"use strict";(self["webpackChunkvue3_webpack5"]=self["webpackChunkvue3_webpack5"]||[]).push([[9504],{45216:function(e,t,r){var i=r(88108),n=r(59947),a=r(82982),o=r(86511),s=r(38443),u=r(52200),h=r(39899),m=r(60072),c=r(2932),l=r(21572),d=r(10667),p=r(53642),f=r(8743),_=r(81154),Z=r(19065),g=r(33306),v=r(18796);function x(e){this._translucentMultipassSupport=!1,this._translucentMRTSupport=!1;var t=e.colorBufferFloat&&e.depthTexture;this._translucentMRTSupport=e.drawBuffers&&t,this._translucentMultipassSupport=!this._translucentMRTSupport&&t,this._opaqueFBO=void 0,this._opaqueTexture=void 0,this._depthStencilTexture=void 0,this._accumulationTexture=void 0,this._translucentFBO=void 0,this._alphaFBO=void 0,this._adjustTranslucentFBO=void 0,this._adjustAlphaFBO=void 0,this._opaqueClearCommand=new h.Z({color:new n.Z(0,0,0,0),owner:this}),this._translucentMRTClearCommand=new h.Z({color:new n.Z(0,0,0,1),owner:this}),this._translucentMultipassClearCommand=new h.Z({color:new n.Z(0,0,0,0),owner:this}),this._alphaClearCommand=new h.Z({color:new n.Z(1,1,1,1),owner:this}),this._translucentRenderStateCache={},this._alphaRenderStateCache={},this._compositeCommand=void 0,this._adjustTranslucentCommand=void 0,this._adjustAlphaCommand=void 0,this._viewport=new i.Z,this._rs=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHDR=!1}function w(e){e._accumulationTexture=e._accumulationTexture&&!e._accumulationTexture.isDestroyed()&&e._accumulationTexture.destroy(),e._revealageTexture=e._revealageTexture&&!e._revealageTexture.isDestroyed()&&e._revealageTexture.destroy()}function y(e){e._translucentFBO=e._translucentFBO&&!e._translucentFBO.isDestroyed()&&e._translucentFBO.destroy(),e._alphaFBO=e._alphaFBO&&!e._alphaFBO.isDestroyed()&&e._alphaFBO.destroy(),e._adjustTranslucentFBO=e._adjustTranslucentFBO&&!e._adjustTranslucentFBO.isDestroyed()&&e._adjustTranslucentFBO.destroy(),e._adjustAlphaFBO=e._adjustAlphaFBO&&!e._adjustAlphaFBO.isDestroyed()&&e._adjustAlphaFBO.destroy()}function C(e){w(e),y(e)}function S(e,t,r,i){w(e),e._accumulationTexture=new f.Z({context:t,width:r,height:i,pixelFormat:s.Z.RGBA,pixelDatatype:l.Z.FLOAT});var n=new Float32Array(r*i*4);e._revealageTexture=new f.Z({context:t,pixelFormat:s.Z.RGBA,pixelDatatype:l.Z.FLOAT,source:{arrayBufferView:n,width:r,height:i},flipY:!1})}function T(e,t){y(e);var r=u.Z.FRAMEBUFFER_COMPLETE,i=!0;if(e._translucentMRTSupport&&(e._translucentFBO=new c.Z({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._adjustTranslucentFBO=new c.Z({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],destroyAttachments:!1}),e._translucentFBO.status===r&&e._adjustTranslucentFBO.status===r||(y(e),e._translucentMRTSupport=!1)),!e._translucentMRTSupport){e._translucentFBO=new c.Z({context:t,colorTextures:[e._accumulationTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._alphaFBO=new c.Z({context:t,colorTextures:[e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._adjustTranslucentFBO=new c.Z({context:t,colorTextures:[e._accumulationTexture],destroyAttachments:!1}),e._adjustAlphaFBO=new c.Z({context:t,colorTextures:[e._revealageTexture],destroyAttachments:!1});var n=e._translucentFBO.status===r,a=e._alphaFBO.status===r,o=e._adjustTranslucentFBO.status===r,s=e._adjustAlphaFBO.status===r;n&&a&&o&&s||(C(e),e._translucentMultipassSupport=!1,i=!1)}return i}x.prototype.update=function(e,t,r,n){if(this.isSupported()){this._opaqueFBO=r,this._opaqueTexture=r.getColorTexture(0),this._depthStencilTexture=r.depthStencilTexture;var o=this._opaqueTexture.width,s=this._opaqueTexture.height,u=this._accumulationTexture,h=!(0,a.Z)(u)||u.width!==o||u.height!==s||n!==this._useHDR;if(h&&S(this,e,o,s),(0,a.Z)(this._translucentFBO)&&!h||T(this,e)){this._useHDR=n;var m,c,l=this;(0,a.Z)(this._compositeCommand)||(m=new p.Z({sources:[Z.Z]}),this._translucentMRTSupport&&m.defines.push("MRT"),c={u_opaque:function(){return l._opaqueTexture},u_accumulation:function(){return l._accumulationTexture},u_revealage:function(){return l._revealageTexture}},this._compositeCommand=e.createViewportQuadCommand(m,{uniformMap:c,owner:this})),(0,a.Z)(this._adjustTranslucentCommand)||(this._translucentMRTSupport?(m=new p.Z({defines:["MRT"],sources:[_.Z]}),c={u_bgColor:function(){return l._translucentMRTClearCommand.color},u_depthTexture:function(){return l._depthStencilTexture}},this._adjustTranslucentCommand=e.createViewportQuadCommand(m,{uniformMap:c,owner:this})):this._translucentMultipassSupport&&(m=new p.Z({sources:[_.Z]}),c={u_bgColor:function(){return l._translucentMultipassClearCommand.color},u_depthTexture:function(){return l._depthStencilTexture}},this._adjustTranslucentCommand=e.createViewportQuadCommand(m,{uniformMap:c,owner:this}),c={u_bgColor:function(){return l._alphaClearCommand.color},u_depthTexture:function(){return l._depthStencilTexture}},this._adjustAlphaCommand=e.createViewportQuadCommand(m,{uniformMap:c,owner:this}))),this._viewport.width=o,this._viewport.height=s;var f=!i.Z.equals(this._viewport,t.viewport),g=f!==this._useScissorTest;this._useScissorTest=f,i.Z.equals(this._scissorRectangle,t.viewport)||(this._scissorRectangle=i.Z.clone(t.viewport,this._scissorRectangle),g=!0),(0,a.Z)(this._rs)&&i.Z.equals(this._viewport,this._rs.viewport)&&!g||(this._rs=d.Z.fromCache({viewport:this._viewport,scissorTest:{enabled:this._useScissorTest,rectangle:this._scissorRectangle}})),(0,a.Z)(this._compositeCommand)&&(this._compositeCommand.renderState=this._rs),this._adjustTranslucentCommand&&(this._adjustTranslucentCommand.renderState=this._rs),(0,a.Z)(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.renderState=this._rs)}}};var b={enabled:!0,color:new n.Z(0,0,0,0),equationRgb:g.Z.ADD,equationAlpha:g.Z.ADD,functionSourceRgb:v.Z.ONE,functionDestinationRgb:v.Z.ONE,functionSourceAlpha:v.Z.ZERO,functionDestinationAlpha:v.Z.ONE_MINUS_SOURCE_ALPHA},D={enabled:!0,color:new n.Z(0,0,0,0),equationRgb:g.Z.ADD,equationAlpha:g.Z.ADD,functionSourceRgb:v.Z.ONE,functionDestinationRgb:v.Z.ONE,functionSourceAlpha:v.Z.ONE,functionDestinationAlpha:v.Z.ONE},P={enabled:!0,color:new n.Z(0,0,0,0),equationRgb:g.Z.ADD,equationAlpha:g.Z.ADD,functionSourceRgb:v.Z.ZERO,functionDestinationRgb:v.Z.ONE_MINUS_SOURCE_ALPHA,functionSourceAlpha:v.Z.ZERO,functionDestinationAlpha:v.Z.ONE_MINUS_SOURCE_ALPHA};function O(e,t,r,i){var n=r[i.id];if(!(0,a.Z)(n)){var o=d.Z.getState(i);o.depthMask=!1,o.blending=t,n=d.Z.fromCache(o),r[i.id]=n}return n}function M(e,t,r){return O(t,b,e._translucentRenderStateCache,r)}function F(e,t,r){return O(t,D,e._translucentRenderStateCache,r)}function E(e,t,r){return O(t,P,e._alphaRenderStateCache,r)}var A="    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n    float ai = czm_gl_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    gl_FragData[0] = vec4(Ci * wzi, ai);\n    gl_FragData[1] = vec4(ai * wzi);\n",B="    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n    float ai = czm_gl_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    gl_FragColor = vec4(Ci, ai) * wzi;\n",R="    float ai = czm_gl_FragColor.a;\n    gl_FragColor = vec4(ai);\n";function z(e,t,r,i){var n=e.shaderCache.getDerivedShaderProgram(t,r);if(!(0,a.Z)(n)){var o=t._attributeLocations,s=t.fragmentShaderSource.clone();s.sources=s.sources.map((function(e){return e=p.Z.replaceMain(e,"czm_translucent_main"),e=e.replace(/gl_FragColor/g,"czm_gl_FragColor"),e=e.replace(/\bdiscard\b/g,"czm_discard = true"),e=e.replace(/czm_phong/g,"czm_translucentPhong"),e})),s.sources.splice(0,0,(-1!==i.indexOf("gl_FragData")?"#extension GL_EXT_draw_buffers : enable \n":"")+"vec4 czm_gl_FragColor;\nbool czm_discard = false;\n"),s.sources.push("void main()\n{\n    czm_translucent_main();\n    if (czm_discard)\n    {\n        discard;\n    }\n"+i+"}\n"),n=e.shaderCache.createDerivedShaderProgram(t,r,{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:s,attributeLocations:o})}return n}function k(e,t){return z(e,t,"translucentMRT",A)}function I(e,t){return z(e,t,"translucentMultipass",B)}function L(e,t){return z(e,t,"alphaMultipass",R)}function j(e,t,r,i,n,o){var s,u,h,m=t.context,c=t.frameState.useLogDepth,l=t._hdr,d=i.framebuffer,p=n.length,f=t.frameState.shadowState.lightShadowsEnabled;i.framebuffer=e._adjustTranslucentFBO,e._adjustTranslucentCommand.execute(m,i),i.framebuffer=e._adjustAlphaFBO,e._adjustAlphaCommand.execute(m,i);var _=e._opaqueFBO;for(i.framebuffer=e._translucentFBO,h=0;h<p;++h)s=n[h],s=c?s.derivedCommands.logDepth.command:s,s=l?s.derivedCommands.hdr.command:s,u=f&&s.receiveShadows?s.derivedCommands.oit.shadows.translucentCommand:s.derivedCommands.oit.translucentCommand,r(u,t,m,i,_);for((0,a.Z)(o)&&(s=o.unclassifiedCommand,u=f&&s.receiveShadows?s.derivedCommands.oit.shadows.translucentCommand:s.derivedCommands.oit.translucentCommand,r(u,t,m,i,_)),i.framebuffer=e._alphaFBO,h=0;h<p;++h)s=n[h],s=c?s.derivedCommands.logDepth.command:s,s=l?s.derivedCommands.hdr.command:s,u=f&&s.receiveShadows?s.derivedCommands.oit.shadows.alphaCommand:s.derivedCommands.oit.alphaCommand,r(u,t,m,i,_);(0,a.Z)(o)&&(s=o.unclassifiedCommand,u=f&&s.receiveShadows?s.derivedCommands.oit.shadows.alphaCommand:s.derivedCommands.oit.alphaCommand,r(u,t,m,i,_)),i.framebuffer=d}function N(e,t,r,i,n,o){var s=t.context,u=t.frameState.useLogDepth,h=t._hdr,m=i.framebuffer,c=n.length,l=t.frameState.shadowState.lightShadowsEnabled;i.framebuffer=e._adjustTranslucentFBO,e._adjustTranslucentCommand.execute(s,i);var d,p,f=e._opaqueFBO;i.framebuffer=e._translucentFBO;for(var _=0;_<c;++_)d=n[_],d=u?d.derivedCommands.logDepth.command:d,d=h?d.derivedCommands.hdr.command:d,p=l&&d.receiveShadows?d.derivedCommands.oit.shadows.translucentCommand:d.derivedCommands.oit.translucentCommand,r(p,t,s,i,f);(0,a.Z)(o)&&(d=o.unclassifiedCommand,p=l&&d.receiveShadows?d.derivedCommands.oit.shadows.translucentCommand:d.derivedCommands.oit.translucentCommand,r(p,t,s,i,f)),i.framebuffer=m}x.prototype.createDerivedCommands=function(e,t,r){var i,n,o,s,u,h;((0,a.Z)(r)||(r={}),this._translucentMRTSupport)?((0,a.Z)(r.translucentCommand)&&(i=r.translucentCommand.shaderProgram,n=r.translucentCommand.renderState),r.translucentCommand=m.Z.shallowClone(e,r.translucentCommand),(0,a.Z)(i)&&r.shaderProgramId===e.shaderProgram.id?(r.translucentCommand.shaderProgram=i,r.translucentCommand.renderState=n):(r.translucentCommand.shaderProgram=k(t,e.shaderProgram),r.translucentCommand.renderState=M(this,t,e.renderState),r.shaderProgramId=e.shaderProgram.id)):((0,a.Z)(r.translucentCommand)&&(o=r.translucentCommand.shaderProgram,s=r.translucentCommand.renderState,u=r.alphaCommand.shaderProgram,h=r.alphaCommand.renderState),r.translucentCommand=m.Z.shallowClone(e,r.translucentCommand),r.alphaCommand=m.Z.shallowClone(e,r.alphaCommand),(0,a.Z)(o)&&r.shaderProgramId===e.shaderProgram.id?(r.translucentCommand.shaderProgram=o,r.translucentCommand.renderState=s,r.alphaCommand.shaderProgram=u,r.alphaCommand.renderState=h):(r.translucentCommand.shaderProgram=I(t,e.shaderProgram),r.translucentCommand.renderState=F(this,t,e.renderState),r.alphaCommand.shaderProgram=L(t,e.shaderProgram),r.alphaCommand.renderState=E(this,t,e.renderState),r.shaderProgramId=e.shaderProgram.id));return r},x.prototype.executeCommands=function(e,t,r,i,n){this._translucentMRTSupport?N(this,e,t,r,i,n):j(this,e,t,r,i,n)},x.prototype.execute=function(e,t){this._compositeCommand.execute(e,t)},x.prototype.clear=function(e,t,r){var i=t.framebuffer;t.framebuffer=this._opaqueFBO,n.Z.clone(r,this._opaqueClearCommand.color),this._opaqueClearCommand.execute(e,t),t.framebuffer=this._translucentFBO;var a=this._translucentMRTSupport?this._translucentMRTClearCommand:this._translucentMultipassClearCommand;a.execute(e,t),this._translucentMultipassSupport&&(t.framebuffer=this._alphaFBO,this._alphaClearCommand.execute(e,t)),t.framebuffer=i},x.prototype.isSupported=function(){return this._translucentMRTSupport||this._translucentMultipassSupport},x.prototype.isDestroyed=function(){return!1},x.prototype.destroy=function(){return C(this),(0,a.Z)(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),(0,a.Z)(this._adjustTranslucentCommand)&&(this._adjustTranslucentCommand.shaderProgram=this._adjustTranslucentCommand.shaderProgram&&this._adjustTranslucentCommand.shaderProgram.destroy()),(0,a.Z)(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.shaderProgram=this._adjustAlphaCommand.shaderProgram&&this._adjustAlphaCommand.shaderProgram.destroy()),(0,o.Z)(this)},t["Z"]=x},22277:function(e,t,r){var i=r(60216),n=r(84828),a=r(82982),o=r(86511),s=r(22832),u=r(54973),h=r(38443),m=r(99095),c=r(58597),l=r(92357),d=r(51107),p=r(21572),f=r(46588),_=r(53642),Z=r(8743),g=r(18192),v=r(60120),x=r(362),w=r(7736),y=r(13222);function C(e){this._url=e,this._cubeMapBuffers=void 0,this._cubeMaps=void 0,this._texture=void 0,this._mipTextures=void 0,this._va=void 0,this._sp=void 0,this._maximumMipmapLevel=void 0,this._loading=!1,this._ready=!1,this._readyPromise=y.Z.defer()}Object.defineProperties(C.prototype,{url:{get:function(){return this._url}},texture:{get:function(){return this._texture}},maximumMipmapLevel:{get:function(){return this._maximumMipmapLevel}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}}),C.isSupported=function(e){return e.colorBufferHalfFloat&&e.halfFloatingPointTexture||e.floatingPointTexture&&e.colorBufferFloat};for(var S=new i.Z(1,0,0),T=new i.Z(0,0,1),b=new i.Z(-1,0,0),D=new i.Z(0,0,-1),P=new i.Z(0,1,0),O=new i.Z(0,-1,0),M=[P,b,T,O,S,P,D,P,P],F=M.length,E=new Float32Array(3*F),A=0,B=0;B<F;++B,A+=3)i.Z.pack(M[B],E,A);var R=new Float32Array([-1,1,-1,0,0,1,0,0,1,0,1,1,0,-1,-1,-1,1,-1]),z=new Uint16Array([0,1,2,2,3,1,7,6,1,3,6,1,2,5,4,3,4,2,4,8,6,3,4,6]);function k(e){var t=m.Z.createVertexBuffer({context:e,typedArray:R,usage:c.Z.STATIC_DRAW}),r=m.Z.createVertexBuffer({context:e,typedArray:E,usage:c.Z.STATIC_DRAW}),i=m.Z.createIndexBuffer({context:e,typedArray:z,usage:c.Z.STATIC_DRAW,indexDatatype:s.Z.UNSIGNED_SHORT}),a=[{index:0,vertexBuffer:t,componentsPerAttribute:2,componentDatatype:n.Z.FLOAT},{index:1,vertexBuffer:r,componentsPerAttribute:3,componentDatatype:n.Z.FLOAT}];return new g.Z({context:e,attributes:a,indexBuffer:i})}function I(e){return function(){return e}}function L(e){var t,r;e._va=e._va&&e._va.destroy(),e._sp=e._sp&&e._sp.destroy();var i=e._cubeMaps;if((0,a.Z)(i))for(r=i.length,t=0;t<r;++t)i[t].destroy();var n=e._mipTextures;if((0,a.Z)(n))for(r=n.length,t=0;t<r;++t)n[t].destroy();e._va=void 0,e._sp=void 0,e._cubeMaps=void 0,e._cubeMapBuffers=void 0,e._mipTextures=void 0}C.prototype.update=function(e){var t=e.context;if(C.isSupported(t)&&((0,a.Z)(this._texture)&&(0,a.Z)(this._va)&&L(this),!(0,a.Z)(this._texture))){if(!(0,a.Z)(this._texture)&&!this._loading){var r=t.textureCache.getTexture(this._url);if((0,a.Z)(r))return L(this),this._texture=r,this._maximumMipmapLevel=this._texture.maximumMipmapLevel,this._ready=!0,void this._readyPromise.resolve()}var i=this._cubeMapBuffers;if(!(0,a.Z)(i)&&!this._loading){var n=this;(0,u.Z)(this._url).then((function(e){n._cubeMapBuffers=e,n._loading=!1})).otherwise(this._readyPromise.reject),this._loading=!0}if((0,a.Z)(this._cubeMapBuffers)){var o=[],s=i[0].positiveX.pixelDatatype;(0,a.Z)(s)?o.push("RGBA_NORMALIZED"):s=t.halfFloatingPointTexture?p.Z.HALF_FLOAT:p.Z.FLOAT;var m=h.Z.RGBA,c=new _.Z({defines:o,sources:[x.Z]});this._va=k(t),this._sp=f.Z.fromCache({context:t,vertexShaderSource:w.Z,fragmentShaderSource:c,attributeLocations:{position:0,cubeMapCoordinates:1}});var g=Math.min(i.length,6);this._maximumMipmapLevel=g-1;for(var y=this._cubeMaps=new Array(g),S=this._mipTextures=new Array(g),T=2*i[0].positiveX.width,b={originalSize:function(){return T}},D=0;D<g;++D){var P=i[D].positiveY;i[D].positiveY=i[D].negativeY,i[D].negativeY=P;var O=y[D]=new d.Z({context:t,source:i[D],pixelDatatype:s}),M=2*y[D].width,F=S[D]=new Z.Z({context:t,width:M,height:M,pixelDatatype:s,pixelFormat:m}),E=new l.Z({vertexArray:this._va,shaderProgram:this._sp,uniformMap:{cubeMap:I(O)},outputTexture:F,persists:!0,owner:this});e.commandList.push(E),b["texture"+D]=I(F)}this._texture=new Z.Z({context:t,width:1.5*T+2,height:T,pixelDatatype:s,pixelFormat:m}),this._texture.maximumMipmapLevel=this._maximumMipmapLevel,t.textureCache.addTexture(this._url,this._texture);var A=new l.Z({fragmentShaderSource:v.Z,uniformMap:b,outputTexture:this._texture,persists:!1,owner:this});e.commandList.push(A),this._ready=!0,this._readyPromise.resolve()}}},C.prototype.isDestroyed=function(){return!1},C.prototype.destroy=function(){return L(this),this._texture=this._texture&&this._texture.destroy(),(0,o.Z)(this)},t["Z"]=C},75436:function(e,t,r){var i=r(52975),n=r(62200),a=r(82982),o=r(12572),s=r(96190),u=r(68985),h=r(42423),m=r(24855),c=new i.Z("MapQuest, Open Street Map and contributors, CC-BY-SA");function l(e){e=(0,n.Z)(e,n.Z.EMPTY_OBJECT);var t=u.Z.createIfNeeded((0,n.Z)(e.url,"https://a.tile.openstreetmap.org/"));t.appendForwardSlash(),t.url+="{z}/{x}/{y}."+(0,n.Z)(e.fileExtension,"png");var r=new h.Z({ellipsoid:e.ellipsoid}),a=256,l=256,d=(0,n.Z)(e.minimumLevel,0),p=e.maximumLevel,f=(0,n.Z)(e.rectangle,r.rectangle),_=r.positionToTileXY(s.Z.southwest(f),d),Z=r.positionToTileXY(s.Z.northeast(f),d),g=(Math.abs(Z.x-_.x)+1)*(Math.abs(Z.y-_.y)+1);if(g>4)throw new o.Z("The rectangle and minimumLevel indicate that there are "+g+" tiles at the minimum level. Imagery providers with more than four tiles at the minimum level are not supported.");var v=(0,n.Z)(e.credit,c);"string"===typeof v&&(v=new i.Z(v)),m.Z.call(this,{url:t,credit:v,tilingScheme:r,tileWidth:a,tileHeight:l,minimumLevel:d,maximumLevel:p,rectangle:f})}(0,a.Z)(Object.create)&&(l.prototype=Object.create(m.Z.prototype),l.prototype.constructor=l),t["Z"]=l},32073:function(e,t,r){var i=r(66553),n=r(62200),a=r(82982),o=r(86511),s=r(73316);function u(){this._length=0,this._collections={},this._collectionsArray=[],this.show=!0}Object.defineProperties(u.prototype,{length:{get:function(){return this._length}}}),u.prototype.add=function(e,t){i.Z.defined("primitive",e),(0,a.Z)(t)&&i.Z.typeOf.number("zIndex",t),t=(0,n.Z)(t,0);var r=this._collections[t];if(!(0,a.Z)(r)){r=new s.Z({destroyPrimitives:!1}),r._zIndex=t,this._collections[t]=r;var o=this._collectionsArray,u=0;while(u<o.length&&o[u]._zIndex<t)u++;o.splice(u,0,r)}return r.add(e),this._length++,e._zIndex=t,e},u.prototype.set=function(e,t){return i.Z.defined("primitive",e),i.Z.typeOf.number("zIndex",t),t===e._zIndex||(this.remove(e,!0),this.add(e,t)),e},u.prototype.remove=function(e,t){if(this.contains(e)){var r,i=e._zIndex,n=this._collections[i];return r=t?n.remove(e):n.removeAndDestroy(e),r&&this._length--,0===n.length&&(this._collectionsArray.splice(this._collectionsArray.indexOf(n),1),this._collections[i]=void 0,n.destroy()),r}return!1},u.prototype.removeAll=function(){for(var e=this._collectionsArray,t=0;t<e.length;t++){var r=e[t];r.destroyPrimitives=!0,r.destroy()}this._collections={},this._collectionsArray=[],this._length=0},u.prototype.contains=function(e){if(!(0,a.Z)(e))return!1;var t=this._collections[e._zIndex];return(0,a.Z)(t)&&t.contains(e)},u.prototype.update=function(e){if(this.show)for(var t=this._collectionsArray,r=0;r<t.length;r++)t[r].update(e)},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){return this.removeAll(),(0,o.Z)(this)},t["Z"]=u},1629:function(e,t,r){var i=r(60838),n=r(60216),a=r(59947),o=r(62200),s=r(82982),u=new i.Z(1,1);function h(e){e=(0,o.Z)(e,o.Z.EMPTY_OBJECT),this.mass=(0,o.Z)(e.mass,1),this.position=n.Z.clone((0,o.Z)(e.position,n.Z.ZERO)),this.velocity=n.Z.clone((0,o.Z)(e.velocity,n.Z.ZERO)),this.life=(0,o.Z)(e.life,Number.MAX_VALUE),this.image=e.image,this.startColor=a.Z.clone((0,o.Z)(e.startColor,a.Z.WHITE)),this.endColor=a.Z.clone((0,o.Z)(e.endColor,a.Z.WHITE)),this.startScale=(0,o.Z)(e.startScale,1),this.endScale=(0,o.Z)(e.endScale,1),this.imageSize=i.Z.clone((0,o.Z)(e.imageSize,u)),this._age=0,this._normalizedAge=0,this._billboard=void 0}Object.defineProperties(h.prototype,{age:{get:function(){return this._age}},normalizedAge:{get:function(){return this._normalizedAge}}});var m=new n.Z;h.prototype.update=function(e,t){return n.Z.multiplyByScalar(this.velocity,e,m),n.Z.add(this.position,m,this.position),(0,s.Z)(t)&&t(this,e),this._age+=e,this.life===Number.MAX_VALUE?this._normalizedAge=0:this._normalizedAge=this._age/this.life,this._age<=this.life},t["Z"]=h},11992:function(e,t,r){var i=r(62200);function n(e){e=(0,i.Z)(e,i.Z.EMPTY_OBJECT),this.time=(0,i.Z)(e.time,0),this.minimum=(0,i.Z)(e.minimum,0),this.maximum=(0,i.Z)(e.maximum,50),this._complete=!1}Object.defineProperties(n.prototype,{complete:{get:function(){return this._complete}}})},90164:function(e,t,r){var i=r(12572);function n(e){throw new i.Z("This type should not be instantiated directly.  Instead, use BoxEmitter, CircleEmitter, ConeEmitter or SphereEmitter.")}n.prototype.emit=function(e){i.Z.throwInstantiationError()}},34992:function(e,t,r){var i=r(60838),n=r(60216),a=r(66553),o=r(59947),s=r(62200),u=r(82982),h=r(86511),m=r(14459),c=r(55293),l=r(99417),d=r(72248),p=r(8044),f=r(27377),_=r(1629),Z=new i.Z(1,1);function g(e){e=(0,s.Z)(e,s.Z.EMPTY_OBJECT),this.show=(0,s.Z)(e.show,!0),this.updateCallback=e.updateCallback,this.loop=(0,s.Z)(e.loop,!0),this.image=(0,s.Z)(e.image,void 0);var t=e.emitter;(0,u.Z)(t)||(t=new f.Z(.5)),this._emitter=t,this._bursts=e.bursts,this._modelMatrix=d.Z.clone((0,s.Z)(e.modelMatrix,d.Z.IDENTITY)),this._emitterModelMatrix=d.Z.clone((0,s.Z)(e.emitterModelMatrix,d.Z.IDENTITY)),this._matrixDirty=!0,this._combinedMatrix=new d.Z,this._startColor=o.Z.clone((0,s.Z)(e.color,(0,s.Z)(e.startColor,o.Z.WHITE))),this._endColor=o.Z.clone((0,s.Z)(e.color,(0,s.Z)(e.endColor,o.Z.WHITE))),this._startScale=(0,s.Z)(e.scale,(0,s.Z)(e.startScale,1)),this._endScale=(0,s.Z)(e.scale,(0,s.Z)(e.endScale,1)),this._emissionRate=(0,s.Z)(e.emissionRate,5),this._minimumSpeed=(0,s.Z)(e.speed,(0,s.Z)(e.minimumSpeed,1)),this._maximumSpeed=(0,s.Z)(e.speed,(0,s.Z)(e.maximumSpeed,1)),this._minimumParticleLife=(0,s.Z)(e.particleLife,(0,s.Z)(e.minimumParticleLife,5)),this._maximumParticleLife=(0,s.Z)(e.particleLife,(0,s.Z)(e.maximumParticleLife,5)),this._minimumMass=(0,s.Z)(e.mass,(0,s.Z)(e.minimumMass,1)),this._maximumMass=(0,s.Z)(e.mass,(0,s.Z)(e.maximumMass,1)),this._minimumImageSize=i.Z.clone((0,s.Z)(e.imageSize,(0,s.Z)(e.minimumImageSize,Z))),this._maximumImageSize=i.Z.clone((0,s.Z)(e.imageSize,(0,s.Z)(e.maximumImageSize,Z))),this._sizeInMeters=(0,s.Z)(e.sizeInMeters,!1),this._lifetime=(0,s.Z)(e.lifetime,Number.MAX_VALUE),this._billboardCollection=void 0,this._particles=[],this._particlePool=[],this._previousTime=void 0,this._currentTime=0,this._carryOver=0,this._complete=new m.Z,this._isComplete=!1,this._updateParticlePool=!0,this._particleEstimate=0}function v(e){var t=e._emissionRate,r=e._maximumParticleLife,i=0,n=e._bursts;if((0,u.Z)(n))for(var a=n.length,o=0;o<a;++o)i+=n[o].maximum;for(var s=e._billboardCollection,h=e.image,m=Math.ceil(t*r+i),c=e._particles,l=e._particlePool,d=Math.max(m-c.length-l.length,0),p=0;p<d;++p){var f=new _.Z;f._billboard=s.add({image:h}),l.push(f)}e._particleEstimate=m}function x(e){var t=e._particlePool.pop();return(0,u.Z)(t)||(t=new _.Z),t}function w(e,t){e._particlePool.push(t)}function y(e){for(var t=e._particles,r=e._particlePool,i=e._billboardCollection,n=t.length,a=r.length,o=e._particleEstimate,s=a-Math.max(o-n-a,0),u=s;u<a;++u){var h=r[u];i.remove(h._billboard)}r.length=s}function C(e){(0,u.Z)(e._billboard)&&(e._billboard.show=!1)}function S(e,t){var r=t._billboard;(0,u.Z)(r)||(r=t._billboard=e._billboardCollection.add({image:t.image})),r.width=t.imageSize.x,r.height=t.imageSize.y,r.position=t.position,r.sizeInMeters=e.sizeInMeters,r.show=!0;var i=l.Z.lerp(t.startColor.red,t.endColor.red,t.normalizedAge),n=l.Z.lerp(t.startColor.green,t.endColor.green,t.normalizedAge),a=l.Z.lerp(t.startColor.blue,t.endColor.blue,t.normalizedAge),s=l.Z.lerp(t.startColor.alpha,t.endColor.alpha,t.normalizedAge);r.color=new o.Z(i,n,a,s),r.scale=l.Z.lerp(t.startScale,t.endScale,t.normalizedAge)}function T(e,t){t.startColor=o.Z.clone(e._startColor,t.startColor),t.endColor=o.Z.clone(e._endColor,t.endColor),t.startScale=e._startScale,t.endScale=e._endScale,t.image=e.image,t.life=l.Z.randomBetween(e._minimumParticleLife,e._maximumParticleLife),t.mass=l.Z.randomBetween(e._minimumMass,e._maximumMass),t.imageSize.x=l.Z.randomBetween(e._minimumImageSize.x,e._maximumImageSize.x),t.imageSize.y=l.Z.randomBetween(e._minimumImageSize.y,e._maximumImageSize.y),t._normalizedAge=0,t._age=0;var r=l.Z.randomBetween(e._minimumSpeed,e._maximumSpeed);n.Z.multiplyByScalar(t.velocity,r,t.velocity),e._particles.push(t)}function b(e,t){if(e._isComplete)return 0;t=l.Z.mod(t,e._lifetime);var r=t*e._emissionRate,i=Math.floor(r);if(e._carryOver+=r-i,e._carryOver>1&&(i++,e._carryOver-=1),(0,u.Z)(e.bursts))for(var n=e.bursts.length,a=0;a<n;a++){var o=e.bursts[a],s=e._currentTime;(0,u.Z)(o)&&!o._complete&&s>o.time&&(i+=l.Z.randomBetween(o.minimum,o.maximum),o._complete=!0)}return i}Object.defineProperties(g.prototype,{emitter:{get:function(){return this._emitter},set:function(e){a.Z.defined("value",e),this._emitter=e}},bursts:{get:function(){return this._bursts},set:function(e){this._bursts=e,this._updateParticlePool=!0}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){a.Z.defined("value",e),this._matrixDirty=this._matrixDirty||!d.Z.equals(this._modelMatrix,e),d.Z.clone(e,this._modelMatrix)}},emitterModelMatrix:{get:function(){return this._emitterModelMatrix},set:function(e){a.Z.defined("value",e),this._matrixDirty=this._matrixDirty||!d.Z.equals(this._emitterModelMatrix,e),d.Z.clone(e,this._emitterModelMatrix)}},startColor:{get:function(){return this._startColor},set:function(e){a.Z.defined("value",e),o.Z.clone(e,this._startColor)}},endColor:{get:function(){return this._endColor},set:function(e){a.Z.defined("value",e),o.Z.clone(e,this._endColor)}},startScale:{get:function(){return this._startScale},set:function(e){a.Z.typeOf.number.greaterThanOrEquals("value",e,0),this._startScale=e}},endScale:{get:function(){return this._endScale},set:function(e){a.Z.typeOf.number.greaterThanOrEquals("value",e,0),this._endScale=e}},emissionRate:{get:function(){return this._emissionRate},set:function(e){a.Z.typeOf.number.greaterThanOrEquals("value",e,0),this._emissionRate=e,this._updateParticlePool=!0}},minimumSpeed:{get:function(){return this._minimumSpeed},set:function(e){a.Z.typeOf.number.greaterThanOrEquals("value",e,0),this._minimumSpeed=e}},maximumSpeed:{get:function(){return this._maximumSpeed},set:function(e){a.Z.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumSpeed=e}},minimumParticleLife:{get:function(){return this._minimumParticleLife},set:function(e){a.Z.typeOf.number.greaterThanOrEquals("value",e,0),this._minimumParticleLife=e}},maximumParticleLife:{get:function(){return this._maximumParticleLife},set:function(e){a.Z.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumParticleLife=e,this._updateParticlePool=!0}},minimumMass:{get:function(){return this._minimumMass},set:function(e){a.Z.typeOf.number.greaterThanOrEquals("value",e,0),this._minimumMass=e}},maximumMass:{get:function(){return this._maximumMass},set:function(e){a.Z.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumMass=e}},minimumImageSize:{get:function(){return this._minimumImageSize},set:function(e){a.Z.typeOf.object("value",e),a.Z.typeOf.number.greaterThanOrEquals("value.x",e.x,0),a.Z.typeOf.number.greaterThanOrEquals("value.y",e.y,0),this._minimumImageSize=e}},maximumImageSize:{get:function(){return this._maximumImageSize},set:function(e){a.Z.typeOf.object("value",e),a.Z.typeOf.number.greaterThanOrEquals("value.x",e.x,0),a.Z.typeOf.number.greaterThanOrEquals("value.y",e.y,0),this._maximumImageSize=e}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){a.Z.typeOf.bool("value",e),this._sizeInMeters=e}},lifetime:{get:function(){return this._lifetime},set:function(e){a.Z.typeOf.number.greaterThanOrEquals("value",e,0),this._lifetime=e}},complete:{get:function(){return this._complete}},isComplete:{get:function(){return this._isComplete}}});var D=new n.Z;g.prototype.update=function(e){if(this.show){(0,u.Z)(this._billboardCollection)||(this._billboardCollection=new p.Z),this._updateParticlePool&&(v(this),this._updateParticlePool=!1);var t=0;this._previousTime&&(t=c.Z.secondsDifference(e.time,this._previousTime)),t<0&&(t=0);var r,i,a=this._particles,o=this._emitter,s=this.updateCallback,h=a.length;for(r=0;r<h;++r)i=a[r],i.update(t,s)?S(this,i):(C(i),w(this,i),a[r]=a[h-1],--r,--h);a.length=h;var m=b(this,t);if(m>0&&(0,u.Z)(o)){this._matrixDirty&&(this._combinedMatrix=d.Z.multiply(this.modelMatrix,this.emitterModelMatrix,this._combinedMatrix),this._matrixDirty=!1);var f=this._combinedMatrix;for(r=0;r<m;r++)i=x(this),this._emitter.emit(i),n.Z.add(i.position,i.velocity,D),d.Z.multiplyByPoint(f,D,D),i.position=d.Z.multiplyByPoint(f,i.position,i.position),n.Z.subtract(D,i.position,i.velocity),n.Z.normalize(i.velocity,i.velocity),T(this,i),S(this,i)}if(this._billboardCollection.update(e),this._previousTime=c.Z.clone(e.time,this._previousTime),this._currentTime+=t,this._lifetime!==Number.MAX_VALUE&&this._currentTime>this._lifetime)if(this.loop){if(this._currentTime=l.Z.mod(this._currentTime,this._lifetime),this.bursts){var _=this.bursts.length;for(r=0;r<_;r++)this.bursts[r]._complete=!1}}else this._isComplete=!0,this._complete.raiseEvent(this);e.frameNumber%120===0&&y(this)}},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),(0,h.Z)(this)}},64060:function(e,t,r){var i=r(62200),n=r(67252),a=r(26712),o=r(82926),s=r(76257),u=r(32321),h=r(12804);function m(e){e=(0,i.Z)(e,i.Z.EMPTY_OBJECT);var t=(0,i.Z)(e.translucent,!0),r=(0,i.Z)(e.closed,!1),n=(0,i.Z)(e.flat,!1),c=n?u.Z:o.Z,l=n?s.Z:a.Z,d=n?m.FLAT_VERTEX_FORMAT:m.VERTEX_FORMAT;this.material=void 0,this.translucent=t,this._vertexShaderSource=(0,i.Z)(e.vertexShaderSource,c),this._fragmentShaderSource=(0,i.Z)(e.fragmentShaderSource,l),this._renderState=h.Z.getDefaultRenderState(t,r,e.renderState),this._closed=r,this._vertexFormat=d,this._flat=n,this._faceForward=(0,i.Z)(e.faceForward,!r)}Object.defineProperties(m.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}}),m.VERTEX_FORMAT=n.Z.POSITION_AND_NORMAL,m.FLAT_VERTEX_FORMAT=n.Z.POSITION_ONLY,m.prototype.getFragmentShaderSource=h.Z.prototype.getFragmentShaderSource,m.prototype.isTranslucent=h.Z.prototype.isTranslucent,m.prototype.getRenderState=h.Z.prototype.getRenderState,t["Z"]=m},73829:function(e,t,r){var i=r(62200),n=r(82982),a=r(86511),o=r(12572),s=r(59081),u=r(43412);function h(e){e=(0,i.Z)(e,i.Z.EMPTY_OBJECT);var t=(0,u.Z)(e.container);if(!(0,n.Z)(t))throw new o.Z("container is required");this._container=t;var r=document.createElement("div");r.className="cesium-performanceDisplay";var a=document.createElement("div");a.className="cesium-performanceDisplay-fps",this._fpsText=document.createTextNode(""),a.appendChild(this._fpsText);var h=document.createElement("div");h.className="cesium-performanceDisplay-ms",this._msText=document.createTextNode(""),h.appendChild(this._msText),r.appendChild(h),r.appendChild(a),this._container.appendChild(r),this._lastFpsSampleTime=(0,s.Z)(),this._lastMsSampleTime=(0,s.Z)(),this._fpsFrameCount=0,this._msFrameCount=0,this._throttled=!1;var m=document.createElement("div");m.className="cesium-performanceDisplay-throttled",this._throttledText=document.createTextNode(""),m.appendChild(this._throttledText),r.appendChild(m)}Object.defineProperties(h.prototype,{throttled:{get:function(){return this._throttled},set:function(e){this._throttled!==e&&(this._throttledText.nodeValue=e?"(throttled)":"",this._throttled=e)}}}),h.prototype.update=function(e){var t=(0,s.Z)(),r=(0,i.Z)(e,!0);this._fpsFrameCount++;var n=t-this._lastFpsSampleTime;if(n>1e3){var a="N/A";r&&(a=1e3*this._fpsFrameCount/n|0),this._fpsText.nodeValue=a+" FPS",this._lastFpsSampleTime=t,this._fpsFrameCount=0}this._msFrameCount++;var o=t-this._lastMsSampleTime;if(o>200){var u="N/A";r&&(u=(o/this._msFrameCount).toFixed(2)),this._msText.nodeValue=u+" MS",this._lastMsSampleTime=t,this._msFrameCount=0}},h.prototype.destroy=function(){return(0,a.Z)(this)},t["Z"]=h},43623:function(e,t,r){var i=r(63367),n=r(82982),a=r(86511),o=r(38443),s=r(2932),u=r(21572),h=r(10667),m=r(53642),c=r(8743);function l(){this._framebuffer=void 0,this._depthTexture=void 0,this._textureToCopy=void 0,this._copyDepthCommand=void 0,this._useLogDepth=void 0,this._debugPickDepthViewportCommand=void 0}function d(e,t,r,i){if(!(0,n.Z)(e._debugPickDepthViewportCommand)||i!==e._useLogDepth){var a="uniform highp sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    float z_window = czm_unpackDepth(texture2D(u_texture, v_textureCoordinates));\n    z_window = czm_reverseLogDepth(z_window); \n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n",o=new m.Z({defines:[i?"LOG_DEPTH":""],sources:[a]});e._debugPickDepthViewportCommand=t.createViewportQuadCommand(o,{uniformMap:{u_texture:function(){return e._depthTexture}},owner:e}),e._useLogDepth=i}e._debugPickDepthViewportCommand.execute(t,r)}function p(e){e._depthTexture=e._depthTexture&&!e._depthTexture.isDestroyed()&&e._depthTexture.destroy()}function f(e){e._framebuffer=e._framebuffer&&!e._framebuffer.isDestroyed()&&e._framebuffer.destroy()}function _(e,t,r,i){e._depthTexture=new c.Z({context:t,width:r,height:i,pixelFormat:o.Z.RGBA,pixelDatatype:u.Z.UNSIGNED_BYTE})}function Z(e,t,r,i){p(e),f(e),_(e,t,r,i),e._framebuffer=new s.Z({context:t,colorTextures:[e._depthTexture],destroyAttachments:!1})}function g(e,t,r){var i=r.width,a=r.height,o=e._depthTexture,s=!(0,n.Z)(o)||o.width!==i||o.height!==a;(0,n.Z)(e._framebuffer)&&!s||Z(e,t,i,a)}function v(e,t,r){if(!(0,n.Z)(e._copyDepthCommand)){var i="uniform highp sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    gl_FragColor = czm_packDepth(texture2D(u_texture, v_textureCoordinates).r);\n}\n";e._copyDepthCommand=t.createViewportQuadCommand(i,{renderState:h.Z.fromCache(),uniformMap:{u_texture:function(){return e._textureToCopy}},owner:e})}e._textureToCopy=r,e._copyDepthCommand.framebuffer=e._framebuffer}l.prototype.executeDebugPickDepth=function(e,t,r){d(this,e,t,r)},l.prototype.update=function(e,t){g(this,e,t),v(this,e,t)};var x=new i.Z,w=new i.Z(1,1/255,1/65025,1/16581375);l.prototype.getDepth=function(e,t,r){if((0,n.Z)(this._framebuffer)){var a=e.readPixels({x:t,y:r,width:1,height:1,framebuffer:this._framebuffer}),o=i.Z.unpack(a,0,x);return i.Z.divideByScalar(o,255,o),i.Z.dot(o,w)}},l.prototype.executeCopyDepth=function(e,t){this._copyDepthCommand.execute(e,t)},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){return p(this),f(this),(0,n.Z)(this._copyDepthCommand)&&(this._copyDepthCommand.shaderProgram=(0,n.Z)(this._copyDepthCommand.shaderProgram)&&this._copyDepthCommand.shaderProgram.destroy()),(0,a.Z)(this)},t["Z"]=l},37811:function(e,t,r){var i=r(88108),n=r(82982),a=r(86511),o=r(38443),s=r(2932),u=r(65121),h=r(21572),m=r(8743);function c(){this._depthStencilTexture=void 0,this._framebuffer=void 0,this._passState=void 0}function l(e){e._framebuffer=e._framebuffer&&e._framebuffer.destroy(),e._depthStencilTexture=e._depthStencilTexture&&e._depthStencilTexture.destroy()}function d(e,t){var r=t.drawingBufferWidth,n=t.drawingBufferHeight;e._depthStencilTexture=new m.Z({context:t,width:r,height:n,pixelFormat:o.Z.DEPTH_STENCIL,pixelDatatype:h.Z.UNSIGNED_INT_24_8}),e._framebuffer=new s.Z({context:t,depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1});var a=new u.Z(t);a.blendingEnabled=!1,a.scissorTest={enabled:!0,rectangle:new i.Z},a.viewport=new i.Z,e._passState=a}c.prototype.update=function(e,t,r){var i=r.width,a=r.height;(0,n.Z)(this._framebuffer)&&i===this._depthStencilTexture.width&&a===this._depthStencilTexture.height||(l(this),d(this,e));var o=this._framebuffer,s=this._passState;return s.framebuffer=o,s.viewport.width=i,s.viewport.height=a,s.scissorTest.rectangle.x=t.x,s.scissorTest.rectangle.y=a-t.y,s.scissorTest.rectangle.width=1,s.scissorTest.rectangle.height=1,s},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return l(this),(0,a.Z)(this)},t["Z"]=c},93704:function(e,t,r){var i=r(88108),n=r(59947),a=r(62200),o=r(82982),s=r(86511),u=r(2932),h=r(65121),m=r(17941),c=r(89032),l=r(8743);function d(e){var t=new h.Z(e);t.blendingEnabled=!1,t.scissorTest={enabled:!0,rectangle:new i.Z},t.viewport=new i.Z,this._context=e,this._fb=void 0,this._passState=t,this._width=0,this._height=0}d.prototype.begin=function(e,t){var r=this._context,n=t.width,a=t.height;return i.Z.clone(e,this._passState.scissorTest.rectangle),(0,o.Z)(this._fb)&&this._width===n&&this._height===a||(this._width=n,this._height=a,this._fb=this._fb&&this._fb.destroy(),this._fb=new u.Z({context:r,colorTextures:[new l.Z({context:r,width:n,height:a})],depthStencilRenderbuffer:new m.Z({context:r,width:n,height:a,format:c.Z.DEPTH_STENCIL})}),this._passState.framebuffer=this._fb),this._passState.viewport.width=n,this._passState.viewport.height=a,this._passState};var p=new n.Z;d.prototype.end=function(e){for(var t=(0,a.Z)(e.width,1),r=(0,a.Z)(e.height,1),i=this._context,s=i.readPixels({x:e.x,y:e.y,width:t,height:r,framebuffer:this._fb}),u=Math.max(t,r),h=u*u,m=Math.floor(.5*t),c=Math.floor(.5*r),l=0,d=0,f=0,_=-1,Z=0;Z<h;++Z){if(-m<=l&&l<=m&&-c<=d&&d<=c){var g=4*((c-d)*t+l+m);p.red=n.Z.byteToFloat(s[g]),p.green=n.Z.byteToFloat(s[g+1]),p.blue=n.Z.byteToFloat(s[g+2]),p.alpha=n.Z.byteToFloat(s[g+3]);var v=i.getObjectByPickColor(p);if((0,o.Z)(v))return v}if(l===d||l<0&&-l===d||l>0&&l===1-d){var x=f;f=-_,_=x}l+=f,d+=_}},d.prototype.isDestroyed=function(){return!1},d.prototype.destroy=function(){return this._fb=this._fb&&this._fb.destroy(),(0,s.Z)(this)},t["Z"]=d},18441:function(e,t,r){var i=r(53773),n=r(88108),a=r(60838),o=r(60216),s=r(51688),u=r(66553),h=r(59947),m=r(62200),c=r(82982),l=r(12572),d=r(72248),p=r(91473),f=r(35131),_=r(66854),Z=r(36135),g=r(68457),v=r(37939),x=r(13222),w=r(70561),y=r(52381),C=r(94170),S=r(55715),T=r(43623),b=r(73316),D=r(89917),P=r(48244),O=r(70419),M=.1,F=new S.Z({pass:C.Z.MOST_DETAILED_PRELOAD}),E=new S.Z({pass:C.Z.MOST_DETAILED_PICK}),A=new S.Z({pass:C.Z.PICK});function B(e){this._mostDetailedRayPicks=[],this.pickRenderStateCache={},this._pickPositionCache={},this._pickPositionCacheDirty=!1;var t=new n.Z(0,0,1,1),r=new w.Z(e);r.frustum=new p.Z({width:M,aspectRatio:1,near:.1}),this._pickOffscreenView=new O.Z(e,r,t)}B.prototype.update=function(){this._pickPositionCacheDirty=!0},B.prototype.getPickDepth=function(e,t){var r=e.view.pickDepths,i=r[t];return(0,c.Z)(i)||(i=new T.Z,r[t]=i),i};var R=new f.Z,z=new o.Z,k=new o.Z,I=new a.Z,L=new d.Z;function j(e,t,r,i,n){var a=e.camera,s=a.frustum;(0,c.Z)(s._offCenterFrustum)&&(s=s._offCenterFrustum);var u=2*(t.x-n.x)/n.width-1;u*=.5*(s.right-s.left);var h=2*(n.height-t.y-n.y)/n.height-1;h*=.5*(s.top-s.bottom);var m=d.Z.clone(a.transform,L);a._setTransform(d.Z.IDENTITY);var l=o.Z.clone(a.position,z);o.Z.multiplyByScalar(a.right,u,k),o.Z.add(k,l,l),o.Z.multiplyByScalar(a.up,h,k),o.Z.add(k,l,l),a._setTransform(m),e.mode===D.Z.SCENE2D&&o.Z.fromElements(l.z,l.x,l.y,l);var p=s.getPixelDimensions(n.width,n.height,1,1,I),f=R;return f.right=.5*p.x,f.left=-f.right,f.top=.5*p.y,f.bottom=-f.top,f.near=s.near,f.far=s.far,f.computeCullingVolume(l,a.directionWC,a.upWC)}var N=new Z.Z,q=new a.Z;function H(e,t,r,i,n){var a=e.camera,o=a.frustum,s=o.near,u=Math.tan(.5*o.fovy),h=o.aspectRatio*u,m=2*(t.x-n.x)/n.width-1,c=2*(n.height-t.y-n.y)/n.height-1,l=m*s*h,d=c*s*u,p=o.getPixelDimensions(n.width,n.height,1,1,q),f=p.x*r*.5,_=p.y*i*.5,Z=N;return Z.top=d+_,Z.bottom=d-_,Z.right=l+f,Z.left=l-f,Z.near=s,Z.far=o.far,Z.computeCullingVolume(a.positionWC,a.directionWC,a.upWC)}function V(e,t,r,i,n){var a=e.camera.frustum;return a instanceof p.Z||a instanceof f.Z?j(e,t,r,i,n):H(e,t,r,i,n)}var W=3,Y=3,U=new n.Z(0,0,W,Y),X=new a.Z,G=new h.Z(0,0,0,0);function Q(e,t){var r=e.context,i=e.frameState,a=e.environmentState,o=e.defaultView;e.view=o;var s=o.viewport;s.x=0,s.y=0,s.width=r.drawingBufferWidth,s.height=r.drawingBufferHeight;var u=o.passState;u.viewport=n.Z.clone(s,u.viewport),e.clearPasses(i.passes),i.passes.pick=!0,i.passes.depth=!0,i.cullingVolume=V(e,t,1,1,s),i.tilesetPassState=A,e.updateEnvironment(),a.renderTranslucentDepthForPick=!0,u=o.pickDepthFramebuffer.update(r,t,s),e.updateAndExecuteCommands(u,G),e.resolveFramebuffers(u),r.endFrame()}B.prototype.pick=function(e,t,r,i){if(!(0,c.Z)(t))throw new l.Z("windowPosition is undefined.");W=(0,m.Z)(r,3),Y=(0,m.Z)(i,W);var a=e.context,o=a.uniformState,s=e.frameState,u=e.defaultView;e.view=u;var h=u.viewport;h.x=0,h.y=0,h.width=a.drawingBufferWidth,h.height=a.drawingBufferHeight;var d=u.passState;d.viewport=n.Z.clone(h,d.viewport);var p=P.Z.transformWindowToDrawingBuffer(e,t,X);e.jobScheduler.disableThisFrame(),e.updateFrameState(),s.cullingVolume=V(e,p,W,Y,h),s.invertClassification=!1,s.passes.pick=!0,s.tilesetPassState=A,o.update(s),e.updateEnvironment(),U.x=p.x-.5*(W-1),U.y=e.drawingBufferHeight-p.y-.5*(Y-1),U.width=W,U.height=Y,d=u.pickFramebuffer.begin(U,u.viewport),e.updateAndExecuteCommands(d,G),e.resolveFramebuffers(d);var f=u.pickFramebuffer.end(U);return a.endFrame(),f};var J=new _.Z,K=new Z.Z,$=new p.Z,ee=new f.Z;B.prototype.pickPositionWorldCoordinates=function(e,t,r){if(e.useDepthPicking){if(!(0,c.Z)(t))throw new l.Z("windowPosition is undefined.");if(!e.context.depthTexture)throw new l.Z("Picking from the depth buffer is not supported. Check pickPositionSupported.");var i=t.toString();if(this._pickPositionCacheDirty)this._pickPositionCache={},this._pickPositionCacheDirty=!1;else if(this._pickPositionCache.hasOwnProperty(i))return o.Z.clone(this._pickPositionCache[i],r);var n=e.frameState,a=e.context,s=a.uniformState,u=e.defaultView;e.view=u;var h=P.Z.transformWindowToDrawingBuffer(e,t,X);e.pickTranslucentDepth?Q(e,h):(e.updateFrameState(),s.update(n),e.updateEnvironment()),h.y=e.drawingBufferHeight-h.y;var m,d=e.camera;m=(0,c.Z)(d.frustum.fov)?d.frustum.clone(J):(0,c.Z)(d.frustum.infiniteProjectionMatrix)?d.frustum.clone(K):(0,c.Z)(d.frustum.width)?d.frustum.clone($):d.frustum.clone(ee);for(var p=u.frustumCommandsList,f=p.length,_=0;_<f;++_){var Z=this.getPickDepth(e,_),g=Z.getDepth(a,h.x,h.y);if((0,c.Z)(g)&&(g>0&&g<1)){var v,x=p[_];return e.mode===D.Z.SCENE2D?(v=d.position.z,d.position.z=v-x.near+1,m.far=Math.max(1,x.far-x.near),m.near=1,s.update(n),s.updateFrustum(m)):(m.near=x.near*(0!==_?e.opaqueFrustumNearOffset:1),m.far=x.far,s.updateFrustum(m)),r=P.Z.drawingBufferToWgs84Coordinates(e,h,g,r),e.mode===D.Z.SCENE2D&&(d.position.z=v,s.update(n)),this._pickPositionCache[i]=o.Z.clone(r),r}}this._pickPositionCache[i]=void 0}};var te=new s.Z;function re(e,t){var r,i,n=[],a=[],o=[],s=[];(0,c.Z)(e)||(e=Number.MAX_VALUE);var u=t();while((0,c.Z)(u)){var h=u.object,m=u.position,l=u.exclude;if((0,c.Z)(m)&&!(0,c.Z)(h)){n.push(u);break}if(!(0,c.Z)(h)||!(0,c.Z)(h.primitive))break;if(!l&&(n.push(u),0>=--e))break;var d=h.primitive,p=!1;"function"===typeof d.getGeometryInstanceAttributes&&(0,c.Z)(h.id)&&(i=d.getGeometryInstanceAttributes(h.id),(0,c.Z)(i)&&(0,c.Z)(i.show)&&(p=!0,i.show=v.Z.toValue(!1,i.show),o.push(i))),h instanceof y.Z&&(p=!0,h.show=!1,s.push(h)),p||(d.show=!1,a.push(d)),u=t()}for(r=0;r<a.length;++r)a[r].show=!0;for(r=0;r<o.length;++r)i=o[r],i.show=v.Z.toValue(!0,i.show);for(r=0;r<s.length;++r)s[r].show=!0;return n}B.prototype.pickPosition=function(e,t,r){if(r=this.pickPositionWorldCoordinates(e,t,r),(0,c.Z)(r)&&e.mode!==D.Z.SCENE3D){o.Z.fromElements(r.y,r.z,r.x,r);var i=e.mapProjection,n=i.ellipsoid,a=i.unproject(r,te);n.cartographicToCartesian(a,r)}return r},B.prototype.drillPick=function(e,t,r,i,n){var a=this,o=function(){var r=a.pick(e,t,i,n);if((0,c.Z)(r))return{object:r,position:void 0,exclude:!1}},s=re(r,o);return s.map((function(e){return e.object}))};var ie=new o.Z,ne=new o.Z;function ae(e,t,r){this.ray=e,this.width=t,this.tilesets=r,this.ready=!1,this.deferred=x.Z.defer(),this.promise=this.deferred.promise}function oe(e,t,r,i){var n=t.direction,a=o.Z.mostOrthogonalAxis(n,ie),s=o.Z.cross(n,a,ie),u=o.Z.cross(n,s,ne);return i.position=t.origin,i.direction=n,i.up=u,i.right=s,i.frustum.width=(0,m.Z)(r,M),i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC)}function se(e,t,r){var i=t.frameState,n=r.ray,a=r.width,o=r.tilesets,s=e._pickOffscreenView.camera,u=oe(e,n,a,s),h=F;h.camera=s,h.cullingVolume=u;for(var m=!0,c=o.length,l=0;l<c;++l){var d=o[l];d.show&&t.primitives.contains(d)&&(d.updateForPass(i,h),m=m&&h.ready)}return m&&r.deferred.resolve(),m}function ue(e,t,r){for(var i=e.length,n=0;n<i;++n){var a=e.get(n);a.show&&((0,c.Z)(a.isCesium3DTileset)?(0,c.Z)(t)&&-1!==t.indexOf(a)||r.push(a):a instanceof b.Z&&ue(a,t,r))}}function he(e,t,r,i,n,a){var o=[];if(ue(t.primitives,i,o),0===o.length)return x.Z.resolve(a());var s=new ae(r,n,o);return e._mostDetailedRayPicks.push(s),s.promise.then((function(){return a()}))}function me(e,t){return!(!(0,c.Z)(e)||!(0,c.Z)(t)||0===t.length)&&(t.indexOf(e)>-1||t.indexOf(e.primitive)>-1||t.indexOf(e.id)>-1)}function ce(e,t,r,i,a,o,s){var u=t.context,h=u.uniformState,m=t.frameState,l=e._pickOffscreenView;t.view=l,oe(e,r,a,l.camera),U=n.Z.clone(l.viewport,U);var d,p=l.pickFramebuffer.begin(U,l.viewport);t.jobScheduler.disableThisFrame(),t.updateFrameState(),m.invertClassification=!1,m.passes.pick=!0,m.passes.offscreen=!0,m.tilesetPassState=s?E:A,h.update(m),t.updateEnvironment(),t.updateAndExecuteCommands(p,G),t.resolveFramebuffers(p);var f=l.pickFramebuffer.end(U);if(t.context.depthTexture)for(var _=l.frustumCommandsList.length,Z=0;Z<_;++Z){var v=e.getPickDepth(t,Z),x=v.getDepth(u,0,0);if((0,c.Z)(x)&&(x>0&&x<1)){var w=l.frustumCommandsList[Z],y=w.near*(0!==Z?t.opaqueFrustumNearOffset:1),C=w.far,S=y+x*(C-y);d=g.Z.getPoint(r,S);break}}if(t.view=t.defaultView,u.endFrame(),(0,c.Z)(f)||(0,c.Z)(d))return{object:f,position:d,exclude:!(0,c.Z)(d)&&o||me(f,i)}}function le(e,t,r,i,n,a,o,s){var u=function(){return ce(e,t,r,n,a,o,s)};return re(i,u)}function de(e,t,r,i,n,a,o){var s=le(e,t,r,1,i,n,a,o);if(s.length>0)return s[0]}function pe(e,t,r,i,n,a,o,s){return le(e,t,r,i,n,a,o,s)}function fe(e,t){var r=x.Z.defer();return t.then((function(t){var i=e.postRender.addEventListener((function(){r.resolve(t),i()}));e.requestRender()})).otherwise((function(e){r.reject(e)})),r.promise}B.prototype.updateMostDetailedRayPicks=function(e){for(var t=this._mostDetailedRayPicks,r=0;r<t.length;++r)se(this,e,t[r])&&t.splice(r--,1)},B.prototype.pickFromRay=function(e,t,r,i){if(u.Z.defined("ray",t),e.mode!==D.Z.SCENE3D)throw new l.Z("Ray intersections are only supported in 3D mode.");return de(this,e,t,r,i,!1,!1)},B.prototype.drillPickFromRay=function(e,t,r,i,n){if(u.Z.defined("ray",t),e.mode!==D.Z.SCENE3D)throw new l.Z("Ray intersections are only supported in 3D mode.");return pe(this,e,t,r,i,n,!1,!1)},B.prototype.pickFromRayMostDetailed=function(e,t,r,i){if(u.Z.defined("ray",t),e.mode!==D.Z.SCENE3D)throw new l.Z("Ray intersections are only supported in 3D mode.");var n=this;return t=g.Z.clone(t),r=(0,c.Z)(r)?r.slice():r,fe(e,he(n,e,t,r,i,(function(){return de(n,e,t,r,i,!1,!0)})))},B.prototype.drillPickFromRayMostDetailed=function(e,t,r,i,n){if(u.Z.defined("ray",t),e.mode!==D.Z.SCENE3D)throw new l.Z("Ray intersections are only supported in 3D mode.");var a=this;return t=g.Z.clone(t),i=(0,c.Z)(i)?i.slice():i,fe(e,he(a,e,t,i,n,(function(){return pe(a,e,t,r,i,n,!1,!0)})))};var _e=new o.Z,Ze=new o.Z,ge=new g.Z,ve=new s.Z;function xe(e,t){var r=e.globe,n=(0,c.Z)(r)?r.ellipsoid:e.mapProjection.ellipsoid,a=i.Z._defaultMaxTerrainHeight,u=n.geodeticSurfaceNormalCartographic(t,Ze),h=s.Z.toCartesian(t,n,_e),m=ge;m.origin=h,m.direction=u;var l=new g.Z;return g.Z.getPoint(m,a,l.origin),o.Z.negate(u,l.direction),l}function we(e,t){var r=e.globe,i=(0,c.Z)(r)?r.ellipsoid:e.mapProjection.ellipsoid,n=s.Z.fromCartesian(t,i,ve);return xe(e,n)}function ye(e,t){var r=e.globe,i=(0,c.Z)(r)?r.ellipsoid:e.mapProjection.ellipsoid,n=s.Z.fromCartesian(t,i,ve);return n.height}function Ce(e,t,r,i,n){var a=xe(t,r);return he(e,t,a,i,n,(function(){var r=de(e,t,a,i,n,!0,!0);if((0,c.Z)(r))return ye(t,r.position)}))}function Se(e,t,r,i,n,a){var s=we(t,r);return he(e,t,s,i,n,(function(){var r=de(e,t,s,i,n,!0,!0);if((0,c.Z)(r))return o.Z.clone(r.position,a)}))}B.prototype.sampleHeight=function(e,t,r,i){if(u.Z.defined("position",t),e.mode!==D.Z.SCENE3D)throw new l.Z("sampleHeight is only supported in 3D mode.");if(!e.sampleHeightSupported)throw new l.Z("sampleHeight requires depth texture support. Check sampleHeightSupported.");var n=xe(e,t),a=de(this,e,n,r,i,!0,!1);if((0,c.Z)(a))return ye(e,a.position)},B.prototype.clampToHeight=function(e,t,r,i,n){if(u.Z.defined("cartesian",t),e.mode!==D.Z.SCENE3D)throw new l.Z("clampToHeight is only supported in 3D mode.");if(!e.clampToHeightSupported)throw new l.Z("clampToHeight requires depth texture support. Check clampToHeightSupported.");var a=we(e,t),s=de(this,e,a,r,i,!0,!1);if((0,c.Z)(s))return o.Z.clone(s.position,n)},B.prototype.sampleHeightMostDetailed=function(e,t,r,i){if(u.Z.defined("positions",t),e.mode!==D.Z.SCENE3D)throw new l.Z("sampleHeightMostDetailed is only supported in 3D mode.");if(!e.sampleHeightSupported)throw new l.Z("sampleHeightMostDetailed requires depth texture support. Check sampleHeightSupported.");r=(0,c.Z)(r)?r.slice():r;for(var n=t.length,a=new Array(n),o=0;o<n;++o)a[o]=Ce(this,e,t[o],r,i);return fe(e,x.Z.all(a).then((function(e){for(var r=e.length,i=0;i<r;++i)t[i].height=e[i];return t})))},B.prototype.clampToHeightMostDetailed=function(e,t,r,i){if(u.Z.defined("cartesians",t),e.mode!==D.Z.SCENE3D)throw new l.Z("clampToHeightMostDetailed is only supported in 3D mode.");if(!e.clampToHeightSupported)throw new l.Z("clampToHeightMostDetailed requires depth texture support. Check clampToHeightSupported.");r=(0,c.Z)(r)?r.slice():r;for(var n=t.length,a=new Array(n),o=0;o<n;++o)a[o]=Se(this,e,t[o],r,i,t[o]);return fe(e,x.Z.all(a).then((function(e){for(var r=e.length,i=0;i<r;++i)t[i]=e[i];return t})))},B.prototype.destroy=function(){this._pickOffscreenView=this._pickOffscreenView&&this._pickOffscreenView.destroy()},t["Z"]=B}}]);
//# sourceMappingURL=chunk-vendors-84c5bd6d-legacy.5adcda75.js.map