"use strict";(self["webpackChunkvue3_webpack5"]=self["webpackChunkvue3_webpack5"]||[]).push([[7640],{15508:function(e,t,r){var n=r(68591),i=r(48243),o=r(60216),a=r(63367),s=r(66553),d=r(83856),l=r(59947),c=r(8182),u=r(84828),_=r(62200),h=r(82982),p=r(86511),m=r(12540),f=r(99417),g=r(72248),Z=r(27671),y=r(91473),S=r(97264),v=r(9407),b=r(95555),T=r(99095),E=r(58597),C=r(60072),I=r(8379),A=r(10667),D=r(46588),P=r(18192),O=r(13222),L=r(13633),N=r(84020),w=r(79553),B=r(8056),x=r(11013),z=r(84167),R=r(89917),M=r(34125),G=r(87233),U={NEEDS_DECODE:0,DECODING:1,READY:2,FAILED:3};function F(e){s.Z.typeOf.object("options",e),s.Z.typeOf.object("options.arrayBuffer",e.arrayBuffer),this._parsedContent=void 0,this._drawCommand=void 0,this._isTranslucent=!1,this._styleTranslucent=!1,this._constantColor=l.Z.clone(l.Z.DARKGRAY),this._highlightColor=l.Z.clone(l.Z.WHITE),this._pointSize=1,this._rtcCenter=void 0,this._quantizedVolumeScale=void 0,this._quantizedVolumeOffset=void 0,this._styleableShaderAttributes=void 0,this._isQuantized=!1,this._isOctEncoded16P=!1,this._isRGB565=!1,this._hasColors=!1,this._hasNormals=!1,this._hasBatchIds=!1,this._decodingState=U.READY,this._dequantizeInShader=!0,this._isQuantizedDraco=!1,this._isOctEncodedDraco=!1,this._quantizedRange=0,this._octEncodedRange=0,this.backFaceCulling=!1,this._backFaceCulling=!1,this.normalShading=!0,this._normalShading=!0,this._opaqueRenderState=void 0,this._translucentRenderState=void 0,this._mode=void 0,this._ready=!1,this._readyPromise=O.Z.defer(),this._pointsLength=0,this._geometryByteLength=0,this._vertexShaderLoaded=e.vertexShaderLoaded,this._fragmentShaderLoaded=e.fragmentShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._batchTableLoaded=e.batchTableLoaded,this._pickIdLoaded=e.pickIdLoaded,this._opaquePass=(0,_.Z)(e.opaquePass,I.Z.OPAQUE),this._cull=(0,_.Z)(e.cull,!0),this.style=void 0,this._style=void 0,this.styleDirty=!1,this.modelMatrix=g.Z.clone(g.Z.IDENTITY),this._modelMatrix=g.Z.clone(g.Z.IDENTITY),this.time=0,this.shadows=M.Z.ENABLED,this._boundingSphere=void 0,this.clippingPlanes=void 0,this.isClipped=!1,this.clippingPlanesDirty=!1,this.clippingPlanesOriginMatrix=void 0,this.attenuation=!1,this._attenuation=!1,this.geometricError=0,this.geometricErrorScale=1,this.maximumAttenuation=this._pointSize,q(this,e)}Object.defineProperties(F.prototype,{pointsLength:{get:function(){return this._pointsLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},color:{get:function(){return l.Z.clone(this._highlightColor)},set:function(e){this._highlightColor=l.Z.clone(e,this._highlightColor)}},boundingSphere:{get:function(){if((0,h.Z)(this._drawCommand))return this._drawCommand.boundingVolume},set:function(e){this._boundingSphere=i.Z.clone(e,this._boundingSphere)}}});var k=Uint32Array.BYTES_PER_ELEMENT;function q(e,t){var r=t.arrayBuffer,i=(0,_.Z)(t.byteOffset,0),a=new Uint8Array(r),s=new DataView(r);i+=k;var d=s.getUint32(i,!0);if(1!==d)throw new v.Z("Only Point Cloud tile version 1 is supported.  Version "+d+" is not.");i+=k,i+=k;var p=s.getUint32(i,!0);if(0===p)throw new v.Z("Feature table must have a byte length greater than zero");i+=k;var f=s.getUint32(i,!0);i+=k;var g=s.getUint32(i,!0);i+=k;var Z=s.getUint32(i,!0);i+=k;var y=(0,m.Z)(a,i,p);i+=p;var S,b,T=new Uint8Array(r,i,f);i+=f,g>0&&(S=(0,m.Z)(a,i,g),i+=g,Z>0&&(b=new Uint8Array(r,i,Z),i+=Z));var E=new w.Z(y,T),C=E.getGlobalProperty("POINTS_LENGTH");if(E.featuresLength=C,!(0,h.Z)(C))throw new v.Z("Feature table global property: POINTS_LENGTH must be defined");var I,A,D,P,O=E.getGlobalProperty("RTC_CENTER",u.Z.FLOAT,3);(0,h.Z)(O)&&(e._rtcCenter=o.Z.unpack(O));var L,B,x,z,R,M=!1,G=!1,F=!1,q=!1,V=!1,H=!1,Y=!1,Q=!1,W=(0,h.Z)(y.extensions)?y.extensions["3DTILES_draco_point_compression"]:void 0,j=(0,h.Z)(S)&&(0,h.Z)(S.extensions)?S.extensions["3DTILES_draco_point_compression"]:void 0;if((0,h.Z)(j)&&(x=j.properties),(0,h.Z)(W)){B=W.properties;var K=W.byteOffset,X=W.byteLength;if(!(0,h.Z)(B)||!(0,h.Z)(K)||!(0,h.Z)(X))throw new v.Z("Draco properties, byteOffset, and byteLength must be defined");L=(0,n.Z)(T,K,K+X),M=(0,h.Z)(B.POSITION),G=(0,h.Z)(B.RGB)||(0,h.Z)(B.RGBA),F=(0,h.Z)(B.NORMAL),q=(0,h.Z)(B.BATCH_ID),H=(0,h.Z)(B.RGBA),e._decodingState=U.NEEDS_DECODE}if((0,h.Z)(L)&&(z={buffer:L,featureTableProperties:B,batchTableProperties:x,properties:(0,c.Z)(B,x),dequantizeInShader:e._dequantizeInShader}),!M)if((0,h.Z)(y.POSITION))I=E.getPropertyArray("POSITION",u.Z.FLOAT,3),M=!0;else if((0,h.Z)(y.POSITION_QUANTIZED)){I=E.getPropertyArray("POSITION_QUANTIZED",u.Z.UNSIGNED_SHORT,3),V=!0,M=!0;var J=E.getGlobalProperty("QUANTIZED_VOLUME_SCALE",u.Z.FLOAT,3);if(!(0,h.Z)(J))throw new v.Z("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");e._quantizedVolumeScale=o.Z.unpack(J),e._quantizedRange=65535;var $=E.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",u.Z.FLOAT,3);if(!(0,h.Z)($))throw new v.Z("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");e._quantizedVolumeOffset=o.Z.unpack($)}if(G||((0,h.Z)(y.RGBA)?(A=E.getPropertyArray("RGBA",u.Z.UNSIGNED_BYTE,4),H=!0,G=!0):(0,h.Z)(y.RGB)?(A=E.getPropertyArray("RGB",u.Z.UNSIGNED_BYTE,3),G=!0):(0,h.Z)(y.RGB565)&&(A=E.getPropertyArray("RGB565",u.Z.UNSIGNED_SHORT,1),Y=!0,G=!0)),F||((0,h.Z)(y.NORMAL)?(D=E.getPropertyArray("NORMAL",u.Z.FLOAT,3),F=!0):(0,h.Z)(y.NORMAL_OCT16P)&&(D=E.getPropertyArray("NORMAL_OCT16P",u.Z.UNSIGNED_BYTE,2),Q=!0,F=!0)),q||(0,h.Z)(y.BATCH_ID)&&(P=E.getPropertyArray("BATCH_ID",u.Z.UNSIGNED_SHORT,1),q=!0),!M)throw new v.Z("Either POSITION or POSITION_QUANTIZED must be defined.");if((0,h.Z)(y.CONSTANT_RGBA)){var ee=E.getGlobalProperty("CONSTANT_RGBA",u.Z.UNSIGNED_BYTE,4);e._constantColor=l.Z.fromBytes(ee[0],ee[1],ee[2],ee[3],e._constantColor)}if(q){var te=E.getGlobalProperty("BATCH_LENGTH");if(!(0,h.Z)(te))throw new v.Z("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");(0,h.Z)(b)&&(b=new Uint8Array(b)),(0,h.Z)(e._batchTableLoaded)&&e._batchTableLoaded(te,S,b)}!q&&(0,h.Z)(b)&&(R=N.Z.getBinaryProperties(C,S,b)),e._parsedContent={positions:I,colors:A,normals:D,batchIds:P,styleableProperties:R,draco:z},e._pointsLength=C,e._isQuantized=V,e._isOctEncoded16P=Q,e._isRGB565=Y,e._isTranslucent=H,e._hasColors=G,e._hasNormals=F,e._hasBatchIds=q}var V,H=new o.Z,Y=new o.Z,Q=new o.Z;function W(e){if(!(0,h.Z)(V)){f.Z.setRandomNumberSeed(0),V=new Array(e);for(var t=0;t<e;++t)V[t]=f.Z.nextRandomNumber()}return V}function j(e){for(var t=20,r=e.length/3,n=Math.min(r,t),a=W(t),s=Number.MAX_VALUE,d=-Number.MAX_VALUE,l=o.Z.fromElements(s,s,s,H),c=o.Z.fromElements(d,d,d,Y),u=0;u<n;++u){var _=Math.floor(a[u]*r),h=o.Z.unpack(e,3*_,Q);o.Z.minimumByComponent(l,h,l),o.Z.maximumByComponent(c,h,c)}var p=i.Z.fromCornerPoints(l,c);return p.radius+=f.Z.EPSILON2,p}function K(e,t){var r=u.Z.fromTypedArray(e);return r===u.Z.INT||r===u.Z.UNSIGNED_INT||r===u.Z.DOUBLE?((0,Z.Z)("Cast pnts property to floats",'Point cloud property "'+t+'" will be casted to a float array because INT, UNSIGNED_INT, and DOUBLE are not valid WebGL vertex attribute types. Some precision may be lost.'),new Float32Array(e)):e}var X=new a.Z,J=new a.Z,$=new l.Z,ee=0,te=1,re=2,ne=3,ie=4,oe=new g.Z,ae=new g.Z;function se(e,t){var r,n,a=t.context,s=e._parsedContent,d=e._pointsLength,l=s.positions,c=s.colors,_=s.normals,p=s.batchIds,m=s.styleableProperties,f=(0,h.Z)(m),Z=e._isQuantized,y=e._isQuantizedDraco,v=e._isOctEncoded16P,b=e._isOctEncodedDraco,D=e._quantizedRange,O=e._octEncodedRange,N=e._isRGB565,w=e._isTranslucent,B=e._hasColors,x=e._hasNormals,z=e._hasBatchIds,R=[],M={};if(e._styleableShaderAttributes=M,f){var U=ie;for(var F in m)if(m.hasOwnProperty(F)){var k=m[F],q=K(k.typedArray,F);r=k.componentCount,n=u.Z.fromTypedArray(q);var V=T.Z.createVertexBuffer({context:a,typedArray:q,usage:E.Z.STATIC_DRAW});e._geometryByteLength+=V.sizeInBytes;var H={index:U,vertexBuffer:V,componentsPerAttribute:r,componentDatatype:n,normalize:!1,offsetInBytes:0,strideInBytes:0};R.push(H),M[F]={location:U,componentCount:r},++U}}var Y,Q,W,X=T.Z.createVertexBuffer({context:a,typedArray:l,usage:E.Z.STATIC_DRAW});e._geometryByteLength+=X.sizeInBytes,B&&(Y=T.Z.createVertexBuffer({context:a,typedArray:c,usage:E.Z.STATIC_DRAW}),e._geometryByteLength+=Y.sizeInBytes),x&&(Q=T.Z.createVertexBuffer({context:a,typedArray:_,usage:E.Z.STATIC_DRAW}),e._geometryByteLength+=Q.sizeInBytes),z&&(p=K(p,"batchIds"),W=T.Z.createVertexBuffer({context:a,typedArray:p,usage:E.Z.STATIC_DRAW}),e._geometryByteLength+=W.sizeInBytes);var J=[];if(n=Z?u.Z.UNSIGNED_SHORT:y?D<=255?u.Z.UNSIGNED_BYTE:u.Z.UNSIGNED_SHORT:u.Z.FLOAT,J.push({index:ee,vertexBuffer:X,componentsPerAttribute:3,componentDatatype:n,normalize:!1,offsetInBytes:0,strideInBytes:0}),e._cull&&(e._boundingSphere=Z||y?i.Z.fromCornerPoints(o.Z.ZERO,e._quantizedVolumeScale):j(l)),B)if(N)J.push({index:te,vertexBuffer:Y,componentsPerAttribute:1,componentDatatype:u.Z.UNSIGNED_SHORT,normalize:!1,offsetInBytes:0,strideInBytes:0});else{var $=w?4:3;J.push({index:te,vertexBuffer:Y,componentsPerAttribute:$,componentDatatype:u.Z.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0})}x&&(v?(r=2,n=u.Z.UNSIGNED_BYTE):b?(r=2,n=O<=255?u.Z.UNSIGNED_BYTE:u.Z.UNSIGNED_SHORT):(r=3,n=u.Z.FLOAT),J.push({index:re,vertexBuffer:Q,componentsPerAttribute:r,componentDatatype:n,normalize:!1,offsetInBytes:0,strideInBytes:0})),z&&J.push({index:ne,vertexBuffer:W,componentsPerAttribute:1,componentDatatype:u.Z.fromTypedArray(p),normalize:!1,offsetInBytes:0,strideInBytes:0}),f&&(J=J.concat(R));var oe=new P.Z({context:a,attributes:J}),ae={depthTest:{enabled:!0}},se={depthTest:{enabled:!0},depthMask:!1,blending:L.Z.ALPHA_BLEND};e._opaquePass===I.Z.CESIUM_3D_TILE&&(ae.stencilTest=G.Z.setCesium3DTileBit(),ae.stencilMask=G.Z.CESIUM_3D_TILE_MASK,se.stencilTest=G.Z.setCesium3DTileBit(),se.stencilMask=G.Z.CESIUM_3D_TILE_MASK),e._opaqueRenderState=A.Z.fromCache(ae),e._translucentRenderState=A.Z.fromCache(se),e._drawCommand=new C.Z({boundingVolume:new i.Z,cull:e._cull,modelMatrix:new g.Z,primitiveType:S.Z.POINTS,vertexArray:oe,count:d,shaderProgram:void 0,uniformMap:void 0,renderState:w?e._translucentRenderState:e._opaqueRenderState,pass:w?I.Z.TRANSLUCENT:e._opaquePass,owner:e,castShadows:!1,receiveShadows:!1,pickId:e._pickIdLoaded()})}function de(e,t){var r=t.context,n=e._isQuantized,i=e._isQuantizedDraco,a=e._isOctEncodedDraco,s={u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier:function(){var n=X;if(n.x=e._attenuation?e.maximumAttenuation:e._pointSize,n.x*=t.pixelRatio,n.y=e.time,e._attenuation){var i,o=t.camera.frustum;i=t.mode===R.Z.SCENE2D||o instanceof y.Z?Number.POSITIVE_INFINITY:r.drawingBufferHeight/t.camera.frustum.sseDenominator,n.z=e.geometricError*e.geometricErrorScale,n.w=i}return n},u_highlightColor:function(){return e._highlightColor},u_constantColor:function(){return e._constantColor},u_clippingPlanes:function(){var t=e.clippingPlanes,n=e.isClipped;return n?t.texture:r.defaultTexture},u_clippingPlanesEdgeStyle:function(){var t=e.clippingPlanes;if(!(0,h.Z)(t))return l.Z.TRANSPARENT;var r=l.Z.clone(t.edgeColor,$);return r.alpha=t.edgeWidth,r},u_clippingPlanesMatrix:function(){var t=e.clippingPlanes;if(!(0,h.Z)(t))return g.Z.IDENTITY;var n=(0,_.Z)(e.clippingPlanesOriginMatrix,e._modelMatrix);g.Z.multiply(r.uniformState.view3D,n,oe);var i=g.Z.multiply(oe,t.modelMatrix,oe);return g.Z.inverseTranspose(i,ae)}};(n||i||a)&&(s=(0,c.Z)(s,{u_quantizedVolumeScaleAndOctEncodedRange:function(){var t=J;if((0,h.Z)(e._quantizedVolumeScale)){var r=o.Z.clone(e._quantizedVolumeScale,t);o.Z.divideByScalar(r,e._quantizedRange,t)}return t.w=e._octEncodedRange,t}})),(0,h.Z)(e._uniformMapLoaded)&&(s=e._uniformMapLoaded(s)),e._drawCommand.uniformMap=s}function le(e,t){var r=/czm_3dtiles_property_(\d+)/g,n=r.exec(e);while(null!==n){var i=parseInt(n[1]);-1===t.indexOf(i)&&t.push(i),n=r.exec(e)}}function ce(e,t){e=e.slice(e.indexOf("\n"));var r=/czm_3dtiles_builtin_property_(\w+)/g,n=r.exec(e);while(null!==n){var i=n[1];-1===t.indexOf(i)&&t.push(i),n=r.exec(e)}}function ue(e,t){for(var r=e.numberOfAttributes,n=0;n<r;++n){var i=e.getAttribute(n);if(i.index===t)return i}}var _e={POSITION:"czm_3dtiles_builtin_property_POSITION",POSITION_ABSOLUTE:"czm_3dtiles_builtin_property_POSITION_ABSOLUTE",COLOR:"czm_3dtiles_builtin_property_COLOR",NORMAL:"czm_3dtiles_builtin_property_NORMAL"};function he(e,t,r){var n,i,o,a,s,l,c=t.context,u=(0,h.Z)(r),_=e._isQuantized,p=e._isQuantizedDraco,m=e._isOctEncoded16P,f=e._isOctEncodedDraco,g=e._isRGB565,Z=e._isTranslucent,y=e._hasColors,S=e._hasNormals,b=e._hasBatchIds,T=e._backFaceCulling,E=e._normalShading,C=e._drawCommand.vertexArray,I=e.clippingPlanes,A=e._attenuation,P=Z,O=(0,d.Z)(_e),L={},N=e._styleableShaderAttributes;for(i in N)N.hasOwnProperty(i)&&(o=N[i],O[i]="czm_3dtiles_property_"+o.location,L[o.location]=o);if(u){var w={translucent:!1},B="(vec3 czm_3dtiles_builtin_property_POSITION, vec3 czm_3dtiles_builtin_property_POSITION_ABSOLUTE, vec4 czm_3dtiles_builtin_property_COLOR, vec3 czm_3dtiles_builtin_property_NORMAL)";a=r.getColorShaderFunction("getColorFromStyle"+B,O,w),s=r.getShowShaderFunction("getShowFromStyle"+B,O,w),l=r.getPointSizeShaderFunction("getPointSizeFromStyle"+B,O,w),(0,h.Z)(a)&&w.translucent&&(P=!0)}e._styleTranslucent=P;var R=(0,h.Z)(a),M=(0,h.Z)(s),G=(0,h.Z)(l),U=e.isClipped,F=[],k=[];R&&(le(a,F),ce(a,k)),M&&(le(s,F),ce(s,k)),G&&(le(l,F),ce(l,k));var q=k.indexOf("COLOR")>=0,V=k.indexOf("NORMAL")>=0;if(V&&!S)throw new v.Z("Style references the NORMAL semantic but the point cloud does not have normals");for(i in N)if(N.hasOwnProperty(i)){o=N[i];var H=F.indexOf(o.location)>=0,Y=ue(C,o.location);Y.enabled=H}var Q=y&&(!R||q);if(y){var W=ue(C,te);W.enabled=Q}var j=S&&(E||T||V);if(S){var K=ue(C,re);K.enabled=j}var X={a_position:ee};Q&&(X.a_color=te),j&&(X.a_normal=re),b&&(X.a_batchId=ne);var J="",$=F.length;for(n=0;n<$;++n){var ie=F[n];o=L[ie];var oe,ae=o.componentCount,se="czm_3dtiles_property_"+ie;oe=1===ae?"float":"vec"+ae,J+="attribute "+oe+" "+se+"; \n",X[se]=o.location}de(e,t);var he="attribute vec3 a_position; \nvarying vec4 v_color; \nuniform vec4 u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier; \nuniform vec4 u_constantColor; \nuniform vec4 u_highlightColor; \n";he+="float u_pointSize; \nfloat u_time; \n",A&&(he+="float u_geometricError; \nfloat u_depthMultiplier; \n"),he+=J,Q&&(he+=Z?"attribute vec4 a_color; \n":g?"attribute float a_color; \nconst float SHIFT_RIGHT_11 = 1.0 / 2048.0; \nconst float SHIFT_RIGHT_5 = 1.0 / 32.0; \nconst float SHIFT_LEFT_11 = 2048.0; \nconst float SHIFT_LEFT_5 = 32.0; \nconst float NORMALIZE_6 = 1.0 / 64.0; \nconst float NORMALIZE_5 = 1.0 / 32.0; \n":"attribute vec3 a_color; \n"),j&&(he+=m||f?"attribute vec2 a_normal; \n":"attribute vec3 a_normal; \n"),b&&(he+="attribute float a_batchId; \n"),(_||p||f)&&(he+="uniform vec4 u_quantizedVolumeScaleAndOctEncodedRange; \n"),R&&(he+=a),M&&(he+=s),G&&(he+=l),he+="void main() \n{ \n    u_pointSize = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.x; \n    u_time = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.y; \n",A&&(he+="    u_geometricError = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.z; \n    u_depthMultiplier = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.w; \n"),he+=Q?Z?"    vec4 color = a_color; \n":g?"    float compressed = a_color; \n    float r = floor(compressed * SHIFT_RIGHT_11); \n    compressed -= r * SHIFT_LEFT_11; \n    float g = floor(compressed * SHIFT_RIGHT_5); \n    compressed -= g * SHIFT_LEFT_5; \n    float b = compressed; \n    vec3 rgb = vec3(r * NORMALIZE_5, g * NORMALIZE_6, b * NORMALIZE_5); \n    vec4 color = vec4(rgb, 1.0); \n":"    vec4 color = vec4(a_color, 1.0); \n":"    vec4 color = u_constantColor; \n",he+=_||p?"    vec3 position = a_position * u_quantizedVolumeScaleAndOctEncodedRange.xyz; \n":"    vec3 position = a_position; \n",he+="    vec3 position_absolute = vec3(czm_model * vec4(position, 1.0)); \n",j?(he+=m?"    vec3 normal = czm_octDecode(a_normal); \n":f?"    vec3 normal = czm_octDecode(a_normal, u_quantizedVolumeScaleAndOctEncodedRange.w).zxy; \n":"    vec3 normal = a_normal; \n",he+="    vec3 normalEC = czm_normal * normal; \n"):he+="    vec3 normal = vec3(1.0); \n",R&&(he+="    color = getColorFromStyle(position, position_absolute, color, normal); \n"),M&&(he+="    float show = float(getShowFromStyle(position, position_absolute, color, normal)); \n"),he+=G?"    gl_PointSize = getPointSizeFromStyle(position, position_absolute, color, normal) * czm_pixelRatio; \n":A?"    vec4 positionEC = czm_modelView * vec4(position, 1.0); \n    float depth = -positionEC.z; \n    gl_PointSize = min((u_geometricError / depth) * u_depthMultiplier, u_pointSize); \n":"    gl_PointSize = u_pointSize; \n",he+="    color = color * u_highlightColor; \n",j&&E&&(he+="    float diffuseStrength = czm_getLambertDiffuse(czm_lightDirectionEC, normalEC); \n    diffuseStrength = max(diffuseStrength, 0.4); \n    color.xyz *= diffuseStrength * czm_lightColor; \n"),he+="    v_color = color; \n    gl_Position = czm_modelViewProjection * vec4(position, 1.0); \n",j&&T&&(he+="    float visible = step(-normalEC.z, 0.0); \n    gl_Position *= visible; \n    gl_PointSize *= visible; \n"),M&&(he+="    gl_Position.w *= float(show); \n    gl_PointSize *= float(show); \n"),he+="} \n";var pe="varying vec4 v_color; \n";U&&(pe+="uniform highp sampler2D u_clippingPlanes; \nuniform mat4 u_clippingPlanesMatrix; \nuniform vec4 u_clippingPlanesEdgeStyle; \n",pe+="\n",pe+=(0,z.Z)(I,c),pe+="\n"),pe+="void main() \n{ \n    gl_FragColor = czm_gammaCorrect(v_color); \n",U&&(pe+=(0,x.Z)("u_clippingPlanes","u_clippingPlanesMatrix","u_clippingPlanesEdgeStyle")),pe+="} \n",(0,h.Z)(e._vertexShaderLoaded)&&(he=e._vertexShaderLoaded(he)),(0,h.Z)(e._fragmentShaderLoaded)&&(pe=e._fragmentShaderLoaded(pe));var me=e._drawCommand;(0,h.Z)(me.shaderProgram)&&me.shaderProgram.destroy(),me.shaderProgram=D.Z.fromCache({context:c,vertexShaderSource:he,fragmentShaderSource:pe,attributeLocations:X});try{me.shaderProgram._bind()}catch(fe){throw new v.Z("Error generating style shader: this may be caused by a type mismatch, index out-of-bounds, or other syntax error.")}}function pe(e,t){if(e._decodingState===U.READY)return!1;if(e._decodingState===U.NEEDS_DECODE){var r=e._parsedContent,n=r.draco,i=B.Z.decodePointCloud(n,t);(0,h.Z)(i)&&(e._decodingState=U.DECODING,i.then((function(t){e._decodingState=U.READY;var i=(0,h.Z)(t.POSITION)?t.POSITION.array:void 0,a=(0,h.Z)(t.RGB)?t.RGB.array:void 0,s=(0,h.Z)(t.RGBA)?t.RGBA.array:void 0,d=(0,h.Z)(t.NORMAL)?t.NORMAL.array:void 0,l=(0,h.Z)(t.BATCH_ID)?t.BATCH_ID.array:void 0,c=(0,h.Z)(i)&&(0,h.Z)(t.POSITION.data.quantization),u=(0,h.Z)(d)&&(0,h.Z)(t.NORMAL.data.quantization);if(c){var p=t.POSITION.data.quantization,m=p.range;e._quantizedVolumeScale=o.Z.fromElements(m,m,m),e._quantizedVolumeOffset=o.Z.unpack(p.minValues),e._quantizedRange=(1<<p.quantizationBits)-1,e._isQuantizedDraco=!0}u&&(e._octEncodedRange=(1<<t.NORMAL.data.quantization.quantizationBits)-1,e._isOctEncodedDraco=!0);var f=r.styleableProperties,g=n.batchTableProperties;for(var Z in g)if(g.hasOwnProperty(Z)){var y=t[Z];(0,h.Z)(f)||(f={}),f[Z]={typedArray:y.array,componentCount:y.data.componentsPerAttribute}}r.positions=(0,_.Z)(i,r.positions),r.colors=(0,_.Z)((0,_.Z)(s,a),r.colors),r.normals=(0,_.Z)(d,r.normals),r.batchIds=(0,_.Z)(l,r.batchIds),r.styleableProperties=f})).otherwise((function(t){e._decodingState=U.FAILED,e._readyPromise.reject(t)})))}return!0}var me=new a.Z,fe=new o.Z;F.prototype.update=function(e){var t=e.context,r=pe(this,t);if(!r){var n=!1,s=!g.Z.equals(this._modelMatrix,this.modelMatrix);if(this._mode!==e.mode&&(this._mode=e.mode,s=!0),(0,h.Z)(this._drawCommand)||(se(this,e),s=!0,n=!0,this._ready=!0,this._readyPromise.resolve(this),this._parsedContent=void 0),s){g.Z.clone(this.modelMatrix,this._modelMatrix);var d=this._drawCommand.modelMatrix;if(g.Z.clone(this._modelMatrix,d),(0,h.Z)(this._rtcCenter)&&g.Z.multiplyByTranslation(d,this._rtcCenter,d),(0,h.Z)(this._quantizedVolumeOffset)&&g.Z.multiplyByTranslation(d,this._quantizedVolumeOffset,d),e.mode!==R.Z.SCENE3D){var l=e.mapProjection,c=g.Z.getColumn(d,3,me);a.Z.equals(c,a.Z.UNIT_W)||b.Z.basisTo2D(l,d,d)}var u=this._drawCommand.boundingVolume;if(i.Z.clone(this._boundingSphere,u),this._cull){var _=u.center;g.Z.multiplyByPoint(d,_,_);var p=g.Z.getScale(d,fe);u.radius*=o.Z.maximumComponent(p)}}this.clippingPlanesDirty&&(this.clippingPlanesDirty=!1,n=!0),this._attenuation!==this.attenuation&&(this._attenuation=this.attenuation,n=!0),this.backFaceCulling!==this._backFaceCulling&&(this._backFaceCulling=this.backFaceCulling,n=!0),this.normalShading!==this._normalShading&&(this._normalShading=this.normalShading,n=!0),(this._style!==this.style||this.styleDirty)&&(this._style=this.style,this.styleDirty=!1,n=!0),n&&he(this,e,this._style),this._drawCommand.castShadows=M.Z.castShadows(this.shadows),this._drawCommand.receiveShadows=M.Z.receiveShadows(this.shadows);var m=this._highlightColor.alpha<1||this._constantColor.alpha<1||this._styleTranslucent;this._drawCommand.renderState=m?this._translucentRenderState:this._opaqueRenderState,this._drawCommand.pass=m?I.Z.TRANSLUCENT:this._opaquePass;var f=e.commandList,Z=e.passes;(Z.render||Z.pick)&&f.push(this._drawCommand)}},F.prototype.isDestroyed=function(){return!1},F.prototype.destroy=function(){var e=this._drawCommand;return(0,h.Z)(e)&&(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy()),(0,p.Z)(this)},t["Z"]=F},8707:function(e,t,r){var n=r(59947),i=r(8182),o=r(62200),a=r(82982),s=r(86511),d=r(12572),l=r(99417),c=r(8379),u=r(84020),_=r(52381),h=r(36819),p=r(15508),m=r(45393),f=r(89917);function g(e,t,r,n,i){this._tileset=e,this._tile=t,this._resource=r,this._pickId=void 0,this._batchTable=void 0,this._styleDirty=!1,this._features=void 0,this.featurePropertiesDirty=!1,this._groupMetadata=void 0,this._pointCloud=new p.Z({arrayBuffer:n,byteOffset:i,cull:!1,opaquePass:c.Z.CESIUM_3D_TILE,vertexShaderLoaded:Z(this),fragmentShaderLoaded:y(this),uniformMapLoaded:S(this),batchTableLoaded:v(this),pickIdLoaded:b(this)})}function Z(e){return function(t){return(0,a.Z)(e._batchTable)?e._batchTable.getVertexShaderCallback(!1,"a_batchId",void 0)(t):t}}function y(e){return function(t){return(0,a.Z)(e._batchTable)?e._batchTable.getFragmentShaderCallback(!1,void 0,!1)(t):"uniform vec4 czm_pickColor;\n"+t}}function S(e){return function(t){return(0,a.Z)(e._batchTable)?e._batchTable.getUniformMapCallback()(t):(0,i.Z)(t,{czm_pickColor:function(){return e._pickId.color}})}}function v(e){return function(t,r,n){e._batchTable=new u.Z(e,t,r,n)}}function b(e){return function(){return(0,a.Z)(e._batchTable)?e._batchTable.getPickId():"czm_pickColor"}}function T(e){var t=e._tileset.pointCloudShading,r=e._tile.contentBoundingVolume.boundingSphere.volume(),n=l.Z.cbrt(r/e.pointsLength),i=e._tile.geometricError;return 0===i&&(i=(0,a.Z)(t)&&(0,a.Z)(t.baseResolution)?t.baseResolution:n),i}function E(e){var t=e.featuresLength;if(!(0,a.Z)(e._features)&&t>0){for(var r=new Array(t),n=0;n<t;++n)r[n]=new _.Z(e,n);e._features=r}}Object.defineProperties(g.prototype,{featuresLength:{get:function(){return(0,a.Z)(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return this._pointCloud.pointsLength}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return this._pointCloud.geometryByteLength}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return(0,a.Z)(this._batchTable)?this._batchTable.memorySizeInBytes:0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._pointCloud.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}},groupMetadata:{get:function(){return this._groupMetadata},set:function(e){this._groupMetadata=e}}}),g.prototype.hasProperty=function(e,t){return!!(0,a.Z)(this._batchTable)&&this._batchTable.hasProperty(e,t)},g.prototype.getFeature=function(e){if((0,a.Z)(this._batchTable)){var t=this.featuresLength;if(!(0,a.Z)(e)||e<0||e>=t)throw new d.Z("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return E(this),this._features[e]}},g.prototype.applyDebugSettings=function(e,t){this._pointCloud.color=e?t:n.Z.WHITE},g.prototype.applyStyle=function(e){(0,a.Z)(this._batchTable)?this._batchTable.applyStyle(e):this._styleDirty=!0};var C=new m.Z;g.prototype.update=function(e,t){var r,n=this._pointCloud,i=(0,o.Z)(e.pointCloudShading,C),s=this._tile,d=this._batchTable,l=t.mode,c=e.clippingPlanes;(0,a.Z)(this._pickId)||(0,a.Z)(d)||(this._pickId=t.context.createPickId({primitive:e,content:this})),(0,a.Z)(d)&&d.update(e,t),r=(0,a.Z)(s._contentBoundingVolume)?l===f.Z.SCENE3D?s._contentBoundingVolume.boundingSphere:s._contentBoundingVolume2D.boundingSphere:l===f.Z.SCENE3D?s._boundingVolume.boundingSphere:s._boundingVolume2D.boundingSphere;var u=this._styleDirty;this._styleDirty=!1,n.clippingPlanesOriginMatrix=e.clippingPlanesOriginMatrix,n.style=(0,a.Z)(d)?void 0:e.style,n.styleDirty=u,n.modelMatrix=s.computedTransform,n.time=e.timeSinceLoad,n.shadows=e.shadows,n.boundingSphere=r,n.clippingPlanes=c,n.isClipped=(0,a.Z)(c)&&c.enabled&&s._isClipped,n.clippingPlanesDirty=s.clippingPlanesDirty,n.attenuation=i.attenuation,n.backFaceCulling=i.backFaceCulling,n.normalShading=i.normalShading,n.geometricError=T(this),n.geometricErrorScale=i.geometricErrorScale,(0,a.Z)(i)&&(0,a.Z)(i.maximumAttenuation)?n.maximumAttenuation=i.maximumAttenuation:s.refine===h.Z.ADD?n.maximumAttenuation=5:n.maximumAttenuation=e.maximumScreenSpaceError,n.update(t)},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return this._pickId=this._pickId&&this._pickId.destroy(),this._pointCloud=this._pointCloud&&this._pointCloud.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),(0,s.Z)(this)},t["Z"]=g},29388:function(e,t,r){var n=r(60838),i=r(59947),o=r(82982),a=r(86511),s=r(38443),d=r(97264),l=r(39899),c=r(60072),u=r(2932),_=r(8379),h=r(21572),p=r(10667),m=r(87721),f=r(53642),g=r(8743),Z=r(13633),y=r(87233),S=r(43474);function v(){this._framebuffer=void 0,this._colorGBuffer=void 0,this._depthGBuffer=void 0,this._depthTexture=void 0,this._drawCommand=void 0,this._clearCommand=void 0,this._strength=1,this._radius=1}function b(e){var t=e._framebuffer;(0,o.Z)(t)&&(e._colorGBuffer.destroy(),e._depthGBuffer.destroy(),e._depthTexture.destroy(),t.destroy(),e._framebuffer=void 0,e._colorGBuffer=void 0,e._depthGBuffer=void 0,e._depthTexture=void 0,e._drawCommand=void 0,e._clearCommand=void 0)}function T(e,t){var r=t.drawingBufferWidth,n=t.drawingBufferHeight,i=new g.Z({context:t,width:r,height:n,pixelFormat:s.Z.RGBA,pixelDatatype:h.Z.UNSIGNED_BYTE,sampler:m.Z.NEAREST}),o=new g.Z({context:t,width:r,height:n,pixelFormat:s.Z.RGBA,pixelDatatype:h.Z.UNSIGNED_BYTE,sampler:m.Z.NEAREST}),a=new g.Z({context:t,width:r,height:n,pixelFormat:s.Z.DEPTH_COMPONENT,pixelDatatype:h.Z.UNSIGNED_INT,sampler:m.Z.NEAREST});e._framebuffer=new u.Z({context:t,colorTextures:[i,o],depthTexture:a,destroyAttachments:!1}),e._colorGBuffer=i,e._depthGBuffer=o,e._depthTexture=a}var E=new n.Z;function C(e,t){var r=new f.Z({defines:["LOG_DEPTH_WRITE"],sources:[S.Z]}),n={u_pointCloud_colorGBuffer:function(){return e._colorGBuffer},u_pointCloud_depthGBuffer:function(){return e._depthGBuffer},u_distanceAndEdlStrength:function(){return E.x=e._radius,E.y=e._strength,E}},o=p.Z.fromCache({blending:Z.Z.ALPHA_BLEND,depthMask:!0,depthTest:{enabled:!0},stencilTest:y.Z.setCesium3DTileBit(),stencilMask:y.Z.CESIUM_3D_TILE_MASK});e._drawCommand=t.createViewportQuadCommand(r,{uniformMap:n,renderState:o,pass:_.Z.CESIUM_3D_TILE,owner:e}),e._clearCommand=new l.Z({framebuffer:e._framebuffer,color:new i.Z(0,0,0,0),depth:1,renderState:p.Z.fromCache(),pass:_.Z.CESIUM_3D_TILE,owner:e})}function I(e,t){var r=t.drawingBufferWidth,n=t.drawingBufferHeight,i=e._colorGBuffer,a=!1,s=(0,o.Z)(i)&&(i.width!==r||i.height!==n);return(0,o.Z)(i)&&!s||(b(e),T(e,t),C(e,t),a=!0),a}function A(e){return e.drawBuffers&&e.fragmentDepth}function D(e,t){var r=e.shaderCache.getDerivedShaderProgram(t,"EC");if(!(0,o.Z)(r)){var n=t._attributeLocations,i=t.fragmentShaderSource.clone();i.sources=i.sources.map((function(e){return e=f.Z.replaceMain(e,"czm_point_cloud_post_process_main"),e=e.replace(/gl_FragColor/g,"gl_FragData[0]"),e})),i.sources.unshift("#extension GL_EXT_draw_buffers : enable \n"),i.sources.push("void main() \n{ \n    czm_point_cloud_post_process_main(); \n#ifdef LOG_DEPTH\n    czm_writeLogDepth();\n    gl_FragData[1] = czm_packDepth(gl_FragDepthEXT); \n#else\n    gl_FragData[1] = czm_packDepth(gl_FragCoord.z);\n#endif\n}"),r=e.shaderCache.createDerivedShaderProgram(t,"EC",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:i,attributeLocations:n})}return r}v.isSupported=A,v.prototype.update=function(e,t,r,n){if(A(e.context)){this._strength=r.eyeDomeLightingStrength,this._radius=r.eyeDomeLightingRadius*e.pixelRatio;var i,a,s,l=I(this,e.context),u=e.commandList,h=u.length;for(i=t;i<h;++i){var p=u[i];if(p.primitiveType===d.Z.POINTS&&p.pass!==_.Z.TRANSLUCENT){a=void 0,s=void 0;var m=p.derivedCommands.pointCloudProcessor;(0,o.Z)(m)&&(a=m.command,s=m.originalShaderProgram),(!(0,o.Z)(a)||p.dirty||l||s!==p.shaderProgram||a.framebuffer!==this._framebuffer)&&(a=c.Z.shallowClone(p,a),a.framebuffer=this._framebuffer,a.shaderProgram=D(e.context,p.shaderProgram),a.castShadows=!1,a.receiveShadows=!1,(0,o.Z)(m)||(m={command:a,originalShaderProgram:p.shaderProgram},p.derivedCommands.pointCloudProcessor=m),m.originalShaderProgram=p.shaderProgram),u[i]=a}}var f=this._clearCommand,g=this._drawCommand;g.boundingVolume=n,u.push(g),u.push(f)}},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){return b(this),(0,a.Z)(this)},t["Z"]=v},45393:function(e,t,r){var n=r(62200),i=r(29388);function o(e){var t=(0,n.Z)(e,{});this.attenuation=(0,n.Z)(t.attenuation,!1),this.geometricErrorScale=(0,n.Z)(t.geometricErrorScale,1),this.maximumAttenuation=t.maximumAttenuation,this.baseResolution=t.baseResolution,this.eyeDomeLighting=(0,n.Z)(t.eyeDomeLighting,!0),this.eyeDomeLightingStrength=(0,n.Z)(t.eyeDomeLightingStrength,1),this.eyeDomeLightingRadius=(0,n.Z)(t.eyeDomeLightingRadius,1),this.backFaceCulling=(0,n.Z)(t.backFaceCulling,!1),this.normalShading=(0,n.Z)(t.normalShading,!0)}o.isSupported=function(e){return i.Z.isSupported(e.context)},t["Z"]=o}}]);
//# sourceMappingURL=chunk-vendors-9f950757-legacy.754e0f0a.js.map