(function(){var t={9662:function(t,e,n){var r=n(614),o=n(6330),a=TypeError;t.exports=function(t){if(r(t))return t;throw a(o(t)+" is not a function")}},9670:function(t,e,n){var r=n(111),o=String,a=TypeError;t.exports=function(t){if(r(t))return t;throw a(o(t)+" is not an object")}},1318:function(t,e,n){var r=n(5656),o=n(1400),a=n(6244),i=function(t){return function(e,n,i){var s,c=r(e),u=a(c),f=o(i,u);if(t&&n!=n){while(u>f)if(s=c[f++],s!=s)return!0}else for(;u>f;f++)if((t||f in c)&&c[f]===n)return t||f||0;return!t&&-1}};t.exports={includes:i(!0),indexOf:i(!1)}},3658:function(t,e,n){"use strict";var r=n(9781),o=n(3157),a=TypeError,i=Object.getOwnPropertyDescriptor,s=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=s?function(t,e){if(o(t)&&!i(t,"length").writable)throw a("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},4326:function(t,e,n){var r=n(1702),o=r({}.toString),a=r("".slice);t.exports=function(t){return a(o(t),8,-1)}},9920:function(t,e,n){var r=n(2597),o=n(3887),a=n(1236),i=n(3070);t.exports=function(t,e,n){for(var s=o(e),c=i.f,u=a.f,f=0;f<s.length;f++){var p=s[f];r(t,p)||n&&r(n,p)||c(t,p,u(e,p))}}},8880:function(t,e,n){var r=n(9781),o=n(3070),a=n(9114);t.exports=r?function(t,e,n){return o.f(t,e,a(1,n))}:function(t,e,n){return t[e]=n,t}},9114:function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},8052:function(t,e,n){var r=n(614),o=n(3070),a=n(6339),i=n(3072);t.exports=function(t,e,n,s){s||(s={});var c=s.enumerable,u=void 0!==s.name?s.name:e;if(r(n)&&a(n,u,s),s.global)c?t[e]=n:i(e,n);else{try{s.unsafe?t[e]&&(c=!0):delete t[e]}catch(f){}c?t[e]=n:o.f(t,e,{value:n,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return t}},3072:function(t,e,n){var r=n(7854),o=Object.defineProperty;t.exports=function(t,e){try{o(r,t,{value:e,configurable:!0,writable:!0})}catch(n){r[t]=e}return e}},9781:function(t,e,n){var r=n(7293);t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4154:function(t){var e="object"==typeof document&&document.all,n="undefined"==typeof e&&void 0!==e;t.exports={all:e,IS_HTMLDDA:n}},317:function(t,e,n){var r=n(7854),o=n(111),a=r.document,i=o(a)&&o(a.createElement);t.exports=function(t){return i?a.createElement(t):{}}},7207:function(t){var e=TypeError,n=9007199254740991;t.exports=function(t){if(t>n)throw e("Maximum allowed index exceeded");return t}},8113:function(t){t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},7392:function(t,e,n){var r,o,a=n(7854),i=n(8113),s=a.process,c=a.Deno,u=s&&s.versions||c&&c.version,f=u&&u.v8;f&&(r=f.split("."),o=r[0]>0&&r[0]<4?1:+(r[0]+r[1])),!o&&i&&(r=i.match(/Edge\/(\d+)/),(!r||r[1]>=74)&&(r=i.match(/Chrome\/(\d+)/),r&&(o=+r[1]))),t.exports=o},748:function(t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:function(t,e,n){var r=n(7854),o=n(1236).f,a=n(8880),i=n(8052),s=n(3072),c=n(9920),u=n(4705);t.exports=function(t,e){var n,f,p,l,d,m,h=t.target,v=t.global,g=t.stat;if(f=v?r:g?r[h]||s(h,{}):(r[h]||{}).prototype,f)for(p in e){if(d=e[p],t.dontCallGetSet?(m=o(f,p),l=m&&m.value):l=f[p],n=u(v?p:h+(g?".":"#")+p,t.forced),!n&&void 0!==l){if(typeof d==typeof l)continue;c(d,l)}(t.sham||l&&l.sham)&&a(d,"sham",!0),i(f,p,d,t)}}},7293:function(t){t.exports=function(t){try{return!!t()}catch(e){return!0}}},4374:function(t,e,n){var r=n(7293);t.exports=!r((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},6916:function(t,e,n){var r=n(4374),o=Function.prototype.call;t.exports=r?o.bind(o):function(){return o.apply(o,arguments)}},6530:function(t,e,n){var r=n(9781),o=n(2597),a=Function.prototype,i=r&&Object.getOwnPropertyDescriptor,s=o(a,"name"),c=s&&"something"===function(){}.name,u=s&&(!r||r&&i(a,"name").configurable);t.exports={EXISTS:s,PROPER:c,CONFIGURABLE:u}},1702:function(t,e,n){var r=n(4374),o=Function.prototype,a=o.call,i=r&&o.bind.bind(a,a);t.exports=r?i:function(t){return function(){return a.apply(t,arguments)}}},5005:function(t,e,n){var r=n(7854),o=n(614),a=function(t){return o(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?a(r[t]):r[t]&&r[t][e]}},8173:function(t,e,n){var r=n(9662),o=n(8554);t.exports=function(t,e){var n=t[e];return o(n)?void 0:r(n)}},7854:function(t,e,n){var r=function(t){return t&&t.Math==Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},2597:function(t,e,n){var r=n(1702),o=n(7908),a=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return a(o(t),e)}},3501:function(t){t.exports={}},4664:function(t,e,n){var r=n(9781),o=n(7293),a=n(317);t.exports=!r&&!o((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},8361:function(t,e,n){var r=n(1702),o=n(7293),a=n(4326),i=Object,s=r("".split);t.exports=o((function(){return!i("z").propertyIsEnumerable(0)}))?function(t){return"String"==a(t)?s(t,""):i(t)}:i},2788:function(t,e,n){var r=n(1702),o=n(614),a=n(5465),i=r(Function.toString);o(a.inspectSource)||(a.inspectSource=function(t){return i(t)}),t.exports=a.inspectSource},9909:function(t,e,n){var r,o,a,i=n(4811),s=n(7854),c=n(111),u=n(8880),f=n(2597),p=n(5465),l=n(6200),d=n(3501),m="Object already initialized",h=s.TypeError,v=s.WeakMap,g=function(t){return a(t)?o(t):r(t,{})},y=function(t){return function(e){var n;if(!c(e)||(n=o(e)).type!==t)throw h("Incompatible receiver, "+t+" required");return n}};if(i||p.state){var S=p.state||(p.state=new v);S.get=S.get,S.has=S.has,S.set=S.set,r=function(t,e){if(S.has(t))throw h(m);return e.facade=t,S.set(t,e),e},o=function(t){return S.get(t)||{}},a=function(t){return S.has(t)}}else{var T=l("state");d[T]=!0,r=function(t,e){if(f(t,T))throw h(m);return e.facade=t,u(t,T,e),e},o=function(t){return f(t,T)?t[T]:{}},a=function(t){return f(t,T)}}t.exports={set:r,get:o,has:a,enforce:g,getterFor:y}},3157:function(t,e,n){var r=n(4326);t.exports=Array.isArray||function(t){return"Array"==r(t)}},614:function(t,e,n){var r=n(4154),o=r.all;t.exports=r.IS_HTMLDDA?function(t){return"function"==typeof t||t===o}:function(t){return"function"==typeof t}},4705:function(t,e,n){var r=n(7293),o=n(614),a=/#|\.prototype\./,i=function(t,e){var n=c[s(t)];return n==f||n!=u&&(o(e)?r(e):!!e)},s=i.normalize=function(t){return String(t).replace(a,".").toLowerCase()},c=i.data={},u=i.NATIVE="N",f=i.POLYFILL="P";t.exports=i},8554:function(t){t.exports=function(t){return null===t||void 0===t}},111:function(t,e,n){var r=n(614),o=n(4154),a=o.all;t.exports=o.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:r(t)||t===a}:function(t){return"object"==typeof t?null!==t:r(t)}},1913:function(t){t.exports=!1},2190:function(t,e,n){var r=n(5005),o=n(614),a=n(7976),i=n(3307),s=Object;t.exports=i?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return o(e)&&a(e.prototype,s(t))}},6244:function(t,e,n){var r=n(7466);t.exports=function(t){return r(t.length)}},6339:function(t,e,n){var r=n(1702),o=n(7293),a=n(614),i=n(2597),s=n(9781),c=n(6530).CONFIGURABLE,u=n(2788),f=n(9909),p=f.enforce,l=f.get,d=String,m=Object.defineProperty,h=r("".slice),v=r("".replace),g=r([].join),y=s&&!o((function(){return 8!==m((function(){}),"length",{value:8}).length})),S=String(String).split("String"),T=t.exports=function(t,e,n){"Symbol("===h(d(e),0,7)&&(e="["+v(d(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!i(t,"name")||c&&t.name!==e)&&(s?m(t,"name",{value:e,configurable:!0}):t.name=e),y&&n&&i(n,"arity")&&t.length!==n.arity&&m(t,"length",{value:n.arity});try{n&&i(n,"constructor")&&n.constructor?s&&m(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(o){}var r=p(t);return i(r,"source")||(r.source=g(S,"string"==typeof e?e:"")),t};Function.prototype.toString=T((function(){return a(this)&&l(this).source||u(this)}),"toString")},4758:function(t){var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var r=+t;return(r>0?n:e)(r)}},3070:function(t,e,n){var r=n(9781),o=n(4664),a=n(3353),i=n(9670),s=n(4948),c=TypeError,u=Object.defineProperty,f=Object.getOwnPropertyDescriptor,p="enumerable",l="configurable",d="writable";e.f=r?a?function(t,e,n){if(i(t),e=s(e),i(n),"function"===typeof t&&"prototype"===e&&"value"in n&&d in n&&!n[d]){var r=f(t,e);r&&r[d]&&(t[e]=n.value,n={configurable:l in n?n[l]:r[l],enumerable:p in n?n[p]:r[p],writable:!1})}return u(t,e,n)}:u:function(t,e,n){if(i(t),e=s(e),i(n),o)try{return u(t,e,n)}catch(r){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},1236:function(t,e,n){var r=n(9781),o=n(6916),a=n(5296),i=n(9114),s=n(5656),c=n(4948),u=n(2597),f=n(4664),p=Object.getOwnPropertyDescriptor;e.f=r?p:function(t,e){if(t=s(t),e=c(e),f)try{return p(t,e)}catch(n){}if(u(t,e))return i(!o(a.f,t,e),t[e])}},8006:function(t,e,n){var r=n(6324),o=n(748),a=o.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,a)}},5181:function(t,e){e.f=Object.getOwnPropertySymbols},7976:function(t,e,n){var r=n(1702);t.exports=r({}.isPrototypeOf)},6324:function(t,e,n){var r=n(1702),o=n(2597),a=n(5656),i=n(1318).indexOf,s=n(3501),c=r([].push);t.exports=function(t,e){var n,r=a(t),u=0,f=[];for(n in r)!o(s,n)&&o(r,n)&&c(f,n);while(e.length>u)o(r,n=e[u++])&&(~i(f,n)||c(f,n));return f}},5296:function(t,e){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!n.call({1:2},1);e.f=o?function(t){var e=r(this,t);return!!e&&e.enumerable}:n},2140:function(t,e,n){var r=n(6916),o=n(614),a=n(111),i=TypeError;t.exports=function(t,e){var n,s;if("string"===e&&o(n=t.toString)&&!a(s=r(n,t)))return s;if(o(n=t.valueOf)&&!a(s=r(n,t)))return s;if("string"!==e&&o(n=t.toString)&&!a(s=r(n,t)))return s;throw i("Can't convert object to primitive value")}},3887:function(t,e,n){var r=n(5005),o=n(1702),a=n(8006),i=n(5181),s=n(9670),c=o([].concat);t.exports=r("Reflect","ownKeys")||function(t){var e=a.f(s(t)),n=i.f;return n?c(e,n(t)):e}},4488:function(t,e,n){var r=n(8554),o=TypeError;t.exports=function(t){if(r(t))throw o("Can't call method on "+t);return t}},6200:function(t,e,n){var r=n(2309),o=n(9711),a=r("keys");t.exports=function(t){return a[t]||(a[t]=o(t))}},5465:function(t,e,n){var r=n(7854),o=n(3072),a="__core-js_shared__",i=r[a]||o(a,{});t.exports=i},2309:function(t,e,n){var r=n(1913),o=n(5465);(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.29.1",mode:r?"pure":"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.29.1/LICENSE",source:"https://github.com/zloirock/core-js"})},6293:function(t,e,n){var r=n(7392),o=n(7293);t.exports=!!Object.getOwnPropertySymbols&&!o((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},1400:function(t,e,n){var r=n(9303),o=Math.max,a=Math.min;t.exports=function(t,e){var n=r(t);return n<0?o(n+e,0):a(n,e)}},5656:function(t,e,n){var r=n(8361),o=n(4488);t.exports=function(t){return r(o(t))}},9303:function(t,e,n){var r=n(4758);t.exports=function(t){var e=+t;return e!==e||0===e?0:r(e)}},7466:function(t,e,n){var r=n(9303),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},7908:function(t,e,n){var r=n(4488),o=Object;t.exports=function(t){return o(r(t))}},7593:function(t,e,n){var r=n(6916),o=n(111),a=n(2190),i=n(8173),s=n(2140),c=n(5112),u=TypeError,f=c("toPrimitive");t.exports=function(t,e){if(!o(t)||a(t))return t;var n,c=i(t,f);if(c){if(void 0===e&&(e="default"),n=r(c,t,e),!o(n)||a(n))return n;throw u("Can't convert object to primitive value")}return void 0===e&&(e="number"),s(t,e)}},4948:function(t,e,n){var r=n(7593),o=n(2190);t.exports=function(t){var e=r(t,"string");return o(e)?e:e+""}},6330:function(t){var e=String;t.exports=function(t){try{return e(t)}catch(n){return"Object"}}},9711:function(t,e,n){var r=n(1702),o=0,a=Math.random(),i=r(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+i(++o+a,36)}},3307:function(t,e,n){var r=n(6293);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:function(t,e,n){var r=n(9781),o=n(7293);t.exports=r&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},4811:function(t,e,n){var r=n(7854),o=n(614),a=r.WeakMap;t.exports=o(a)&&/native code/.test(String(a))},5112:function(t,e,n){var r=n(7854),o=n(2309),a=n(2597),i=n(9711),s=n(6293),c=n(3307),u=r.Symbol,f=o("wks"),p=c?u["for"]||u:u&&u.withoutSetter||i;t.exports=function(t){return a(f,t)||(f[t]=s&&a(u,t)?u[t]:p("Symbol."+t)),f[t]}},7658:function(t,e,n){"use strict";var r=n(2109),o=n(7908),a=n(6244),i=n(3658),s=n(7207),c=n(7293),u=c((function(){return 4294967297!==[].push.call({length:4294967296},1)})),f=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},p=u||!f();r({target:"Array",proto:!0,arity:1,forced:p},{push:function(t){var e=o(this),n=a(e),r=arguments.length;s(n+r);for(var c=0;c<r;c++)e[n]=arguments[c],n++;return i(e,n),n}})}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={exports:{}};return t[r](a,a.exports,n),a.exports}!function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}();!function(){"use strict";const t="datasource-data-",e={DATA:"data",LAST_TIME:"last-time",MASTER_TIME:"master-time",STATUS:"status",TIME_CHANGED:"time-changed",CLOSED:"closed"};n(7658);Math.pow(2,53);function r(t){return"undefined"!==typeof t&&null!==t}const o={CONNECTING:"connecting",CONNECTED:"connected",DISCONNECTED:"disconnected",FETCH_STARTED:"fetch-start",FETCH_ENDED:"fetch-end",CLOSED:"closed",CLOSED_ERROR:"closed-error"};class a{constructor(t,e=5){this.dataSourceMap={},this.tsRun=void 0,this.timerResolution=e,this.interval=null,this.datasources=[];for(let n of t)this.addDataSource(n)}removeDataSource(t){this.datasources=this.datasources.filter((e=>e.id!==t)),delete this.dataSourceMap[t]}push(t,e){}getCurrentTimestamp(){return this.tsRun}processData(){let t,e=-1,n=performance.now();for(let r in this.dataSourceMap)t=this.dataSourceMap[r],t.dataBuffer.length>0&&(e=-1===e||t.dataBuffer[0].data.timestamp<e?t.dataBuffer[0].data.timestamp:e);this.interval=setInterval((()=>{while(this.computeNextData(e,n));}),this.timerResolution),console.warn(`Started Algorithm ${this.constructor.name} with  tsRef=${new Date(e).toISOString()}`)}computeNextData(t,e){throw Error("Should be overridden")}addDataSource(t){throw Error("Should be overridden")}checkVersion(t,e){throw Error("Should be overridden")}onData(t,e){}checkStart(){}setStatus(t,e){throw Error("Should be overridden")}close(){r(this.interval)&&(clearInterval(this.interval),this.interval=void 0),console.log("Data synchronizer terminated successfully"),this.onClose()}onStart(){}onClose(){}}var i=a;class s extends i{constructor(t,e=1,n,r,o=5,a){super(t,e,o),this.replaySpeed=e,this.startTimestamp=n,this.endTimestamp=r,this.version=a}push(t,e){if(0!==e.length&&t in this.dataSourceMap){const n=this.dataSourceMap[t],r=e[e.length-1];if(!this.checkVersion(r))return void console.warn(`[DataSynchronizer] incompatible version ${r.version} ~ ${this.version}, skipping data`);n.dataBuffer.push(...e)}}processData(){this.clockTimeRef=performance.now(),this.interval=setInterval((()=>{while(this.computeNextData(this.startTimestamp,this.clockTimeRef))this.checkEnd();this.checkEnd()}),this.timerResolution),console.warn(`Started Replay Algorithm with tsRef=${new Date(this.startTimestamp).toISOString()}`)}computeNextData(t,e){try{let n,r=null;const o=(performance.now()-e)*this.replaySpeed;let a=t+o,i=!1;for(let e in this.dataSourceMap)if(n=this.dataSourceMap[e],n.skip&&a>n.minTimestamp&&a<n.maxTimestamp&&(n.skip=!1),!n.skip&&n.dataBuffer.length>0){const e=n.dataBuffer[0].data.timestamp-t;e<=o&&(r=null===r?n:r.dataBuffer[0].data.timestamp<n.dataBuffer[0].data.timestamp?r:n)}return null!==r&&(r.id in this.dataSourceMap&&this.onData(r.id,r.dataBuffer.shift()),i=!0),this.tsRun=a,i}catch(n){return console.log(n),!1}}addDataSource(t){this.dataSourceMap[t.id]={dataBuffer:[],id:t.id,name:t.name||t.id,status:o.DISCONNECTED,minTimestamp:t.minTimestamp,maxTimestamp:t.maxTimestamp,skip:!1},(t.maxTimestamp<this.getCurrentTimestamp()||t.minTimestamp>this.getCurrentTimestamp())&&(this.dataSourceMap[t.id].skip=!0,console.warn(`Skipping new added dataSource ${t.id} because timeRange of the dataSource is not intersecting the synchronizer one`)),this.datasources.push(t)}checkVersion(t){return t.version===this.version}setStatus(t,e){t in this.dataSourceMap&&(this.dataSourceMap[t].status=e,console.warn(e+" DataSource "+t+" from the synchronizer ")),this.checkStart()}checkStart(){if(!r(this.interval)){let t,e=0,n=0,r=Object.keys(this.dataSourceMap).length;if(0===r)return;for(let a in this.dataSourceMap)t=this.dataSourceMap[a],t.skip=this.startTimestamp<t.minTimestamp||this.startTimestamp>t.maxTimestamp,t.status===o.FETCH_STARTED?n++:t.skip&&e++;console.warn(`[Synchronizer] Fetched ${n}/${r} datasources`),console.warn(`[Synchronizer] Skipped ${e}/${r} datasources`),n+e===r&&(console.warn("Starting Replay Algorithm..."),this.processData(),this.onStart())}}checkEnd(){this.getCurrentTimestamp()>this.endTimestamp&&(this.onEnd(),this.reset())}reset(){console.log("reset synchronizer algo"),this.close();for(let t in this.dataSourceMap)this.resetDataSource(t);this.tsRun=void 0}resetDataSource(t){const e=this.dataSourceMap[t];e.dataBuffer=[],e.status=o.DISCONNECTED,e.version=void 0,e.skip=!1}removeDataSource(t){super.removeDataSource(t);let e,n,r=this.getCurrentTimestamp();for(let o in this.dataSourceMap){if(n=this.dataSourceMap[o],r>=n.minTimestamp&&r<=n.maxTimestamp)return;e?n.minTimestamp<e&&(e=n.minTimestamp):e=n.minTimestamp}}setEndTimestamp(t){this.endTimestamp=t}setTimeRange(t,e,n){this.replaySpeed=n,this.startTimestamp=t,this.endTimestamp=e,this.clockTimeRef=performance.now(),this.reset(),this.checkStart()}onEnd(){}onStart(){}}var c=s;const u={};let f,p,l=!1,d=null;const m={};let h,v,g,y,S,T,b,x,w,E,D,M=null,O=-1,C=-1;async function I(t){let e,n={};t.data.ackId&&(n.ackId=t.data.ackId);try{"init"===t.data.message?(g=t.data.replaySpeed,x=t.data.startTimestamp,w=t.data.endTimestamp,C=t.data.version,E=t.data.timerResolution,f=new c(t.data.dataSources,g,x,w,t.data.timerResolution,C),f.onClose=F,f.onData=$,l=!0,R(t.data.dataSources),v=t.data.topics.data,h=t.data.topics.time,A(v,h),b=t.data.masterTimeRefreshRate):"add"===t.data.message&&t.data.dataSources?(console.log("Add datasource to synchronizer.."),R(t.data.dataSources)):"connect"===t.data.message?(U(b),f.checkStart(),C=t.data.version):"is-connected"===t.data.message?e=r(y)&&r(f)&&r(f.interval):"remove"===t.data.message?(console.log("Remove datasource from synchronizer algorithm.."),await N(t.data.dataSourceIds),f instanceof c&&(f.endTimestamp=t.data.endTimestamp)):"current-time"===t.data.message?e=f.getCurrentTimestamp():"reset"===t.data.message?k():"replay-speed"===t.data.message?null!==f&&(k(),f.replaySpeed=t.data.replaySpeed):"set-max-time"===t.data.message?f.setEndTimestamp(t.data.maxTimestamp):"time-range"===t.data.message?j(t.data.startTimestamp,t.data.endTimestamp,t.data.mode,t.data.replaySpeed,t.data.version,t.data.dataSources):"data"===t.data.message&&(B(),null!==f&&f.push(t.data.dataSourceId,t.data.data))}catch(o){console.error(o),n.error=o}finally{n.data=e,self.postMessage(n)}}function j(t,e,n,r,o,a){k(),C=o,f=new c(a,r,t,e,E,C),f.onEnd=L,f.onStart=z,f.onClose=F,f.onData=$}function k(){clearInterval(y),y=void 0,null!==f&&f.reset(),M.postMessage({type:e.TIME_CHANGED}),M.postMessage({type:e.CLOSED}),d.postMessage({type:e.STATUS,status:"not_running"})}function A(t,n){console.log("listen on topic ",t),d=new BroadcastChannel(t),d.onmessage=async t=>{if(t.data.type===e.DATA)B(),f.push(t.data.dataSourceId,t.data.values);else if(t.data.type===e.STATUS){const e=t.data.dataSourceId;f.setStatus(e,t.data.status),e in u&&(console.log(m[e].name+": status="+t.data.status),u[e].postMessage(t.data))}},M=new BroadcastChannel(n)}function R(t){for(let e of t)P(e)}function P(e){f.addDataSource(e),u[e.id]=new BroadcastChannel(t+e.id),e.id in m||(m[e.id]=e)}async function N(t){for(let e of t)await _(e)}async function _(t){await f.removeDataSource(t),console.log("deleting BC for datasource "+t),delete u[t],delete m[t]}function B(){r(y)||U(b)}async function L(){const t=f.getCurrentTimestamp();clearInterval(y),y=void 0,M.postMessage({timestamp:t,type:e.MASTER_TIME}),d.postMessage({type:e.STATUS,status:"not_running"})}async function z(){B()}function F(){M.postMessage({type:e.CLOSED}),d.postMessage({type:e.STATUS,status:"not_running"})}async function $(t,n){n.version===C?(p={dataSourceId:t,dataBlock:n},u[t].postMessage({values:[n],dataSourceId:t,type:e.DATA})):console.error("version are different:",n.version,C)}function U(t){r(y)||(y=setInterval((()=>{D=f.getCurrentTimestamp(),r(D)&&M.postMessage({timestamp:D,type:e.MASTER_TIME}),r(p)&&(S=p.dataBlock.data.timestamp,T=p.dataSourceId,(-1!==S&&-1===O||-1!==O&&S!==O)&&M.postMessage({timestamp:S,dataSourceId:T,type:e.LAST_TIME}),O=S)}),t),d.postMessage({type:e.STATUS,status:"running"}))}self.onmessage=async t=>{I(t)},self.onclose=function(){f.close(),console.log("Data Synchronizer has been terminated successfully"),d.postMessage({type:e.STATUS,status:"not_running"})}}()})();
//# sourceMappingURL=DataSynchronizer.replay.worker.d08ae238.worker.js.map