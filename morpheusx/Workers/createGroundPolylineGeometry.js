define(["./Transforms-62a339c3","./Matrix2-92b7fb9d","./RuntimeError-4fdc4459","./when-8166c7dd","./ComponentDatatype-9ed50558","./ArcType-13a53523","./arrayRemoveDuplicates-198208a4","./EllipsoidGeodesic-133bd147","./EllipsoidRhumbLine-51654311","./EncodedCartesian3-4a314cb8","./GeometryAttribute-6f4c3b93","./IntersectionTests-4f28a69c","./Plane-049255eb","./WebMercatorProjection-6ac42c0a","./combine-a5c4cc47","./WebGLConstants-0664004c"],(function(e,a,t,r,i,n,s,o,l,u,c,C,p,d,h,g){"use strict";function f(t){t=r.defaultValue(t,r.defaultValue.EMPTY_OBJECT),this._ellipsoid=r.defaultValue(t.ellipsoid,a.Ellipsoid.WGS84),this._rectangle=r.defaultValue(t.rectangle,a.Rectangle.MAX_VALUE),this._projection=new e.GeographicProjection(this._ellipsoid),this._numberOfLevelZeroTilesX=r.defaultValue(t.numberOfLevelZeroTilesX,2),this._numberOfLevelZeroTilesY=r.defaultValue(t.numberOfLevelZeroTilesY,1)}Object.defineProperties(f.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}}),f.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e},f.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e},f.prototype.rectangleToNativeRectangle=function(e,n){t.Check.defined("rectangle",e);var s=i.CesiumMath.toDegrees(e.west),o=i.CesiumMath.toDegrees(e.south),l=i.CesiumMath.toDegrees(e.east),u=i.CesiumMath.toDegrees(e.north);return r.defined(n)?(n.west=s,n.south=o,n.east=l,n.north=u,n):new a.Rectangle(s,o,l,u)},f.prototype.tileXYToNativeRectangle=function(e,a,t,r){var n=this.tileXYToRectangle(e,a,t,r);return n.west=i.CesiumMath.toDegrees(n.west),n.south=i.CesiumMath.toDegrees(n.south),n.east=i.CesiumMath.toDegrees(n.east),n.north=i.CesiumMath.toDegrees(n.north),n},f.prototype.tileXYToRectangle=function(e,t,i,n){var s=this._rectangle,o=this.getNumberOfXTilesAtLevel(i),l=this.getNumberOfYTilesAtLevel(i),u=s.width/o,c=e*u+s.west,C=(e+1)*u+s.west,p=s.height/l,d=s.north-t*p,h=s.north-(t+1)*p;return r.defined(n)||(n=new a.Rectangle(c,h,C,d)),n.west=c,n.south=h,n.east=C,n.north=d,n},f.prototype.positionToTileXY=function(e,t,n){var s=this._rectangle;if(a.Rectangle.contains(s,e)){var o=this.getNumberOfXTilesAtLevel(t),l=this.getNumberOfYTilesAtLevel(t),u=s.width/o,c=s.height/l,C=e.longitude;s.east<s.west&&(C+=i.CesiumMath.TWO_PI);var p=(C-s.west)/u|0;p>=o&&(p=o-1);var d=(s.north-e.latitude)/c|0;return d>=l&&(d=l-1),r.defined(n)?(n.x=p,n.y=d,n):new a.Cartesian2(p,d)}};var m=new a.Cartesian3,w=new a.Cartesian3,v=new a.Cartographic,y=new a.Cartesian3,T=new a.Cartesian3,E=new e.BoundingSphere,M=new f,_=[new a.Cartographic,new a.Cartographic,new a.Cartographic,new a.Cartographic],O=new a.Cartesian2,b={};function A(e){a.Cartographic.fromRadians(e.east,e.north,0,_[0]),a.Cartographic.fromRadians(e.west,e.north,0,_[1]),a.Cartographic.fromRadians(e.east,e.south,0,_[2]),a.Cartographic.fromRadians(e.west,e.south,0,_[3]);var t,r=0,i=0,n=0,s=0,o=b._terrainHeightsMaxLevel;for(t=0;t<=o;++t){for(var l=!1,u=0;u<4;++u){var c=_[u];if(M.positionToTileXY(c,t,O),0===u)n=O.x,s=O.y;else if(n!==O.x||s!==O.y){l=!0;break}}if(l)break;r=n,i=s}if(0!==t)return{x:r,y:i,level:t>o?o:t-1}}b.initialize=function(){var a=b._initPromise;return r.defined(a)||(a=e.Resource.fetchJson(e.buildModuleUrl("Assets/approximateTerrainHeights.json")).then((function(e){b._terrainHeights=e})),b._initPromise=a),a},b.getMinimumMaximumHeights=function(e,i){if(t.Check.defined("rectangle",e),!r.defined(b._terrainHeights))throw new t.DeveloperError("You must call ApproximateTerrainHeights.initialize and wait for the promise to resolve before using this function");i=r.defaultValue(i,a.Ellipsoid.WGS84);var n=A(e),s=b._defaultMinTerrainHeight,o=b._defaultMaxTerrainHeight;if(r.defined(n)){var l=n.level+"-"+n.x+"-"+n.y,u=b._terrainHeights[l];r.defined(u)&&(s=u[0],o=u[1]),i.cartographicToCartesian(a.Rectangle.northeast(e,v),m),i.cartographicToCartesian(a.Rectangle.southwest(e,v),w),a.Cartesian3.midpoint(w,m,y);var c=i.scaleToGeodeticSurface(y,T);if(r.defined(c)){var C=a.Cartesian3.distance(y,c);s=Math.min(s,-C)}else s=b._defaultMinTerrainHeight}return s=Math.max(b._defaultMinTerrainHeight,s),{minimumTerrainHeight:s,maximumTerrainHeight:o}},b.getBoundingSphere=function(i,n){if(t.Check.defined("rectangle",i),!r.defined(b._terrainHeights))throw new t.DeveloperError("You must call ApproximateTerrainHeights.initialize and wait for the promise to resolve before using this function");n=r.defaultValue(n,a.Ellipsoid.WGS84);var s=A(i),o=b._defaultMaxTerrainHeight;if(r.defined(s)){var l=s.level+"-"+s.x+"-"+s.y,u=b._terrainHeights[l];r.defined(u)&&(o=u[1])}var c=e.BoundingSphere.fromRectangle3D(i,n,0);return e.BoundingSphere.fromRectangle3D(i,n,o,E),e.BoundingSphere.union(c,E,c)},b._terrainHeightsMaxLevel=6,b._defaultMaxTerrainHeight=9e3,b._defaultMinTerrainHeight=-1e5,b._terrainHeights=void 0,b._initPromise=void 0,Object.defineProperties(b,{initialized:{get:function(){return r.defined(b._terrainHeights)}}});var k=[e.GeographicProjection,d.WebMercatorProjection],P=k.length,S=Math.cos(i.CesiumMath.toRadians(30)),L=Math.cos(i.CesiumMath.toRadians(150)),x=0,I=1e3;function D(e){e=r.defaultValue(e,r.defaultValue.EMPTY_OBJECT);var i=e.positions;if(!r.defined(i)||i.length<2)throw new t.DeveloperError("At least two positions are required.");if(r.defined(e.arcType)&&e.arcType!==n.ArcType.GEODESIC&&e.arcType!==n.ArcType.RHUMB)throw new t.DeveloperError("Valid options for arcType are ArcType.GEODESIC and ArcType.RHUMB.");this.width=r.defaultValue(e.width,1),this._positions=i,this.granularity=r.defaultValue(e.granularity,9999),this.loop=r.defaultValue(e.loop,!1),this.arcType=r.defaultValue(e.arcType,n.ArcType.GEODESIC),this._ellipsoid=a.Ellipsoid.WGS84,this._projectionIndex=0,this._workerName="createGroundPolylineGeometry",this._scene3DOnly=!1}Object.defineProperties(D.prototype,{packedLength:{get:function(){return 1+3*this._positions.length+1+1+1+a.Ellipsoid.packedLength+1+1}}}),D.setProjectionAndEllipsoid=function(e,a){for(var t=0,r=0;r<P;r++)if(a instanceof k[r]){t=r;break}e._projectionIndex=t,e._ellipsoid=a.ellipsoid};var N=new a.Cartesian3,R=new a.Cartesian3,H=new a.Cartesian3;function z(e,t,r,i,n){var s=F(i,e,0,N),o=F(i,e,r,R),l=F(i,t,0,H),u=X(o,s,R),c=X(l,s,H);return a.Cartesian3.cross(c,u,n),a.Cartesian3.normalize(n,n)}var B=new a.Cartographic,G=new a.Cartesian3,j=new a.Cartesian3,V=new a.Cartesian3;function Y(e,t,r,i,s,u,c,C,p,d,h){if(0!==s){var g;u===n.ArcType.GEODESIC?g=new o.EllipsoidGeodesic(e,t,c):u===n.ArcType.RHUMB&&(g=new l.EllipsoidRhumbLine(e,t,c));var f=g.surfaceDistance;if(!(f<s))for(var m=z(e,t,i,c,V),w=Math.ceil(f/s),v=f/w,y=v,T=w-1,E=C.length,M=0;M<T;M++){var _=g.interpolateUsingSurfaceDistance(y,B),O=F(c,_,r,G),b=F(c,_,i,j);a.Cartesian3.pack(m,C,E),a.Cartesian3.pack(O,p,E),a.Cartesian3.pack(b,d,E),h.push(_.latitude),h.push(_.longitude),E+=3,y+=v}}}var q=new a.Cartographic;function F(e,t,r,i){return a.Cartographic.clone(t,q),q.height=r,a.Cartographic.toCartesian(q,e,i)}function X(e,t,r){return a.Cartesian3.subtract(e,t,r),a.Cartesian3.normalize(r,r),r}function U(e,t,r,i){return i=X(e,t,i),i=a.Cartesian3.cross(i,r,i),i=a.Cartesian3.normalize(i,i),i=a.Cartesian3.cross(r,i,i),i}D.pack=function(e,i,n){t.Check.typeOf.object("value",e),t.Check.defined("array",i);var s=r.defaultValue(n,0),o=e._positions,l=o.length;i[s++]=l;for(var u=0;u<l;++u){var c=o[u];a.Cartesian3.pack(c,i,s),s+=3}return i[s++]=e.granularity,i[s++]=e.loop?1:0,i[s++]=e.arcType,a.Ellipsoid.pack(e._ellipsoid,i,s),s+=a.Ellipsoid.packedLength,i[s++]=e._projectionIndex,i[s++]=e._scene3DOnly?1:0,i},D.unpack=function(e,i,n){t.Check.defined("array",e);for(var s=r.defaultValue(i,0),o=e[s++],l=new Array(o),u=0;u<o;u++)l[u]=a.Cartesian3.unpack(e,s),s+=3;var c=e[s++],C=1===e[s++],p=e[s++],d=a.Ellipsoid.unpack(e,s);s+=a.Ellipsoid.packedLength;var h=e[s++],g=1===e[s++];return r.defined(n)||(n=new D({positions:l})),n._positions=l,n.granularity=c,n.loop=C,n.arcType=p,n._ellipsoid=d,n._projectionIndex=h,n._scene3DOnly=g,n};var W=new a.Cartesian3,Z=new a.Cartesian3,J=new a.Cartesian3,Q=new a.Cartesian3,K=0,$=-1;function ee(e,t,r,n,s){var o=X(r,t,Q),l=U(e,t,o,W),u=U(n,t,o,Z);if(i.CesiumMath.equalsEpsilon(a.Cartesian3.dot(l,u),$,i.CesiumMath.EPSILON5))return s=a.Cartesian3.cross(o,l,s),s=a.Cartesian3.normalize(s,s),s;s=a.Cartesian3.add(u,l,s),s=a.Cartesian3.normalize(s,s);var c=a.Cartesian3.cross(o,s,J);return a.Cartesian3.dot(u,c)<K&&(s=a.Cartesian3.negate(s,s)),s}var ae=p.Plane.fromPointNormal(a.Cartesian3.ZERO,a.Cartesian3.UNIT_Y),te=new a.Cartesian3,re=new a.Cartesian3,ie=new a.Cartesian3,ne=new a.Cartesian3,se=new a.Cartesian3,oe=new a.Cartesian3,le=new a.Cartographic,ue=new a.Cartographic,ce=new a.Cartographic;D.createGeometry=function(e){var t,o,u,c,p,d,h=!e._scene3DOnly,g=e.loop,f=e._ellipsoid,m=e.granularity,w=e.arcType,v=new k[e._projectionIndex](f),y=x,T=I,E=e._positions,M=E.length;2===M&&(g=!1);var _,O,b,A=new l.EllipsoidRhumbLine(void 0,void 0,f),P=[E[0]];for(o=0;o<M-1;o++)u=E[o],c=E[o+1],_=C.IntersectionTests.lineSegmentPlane(u,c,ae,oe),!r.defined(_)||a.Cartesian3.equalsEpsilon(_,u,i.CesiumMath.EPSILON7)||a.Cartesian3.equalsEpsilon(_,c,i.CesiumMath.EPSILON7)||(e.arcType===n.ArcType.GEODESIC?P.push(a.Cartesian3.clone(_)):e.arcType===n.ArcType.RHUMB&&(b=f.cartesianToCartographic(_,le).longitude,p=f.cartesianToCartographic(u,le),d=f.cartesianToCartographic(c,ue),A.setEndPoints(p,d),O=A.findIntersectionWithLongitude(b,ce),_=f.cartographicToCartesian(O,oe),!r.defined(_)||a.Cartesian3.equalsEpsilon(_,u,i.CesiumMath.EPSILON7)||a.Cartesian3.equalsEpsilon(_,c,i.CesiumMath.EPSILON7)||P.push(a.Cartesian3.clone(_)))),P.push(c);g&&(u=E[M-1],c=E[0],_=C.IntersectionTests.lineSegmentPlane(u,c,ae,oe),!r.defined(_)||a.Cartesian3.equalsEpsilon(_,u,i.CesiumMath.EPSILON7)||a.Cartesian3.equalsEpsilon(_,c,i.CesiumMath.EPSILON7)||(e.arcType===n.ArcType.GEODESIC?P.push(a.Cartesian3.clone(_)):e.arcType===n.ArcType.RHUMB&&(b=f.cartesianToCartographic(_,le).longitude,p=f.cartesianToCartographic(u,le),d=f.cartesianToCartographic(c,ue),A.setEndPoints(p,d),O=A.findIntersectionWithLongitude(b,ce),_=f.cartographicToCartesian(O,oe),!r.defined(_)||a.Cartesian3.equalsEpsilon(_,u,i.CesiumMath.EPSILON7)||a.Cartesian3.equalsEpsilon(_,c,i.CesiumMath.EPSILON7)||P.push(a.Cartesian3.clone(_)))));var S=P.length,L=new Array(S);for(o=0;o<S;o++){var D=a.Cartographic.fromCartesian(P[o],f);D.height=0,L[o]=D}if(L=s.arrayRemoveDuplicates(L,a.Cartographic.equalsEpsilon),S=L.length,!(S<2)){var N=[],R=[],H=[],B=[],G=te,j=re,V=ie,q=ne,X=se,U=L[0],W=L[1],Z=L[S-1];for(G=F(f,Z,y,G),q=F(f,W,y,q),j=F(f,U,y,j),V=F(f,U,T,V),X=g?ee(G,j,V,q,X):z(U,W,T,f,X),a.Cartesian3.pack(X,R,0),a.Cartesian3.pack(j,H,0),a.Cartesian3.pack(V,B,0),N.push(U.latitude),N.push(U.longitude),Y(U,W,y,T,m,w,f,R,H,B,N),o=1;o<S-1;++o){G=a.Cartesian3.clone(j,G),j=a.Cartesian3.clone(q,j);var J=L[o];F(f,J,T,V),F(f,L[o+1],y,q),ee(G,j,V,q,X),t=R.length,a.Cartesian3.pack(X,R,t),a.Cartesian3.pack(j,H,t),a.Cartesian3.pack(V,B,t),N.push(J.latitude),N.push(J.longitude),Y(L[o],L[o+1],y,T,m,w,f,R,H,B,N)}var Q=L[S-1],K=L[S-2];if(j=F(f,Q,y,j),V=F(f,Q,T,V),g){var $=L[0];G=F(f,K,y,G),q=F(f,$,y,q),X=ee(G,j,V,q,X)}else X=z(K,Q,T,f,X);if(t=R.length,a.Cartesian3.pack(X,R,t),a.Cartesian3.pack(j,H,t),a.Cartesian3.pack(V,B,t),N.push(Q.latitude),N.push(Q.longitude),g){for(Y(Q,U,y,T,m,w,f,R,H,B,N),t=R.length,o=0;o<3;++o)R[t+o]=R[o],H[t+o]=H[o],B[t+o]=B[o];N.push(U.latitude),N.push(U.longitude)}return ra(g,v,H,B,R,N,h)}};var Ce=new a.Cartesian3,pe=new a.Matrix3,de=new e.Quaternion;function he(t,r,n,s){var o=X(n,r,Ce),l=a.Cartesian3.dot(o,t);if(l>S||l<L){var u=X(s,n,Q),c=l<L?i.CesiumMath.PI_OVER_TWO:-i.CesiumMath.PI_OVER_TWO,C=e.Quaternion.fromAxisAngle(u,c,de),p=a.Matrix3.fromQuaternion(C,pe);return a.Matrix3.multiplyByVector(p,t,t),!0}return!1}var ge=new a.Cartographic,fe=new a.Cartesian3,me=new a.Cartesian3;function we(e,t,r,n,s){var o=a.Cartographic.toCartesian(t,e._ellipsoid,fe),l=a.Cartesian3.add(o,r,me),u=!1,c=e._ellipsoid,C=c.cartesianToCartographic(l,ge);Math.abs(t.longitude-C.longitude)>i.CesiumMath.PI_OVER_TWO&&(u=!0,l=a.Cartesian3.subtract(o,r,me),C=c.cartesianToCartographic(l,ge)),C.height=0;var p=e.project(C,s);return s=a.Cartesian3.subtract(p,n,s),s.z=0,s=a.Cartesian3.normalize(s,s),u&&a.Cartesian3.negate(s,s),s}var ve=new a.Cartesian3,ye=new a.Cartesian3;function Te(e,t,r,i,n,s){var o=a.Cartesian3.subtract(t,e,ve);a.Cartesian3.normalize(o,o);var l=r-x,u=a.Cartesian3.multiplyByScalar(o,l,ye);a.Cartesian3.add(e,u,n);var c=i-I;u=a.Cartesian3.multiplyByScalar(o,c,ye),a.Cartesian3.add(t,u,s)}var Ee=new a.Cartesian3;function Me(e,t){var r=p.Plane.getPointDistance(ae,e),n=p.Plane.getPointDistance(ae,t),s=Ee;i.CesiumMath.equalsEpsilon(r,0,i.CesiumMath.EPSILON2)?(s=X(t,e,s),a.Cartesian3.multiplyByScalar(s,i.CesiumMath.EPSILON2,s),a.Cartesian3.add(e,s,e)):i.CesiumMath.equalsEpsilon(n,0,i.CesiumMath.EPSILON2)&&(s=X(e,t,s),a.Cartesian3.multiplyByScalar(s,i.CesiumMath.EPSILON2,s),a.Cartesian3.add(t,s,t))}function _e(e,a){var t=Math.abs(e.longitude),r=Math.abs(a.longitude);if(i.CesiumMath.equalsEpsilon(t,i.CesiumMath.PI,i.CesiumMath.EPSILON11)){var n=i.CesiumMath.sign(a.longitude);return e.longitude=n*(t-i.CesiumMath.EPSILON11),1}if(i.CesiumMath.equalsEpsilon(r,i.CesiumMath.PI,i.CesiumMath.EPSILON11)){var s=i.CesiumMath.sign(e.longitude);return a.longitude=s*(r-i.CesiumMath.EPSILON11),2}return 0}var Oe=new a.Cartographic,be=new a.Cartographic,Ae=new a.Cartesian3,ke=new a.Cartesian3,Pe=new a.Cartesian3,Se=new a.Cartesian3,Le=new a.Cartesian3,xe=new a.Cartesian3,Ie=[Oe,be],De=new a.Rectangle,Ne=new a.Cartesian3,Re=new a.Cartesian3,He=new a.Cartesian3,ze=new a.Cartesian3,Be=new a.Cartesian3,Ge=new a.Cartesian3,je=new a.Cartesian3,Ve=new a.Cartesian3,Ye=new a.Cartesian3,qe=new a.Cartesian3,Fe=new a.Cartesian3,Xe=new a.Cartesian3,Ue=new a.Cartesian3,We=new a.Cartesian3,Ze=new u.EncodedCartesian3,Je=new u.EncodedCartesian3,Qe=new a.Cartesian3,Ke=new a.Cartesian3,$e=new a.Cartesian3,ea=[new e.BoundingSphere,new e.BoundingSphere],aa=[0,2,1,0,3,2,0,7,3,0,4,7,0,5,4,0,1,5,5,7,4,5,6,7,5,2,6,5,1,2,3,6,2,3,7,6],ta=aa.length;function ra(t,r,n,s,o,l,C){var p,d,h,g,f,m,w=r._ellipsoid,v=n.length/3-1,y=8*v,T=4*y,E=36*v,M=y>65535?new Uint32Array(E):new Uint16Array(E),_=new Float64Array(3*y),O=new Float32Array(T),A=new Float32Array(T),k=new Float32Array(T),P=new Float32Array(T),L=new Float32Array(T);C&&(h=new Float32Array(T),g=new Float32Array(T),f=new Float32Array(T),m=new Float32Array(2*y));var x=l.length/2,I=0,D=Oe;D.height=0;var N=be;N.height=0;var R=Ae,H=ke;if(C)for(d=0,p=1;p<x;p++)D.latitude=l[d],D.longitude=l[d+1],N.latitude=l[d+2],N.longitude=l[d+3],R=r.project(D,R),H=r.project(N,H),I+=a.Cartesian3.distance(R,H),d+=2;var z=s.length/3;H=a.Cartesian3.unpack(s,0,H);var B,G=0;for(d=3,p=1;p<z;p++)R=a.Cartesian3.clone(H,R),H=a.Cartesian3.unpack(s,d,H),G+=a.Cartesian3.distance(R,H),d+=3;d=3;var j=0,V=0,Y=0,q=0,F=!1,U=a.Cartesian3.unpack(n,0,Se),W=a.Cartesian3.unpack(s,0,ke),Z=a.Cartesian3.unpack(o,0,xe);if(t){var J=a.Cartesian3.unpack(n,n.length-6,Pe);he(Z,J,U,W)&&(Z=a.Cartesian3.negate(Z,Z))}var Q=0,K=0,$=0;for(p=0;p<v;p++){var ee,ae,te,re,ie=a.Cartesian3.clone(U,Pe),ne=a.Cartesian3.clone(W,Ae),se=a.Cartesian3.clone(Z,Le);if(F&&(se=a.Cartesian3.negate(se,se)),U=a.Cartesian3.unpack(n,d,Se),W=a.Cartesian3.unpack(s,d,ke),Z=a.Cartesian3.unpack(o,d,xe),F=he(Z,ie,U,W),D.latitude=l[j],D.longitude=l[j+1],N.latitude=l[j+2],N.longitude=l[j+3],C){var oe=_e(D,N);ee=r.project(D,Be),ae=r.project(N,Ge);var le=X(ae,ee,Qe);le.y=Math.abs(le.y),te=je,re=Ve,0===oe||a.Cartesian3.dot(le,a.Cartesian3.UNIT_Y)>S?(te=we(r,D,se,ee,je),re=we(r,N,Z,ae,Ve)):1===oe?(re=we(r,N,Z,ae,Ve),te.x=0,te.y=i.CesiumMath.sign(D.longitude-Math.abs(N.longitude)),te.z=0):(te=we(r,D,se,ee,je),re.x=0,re.y=i.CesiumMath.sign(D.longitude-N.longitude),re.z=0)}var ue=a.Cartesian3.distance(ne,W),ce=u.EncodedCartesian3.fromCartesian(ie,Ze),Ce=a.Cartesian3.subtract(U,ie,Ye),pe=a.Cartesian3.normalize(Ce,Xe),de=a.Cartesian3.subtract(ne,ie,qe);de=a.Cartesian3.normalize(de,de);var ge=a.Cartesian3.cross(pe,de,Xe);ge=a.Cartesian3.normalize(ge,ge);var fe=a.Cartesian3.cross(de,se,Ue);fe=a.Cartesian3.normalize(fe,fe);var me=a.Cartesian3.subtract(W,U,Fe);me=a.Cartesian3.normalize(me,me);var ve=a.Cartesian3.cross(Z,me,We);ve=a.Cartesian3.normalize(ve,ve);var ye,Ee,ra,na=ue/G,sa=Q/G,oa=0,la=0,ua=0;if(C){oa=a.Cartesian3.distance(ee,ae),ye=u.EncodedCartesian3.fromCartesian(ee,Je),Ee=a.Cartesian3.subtract(ae,ee,Qe),ra=a.Cartesian3.normalize(Ee,Ke);var ca=ra.x;ra.x=ra.y,ra.y=-ca,la=oa/I,ua=K/I}for(B=0;B<8;B++){var Ca=q+4*B,pa=V+2*B,da=Ca+3,ha=B<4?1:-1,ga=2===B||3===B||6===B||7===B?1:-1;a.Cartesian3.pack(ce.high,O,Ca),O[da]=Ce.x,a.Cartesian3.pack(ce.low,A,Ca),A[da]=Ce.y,a.Cartesian3.pack(fe,k,Ca),k[da]=Ce.z,a.Cartesian3.pack(ve,P,Ca),P[da]=na*ha,a.Cartesian3.pack(ge,L,Ca);var fa=sa*ga;0===fa&&ga<0&&(fa=9),L[da]=fa,C&&(h[Ca]=ye.high.x,h[Ca+1]=ye.high.y,h[Ca+2]=ye.low.x,h[Ca+3]=ye.low.y,f[Ca]=-te.y,f[Ca+1]=te.x,f[Ca+2]=re.y,f[Ca+3]=-re.x,g[Ca]=Ee.x,g[Ca+1]=Ee.y,g[Ca+2]=ra.x,g[Ca+3]=ra.y,m[pa]=la*ha,fa=ua*ga,0===fa&&ga<0&&(fa=9),m[pa+1]=fa)}var ma=He,wa=ze,va=Ne,ya=Re,Ta=a.Rectangle.fromCartographicArray(Ie,De),Ea=b.getMinimumMaximumHeights(Ta,w),Ma=Ea.minimumTerrainHeight,_a=Ea.maximumTerrainHeight;$+=Ma,$+=_a,Te(ie,ne,Ma,_a,ma,va),Te(U,W,Ma,_a,wa,ya);var Oa=a.Cartesian3.multiplyByScalar(ge,i.CesiumMath.EPSILON5,$e);a.Cartesian3.add(ma,Oa,ma),a.Cartesian3.add(wa,Oa,wa),a.Cartesian3.add(va,Oa,va),a.Cartesian3.add(ya,Oa,ya),Me(ma,wa),Me(va,ya),a.Cartesian3.pack(ma,_,Y),a.Cartesian3.pack(wa,_,Y+3),a.Cartesian3.pack(ya,_,Y+6),a.Cartesian3.pack(va,_,Y+9),Oa=a.Cartesian3.multiplyByScalar(ge,-2*i.CesiumMath.EPSILON5,$e),a.Cartesian3.add(ma,Oa,ma),a.Cartesian3.add(wa,Oa,wa),a.Cartesian3.add(va,Oa,va),a.Cartesian3.add(ya,Oa,ya),Me(ma,wa),Me(va,ya),a.Cartesian3.pack(ma,_,Y+12),a.Cartesian3.pack(wa,_,Y+15),a.Cartesian3.pack(ya,_,Y+18),a.Cartesian3.pack(va,_,Y+21),j+=2,d+=3,V+=16,Y+=24,q+=32,Q+=ue,K+=oa}d=0;var ba=0;for(p=0;p<v;p++){for(B=0;B<ta;B++)M[d+B]=aa[B]+ba;ba+=8,d+=ta}var Aa=ea;e.BoundingSphere.fromVertices(n,a.Cartesian3.ZERO,3,Aa[0]),e.BoundingSphere.fromVertices(s,a.Cartesian3.ZERO,3,Aa[1]);var ka=e.BoundingSphere.fromBoundingSpheres(Aa);ka.radius+=$/(2*v);var Pa={position:new c.GeometryAttribute({componentDatatype:i.ComponentDatatype.DOUBLE,componentsPerAttribute:3,normalize:!1,values:_}),startHiAndForwardOffsetX:ia(O),startLoAndForwardOffsetY:ia(A),startNormalAndForwardOffsetZ:ia(k),endNormalAndTextureCoordinateNormalizationX:ia(P),rightNormalAndTextureCoordinateNormalizationY:ia(L)};return C&&(Pa.startHiLo2D=ia(h),Pa.offsetAndRight2D=ia(g),Pa.startEndNormals2D=ia(f),Pa.texcoordNormalization2D=new c.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:2,normalize:!1,values:m})),new c.Geometry({attributes:Pa,indices:M,boundingSphere:ka})}function ia(e){return new c.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:4,normalize:!1,values:e})}function na(e,a){return b.initialize().then((function(){return r.defined(a)&&(e=D.unpack(e,a)),D.createGeometry(e)}))}return D._projectNormal=we,na}));