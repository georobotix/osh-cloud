define(["./when-8166c7dd","./Matrix2-92b7fb9d","./ArcType-13a53523","./GeometryOffsetAttribute-e8e698d7","./Transforms-62a339c3","./RuntimeError-4fdc4459","./ComponentDatatype-9ed50558","./EllipsoidTangentPlane-5d8b4bd3","./GeometryAttribute-6f4c3b93","./GeometryAttributes-50becc99","./GeometryInstance-c790ce17","./GeometryPipeline-54fb0bb4","./IndexDatatype-797210ca","./PolygonGeometryLibrary-e5495823","./PolygonPipeline-7fb6627c","./combine-a5c4cc47","./WebGLConstants-0664004c","./AxisAlignedBoundingBox-b0cd1e39","./IntersectionTests-4f28a69c","./Plane-049255eb","./AttributeCompression-212262a3","./EncodedCartesian3-4a314cb8","./arrayRemoveDuplicates-198208a4","./EllipsoidRhumbLine-51654311"],(function(e,t,i,r,o,n,a,y,l,s,p,u,d,c,g,f,h,m,b,P,v,E,A,G){"use strict";var _=[],T=[];function H(e,t,r,o,n){var u,f,h=y.EllipsoidTangentPlane.fromPoints(t,e),m=h.projectPointsOntoPlane(t,_),b=g.PolygonPipeline.computeWindingOrder2D(m);b===g.WindingOrder.CLOCKWISE&&(m.reverse(),t=t.slice().reverse());var P=t.length,v=0;if(o)for(u=new Float64Array(2*P*3),f=0;f<P;f++){var E=t[f],A=t[(f+1)%P];u[v++]=E.x,u[v++]=E.y,u[v++]=E.z,u[v++]=A.x,u[v++]=A.y,u[v++]=A.z}else{var G=0;if(n===i.ArcType.GEODESIC)for(f=0;f<P;f++)G+=c.PolygonGeometryLibrary.subdivideLineCount(t[f],t[(f+1)%P],r);else if(n===i.ArcType.RHUMB)for(f=0;f<P;f++)G+=c.PolygonGeometryLibrary.subdivideRhumbLineCount(e,t[f],t[(f+1)%P],r);for(u=new Float64Array(3*G),f=0;f<P;f++){var H;n===i.ArcType.GEODESIC?H=c.PolygonGeometryLibrary.subdivideLine(t[f],t[(f+1)%P],r,T):n===i.ArcType.RHUMB&&(H=c.PolygonGeometryLibrary.subdivideRhumbLine(e,t[f],t[(f+1)%P],r,T));for(var L=H.length,C=0;C<L;++C)u[v++]=H[C]}}P=u.length/3;var O=2*P,D=d.IndexDatatype.createTypedArray(P,O);for(v=0,f=0;f<P-1;f++)D[v++]=f,D[v++]=f+1;return D[v++]=P-1,D[v++]=0,new p.GeometryInstance({geometry:new l.Geometry({attributes:new s.GeometryAttributes({position:new l.GeometryAttribute({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:u})}),indices:D,primitiveType:l.PrimitiveType.LINES})})}function L(e,t,r,o,n){var u,f,h=y.EllipsoidTangentPlane.fromPoints(t,e),m=h.projectPointsOntoPlane(t,_),b=g.PolygonPipeline.computeWindingOrder2D(m);b===g.WindingOrder.CLOCKWISE&&(m.reverse(),t=t.slice().reverse());var P=t.length,v=new Array(P),E=0;if(o)for(u=new Float64Array(2*P*3*2),f=0;f<P;++f){v[f]=E/3;var A=t[f],G=t[(f+1)%P];u[E++]=A.x,u[E++]=A.y,u[E++]=A.z,u[E++]=G.x,u[E++]=G.y,u[E++]=G.z}else{var H=0;if(n===i.ArcType.GEODESIC)for(f=0;f<P;f++)H+=c.PolygonGeometryLibrary.subdivideLineCount(t[f],t[(f+1)%P],r);else if(n===i.ArcType.RHUMB)for(f=0;f<P;f++)H+=c.PolygonGeometryLibrary.subdivideRhumbLineCount(e,t[f],t[(f+1)%P],r);for(u=new Float64Array(3*H*2),f=0;f<P;++f){var L;v[f]=E/3,n===i.ArcType.GEODESIC?L=c.PolygonGeometryLibrary.subdivideLine(t[f],t[(f+1)%P],r,T):n===i.ArcType.RHUMB&&(L=c.PolygonGeometryLibrary.subdivideRhumbLine(e,t[f],t[(f+1)%P],r,T));for(var C=L.length,O=0;O<C;++O)u[E++]=L[O]}}P=u.length/6;var D=v.length,x=2*(2*P+D),I=d.IndexDatatype.createTypedArray(P+D,x);for(E=0,f=0;f<P;++f)I[E++]=f,I[E++]=(f+1)%P,I[E++]=f+P,I[E++]=(f+1)%P+P;for(f=0;f<D;f++){var w=v[f];I[E++]=w,I[E++]=w+P}return new p.GeometryInstance({geometry:new l.Geometry({attributes:new s.GeometryAttributes({position:new l.GeometryAttribute({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:u})}),indices:I,primitiveType:l.PrimitiveType.LINES})})}function C(r){if(n.Check.typeOf.object("options",r),n.Check.typeOf.object("options.polygonHierarchy",r.polygonHierarchy),r.perPositionHeight&&e.defined(r.height))throw new n.DeveloperError("Cannot use both options.perPositionHeight and options.height");if(e.defined(r.arcType)&&r.arcType!==i.ArcType.GEODESIC&&r.arcType!==i.ArcType.RHUMB)throw new n.DeveloperError("Invalid arcType. Valid options are ArcType.GEODESIC and ArcType.RHUMB.");var o=r.polygonHierarchy,y=e.defaultValue(r.ellipsoid,t.Ellipsoid.WGS84),l=e.defaultValue(r.granularity,a.CesiumMath.RADIANS_PER_DEGREE),s=e.defaultValue(r.perPositionHeight,!1),p=s&&e.defined(r.extrudedHeight),u=e.defaultValue(r.arcType,i.ArcType.GEODESIC),d=e.defaultValue(r.height,0),g=e.defaultValue(r.extrudedHeight,d);if(!p){var f=Math.max(d,g);g=Math.min(d,g),d=f}this._ellipsoid=t.Ellipsoid.clone(y),this._granularity=l,this._height=d,this._extrudedHeight=g,this._arcType=u,this._polygonHierarchy=o,this._perPositionHeight=s,this._perPositionHeightExtrude=p,this._offsetAttribute=r.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=c.PolygonGeometryLibrary.computeHierarchyPackedLength(o)+t.Ellipsoid.packedLength+8}C.pack=function(i,r,o){return n.Check.typeOf.object("value",i),n.Check.defined("array",r),o=e.defaultValue(o,0),o=c.PolygonGeometryLibrary.packPolygonHierarchy(i._polygonHierarchy,r,o),t.Ellipsoid.pack(i._ellipsoid,r,o),o+=t.Ellipsoid.packedLength,r[o++]=i._height,r[o++]=i._extrudedHeight,r[o++]=i._granularity,r[o++]=i._perPositionHeightExtrude?1:0,r[o++]=i._perPositionHeight?1:0,r[o++]=i._arcType,r[o++]=e.defaultValue(i._offsetAttribute,-1),r[o]=i.packedLength,r};var O=t.Ellipsoid.clone(t.Ellipsoid.UNIT_SPHERE),D={polygonHierarchy:{}};function x(i,r){return e.defined(r)&&(i=C.unpack(i,r)),i._ellipsoid=t.Ellipsoid.clone(i._ellipsoid),C.createGeometry(i)}return C.unpack=function(i,r,o){n.Check.defined("array",i),r=e.defaultValue(r,0);var a=c.PolygonGeometryLibrary.unpackPolygonHierarchy(i,r);r=a.startingIndex,delete a.startingIndex;var y=t.Ellipsoid.unpack(i,r,O);r+=t.Ellipsoid.packedLength;var l=i[r++],s=i[r++],p=i[r++],u=1===i[r++],d=1===i[r++],g=i[r++],f=i[r++],h=i[r];return e.defined(o)||(o=new C(D)),o._polygonHierarchy=a,o._ellipsoid=t.Ellipsoid.clone(y,o._ellipsoid),o._height=l,o._extrudedHeight=s,o._granularity=p,o._perPositionHeight=d,o._perPositionHeightExtrude=u,o._arcType=g,o._offsetAttribute=-1===f?void 0:f,o.packedLength=h,o},C.fromPositions=function(t){t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT),n.Check.defined("options.positions",t.positions);var i={polygonHierarchy:{positions:t.positions},height:t.height,extrudedHeight:t.extrudedHeight,ellipsoid:t.ellipsoid,granularity:t.granularity,perPositionHeight:t.perPositionHeight,arcType:t.arcType,offsetAttribute:t.offsetAttribute};return new C(i)},C.createGeometry=function(t){var i=t._ellipsoid,n=t._granularity,y=t._polygonHierarchy,s=t._perPositionHeight,p=t._arcType,d=c.PolygonGeometryLibrary.polygonOutlinesFromHierarchy(y,!s,i);if(0!==d.length){var f,h,m,b=[],P=a.CesiumMath.chordLength(n,i.maximumRadius),v=t._height,E=t._extrudedHeight,A=t._perPositionHeightExtrude||!a.CesiumMath.equalsEpsilon(v,E,0,a.CesiumMath.EPSILON2);if(A)for(m=0;m<d.length;m++){if(f=L(i,d[m],P,s,p),f.geometry=c.PolygonGeometryLibrary.scaleToGeodeticHeightExtruded(f.geometry,v,E,i,s),e.defined(t._offsetAttribute)){var G=f.geometry.attributes.position.values.length/3,_=new Uint8Array(G);t._offsetAttribute===r.GeometryOffsetAttribute.TOP?_=r.arrayFill(_,1,0,G/2):(h=t._offsetAttribute===r.GeometryOffsetAttribute.NONE?0:1,_=r.arrayFill(_,h)),f.geometry.attributes.applyOffset=new l.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:_})}b.push(f)}else for(m=0;m<d.length;m++){if(f=H(i,d[m],P,s,p),f.geometry.attributes.position.values=g.PolygonPipeline.scaleToGeodeticHeight(f.geometry.attributes.position.values,v,i,!s),e.defined(t._offsetAttribute)){var T=f.geometry.attributes.position.values.length,C=new Uint8Array(T/3);h=t._offsetAttribute===r.GeometryOffsetAttribute.NONE?0:1,r.arrayFill(C,h),f.geometry.attributes.applyOffset=new l.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:C})}b.push(f)}var O=u.GeometryPipeline.combineInstances(b)[0],D=o.BoundingSphere.fromVertices(O.attributes.position.values);return new l.Geometry({attributes:O.attributes,indices:O.indices,primitiveType:O.primitiveType,boundingSphere:D,offsetAttribute:t._offsetAttribute})}},x}));