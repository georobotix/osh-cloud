"use strict";(self["webpackChunkvue3_webpack5"]=self["webpackChunkvue3_webpack5"]||[]).push([[6183],{79162:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(88108);\n/* harmony import */ var _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(48243);\n/* harmony import */ var _Core_BoxOutlineGeometry_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(27495);\n/* harmony import */ var _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(60838);\n/* harmony import */ var _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(60216);\n/* harmony import */ var _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(63367);\n/* harmony import */ var _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(51688);\n/* harmony import */ var _Core_clone_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(83856);\n/* harmony import */ var _Core_Color_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(59947);\n/* harmony import */ var _Core_ColorGeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(92062);\n/* harmony import */ var _Core_combine_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(8182);\n/* harmony import */ var _Core_CullingVolume_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(17711);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(82982);\n/* harmony import */ var _Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(86511);\n/* harmony import */ var _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(12572);\n/* harmony import */ var _Core_FeatureDetection_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(96037);\n/* harmony import */ var _Core_GeometryInstance_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(26865);\n/* harmony import */ var _Core_Intersect_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(84935);\n/* harmony import */ var _Core_Math_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(99417);\n/* harmony import */ var _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(72248);\n/* harmony import */ var _Core_OrthographicOffCenterFrustum_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(35131);\n/* harmony import */ var _Core_PerspectiveFrustum_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(66854);\n/* harmony import */ var _Core_PixelFormat_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(38443);\n/* harmony import */ var _Core_Quaternion_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(87811);\n/* harmony import */ var _Core_SphereOutlineGeometry_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(38779);\n/* harmony import */ var _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(52200);\n/* harmony import */ var _Renderer_ClearCommand_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(39899);\n/* harmony import */ var _Renderer_ContextLimits_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(20521);\n/* harmony import */ var _Renderer_CubeMap_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(51107);\n/* harmony import */ var _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(60072);\n/* harmony import */ var _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(2932);\n/* harmony import */ var _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(8379);\n/* harmony import */ var _Renderer_PassState_js__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(65121);\n/* harmony import */ var _Renderer_PixelDatatype_js__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(21572);\n/* harmony import */ var _Renderer_Renderbuffer_js__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(17941);\n/* harmony import */ var _Renderer_RenderbufferFormat_js__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(89032);\n/* harmony import */ var _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(10667);\n/* harmony import */ var _Renderer_Sampler_js__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(87721);\n/* harmony import */ var _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(8743);\n/* harmony import */ var _Camera_js__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(70561);\n/* harmony import */ var _CullFace_js__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(71593);\n/* harmony import */ var _DebugCameraPrimitive_js__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(96548);\n/* harmony import */ var _PerInstanceColorAppearance_js__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(64060);\n/* harmony import */ var _Primitive_js__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(34380);\n/* harmony import */ var _ShadowMapShader_js__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(2143);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Use {@link Viewer#shadowMap} to get the scene\'s shadow map. Do not construct this directly.\n *\n * <p>\n * The normalOffset bias pushes the shadows forward slightly, and may be disabled\n * for applications that require ultra precise shadows.\n * </p>\n *\n * @alias ShadowMap\n * @internalConstructor\n * @class\n *\n * @param {Object} options An object containing the following properties:\n * @param {Camera} options.lightCamera A camera representing the light source.\n * @param {Boolean} [options.enabled=true] Whether the shadow map is enabled.\n * @param {Boolean} [options.isPointLight=false] Whether the light source is a point light. Point light shadows do not use cascades.\n * @param {Boolean} [options.pointLightRadius=100.0] Radius of the point light.\n * @param {Boolean} [options.cascadesEnabled=true] Use multiple shadow maps to cover different partitions of the view frustum.\n * @param {Number} [options.numberOfCascades=4] The number of cascades to use for the shadow map. Supported values are one and four.\n * @param {Number} [options.maximumDistance=5000.0] The maximum distance used for generating cascaded shadows. Lower values improve shadow quality.\n * @param {Number} [options.size=2048] The width and height, in pixels, of each shadow map.\n * @param {Boolean} [options.softShadows=false] Whether percentage-closer-filtering is enabled for producing softer shadows.\n * @param {Number} [options.darkness=0.3] The shadow darkness.\n * @param {Boolean} [options.normalOffset=true] Whether a normal bias is applied to shadows.\n * @param {Boolean} [options.fadingEnabled=true] Whether shadows start to fade out once the light gets closer to the horizon.\n *\n * @exception {DeveloperError} Only one or four cascades are supported.\n *\n * @demo {@link https://sandcastle.cesium.com/index.html?src=Shadows.html|Cesium Sandcastle Shadows Demo}\n */\nfunction ShadowMap(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n  // options.context is an undocumented option\n  var context = options.context;\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(context)) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z("context is required.");\n  }\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(options.lightCamera)) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z("lightCamera is required.");\n  }\n  if (\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(options.numberOfCascades) &&\n    options.numberOfCascades !== 1 &&\n    options.numberOfCascades !== 4\n  ) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z("Only one or four cascades are supported.");\n  }\n  //>>includeEnd(\'debug\');\n\n  this._enabled = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(options.enabled, true);\n  this._softShadows = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(options.softShadows, false);\n  this._normalOffset = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(options.normalOffset, true);\n  this.dirty = true;\n\n  /**\n   * Specifies whether the shadow map originates from a light source. Shadow maps that are used for analytical\n   * purposes should set this to false so as not to affect scene rendering.\n   *\n   * @private\n   */\n  this.fromLightSource = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(options.fromLightSource, true);\n\n  /**\n   * Determines the darkness of the shadows.\n   *\n   * @type {Number}\n   * @default 0.3\n   */\n  this.darkness = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(options.darkness, 0.3);\n  this._darkness = this.darkness;\n\n  /**\n   * Determines whether shadows start to fade out once the light gets closer to the horizon.\n   *\n   * @type {Boolean}\n   * @default true\n   */\n  this.fadingEnabled = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(options.fadingEnabled, true);\n\n  /**\n   * Determines the maximum distance of the shadow map. Only applicable for cascaded shadows. Larger distances may result in lower quality shadows.\n   *\n   * @type {Number}\n   * @default 5000.0\n   */\n  this.maximumDistance = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(options.maximumDistance, 5000.0);\n\n  this._outOfView = false;\n  this._outOfViewPrevious = false;\n  this._needsUpdate = true;\n\n  // In IE11 and Edge polygon offset is not functional.\n  // TODO : Also disabled for instances of Firefox and Chrome running ANGLE that do not support depth textures.\n  // Re-enable once https://github.com/CesiumGS/cesium/issues/4560 is resolved.\n  var polygonOffsetSupported = true;\n  if (\n    _Core_FeatureDetection_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"].isInternetExplorer */ .Z.isInternetExplorer() ||\n    _Core_FeatureDetection_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"].isEdge */ .Z.isEdge() ||\n    ((_Core_FeatureDetection_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"].isChrome */ .Z.isChrome() || _Core_FeatureDetection_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"].isFirefox */ .Z.isFirefox()) &&\n      _Core_FeatureDetection_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"].isWindows */ .Z.isWindows() &&\n      !context.depthTexture)\n  ) {\n    polygonOffsetSupported = false;\n  }\n  this._polygonOffsetSupported = polygonOffsetSupported;\n\n  this._terrainBias = {\n    polygonOffset: polygonOffsetSupported,\n    polygonOffsetFactor: 1.1,\n    polygonOffsetUnits: 4.0,\n    normalOffset: this._normalOffset,\n    normalOffsetScale: 0.5,\n    normalShading: true,\n    normalShadingSmooth: 0.3,\n    depthBias: 0.0001,\n  };\n\n  this._primitiveBias = {\n    polygonOffset: polygonOffsetSupported,\n    polygonOffsetFactor: 1.1,\n    polygonOffsetUnits: 4.0,\n    normalOffset: this._normalOffset,\n    normalOffsetScale: 0.1,\n    normalShading: true,\n    normalShadingSmooth: 0.05,\n    depthBias: 0.00002,\n  };\n\n  this._pointBias = {\n    polygonOffset: false,\n    polygonOffsetFactor: 1.1,\n    polygonOffsetUnits: 4.0,\n    normalOffset: this._normalOffset,\n    normalOffsetScale: 0.0,\n    normalShading: true,\n    normalShadingSmooth: 0.1,\n    depthBias: 0.0005,\n  };\n\n  // Framebuffer resources\n  this._depthAttachment = undefined;\n  this._colorAttachment = undefined;\n\n  // Uniforms\n  this._shadowMapMatrix = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z();\n  this._shadowMapTexture = undefined;\n  this._lightDirectionEC = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\n  this._lightPositionEC = new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z();\n  this._distance = 0.0;\n\n  this._lightCamera = options.lightCamera;\n  this._shadowMapCamera = new ShadowMapCamera();\n  this._shadowMapCullingVolume = undefined;\n  this._sceneCamera = undefined;\n  this._boundingSphere = new _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\n\n  this._isPointLight = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(options.isPointLight, false);\n  this._pointLightRadius = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(options.pointLightRadius, 100.0);\n\n  this._cascadesEnabled = this._isPointLight\n    ? false\n    : (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(options.cascadesEnabled, true);\n  this._numberOfCascades = !this._cascadesEnabled\n    ? 0\n    : (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(options.numberOfCascades, 4);\n  this._fitNearFar = true;\n  this._maximumCascadeDistances = [25.0, 150.0, 700.0, Number.MAX_VALUE];\n\n  this._textureSize = new _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\n\n  this._isSpotLight = false;\n  if (this._cascadesEnabled) {\n    // Cascaded shadows are always orthographic. The frustum dimensions are calculated on the fly.\n    this._shadowMapCamera.frustum = new _Core_OrthographicOffCenterFrustum_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"] */ .Z();\n  } else if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(this._lightCamera.frustum.fov)) {\n    // If the light camera uses a perspective frustum, then the light source is a spot light\n    this._isSpotLight = true;\n  }\n\n  // Uniforms\n  this._cascadeSplits = [new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z(), new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z()];\n  this._cascadeMatrices = [\n    new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z(),\n    new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z(),\n    new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z(),\n    new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z(),\n  ];\n  this._cascadeDistances = new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z();\n\n  var numberOfPasses;\n  if (this._isPointLight) {\n    numberOfPasses = 6; // One shadow map for each direction\n  } else if (!this._cascadesEnabled) {\n    numberOfPasses = 1;\n  } else {\n    numberOfPasses = this._numberOfCascades;\n  }\n\n  this._passes = new Array(numberOfPasses);\n  for (var i = 0; i < numberOfPasses; ++i) {\n    this._passes[i] = new ShadowPass(context);\n  }\n\n  this.debugShow = false;\n  this.debugFreezeFrame = false;\n  this._debugFreezeFrame = false;\n  this._debugCascadeColors = false;\n  this._debugLightFrustum = undefined;\n  this._debugCameraFrustum = undefined;\n  this._debugCascadeFrustums = new Array(this._numberOfCascades);\n  this._debugShadowViewCommand = undefined;\n\n  this._usesDepthTexture = context.depthTexture;\n\n  if (this._isPointLight) {\n    this._usesDepthTexture = false;\n  }\n\n  // Create render states for shadow casters\n  this._primitiveRenderState = undefined;\n  this._terrainRenderState = undefined;\n  this._pointRenderState = undefined;\n  createRenderStates(this);\n\n  // For clearing the shadow map texture every frame\n  this._clearCommand = new _Renderer_ClearCommand_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z({\n    depth: 1.0,\n    color: new _Core_Color_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z(),\n  });\n\n  this._clearPassState = new _Renderer_PassState_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"] */ .Z(context);\n\n  this._size = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(options.size, 2048);\n  this.size = this._size;\n}\n\n/**\n * Global maximum shadow distance used to prevent far off receivers from extending\n * the shadow far plane. This helps set a tighter near/far when viewing objects from space.\n *\n * @private\n */\nShadowMap.MAXIMUM_DISTANCE = 20000.0;\n\nfunction ShadowPass(context) {\n  this.camera = new ShadowMapCamera();\n  this.passState = new _Renderer_PassState_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"] */ .Z(context);\n  this.framebuffer = undefined;\n  this.textureOffsets = undefined;\n  this.commandList = [];\n  this.cullingVolume = undefined;\n}\n\nfunction createRenderState(colorMask, bias) {\n  return _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_35__/* ["default"].fromCache */ .Z.fromCache({\n    cull: {\n      enabled: true,\n      face: _CullFace_js__WEBPACK_IMPORTED_MODULE_39__/* ["default"].BACK */ .Z.BACK,\n    },\n    depthTest: {\n      enabled: true,\n    },\n    colorMask: {\n      red: colorMask,\n      green: colorMask,\n      blue: colorMask,\n      alpha: colorMask,\n    },\n    depthMask: true,\n    polygonOffset: {\n      enabled: bias.polygonOffset,\n      factor: bias.polygonOffsetFactor,\n      units: bias.polygonOffsetUnits,\n    },\n  });\n}\n\nfunction createRenderStates(shadowMap) {\n  // Enable the color mask if the shadow map is backed by a color texture, e.g. when depth textures aren\'t supported\n  var colorMask = !shadowMap._usesDepthTexture;\n  shadowMap._primitiveRenderState = createRenderState(\n    colorMask,\n    shadowMap._primitiveBias\n  );\n  shadowMap._terrainRenderState = createRenderState(\n    colorMask,\n    shadowMap._terrainBias\n  );\n  shadowMap._pointRenderState = createRenderState(\n    colorMask,\n    shadowMap._pointBias\n  );\n}\n\n/**\n * @private\n */\nShadowMap.prototype.debugCreateRenderStates = function () {\n  createRenderStates(this);\n};\n\nObject.defineProperties(ShadowMap.prototype, {\n  /**\n   * Determines if the shadow map will be shown.\n   *\n   * @memberof ShadowMap.prototype\n   * @type {Boolean}\n   * @default true\n   */\n  enabled: {\n    get: function () {\n      return this._enabled;\n    },\n    set: function (value) {\n      this.dirty = this._enabled !== value;\n      this._enabled = value;\n    },\n  },\n\n  /**\n   * Determines if a normal bias will be applied to shadows.\n   *\n   * @memberof ShadowMap.prototype\n   * @type {Boolean}\n   * @default true\n   */\n  normalOffset: {\n    get: function () {\n      return this._normalOffset;\n    },\n    set: function (value) {\n      this.dirty = this._normalOffset !== value;\n      this._normalOffset = value;\n      this._terrainBias.normalOffset = value;\n      this._primitiveBias.normalOffset = value;\n      this._pointBias.normalOffset = value;\n    },\n  },\n\n  /**\n   * Determines if soft shadows are enabled. Uses pcf filtering which requires more texture reads and may hurt performance.\n   *\n   * @memberof ShadowMap.prototype\n   * @type {Boolean}\n   * @default false\n   */\n  softShadows: {\n    get: function () {\n      return this._softShadows;\n    },\n    set: function (value) {\n      this.dirty = this._softShadows !== value;\n      this._softShadows = value;\n    },\n  },\n\n  /**\n   * The width and height, in pixels, of each shadow map.\n   *\n   * @memberof ShadowMap.prototype\n   * @type {Number}\n   * @default 2048\n   */\n  size: {\n    get: function () {\n      return this._size;\n    },\n    set: function (value) {\n      resize(this, value);\n    },\n  },\n\n  /**\n   * Whether the shadow map is out of view of the scene camera.\n   *\n   * @memberof ShadowMap.prototype\n   * @type {Boolean}\n   * @readonly\n   * @private\n   */\n  outOfView: {\n    get: function () {\n      return this._outOfView;\n    },\n  },\n\n  /**\n   * The culling volume of the shadow frustum.\n   *\n   * @memberof ShadowMap.prototype\n   * @type {CullingVolume}\n   * @readonly\n   * @private\n   */\n  shadowMapCullingVolume: {\n    get: function () {\n      return this._shadowMapCullingVolume;\n    },\n  },\n\n  /**\n   * The passes used for rendering shadows. Each face of a point light or each cascade for a cascaded shadow map is a separate pass.\n   *\n   * @memberof ShadowMap.prototype\n   * @type {ShadowPass[]}\n   * @readonly\n   * @private\n   */\n  passes: {\n    get: function () {\n      return this._passes;\n    },\n  },\n\n  /**\n   * Whether the light source is a point light.\n   *\n   * @memberof ShadowMap.prototype\n   * @type {Boolean}\n   * @readonly\n   * @private\n   */\n  isPointLight: {\n    get: function () {\n      return this._isPointLight;\n    },\n  },\n\n  /**\n   * Debug option for visualizing the cascades by color.\n   *\n   * @memberof ShadowMap.prototype\n   * @type {Boolean}\n   * @default false\n   * @private\n   */\n  debugCascadeColors: {\n    get: function () {\n      return this._debugCascadeColors;\n    },\n    set: function (value) {\n      this.dirty = this._debugCascadeColors !== value;\n      this._debugCascadeColors = value;\n    },\n  },\n});\n\nfunction destroyFramebuffer(shadowMap) {\n  var length = shadowMap._passes.length;\n  for (var i = 0; i < length; ++i) {\n    var pass = shadowMap._passes[i];\n    var framebuffer = pass.framebuffer;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(framebuffer) && !framebuffer.isDestroyed()) {\n      framebuffer.destroy();\n    }\n    pass.framebuffer = undefined;\n  }\n\n  // Destroy the framebuffer attachments\n  shadowMap._depthAttachment =\n    shadowMap._depthAttachment && shadowMap._depthAttachment.destroy();\n  shadowMap._colorAttachment =\n    shadowMap._colorAttachment && shadowMap._colorAttachment.destroy();\n}\n\nfunction createFramebufferColor(shadowMap, context) {\n  var depthRenderbuffer = new _Renderer_Renderbuffer_js__WEBPACK_IMPORTED_MODULE_33__/* ["default"] */ .Z({\n    context: context,\n    width: shadowMap._textureSize.x,\n    height: shadowMap._textureSize.y,\n    format: _Renderer_RenderbufferFormat_js__WEBPACK_IMPORTED_MODULE_34__/* ["default"].DEPTH_COMPONENT16 */ .Z.DEPTH_COMPONENT16,\n  });\n\n  var colorTexture = new _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"] */ .Z({\n    context: context,\n    width: shadowMap._textureSize.x,\n    height: shadowMap._textureSize.y,\n    pixelFormat: _Core_PixelFormat_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].RGBA */ .Z.RGBA,\n    pixelDatatype: _Renderer_PixelDatatype_js__WEBPACK_IMPORTED_MODULE_32__/* ["default"].UNSIGNED_BYTE */ .Z.UNSIGNED_BYTE,\n    sampler: _Renderer_Sampler_js__WEBPACK_IMPORTED_MODULE_36__/* ["default"].NEAREST */ .Z.NEAREST,\n  });\n\n  var framebuffer = new _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"] */ .Z({\n    context: context,\n    depthRenderbuffer: depthRenderbuffer,\n    colorTextures: [colorTexture],\n    destroyAttachments: false,\n  });\n\n  var length = shadowMap._passes.length;\n  for (var i = 0; i < length; ++i) {\n    var pass = shadowMap._passes[i];\n    pass.framebuffer = framebuffer;\n    pass.passState.framebuffer = framebuffer;\n  }\n\n  shadowMap._shadowMapTexture = colorTexture;\n  shadowMap._depthAttachment = depthRenderbuffer;\n  shadowMap._colorAttachment = colorTexture;\n}\n\nfunction createFramebufferDepth(shadowMap, context) {\n  var depthStencilTexture = new _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"] */ .Z({\n    context: context,\n    width: shadowMap._textureSize.x,\n    height: shadowMap._textureSize.y,\n    pixelFormat: _Core_PixelFormat_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].DEPTH_STENCIL */ .Z.DEPTH_STENCIL,\n    pixelDatatype: _Renderer_PixelDatatype_js__WEBPACK_IMPORTED_MODULE_32__/* ["default"].UNSIGNED_INT_24_8 */ .Z.UNSIGNED_INT_24_8,\n    sampler: _Renderer_Sampler_js__WEBPACK_IMPORTED_MODULE_36__/* ["default"].NEAREST */ .Z.NEAREST,\n  });\n\n  var framebuffer = new _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"] */ .Z({\n    context: context,\n    depthStencilTexture: depthStencilTexture,\n    destroyAttachments: false,\n  });\n\n  var length = shadowMap._passes.length;\n  for (var i = 0; i < length; ++i) {\n    var pass = shadowMap._passes[i];\n    pass.framebuffer = framebuffer;\n    pass.passState.framebuffer = framebuffer;\n  }\n\n  shadowMap._shadowMapTexture = depthStencilTexture;\n  shadowMap._depthAttachment = depthStencilTexture;\n}\n\nfunction createFramebufferCube(shadowMap, context) {\n  var depthRenderbuffer = new _Renderer_Renderbuffer_js__WEBPACK_IMPORTED_MODULE_33__/* ["default"] */ .Z({\n    context: context,\n    width: shadowMap._textureSize.x,\n    height: shadowMap._textureSize.y,\n    format: _Renderer_RenderbufferFormat_js__WEBPACK_IMPORTED_MODULE_34__/* ["default"].DEPTH_COMPONENT16 */ .Z.DEPTH_COMPONENT16,\n  });\n\n  var cubeMap = new _Renderer_CubeMap_js__WEBPACK_IMPORTED_MODULE_28__/* ["default"] */ .Z({\n    context: context,\n    width: shadowMap._textureSize.x,\n    height: shadowMap._textureSize.y,\n    pixelFormat: _Core_PixelFormat_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].RGBA */ .Z.RGBA,\n    pixelDatatype: _Renderer_PixelDatatype_js__WEBPACK_IMPORTED_MODULE_32__/* ["default"].UNSIGNED_BYTE */ .Z.UNSIGNED_BYTE,\n    sampler: _Renderer_Sampler_js__WEBPACK_IMPORTED_MODULE_36__/* ["default"].NEAREST */ .Z.NEAREST,\n  });\n\n  var faces = [\n    cubeMap.negativeX,\n    cubeMap.negativeY,\n    cubeMap.negativeZ,\n    cubeMap.positiveX,\n    cubeMap.positiveY,\n    cubeMap.positiveZ,\n  ];\n\n  for (var i = 0; i < 6; ++i) {\n    var framebuffer = new _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"] */ .Z({\n      context: context,\n      depthRenderbuffer: depthRenderbuffer,\n      colorTextures: [faces[i]],\n      destroyAttachments: false,\n    });\n    var pass = shadowMap._passes[i];\n    pass.framebuffer = framebuffer;\n    pass.passState.framebuffer = framebuffer;\n  }\n\n  shadowMap._shadowMapTexture = cubeMap;\n  shadowMap._depthAttachment = depthRenderbuffer;\n  shadowMap._colorAttachment = cubeMap;\n}\n\nfunction createFramebuffer(shadowMap, context) {\n  if (shadowMap._isPointLight) {\n    createFramebufferCube(shadowMap, context);\n  } else if (shadowMap._usesDepthTexture) {\n    createFramebufferDepth(shadowMap, context);\n  } else {\n    createFramebufferColor(shadowMap, context);\n  }\n}\n\nfunction checkFramebuffer(shadowMap, context) {\n  // Attempt to make an FBO with only a depth texture. If it fails, fallback to a color texture.\n  if (\n    shadowMap._usesDepthTexture &&\n    shadowMap._passes[0].framebuffer.status !==\n      _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_25__/* ["default"].FRAMEBUFFER_COMPLETE */ .Z.FRAMEBUFFER_COMPLETE\n  ) {\n    shadowMap._usesDepthTexture = false;\n    createRenderStates(shadowMap);\n    destroyFramebuffer(shadowMap);\n    createFramebuffer(shadowMap, context);\n  }\n}\n\nfunction updateFramebuffer(shadowMap, context) {\n  if (\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(shadowMap._passes[0].framebuffer) ||\n    shadowMap._shadowMapTexture.width !== shadowMap._textureSize.x\n  ) {\n    destroyFramebuffer(shadowMap);\n    createFramebuffer(shadowMap, context);\n    checkFramebuffer(shadowMap, context);\n    clearFramebuffer(shadowMap, context);\n  }\n}\n\nfunction clearFramebuffer(shadowMap, context, shadowPass) {\n  shadowPass = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(shadowPass, 0);\n  if (shadowMap._isPointLight || shadowPass === 0) {\n    shadowMap._clearCommand.framebuffer =\n      shadowMap._passes[shadowPass].framebuffer;\n    shadowMap._clearCommand.execute(context, shadowMap._clearPassState);\n  }\n}\n\nfunction resize(shadowMap, size) {\n  shadowMap._size = size;\n  var passes = shadowMap._passes;\n  var numberOfPasses = passes.length;\n  var textureSize = shadowMap._textureSize;\n\n  if (shadowMap._isPointLight) {\n    size =\n      _Renderer_ContextLimits_js__WEBPACK_IMPORTED_MODULE_27__/* ["default"].maximumCubeMapSize */ .Z.maximumCubeMapSize >= size\n        ? size\n        : _Renderer_ContextLimits_js__WEBPACK_IMPORTED_MODULE_27__/* ["default"].maximumCubeMapSize */ .Z.maximumCubeMapSize;\n    textureSize.x = size;\n    textureSize.y = size;\n    var faceViewport = new _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(0, 0, size, size);\n    passes[0].passState.viewport = faceViewport;\n    passes[1].passState.viewport = faceViewport;\n    passes[2].passState.viewport = faceViewport;\n    passes[3].passState.viewport = faceViewport;\n    passes[4].passState.viewport = faceViewport;\n    passes[5].passState.viewport = faceViewport;\n  } else if (numberOfPasses === 1) {\n    // +----+\n    // |  1 |\n    // +----+\n    size =\n      _Renderer_ContextLimits_js__WEBPACK_IMPORTED_MODULE_27__/* ["default"].maximumTextureSize */ .Z.maximumTextureSize >= size\n        ? size\n        : _Renderer_ContextLimits_js__WEBPACK_IMPORTED_MODULE_27__/* ["default"].maximumTextureSize */ .Z.maximumTextureSize;\n    textureSize.x = size;\n    textureSize.y = size;\n    passes[0].passState.viewport = new _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(0, 0, size, size);\n  } else if (numberOfPasses === 4) {\n    // +----+----+\n    // |  3 |  4 |\n    // +----+----+\n    // |  1 |  2 |\n    // +----+----+\n    size =\n      _Renderer_ContextLimits_js__WEBPACK_IMPORTED_MODULE_27__/* ["default"].maximumTextureSize */ .Z.maximumTextureSize >= size * 2\n        ? size\n        : _Renderer_ContextLimits_js__WEBPACK_IMPORTED_MODULE_27__/* ["default"].maximumTextureSize */ .Z.maximumTextureSize / 2;\n    textureSize.x = size * 2;\n    textureSize.y = size * 2;\n    passes[0].passState.viewport = new _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(0, 0, size, size);\n    passes[1].passState.viewport = new _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(size, 0, size, size);\n    passes[2].passState.viewport = new _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(0, size, size, size);\n    passes[3].passState.viewport = new _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(\n      size,\n      size,\n      size,\n      size\n    );\n  }\n\n  // Update clear pass state\n  shadowMap._clearPassState.viewport = new _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(\n    0,\n    0,\n    textureSize.x,\n    textureSize.y\n  );\n\n  // Transforms shadow coordinates [0, 1] into the pass\'s region of the texture\n  for (var i = 0; i < numberOfPasses; ++i) {\n    var pass = passes[i];\n    var viewport = pass.passState.viewport;\n    var biasX = viewport.x / textureSize.x;\n    var biasY = viewport.y / textureSize.y;\n    var scaleX = viewport.width / textureSize.x;\n    var scaleY = viewport.height / textureSize.y;\n    pass.textureOffsets = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z(\n      scaleX,\n      0.0,\n      0.0,\n      biasX,\n      0.0,\n      scaleY,\n      0.0,\n      biasY,\n      0.0,\n      0.0,\n      1.0,\n      0.0,\n      0.0,\n      0.0,\n      0.0,\n      1.0\n    );\n  }\n}\n\nvar scratchViewport = new _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\n\nfunction createDebugShadowViewCommand(shadowMap, context) {\n  var fs;\n  if (shadowMap._isPointLight) {\n    fs =\n      "uniform samplerCube shadowMap_textureCube; \\n" +\n      "varying vec2 v_textureCoordinates; \\n" +\n      "void main() \\n" +\n      "{ \\n" +\n      "    vec2 uv = v_textureCoordinates; \\n" +\n      "    vec3 dir; \\n" +\n      " \\n" +\n      "    if (uv.y < 0.5) \\n" +\n      "    { \\n" +\n      "        if (uv.x < 0.333) \\n" +\n      "        { \\n" +\n      "            dir.x = -1.0; \\n" +\n      "            dir.y = uv.x * 6.0 - 1.0; \\n" +\n      "            dir.z = uv.y * 4.0 - 1.0; \\n" +\n      "        } \\n" +\n      "        else if (uv.x < 0.666) \\n" +\n      "        { \\n" +\n      "            dir.y = -1.0; \\n" +\n      "            dir.x = uv.x * 6.0 - 3.0; \\n" +\n      "            dir.z = uv.y * 4.0 - 1.0; \\n" +\n      "        } \\n" +\n      "        else \\n" +\n      "        { \\n" +\n      "            dir.z = -1.0; \\n" +\n      "            dir.x = uv.x * 6.0 - 5.0; \\n" +\n      "            dir.y = uv.y * 4.0 - 1.0; \\n" +\n      "        } \\n" +\n      "    } \\n" +\n      "    else \\n" +\n      "    { \\n" +\n      "        if (uv.x < 0.333) \\n" +\n      "        { \\n" +\n      "            dir.x = 1.0; \\n" +\n      "            dir.y = uv.x * 6.0 - 1.0; \\n" +\n      "            dir.z = uv.y * 4.0 - 3.0; \\n" +\n      "        } \\n" +\n      "        else if (uv.x < 0.666) \\n" +\n      "        { \\n" +\n      "            dir.y = 1.0; \\n" +\n      "            dir.x = uv.x * 6.0 - 3.0; \\n" +\n      "            dir.z = uv.y * 4.0 - 3.0; \\n" +\n      "        } \\n" +\n      "        else \\n" +\n      "        { \\n" +\n      "            dir.z = 1.0; \\n" +\n      "            dir.x = uv.x * 6.0 - 5.0; \\n" +\n      "            dir.y = uv.y * 4.0 - 3.0; \\n" +\n      "        } \\n" +\n      "    } \\n" +\n      " \\n" +\n      "    float shadow = czm_unpackDepth(textureCube(shadowMap_textureCube, dir)); \\n" +\n      "    gl_FragColor = vec4(vec3(shadow), 1.0); \\n" +\n      "} \\n";\n  } else {\n    fs =\n      "uniform sampler2D shadowMap_texture; \\n" +\n      "varying vec2 v_textureCoordinates; \\n" +\n      "void main() \\n" +\n      "{ \\n" +\n      (shadowMap._usesDepthTexture\n        ? "    float shadow = texture2D(shadowMap_texture, v_textureCoordinates).r; \\n"\n        : "    float shadow = czm_unpackDepth(texture2D(shadowMap_texture, v_textureCoordinates)); \\n") +\n      "    gl_FragColor = vec4(vec3(shadow), 1.0); \\n" +\n      "} \\n";\n  }\n\n  var drawCommand = context.createViewportQuadCommand(fs, {\n    uniformMap: {\n      shadowMap_texture: function () {\n        return shadowMap._shadowMapTexture;\n      },\n      shadowMap_textureCube: function () {\n        return shadowMap._shadowMapTexture;\n      },\n    },\n  });\n  drawCommand.pass = _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_31__/* ["default"].OVERLAY */ .Z.OVERLAY;\n  return drawCommand;\n}\n\nfunction updateDebugShadowViewCommand(shadowMap, frameState) {\n  // Draws the shadow map on the bottom-right corner of the screen\n  var context = frameState.context;\n  var screenWidth = frameState.context.drawingBufferWidth;\n  var screenHeight = frameState.context.drawingBufferHeight;\n  var size = Math.min(screenWidth, screenHeight) * 0.3;\n\n  var viewport = scratchViewport;\n  viewport.x = screenWidth - size;\n  viewport.y = 0;\n  viewport.width = size;\n  viewport.height = size;\n\n  var debugCommand = shadowMap._debugShadowViewCommand;\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(debugCommand)) {\n    debugCommand = createDebugShadowViewCommand(shadowMap, context);\n    shadowMap._debugShadowViewCommand = debugCommand;\n  }\n\n  // Get a new RenderState for the updated viewport size\n  if (\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(debugCommand.renderState) ||\n    !_Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].equals */ .Z.equals(debugCommand.renderState.viewport, viewport)\n  ) {\n    debugCommand.renderState = _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_35__/* ["default"].fromCache */ .Z.fromCache({\n      viewport: _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone(viewport),\n    });\n  }\n\n  frameState.commandList.push(shadowMap._debugShadowViewCommand);\n}\n\nvar frustumCornersNDC = new Array(8);\nfrustumCornersNDC[0] = new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z(-1.0, -1.0, -1.0, 1.0);\nfrustumCornersNDC[1] = new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z(1.0, -1.0, -1.0, 1.0);\nfrustumCornersNDC[2] = new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z(1.0, 1.0, -1.0, 1.0);\nfrustumCornersNDC[3] = new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z(-1.0, 1.0, -1.0, 1.0);\nfrustumCornersNDC[4] = new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z(-1.0, -1.0, 1.0, 1.0);\nfrustumCornersNDC[5] = new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z(1.0, -1.0, 1.0, 1.0);\nfrustumCornersNDC[6] = new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z(1.0, 1.0, 1.0, 1.0);\nfrustumCornersNDC[7] = new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z(-1.0, 1.0, 1.0, 1.0);\n\nvar scratchMatrix = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z();\nvar scratchFrustumCorners = new Array(8);\nfor (var i = 0; i < 8; ++i) {\n  scratchFrustumCorners[i] = new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z();\n}\n\nfunction createDebugPointLight(modelMatrix, color) {\n  var box = new _Core_GeometryInstance_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z({\n    geometry: new _Core_BoxOutlineGeometry_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z({\n      minimum: new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(-0.5, -0.5, -0.5),\n      maximum: new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(0.5, 0.5, 0.5),\n    }),\n    attributes: {\n      color: _Core_ColorGeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].fromColor */ .Z.fromColor(color),\n    },\n  });\n\n  var sphere = new _Core_GeometryInstance_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z({\n    geometry: new _Core_SphereOutlineGeometry_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z({\n      radius: 0.5,\n    }),\n    attributes: {\n      color: _Core_ColorGeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].fromColor */ .Z.fromColor(color),\n    },\n  });\n\n  return new _Primitive_js__WEBPACK_IMPORTED_MODULE_42__/* ["default"] */ .Z({\n    geometryInstances: [box, sphere],\n    appearance: new _PerInstanceColorAppearance_js__WEBPACK_IMPORTED_MODULE_41__/* ["default"] */ .Z({\n      translucent: false,\n      flat: true,\n    }),\n    asynchronous: false,\n    modelMatrix: modelMatrix,\n  });\n}\n\nvar debugOutlineColors = [_Core_Color_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].RED */ .Z.RED, _Core_Color_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].GREEN */ .Z.GREEN, _Core_Color_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].BLUE */ .Z.BLUE, _Core_Color_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].MAGENTA */ .Z.MAGENTA];\nvar scratchScale = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\n\nfunction applyDebugSettings(shadowMap, frameState) {\n  updateDebugShadowViewCommand(shadowMap, frameState);\n\n  var enterFreezeFrame =\n    shadowMap.debugFreezeFrame && !shadowMap._debugFreezeFrame;\n  shadowMap._debugFreezeFrame = shadowMap.debugFreezeFrame;\n\n  // Draw scene camera in freeze frame mode\n  if (shadowMap.debugFreezeFrame) {\n    if (enterFreezeFrame) {\n      // Recreate debug camera when entering freeze frame mode\n      shadowMap._debugCameraFrustum =\n        shadowMap._debugCameraFrustum &&\n        shadowMap._debugCameraFrustum.destroy();\n      shadowMap._debugCameraFrustum = new _DebugCameraPrimitive_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z({\n        camera: shadowMap._sceneCamera,\n        color: _Core_Color_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].CYAN */ .Z.CYAN,\n        updateOnChange: false,\n      });\n    }\n    shadowMap._debugCameraFrustum.update(frameState);\n  }\n\n  if (shadowMap._cascadesEnabled) {\n    // Draw cascades only in freeze frame mode\n    if (shadowMap.debugFreezeFrame) {\n      if (enterFreezeFrame) {\n        // Recreate debug frustum when entering freeze frame mode\n        shadowMap._debugLightFrustum =\n          shadowMap._debugLightFrustum &&\n          shadowMap._debugLightFrustum.destroy();\n        shadowMap._debugLightFrustum = new _DebugCameraPrimitive_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z({\n          camera: shadowMap._shadowMapCamera,\n          color: _Core_Color_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].YELLOW */ .Z.YELLOW,\n          updateOnChange: false,\n        });\n      }\n      shadowMap._debugLightFrustum.update(frameState);\n\n      for (var i = 0; i < shadowMap._numberOfCascades; ++i) {\n        if (enterFreezeFrame) {\n          // Recreate debug frustum when entering freeze frame mode\n          shadowMap._debugCascadeFrustums[i] =\n            shadowMap._debugCascadeFrustums[i] &&\n            shadowMap._debugCascadeFrustums[i].destroy();\n          shadowMap._debugCascadeFrustums[i] = new _DebugCameraPrimitive_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z({\n            camera: shadowMap._passes[i].camera,\n            color: debugOutlineColors[i],\n            updateOnChange: false,\n          });\n        }\n        shadowMap._debugCascadeFrustums[i].update(frameState);\n      }\n    }\n  } else if (shadowMap._isPointLight) {\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(shadowMap._debugLightFrustum) || shadowMap._needsUpdate) {\n      var translation = shadowMap._shadowMapCamera.positionWC;\n      var rotation = _Core_Quaternion_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].IDENTITY */ .Z.IDENTITY;\n      var uniformScale = shadowMap._pointLightRadius * 2.0;\n      var scale = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].fromElements */ .Z.fromElements(\n        uniformScale,\n        uniformScale,\n        uniformScale,\n        scratchScale\n      );\n      var modelMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].fromTranslationQuaternionRotationScale */ .Z.fromTranslationQuaternionRotationScale(\n        translation,\n        rotation,\n        scale,\n        scratchMatrix\n      );\n\n      shadowMap._debugLightFrustum =\n        shadowMap._debugLightFrustum && shadowMap._debugLightFrustum.destroy();\n      shadowMap._debugLightFrustum = createDebugPointLight(\n        modelMatrix,\n        _Core_Color_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].YELLOW */ .Z.YELLOW\n      );\n    }\n    shadowMap._debugLightFrustum.update(frameState);\n  } else {\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(shadowMap._debugLightFrustum) || shadowMap._needsUpdate) {\n      shadowMap._debugLightFrustum = new _DebugCameraPrimitive_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z({\n        camera: shadowMap._shadowMapCamera,\n        color: _Core_Color_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].YELLOW */ .Z.YELLOW,\n        updateOnChange: false,\n      });\n    }\n    shadowMap._debugLightFrustum.update(frameState);\n  }\n}\n\nfunction ShadowMapCamera() {\n  this.viewMatrix = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z();\n  this.inverseViewMatrix = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z();\n  this.frustum = undefined;\n  this.positionCartographic = new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z();\n  this.positionWC = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\n  this.directionWC = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].clone */ .Z.clone(_Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].UNIT_Z */ .Z.UNIT_Z);\n  this.upWC = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].clone */ .Z.clone(_Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].UNIT_Y */ .Z.UNIT_Y);\n  this.rightWC = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].clone */ .Z.clone(_Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].UNIT_X */ .Z.UNIT_X);\n  this.viewProjectionMatrix = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z();\n}\n\nShadowMapCamera.prototype.clone = function (camera) {\n  _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].clone */ .Z.clone(camera.viewMatrix, this.viewMatrix);\n  _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].clone */ .Z.clone(camera.inverseViewMatrix, this.inverseViewMatrix);\n  this.frustum = camera.frustum.clone(this.frustum);\n  _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].clone */ .Z.clone(camera.positionCartographic, this.positionCartographic);\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].clone */ .Z.clone(camera.positionWC, this.positionWC);\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].clone */ .Z.clone(camera.directionWC, this.directionWC);\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].clone */ .Z.clone(camera.upWC, this.upWC);\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].clone */ .Z.clone(camera.rightWC, this.rightWC);\n};\n\n// Converts from NDC space to texture space\nvar scaleBiasMatrix = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z(\n  0.5,\n  0.0,\n  0.0,\n  0.5,\n  0.0,\n  0.5,\n  0.0,\n  0.5,\n  0.0,\n  0.0,\n  0.5,\n  0.5,\n  0.0,\n  0.0,\n  0.0,\n  1.0\n);\n\nShadowMapCamera.prototype.getViewProjection = function () {\n  var view = this.viewMatrix;\n  var projection = this.frustum.projectionMatrix;\n  _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiply */ .Z.multiply(projection, view, this.viewProjectionMatrix);\n  _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiply */ .Z.multiply(\n    scaleBiasMatrix,\n    this.viewProjectionMatrix,\n    this.viewProjectionMatrix\n  );\n  return this.viewProjectionMatrix;\n};\n\nvar scratchSplits = new Array(5);\nvar scratchFrustum = new _Core_PerspectiveFrustum_js__WEBPACK_IMPORTED_MODULE_21__/* ["default"] */ .Z();\nvar scratchCascadeDistances = new Array(4);\nvar scratchMin = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\nvar scratchMax = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\n\nfunction computeCascades(shadowMap, frameState) {\n  var shadowMapCamera = shadowMap._shadowMapCamera;\n  var sceneCamera = shadowMap._sceneCamera;\n  var cameraNear = sceneCamera.frustum.near;\n  var cameraFar = sceneCamera.frustum.far;\n  var numberOfCascades = shadowMap._numberOfCascades;\n\n  // Split cascades. Use a mix of linear and log splits.\n  var i;\n  var range = cameraFar - cameraNear;\n  var ratio = cameraFar / cameraNear;\n\n  var lambda = 0.9;\n  var clampCascadeDistances = false;\n\n  // When the camera is close to a relatively small model, provide more detail in the closer cascades.\n  // If the camera is near or inside a large model, such as the root tile of a city, then use the default values.\n  // To get the most accurate cascade splits we would need to find the min and max values from the depth texture.\n  if (frameState.shadowState.closestObjectSize < 200.0) {\n    clampCascadeDistances = true;\n    lambda = 0.9;\n  }\n\n  var cascadeDistances = scratchCascadeDistances;\n  var splits = scratchSplits;\n  splits[0] = cameraNear;\n  splits[numberOfCascades] = cameraFar;\n\n  // Find initial splits\n  for (i = 0; i < numberOfCascades; ++i) {\n    var p = (i + 1) / numberOfCascades;\n    var logScale = cameraNear * Math.pow(ratio, p);\n    var uniformScale = cameraNear + range * p;\n    var split = _Core_Math_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].lerp */ .Z.lerp(uniformScale, logScale, lambda);\n    splits[i + 1] = split;\n    cascadeDistances[i] = split - splits[i];\n  }\n\n  if (clampCascadeDistances) {\n    // Clamp each cascade to its maximum distance\n    for (i = 0; i < numberOfCascades; ++i) {\n      cascadeDistances[i] = Math.min(\n        cascadeDistances[i],\n        shadowMap._maximumCascadeDistances[i]\n      );\n    }\n\n    // Recompute splits\n    var distance = splits[0];\n    for (i = 0; i < numberOfCascades - 1; ++i) {\n      distance += cascadeDistances[i];\n      splits[i + 1] = distance;\n    }\n  }\n\n  _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].unpack */ .Z.unpack(splits, 0, shadowMap._cascadeSplits[0]);\n  _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].unpack */ .Z.unpack(splits, 1, shadowMap._cascadeSplits[1]);\n  _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].unpack */ .Z.unpack(cascadeDistances, 0, shadowMap._cascadeDistances);\n\n  var shadowFrustum = shadowMapCamera.frustum;\n  var left = shadowFrustum.left;\n  var right = shadowFrustum.right;\n  var bottom = shadowFrustum.bottom;\n  var top = shadowFrustum.top;\n  var near = shadowFrustum.near;\n  var far = shadowFrustum.far;\n\n  var position = shadowMapCamera.positionWC;\n  var direction = shadowMapCamera.directionWC;\n  var up = shadowMapCamera.upWC;\n\n  var cascadeSubFrustum = sceneCamera.frustum.clone(scratchFrustum);\n  var shadowViewProjection = shadowMapCamera.getViewProjection();\n\n  for (i = 0; i < numberOfCascades; ++i) {\n    // Find the bounding box of the camera sub-frustum in shadow map texture space\n    cascadeSubFrustum.near = splits[i];\n    cascadeSubFrustum.far = splits[i + 1];\n    var viewProjection = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiply */ .Z.multiply(\n      cascadeSubFrustum.projectionMatrix,\n      sceneCamera.viewMatrix,\n      scratchMatrix\n    );\n    var inverseViewProjection = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].inverse */ .Z.inverse(viewProjection, scratchMatrix);\n    var shadowMapMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiply */ .Z.multiply(\n      shadowViewProjection,\n      inverseViewProjection,\n      scratchMatrix\n    );\n\n    // Project each corner from camera NDC space to shadow map texture space. Min and max will be from 0 to 1.\n    var min = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].fromElements */ .Z.fromElements(\n      Number.MAX_VALUE,\n      Number.MAX_VALUE,\n      Number.MAX_VALUE,\n      scratchMin\n    );\n    var max = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].fromElements */ .Z.fromElements(\n      -Number.MAX_VALUE,\n      -Number.MAX_VALUE,\n      -Number.MAX_VALUE,\n      scratchMax\n    );\n\n    for (var k = 0; k < 8; ++k) {\n      var corner = _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].clone */ .Z.clone(\n        frustumCornersNDC[k],\n        scratchFrustumCorners[k]\n      );\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiplyByVector */ .Z.multiplyByVector(shadowMapMatrix, corner, corner);\n      _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].divideByScalar */ .Z.divideByScalar(corner, corner.w, corner); // Handle the perspective divide\n      _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].minimumByComponent */ .Z.minimumByComponent(corner, min, min);\n      _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].maximumByComponent */ .Z.maximumByComponent(corner, max, max);\n    }\n\n    // Limit light-space coordinates to the [0, 1] range\n    min.x = Math.max(min.x, 0.0);\n    min.y = Math.max(min.y, 0.0);\n    min.z = 0.0; // Always start cascade frustum at the top of the light frustum to capture objects in the light\'s path\n    max.x = Math.min(max.x, 1.0);\n    max.y = Math.min(max.y, 1.0);\n    max.z = Math.min(max.z, 1.0);\n\n    var pass = shadowMap._passes[i];\n    var cascadeCamera = pass.camera;\n    cascadeCamera.clone(shadowMapCamera); // PERFORMANCE_IDEA : could do a shallow clone for all properties except the frustum\n\n    var frustum = cascadeCamera.frustum;\n    frustum.left = left + min.x * (right - left);\n    frustum.right = left + max.x * (right - left);\n    frustum.bottom = bottom + min.y * (top - bottom);\n    frustum.top = bottom + max.y * (top - bottom);\n    frustum.near = near + min.z * (far - near);\n    frustum.far = near + max.z * (far - near);\n\n    pass.cullingVolume = cascadeCamera.frustum.computeCullingVolume(\n      position,\n      direction,\n      up\n    );\n\n    // Transforms from eye space to the cascade\'s texture space\n    var cascadeMatrix = shadowMap._cascadeMatrices[i];\n    _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiply */ .Z.multiply(\n      cascadeCamera.getViewProjection(),\n      sceneCamera.inverseViewMatrix,\n      cascadeMatrix\n    );\n    _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiply */ .Z.multiply(pass.textureOffsets, cascadeMatrix, cascadeMatrix);\n  }\n}\n\nvar scratchLightView = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z();\nvar scratchRight = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\nvar scratchUp = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\nvar scratchTranslation = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\n\nfunction fitShadowMapToScene(shadowMap, frameState) {\n  var shadowMapCamera = shadowMap._shadowMapCamera;\n  var sceneCamera = shadowMap._sceneCamera;\n\n  // 1. First find a tight bounding box in light space that contains the entire camera frustum.\n  var viewProjection = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiply */ .Z.multiply(\n    sceneCamera.frustum.projectionMatrix,\n    sceneCamera.viewMatrix,\n    scratchMatrix\n  );\n  var inverseViewProjection = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].inverse */ .Z.inverse(viewProjection, scratchMatrix);\n\n  // Start to construct the light view matrix. Set translation later once the bounding box is found.\n  var lightDir = shadowMapCamera.directionWC;\n  var lightUp = sceneCamera.directionWC; // Align shadows to the camera view.\n  if (_Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].equalsEpsilon */ .Z.equalsEpsilon(lightDir, lightUp, _Core_Math_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].EPSILON10 */ .Z.EPSILON10)) {\n    lightUp = sceneCamera.upWC;\n  }\n  var lightRight = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].cross */ .Z.cross(lightDir, lightUp, scratchRight);\n  lightUp = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].cross */ .Z.cross(lightRight, lightDir, scratchUp); // Recalculate up now that right is derived\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].normalize */ .Z.normalize(lightUp, lightUp);\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].normalize */ .Z.normalize(lightRight, lightRight);\n  var lightPosition = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].fromElements */ .Z.fromElements(\n    0.0,\n    0.0,\n    0.0,\n    scratchTranslation\n  );\n\n  var lightView = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].computeView */ .Z.computeView(\n    lightPosition,\n    lightDir,\n    lightUp,\n    lightRight,\n    scratchLightView\n  );\n  var cameraToLight = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiply */ .Z.multiply(\n    lightView,\n    inverseViewProjection,\n    scratchMatrix\n  );\n\n  // Project each corner from NDC space to light view space, and calculate a min and max in light view space\n  var min = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].fromElements */ .Z.fromElements(\n    Number.MAX_VALUE,\n    Number.MAX_VALUE,\n    Number.MAX_VALUE,\n    scratchMin\n  );\n  var max = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].fromElements */ .Z.fromElements(\n    -Number.MAX_VALUE,\n    -Number.MAX_VALUE,\n    -Number.MAX_VALUE,\n    scratchMax\n  );\n\n  for (var i = 0; i < 8; ++i) {\n    var corner = _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].clone */ .Z.clone(\n      frustumCornersNDC[i],\n      scratchFrustumCorners[i]\n    );\n    _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiplyByVector */ .Z.multiplyByVector(cameraToLight, corner, corner);\n    _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].divideByScalar */ .Z.divideByScalar(corner, corner.w, corner); // Handle the perspective divide\n    _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].minimumByComponent */ .Z.minimumByComponent(corner, min, min);\n    _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].maximumByComponent */ .Z.maximumByComponent(corner, max, max);\n  }\n\n  // 2. Set bounding box back to include objects in the light\'s view\n  max.z += 1000.0; // Note: in light space, a positive number is behind the camera\n  min.z -= 10.0; // Extend the shadow volume forward slightly to avoid problems right at the edge\n\n  // 3. Adjust light view matrix so that it is centered on the bounding volume\n  var translation = scratchTranslation;\n  translation.x = -(0.5 * (min.x + max.x));\n  translation.y = -(0.5 * (min.y + max.y));\n  translation.z = -max.z;\n\n  var translationMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].fromTranslation */ .Z.fromTranslation(translation, scratchMatrix);\n  lightView = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiply */ .Z.multiply(translationMatrix, lightView, lightView);\n\n  // 4. Create an orthographic frustum that covers the bounding box extents\n  var halfWidth = 0.5 * (max.x - min.x);\n  var halfHeight = 0.5 * (max.y - min.y);\n  var depth = max.z - min.z;\n\n  var frustum = shadowMapCamera.frustum;\n  frustum.left = -halfWidth;\n  frustum.right = halfWidth;\n  frustum.bottom = -halfHeight;\n  frustum.top = halfHeight;\n  frustum.near = 0.01;\n  frustum.far = depth;\n\n  // 5. Update the shadow map camera\n  _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].clone */ .Z.clone(lightView, shadowMapCamera.viewMatrix);\n  _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].inverse */ .Z.inverse(lightView, shadowMapCamera.inverseViewMatrix);\n  _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].getTranslation */ .Z.getTranslation(\n    shadowMapCamera.inverseViewMatrix,\n    shadowMapCamera.positionWC\n  );\n  frameState.mapProjection.ellipsoid.cartesianToCartographic(\n    shadowMapCamera.positionWC,\n    shadowMapCamera.positionCartographic\n  );\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].clone */ .Z.clone(lightDir, shadowMapCamera.directionWC);\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].clone */ .Z.clone(lightUp, shadowMapCamera.upWC);\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].clone */ .Z.clone(lightRight, shadowMapCamera.rightWC);\n}\n\nvar directions = [\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(-1.0, 0.0, 0.0),\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(0.0, -1.0, 0.0),\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(0.0, 0.0, -1.0),\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(1.0, 0.0, 0.0),\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(0.0, 1.0, 0.0),\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(0.0, 0.0, 1.0),\n];\n\nvar ups = [\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(0.0, -1.0, 0.0),\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(0.0, 0.0, -1.0),\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(0.0, -1.0, 0.0),\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(0.0, -1.0, 0.0),\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(0.0, 0.0, 1.0),\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(0.0, -1.0, 0.0),\n];\n\nvar rights = [\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(0.0, 0.0, 1.0),\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(1.0, 0.0, 0.0),\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(-1.0, 0.0, 0.0),\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(0.0, 0.0, -1.0),\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(1.0, 0.0, 0.0),\n  new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(1.0, 0.0, 0.0),\n];\n\nfunction computeOmnidirectional(shadowMap, frameState) {\n  // All sides share the same frustum\n  var frustum = new _Core_PerspectiveFrustum_js__WEBPACK_IMPORTED_MODULE_21__/* ["default"] */ .Z();\n  frustum.fov = _Core_Math_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].PI_OVER_TWO */ .Z.PI_OVER_TWO;\n  frustum.near = 1.0;\n  frustum.far = shadowMap._pointLightRadius;\n  frustum.aspectRatio = 1.0;\n\n  for (var i = 0; i < 6; ++i) {\n    var camera = shadowMap._passes[i].camera;\n    camera.positionWC = shadowMap._shadowMapCamera.positionWC;\n    camera.positionCartographic = frameState.mapProjection.ellipsoid.cartesianToCartographic(\n      camera.positionWC,\n      camera.positionCartographic\n    );\n    camera.directionWC = directions[i];\n    camera.upWC = ups[i];\n    camera.rightWC = rights[i];\n\n    _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].computeView */ .Z.computeView(\n      camera.positionWC,\n      camera.directionWC,\n      camera.upWC,\n      camera.rightWC,\n      camera.viewMatrix\n    );\n    _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].inverse */ .Z.inverse(camera.viewMatrix, camera.inverseViewMatrix);\n\n    camera.frustum = frustum;\n  }\n}\n\nvar scratchCartesian1 = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\nvar scratchCartesian2 = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\nvar scratchBoundingSphere = new _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\nvar scratchCenter = scratchBoundingSphere.center;\n\nfunction checkVisibility(shadowMap, frameState) {\n  var sceneCamera = shadowMap._sceneCamera;\n  var shadowMapCamera = shadowMap._shadowMapCamera;\n\n  var boundingSphere = scratchBoundingSphere;\n\n  // Check whether the shadow map is in view and needs to be updated\n  if (shadowMap._cascadesEnabled) {\n    // If the nearest shadow receiver is further than the shadow map\'s maximum distance then the shadow map is out of view.\n    if (sceneCamera.frustum.near >= shadowMap.maximumDistance) {\n      shadowMap._outOfView = true;\n      shadowMap._needsUpdate = false;\n      return;\n    }\n\n    // If the light source is below the horizon then the shadow map is out of view\n    var surfaceNormal = frameState.mapProjection.ellipsoid.geodeticSurfaceNormal(\n      sceneCamera.positionWC,\n      scratchCartesian1\n    );\n    var lightDirection = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].negate */ .Z.negate(\n      shadowMapCamera.directionWC,\n      scratchCartesian2\n    );\n    var dot = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].dot */ .Z.dot(surfaceNormal, lightDirection);\n    if (shadowMap.fadingEnabled) {\n      // Shadows start to fade out once the light gets closer to the horizon.\n      // At this point the globe uses vertex lighting alone to darken the surface.\n      var darknessAmount = _Core_Math_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].clamp */ .Z.clamp(dot / 0.1, 0.0, 1.0);\n      shadowMap._darkness = _Core_Math_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].lerp */ .Z.lerp(\n        1.0,\n        shadowMap.darkness,\n        darknessAmount\n      );\n    } else {\n      shadowMap._darkness = shadowMap.darkness;\n    }\n\n    if (dot < 0.0) {\n      shadowMap._outOfView = true;\n      shadowMap._needsUpdate = false;\n      return;\n    }\n\n    // By default cascaded shadows need to update and are always in view\n    shadowMap._needsUpdate = true;\n    shadowMap._outOfView = false;\n  } else if (shadowMap._isPointLight) {\n    // Sphere-frustum intersection test\n    boundingSphere.center = shadowMapCamera.positionWC;\n    boundingSphere.radius = shadowMap._pointLightRadius;\n    shadowMap._outOfView =\n      frameState.cullingVolume.computeVisibility(boundingSphere) ===\n      _Core_Intersect_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].OUTSIDE */ .Z.OUTSIDE;\n    shadowMap._needsUpdate =\n      !shadowMap._outOfView &&\n      !shadowMap._boundingSphere.equals(boundingSphere);\n    _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].clone */ .Z.clone(boundingSphere, shadowMap._boundingSphere);\n  } else {\n    // Simplify frustum-frustum intersection test as a sphere-frustum test\n    var frustumRadius = shadowMapCamera.frustum.far / 2.0;\n    var frustumCenter = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].add */ .Z.add(\n      shadowMapCamera.positionWC,\n      _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].multiplyByScalar */ .Z.multiplyByScalar(\n        shadowMapCamera.directionWC,\n        frustumRadius,\n        scratchCenter\n      ),\n      scratchCenter\n    );\n    boundingSphere.center = frustumCenter;\n    boundingSphere.radius = frustumRadius;\n    shadowMap._outOfView =\n      frameState.cullingVolume.computeVisibility(boundingSphere) ===\n      _Core_Intersect_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].OUTSIDE */ .Z.OUTSIDE;\n    shadowMap._needsUpdate =\n      !shadowMap._outOfView &&\n      !shadowMap._boundingSphere.equals(boundingSphere);\n    _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].clone */ .Z.clone(boundingSphere, shadowMap._boundingSphere);\n  }\n}\n\nfunction updateCameras(shadowMap, frameState) {\n  var camera = frameState.camera; // The actual camera in the scene\n  var lightCamera = shadowMap._lightCamera; // The external camera representing the light source\n  var sceneCamera = shadowMap._sceneCamera; // Clone of camera, with clamped near and far planes\n  var shadowMapCamera = shadowMap._shadowMapCamera; // Camera representing the shadow volume, initially cloned from lightCamera\n\n  // Clone light camera into the shadow map camera\n  if (shadowMap._cascadesEnabled) {\n    _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].clone */ .Z.clone(lightCamera.directionWC, shadowMapCamera.directionWC);\n  } else if (shadowMap._isPointLight) {\n    _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].clone */ .Z.clone(lightCamera.positionWC, shadowMapCamera.positionWC);\n  } else {\n    shadowMapCamera.clone(lightCamera);\n  }\n\n  // Get the light direction in eye coordinates\n  var lightDirection = shadowMap._lightDirectionEC;\n  _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiplyByPointAsVector */ .Z.multiplyByPointAsVector(\n    camera.viewMatrix,\n    shadowMapCamera.directionWC,\n    lightDirection\n  );\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].normalize */ .Z.normalize(lightDirection, lightDirection);\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].negate */ .Z.negate(lightDirection, lightDirection);\n\n  // Get the light position in eye coordinates\n  _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiplyByPoint */ .Z.multiplyByPoint(\n    camera.viewMatrix,\n    shadowMapCamera.positionWC,\n    shadowMap._lightPositionEC\n  );\n  shadowMap._lightPositionEC.w = shadowMap._pointLightRadius;\n\n  // Get the near and far of the scene camera\n  var near;\n  var far;\n  if (shadowMap._fitNearFar) {\n    // shadowFar can be very large, so limit to shadowMap.maximumDistance\n    // Push the far plane slightly further than the near plane to avoid degenerate frustum\n    near = Math.min(\n      frameState.shadowState.nearPlane,\n      shadowMap.maximumDistance\n    );\n    far = Math.min(frameState.shadowState.farPlane, shadowMap.maximumDistance);\n    far = Math.max(far, near + 1.0);\n  } else {\n    near = camera.frustum.near;\n    far = shadowMap.maximumDistance;\n  }\n\n  shadowMap._sceneCamera = _Camera_js__WEBPACK_IMPORTED_MODULE_38__/* ["default"].clone */ .Z.clone(camera, sceneCamera);\n  camera.frustum.clone(shadowMap._sceneCamera.frustum);\n  shadowMap._sceneCamera.frustum.near = near;\n  shadowMap._sceneCamera.frustum.far = far;\n  shadowMap._distance = far - near;\n\n  checkVisibility(shadowMap, frameState);\n\n  if (!shadowMap._outOfViewPrevious && shadowMap._outOfView) {\n    shadowMap._needsUpdate = true;\n  }\n  shadowMap._outOfViewPrevious = shadowMap._outOfView;\n}\n\n/**\n * @private\n */\nShadowMap.prototype.update = function (frameState) {\n  updateCameras(this, frameState);\n\n  if (this._needsUpdate) {\n    updateFramebuffer(this, frameState.context);\n\n    if (this._isPointLight) {\n      computeOmnidirectional(this, frameState);\n    }\n\n    if (this._cascadesEnabled) {\n      fitShadowMapToScene(this, frameState);\n\n      if (this._numberOfCascades > 1) {\n        computeCascades(this, frameState);\n      }\n    }\n\n    if (!this._isPointLight) {\n      // Compute the culling volume\n      var shadowMapCamera = this._shadowMapCamera;\n      var position = shadowMapCamera.positionWC;\n      var direction = shadowMapCamera.directionWC;\n      var up = shadowMapCamera.upWC;\n      this._shadowMapCullingVolume = shadowMapCamera.frustum.computeCullingVolume(\n        position,\n        direction,\n        up\n      );\n\n      if (this._passes.length === 1) {\n        // Since there is only one pass, use the shadow map camera as the pass camera.\n        this._passes[0].camera.clone(shadowMapCamera);\n      }\n    } else {\n      this._shadowMapCullingVolume = _Core_CullingVolume_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"].fromBoundingSphere */ .Z.fromBoundingSphere(\n        this._boundingSphere\n      );\n    }\n  }\n\n  if (this._passes.length === 1) {\n    // Transforms from eye space to shadow texture space.\n    // Always requires an update since the scene camera constantly changes.\n    var inverseView = this._sceneCamera.inverseViewMatrix;\n    _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiply */ .Z.multiply(\n      this._shadowMapCamera.getViewProjection(),\n      inverseView,\n      this._shadowMapMatrix\n    );\n  }\n\n  if (this.debugShow) {\n    applyDebugSettings(this, frameState);\n  }\n};\n\n/**\n * @private\n */\nShadowMap.prototype.updatePass = function (context, shadowPass) {\n  clearFramebuffer(this, context, shadowPass);\n};\n\nvar scratchTexelStepSize = new _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\n\nfunction combineUniforms(shadowMap, uniforms, isTerrain) {\n  var bias = shadowMap._isPointLight\n    ? shadowMap._pointBias\n    : isTerrain\n    ? shadowMap._terrainBias\n    : shadowMap._primitiveBias;\n\n  var mapUniforms = {\n    shadowMap_texture: function () {\n      return shadowMap._shadowMapTexture;\n    },\n    shadowMap_textureCube: function () {\n      return shadowMap._shadowMapTexture;\n    },\n    shadowMap_matrix: function () {\n      return shadowMap._shadowMapMatrix;\n    },\n    shadowMap_cascadeSplits: function () {\n      return shadowMap._cascadeSplits;\n    },\n    shadowMap_cascadeMatrices: function () {\n      return shadowMap._cascadeMatrices;\n    },\n    shadowMap_lightDirectionEC: function () {\n      return shadowMap._lightDirectionEC;\n    },\n    shadowMap_lightPositionEC: function () {\n      return shadowMap._lightPositionEC;\n    },\n    shadowMap_cascadeDistances: function () {\n      return shadowMap._cascadeDistances;\n    },\n    shadowMap_texelSizeDepthBiasAndNormalShadingSmooth: function () {\n      var texelStepSize = scratchTexelStepSize;\n      texelStepSize.x = 1.0 / shadowMap._textureSize.x;\n      texelStepSize.y = 1.0 / shadowMap._textureSize.y;\n\n      return _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].fromElements */ .Z.fromElements(\n        texelStepSize.x,\n        texelStepSize.y,\n        bias.depthBias,\n        bias.normalShadingSmooth,\n        this.combinedUniforms1\n      );\n    },\n    shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness: function () {\n      return _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].fromElements */ .Z.fromElements(\n        bias.normalOffsetScale,\n        shadowMap._distance,\n        shadowMap.maximumDistance,\n        shadowMap._darkness,\n        this.combinedUniforms2\n      );\n    },\n\n    combinedUniforms1: new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z(),\n    combinedUniforms2: new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z(),\n  };\n\n  return (0,_Core_combine_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(uniforms, mapUniforms, false);\n}\n\nfunction createCastDerivedCommand(\n  shadowMap,\n  shadowsDirty,\n  command,\n  context,\n  oldShaderId,\n  result\n) {\n  var castShader;\n  var castRenderState;\n  var castUniformMap;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(result)) {\n    castShader = result.shaderProgram;\n    castRenderState = result.renderState;\n    castUniformMap = result.uniformMap;\n  }\n\n  result = _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_29__/* ["default"].shallowClone */ .Z.shallowClone(command, result);\n  result.castShadows = true;\n  result.receiveShadows = false;\n\n  if (\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(castShader) ||\n    oldShaderId !== command.shaderProgram.id ||\n    shadowsDirty\n  ) {\n    var shaderProgram = command.shaderProgram;\n\n    var isTerrain = command.pass === _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_31__/* ["default"].GLOBE */ .Z.GLOBE;\n    var isOpaque = command.pass !== _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_31__/* ["default"].TRANSLUCENT */ .Z.TRANSLUCENT;\n    var isPointLight = shadowMap._isPointLight;\n    var usesDepthTexture = shadowMap._usesDepthTexture;\n\n    var keyword = _ShadowMapShader_js__WEBPACK_IMPORTED_MODULE_43__/* ["default"].getShadowCastShaderKeyword */ .Z.getShadowCastShaderKeyword(\n      isPointLight,\n      isTerrain,\n      usesDepthTexture,\n      isOpaque\n    );\n    castShader = context.shaderCache.getDerivedShaderProgram(\n      shaderProgram,\n      keyword\n    );\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(castShader)) {\n      var vertexShaderSource = shaderProgram.vertexShaderSource;\n      var fragmentShaderSource = shaderProgram.fragmentShaderSource;\n\n      var castVS = _ShadowMapShader_js__WEBPACK_IMPORTED_MODULE_43__/* ["default"].createShadowCastVertexShader */ .Z.createShadowCastVertexShader(\n        vertexShaderSource,\n        isPointLight,\n        isTerrain\n      );\n      var castFS = _ShadowMapShader_js__WEBPACK_IMPORTED_MODULE_43__/* ["default"].createShadowCastFragmentShader */ .Z.createShadowCastFragmentShader(\n        fragmentShaderSource,\n        isPointLight,\n        usesDepthTexture,\n        isOpaque\n      );\n\n      castShader = context.shaderCache.createDerivedShaderProgram(\n        shaderProgram,\n        keyword,\n        {\n          vertexShaderSource: castVS,\n          fragmentShaderSource: castFS,\n          attributeLocations: shaderProgram._attributeLocations,\n        }\n      );\n    }\n\n    castRenderState = shadowMap._primitiveRenderState;\n    if (isPointLight) {\n      castRenderState = shadowMap._pointRenderState;\n    } else if (isTerrain) {\n      castRenderState = shadowMap._terrainRenderState;\n    }\n\n    // Modify the render state for commands that do not use back-face culling, e.g. flat textured walls\n    var cullEnabled = command.renderState.cull.enabled;\n    if (!cullEnabled) {\n      castRenderState = (0,_Core_clone_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(castRenderState, false);\n      castRenderState.cull = (0,_Core_clone_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(castRenderState.cull, false);\n      castRenderState.cull.enabled = false;\n      castRenderState = _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_35__/* ["default"].fromCache */ .Z.fromCache(castRenderState);\n    }\n\n    castUniformMap = combineUniforms(shadowMap, command.uniformMap, isTerrain);\n  }\n\n  result.shaderProgram = castShader;\n  result.renderState = castRenderState;\n  result.uniformMap = castUniformMap;\n\n  return result;\n}\n\nShadowMap.createReceiveDerivedCommand = function (\n  lightShadowMaps,\n  command,\n  shadowsDirty,\n  context,\n  result\n) {\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(result)) {\n    result = {};\n  }\n\n  var lightShadowMapsEnabled = lightShadowMaps.length > 0;\n  var shaderProgram = command.shaderProgram;\n  var vertexShaderSource = shaderProgram.vertexShaderSource;\n  var fragmentShaderSource = shaderProgram.fragmentShaderSource;\n  var isTerrain = command.pass === _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_31__/* ["default"].GLOBE */ .Z.GLOBE;\n\n  var hasTerrainNormal = false;\n  if (isTerrain) {\n    hasTerrainNormal =\n      command.owner.data.renderedMesh.encoding.hasVertexNormals;\n  }\n\n  if (command.receiveShadows && lightShadowMapsEnabled) {\n    // Only generate a receiveCommand if there is a shadow map originating from a light source.\n    var receiveShader;\n    var receiveUniformMap;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(result.receiveCommand)) {\n      receiveShader = result.receiveCommand.shaderProgram;\n      receiveUniformMap = result.receiveCommand.uniformMap;\n    }\n\n    result.receiveCommand = _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_29__/* ["default"].shallowClone */ .Z.shallowClone(\n      command,\n      result.receiveCommand\n    );\n    result.castShadows = false;\n    result.receiveShadows = true;\n\n    // If castShadows changed, recompile the receive shadows shader. The normal shading technique simulates\n    // self-shadowing so it should be turned off if castShadows is false.\n    var castShadowsDirty =\n      result.receiveShaderCastShadows !== command.castShadows;\n    var shaderDirty =\n      result.receiveShaderProgramId !== command.shaderProgram.id;\n\n    if (\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(receiveShader) ||\n      shaderDirty ||\n      shadowsDirty ||\n      castShadowsDirty\n    ) {\n      var keyword = _ShadowMapShader_js__WEBPACK_IMPORTED_MODULE_43__/* ["default"].getShadowReceiveShaderKeyword */ .Z.getShadowReceiveShaderKeyword(\n        lightShadowMaps[0],\n        command.castShadows,\n        isTerrain,\n        hasTerrainNormal\n      );\n      receiveShader = context.shaderCache.getDerivedShaderProgram(\n        shaderProgram,\n        keyword\n      );\n      if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(receiveShader)) {\n        var receiveVS = _ShadowMapShader_js__WEBPACK_IMPORTED_MODULE_43__/* ["default"].createShadowReceiveVertexShader */ .Z.createShadowReceiveVertexShader(\n          vertexShaderSource,\n          isTerrain,\n          hasTerrainNormal\n        );\n        var receiveFS = _ShadowMapShader_js__WEBPACK_IMPORTED_MODULE_43__/* ["default"].createShadowReceiveFragmentShader */ .Z.createShadowReceiveFragmentShader(\n          fragmentShaderSource,\n          lightShadowMaps[0],\n          command.castShadows,\n          isTerrain,\n          hasTerrainNormal\n        );\n\n        receiveShader = context.shaderCache.createDerivedShaderProgram(\n          shaderProgram,\n          keyword,\n          {\n            vertexShaderSource: receiveVS,\n            fragmentShaderSource: receiveFS,\n            attributeLocations: shaderProgram._attributeLocations,\n          }\n        );\n      }\n\n      receiveUniformMap = combineUniforms(\n        lightShadowMaps[0],\n        command.uniformMap,\n        isTerrain\n      );\n    }\n\n    result.receiveCommand.shaderProgram = receiveShader;\n    result.receiveCommand.uniformMap = receiveUniformMap;\n    result.receiveShaderProgramId = command.shaderProgram.id;\n    result.receiveShaderCastShadows = command.castShadows;\n  }\n\n  return result;\n};\n\nShadowMap.createCastDerivedCommand = function (\n  shadowMaps,\n  command,\n  shadowsDirty,\n  context,\n  result\n) {\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(result)) {\n    result = {};\n  }\n\n  if (command.castShadows) {\n    var castCommands = result.castCommands;\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(castCommands)) {\n      castCommands = result.castCommands = [];\n    }\n\n    var oldShaderId = result.castShaderProgramId;\n\n    var shadowMapLength = shadowMaps.length;\n    castCommands.length = shadowMapLength;\n\n    for (var i = 0; i < shadowMapLength; ++i) {\n      castCommands[i] = createCastDerivedCommand(\n        shadowMaps[i],\n        shadowsDirty,\n        command,\n        context,\n        oldShaderId,\n        castCommands[i]\n      );\n    }\n\n    result.castShaderProgramId = command.shaderProgram.id;\n  }\n\n  return result;\n};\n\n/**\n * @private\n */\nShadowMap.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * @private\n */\nShadowMap.prototype.destroy = function () {\n  destroyFramebuffer(this);\n\n  this._debugLightFrustum =\n    this._debugLightFrustum && this._debugLightFrustum.destroy();\n  this._debugCameraFrustum =\n    this._debugCameraFrustum && this._debugCameraFrustum.destroy();\n  this._debugShadowViewCommand =\n    this._debugShadowViewCommand &&\n    this._debugShadowViewCommand.shaderProgram &&\n    this._debugShadowViewCommand.shaderProgram.destroy();\n\n  for (var i = 0; i < this._numberOfCascades; ++i) {\n    this._debugCascadeFrustums[i] =\n      this._debugCascadeFrustums[i] && this._debugCascadeFrustums[i].destroy();\n  }\n\n  return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z)(this);\n};\n/* harmony default export */ __webpack_exports__["Z"] = (ShadowMap);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUF3Qix5SUFBaUQ7QUFDekU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPLHNFQUFPO0FBQ2Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUyxzRUFBTztBQUNoQjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUEsb0JBQW9CLHFCQUFxQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsa0JBQWtCLDRCQUE0QjtBQUM5QztBQUNBO0FBQ0E7O0FBRUEsU0FBUyw0RUFBYTtBQUN0QjtBQUNBLHlEQUFlLFNBQVMsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9TY2VuZS9TaGFkb3dNYXAuanM/NzE1YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQm91bmRpbmdSZWN0YW5nbGUgZnJvbSBcIi4uL0NvcmUvQm91bmRpbmdSZWN0YW5nbGUuanNcIjtcbmltcG9ydCBCb3VuZGluZ1NwaGVyZSBmcm9tIFwiLi4vQ29yZS9Cb3VuZGluZ1NwaGVyZS5qc1wiO1xuaW1wb3J0IEJveE91dGxpbmVHZW9tZXRyeSBmcm9tIFwiLi4vQ29yZS9Cb3hPdXRsaW5lR2VvbWV0cnkuanNcIjtcbmltcG9ydCBDYXJ0ZXNpYW4yIGZyb20gXCIuLi9Db3JlL0NhcnRlc2lhbjIuanNcIjtcbmltcG9ydCBDYXJ0ZXNpYW4zIGZyb20gXCIuLi9Db3JlL0NhcnRlc2lhbjMuanNcIjtcbmltcG9ydCBDYXJ0ZXNpYW40IGZyb20gXCIuLi9Db3JlL0NhcnRlc2lhbjQuanNcIjtcbmltcG9ydCBDYXJ0b2dyYXBoaWMgZnJvbSBcIi4uL0NvcmUvQ2FydG9ncmFwaGljLmpzXCI7XG5pbXBvcnQgY2xvbmUgZnJvbSBcIi4uL0NvcmUvY2xvbmUuanNcIjtcbmltcG9ydCBDb2xvciBmcm9tIFwiLi4vQ29yZS9Db2xvci5qc1wiO1xuaW1wb3J0IENvbG9yR2VvbWV0cnlJbnN0YW5jZUF0dHJpYnV0ZSBmcm9tIFwiLi4vQ29yZS9Db2xvckdlb21ldHJ5SW5zdGFuY2VBdHRyaWJ1dGUuanNcIjtcbmltcG9ydCBjb21iaW5lIGZyb20gXCIuLi9Db3JlL2NvbWJpbmUuanNcIjtcbmltcG9ydCBDdWxsaW5nVm9sdW1lIGZyb20gXCIuLi9Db3JlL0N1bGxpbmdWb2x1bWUuanNcIjtcbmltcG9ydCBkZWZhdWx0VmFsdWUgZnJvbSBcIi4uL0NvcmUvZGVmYXVsdFZhbHVlLmpzXCI7XG5pbXBvcnQgZGVmaW5lZCBmcm9tIFwiLi4vQ29yZS9kZWZpbmVkLmpzXCI7XG5pbXBvcnQgZGVzdHJveU9iamVjdCBmcm9tIFwiLi4vQ29yZS9kZXN0cm95T2JqZWN0LmpzXCI7XG5pbXBvcnQgRGV2ZWxvcGVyRXJyb3IgZnJvbSBcIi4uL0NvcmUvRGV2ZWxvcGVyRXJyb3IuanNcIjtcbmltcG9ydCBGZWF0dXJlRGV0ZWN0aW9uIGZyb20gXCIuLi9Db3JlL0ZlYXR1cmVEZXRlY3Rpb24uanNcIjtcbmltcG9ydCBHZW9tZXRyeUluc3RhbmNlIGZyb20gXCIuLi9Db3JlL0dlb21ldHJ5SW5zdGFuY2UuanNcIjtcbmltcG9ydCBJbnRlcnNlY3QgZnJvbSBcIi4uL0NvcmUvSW50ZXJzZWN0LmpzXCI7XG5pbXBvcnQgQ2VzaXVtTWF0aCBmcm9tIFwiLi4vQ29yZS9NYXRoLmpzXCI7XG5pbXBvcnQgTWF0cml4NCBmcm9tIFwiLi4vQ29yZS9NYXRyaXg0LmpzXCI7XG5pbXBvcnQgT3J0aG9ncmFwaGljT2ZmQ2VudGVyRnJ1c3R1bSBmcm9tIFwiLi4vQ29yZS9PcnRob2dyYXBoaWNPZmZDZW50ZXJGcnVzdHVtLmpzXCI7XG5pbXBvcnQgUGVyc3BlY3RpdmVGcnVzdHVtIGZyb20gXCIuLi9Db3JlL1BlcnNwZWN0aXZlRnJ1c3R1bS5qc1wiO1xuaW1wb3J0IFBpeGVsRm9ybWF0IGZyb20gXCIuLi9Db3JlL1BpeGVsRm9ybWF0LmpzXCI7XG5pbXBvcnQgUXVhdGVybmlvbiBmcm9tIFwiLi4vQ29yZS9RdWF0ZXJuaW9uLmpzXCI7XG5pbXBvcnQgU3BoZXJlT3V0bGluZUdlb21ldHJ5IGZyb20gXCIuLi9Db3JlL1NwaGVyZU91dGxpbmVHZW9tZXRyeS5qc1wiO1xuaW1wb3J0IFdlYkdMQ29uc3RhbnRzIGZyb20gXCIuLi9Db3JlL1dlYkdMQ29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgQ2xlYXJDb21tYW5kIGZyb20gXCIuLi9SZW5kZXJlci9DbGVhckNvbW1hbmQuanNcIjtcbmltcG9ydCBDb250ZXh0TGltaXRzIGZyb20gXCIuLi9SZW5kZXJlci9Db250ZXh0TGltaXRzLmpzXCI7XG5pbXBvcnQgQ3ViZU1hcCBmcm9tIFwiLi4vUmVuZGVyZXIvQ3ViZU1hcC5qc1wiO1xuaW1wb3J0IERyYXdDb21tYW5kIGZyb20gXCIuLi9SZW5kZXJlci9EcmF3Q29tbWFuZC5qc1wiO1xuaW1wb3J0IEZyYW1lYnVmZmVyIGZyb20gXCIuLi9SZW5kZXJlci9GcmFtZWJ1ZmZlci5qc1wiO1xuaW1wb3J0IFBhc3MgZnJvbSBcIi4uL1JlbmRlcmVyL1Bhc3MuanNcIjtcbmltcG9ydCBQYXNzU3RhdGUgZnJvbSBcIi4uL1JlbmRlcmVyL1Bhc3NTdGF0ZS5qc1wiO1xuaW1wb3J0IFBpeGVsRGF0YXR5cGUgZnJvbSBcIi4uL1JlbmRlcmVyL1BpeGVsRGF0YXR5cGUuanNcIjtcbmltcG9ydCBSZW5kZXJidWZmZXIgZnJvbSBcIi4uL1JlbmRlcmVyL1JlbmRlcmJ1ZmZlci5qc1wiO1xuaW1wb3J0IFJlbmRlcmJ1ZmZlckZvcm1hdCBmcm9tIFwiLi4vUmVuZGVyZXIvUmVuZGVyYnVmZmVyRm9ybWF0LmpzXCI7XG5pbXBvcnQgUmVuZGVyU3RhdGUgZnJvbSBcIi4uL1JlbmRlcmVyL1JlbmRlclN0YXRlLmpzXCI7XG5pbXBvcnQgU2FtcGxlciBmcm9tIFwiLi4vUmVuZGVyZXIvU2FtcGxlci5qc1wiO1xuaW1wb3J0IFRleHR1cmUgZnJvbSBcIi4uL1JlbmRlcmVyL1RleHR1cmUuanNcIjtcbmltcG9ydCBDYW1lcmEgZnJvbSBcIi4vQ2FtZXJhLmpzXCI7XG5pbXBvcnQgQ3VsbEZhY2UgZnJvbSBcIi4vQ3VsbEZhY2UuanNcIjtcbmltcG9ydCBEZWJ1Z0NhbWVyYVByaW1pdGl2ZSBmcm9tIFwiLi9EZWJ1Z0NhbWVyYVByaW1pdGl2ZS5qc1wiO1xuaW1wb3J0IFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlIGZyb20gXCIuL1Blckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlLmpzXCI7XG5pbXBvcnQgUHJpbWl0aXZlIGZyb20gXCIuL1ByaW1pdGl2ZS5qc1wiO1xuaW1wb3J0IFNoYWRvd01hcFNoYWRlciBmcm9tIFwiLi9TaGFkb3dNYXBTaGFkZXIuanNcIjtcblxuLyoqXG4gKiBVc2Uge0BsaW5rIFZpZXdlciNzaGFkb3dNYXB9IHRvIGdldCB0aGUgc2NlbmUncyBzaGFkb3cgbWFwLiBEbyBub3QgY29uc3RydWN0IHRoaXMgZGlyZWN0bHkuXG4gKlxuICogPHA+XG4gKiBUaGUgbm9ybWFsT2Zmc2V0IGJpYXMgcHVzaGVzIHRoZSBzaGFkb3dzIGZvcndhcmQgc2xpZ2h0bHksIGFuZCBtYXkgYmUgZGlzYWJsZWRcbiAqIGZvciBhcHBsaWNhdGlvbnMgdGhhdCByZXF1aXJlIHVsdHJhIHByZWNpc2Ugc2hhZG93cy5cbiAqIDwvcD5cbiAqXG4gKiBAYWxpYXMgU2hhZG93TWFwXG4gKiBAaW50ZXJuYWxDb25zdHJ1Y3RvclxuICogQGNsYXNzXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgQW4gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxuICogQHBhcmFtIHtDYW1lcmF9IG9wdGlvbnMubGlnaHRDYW1lcmEgQSBjYW1lcmEgcmVwcmVzZW50aW5nIHRoZSBsaWdodCBzb3VyY2UuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmVuYWJsZWQ9dHJ1ZV0gV2hldGhlciB0aGUgc2hhZG93IG1hcCBpcyBlbmFibGVkLlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5pc1BvaW50TGlnaHQ9ZmFsc2VdIFdoZXRoZXIgdGhlIGxpZ2h0IHNvdXJjZSBpcyBhIHBvaW50IGxpZ2h0LiBQb2ludCBsaWdodCBzaGFkb3dzIGRvIG5vdCB1c2UgY2FzY2FkZXMuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLnBvaW50TGlnaHRSYWRpdXM9MTAwLjBdIFJhZGl1cyBvZiB0aGUgcG9pbnQgbGlnaHQuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmNhc2NhZGVzRW5hYmxlZD10cnVlXSBVc2UgbXVsdGlwbGUgc2hhZG93IG1hcHMgdG8gY292ZXIgZGlmZmVyZW50IHBhcnRpdGlvbnMgb2YgdGhlIHZpZXcgZnJ1c3R1bS5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5udW1iZXJPZkNhc2NhZGVzPTRdIFRoZSBudW1iZXIgb2YgY2FzY2FkZXMgdG8gdXNlIGZvciB0aGUgc2hhZG93IG1hcC4gU3VwcG9ydGVkIHZhbHVlcyBhcmUgb25lIGFuZCBmb3VyLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLm1heGltdW1EaXN0YW5jZT01MDAwLjBdIFRoZSBtYXhpbXVtIGRpc3RhbmNlIHVzZWQgZm9yIGdlbmVyYXRpbmcgY2FzY2FkZWQgc2hhZG93cy4gTG93ZXIgdmFsdWVzIGltcHJvdmUgc2hhZG93IHF1YWxpdHkuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMuc2l6ZT0yMDQ4XSBUaGUgd2lkdGggYW5kIGhlaWdodCwgaW4gcGl4ZWxzLCBvZiBlYWNoIHNoYWRvdyBtYXAuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLnNvZnRTaGFkb3dzPWZhbHNlXSBXaGV0aGVyIHBlcmNlbnRhZ2UtY2xvc2VyLWZpbHRlcmluZyBpcyBlbmFibGVkIGZvciBwcm9kdWNpbmcgc29mdGVyIHNoYWRvd3MuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMuZGFya25lc3M9MC4zXSBUaGUgc2hhZG93IGRhcmtuZXNzLlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5ub3JtYWxPZmZzZXQ9dHJ1ZV0gV2hldGhlciBhIG5vcm1hbCBiaWFzIGlzIGFwcGxpZWQgdG8gc2hhZG93cy5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuZmFkaW5nRW5hYmxlZD10cnVlXSBXaGV0aGVyIHNoYWRvd3Mgc3RhcnQgdG8gZmFkZSBvdXQgb25jZSB0aGUgbGlnaHQgZ2V0cyBjbG9zZXIgdG8gdGhlIGhvcml6b24uXG4gKlxuICogQGV4Y2VwdGlvbiB7RGV2ZWxvcGVyRXJyb3J9IE9ubHkgb25lIG9yIGZvdXIgY2FzY2FkZXMgYXJlIHN1cHBvcnRlZC5cbiAqXG4gKiBAZGVtbyB7QGxpbmsgaHR0cHM6Ly9zYW5kY2FzdGxlLmNlc2l1bS5jb20vaW5kZXguaHRtbD9zcmM9U2hhZG93cy5odG1sfENlc2l1bSBTYW5kY2FzdGxlIFNoYWRvd3MgRGVtb31cbiAqL1xuZnVuY3Rpb24gU2hhZG93TWFwKG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLCBkZWZhdWx0VmFsdWUuRU1QVFlfT0JKRUNUKTtcbiAgLy8gb3B0aW9ucy5jb250ZXh0IGlzIGFuIHVuZG9jdW1lbnRlZCBvcHRpb25cbiAgdmFyIGNvbnRleHQgPSBvcHRpb25zLmNvbnRleHQ7XG5cbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgaWYgKCFkZWZpbmVkKGNvbnRleHQpKSB7XG4gICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFwiY29udGV4dCBpcyByZXF1aXJlZC5cIik7XG4gIH1cbiAgaWYgKCFkZWZpbmVkKG9wdGlvbnMubGlnaHRDYW1lcmEpKSB7XG4gICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFwibGlnaHRDYW1lcmEgaXMgcmVxdWlyZWQuXCIpO1xuICB9XG4gIGlmIChcbiAgICBkZWZpbmVkKG9wdGlvbnMubnVtYmVyT2ZDYXNjYWRlcykgJiZcbiAgICBvcHRpb25zLm51bWJlck9mQ2FzY2FkZXMgIT09IDEgJiZcbiAgICBvcHRpb25zLm51bWJlck9mQ2FzY2FkZXMgIT09IDRcbiAgKSB7XG4gICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFwiT25seSBvbmUgb3IgZm91ciBjYXNjYWRlcyBhcmUgc3VwcG9ydGVkLlwiKTtcbiAgfVxuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB0aGlzLl9lbmFibGVkID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuZW5hYmxlZCwgdHJ1ZSk7XG4gIHRoaXMuX3NvZnRTaGFkb3dzID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuc29mdFNoYWRvd3MsIGZhbHNlKTtcbiAgdGhpcy5fbm9ybWFsT2Zmc2V0ID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMubm9ybWFsT2Zmc2V0LCB0cnVlKTtcbiAgdGhpcy5kaXJ0eSA9IHRydWU7XG5cbiAgLyoqXG4gICAqIFNwZWNpZmllcyB3aGV0aGVyIHRoZSBzaGFkb3cgbWFwIG9yaWdpbmF0ZXMgZnJvbSBhIGxpZ2h0IHNvdXJjZS4gU2hhZG93IG1hcHMgdGhhdCBhcmUgdXNlZCBmb3IgYW5hbHl0aWNhbFxuICAgKiBwdXJwb3NlcyBzaG91bGQgc2V0IHRoaXMgdG8gZmFsc2Ugc28gYXMgbm90IHRvIGFmZmVjdCBzY2VuZSByZW5kZXJpbmcuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB0aGlzLmZyb21MaWdodFNvdXJjZSA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmZyb21MaWdodFNvdXJjZSwgdHJ1ZSk7XG5cbiAgLyoqXG4gICAqIERldGVybWluZXMgdGhlIGRhcmtuZXNzIG9mIHRoZSBzaGFkb3dzLlxuICAgKlxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKiBAZGVmYXVsdCAwLjNcbiAgICovXG4gIHRoaXMuZGFya25lc3MgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5kYXJrbmVzcywgMC4zKTtcbiAgdGhpcy5fZGFya25lc3MgPSB0aGlzLmRhcmtuZXNzO1xuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIHdoZXRoZXIgc2hhZG93cyBzdGFydCB0byBmYWRlIG91dCBvbmNlIHRoZSBsaWdodCBnZXRzIGNsb3NlciB0byB0aGUgaG9yaXpvbi5cbiAgICpcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqIEBkZWZhdWx0IHRydWVcbiAgICovXG4gIHRoaXMuZmFkaW5nRW5hYmxlZCA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmZhZGluZ0VuYWJsZWQsIHRydWUpO1xuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIHRoZSBtYXhpbXVtIGRpc3RhbmNlIG9mIHRoZSBzaGFkb3cgbWFwLiBPbmx5IGFwcGxpY2FibGUgZm9yIGNhc2NhZGVkIHNoYWRvd3MuIExhcmdlciBkaXN0YW5jZXMgbWF5IHJlc3VsdCBpbiBsb3dlciBxdWFsaXR5IHNoYWRvd3MuXG4gICAqXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqIEBkZWZhdWx0IDUwMDAuMFxuICAgKi9cbiAgdGhpcy5tYXhpbXVtRGlzdGFuY2UgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5tYXhpbXVtRGlzdGFuY2UsIDUwMDAuMCk7XG5cbiAgdGhpcy5fb3V0T2ZWaWV3ID0gZmFsc2U7XG4gIHRoaXMuX291dE9mVmlld1ByZXZpb3VzID0gZmFsc2U7XG4gIHRoaXMuX25lZWRzVXBkYXRlID0gdHJ1ZTtcblxuICAvLyBJbiBJRTExIGFuZCBFZGdlIHBvbHlnb24gb2Zmc2V0IGlzIG5vdCBmdW5jdGlvbmFsLlxuICAvLyBUT0RPIDogQWxzbyBkaXNhYmxlZCBmb3IgaW5zdGFuY2VzIG9mIEZpcmVmb3ggYW5kIENocm9tZSBydW5uaW5nIEFOR0xFIHRoYXQgZG8gbm90IHN1cHBvcnQgZGVwdGggdGV4dHVyZXMuXG4gIC8vIFJlLWVuYWJsZSBvbmNlIGh0dHBzOi8vZ2l0aHViLmNvbS9DZXNpdW1HUy9jZXNpdW0vaXNzdWVzLzQ1NjAgaXMgcmVzb2x2ZWQuXG4gIHZhciBwb2x5Z29uT2Zmc2V0U3VwcG9ydGVkID0gdHJ1ZTtcbiAgaWYgKFxuICAgIEZlYXR1cmVEZXRlY3Rpb24uaXNJbnRlcm5ldEV4cGxvcmVyKCkgfHxcbiAgICBGZWF0dXJlRGV0ZWN0aW9uLmlzRWRnZSgpIHx8XG4gICAgKChGZWF0dXJlRGV0ZWN0aW9uLmlzQ2hyb21lKCkgfHwgRmVhdHVyZURldGVjdGlvbi5pc0ZpcmVmb3goKSkgJiZcbiAgICAgIEZlYXR1cmVEZXRlY3Rpb24uaXNXaW5kb3dzKCkgJiZcbiAgICAgICFjb250ZXh0LmRlcHRoVGV4dHVyZSlcbiAgKSB7XG4gICAgcG9seWdvbk9mZnNldFN1cHBvcnRlZCA9IGZhbHNlO1xuICB9XG4gIHRoaXMuX3BvbHlnb25PZmZzZXRTdXBwb3J0ZWQgPSBwb2x5Z29uT2Zmc2V0U3VwcG9ydGVkO1xuXG4gIHRoaXMuX3RlcnJhaW5CaWFzID0ge1xuICAgIHBvbHlnb25PZmZzZXQ6IHBvbHlnb25PZmZzZXRTdXBwb3J0ZWQsXG4gICAgcG9seWdvbk9mZnNldEZhY3RvcjogMS4xLFxuICAgIHBvbHlnb25PZmZzZXRVbml0czogNC4wLFxuICAgIG5vcm1hbE9mZnNldDogdGhpcy5fbm9ybWFsT2Zmc2V0LFxuICAgIG5vcm1hbE9mZnNldFNjYWxlOiAwLjUsXG4gICAgbm9ybWFsU2hhZGluZzogdHJ1ZSxcbiAgICBub3JtYWxTaGFkaW5nU21vb3RoOiAwLjMsXG4gICAgZGVwdGhCaWFzOiAwLjAwMDEsXG4gIH07XG5cbiAgdGhpcy5fcHJpbWl0aXZlQmlhcyA9IHtcbiAgICBwb2x5Z29uT2Zmc2V0OiBwb2x5Z29uT2Zmc2V0U3VwcG9ydGVkLFxuICAgIHBvbHlnb25PZmZzZXRGYWN0b3I6IDEuMSxcbiAgICBwb2x5Z29uT2Zmc2V0VW5pdHM6IDQuMCxcbiAgICBub3JtYWxPZmZzZXQ6IHRoaXMuX25vcm1hbE9mZnNldCxcbiAgICBub3JtYWxPZmZzZXRTY2FsZTogMC4xLFxuICAgIG5vcm1hbFNoYWRpbmc6IHRydWUsXG4gICAgbm9ybWFsU2hhZGluZ1Ntb290aDogMC4wNSxcbiAgICBkZXB0aEJpYXM6IDAuMDAwMDIsXG4gIH07XG5cbiAgdGhpcy5fcG9pbnRCaWFzID0ge1xuICAgIHBvbHlnb25PZmZzZXQ6IGZhbHNlLFxuICAgIHBvbHlnb25PZmZzZXRGYWN0b3I6IDEuMSxcbiAgICBwb2x5Z29uT2Zmc2V0VW5pdHM6IDQuMCxcbiAgICBub3JtYWxPZmZzZXQ6IHRoaXMuX25vcm1hbE9mZnNldCxcbiAgICBub3JtYWxPZmZzZXRTY2FsZTogMC4wLFxuICAgIG5vcm1hbFNoYWRpbmc6IHRydWUsXG4gICAgbm9ybWFsU2hhZGluZ1Ntb290aDogMC4xLFxuICAgIGRlcHRoQmlhczogMC4wMDA1LFxuICB9O1xuXG4gIC8vIEZyYW1lYnVmZmVyIHJlc291cmNlc1xuICB0aGlzLl9kZXB0aEF0dGFjaG1lbnQgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2NvbG9yQXR0YWNobWVudCA9IHVuZGVmaW5lZDtcblxuICAvLyBVbmlmb3Jtc1xuICB0aGlzLl9zaGFkb3dNYXBNYXRyaXggPSBuZXcgTWF0cml4NCgpO1xuICB0aGlzLl9zaGFkb3dNYXBUZXh0dXJlID0gdW5kZWZpbmVkO1xuICB0aGlzLl9saWdodERpcmVjdGlvbkVDID0gbmV3IENhcnRlc2lhbjMoKTtcbiAgdGhpcy5fbGlnaHRQb3NpdGlvbkVDID0gbmV3IENhcnRlc2lhbjQoKTtcbiAgdGhpcy5fZGlzdGFuY2UgPSAwLjA7XG5cbiAgdGhpcy5fbGlnaHRDYW1lcmEgPSBvcHRpb25zLmxpZ2h0Q2FtZXJhO1xuICB0aGlzLl9zaGFkb3dNYXBDYW1lcmEgPSBuZXcgU2hhZG93TWFwQ2FtZXJhKCk7XG4gIHRoaXMuX3NoYWRvd01hcEN1bGxpbmdWb2x1bWUgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX3NjZW5lQ2FtZXJhID0gdW5kZWZpbmVkO1xuICB0aGlzLl9ib3VuZGluZ1NwaGVyZSA9IG5ldyBCb3VuZGluZ1NwaGVyZSgpO1xuXG4gIHRoaXMuX2lzUG9pbnRMaWdodCA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmlzUG9pbnRMaWdodCwgZmFsc2UpO1xuICB0aGlzLl9wb2ludExpZ2h0UmFkaXVzID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMucG9pbnRMaWdodFJhZGl1cywgMTAwLjApO1xuXG4gIHRoaXMuX2Nhc2NhZGVzRW5hYmxlZCA9IHRoaXMuX2lzUG9pbnRMaWdodFxuICAgID8gZmFsc2VcbiAgICA6IGRlZmF1bHRWYWx1ZShvcHRpb25zLmNhc2NhZGVzRW5hYmxlZCwgdHJ1ZSk7XG4gIHRoaXMuX251bWJlck9mQ2FzY2FkZXMgPSAhdGhpcy5fY2FzY2FkZXNFbmFibGVkXG4gICAgPyAwXG4gICAgOiBkZWZhdWx0VmFsdWUob3B0aW9ucy5udW1iZXJPZkNhc2NhZGVzLCA0KTtcbiAgdGhpcy5fZml0TmVhckZhciA9IHRydWU7XG4gIHRoaXMuX21heGltdW1DYXNjYWRlRGlzdGFuY2VzID0gWzI1LjAsIDE1MC4wLCA3MDAuMCwgTnVtYmVyLk1BWF9WQUxVRV07XG5cbiAgdGhpcy5fdGV4dHVyZVNpemUgPSBuZXcgQ2FydGVzaWFuMigpO1xuXG4gIHRoaXMuX2lzU3BvdExpZ2h0ID0gZmFsc2U7XG4gIGlmICh0aGlzLl9jYXNjYWRlc0VuYWJsZWQpIHtcbiAgICAvLyBDYXNjYWRlZCBzaGFkb3dzIGFyZSBhbHdheXMgb3J0aG9ncmFwaGljLiBUaGUgZnJ1c3R1bSBkaW1lbnNpb25zIGFyZSBjYWxjdWxhdGVkIG9uIHRoZSBmbHkuXG4gICAgdGhpcy5fc2hhZG93TWFwQ2FtZXJhLmZydXN0dW0gPSBuZXcgT3J0aG9ncmFwaGljT2ZmQ2VudGVyRnJ1c3R1bSgpO1xuICB9IGVsc2UgaWYgKGRlZmluZWQodGhpcy5fbGlnaHRDYW1lcmEuZnJ1c3R1bS5mb3YpKSB7XG4gICAgLy8gSWYgdGhlIGxpZ2h0IGNhbWVyYSB1c2VzIGEgcGVyc3BlY3RpdmUgZnJ1c3R1bSwgdGhlbiB0aGUgbGlnaHQgc291cmNlIGlzIGEgc3BvdCBsaWdodFxuICAgIHRoaXMuX2lzU3BvdExpZ2h0ID0gdHJ1ZTtcbiAgfVxuXG4gIC8vIFVuaWZvcm1zXG4gIHRoaXMuX2Nhc2NhZGVTcGxpdHMgPSBbbmV3IENhcnRlc2lhbjQoKSwgbmV3IENhcnRlc2lhbjQoKV07XG4gIHRoaXMuX2Nhc2NhZGVNYXRyaWNlcyA9IFtcbiAgICBuZXcgTWF0cml4NCgpLFxuICAgIG5ldyBNYXRyaXg0KCksXG4gICAgbmV3IE1hdHJpeDQoKSxcbiAgICBuZXcgTWF0cml4NCgpLFxuICBdO1xuICB0aGlzLl9jYXNjYWRlRGlzdGFuY2VzID0gbmV3IENhcnRlc2lhbjQoKTtcblxuICB2YXIgbnVtYmVyT2ZQYXNzZXM7XG4gIGlmICh0aGlzLl9pc1BvaW50TGlnaHQpIHtcbiAgICBudW1iZXJPZlBhc3NlcyA9IDY7IC8vIE9uZSBzaGFkb3cgbWFwIGZvciBlYWNoIGRpcmVjdGlvblxuICB9IGVsc2UgaWYgKCF0aGlzLl9jYXNjYWRlc0VuYWJsZWQpIHtcbiAgICBudW1iZXJPZlBhc3NlcyA9IDE7XG4gIH0gZWxzZSB7XG4gICAgbnVtYmVyT2ZQYXNzZXMgPSB0aGlzLl9udW1iZXJPZkNhc2NhZGVzO1xuICB9XG5cbiAgdGhpcy5fcGFzc2VzID0gbmV3IEFycmF5KG51bWJlck9mUGFzc2VzKTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1iZXJPZlBhc3NlczsgKytpKSB7XG4gICAgdGhpcy5fcGFzc2VzW2ldID0gbmV3IFNoYWRvd1Bhc3MoY29udGV4dCk7XG4gIH1cblxuICB0aGlzLmRlYnVnU2hvdyA9IGZhbHNlO1xuICB0aGlzLmRlYnVnRnJlZXplRnJhbWUgPSBmYWxzZTtcbiAgdGhpcy5fZGVidWdGcmVlemVGcmFtZSA9IGZhbHNlO1xuICB0aGlzLl9kZWJ1Z0Nhc2NhZGVDb2xvcnMgPSBmYWxzZTtcbiAgdGhpcy5fZGVidWdMaWdodEZydXN0dW0gPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2RlYnVnQ2FtZXJhRnJ1c3R1bSA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fZGVidWdDYXNjYWRlRnJ1c3R1bXMgPSBuZXcgQXJyYXkodGhpcy5fbnVtYmVyT2ZDYXNjYWRlcyk7XG4gIHRoaXMuX2RlYnVnU2hhZG93Vmlld0NvbW1hbmQgPSB1bmRlZmluZWQ7XG5cbiAgdGhpcy5fdXNlc0RlcHRoVGV4dHVyZSA9IGNvbnRleHQuZGVwdGhUZXh0dXJlO1xuXG4gIGlmICh0aGlzLl9pc1BvaW50TGlnaHQpIHtcbiAgICB0aGlzLl91c2VzRGVwdGhUZXh0dXJlID0gZmFsc2U7XG4gIH1cblxuICAvLyBDcmVhdGUgcmVuZGVyIHN0YXRlcyBmb3Igc2hhZG93IGNhc3RlcnNcbiAgdGhpcy5fcHJpbWl0aXZlUmVuZGVyU3RhdGUgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX3RlcnJhaW5SZW5kZXJTdGF0ZSA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fcG9pbnRSZW5kZXJTdGF0ZSA9IHVuZGVmaW5lZDtcbiAgY3JlYXRlUmVuZGVyU3RhdGVzKHRoaXMpO1xuXG4gIC8vIEZvciBjbGVhcmluZyB0aGUgc2hhZG93IG1hcCB0ZXh0dXJlIGV2ZXJ5IGZyYW1lXG4gIHRoaXMuX2NsZWFyQ29tbWFuZCA9IG5ldyBDbGVhckNvbW1hbmQoe1xuICAgIGRlcHRoOiAxLjAsXG4gICAgY29sb3I6IG5ldyBDb2xvcigpLFxuICB9KTtcblxuICB0aGlzLl9jbGVhclBhc3NTdGF0ZSA9IG5ldyBQYXNzU3RhdGUoY29udGV4dCk7XG5cbiAgdGhpcy5fc2l6ZSA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLnNpemUsIDIwNDgpO1xuICB0aGlzLnNpemUgPSB0aGlzLl9zaXplO1xufVxuXG4vKipcbiAqIEdsb2JhbCBtYXhpbXVtIHNoYWRvdyBkaXN0YW5jZSB1c2VkIHRvIHByZXZlbnQgZmFyIG9mZiByZWNlaXZlcnMgZnJvbSBleHRlbmRpbmdcbiAqIHRoZSBzaGFkb3cgZmFyIHBsYW5lLiBUaGlzIGhlbHBzIHNldCBhIHRpZ2h0ZXIgbmVhci9mYXIgd2hlbiB2aWV3aW5nIG9iamVjdHMgZnJvbSBzcGFjZS5cbiAqXG4gKiBAcHJpdmF0ZVxuICovXG5TaGFkb3dNYXAuTUFYSU1VTV9ESVNUQU5DRSA9IDIwMDAwLjA7XG5cbmZ1bmN0aW9uIFNoYWRvd1Bhc3MoY29udGV4dCkge1xuICB0aGlzLmNhbWVyYSA9IG5ldyBTaGFkb3dNYXBDYW1lcmEoKTtcbiAgdGhpcy5wYXNzU3RhdGUgPSBuZXcgUGFzc1N0YXRlKGNvbnRleHQpO1xuICB0aGlzLmZyYW1lYnVmZmVyID0gdW5kZWZpbmVkO1xuICB0aGlzLnRleHR1cmVPZmZzZXRzID0gdW5kZWZpbmVkO1xuICB0aGlzLmNvbW1hbmRMaXN0ID0gW107XG4gIHRoaXMuY3VsbGluZ1ZvbHVtZSA9IHVuZGVmaW5lZDtcbn1cblxuZnVuY3Rpb24gY3JlYXRlUmVuZGVyU3RhdGUoY29sb3JNYXNrLCBiaWFzKSB7XG4gIHJldHVybiBSZW5kZXJTdGF0ZS5mcm9tQ2FjaGUoe1xuICAgIGN1bGw6IHtcbiAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICBmYWNlOiBDdWxsRmFjZS5CQUNLLFxuICAgIH0sXG4gICAgZGVwdGhUZXN0OiB7XG4gICAgICBlbmFibGVkOiB0cnVlLFxuICAgIH0sXG4gICAgY29sb3JNYXNrOiB7XG4gICAgICByZWQ6IGNvbG9yTWFzayxcbiAgICAgIGdyZWVuOiBjb2xvck1hc2ssXG4gICAgICBibHVlOiBjb2xvck1hc2ssXG4gICAgICBhbHBoYTogY29sb3JNYXNrLFxuICAgIH0sXG4gICAgZGVwdGhNYXNrOiB0cnVlLFxuICAgIHBvbHlnb25PZmZzZXQ6IHtcbiAgICAgIGVuYWJsZWQ6IGJpYXMucG9seWdvbk9mZnNldCxcbiAgICAgIGZhY3RvcjogYmlhcy5wb2x5Z29uT2Zmc2V0RmFjdG9yLFxuICAgICAgdW5pdHM6IGJpYXMucG9seWdvbk9mZnNldFVuaXRzLFxuICAgIH0sXG4gIH0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVSZW5kZXJTdGF0ZXMoc2hhZG93TWFwKSB7XG4gIC8vIEVuYWJsZSB0aGUgY29sb3IgbWFzayBpZiB0aGUgc2hhZG93IG1hcCBpcyBiYWNrZWQgYnkgYSBjb2xvciB0ZXh0dXJlLCBlLmcuIHdoZW4gZGVwdGggdGV4dHVyZXMgYXJlbid0IHN1cHBvcnRlZFxuICB2YXIgY29sb3JNYXNrID0gIXNoYWRvd01hcC5fdXNlc0RlcHRoVGV4dHVyZTtcbiAgc2hhZG93TWFwLl9wcmltaXRpdmVSZW5kZXJTdGF0ZSA9IGNyZWF0ZVJlbmRlclN0YXRlKFxuICAgIGNvbG9yTWFzayxcbiAgICBzaGFkb3dNYXAuX3ByaW1pdGl2ZUJpYXNcbiAgKTtcbiAgc2hhZG93TWFwLl90ZXJyYWluUmVuZGVyU3RhdGUgPSBjcmVhdGVSZW5kZXJTdGF0ZShcbiAgICBjb2xvck1hc2ssXG4gICAgc2hhZG93TWFwLl90ZXJyYWluQmlhc1xuICApO1xuICBzaGFkb3dNYXAuX3BvaW50UmVuZGVyU3RhdGUgPSBjcmVhdGVSZW5kZXJTdGF0ZShcbiAgICBjb2xvck1hc2ssXG4gICAgc2hhZG93TWFwLl9wb2ludEJpYXNcbiAgKTtcbn1cblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5TaGFkb3dNYXAucHJvdG90eXBlLmRlYnVnQ3JlYXRlUmVuZGVyU3RhdGVzID0gZnVuY3Rpb24gKCkge1xuICBjcmVhdGVSZW5kZXJTdGF0ZXModGhpcyk7XG59O1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhTaGFkb3dNYXAucHJvdG90eXBlLCB7XG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIGlmIHRoZSBzaGFkb3cgbWFwIHdpbGwgYmUgc2hvd24uXG4gICAqXG4gICAqIEBtZW1iZXJvZiBTaGFkb3dNYXAucHJvdG90eXBlXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKiBAZGVmYXVsdCB0cnVlXG4gICAqL1xuICBlbmFibGVkOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZW5hYmxlZDtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICB0aGlzLmRpcnR5ID0gdGhpcy5fZW5hYmxlZCAhPT0gdmFsdWU7XG4gICAgICB0aGlzLl9lbmFibGVkID0gdmFsdWU7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiBhIG5vcm1hbCBiaWFzIHdpbGwgYmUgYXBwbGllZCB0byBzaGFkb3dzLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgU2hhZG93TWFwLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICogQGRlZmF1bHQgdHJ1ZVxuICAgKi9cbiAgbm9ybWFsT2Zmc2V0OiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbm9ybWFsT2Zmc2V0O1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHRoaXMuZGlydHkgPSB0aGlzLl9ub3JtYWxPZmZzZXQgIT09IHZhbHVlO1xuICAgICAgdGhpcy5fbm9ybWFsT2Zmc2V0ID0gdmFsdWU7XG4gICAgICB0aGlzLl90ZXJyYWluQmlhcy5ub3JtYWxPZmZzZXQgPSB2YWx1ZTtcbiAgICAgIHRoaXMuX3ByaW1pdGl2ZUJpYXMubm9ybWFsT2Zmc2V0ID0gdmFsdWU7XG4gICAgICB0aGlzLl9wb2ludEJpYXMubm9ybWFsT2Zmc2V0ID0gdmFsdWU7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiBzb2Z0IHNoYWRvd3MgYXJlIGVuYWJsZWQuIFVzZXMgcGNmIGZpbHRlcmluZyB3aGljaCByZXF1aXJlcyBtb3JlIHRleHR1cmUgcmVhZHMgYW5kIG1heSBodXJ0IHBlcmZvcm1hbmNlLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgU2hhZG93TWFwLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICogQGRlZmF1bHQgZmFsc2VcbiAgICovXG4gIHNvZnRTaGFkb3dzOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc29mdFNoYWRvd3M7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgdGhpcy5kaXJ0eSA9IHRoaXMuX3NvZnRTaGFkb3dzICE9PSB2YWx1ZTtcbiAgICAgIHRoaXMuX3NvZnRTaGFkb3dzID0gdmFsdWU7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogVGhlIHdpZHRoIGFuZCBoZWlnaHQsIGluIHBpeGVscywgb2YgZWFjaCBzaGFkb3cgbWFwLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgU2hhZG93TWFwLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKiBAZGVmYXVsdCAyMDQ4XG4gICAqL1xuICBzaXplOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2l6ZTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICByZXNpemUodGhpcywgdmFsdWUpO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdGhlIHNoYWRvdyBtYXAgaXMgb3V0IG9mIHZpZXcgb2YgdGhlIHNjZW5lIGNhbWVyYS5cbiAgICpcbiAgICogQG1lbWJlcm9mIFNoYWRvd01hcC5wcm90b3R5cGVcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqIEByZWFkb25seVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgb3V0T2ZWaWV3OiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fb3V0T2ZWaWV3O1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFRoZSBjdWxsaW5nIHZvbHVtZSBvZiB0aGUgc2hhZG93IGZydXN0dW0uXG4gICAqXG4gICAqIEBtZW1iZXJvZiBTaGFkb3dNYXAucHJvdG90eXBlXG4gICAqIEB0eXBlIHtDdWxsaW5nVm9sdW1lfVxuICAgKiBAcmVhZG9ubHlcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHNoYWRvd01hcEN1bGxpbmdWb2x1bWU6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zaGFkb3dNYXBDdWxsaW5nVm9sdW1lO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFRoZSBwYXNzZXMgdXNlZCBmb3IgcmVuZGVyaW5nIHNoYWRvd3MuIEVhY2ggZmFjZSBvZiBhIHBvaW50IGxpZ2h0IG9yIGVhY2ggY2FzY2FkZSBmb3IgYSBjYXNjYWRlZCBzaGFkb3cgbWFwIGlzIGEgc2VwYXJhdGUgcGFzcy5cbiAgICpcbiAgICogQG1lbWJlcm9mIFNoYWRvd01hcC5wcm90b3R5cGVcbiAgICogQHR5cGUge1NoYWRvd1Bhc3NbXX1cbiAgICogQHJlYWRvbmx5XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwYXNzZXM6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9wYXNzZXM7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogV2hldGhlciB0aGUgbGlnaHQgc291cmNlIGlzIGEgcG9pbnQgbGlnaHQuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBTaGFkb3dNYXAucHJvdG90eXBlXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKiBAcmVhZG9ubHlcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGlzUG9pbnRMaWdodDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2lzUG9pbnRMaWdodDtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBEZWJ1ZyBvcHRpb24gZm9yIHZpc3VhbGl6aW5nIHRoZSBjYXNjYWRlcyBieSBjb2xvci5cbiAgICpcbiAgICogQG1lbWJlcm9mIFNoYWRvd01hcC5wcm90b3R5cGVcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqIEBkZWZhdWx0IGZhbHNlXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBkZWJ1Z0Nhc2NhZGVDb2xvcnM6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9kZWJ1Z0Nhc2NhZGVDb2xvcnM7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgdGhpcy5kaXJ0eSA9IHRoaXMuX2RlYnVnQ2FzY2FkZUNvbG9ycyAhPT0gdmFsdWU7XG4gICAgICB0aGlzLl9kZWJ1Z0Nhc2NhZGVDb2xvcnMgPSB2YWx1ZTtcbiAgICB9LFxuICB9LFxufSk7XG5cbmZ1bmN0aW9uIGRlc3Ryb3lGcmFtZWJ1ZmZlcihzaGFkb3dNYXApIHtcbiAgdmFyIGxlbmd0aCA9IHNoYWRvd01hcC5fcGFzc2VzLmxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIHZhciBwYXNzID0gc2hhZG93TWFwLl9wYXNzZXNbaV07XG4gICAgdmFyIGZyYW1lYnVmZmVyID0gcGFzcy5mcmFtZWJ1ZmZlcjtcbiAgICBpZiAoZGVmaW5lZChmcmFtZWJ1ZmZlcikgJiYgIWZyYW1lYnVmZmVyLmlzRGVzdHJveWVkKCkpIHtcbiAgICAgIGZyYW1lYnVmZmVyLmRlc3Ryb3koKTtcbiAgICB9XG4gICAgcGFzcy5mcmFtZWJ1ZmZlciA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIC8vIERlc3Ryb3kgdGhlIGZyYW1lYnVmZmVyIGF0dGFjaG1lbnRzXG4gIHNoYWRvd01hcC5fZGVwdGhBdHRhY2htZW50ID1cbiAgICBzaGFkb3dNYXAuX2RlcHRoQXR0YWNobWVudCAmJiBzaGFkb3dNYXAuX2RlcHRoQXR0YWNobWVudC5kZXN0cm95KCk7XG4gIHNoYWRvd01hcC5fY29sb3JBdHRhY2htZW50ID1cbiAgICBzaGFkb3dNYXAuX2NvbG9yQXR0YWNobWVudCAmJiBzaGFkb3dNYXAuX2NvbG9yQXR0YWNobWVudC5kZXN0cm95KCk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUZyYW1lYnVmZmVyQ29sb3Ioc2hhZG93TWFwLCBjb250ZXh0KSB7XG4gIHZhciBkZXB0aFJlbmRlcmJ1ZmZlciA9IG5ldyBSZW5kZXJidWZmZXIoe1xuICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgd2lkdGg6IHNoYWRvd01hcC5fdGV4dHVyZVNpemUueCxcbiAgICBoZWlnaHQ6IHNoYWRvd01hcC5fdGV4dHVyZVNpemUueSxcbiAgICBmb3JtYXQ6IFJlbmRlcmJ1ZmZlckZvcm1hdC5ERVBUSF9DT01QT05FTlQxNixcbiAgfSk7XG5cbiAgdmFyIGNvbG9yVGV4dHVyZSA9IG5ldyBUZXh0dXJlKHtcbiAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgIHdpZHRoOiBzaGFkb3dNYXAuX3RleHR1cmVTaXplLngsXG4gICAgaGVpZ2h0OiBzaGFkb3dNYXAuX3RleHR1cmVTaXplLnksXG4gICAgcGl4ZWxGb3JtYXQ6IFBpeGVsRm9ybWF0LlJHQkEsXG4gICAgcGl4ZWxEYXRhdHlwZTogUGl4ZWxEYXRhdHlwZS5VTlNJR05FRF9CWVRFLFxuICAgIHNhbXBsZXI6IFNhbXBsZXIuTkVBUkVTVCxcbiAgfSk7XG5cbiAgdmFyIGZyYW1lYnVmZmVyID0gbmV3IEZyYW1lYnVmZmVyKHtcbiAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgIGRlcHRoUmVuZGVyYnVmZmVyOiBkZXB0aFJlbmRlcmJ1ZmZlcixcbiAgICBjb2xvclRleHR1cmVzOiBbY29sb3JUZXh0dXJlXSxcbiAgICBkZXN0cm95QXR0YWNobWVudHM6IGZhbHNlLFxuICB9KTtcblxuICB2YXIgbGVuZ3RoID0gc2hhZG93TWFwLl9wYXNzZXMubGVuZ3RoO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgdmFyIHBhc3MgPSBzaGFkb3dNYXAuX3Bhc3Nlc1tpXTtcbiAgICBwYXNzLmZyYW1lYnVmZmVyID0gZnJhbWVidWZmZXI7XG4gICAgcGFzcy5wYXNzU3RhdGUuZnJhbWVidWZmZXIgPSBmcmFtZWJ1ZmZlcjtcbiAgfVxuXG4gIHNoYWRvd01hcC5fc2hhZG93TWFwVGV4dHVyZSA9IGNvbG9yVGV4dHVyZTtcbiAgc2hhZG93TWFwLl9kZXB0aEF0dGFjaG1lbnQgPSBkZXB0aFJlbmRlcmJ1ZmZlcjtcbiAgc2hhZG93TWFwLl9jb2xvckF0dGFjaG1lbnQgPSBjb2xvclRleHR1cmU7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUZyYW1lYnVmZmVyRGVwdGgoc2hhZG93TWFwLCBjb250ZXh0KSB7XG4gIHZhciBkZXB0aFN0ZW5jaWxUZXh0dXJlID0gbmV3IFRleHR1cmUoe1xuICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgd2lkdGg6IHNoYWRvd01hcC5fdGV4dHVyZVNpemUueCxcbiAgICBoZWlnaHQ6IHNoYWRvd01hcC5fdGV4dHVyZVNpemUueSxcbiAgICBwaXhlbEZvcm1hdDogUGl4ZWxGb3JtYXQuREVQVEhfU1RFTkNJTCxcbiAgICBwaXhlbERhdGF0eXBlOiBQaXhlbERhdGF0eXBlLlVOU0lHTkVEX0lOVF8yNF84LFxuICAgIHNhbXBsZXI6IFNhbXBsZXIuTkVBUkVTVCxcbiAgfSk7XG5cbiAgdmFyIGZyYW1lYnVmZmVyID0gbmV3IEZyYW1lYnVmZmVyKHtcbiAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgIGRlcHRoU3RlbmNpbFRleHR1cmU6IGRlcHRoU3RlbmNpbFRleHR1cmUsXG4gICAgZGVzdHJveUF0dGFjaG1lbnRzOiBmYWxzZSxcbiAgfSk7XG5cbiAgdmFyIGxlbmd0aCA9IHNoYWRvd01hcC5fcGFzc2VzLmxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIHZhciBwYXNzID0gc2hhZG93TWFwLl9wYXNzZXNbaV07XG4gICAgcGFzcy5mcmFtZWJ1ZmZlciA9IGZyYW1lYnVmZmVyO1xuICAgIHBhc3MucGFzc1N0YXRlLmZyYW1lYnVmZmVyID0gZnJhbWVidWZmZXI7XG4gIH1cblxuICBzaGFkb3dNYXAuX3NoYWRvd01hcFRleHR1cmUgPSBkZXB0aFN0ZW5jaWxUZXh0dXJlO1xuICBzaGFkb3dNYXAuX2RlcHRoQXR0YWNobWVudCA9IGRlcHRoU3RlbmNpbFRleHR1cmU7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUZyYW1lYnVmZmVyQ3ViZShzaGFkb3dNYXAsIGNvbnRleHQpIHtcbiAgdmFyIGRlcHRoUmVuZGVyYnVmZmVyID0gbmV3IFJlbmRlcmJ1ZmZlcih7XG4gICAgY29udGV4dDogY29udGV4dCxcbiAgICB3aWR0aDogc2hhZG93TWFwLl90ZXh0dXJlU2l6ZS54LFxuICAgIGhlaWdodDogc2hhZG93TWFwLl90ZXh0dXJlU2l6ZS55LFxuICAgIGZvcm1hdDogUmVuZGVyYnVmZmVyRm9ybWF0LkRFUFRIX0NPTVBPTkVOVDE2LFxuICB9KTtcblxuICB2YXIgY3ViZU1hcCA9IG5ldyBDdWJlTWFwKHtcbiAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgIHdpZHRoOiBzaGFkb3dNYXAuX3RleHR1cmVTaXplLngsXG4gICAgaGVpZ2h0OiBzaGFkb3dNYXAuX3RleHR1cmVTaXplLnksXG4gICAgcGl4ZWxGb3JtYXQ6IFBpeGVsRm9ybWF0LlJHQkEsXG4gICAgcGl4ZWxEYXRhdHlwZTogUGl4ZWxEYXRhdHlwZS5VTlNJR05FRF9CWVRFLFxuICAgIHNhbXBsZXI6IFNhbXBsZXIuTkVBUkVTVCxcbiAgfSk7XG5cbiAgdmFyIGZhY2VzID0gW1xuICAgIGN1YmVNYXAubmVnYXRpdmVYLFxuICAgIGN1YmVNYXAubmVnYXRpdmVZLFxuICAgIGN1YmVNYXAubmVnYXRpdmVaLFxuICAgIGN1YmVNYXAucG9zaXRpdmVYLFxuICAgIGN1YmVNYXAucG9zaXRpdmVZLFxuICAgIGN1YmVNYXAucG9zaXRpdmVaLFxuICBdO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgNjsgKytpKSB7XG4gICAgdmFyIGZyYW1lYnVmZmVyID0gbmV3IEZyYW1lYnVmZmVyKHtcbiAgICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgICBkZXB0aFJlbmRlcmJ1ZmZlcjogZGVwdGhSZW5kZXJidWZmZXIsXG4gICAgICBjb2xvclRleHR1cmVzOiBbZmFjZXNbaV1dLFxuICAgICAgZGVzdHJveUF0dGFjaG1lbnRzOiBmYWxzZSxcbiAgICB9KTtcbiAgICB2YXIgcGFzcyA9IHNoYWRvd01hcC5fcGFzc2VzW2ldO1xuICAgIHBhc3MuZnJhbWVidWZmZXIgPSBmcmFtZWJ1ZmZlcjtcbiAgICBwYXNzLnBhc3NTdGF0ZS5mcmFtZWJ1ZmZlciA9IGZyYW1lYnVmZmVyO1xuICB9XG5cbiAgc2hhZG93TWFwLl9zaGFkb3dNYXBUZXh0dXJlID0gY3ViZU1hcDtcbiAgc2hhZG93TWFwLl9kZXB0aEF0dGFjaG1lbnQgPSBkZXB0aFJlbmRlcmJ1ZmZlcjtcbiAgc2hhZG93TWFwLl9jb2xvckF0dGFjaG1lbnQgPSBjdWJlTWFwO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVGcmFtZWJ1ZmZlcihzaGFkb3dNYXAsIGNvbnRleHQpIHtcbiAgaWYgKHNoYWRvd01hcC5faXNQb2ludExpZ2h0KSB7XG4gICAgY3JlYXRlRnJhbWVidWZmZXJDdWJlKHNoYWRvd01hcCwgY29udGV4dCk7XG4gIH0gZWxzZSBpZiAoc2hhZG93TWFwLl91c2VzRGVwdGhUZXh0dXJlKSB7XG4gICAgY3JlYXRlRnJhbWVidWZmZXJEZXB0aChzaGFkb3dNYXAsIGNvbnRleHQpO1xuICB9IGVsc2Uge1xuICAgIGNyZWF0ZUZyYW1lYnVmZmVyQ29sb3Ioc2hhZG93TWFwLCBjb250ZXh0KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBjaGVja0ZyYW1lYnVmZmVyKHNoYWRvd01hcCwgY29udGV4dCkge1xuICAvLyBBdHRlbXB0IHRvIG1ha2UgYW4gRkJPIHdpdGggb25seSBhIGRlcHRoIHRleHR1cmUuIElmIGl0IGZhaWxzLCBmYWxsYmFjayB0byBhIGNvbG9yIHRleHR1cmUuXG4gIGlmIChcbiAgICBzaGFkb3dNYXAuX3VzZXNEZXB0aFRleHR1cmUgJiZcbiAgICBzaGFkb3dNYXAuX3Bhc3Nlc1swXS5mcmFtZWJ1ZmZlci5zdGF0dXMgIT09XG4gICAgICBXZWJHTENvbnN0YW50cy5GUkFNRUJVRkZFUl9DT01QTEVURVxuICApIHtcbiAgICBzaGFkb3dNYXAuX3VzZXNEZXB0aFRleHR1cmUgPSBmYWxzZTtcbiAgICBjcmVhdGVSZW5kZXJTdGF0ZXMoc2hhZG93TWFwKTtcbiAgICBkZXN0cm95RnJhbWVidWZmZXIoc2hhZG93TWFwKTtcbiAgICBjcmVhdGVGcmFtZWJ1ZmZlcihzaGFkb3dNYXAsIGNvbnRleHQpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUZyYW1lYnVmZmVyKHNoYWRvd01hcCwgY29udGV4dCkge1xuICBpZiAoXG4gICAgIWRlZmluZWQoc2hhZG93TWFwLl9wYXNzZXNbMF0uZnJhbWVidWZmZXIpIHx8XG4gICAgc2hhZG93TWFwLl9zaGFkb3dNYXBUZXh0dXJlLndpZHRoICE9PSBzaGFkb3dNYXAuX3RleHR1cmVTaXplLnhcbiAgKSB7XG4gICAgZGVzdHJveUZyYW1lYnVmZmVyKHNoYWRvd01hcCk7XG4gICAgY3JlYXRlRnJhbWVidWZmZXIoc2hhZG93TWFwLCBjb250ZXh0KTtcbiAgICBjaGVja0ZyYW1lYnVmZmVyKHNoYWRvd01hcCwgY29udGV4dCk7XG4gICAgY2xlYXJGcmFtZWJ1ZmZlcihzaGFkb3dNYXAsIGNvbnRleHQpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNsZWFyRnJhbWVidWZmZXIoc2hhZG93TWFwLCBjb250ZXh0LCBzaGFkb3dQYXNzKSB7XG4gIHNoYWRvd1Bhc3MgPSBkZWZhdWx0VmFsdWUoc2hhZG93UGFzcywgMCk7XG4gIGlmIChzaGFkb3dNYXAuX2lzUG9pbnRMaWdodCB8fCBzaGFkb3dQYXNzID09PSAwKSB7XG4gICAgc2hhZG93TWFwLl9jbGVhckNvbW1hbmQuZnJhbWVidWZmZXIgPVxuICAgICAgc2hhZG93TWFwLl9wYXNzZXNbc2hhZG93UGFzc10uZnJhbWVidWZmZXI7XG4gICAgc2hhZG93TWFwLl9jbGVhckNvbW1hbmQuZXhlY3V0ZShjb250ZXh0LCBzaGFkb3dNYXAuX2NsZWFyUGFzc1N0YXRlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiByZXNpemUoc2hhZG93TWFwLCBzaXplKSB7XG4gIHNoYWRvd01hcC5fc2l6ZSA9IHNpemU7XG4gIHZhciBwYXNzZXMgPSBzaGFkb3dNYXAuX3Bhc3NlcztcbiAgdmFyIG51bWJlck9mUGFzc2VzID0gcGFzc2VzLmxlbmd0aDtcbiAgdmFyIHRleHR1cmVTaXplID0gc2hhZG93TWFwLl90ZXh0dXJlU2l6ZTtcblxuICBpZiAoc2hhZG93TWFwLl9pc1BvaW50TGlnaHQpIHtcbiAgICBzaXplID1cbiAgICAgIENvbnRleHRMaW1pdHMubWF4aW11bUN1YmVNYXBTaXplID49IHNpemVcbiAgICAgICAgPyBzaXplXG4gICAgICAgIDogQ29udGV4dExpbWl0cy5tYXhpbXVtQ3ViZU1hcFNpemU7XG4gICAgdGV4dHVyZVNpemUueCA9IHNpemU7XG4gICAgdGV4dHVyZVNpemUueSA9IHNpemU7XG4gICAgdmFyIGZhY2VWaWV3cG9ydCA9IG5ldyBCb3VuZGluZ1JlY3RhbmdsZSgwLCAwLCBzaXplLCBzaXplKTtcbiAgICBwYXNzZXNbMF0ucGFzc1N0YXRlLnZpZXdwb3J0ID0gZmFjZVZpZXdwb3J0O1xuICAgIHBhc3Nlc1sxXS5wYXNzU3RhdGUudmlld3BvcnQgPSBmYWNlVmlld3BvcnQ7XG4gICAgcGFzc2VzWzJdLnBhc3NTdGF0ZS52aWV3cG9ydCA9IGZhY2VWaWV3cG9ydDtcbiAgICBwYXNzZXNbM10ucGFzc1N0YXRlLnZpZXdwb3J0ID0gZmFjZVZpZXdwb3J0O1xuICAgIHBhc3Nlc1s0XS5wYXNzU3RhdGUudmlld3BvcnQgPSBmYWNlVmlld3BvcnQ7XG4gICAgcGFzc2VzWzVdLnBhc3NTdGF0ZS52aWV3cG9ydCA9IGZhY2VWaWV3cG9ydDtcbiAgfSBlbHNlIGlmIChudW1iZXJPZlBhc3NlcyA9PT0gMSkge1xuICAgIC8vICstLS0tK1xuICAgIC8vIHwgIDEgfFxuICAgIC8vICstLS0tK1xuICAgIHNpemUgPVxuICAgICAgQ29udGV4dExpbWl0cy5tYXhpbXVtVGV4dHVyZVNpemUgPj0gc2l6ZVxuICAgICAgICA/IHNpemVcbiAgICAgICAgOiBDb250ZXh0TGltaXRzLm1heGltdW1UZXh0dXJlU2l6ZTtcbiAgICB0ZXh0dXJlU2l6ZS54ID0gc2l6ZTtcbiAgICB0ZXh0dXJlU2l6ZS55ID0gc2l6ZTtcbiAgICBwYXNzZXNbMF0ucGFzc1N0YXRlLnZpZXdwb3J0ID0gbmV3IEJvdW5kaW5nUmVjdGFuZ2xlKDAsIDAsIHNpemUsIHNpemUpO1xuICB9IGVsc2UgaWYgKG51bWJlck9mUGFzc2VzID09PSA0KSB7XG4gICAgLy8gKy0tLS0rLS0tLStcbiAgICAvLyB8ICAzIHwgIDQgfFxuICAgIC8vICstLS0tKy0tLS0rXG4gICAgLy8gfCAgMSB8ICAyIHxcbiAgICAvLyArLS0tLSstLS0tK1xuICAgIHNpemUgPVxuICAgICAgQ29udGV4dExpbWl0cy5tYXhpbXVtVGV4dHVyZVNpemUgPj0gc2l6ZSAqIDJcbiAgICAgICAgPyBzaXplXG4gICAgICAgIDogQ29udGV4dExpbWl0cy5tYXhpbXVtVGV4dHVyZVNpemUgLyAyO1xuICAgIHRleHR1cmVTaXplLnggPSBzaXplICogMjtcbiAgICB0ZXh0dXJlU2l6ZS55ID0gc2l6ZSAqIDI7XG4gICAgcGFzc2VzWzBdLnBhc3NTdGF0ZS52aWV3cG9ydCA9IG5ldyBCb3VuZGluZ1JlY3RhbmdsZSgwLCAwLCBzaXplLCBzaXplKTtcbiAgICBwYXNzZXNbMV0ucGFzc1N0YXRlLnZpZXdwb3J0ID0gbmV3IEJvdW5kaW5nUmVjdGFuZ2xlKHNpemUsIDAsIHNpemUsIHNpemUpO1xuICAgIHBhc3Nlc1syXS5wYXNzU3RhdGUudmlld3BvcnQgPSBuZXcgQm91bmRpbmdSZWN0YW5nbGUoMCwgc2l6ZSwgc2l6ZSwgc2l6ZSk7XG4gICAgcGFzc2VzWzNdLnBhc3NTdGF0ZS52aWV3cG9ydCA9IG5ldyBCb3VuZGluZ1JlY3RhbmdsZShcbiAgICAgIHNpemUsXG4gICAgICBzaXplLFxuICAgICAgc2l6ZSxcbiAgICAgIHNpemVcbiAgICApO1xuICB9XG5cbiAgLy8gVXBkYXRlIGNsZWFyIHBhc3Mgc3RhdGVcbiAgc2hhZG93TWFwLl9jbGVhclBhc3NTdGF0ZS52aWV3cG9ydCA9IG5ldyBCb3VuZGluZ1JlY3RhbmdsZShcbiAgICAwLFxuICAgIDAsXG4gICAgdGV4dHVyZVNpemUueCxcbiAgICB0ZXh0dXJlU2l6ZS55XG4gICk7XG5cbiAgLy8gVHJhbnNmb3JtcyBzaGFkb3cgY29vcmRpbmF0ZXMgWzAsIDFdIGludG8gdGhlIHBhc3MncyByZWdpb24gb2YgdGhlIHRleHR1cmVcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1iZXJPZlBhc3NlczsgKytpKSB7XG4gICAgdmFyIHBhc3MgPSBwYXNzZXNbaV07XG4gICAgdmFyIHZpZXdwb3J0ID0gcGFzcy5wYXNzU3RhdGUudmlld3BvcnQ7XG4gICAgdmFyIGJpYXNYID0gdmlld3BvcnQueCAvIHRleHR1cmVTaXplLng7XG4gICAgdmFyIGJpYXNZID0gdmlld3BvcnQueSAvIHRleHR1cmVTaXplLnk7XG4gICAgdmFyIHNjYWxlWCA9IHZpZXdwb3J0LndpZHRoIC8gdGV4dHVyZVNpemUueDtcbiAgICB2YXIgc2NhbGVZID0gdmlld3BvcnQuaGVpZ2h0IC8gdGV4dHVyZVNpemUueTtcbiAgICBwYXNzLnRleHR1cmVPZmZzZXRzID0gbmV3IE1hdHJpeDQoXG4gICAgICBzY2FsZVgsXG4gICAgICAwLjAsXG4gICAgICAwLjAsXG4gICAgICBiaWFzWCxcbiAgICAgIDAuMCxcbiAgICAgIHNjYWxlWSxcbiAgICAgIDAuMCxcbiAgICAgIGJpYXNZLFxuICAgICAgMC4wLFxuICAgICAgMC4wLFxuICAgICAgMS4wLFxuICAgICAgMC4wLFxuICAgICAgMC4wLFxuICAgICAgMC4wLFxuICAgICAgMC4wLFxuICAgICAgMS4wXG4gICAgKTtcbiAgfVxufVxuXG52YXIgc2NyYXRjaFZpZXdwb3J0ID0gbmV3IEJvdW5kaW5nUmVjdGFuZ2xlKCk7XG5cbmZ1bmN0aW9uIGNyZWF0ZURlYnVnU2hhZG93Vmlld0NvbW1hbmQoc2hhZG93TWFwLCBjb250ZXh0KSB7XG4gIHZhciBmcztcbiAgaWYgKHNoYWRvd01hcC5faXNQb2ludExpZ2h0KSB7XG4gICAgZnMgPVxuICAgICAgXCJ1bmlmb3JtIHNhbXBsZXJDdWJlIHNoYWRvd01hcF90ZXh0dXJlQ3ViZTsgXFxuXCIgK1xuICAgICAgXCJ2YXJ5aW5nIHZlYzIgdl90ZXh0dXJlQ29vcmRpbmF0ZXM7IFxcblwiICtcbiAgICAgIFwidm9pZCBtYWluKCkgXFxuXCIgK1xuICAgICAgXCJ7IFxcblwiICtcbiAgICAgIFwiICAgIHZlYzIgdXYgPSB2X3RleHR1cmVDb29yZGluYXRlczsgXFxuXCIgK1xuICAgICAgXCIgICAgdmVjMyBkaXI7IFxcblwiICtcbiAgICAgIFwiIFxcblwiICtcbiAgICAgIFwiICAgIGlmICh1di55IDwgMC41KSBcXG5cIiArXG4gICAgICBcIiAgICB7IFxcblwiICtcbiAgICAgIFwiICAgICAgICBpZiAodXYueCA8IDAuMzMzKSBcXG5cIiArXG4gICAgICBcIiAgICAgICAgeyBcXG5cIiArXG4gICAgICBcIiAgICAgICAgICAgIGRpci54ID0gLTEuMDsgXFxuXCIgK1xuICAgICAgXCIgICAgICAgICAgICBkaXIueSA9IHV2LnggKiA2LjAgLSAxLjA7IFxcblwiICtcbiAgICAgIFwiICAgICAgICAgICAgZGlyLnogPSB1di55ICogNC4wIC0gMS4wOyBcXG5cIiArXG4gICAgICBcIiAgICAgICAgfSBcXG5cIiArXG4gICAgICBcIiAgICAgICAgZWxzZSBpZiAodXYueCA8IDAuNjY2KSBcXG5cIiArXG4gICAgICBcIiAgICAgICAgeyBcXG5cIiArXG4gICAgICBcIiAgICAgICAgICAgIGRpci55ID0gLTEuMDsgXFxuXCIgK1xuICAgICAgXCIgICAgICAgICAgICBkaXIueCA9IHV2LnggKiA2LjAgLSAzLjA7IFxcblwiICtcbiAgICAgIFwiICAgICAgICAgICAgZGlyLnogPSB1di55ICogNC4wIC0gMS4wOyBcXG5cIiArXG4gICAgICBcIiAgICAgICAgfSBcXG5cIiArXG4gICAgICBcIiAgICAgICAgZWxzZSBcXG5cIiArXG4gICAgICBcIiAgICAgICAgeyBcXG5cIiArXG4gICAgICBcIiAgICAgICAgICAgIGRpci56ID0gLTEuMDsgXFxuXCIgK1xuICAgICAgXCIgICAgICAgICAgICBkaXIueCA9IHV2LnggKiA2LjAgLSA1LjA7IFxcblwiICtcbiAgICAgIFwiICAgICAgICAgICAgZGlyLnkgPSB1di55ICogNC4wIC0gMS4wOyBcXG5cIiArXG4gICAgICBcIiAgICAgICAgfSBcXG5cIiArXG4gICAgICBcIiAgICB9IFxcblwiICtcbiAgICAgIFwiICAgIGVsc2UgXFxuXCIgK1xuICAgICAgXCIgICAgeyBcXG5cIiArXG4gICAgICBcIiAgICAgICAgaWYgKHV2LnggPCAwLjMzMykgXFxuXCIgK1xuICAgICAgXCIgICAgICAgIHsgXFxuXCIgK1xuICAgICAgXCIgICAgICAgICAgICBkaXIueCA9IDEuMDsgXFxuXCIgK1xuICAgICAgXCIgICAgICAgICAgICBkaXIueSA9IHV2LnggKiA2LjAgLSAxLjA7IFxcblwiICtcbiAgICAgIFwiICAgICAgICAgICAgZGlyLnogPSB1di55ICogNC4wIC0gMy4wOyBcXG5cIiArXG4gICAgICBcIiAgICAgICAgfSBcXG5cIiArXG4gICAgICBcIiAgICAgICAgZWxzZSBpZiAodXYueCA8IDAuNjY2KSBcXG5cIiArXG4gICAgICBcIiAgICAgICAgeyBcXG5cIiArXG4gICAgICBcIiAgICAgICAgICAgIGRpci55ID0gMS4wOyBcXG5cIiArXG4gICAgICBcIiAgICAgICAgICAgIGRpci54ID0gdXYueCAqIDYuMCAtIDMuMDsgXFxuXCIgK1xuICAgICAgXCIgICAgICAgICAgICBkaXIueiA9IHV2LnkgKiA0LjAgLSAzLjA7IFxcblwiICtcbiAgICAgIFwiICAgICAgICB9IFxcblwiICtcbiAgICAgIFwiICAgICAgICBlbHNlIFxcblwiICtcbiAgICAgIFwiICAgICAgICB7IFxcblwiICtcbiAgICAgIFwiICAgICAgICAgICAgZGlyLnogPSAxLjA7IFxcblwiICtcbiAgICAgIFwiICAgICAgICAgICAgZGlyLnggPSB1di54ICogNi4wIC0gNS4wOyBcXG5cIiArXG4gICAgICBcIiAgICAgICAgICAgIGRpci55ID0gdXYueSAqIDQuMCAtIDMuMDsgXFxuXCIgK1xuICAgICAgXCIgICAgICAgIH0gXFxuXCIgK1xuICAgICAgXCIgICAgfSBcXG5cIiArXG4gICAgICBcIiBcXG5cIiArXG4gICAgICBcIiAgICBmbG9hdCBzaGFkb3cgPSBjem1fdW5wYWNrRGVwdGgodGV4dHVyZUN1YmUoc2hhZG93TWFwX3RleHR1cmVDdWJlLCBkaXIpKTsgXFxuXCIgK1xuICAgICAgXCIgICAgZ2xfRnJhZ0NvbG9yID0gdmVjNCh2ZWMzKHNoYWRvdyksIDEuMCk7IFxcblwiICtcbiAgICAgIFwifSBcXG5cIjtcbiAgfSBlbHNlIHtcbiAgICBmcyA9XG4gICAgICBcInVuaWZvcm0gc2FtcGxlcjJEIHNoYWRvd01hcF90ZXh0dXJlOyBcXG5cIiArXG4gICAgICBcInZhcnlpbmcgdmVjMiB2X3RleHR1cmVDb29yZGluYXRlczsgXFxuXCIgK1xuICAgICAgXCJ2b2lkIG1haW4oKSBcXG5cIiArXG4gICAgICBcInsgXFxuXCIgK1xuICAgICAgKHNoYWRvd01hcC5fdXNlc0RlcHRoVGV4dHVyZVxuICAgICAgICA/IFwiICAgIGZsb2F0IHNoYWRvdyA9IHRleHR1cmUyRChzaGFkb3dNYXBfdGV4dHVyZSwgdl90ZXh0dXJlQ29vcmRpbmF0ZXMpLnI7IFxcblwiXG4gICAgICAgIDogXCIgICAgZmxvYXQgc2hhZG93ID0gY3ptX3VucGFja0RlcHRoKHRleHR1cmUyRChzaGFkb3dNYXBfdGV4dHVyZSwgdl90ZXh0dXJlQ29vcmRpbmF0ZXMpKTsgXFxuXCIpICtcbiAgICAgIFwiICAgIGdsX0ZyYWdDb2xvciA9IHZlYzQodmVjMyhzaGFkb3cpLCAxLjApOyBcXG5cIiArXG4gICAgICBcIn0gXFxuXCI7XG4gIH1cblxuICB2YXIgZHJhd0NvbW1hbmQgPSBjb250ZXh0LmNyZWF0ZVZpZXdwb3J0UXVhZENvbW1hbmQoZnMsIHtcbiAgICB1bmlmb3JtTWFwOiB7XG4gICAgICBzaGFkb3dNYXBfdGV4dHVyZTogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gc2hhZG93TWFwLl9zaGFkb3dNYXBUZXh0dXJlO1xuICAgICAgfSxcbiAgICAgIHNoYWRvd01hcF90ZXh0dXJlQ3ViZTogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gc2hhZG93TWFwLl9zaGFkb3dNYXBUZXh0dXJlO1xuICAgICAgfSxcbiAgICB9LFxuICB9KTtcbiAgZHJhd0NvbW1hbmQucGFzcyA9IFBhc3MuT1ZFUkxBWTtcbiAgcmV0dXJuIGRyYXdDb21tYW5kO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVEZWJ1Z1NoYWRvd1ZpZXdDb21tYW5kKHNoYWRvd01hcCwgZnJhbWVTdGF0ZSkge1xuICAvLyBEcmF3cyB0aGUgc2hhZG93IG1hcCBvbiB0aGUgYm90dG9tLXJpZ2h0IGNvcm5lciBvZiB0aGUgc2NyZWVuXG4gIHZhciBjb250ZXh0ID0gZnJhbWVTdGF0ZS5jb250ZXh0O1xuICB2YXIgc2NyZWVuV2lkdGggPSBmcmFtZVN0YXRlLmNvbnRleHQuZHJhd2luZ0J1ZmZlcldpZHRoO1xuICB2YXIgc2NyZWVuSGVpZ2h0ID0gZnJhbWVTdGF0ZS5jb250ZXh0LmRyYXdpbmdCdWZmZXJIZWlnaHQ7XG4gIHZhciBzaXplID0gTWF0aC5taW4oc2NyZWVuV2lkdGgsIHNjcmVlbkhlaWdodCkgKiAwLjM7XG5cbiAgdmFyIHZpZXdwb3J0ID0gc2NyYXRjaFZpZXdwb3J0O1xuICB2aWV3cG9ydC54ID0gc2NyZWVuV2lkdGggLSBzaXplO1xuICB2aWV3cG9ydC55ID0gMDtcbiAgdmlld3BvcnQud2lkdGggPSBzaXplO1xuICB2aWV3cG9ydC5oZWlnaHQgPSBzaXplO1xuXG4gIHZhciBkZWJ1Z0NvbW1hbmQgPSBzaGFkb3dNYXAuX2RlYnVnU2hhZG93Vmlld0NvbW1hbmQ7XG4gIGlmICghZGVmaW5lZChkZWJ1Z0NvbW1hbmQpKSB7XG4gICAgZGVidWdDb21tYW5kID0gY3JlYXRlRGVidWdTaGFkb3dWaWV3Q29tbWFuZChzaGFkb3dNYXAsIGNvbnRleHQpO1xuICAgIHNoYWRvd01hcC5fZGVidWdTaGFkb3dWaWV3Q29tbWFuZCA9IGRlYnVnQ29tbWFuZDtcbiAgfVxuXG4gIC8vIEdldCBhIG5ldyBSZW5kZXJTdGF0ZSBmb3IgdGhlIHVwZGF0ZWQgdmlld3BvcnQgc2l6ZVxuICBpZiAoXG4gICAgIWRlZmluZWQoZGVidWdDb21tYW5kLnJlbmRlclN0YXRlKSB8fFxuICAgICFCb3VuZGluZ1JlY3RhbmdsZS5lcXVhbHMoZGVidWdDb21tYW5kLnJlbmRlclN0YXRlLnZpZXdwb3J0LCB2aWV3cG9ydClcbiAgKSB7XG4gICAgZGVidWdDb21tYW5kLnJlbmRlclN0YXRlID0gUmVuZGVyU3RhdGUuZnJvbUNhY2hlKHtcbiAgICAgIHZpZXdwb3J0OiBCb3VuZGluZ1JlY3RhbmdsZS5jbG9uZSh2aWV3cG9ydCksXG4gICAgfSk7XG4gIH1cblxuICBmcmFtZVN0YXRlLmNvbW1hbmRMaXN0LnB1c2goc2hhZG93TWFwLl9kZWJ1Z1NoYWRvd1ZpZXdDb21tYW5kKTtcbn1cblxudmFyIGZydXN0dW1Db3JuZXJzTkRDID0gbmV3IEFycmF5KDgpO1xuZnJ1c3R1bUNvcm5lcnNORENbMF0gPSBuZXcgQ2FydGVzaWFuNCgtMS4wLCAtMS4wLCAtMS4wLCAxLjApO1xuZnJ1c3R1bUNvcm5lcnNORENbMV0gPSBuZXcgQ2FydGVzaWFuNCgxLjAsIC0xLjAsIC0xLjAsIDEuMCk7XG5mcnVzdHVtQ29ybmVyc05EQ1syXSA9IG5ldyBDYXJ0ZXNpYW40KDEuMCwgMS4wLCAtMS4wLCAxLjApO1xuZnJ1c3R1bUNvcm5lcnNORENbM10gPSBuZXcgQ2FydGVzaWFuNCgtMS4wLCAxLjAsIC0xLjAsIDEuMCk7XG5mcnVzdHVtQ29ybmVyc05EQ1s0XSA9IG5ldyBDYXJ0ZXNpYW40KC0xLjAsIC0xLjAsIDEuMCwgMS4wKTtcbmZydXN0dW1Db3JuZXJzTkRDWzVdID0gbmV3IENhcnRlc2lhbjQoMS4wLCAtMS4wLCAxLjAsIDEuMCk7XG5mcnVzdHVtQ29ybmVyc05EQ1s2XSA9IG5ldyBDYXJ0ZXNpYW40KDEuMCwgMS4wLCAxLjAsIDEuMCk7XG5mcnVzdHVtQ29ybmVyc05EQ1s3XSA9IG5ldyBDYXJ0ZXNpYW40KC0xLjAsIDEuMCwgMS4wLCAxLjApO1xuXG52YXIgc2NyYXRjaE1hdHJpeCA9IG5ldyBNYXRyaXg0KCk7XG52YXIgc2NyYXRjaEZydXN0dW1Db3JuZXJzID0gbmV3IEFycmF5KDgpO1xuZm9yICh2YXIgaSA9IDA7IGkgPCA4OyArK2kpIHtcbiAgc2NyYXRjaEZydXN0dW1Db3JuZXJzW2ldID0gbmV3IENhcnRlc2lhbjQoKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlRGVidWdQb2ludExpZ2h0KG1vZGVsTWF0cml4LCBjb2xvcikge1xuICB2YXIgYm94ID0gbmV3IEdlb21ldHJ5SW5zdGFuY2Uoe1xuICAgIGdlb21ldHJ5OiBuZXcgQm94T3V0bGluZUdlb21ldHJ5KHtcbiAgICAgIG1pbmltdW06IG5ldyBDYXJ0ZXNpYW4zKC0wLjUsIC0wLjUsIC0wLjUpLFxuICAgICAgbWF4aW11bTogbmV3IENhcnRlc2lhbjMoMC41LCAwLjUsIDAuNSksXG4gICAgfSksXG4gICAgYXR0cmlidXRlczoge1xuICAgICAgY29sb3I6IENvbG9yR2VvbWV0cnlJbnN0YW5jZUF0dHJpYnV0ZS5mcm9tQ29sb3IoY29sb3IpLFxuICAgIH0sXG4gIH0pO1xuXG4gIHZhciBzcGhlcmUgPSBuZXcgR2VvbWV0cnlJbnN0YW5jZSh7XG4gICAgZ2VvbWV0cnk6IG5ldyBTcGhlcmVPdXRsaW5lR2VvbWV0cnkoe1xuICAgICAgcmFkaXVzOiAwLjUsXG4gICAgfSksXG4gICAgYXR0cmlidXRlczoge1xuICAgICAgY29sb3I6IENvbG9yR2VvbWV0cnlJbnN0YW5jZUF0dHJpYnV0ZS5mcm9tQ29sb3IoY29sb3IpLFxuICAgIH0sXG4gIH0pO1xuXG4gIHJldHVybiBuZXcgUHJpbWl0aXZlKHtcbiAgICBnZW9tZXRyeUluc3RhbmNlczogW2JveCwgc3BoZXJlXSxcbiAgICBhcHBlYXJhbmNlOiBuZXcgUGVySW5zdGFuY2VDb2xvckFwcGVhcmFuY2Uoe1xuICAgICAgdHJhbnNsdWNlbnQ6IGZhbHNlLFxuICAgICAgZmxhdDogdHJ1ZSxcbiAgICB9KSxcbiAgICBhc3luY2hyb25vdXM6IGZhbHNlLFxuICAgIG1vZGVsTWF0cml4OiBtb2RlbE1hdHJpeCxcbiAgfSk7XG59XG5cbnZhciBkZWJ1Z091dGxpbmVDb2xvcnMgPSBbQ29sb3IuUkVELCBDb2xvci5HUkVFTiwgQ29sb3IuQkxVRSwgQ29sb3IuTUFHRU5UQV07XG52YXIgc2NyYXRjaFNjYWxlID0gbmV3IENhcnRlc2lhbjMoKTtcblxuZnVuY3Rpb24gYXBwbHlEZWJ1Z1NldHRpbmdzKHNoYWRvd01hcCwgZnJhbWVTdGF0ZSkge1xuICB1cGRhdGVEZWJ1Z1NoYWRvd1ZpZXdDb21tYW5kKHNoYWRvd01hcCwgZnJhbWVTdGF0ZSk7XG5cbiAgdmFyIGVudGVyRnJlZXplRnJhbWUgPVxuICAgIHNoYWRvd01hcC5kZWJ1Z0ZyZWV6ZUZyYW1lICYmICFzaGFkb3dNYXAuX2RlYnVnRnJlZXplRnJhbWU7XG4gIHNoYWRvd01hcC5fZGVidWdGcmVlemVGcmFtZSA9IHNoYWRvd01hcC5kZWJ1Z0ZyZWV6ZUZyYW1lO1xuXG4gIC8vIERyYXcgc2NlbmUgY2FtZXJhIGluIGZyZWV6ZSBmcmFtZSBtb2RlXG4gIGlmIChzaGFkb3dNYXAuZGVidWdGcmVlemVGcmFtZSkge1xuICAgIGlmIChlbnRlckZyZWV6ZUZyYW1lKSB7XG4gICAgICAvLyBSZWNyZWF0ZSBkZWJ1ZyBjYW1lcmEgd2hlbiBlbnRlcmluZyBmcmVlemUgZnJhbWUgbW9kZVxuICAgICAgc2hhZG93TWFwLl9kZWJ1Z0NhbWVyYUZydXN0dW0gPVxuICAgICAgICBzaGFkb3dNYXAuX2RlYnVnQ2FtZXJhRnJ1c3R1bSAmJlxuICAgICAgICBzaGFkb3dNYXAuX2RlYnVnQ2FtZXJhRnJ1c3R1bS5kZXN0cm95KCk7XG4gICAgICBzaGFkb3dNYXAuX2RlYnVnQ2FtZXJhRnJ1c3R1bSA9IG5ldyBEZWJ1Z0NhbWVyYVByaW1pdGl2ZSh7XG4gICAgICAgIGNhbWVyYTogc2hhZG93TWFwLl9zY2VuZUNhbWVyYSxcbiAgICAgICAgY29sb3I6IENvbG9yLkNZQU4sXG4gICAgICAgIHVwZGF0ZU9uQ2hhbmdlOiBmYWxzZSxcbiAgICAgIH0pO1xuICAgIH1cbiAgICBzaGFkb3dNYXAuX2RlYnVnQ2FtZXJhRnJ1c3R1bS51cGRhdGUoZnJhbWVTdGF0ZSk7XG4gIH1cblxuICBpZiAoc2hhZG93TWFwLl9jYXNjYWRlc0VuYWJsZWQpIHtcbiAgICAvLyBEcmF3IGNhc2NhZGVzIG9ubHkgaW4gZnJlZXplIGZyYW1lIG1vZGVcbiAgICBpZiAoc2hhZG93TWFwLmRlYnVnRnJlZXplRnJhbWUpIHtcbiAgICAgIGlmIChlbnRlckZyZWV6ZUZyYW1lKSB7XG4gICAgICAgIC8vIFJlY3JlYXRlIGRlYnVnIGZydXN0dW0gd2hlbiBlbnRlcmluZyBmcmVlemUgZnJhbWUgbW9kZVxuICAgICAgICBzaGFkb3dNYXAuX2RlYnVnTGlnaHRGcnVzdHVtID1cbiAgICAgICAgICBzaGFkb3dNYXAuX2RlYnVnTGlnaHRGcnVzdHVtICYmXG4gICAgICAgICAgc2hhZG93TWFwLl9kZWJ1Z0xpZ2h0RnJ1c3R1bS5kZXN0cm95KCk7XG4gICAgICAgIHNoYWRvd01hcC5fZGVidWdMaWdodEZydXN0dW0gPSBuZXcgRGVidWdDYW1lcmFQcmltaXRpdmUoe1xuICAgICAgICAgIGNhbWVyYTogc2hhZG93TWFwLl9zaGFkb3dNYXBDYW1lcmEsXG4gICAgICAgICAgY29sb3I6IENvbG9yLllFTExPVyxcbiAgICAgICAgICB1cGRhdGVPbkNoYW5nZTogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgc2hhZG93TWFwLl9kZWJ1Z0xpZ2h0RnJ1c3R1bS51cGRhdGUoZnJhbWVTdGF0ZSk7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2hhZG93TWFwLl9udW1iZXJPZkNhc2NhZGVzOyArK2kpIHtcbiAgICAgICAgaWYgKGVudGVyRnJlZXplRnJhbWUpIHtcbiAgICAgICAgICAvLyBSZWNyZWF0ZSBkZWJ1ZyBmcnVzdHVtIHdoZW4gZW50ZXJpbmcgZnJlZXplIGZyYW1lIG1vZGVcbiAgICAgICAgICBzaGFkb3dNYXAuX2RlYnVnQ2FzY2FkZUZydXN0dW1zW2ldID1cbiAgICAgICAgICAgIHNoYWRvd01hcC5fZGVidWdDYXNjYWRlRnJ1c3R1bXNbaV0gJiZcbiAgICAgICAgICAgIHNoYWRvd01hcC5fZGVidWdDYXNjYWRlRnJ1c3R1bXNbaV0uZGVzdHJveSgpO1xuICAgICAgICAgIHNoYWRvd01hcC5fZGVidWdDYXNjYWRlRnJ1c3R1bXNbaV0gPSBuZXcgRGVidWdDYW1lcmFQcmltaXRpdmUoe1xuICAgICAgICAgICAgY2FtZXJhOiBzaGFkb3dNYXAuX3Bhc3Nlc1tpXS5jYW1lcmEsXG4gICAgICAgICAgICBjb2xvcjogZGVidWdPdXRsaW5lQ29sb3JzW2ldLFxuICAgICAgICAgICAgdXBkYXRlT25DaGFuZ2U6IGZhbHNlLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHNoYWRvd01hcC5fZGVidWdDYXNjYWRlRnJ1c3R1bXNbaV0udXBkYXRlKGZyYW1lU3RhdGUpO1xuICAgICAgfVxuICAgIH1cbiAgfSBlbHNlIGlmIChzaGFkb3dNYXAuX2lzUG9pbnRMaWdodCkge1xuICAgIGlmICghZGVmaW5lZChzaGFkb3dNYXAuX2RlYnVnTGlnaHRGcnVzdHVtKSB8fCBzaGFkb3dNYXAuX25lZWRzVXBkYXRlKSB7XG4gICAgICB2YXIgdHJhbnNsYXRpb24gPSBzaGFkb3dNYXAuX3NoYWRvd01hcENhbWVyYS5wb3NpdGlvbldDO1xuICAgICAgdmFyIHJvdGF0aW9uID0gUXVhdGVybmlvbi5JREVOVElUWTtcbiAgICAgIHZhciB1bmlmb3JtU2NhbGUgPSBzaGFkb3dNYXAuX3BvaW50TGlnaHRSYWRpdXMgKiAyLjA7XG4gICAgICB2YXIgc2NhbGUgPSBDYXJ0ZXNpYW4zLmZyb21FbGVtZW50cyhcbiAgICAgICAgdW5pZm9ybVNjYWxlLFxuICAgICAgICB1bmlmb3JtU2NhbGUsXG4gICAgICAgIHVuaWZvcm1TY2FsZSxcbiAgICAgICAgc2NyYXRjaFNjYWxlXG4gICAgICApO1xuICAgICAgdmFyIG1vZGVsTWF0cml4ID0gTWF0cml4NC5mcm9tVHJhbnNsYXRpb25RdWF0ZXJuaW9uUm90YXRpb25TY2FsZShcbiAgICAgICAgdHJhbnNsYXRpb24sXG4gICAgICAgIHJvdGF0aW9uLFxuICAgICAgICBzY2FsZSxcbiAgICAgICAgc2NyYXRjaE1hdHJpeFxuICAgICAgKTtcblxuICAgICAgc2hhZG93TWFwLl9kZWJ1Z0xpZ2h0RnJ1c3R1bSA9XG4gICAgICAgIHNoYWRvd01hcC5fZGVidWdMaWdodEZydXN0dW0gJiYgc2hhZG93TWFwLl9kZWJ1Z0xpZ2h0RnJ1c3R1bS5kZXN0cm95KCk7XG4gICAgICBzaGFkb3dNYXAuX2RlYnVnTGlnaHRGcnVzdHVtID0gY3JlYXRlRGVidWdQb2ludExpZ2h0KFxuICAgICAgICBtb2RlbE1hdHJpeCxcbiAgICAgICAgQ29sb3IuWUVMTE9XXG4gICAgICApO1xuICAgIH1cbiAgICBzaGFkb3dNYXAuX2RlYnVnTGlnaHRGcnVzdHVtLnVwZGF0ZShmcmFtZVN0YXRlKTtcbiAgfSBlbHNlIHtcbiAgICBpZiAoIWRlZmluZWQoc2hhZG93TWFwLl9kZWJ1Z0xpZ2h0RnJ1c3R1bSkgfHwgc2hhZG93TWFwLl9uZWVkc1VwZGF0ZSkge1xuICAgICAgc2hhZG93TWFwLl9kZWJ1Z0xpZ2h0RnJ1c3R1bSA9IG5ldyBEZWJ1Z0NhbWVyYVByaW1pdGl2ZSh7XG4gICAgICAgIGNhbWVyYTogc2hhZG93TWFwLl9zaGFkb3dNYXBDYW1lcmEsXG4gICAgICAgIGNvbG9yOiBDb2xvci5ZRUxMT1csXG4gICAgICAgIHVwZGF0ZU9uQ2hhbmdlOiBmYWxzZSxcbiAgICAgIH0pO1xuICAgIH1cbiAgICBzaGFkb3dNYXAuX2RlYnVnTGlnaHRGcnVzdHVtLnVwZGF0ZShmcmFtZVN0YXRlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBTaGFkb3dNYXBDYW1lcmEoKSB7XG4gIHRoaXMudmlld01hdHJpeCA9IG5ldyBNYXRyaXg0KCk7XG4gIHRoaXMuaW52ZXJzZVZpZXdNYXRyaXggPSBuZXcgTWF0cml4NCgpO1xuICB0aGlzLmZydXN0dW0gPSB1bmRlZmluZWQ7XG4gIHRoaXMucG9zaXRpb25DYXJ0b2dyYXBoaWMgPSBuZXcgQ2FydG9ncmFwaGljKCk7XG4gIHRoaXMucG9zaXRpb25XQyA9IG5ldyBDYXJ0ZXNpYW4zKCk7XG4gIHRoaXMuZGlyZWN0aW9uV0MgPSBDYXJ0ZXNpYW4zLmNsb25lKENhcnRlc2lhbjMuVU5JVF9aKTtcbiAgdGhpcy51cFdDID0gQ2FydGVzaWFuMy5jbG9uZShDYXJ0ZXNpYW4zLlVOSVRfWSk7XG4gIHRoaXMucmlnaHRXQyA9IENhcnRlc2lhbjMuY2xvbmUoQ2FydGVzaWFuMy5VTklUX1gpO1xuICB0aGlzLnZpZXdQcm9qZWN0aW9uTWF0cml4ID0gbmV3IE1hdHJpeDQoKTtcbn1cblxuU2hhZG93TWFwQ2FtZXJhLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uIChjYW1lcmEpIHtcbiAgTWF0cml4NC5jbG9uZShjYW1lcmEudmlld01hdHJpeCwgdGhpcy52aWV3TWF0cml4KTtcbiAgTWF0cml4NC5jbG9uZShjYW1lcmEuaW52ZXJzZVZpZXdNYXRyaXgsIHRoaXMuaW52ZXJzZVZpZXdNYXRyaXgpO1xuICB0aGlzLmZydXN0dW0gPSBjYW1lcmEuZnJ1c3R1bS5jbG9uZSh0aGlzLmZydXN0dW0pO1xuICBDYXJ0b2dyYXBoaWMuY2xvbmUoY2FtZXJhLnBvc2l0aW9uQ2FydG9ncmFwaGljLCB0aGlzLnBvc2l0aW9uQ2FydG9ncmFwaGljKTtcbiAgQ2FydGVzaWFuMy5jbG9uZShjYW1lcmEucG9zaXRpb25XQywgdGhpcy5wb3NpdGlvbldDKTtcbiAgQ2FydGVzaWFuMy5jbG9uZShjYW1lcmEuZGlyZWN0aW9uV0MsIHRoaXMuZGlyZWN0aW9uV0MpO1xuICBDYXJ0ZXNpYW4zLmNsb25lKGNhbWVyYS51cFdDLCB0aGlzLnVwV0MpO1xuICBDYXJ0ZXNpYW4zLmNsb25lKGNhbWVyYS5yaWdodFdDLCB0aGlzLnJpZ2h0V0MpO1xufTtcblxuLy8gQ29udmVydHMgZnJvbSBOREMgc3BhY2UgdG8gdGV4dHVyZSBzcGFjZVxudmFyIHNjYWxlQmlhc01hdHJpeCA9IG5ldyBNYXRyaXg0KFxuICAwLjUsXG4gIDAuMCxcbiAgMC4wLFxuICAwLjUsXG4gIDAuMCxcbiAgMC41LFxuICAwLjAsXG4gIDAuNSxcbiAgMC4wLFxuICAwLjAsXG4gIDAuNSxcbiAgMC41LFxuICAwLjAsXG4gIDAuMCxcbiAgMC4wLFxuICAxLjBcbik7XG5cblNoYWRvd01hcENhbWVyYS5wcm90b3R5cGUuZ2V0Vmlld1Byb2plY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gIHZhciB2aWV3ID0gdGhpcy52aWV3TWF0cml4O1xuICB2YXIgcHJvamVjdGlvbiA9IHRoaXMuZnJ1c3R1bS5wcm9qZWN0aW9uTWF0cml4O1xuICBNYXRyaXg0Lm11bHRpcGx5KHByb2plY3Rpb24sIHZpZXcsIHRoaXMudmlld1Byb2plY3Rpb25NYXRyaXgpO1xuICBNYXRyaXg0Lm11bHRpcGx5KFxuICAgIHNjYWxlQmlhc01hdHJpeCxcbiAgICB0aGlzLnZpZXdQcm9qZWN0aW9uTWF0cml4LFxuICAgIHRoaXMudmlld1Byb2plY3Rpb25NYXRyaXhcbiAgKTtcbiAgcmV0dXJuIHRoaXMudmlld1Byb2plY3Rpb25NYXRyaXg7XG59O1xuXG52YXIgc2NyYXRjaFNwbGl0cyA9IG5ldyBBcnJheSg1KTtcbnZhciBzY3JhdGNoRnJ1c3R1bSA9IG5ldyBQZXJzcGVjdGl2ZUZydXN0dW0oKTtcbnZhciBzY3JhdGNoQ2FzY2FkZURpc3RhbmNlcyA9IG5ldyBBcnJheSg0KTtcbnZhciBzY3JhdGNoTWluID0gbmV3IENhcnRlc2lhbjMoKTtcbnZhciBzY3JhdGNoTWF4ID0gbmV3IENhcnRlc2lhbjMoKTtcblxuZnVuY3Rpb24gY29tcHV0ZUNhc2NhZGVzKHNoYWRvd01hcCwgZnJhbWVTdGF0ZSkge1xuICB2YXIgc2hhZG93TWFwQ2FtZXJhID0gc2hhZG93TWFwLl9zaGFkb3dNYXBDYW1lcmE7XG4gIHZhciBzY2VuZUNhbWVyYSA9IHNoYWRvd01hcC5fc2NlbmVDYW1lcmE7XG4gIHZhciBjYW1lcmFOZWFyID0gc2NlbmVDYW1lcmEuZnJ1c3R1bS5uZWFyO1xuICB2YXIgY2FtZXJhRmFyID0gc2NlbmVDYW1lcmEuZnJ1c3R1bS5mYXI7XG4gIHZhciBudW1iZXJPZkNhc2NhZGVzID0gc2hhZG93TWFwLl9udW1iZXJPZkNhc2NhZGVzO1xuXG4gIC8vIFNwbGl0IGNhc2NhZGVzLiBVc2UgYSBtaXggb2YgbGluZWFyIGFuZCBsb2cgc3BsaXRzLlxuICB2YXIgaTtcbiAgdmFyIHJhbmdlID0gY2FtZXJhRmFyIC0gY2FtZXJhTmVhcjtcbiAgdmFyIHJhdGlvID0gY2FtZXJhRmFyIC8gY2FtZXJhTmVhcjtcblxuICB2YXIgbGFtYmRhID0gMC45O1xuICB2YXIgY2xhbXBDYXNjYWRlRGlzdGFuY2VzID0gZmFsc2U7XG5cbiAgLy8gV2hlbiB0aGUgY2FtZXJhIGlzIGNsb3NlIHRvIGEgcmVsYXRpdmVseSBzbWFsbCBtb2RlbCwgcHJvdmlkZSBtb3JlIGRldGFpbCBpbiB0aGUgY2xvc2VyIGNhc2NhZGVzLlxuICAvLyBJZiB0aGUgY2FtZXJhIGlzIG5lYXIgb3IgaW5zaWRlIGEgbGFyZ2UgbW9kZWwsIHN1Y2ggYXMgdGhlIHJvb3QgdGlsZSBvZiBhIGNpdHksIHRoZW4gdXNlIHRoZSBkZWZhdWx0IHZhbHVlcy5cbiAgLy8gVG8gZ2V0IHRoZSBtb3N0IGFjY3VyYXRlIGNhc2NhZGUgc3BsaXRzIHdlIHdvdWxkIG5lZWQgdG8gZmluZCB0aGUgbWluIGFuZCBtYXggdmFsdWVzIGZyb20gdGhlIGRlcHRoIHRleHR1cmUuXG4gIGlmIChmcmFtZVN0YXRlLnNoYWRvd1N0YXRlLmNsb3Nlc3RPYmplY3RTaXplIDwgMjAwLjApIHtcbiAgICBjbGFtcENhc2NhZGVEaXN0YW5jZXMgPSB0cnVlO1xuICAgIGxhbWJkYSA9IDAuOTtcbiAgfVxuXG4gIHZhciBjYXNjYWRlRGlzdGFuY2VzID0gc2NyYXRjaENhc2NhZGVEaXN0YW5jZXM7XG4gIHZhciBzcGxpdHMgPSBzY3JhdGNoU3BsaXRzO1xuICBzcGxpdHNbMF0gPSBjYW1lcmFOZWFyO1xuICBzcGxpdHNbbnVtYmVyT2ZDYXNjYWRlc10gPSBjYW1lcmFGYXI7XG5cbiAgLy8gRmluZCBpbml0aWFsIHNwbGl0c1xuICBmb3IgKGkgPSAwOyBpIDwgbnVtYmVyT2ZDYXNjYWRlczsgKytpKSB7XG4gICAgdmFyIHAgPSAoaSArIDEpIC8gbnVtYmVyT2ZDYXNjYWRlcztcbiAgICB2YXIgbG9nU2NhbGUgPSBjYW1lcmFOZWFyICogTWF0aC5wb3cocmF0aW8sIHApO1xuICAgIHZhciB1bmlmb3JtU2NhbGUgPSBjYW1lcmFOZWFyICsgcmFuZ2UgKiBwO1xuICAgIHZhciBzcGxpdCA9IENlc2l1bU1hdGgubGVycCh1bmlmb3JtU2NhbGUsIGxvZ1NjYWxlLCBsYW1iZGEpO1xuICAgIHNwbGl0c1tpICsgMV0gPSBzcGxpdDtcbiAgICBjYXNjYWRlRGlzdGFuY2VzW2ldID0gc3BsaXQgLSBzcGxpdHNbaV07XG4gIH1cblxuICBpZiAoY2xhbXBDYXNjYWRlRGlzdGFuY2VzKSB7XG4gICAgLy8gQ2xhbXAgZWFjaCBjYXNjYWRlIHRvIGl0cyBtYXhpbXVtIGRpc3RhbmNlXG4gICAgZm9yIChpID0gMDsgaSA8IG51bWJlck9mQ2FzY2FkZXM7ICsraSkge1xuICAgICAgY2FzY2FkZURpc3RhbmNlc1tpXSA9IE1hdGgubWluKFxuICAgICAgICBjYXNjYWRlRGlzdGFuY2VzW2ldLFxuICAgICAgICBzaGFkb3dNYXAuX21heGltdW1DYXNjYWRlRGlzdGFuY2VzW2ldXG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIFJlY29tcHV0ZSBzcGxpdHNcbiAgICB2YXIgZGlzdGFuY2UgPSBzcGxpdHNbMF07XG4gICAgZm9yIChpID0gMDsgaSA8IG51bWJlck9mQ2FzY2FkZXMgLSAxOyArK2kpIHtcbiAgICAgIGRpc3RhbmNlICs9IGNhc2NhZGVEaXN0YW5jZXNbaV07XG4gICAgICBzcGxpdHNbaSArIDFdID0gZGlzdGFuY2U7XG4gICAgfVxuICB9XG5cbiAgQ2FydGVzaWFuNC51bnBhY2soc3BsaXRzLCAwLCBzaGFkb3dNYXAuX2Nhc2NhZGVTcGxpdHNbMF0pO1xuICBDYXJ0ZXNpYW40LnVucGFjayhzcGxpdHMsIDEsIHNoYWRvd01hcC5fY2FzY2FkZVNwbGl0c1sxXSk7XG4gIENhcnRlc2lhbjQudW5wYWNrKGNhc2NhZGVEaXN0YW5jZXMsIDAsIHNoYWRvd01hcC5fY2FzY2FkZURpc3RhbmNlcyk7XG5cbiAgdmFyIHNoYWRvd0ZydXN0dW0gPSBzaGFkb3dNYXBDYW1lcmEuZnJ1c3R1bTtcbiAgdmFyIGxlZnQgPSBzaGFkb3dGcnVzdHVtLmxlZnQ7XG4gIHZhciByaWdodCA9IHNoYWRvd0ZydXN0dW0ucmlnaHQ7XG4gIHZhciBib3R0b20gPSBzaGFkb3dGcnVzdHVtLmJvdHRvbTtcbiAgdmFyIHRvcCA9IHNoYWRvd0ZydXN0dW0udG9wO1xuICB2YXIgbmVhciA9IHNoYWRvd0ZydXN0dW0ubmVhcjtcbiAgdmFyIGZhciA9IHNoYWRvd0ZydXN0dW0uZmFyO1xuXG4gIHZhciBwb3NpdGlvbiA9IHNoYWRvd01hcENhbWVyYS5wb3NpdGlvbldDO1xuICB2YXIgZGlyZWN0aW9uID0gc2hhZG93TWFwQ2FtZXJhLmRpcmVjdGlvbldDO1xuICB2YXIgdXAgPSBzaGFkb3dNYXBDYW1lcmEudXBXQztcblxuICB2YXIgY2FzY2FkZVN1YkZydXN0dW0gPSBzY2VuZUNhbWVyYS5mcnVzdHVtLmNsb25lKHNjcmF0Y2hGcnVzdHVtKTtcbiAgdmFyIHNoYWRvd1ZpZXdQcm9qZWN0aW9uID0gc2hhZG93TWFwQ2FtZXJhLmdldFZpZXdQcm9qZWN0aW9uKCk7XG5cbiAgZm9yIChpID0gMDsgaSA8IG51bWJlck9mQ2FzY2FkZXM7ICsraSkge1xuICAgIC8vIEZpbmQgdGhlIGJvdW5kaW5nIGJveCBvZiB0aGUgY2FtZXJhIHN1Yi1mcnVzdHVtIGluIHNoYWRvdyBtYXAgdGV4dHVyZSBzcGFjZVxuICAgIGNhc2NhZGVTdWJGcnVzdHVtLm5lYXIgPSBzcGxpdHNbaV07XG4gICAgY2FzY2FkZVN1YkZydXN0dW0uZmFyID0gc3BsaXRzW2kgKyAxXTtcbiAgICB2YXIgdmlld1Byb2plY3Rpb24gPSBNYXRyaXg0Lm11bHRpcGx5KFxuICAgICAgY2FzY2FkZVN1YkZydXN0dW0ucHJvamVjdGlvbk1hdHJpeCxcbiAgICAgIHNjZW5lQ2FtZXJhLnZpZXdNYXRyaXgsXG4gICAgICBzY3JhdGNoTWF0cml4XG4gICAgKTtcbiAgICB2YXIgaW52ZXJzZVZpZXdQcm9qZWN0aW9uID0gTWF0cml4NC5pbnZlcnNlKHZpZXdQcm9qZWN0aW9uLCBzY3JhdGNoTWF0cml4KTtcbiAgICB2YXIgc2hhZG93TWFwTWF0cml4ID0gTWF0cml4NC5tdWx0aXBseShcbiAgICAgIHNoYWRvd1ZpZXdQcm9qZWN0aW9uLFxuICAgICAgaW52ZXJzZVZpZXdQcm9qZWN0aW9uLFxuICAgICAgc2NyYXRjaE1hdHJpeFxuICAgICk7XG5cbiAgICAvLyBQcm9qZWN0IGVhY2ggY29ybmVyIGZyb20gY2FtZXJhIE5EQyBzcGFjZSB0byBzaGFkb3cgbWFwIHRleHR1cmUgc3BhY2UuIE1pbiBhbmQgbWF4IHdpbGwgYmUgZnJvbSAwIHRvIDEuXG4gICAgdmFyIG1pbiA9IENhcnRlc2lhbjMuZnJvbUVsZW1lbnRzKFxuICAgICAgTnVtYmVyLk1BWF9WQUxVRSxcbiAgICAgIE51bWJlci5NQVhfVkFMVUUsXG4gICAgICBOdW1iZXIuTUFYX1ZBTFVFLFxuICAgICAgc2NyYXRjaE1pblxuICAgICk7XG4gICAgdmFyIG1heCA9IENhcnRlc2lhbjMuZnJvbUVsZW1lbnRzKFxuICAgICAgLU51bWJlci5NQVhfVkFMVUUsXG4gICAgICAtTnVtYmVyLk1BWF9WQUxVRSxcbiAgICAgIC1OdW1iZXIuTUFYX1ZBTFVFLFxuICAgICAgc2NyYXRjaE1heFxuICAgICk7XG5cbiAgICBmb3IgKHZhciBrID0gMDsgayA8IDg7ICsraykge1xuICAgICAgdmFyIGNvcm5lciA9IENhcnRlc2lhbjQuY2xvbmUoXG4gICAgICAgIGZydXN0dW1Db3JuZXJzTkRDW2tdLFxuICAgICAgICBzY3JhdGNoRnJ1c3R1bUNvcm5lcnNba11cbiAgICAgICk7XG4gICAgICBNYXRyaXg0Lm11bHRpcGx5QnlWZWN0b3Ioc2hhZG93TWFwTWF0cml4LCBjb3JuZXIsIGNvcm5lcik7XG4gICAgICBDYXJ0ZXNpYW4zLmRpdmlkZUJ5U2NhbGFyKGNvcm5lciwgY29ybmVyLncsIGNvcm5lcik7IC8vIEhhbmRsZSB0aGUgcGVyc3BlY3RpdmUgZGl2aWRlXG4gICAgICBDYXJ0ZXNpYW4zLm1pbmltdW1CeUNvbXBvbmVudChjb3JuZXIsIG1pbiwgbWluKTtcbiAgICAgIENhcnRlc2lhbjMubWF4aW11bUJ5Q29tcG9uZW50KGNvcm5lciwgbWF4LCBtYXgpO1xuICAgIH1cblxuICAgIC8vIExpbWl0IGxpZ2h0LXNwYWNlIGNvb3JkaW5hdGVzIHRvIHRoZSBbMCwgMV0gcmFuZ2VcbiAgICBtaW4ueCA9IE1hdGgubWF4KG1pbi54LCAwLjApO1xuICAgIG1pbi55ID0gTWF0aC5tYXgobWluLnksIDAuMCk7XG4gICAgbWluLnogPSAwLjA7IC8vIEFsd2F5cyBzdGFydCBjYXNjYWRlIGZydXN0dW0gYXQgdGhlIHRvcCBvZiB0aGUgbGlnaHQgZnJ1c3R1bSB0byBjYXB0dXJlIG9iamVjdHMgaW4gdGhlIGxpZ2h0J3MgcGF0aFxuICAgIG1heC54ID0gTWF0aC5taW4obWF4LngsIDEuMCk7XG4gICAgbWF4LnkgPSBNYXRoLm1pbihtYXgueSwgMS4wKTtcbiAgICBtYXgueiA9IE1hdGgubWluKG1heC56LCAxLjApO1xuXG4gICAgdmFyIHBhc3MgPSBzaGFkb3dNYXAuX3Bhc3Nlc1tpXTtcbiAgICB2YXIgY2FzY2FkZUNhbWVyYSA9IHBhc3MuY2FtZXJhO1xuICAgIGNhc2NhZGVDYW1lcmEuY2xvbmUoc2hhZG93TWFwQ2FtZXJhKTsgLy8gUEVSRk9STUFOQ0VfSURFQSA6IGNvdWxkIGRvIGEgc2hhbGxvdyBjbG9uZSBmb3IgYWxsIHByb3BlcnRpZXMgZXhjZXB0IHRoZSBmcnVzdHVtXG5cbiAgICB2YXIgZnJ1c3R1bSA9IGNhc2NhZGVDYW1lcmEuZnJ1c3R1bTtcbiAgICBmcnVzdHVtLmxlZnQgPSBsZWZ0ICsgbWluLnggKiAocmlnaHQgLSBsZWZ0KTtcbiAgICBmcnVzdHVtLnJpZ2h0ID0gbGVmdCArIG1heC54ICogKHJpZ2h0IC0gbGVmdCk7XG4gICAgZnJ1c3R1bS5ib3R0b20gPSBib3R0b20gKyBtaW4ueSAqICh0b3AgLSBib3R0b20pO1xuICAgIGZydXN0dW0udG9wID0gYm90dG9tICsgbWF4LnkgKiAodG9wIC0gYm90dG9tKTtcbiAgICBmcnVzdHVtLm5lYXIgPSBuZWFyICsgbWluLnogKiAoZmFyIC0gbmVhcik7XG4gICAgZnJ1c3R1bS5mYXIgPSBuZWFyICsgbWF4LnogKiAoZmFyIC0gbmVhcik7XG5cbiAgICBwYXNzLmN1bGxpbmdWb2x1bWUgPSBjYXNjYWRlQ2FtZXJhLmZydXN0dW0uY29tcHV0ZUN1bGxpbmdWb2x1bWUoXG4gICAgICBwb3NpdGlvbixcbiAgICAgIGRpcmVjdGlvbixcbiAgICAgIHVwXG4gICAgKTtcblxuICAgIC8vIFRyYW5zZm9ybXMgZnJvbSBleWUgc3BhY2UgdG8gdGhlIGNhc2NhZGUncyB0ZXh0dXJlIHNwYWNlXG4gICAgdmFyIGNhc2NhZGVNYXRyaXggPSBzaGFkb3dNYXAuX2Nhc2NhZGVNYXRyaWNlc1tpXTtcbiAgICBNYXRyaXg0Lm11bHRpcGx5KFxuICAgICAgY2FzY2FkZUNhbWVyYS5nZXRWaWV3UHJvamVjdGlvbigpLFxuICAgICAgc2NlbmVDYW1lcmEuaW52ZXJzZVZpZXdNYXRyaXgsXG4gICAgICBjYXNjYWRlTWF0cml4XG4gICAgKTtcbiAgICBNYXRyaXg0Lm11bHRpcGx5KHBhc3MudGV4dHVyZU9mZnNldHMsIGNhc2NhZGVNYXRyaXgsIGNhc2NhZGVNYXRyaXgpO1xuICB9XG59XG5cbnZhciBzY3JhdGNoTGlnaHRWaWV3ID0gbmV3IE1hdHJpeDQoKTtcbnZhciBzY3JhdGNoUmlnaHQgPSBuZXcgQ2FydGVzaWFuMygpO1xudmFyIHNjcmF0Y2hVcCA9IG5ldyBDYXJ0ZXNpYW4zKCk7XG52YXIgc2NyYXRjaFRyYW5zbGF0aW9uID0gbmV3IENhcnRlc2lhbjMoKTtcblxuZnVuY3Rpb24gZml0U2hhZG93TWFwVG9TY2VuZShzaGFkb3dNYXAsIGZyYW1lU3RhdGUpIHtcbiAgdmFyIHNoYWRvd01hcENhbWVyYSA9IHNoYWRvd01hcC5fc2hhZG93TWFwQ2FtZXJhO1xuICB2YXIgc2NlbmVDYW1lcmEgPSBzaGFkb3dNYXAuX3NjZW5lQ2FtZXJhO1xuXG4gIC8vIDEuIEZpcnN0IGZpbmQgYSB0aWdodCBib3VuZGluZyBib3ggaW4gbGlnaHQgc3BhY2UgdGhhdCBjb250YWlucyB0aGUgZW50aXJlIGNhbWVyYSBmcnVzdHVtLlxuICB2YXIgdmlld1Byb2plY3Rpb24gPSBNYXRyaXg0Lm11bHRpcGx5KFxuICAgIHNjZW5lQ2FtZXJhLmZydXN0dW0ucHJvamVjdGlvbk1hdHJpeCxcbiAgICBzY2VuZUNhbWVyYS52aWV3TWF0cml4LFxuICAgIHNjcmF0Y2hNYXRyaXhcbiAgKTtcbiAgdmFyIGludmVyc2VWaWV3UHJvamVjdGlvbiA9IE1hdHJpeDQuaW52ZXJzZSh2aWV3UHJvamVjdGlvbiwgc2NyYXRjaE1hdHJpeCk7XG5cbiAgLy8gU3RhcnQgdG8gY29uc3RydWN0IHRoZSBsaWdodCB2aWV3IG1hdHJpeC4gU2V0IHRyYW5zbGF0aW9uIGxhdGVyIG9uY2UgdGhlIGJvdW5kaW5nIGJveCBpcyBmb3VuZC5cbiAgdmFyIGxpZ2h0RGlyID0gc2hhZG93TWFwQ2FtZXJhLmRpcmVjdGlvbldDO1xuICB2YXIgbGlnaHRVcCA9IHNjZW5lQ2FtZXJhLmRpcmVjdGlvbldDOyAvLyBBbGlnbiBzaGFkb3dzIHRvIHRoZSBjYW1lcmEgdmlldy5cbiAgaWYgKENhcnRlc2lhbjMuZXF1YWxzRXBzaWxvbihsaWdodERpciwgbGlnaHRVcCwgQ2VzaXVtTWF0aC5FUFNJTE9OMTApKSB7XG4gICAgbGlnaHRVcCA9IHNjZW5lQ2FtZXJhLnVwV0M7XG4gIH1cbiAgdmFyIGxpZ2h0UmlnaHQgPSBDYXJ0ZXNpYW4zLmNyb3NzKGxpZ2h0RGlyLCBsaWdodFVwLCBzY3JhdGNoUmlnaHQpO1xuICBsaWdodFVwID0gQ2FydGVzaWFuMy5jcm9zcyhsaWdodFJpZ2h0LCBsaWdodERpciwgc2NyYXRjaFVwKTsgLy8gUmVjYWxjdWxhdGUgdXAgbm93IHRoYXQgcmlnaHQgaXMgZGVyaXZlZFxuICBDYXJ0ZXNpYW4zLm5vcm1hbGl6ZShsaWdodFVwLCBsaWdodFVwKTtcbiAgQ2FydGVzaWFuMy5ub3JtYWxpemUobGlnaHRSaWdodCwgbGlnaHRSaWdodCk7XG4gIHZhciBsaWdodFBvc2l0aW9uID0gQ2FydGVzaWFuMy5mcm9tRWxlbWVudHMoXG4gICAgMC4wLFxuICAgIDAuMCxcbiAgICAwLjAsXG4gICAgc2NyYXRjaFRyYW5zbGF0aW9uXG4gICk7XG5cbiAgdmFyIGxpZ2h0VmlldyA9IE1hdHJpeDQuY29tcHV0ZVZpZXcoXG4gICAgbGlnaHRQb3NpdGlvbixcbiAgICBsaWdodERpcixcbiAgICBsaWdodFVwLFxuICAgIGxpZ2h0UmlnaHQsXG4gICAgc2NyYXRjaExpZ2h0Vmlld1xuICApO1xuICB2YXIgY2FtZXJhVG9MaWdodCA9IE1hdHJpeDQubXVsdGlwbHkoXG4gICAgbGlnaHRWaWV3LFxuICAgIGludmVyc2VWaWV3UHJvamVjdGlvbixcbiAgICBzY3JhdGNoTWF0cml4XG4gICk7XG5cbiAgLy8gUHJvamVjdCBlYWNoIGNvcm5lciBmcm9tIE5EQyBzcGFjZSB0byBsaWdodCB2aWV3IHNwYWNlLCBhbmQgY2FsY3VsYXRlIGEgbWluIGFuZCBtYXggaW4gbGlnaHQgdmlldyBzcGFjZVxuICB2YXIgbWluID0gQ2FydGVzaWFuMy5mcm9tRWxlbWVudHMoXG4gICAgTnVtYmVyLk1BWF9WQUxVRSxcbiAgICBOdW1iZXIuTUFYX1ZBTFVFLFxuICAgIE51bWJlci5NQVhfVkFMVUUsXG4gICAgc2NyYXRjaE1pblxuICApO1xuICB2YXIgbWF4ID0gQ2FydGVzaWFuMy5mcm9tRWxlbWVudHMoXG4gICAgLU51bWJlci5NQVhfVkFMVUUsXG4gICAgLU51bWJlci5NQVhfVkFMVUUsXG4gICAgLU51bWJlci5NQVhfVkFMVUUsXG4gICAgc2NyYXRjaE1heFxuICApO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgODsgKytpKSB7XG4gICAgdmFyIGNvcm5lciA9IENhcnRlc2lhbjQuY2xvbmUoXG4gICAgICBmcnVzdHVtQ29ybmVyc05EQ1tpXSxcbiAgICAgIHNjcmF0Y2hGcnVzdHVtQ29ybmVyc1tpXVxuICAgICk7XG4gICAgTWF0cml4NC5tdWx0aXBseUJ5VmVjdG9yKGNhbWVyYVRvTGlnaHQsIGNvcm5lciwgY29ybmVyKTtcbiAgICBDYXJ0ZXNpYW4zLmRpdmlkZUJ5U2NhbGFyKGNvcm5lciwgY29ybmVyLncsIGNvcm5lcik7IC8vIEhhbmRsZSB0aGUgcGVyc3BlY3RpdmUgZGl2aWRlXG4gICAgQ2FydGVzaWFuMy5taW5pbXVtQnlDb21wb25lbnQoY29ybmVyLCBtaW4sIG1pbik7XG4gICAgQ2FydGVzaWFuMy5tYXhpbXVtQnlDb21wb25lbnQoY29ybmVyLCBtYXgsIG1heCk7XG4gIH1cblxuICAvLyAyLiBTZXQgYm91bmRpbmcgYm94IGJhY2sgdG8gaW5jbHVkZSBvYmplY3RzIGluIHRoZSBsaWdodCdzIHZpZXdcbiAgbWF4LnogKz0gMTAwMC4wOyAvLyBOb3RlOiBpbiBsaWdodCBzcGFjZSwgYSBwb3NpdGl2ZSBudW1iZXIgaXMgYmVoaW5kIHRoZSBjYW1lcmFcbiAgbWluLnogLT0gMTAuMDsgLy8gRXh0ZW5kIHRoZSBzaGFkb3cgdm9sdW1lIGZvcndhcmQgc2xpZ2h0bHkgdG8gYXZvaWQgcHJvYmxlbXMgcmlnaHQgYXQgdGhlIGVkZ2VcblxuICAvLyAzLiBBZGp1c3QgbGlnaHQgdmlldyBtYXRyaXggc28gdGhhdCBpdCBpcyBjZW50ZXJlZCBvbiB0aGUgYm91bmRpbmcgdm9sdW1lXG4gIHZhciB0cmFuc2xhdGlvbiA9IHNjcmF0Y2hUcmFuc2xhdGlvbjtcbiAgdHJhbnNsYXRpb24ueCA9IC0oMC41ICogKG1pbi54ICsgbWF4LngpKTtcbiAgdHJhbnNsYXRpb24ueSA9IC0oMC41ICogKG1pbi55ICsgbWF4LnkpKTtcbiAgdHJhbnNsYXRpb24ueiA9IC1tYXguejtcblxuICB2YXIgdHJhbnNsYXRpb25NYXRyaXggPSBNYXRyaXg0LmZyb21UcmFuc2xhdGlvbih0cmFuc2xhdGlvbiwgc2NyYXRjaE1hdHJpeCk7XG4gIGxpZ2h0VmlldyA9IE1hdHJpeDQubXVsdGlwbHkodHJhbnNsYXRpb25NYXRyaXgsIGxpZ2h0VmlldywgbGlnaHRWaWV3KTtcblxuICAvLyA0LiBDcmVhdGUgYW4gb3J0aG9ncmFwaGljIGZydXN0dW0gdGhhdCBjb3ZlcnMgdGhlIGJvdW5kaW5nIGJveCBleHRlbnRzXG4gIHZhciBoYWxmV2lkdGggPSAwLjUgKiAobWF4LnggLSBtaW4ueCk7XG4gIHZhciBoYWxmSGVpZ2h0ID0gMC41ICogKG1heC55IC0gbWluLnkpO1xuICB2YXIgZGVwdGggPSBtYXgueiAtIG1pbi56O1xuXG4gIHZhciBmcnVzdHVtID0gc2hhZG93TWFwQ2FtZXJhLmZydXN0dW07XG4gIGZydXN0dW0ubGVmdCA9IC1oYWxmV2lkdGg7XG4gIGZydXN0dW0ucmlnaHQgPSBoYWxmV2lkdGg7XG4gIGZydXN0dW0uYm90dG9tID0gLWhhbGZIZWlnaHQ7XG4gIGZydXN0dW0udG9wID0gaGFsZkhlaWdodDtcbiAgZnJ1c3R1bS5uZWFyID0gMC4wMTtcbiAgZnJ1c3R1bS5mYXIgPSBkZXB0aDtcblxuICAvLyA1LiBVcGRhdGUgdGhlIHNoYWRvdyBtYXAgY2FtZXJhXG4gIE1hdHJpeDQuY2xvbmUobGlnaHRWaWV3LCBzaGFkb3dNYXBDYW1lcmEudmlld01hdHJpeCk7XG4gIE1hdHJpeDQuaW52ZXJzZShsaWdodFZpZXcsIHNoYWRvd01hcENhbWVyYS5pbnZlcnNlVmlld01hdHJpeCk7XG4gIE1hdHJpeDQuZ2V0VHJhbnNsYXRpb24oXG4gICAgc2hhZG93TWFwQ2FtZXJhLmludmVyc2VWaWV3TWF0cml4LFxuICAgIHNoYWRvd01hcENhbWVyYS5wb3NpdGlvbldDXG4gICk7XG4gIGZyYW1lU3RhdGUubWFwUHJvamVjdGlvbi5lbGxpcHNvaWQuY2FydGVzaWFuVG9DYXJ0b2dyYXBoaWMoXG4gICAgc2hhZG93TWFwQ2FtZXJhLnBvc2l0aW9uV0MsXG4gICAgc2hhZG93TWFwQ2FtZXJhLnBvc2l0aW9uQ2FydG9ncmFwaGljXG4gICk7XG4gIENhcnRlc2lhbjMuY2xvbmUobGlnaHREaXIsIHNoYWRvd01hcENhbWVyYS5kaXJlY3Rpb25XQyk7XG4gIENhcnRlc2lhbjMuY2xvbmUobGlnaHRVcCwgc2hhZG93TWFwQ2FtZXJhLnVwV0MpO1xuICBDYXJ0ZXNpYW4zLmNsb25lKGxpZ2h0UmlnaHQsIHNoYWRvd01hcENhbWVyYS5yaWdodFdDKTtcbn1cblxudmFyIGRpcmVjdGlvbnMgPSBbXG4gIG5ldyBDYXJ0ZXNpYW4zKC0xLjAsIDAuMCwgMC4wKSxcbiAgbmV3IENhcnRlc2lhbjMoMC4wLCAtMS4wLCAwLjApLFxuICBuZXcgQ2FydGVzaWFuMygwLjAsIDAuMCwgLTEuMCksXG4gIG5ldyBDYXJ0ZXNpYW4zKDEuMCwgMC4wLCAwLjApLFxuICBuZXcgQ2FydGVzaWFuMygwLjAsIDEuMCwgMC4wKSxcbiAgbmV3IENhcnRlc2lhbjMoMC4wLCAwLjAsIDEuMCksXG5dO1xuXG52YXIgdXBzID0gW1xuICBuZXcgQ2FydGVzaWFuMygwLjAsIC0xLjAsIDAuMCksXG4gIG5ldyBDYXJ0ZXNpYW4zKDAuMCwgMC4wLCAtMS4wKSxcbiAgbmV3IENhcnRlc2lhbjMoMC4wLCAtMS4wLCAwLjApLFxuICBuZXcgQ2FydGVzaWFuMygwLjAsIC0xLjAsIDAuMCksXG4gIG5ldyBDYXJ0ZXNpYW4zKDAuMCwgMC4wLCAxLjApLFxuICBuZXcgQ2FydGVzaWFuMygwLjAsIC0xLjAsIDAuMCksXG5dO1xuXG52YXIgcmlnaHRzID0gW1xuICBuZXcgQ2FydGVzaWFuMygwLjAsIDAuMCwgMS4wKSxcbiAgbmV3IENhcnRlc2lhbjMoMS4wLCAwLjAsIDAuMCksXG4gIG5ldyBDYXJ0ZXNpYW4zKC0xLjAsIDAuMCwgMC4wKSxcbiAgbmV3IENhcnRlc2lhbjMoMC4wLCAwLjAsIC0xLjApLFxuICBuZXcgQ2FydGVzaWFuMygxLjAsIDAuMCwgMC4wKSxcbiAgbmV3IENhcnRlc2lhbjMoMS4wLCAwLjAsIDAuMCksXG5dO1xuXG5mdW5jdGlvbiBjb21wdXRlT21uaWRpcmVjdGlvbmFsKHNoYWRvd01hcCwgZnJhbWVTdGF0ZSkge1xuICAvLyBBbGwgc2lkZXMgc2hhcmUgdGhlIHNhbWUgZnJ1c3R1bVxuICB2YXIgZnJ1c3R1bSA9IG5ldyBQZXJzcGVjdGl2ZUZydXN0dW0oKTtcbiAgZnJ1c3R1bS5mb3YgPSBDZXNpdW1NYXRoLlBJX09WRVJfVFdPO1xuICBmcnVzdHVtLm5lYXIgPSAxLjA7XG4gIGZydXN0dW0uZmFyID0gc2hhZG93TWFwLl9wb2ludExpZ2h0UmFkaXVzO1xuICBmcnVzdHVtLmFzcGVjdFJhdGlvID0gMS4wO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgNjsgKytpKSB7XG4gICAgdmFyIGNhbWVyYSA9IHNoYWRvd01hcC5fcGFzc2VzW2ldLmNhbWVyYTtcbiAgICBjYW1lcmEucG9zaXRpb25XQyA9IHNoYWRvd01hcC5fc2hhZG93TWFwQ2FtZXJhLnBvc2l0aW9uV0M7XG4gICAgY2FtZXJhLnBvc2l0aW9uQ2FydG9ncmFwaGljID0gZnJhbWVTdGF0ZS5tYXBQcm9qZWN0aW9uLmVsbGlwc29pZC5jYXJ0ZXNpYW5Ub0NhcnRvZ3JhcGhpYyhcbiAgICAgIGNhbWVyYS5wb3NpdGlvbldDLFxuICAgICAgY2FtZXJhLnBvc2l0aW9uQ2FydG9ncmFwaGljXG4gICAgKTtcbiAgICBjYW1lcmEuZGlyZWN0aW9uV0MgPSBkaXJlY3Rpb25zW2ldO1xuICAgIGNhbWVyYS51cFdDID0gdXBzW2ldO1xuICAgIGNhbWVyYS5yaWdodFdDID0gcmlnaHRzW2ldO1xuXG4gICAgTWF0cml4NC5jb21wdXRlVmlldyhcbiAgICAgIGNhbWVyYS5wb3NpdGlvbldDLFxuICAgICAgY2FtZXJhLmRpcmVjdGlvbldDLFxuICAgICAgY2FtZXJhLnVwV0MsXG4gICAgICBjYW1lcmEucmlnaHRXQyxcbiAgICAgIGNhbWVyYS52aWV3TWF0cml4XG4gICAgKTtcbiAgICBNYXRyaXg0LmludmVyc2UoY2FtZXJhLnZpZXdNYXRyaXgsIGNhbWVyYS5pbnZlcnNlVmlld01hdHJpeCk7XG5cbiAgICBjYW1lcmEuZnJ1c3R1bSA9IGZydXN0dW07XG4gIH1cbn1cblxudmFyIHNjcmF0Y2hDYXJ0ZXNpYW4xID0gbmV3IENhcnRlc2lhbjMoKTtcbnZhciBzY3JhdGNoQ2FydGVzaWFuMiA9IG5ldyBDYXJ0ZXNpYW4zKCk7XG52YXIgc2NyYXRjaEJvdW5kaW5nU3BoZXJlID0gbmV3IEJvdW5kaW5nU3BoZXJlKCk7XG52YXIgc2NyYXRjaENlbnRlciA9IHNjcmF0Y2hCb3VuZGluZ1NwaGVyZS5jZW50ZXI7XG5cbmZ1bmN0aW9uIGNoZWNrVmlzaWJpbGl0eShzaGFkb3dNYXAsIGZyYW1lU3RhdGUpIHtcbiAgdmFyIHNjZW5lQ2FtZXJhID0gc2hhZG93TWFwLl9zY2VuZUNhbWVyYTtcbiAgdmFyIHNoYWRvd01hcENhbWVyYSA9IHNoYWRvd01hcC5fc2hhZG93TWFwQ2FtZXJhO1xuXG4gIHZhciBib3VuZGluZ1NwaGVyZSA9IHNjcmF0Y2hCb3VuZGluZ1NwaGVyZTtcblxuICAvLyBDaGVjayB3aGV0aGVyIHRoZSBzaGFkb3cgbWFwIGlzIGluIHZpZXcgYW5kIG5lZWRzIHRvIGJlIHVwZGF0ZWRcbiAgaWYgKHNoYWRvd01hcC5fY2FzY2FkZXNFbmFibGVkKSB7XG4gICAgLy8gSWYgdGhlIG5lYXJlc3Qgc2hhZG93IHJlY2VpdmVyIGlzIGZ1cnRoZXIgdGhhbiB0aGUgc2hhZG93IG1hcCdzIG1heGltdW0gZGlzdGFuY2UgdGhlbiB0aGUgc2hhZG93IG1hcCBpcyBvdXQgb2Ygdmlldy5cbiAgICBpZiAoc2NlbmVDYW1lcmEuZnJ1c3R1bS5uZWFyID49IHNoYWRvd01hcC5tYXhpbXVtRGlzdGFuY2UpIHtcbiAgICAgIHNoYWRvd01hcC5fb3V0T2ZWaWV3ID0gdHJ1ZTtcbiAgICAgIHNoYWRvd01hcC5fbmVlZHNVcGRhdGUgPSBmYWxzZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBJZiB0aGUgbGlnaHQgc291cmNlIGlzIGJlbG93IHRoZSBob3Jpem9uIHRoZW4gdGhlIHNoYWRvdyBtYXAgaXMgb3V0IG9mIHZpZXdcbiAgICB2YXIgc3VyZmFjZU5vcm1hbCA9IGZyYW1lU3RhdGUubWFwUHJvamVjdGlvbi5lbGxpcHNvaWQuZ2VvZGV0aWNTdXJmYWNlTm9ybWFsKFxuICAgICAgc2NlbmVDYW1lcmEucG9zaXRpb25XQyxcbiAgICAgIHNjcmF0Y2hDYXJ0ZXNpYW4xXG4gICAgKTtcbiAgICB2YXIgbGlnaHREaXJlY3Rpb24gPSBDYXJ0ZXNpYW4zLm5lZ2F0ZShcbiAgICAgIHNoYWRvd01hcENhbWVyYS5kaXJlY3Rpb25XQyxcbiAgICAgIHNjcmF0Y2hDYXJ0ZXNpYW4yXG4gICAgKTtcbiAgICB2YXIgZG90ID0gQ2FydGVzaWFuMy5kb3Qoc3VyZmFjZU5vcm1hbCwgbGlnaHREaXJlY3Rpb24pO1xuICAgIGlmIChzaGFkb3dNYXAuZmFkaW5nRW5hYmxlZCkge1xuICAgICAgLy8gU2hhZG93cyBzdGFydCB0byBmYWRlIG91dCBvbmNlIHRoZSBsaWdodCBnZXRzIGNsb3NlciB0byB0aGUgaG9yaXpvbi5cbiAgICAgIC8vIEF0IHRoaXMgcG9pbnQgdGhlIGdsb2JlIHVzZXMgdmVydGV4IGxpZ2h0aW5nIGFsb25lIHRvIGRhcmtlbiB0aGUgc3VyZmFjZS5cbiAgICAgIHZhciBkYXJrbmVzc0Ftb3VudCA9IENlc2l1bU1hdGguY2xhbXAoZG90IC8gMC4xLCAwLjAsIDEuMCk7XG4gICAgICBzaGFkb3dNYXAuX2RhcmtuZXNzID0gQ2VzaXVtTWF0aC5sZXJwKFxuICAgICAgICAxLjAsXG4gICAgICAgIHNoYWRvd01hcC5kYXJrbmVzcyxcbiAgICAgICAgZGFya25lc3NBbW91bnRcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNoYWRvd01hcC5fZGFya25lc3MgPSBzaGFkb3dNYXAuZGFya25lc3M7XG4gICAgfVxuXG4gICAgaWYgKGRvdCA8IDAuMCkge1xuICAgICAgc2hhZG93TWFwLl9vdXRPZlZpZXcgPSB0cnVlO1xuICAgICAgc2hhZG93TWFwLl9uZWVkc1VwZGF0ZSA9IGZhbHNlO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEJ5IGRlZmF1bHQgY2FzY2FkZWQgc2hhZG93cyBuZWVkIHRvIHVwZGF0ZSBhbmQgYXJlIGFsd2F5cyBpbiB2aWV3XG4gICAgc2hhZG93TWFwLl9uZWVkc1VwZGF0ZSA9IHRydWU7XG4gICAgc2hhZG93TWFwLl9vdXRPZlZpZXcgPSBmYWxzZTtcbiAgfSBlbHNlIGlmIChzaGFkb3dNYXAuX2lzUG9pbnRMaWdodCkge1xuICAgIC8vIFNwaGVyZS1mcnVzdHVtIGludGVyc2VjdGlvbiB0ZXN0XG4gICAgYm91bmRpbmdTcGhlcmUuY2VudGVyID0gc2hhZG93TWFwQ2FtZXJhLnBvc2l0aW9uV0M7XG4gICAgYm91bmRpbmdTcGhlcmUucmFkaXVzID0gc2hhZG93TWFwLl9wb2ludExpZ2h0UmFkaXVzO1xuICAgIHNoYWRvd01hcC5fb3V0T2ZWaWV3ID1cbiAgICAgIGZyYW1lU3RhdGUuY3VsbGluZ1ZvbHVtZS5jb21wdXRlVmlzaWJpbGl0eShib3VuZGluZ1NwaGVyZSkgPT09XG4gICAgICBJbnRlcnNlY3QuT1VUU0lERTtcbiAgICBzaGFkb3dNYXAuX25lZWRzVXBkYXRlID1cbiAgICAgICFzaGFkb3dNYXAuX291dE9mVmlldyAmJlxuICAgICAgIXNoYWRvd01hcC5fYm91bmRpbmdTcGhlcmUuZXF1YWxzKGJvdW5kaW5nU3BoZXJlKTtcbiAgICBCb3VuZGluZ1NwaGVyZS5jbG9uZShib3VuZGluZ1NwaGVyZSwgc2hhZG93TWFwLl9ib3VuZGluZ1NwaGVyZSk7XG4gIH0gZWxzZSB7XG4gICAgLy8gU2ltcGxpZnkgZnJ1c3R1bS1mcnVzdHVtIGludGVyc2VjdGlvbiB0ZXN0IGFzIGEgc3BoZXJlLWZydXN0dW0gdGVzdFxuICAgIHZhciBmcnVzdHVtUmFkaXVzID0gc2hhZG93TWFwQ2FtZXJhLmZydXN0dW0uZmFyIC8gMi4wO1xuICAgIHZhciBmcnVzdHVtQ2VudGVyID0gQ2FydGVzaWFuMy5hZGQoXG4gICAgICBzaGFkb3dNYXBDYW1lcmEucG9zaXRpb25XQyxcbiAgICAgIENhcnRlc2lhbjMubXVsdGlwbHlCeVNjYWxhcihcbiAgICAgICAgc2hhZG93TWFwQ2FtZXJhLmRpcmVjdGlvbldDLFxuICAgICAgICBmcnVzdHVtUmFkaXVzLFxuICAgICAgICBzY3JhdGNoQ2VudGVyXG4gICAgICApLFxuICAgICAgc2NyYXRjaENlbnRlclxuICAgICk7XG4gICAgYm91bmRpbmdTcGhlcmUuY2VudGVyID0gZnJ1c3R1bUNlbnRlcjtcbiAgICBib3VuZGluZ1NwaGVyZS5yYWRpdXMgPSBmcnVzdHVtUmFkaXVzO1xuICAgIHNoYWRvd01hcC5fb3V0T2ZWaWV3ID1cbiAgICAgIGZyYW1lU3RhdGUuY3VsbGluZ1ZvbHVtZS5jb21wdXRlVmlzaWJpbGl0eShib3VuZGluZ1NwaGVyZSkgPT09XG4gICAgICBJbnRlcnNlY3QuT1VUU0lERTtcbiAgICBzaGFkb3dNYXAuX25lZWRzVXBkYXRlID1cbiAgICAgICFzaGFkb3dNYXAuX291dE9mVmlldyAmJlxuICAgICAgIXNoYWRvd01hcC5fYm91bmRpbmdTcGhlcmUuZXF1YWxzKGJvdW5kaW5nU3BoZXJlKTtcbiAgICBCb3VuZGluZ1NwaGVyZS5jbG9uZShib3VuZGluZ1NwaGVyZSwgc2hhZG93TWFwLl9ib3VuZGluZ1NwaGVyZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gdXBkYXRlQ2FtZXJhcyhzaGFkb3dNYXAsIGZyYW1lU3RhdGUpIHtcbiAgdmFyIGNhbWVyYSA9IGZyYW1lU3RhdGUuY2FtZXJhOyAvLyBUaGUgYWN0dWFsIGNhbWVyYSBpbiB0aGUgc2NlbmVcbiAgdmFyIGxpZ2h0Q2FtZXJhID0gc2hhZG93TWFwLl9saWdodENhbWVyYTsgLy8gVGhlIGV4dGVybmFsIGNhbWVyYSByZXByZXNlbnRpbmcgdGhlIGxpZ2h0IHNvdXJjZVxuICB2YXIgc2NlbmVDYW1lcmEgPSBzaGFkb3dNYXAuX3NjZW5lQ2FtZXJhOyAvLyBDbG9uZSBvZiBjYW1lcmEsIHdpdGggY2xhbXBlZCBuZWFyIGFuZCBmYXIgcGxhbmVzXG4gIHZhciBzaGFkb3dNYXBDYW1lcmEgPSBzaGFkb3dNYXAuX3NoYWRvd01hcENhbWVyYTsgLy8gQ2FtZXJhIHJlcHJlc2VudGluZyB0aGUgc2hhZG93IHZvbHVtZSwgaW5pdGlhbGx5IGNsb25lZCBmcm9tIGxpZ2h0Q2FtZXJhXG5cbiAgLy8gQ2xvbmUgbGlnaHQgY2FtZXJhIGludG8gdGhlIHNoYWRvdyBtYXAgY2FtZXJhXG4gIGlmIChzaGFkb3dNYXAuX2Nhc2NhZGVzRW5hYmxlZCkge1xuICAgIENhcnRlc2lhbjMuY2xvbmUobGlnaHRDYW1lcmEuZGlyZWN0aW9uV0MsIHNoYWRvd01hcENhbWVyYS5kaXJlY3Rpb25XQyk7XG4gIH0gZWxzZSBpZiAoc2hhZG93TWFwLl9pc1BvaW50TGlnaHQpIHtcbiAgICBDYXJ0ZXNpYW4zLmNsb25lKGxpZ2h0Q2FtZXJhLnBvc2l0aW9uV0MsIHNoYWRvd01hcENhbWVyYS5wb3NpdGlvbldDKTtcbiAgfSBlbHNlIHtcbiAgICBzaGFkb3dNYXBDYW1lcmEuY2xvbmUobGlnaHRDYW1lcmEpO1xuICB9XG5cbiAgLy8gR2V0IHRoZSBsaWdodCBkaXJlY3Rpb24gaW4gZXllIGNvb3JkaW5hdGVzXG4gIHZhciBsaWdodERpcmVjdGlvbiA9IHNoYWRvd01hcC5fbGlnaHREaXJlY3Rpb25FQztcbiAgTWF0cml4NC5tdWx0aXBseUJ5UG9pbnRBc1ZlY3RvcihcbiAgICBjYW1lcmEudmlld01hdHJpeCxcbiAgICBzaGFkb3dNYXBDYW1lcmEuZGlyZWN0aW9uV0MsXG4gICAgbGlnaHREaXJlY3Rpb25cbiAgKTtcbiAgQ2FydGVzaWFuMy5ub3JtYWxpemUobGlnaHREaXJlY3Rpb24sIGxpZ2h0RGlyZWN0aW9uKTtcbiAgQ2FydGVzaWFuMy5uZWdhdGUobGlnaHREaXJlY3Rpb24sIGxpZ2h0RGlyZWN0aW9uKTtcblxuICAvLyBHZXQgdGhlIGxpZ2h0IHBvc2l0aW9uIGluIGV5ZSBjb29yZGluYXRlc1xuICBNYXRyaXg0Lm11bHRpcGx5QnlQb2ludChcbiAgICBjYW1lcmEudmlld01hdHJpeCxcbiAgICBzaGFkb3dNYXBDYW1lcmEucG9zaXRpb25XQyxcbiAgICBzaGFkb3dNYXAuX2xpZ2h0UG9zaXRpb25FQ1xuICApO1xuICBzaGFkb3dNYXAuX2xpZ2h0UG9zaXRpb25FQy53ID0gc2hhZG93TWFwLl9wb2ludExpZ2h0UmFkaXVzO1xuXG4gIC8vIEdldCB0aGUgbmVhciBhbmQgZmFyIG9mIHRoZSBzY2VuZSBjYW1lcmFcbiAgdmFyIG5lYXI7XG4gIHZhciBmYXI7XG4gIGlmIChzaGFkb3dNYXAuX2ZpdE5lYXJGYXIpIHtcbiAgICAvLyBzaGFkb3dGYXIgY2FuIGJlIHZlcnkgbGFyZ2UsIHNvIGxpbWl0IHRvIHNoYWRvd01hcC5tYXhpbXVtRGlzdGFuY2VcbiAgICAvLyBQdXNoIHRoZSBmYXIgcGxhbmUgc2xpZ2h0bHkgZnVydGhlciB0aGFuIHRoZSBuZWFyIHBsYW5lIHRvIGF2b2lkIGRlZ2VuZXJhdGUgZnJ1c3R1bVxuICAgIG5lYXIgPSBNYXRoLm1pbihcbiAgICAgIGZyYW1lU3RhdGUuc2hhZG93U3RhdGUubmVhclBsYW5lLFxuICAgICAgc2hhZG93TWFwLm1heGltdW1EaXN0YW5jZVxuICAgICk7XG4gICAgZmFyID0gTWF0aC5taW4oZnJhbWVTdGF0ZS5zaGFkb3dTdGF0ZS5mYXJQbGFuZSwgc2hhZG93TWFwLm1heGltdW1EaXN0YW5jZSk7XG4gICAgZmFyID0gTWF0aC5tYXgoZmFyLCBuZWFyICsgMS4wKTtcbiAgfSBlbHNlIHtcbiAgICBuZWFyID0gY2FtZXJhLmZydXN0dW0ubmVhcjtcbiAgICBmYXIgPSBzaGFkb3dNYXAubWF4aW11bURpc3RhbmNlO1xuICB9XG5cbiAgc2hhZG93TWFwLl9zY2VuZUNhbWVyYSA9IENhbWVyYS5jbG9uZShjYW1lcmEsIHNjZW5lQ2FtZXJhKTtcbiAgY2FtZXJhLmZydXN0dW0uY2xvbmUoc2hhZG93TWFwLl9zY2VuZUNhbWVyYS5mcnVzdHVtKTtcbiAgc2hhZG93TWFwLl9zY2VuZUNhbWVyYS5mcnVzdHVtLm5lYXIgPSBuZWFyO1xuICBzaGFkb3dNYXAuX3NjZW5lQ2FtZXJhLmZydXN0dW0uZmFyID0gZmFyO1xuICBzaGFkb3dNYXAuX2Rpc3RhbmNlID0gZmFyIC0gbmVhcjtcblxuICBjaGVja1Zpc2liaWxpdHkoc2hhZG93TWFwLCBmcmFtZVN0YXRlKTtcblxuICBpZiAoIXNoYWRvd01hcC5fb3V0T2ZWaWV3UHJldmlvdXMgJiYgc2hhZG93TWFwLl9vdXRPZlZpZXcpIHtcbiAgICBzaGFkb3dNYXAuX25lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgfVxuICBzaGFkb3dNYXAuX291dE9mVmlld1ByZXZpb3VzID0gc2hhZG93TWFwLl9vdXRPZlZpZXc7XG59XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuU2hhZG93TWFwLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoZnJhbWVTdGF0ZSkge1xuICB1cGRhdGVDYW1lcmFzKHRoaXMsIGZyYW1lU3RhdGUpO1xuXG4gIGlmICh0aGlzLl9uZWVkc1VwZGF0ZSkge1xuICAgIHVwZGF0ZUZyYW1lYnVmZmVyKHRoaXMsIGZyYW1lU3RhdGUuY29udGV4dCk7XG5cbiAgICBpZiAodGhpcy5faXNQb2ludExpZ2h0KSB7XG4gICAgICBjb21wdXRlT21uaWRpcmVjdGlvbmFsKHRoaXMsIGZyYW1lU3RhdGUpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9jYXNjYWRlc0VuYWJsZWQpIHtcbiAgICAgIGZpdFNoYWRvd01hcFRvU2NlbmUodGhpcywgZnJhbWVTdGF0ZSk7XG5cbiAgICAgIGlmICh0aGlzLl9udW1iZXJPZkNhc2NhZGVzID4gMSkge1xuICAgICAgICBjb21wdXRlQ2FzY2FkZXModGhpcywgZnJhbWVTdGF0ZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLl9pc1BvaW50TGlnaHQpIHtcbiAgICAgIC8vIENvbXB1dGUgdGhlIGN1bGxpbmcgdm9sdW1lXG4gICAgICB2YXIgc2hhZG93TWFwQ2FtZXJhID0gdGhpcy5fc2hhZG93TWFwQ2FtZXJhO1xuICAgICAgdmFyIHBvc2l0aW9uID0gc2hhZG93TWFwQ2FtZXJhLnBvc2l0aW9uV0M7XG4gICAgICB2YXIgZGlyZWN0aW9uID0gc2hhZG93TWFwQ2FtZXJhLmRpcmVjdGlvbldDO1xuICAgICAgdmFyIHVwID0gc2hhZG93TWFwQ2FtZXJhLnVwV0M7XG4gICAgICB0aGlzLl9zaGFkb3dNYXBDdWxsaW5nVm9sdW1lID0gc2hhZG93TWFwQ2FtZXJhLmZydXN0dW0uY29tcHV0ZUN1bGxpbmdWb2x1bWUoXG4gICAgICAgIHBvc2l0aW9uLFxuICAgICAgICBkaXJlY3Rpb24sXG4gICAgICAgIHVwXG4gICAgICApO1xuXG4gICAgICBpZiAodGhpcy5fcGFzc2VzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAvLyBTaW5jZSB0aGVyZSBpcyBvbmx5IG9uZSBwYXNzLCB1c2UgdGhlIHNoYWRvdyBtYXAgY2FtZXJhIGFzIHRoZSBwYXNzIGNhbWVyYS5cbiAgICAgICAgdGhpcy5fcGFzc2VzWzBdLmNhbWVyYS5jbG9uZShzaGFkb3dNYXBDYW1lcmEpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zaGFkb3dNYXBDdWxsaW5nVm9sdW1lID0gQ3VsbGluZ1ZvbHVtZS5mcm9tQm91bmRpbmdTcGhlcmUoXG4gICAgICAgIHRoaXMuX2JvdW5kaW5nU3BoZXJlXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIGlmICh0aGlzLl9wYXNzZXMubGVuZ3RoID09PSAxKSB7XG4gICAgLy8gVHJhbnNmb3JtcyBmcm9tIGV5ZSBzcGFjZSB0byBzaGFkb3cgdGV4dHVyZSBzcGFjZS5cbiAgICAvLyBBbHdheXMgcmVxdWlyZXMgYW4gdXBkYXRlIHNpbmNlIHRoZSBzY2VuZSBjYW1lcmEgY29uc3RhbnRseSBjaGFuZ2VzLlxuICAgIHZhciBpbnZlcnNlVmlldyA9IHRoaXMuX3NjZW5lQ2FtZXJhLmludmVyc2VWaWV3TWF0cml4O1xuICAgIE1hdHJpeDQubXVsdGlwbHkoXG4gICAgICB0aGlzLl9zaGFkb3dNYXBDYW1lcmEuZ2V0Vmlld1Byb2plY3Rpb24oKSxcbiAgICAgIGludmVyc2VWaWV3LFxuICAgICAgdGhpcy5fc2hhZG93TWFwTWF0cml4XG4gICAgKTtcbiAgfVxuXG4gIGlmICh0aGlzLmRlYnVnU2hvdykge1xuICAgIGFwcGx5RGVidWdTZXR0aW5ncyh0aGlzLCBmcmFtZVN0YXRlKTtcbiAgfVxufTtcblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5TaGFkb3dNYXAucHJvdG90eXBlLnVwZGF0ZVBhc3MgPSBmdW5jdGlvbiAoY29udGV4dCwgc2hhZG93UGFzcykge1xuICBjbGVhckZyYW1lYnVmZmVyKHRoaXMsIGNvbnRleHQsIHNoYWRvd1Bhc3MpO1xufTtcblxudmFyIHNjcmF0Y2hUZXhlbFN0ZXBTaXplID0gbmV3IENhcnRlc2lhbjIoKTtcblxuZnVuY3Rpb24gY29tYmluZVVuaWZvcm1zKHNoYWRvd01hcCwgdW5pZm9ybXMsIGlzVGVycmFpbikge1xuICB2YXIgYmlhcyA9IHNoYWRvd01hcC5faXNQb2ludExpZ2h0XG4gICAgPyBzaGFkb3dNYXAuX3BvaW50Qmlhc1xuICAgIDogaXNUZXJyYWluXG4gICAgPyBzaGFkb3dNYXAuX3RlcnJhaW5CaWFzXG4gICAgOiBzaGFkb3dNYXAuX3ByaW1pdGl2ZUJpYXM7XG5cbiAgdmFyIG1hcFVuaWZvcm1zID0ge1xuICAgIHNoYWRvd01hcF90ZXh0dXJlOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gc2hhZG93TWFwLl9zaGFkb3dNYXBUZXh0dXJlO1xuICAgIH0sXG4gICAgc2hhZG93TWFwX3RleHR1cmVDdWJlOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gc2hhZG93TWFwLl9zaGFkb3dNYXBUZXh0dXJlO1xuICAgIH0sXG4gICAgc2hhZG93TWFwX21hdHJpeDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHNoYWRvd01hcC5fc2hhZG93TWFwTWF0cml4O1xuICAgIH0sXG4gICAgc2hhZG93TWFwX2Nhc2NhZGVTcGxpdHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzaGFkb3dNYXAuX2Nhc2NhZGVTcGxpdHM7XG4gICAgfSxcbiAgICBzaGFkb3dNYXBfY2FzY2FkZU1hdHJpY2VzOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gc2hhZG93TWFwLl9jYXNjYWRlTWF0cmljZXM7XG4gICAgfSxcbiAgICBzaGFkb3dNYXBfbGlnaHREaXJlY3Rpb25FQzogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHNoYWRvd01hcC5fbGlnaHREaXJlY3Rpb25FQztcbiAgICB9LFxuICAgIHNoYWRvd01hcF9saWdodFBvc2l0aW9uRUM6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzaGFkb3dNYXAuX2xpZ2h0UG9zaXRpb25FQztcbiAgICB9LFxuICAgIHNoYWRvd01hcF9jYXNjYWRlRGlzdGFuY2VzOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gc2hhZG93TWFwLl9jYXNjYWRlRGlzdGFuY2VzO1xuICAgIH0sXG4gICAgc2hhZG93TWFwX3RleGVsU2l6ZURlcHRoQmlhc0FuZE5vcm1hbFNoYWRpbmdTbW9vdGg6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ZXhlbFN0ZXBTaXplID0gc2NyYXRjaFRleGVsU3RlcFNpemU7XG4gICAgICB0ZXhlbFN0ZXBTaXplLnggPSAxLjAgLyBzaGFkb3dNYXAuX3RleHR1cmVTaXplLng7XG4gICAgICB0ZXhlbFN0ZXBTaXplLnkgPSAxLjAgLyBzaGFkb3dNYXAuX3RleHR1cmVTaXplLnk7XG5cbiAgICAgIHJldHVybiBDYXJ0ZXNpYW40LmZyb21FbGVtZW50cyhcbiAgICAgICAgdGV4ZWxTdGVwU2l6ZS54LFxuICAgICAgICB0ZXhlbFN0ZXBTaXplLnksXG4gICAgICAgIGJpYXMuZGVwdGhCaWFzLFxuICAgICAgICBiaWFzLm5vcm1hbFNoYWRpbmdTbW9vdGgsXG4gICAgICAgIHRoaXMuY29tYmluZWRVbmlmb3JtczFcbiAgICAgICk7XG4gICAgfSxcbiAgICBzaGFkb3dNYXBfbm9ybWFsT2Zmc2V0U2NhbGVEaXN0YW5jZU1heERpc3RhbmNlQW5kRGFya25lc3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBDYXJ0ZXNpYW40LmZyb21FbGVtZW50cyhcbiAgICAgICAgYmlhcy5ub3JtYWxPZmZzZXRTY2FsZSxcbiAgICAgICAgc2hhZG93TWFwLl9kaXN0YW5jZSxcbiAgICAgICAgc2hhZG93TWFwLm1heGltdW1EaXN0YW5jZSxcbiAgICAgICAgc2hhZG93TWFwLl9kYXJrbmVzcyxcbiAgICAgICAgdGhpcy5jb21iaW5lZFVuaWZvcm1zMlxuICAgICAgKTtcbiAgICB9LFxuXG4gICAgY29tYmluZWRVbmlmb3JtczE6IG5ldyBDYXJ0ZXNpYW40KCksXG4gICAgY29tYmluZWRVbmlmb3JtczI6IG5ldyBDYXJ0ZXNpYW40KCksXG4gIH07XG5cbiAgcmV0dXJuIGNvbWJpbmUodW5pZm9ybXMsIG1hcFVuaWZvcm1zLCBmYWxzZSk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNhc3REZXJpdmVkQ29tbWFuZChcbiAgc2hhZG93TWFwLFxuICBzaGFkb3dzRGlydHksXG4gIGNvbW1hbmQsXG4gIGNvbnRleHQsXG4gIG9sZFNoYWRlcklkLFxuICByZXN1bHRcbikge1xuICB2YXIgY2FzdFNoYWRlcjtcbiAgdmFyIGNhc3RSZW5kZXJTdGF0ZTtcbiAgdmFyIGNhc3RVbmlmb3JtTWFwO1xuICBpZiAoZGVmaW5lZChyZXN1bHQpKSB7XG4gICAgY2FzdFNoYWRlciA9IHJlc3VsdC5zaGFkZXJQcm9ncmFtO1xuICAgIGNhc3RSZW5kZXJTdGF0ZSA9IHJlc3VsdC5yZW5kZXJTdGF0ZTtcbiAgICBjYXN0VW5pZm9ybU1hcCA9IHJlc3VsdC51bmlmb3JtTWFwO1xuICB9XG5cbiAgcmVzdWx0ID0gRHJhd0NvbW1hbmQuc2hhbGxvd0Nsb25lKGNvbW1hbmQsIHJlc3VsdCk7XG4gIHJlc3VsdC5jYXN0U2hhZG93cyA9IHRydWU7XG4gIHJlc3VsdC5yZWNlaXZlU2hhZG93cyA9IGZhbHNlO1xuXG4gIGlmIChcbiAgICAhZGVmaW5lZChjYXN0U2hhZGVyKSB8fFxuICAgIG9sZFNoYWRlcklkICE9PSBjb21tYW5kLnNoYWRlclByb2dyYW0uaWQgfHxcbiAgICBzaGFkb3dzRGlydHlcbiAgKSB7XG4gICAgdmFyIHNoYWRlclByb2dyYW0gPSBjb21tYW5kLnNoYWRlclByb2dyYW07XG5cbiAgICB2YXIgaXNUZXJyYWluID0gY29tbWFuZC5wYXNzID09PSBQYXNzLkdMT0JFO1xuICAgIHZhciBpc09wYXF1ZSA9IGNvbW1hbmQucGFzcyAhPT0gUGFzcy5UUkFOU0xVQ0VOVDtcbiAgICB2YXIgaXNQb2ludExpZ2h0ID0gc2hhZG93TWFwLl9pc1BvaW50TGlnaHQ7XG4gICAgdmFyIHVzZXNEZXB0aFRleHR1cmUgPSBzaGFkb3dNYXAuX3VzZXNEZXB0aFRleHR1cmU7XG5cbiAgICB2YXIga2V5d29yZCA9IFNoYWRvd01hcFNoYWRlci5nZXRTaGFkb3dDYXN0U2hhZGVyS2V5d29yZChcbiAgICAgIGlzUG9pbnRMaWdodCxcbiAgICAgIGlzVGVycmFpbixcbiAgICAgIHVzZXNEZXB0aFRleHR1cmUsXG4gICAgICBpc09wYXF1ZVxuICAgICk7XG4gICAgY2FzdFNoYWRlciA9IGNvbnRleHQuc2hhZGVyQ2FjaGUuZ2V0RGVyaXZlZFNoYWRlclByb2dyYW0oXG4gICAgICBzaGFkZXJQcm9ncmFtLFxuICAgICAga2V5d29yZFxuICAgICk7XG4gICAgaWYgKCFkZWZpbmVkKGNhc3RTaGFkZXIpKSB7XG4gICAgICB2YXIgdmVydGV4U2hhZGVyU291cmNlID0gc2hhZGVyUHJvZ3JhbS52ZXJ0ZXhTaGFkZXJTb3VyY2U7XG4gICAgICB2YXIgZnJhZ21lbnRTaGFkZXJTb3VyY2UgPSBzaGFkZXJQcm9ncmFtLmZyYWdtZW50U2hhZGVyU291cmNlO1xuXG4gICAgICB2YXIgY2FzdFZTID0gU2hhZG93TWFwU2hhZGVyLmNyZWF0ZVNoYWRvd0Nhc3RWZXJ0ZXhTaGFkZXIoXG4gICAgICAgIHZlcnRleFNoYWRlclNvdXJjZSxcbiAgICAgICAgaXNQb2ludExpZ2h0LFxuICAgICAgICBpc1RlcnJhaW5cbiAgICAgICk7XG4gICAgICB2YXIgY2FzdEZTID0gU2hhZG93TWFwU2hhZGVyLmNyZWF0ZVNoYWRvd0Nhc3RGcmFnbWVudFNoYWRlcihcbiAgICAgICAgZnJhZ21lbnRTaGFkZXJTb3VyY2UsXG4gICAgICAgIGlzUG9pbnRMaWdodCxcbiAgICAgICAgdXNlc0RlcHRoVGV4dHVyZSxcbiAgICAgICAgaXNPcGFxdWVcbiAgICAgICk7XG5cbiAgICAgIGNhc3RTaGFkZXIgPSBjb250ZXh0LnNoYWRlckNhY2hlLmNyZWF0ZURlcml2ZWRTaGFkZXJQcm9ncmFtKFxuICAgICAgICBzaGFkZXJQcm9ncmFtLFxuICAgICAgICBrZXl3b3JkLFxuICAgICAgICB7XG4gICAgICAgICAgdmVydGV4U2hhZGVyU291cmNlOiBjYXN0VlMsXG4gICAgICAgICAgZnJhZ21lbnRTaGFkZXJTb3VyY2U6IGNhc3RGUyxcbiAgICAgICAgICBhdHRyaWJ1dGVMb2NhdGlvbnM6IHNoYWRlclByb2dyYW0uX2F0dHJpYnV0ZUxvY2F0aW9ucyxcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjYXN0UmVuZGVyU3RhdGUgPSBzaGFkb3dNYXAuX3ByaW1pdGl2ZVJlbmRlclN0YXRlO1xuICAgIGlmIChpc1BvaW50TGlnaHQpIHtcbiAgICAgIGNhc3RSZW5kZXJTdGF0ZSA9IHNoYWRvd01hcC5fcG9pbnRSZW5kZXJTdGF0ZTtcbiAgICB9IGVsc2UgaWYgKGlzVGVycmFpbikge1xuICAgICAgY2FzdFJlbmRlclN0YXRlID0gc2hhZG93TWFwLl90ZXJyYWluUmVuZGVyU3RhdGU7XG4gICAgfVxuXG4gICAgLy8gTW9kaWZ5IHRoZSByZW5kZXIgc3RhdGUgZm9yIGNvbW1hbmRzIHRoYXQgZG8gbm90IHVzZSBiYWNrLWZhY2UgY3VsbGluZywgZS5nLiBmbGF0IHRleHR1cmVkIHdhbGxzXG4gICAgdmFyIGN1bGxFbmFibGVkID0gY29tbWFuZC5yZW5kZXJTdGF0ZS5jdWxsLmVuYWJsZWQ7XG4gICAgaWYgKCFjdWxsRW5hYmxlZCkge1xuICAgICAgY2FzdFJlbmRlclN0YXRlID0gY2xvbmUoY2FzdFJlbmRlclN0YXRlLCBmYWxzZSk7XG4gICAgICBjYXN0UmVuZGVyU3RhdGUuY3VsbCA9IGNsb25lKGNhc3RSZW5kZXJTdGF0ZS5jdWxsLCBmYWxzZSk7XG4gICAgICBjYXN0UmVuZGVyU3RhdGUuY3VsbC5lbmFibGVkID0gZmFsc2U7XG4gICAgICBjYXN0UmVuZGVyU3RhdGUgPSBSZW5kZXJTdGF0ZS5mcm9tQ2FjaGUoY2FzdFJlbmRlclN0YXRlKTtcbiAgICB9XG5cbiAgICBjYXN0VW5pZm9ybU1hcCA9IGNvbWJpbmVVbmlmb3JtcyhzaGFkb3dNYXAsIGNvbW1hbmQudW5pZm9ybU1hcCwgaXNUZXJyYWluKTtcbiAgfVxuXG4gIHJlc3VsdC5zaGFkZXJQcm9ncmFtID0gY2FzdFNoYWRlcjtcbiAgcmVzdWx0LnJlbmRlclN0YXRlID0gY2FzdFJlbmRlclN0YXRlO1xuICByZXN1bHQudW5pZm9ybU1hcCA9IGNhc3RVbmlmb3JtTWFwO1xuXG4gIHJldHVybiByZXN1bHQ7XG59XG5cblNoYWRvd01hcC5jcmVhdGVSZWNlaXZlRGVyaXZlZENvbW1hbmQgPSBmdW5jdGlvbiAoXG4gIGxpZ2h0U2hhZG93TWFwcyxcbiAgY29tbWFuZCxcbiAgc2hhZG93c0RpcnR5LFxuICBjb250ZXh0LFxuICByZXN1bHRcbikge1xuICBpZiAoIWRlZmluZWQocmVzdWx0KSkge1xuICAgIHJlc3VsdCA9IHt9O1xuICB9XG5cbiAgdmFyIGxpZ2h0U2hhZG93TWFwc0VuYWJsZWQgPSBsaWdodFNoYWRvd01hcHMubGVuZ3RoID4gMDtcbiAgdmFyIHNoYWRlclByb2dyYW0gPSBjb21tYW5kLnNoYWRlclByb2dyYW07XG4gIHZhciB2ZXJ0ZXhTaGFkZXJTb3VyY2UgPSBzaGFkZXJQcm9ncmFtLnZlcnRleFNoYWRlclNvdXJjZTtcbiAgdmFyIGZyYWdtZW50U2hhZGVyU291cmNlID0gc2hhZGVyUHJvZ3JhbS5mcmFnbWVudFNoYWRlclNvdXJjZTtcbiAgdmFyIGlzVGVycmFpbiA9IGNvbW1hbmQucGFzcyA9PT0gUGFzcy5HTE9CRTtcblxuICB2YXIgaGFzVGVycmFpbk5vcm1hbCA9IGZhbHNlO1xuICBpZiAoaXNUZXJyYWluKSB7XG4gICAgaGFzVGVycmFpbk5vcm1hbCA9XG4gICAgICBjb21tYW5kLm93bmVyLmRhdGEucmVuZGVyZWRNZXNoLmVuY29kaW5nLmhhc1ZlcnRleE5vcm1hbHM7XG4gIH1cblxuICBpZiAoY29tbWFuZC5yZWNlaXZlU2hhZG93cyAmJiBsaWdodFNoYWRvd01hcHNFbmFibGVkKSB7XG4gICAgLy8gT25seSBnZW5lcmF0ZSBhIHJlY2VpdmVDb21tYW5kIGlmIHRoZXJlIGlzIGEgc2hhZG93IG1hcCBvcmlnaW5hdGluZyBmcm9tIGEgbGlnaHQgc291cmNlLlxuICAgIHZhciByZWNlaXZlU2hhZGVyO1xuICAgIHZhciByZWNlaXZlVW5pZm9ybU1hcDtcbiAgICBpZiAoZGVmaW5lZChyZXN1bHQucmVjZWl2ZUNvbW1hbmQpKSB7XG4gICAgICByZWNlaXZlU2hhZGVyID0gcmVzdWx0LnJlY2VpdmVDb21tYW5kLnNoYWRlclByb2dyYW07XG4gICAgICByZWNlaXZlVW5pZm9ybU1hcCA9IHJlc3VsdC5yZWNlaXZlQ29tbWFuZC51bmlmb3JtTWFwO1xuICAgIH1cblxuICAgIHJlc3VsdC5yZWNlaXZlQ29tbWFuZCA9IERyYXdDb21tYW5kLnNoYWxsb3dDbG9uZShcbiAgICAgIGNvbW1hbmQsXG4gICAgICByZXN1bHQucmVjZWl2ZUNvbW1hbmRcbiAgICApO1xuICAgIHJlc3VsdC5jYXN0U2hhZG93cyA9IGZhbHNlO1xuICAgIHJlc3VsdC5yZWNlaXZlU2hhZG93cyA9IHRydWU7XG5cbiAgICAvLyBJZiBjYXN0U2hhZG93cyBjaGFuZ2VkLCByZWNvbXBpbGUgdGhlIHJlY2VpdmUgc2hhZG93cyBzaGFkZXIuIFRoZSBub3JtYWwgc2hhZGluZyB0ZWNobmlxdWUgc2ltdWxhdGVzXG4gICAgLy8gc2VsZi1zaGFkb3dpbmcgc28gaXQgc2hvdWxkIGJlIHR1cm5lZCBvZmYgaWYgY2FzdFNoYWRvd3MgaXMgZmFsc2UuXG4gICAgdmFyIGNhc3RTaGFkb3dzRGlydHkgPVxuICAgICAgcmVzdWx0LnJlY2VpdmVTaGFkZXJDYXN0U2hhZG93cyAhPT0gY29tbWFuZC5jYXN0U2hhZG93cztcbiAgICB2YXIgc2hhZGVyRGlydHkgPVxuICAgICAgcmVzdWx0LnJlY2VpdmVTaGFkZXJQcm9ncmFtSWQgIT09IGNvbW1hbmQuc2hhZGVyUHJvZ3JhbS5pZDtcblxuICAgIGlmIChcbiAgICAgICFkZWZpbmVkKHJlY2VpdmVTaGFkZXIpIHx8XG4gICAgICBzaGFkZXJEaXJ0eSB8fFxuICAgICAgc2hhZG93c0RpcnR5IHx8XG4gICAgICBjYXN0U2hhZG93c0RpcnR5XG4gICAgKSB7XG4gICAgICB2YXIga2V5d29yZCA9IFNoYWRvd01hcFNoYWRlci5nZXRTaGFkb3dSZWNlaXZlU2hhZGVyS2V5d29yZChcbiAgICAgICAgbGlnaHRTaGFkb3dNYXBzWzBdLFxuICAgICAgICBjb21tYW5kLmNhc3RTaGFkb3dzLFxuICAgICAgICBpc1RlcnJhaW4sXG4gICAgICAgIGhhc1RlcnJhaW5Ob3JtYWxcbiAgICAgICk7XG4gICAgICByZWNlaXZlU2hhZGVyID0gY29udGV4dC5zaGFkZXJDYWNoZS5nZXREZXJpdmVkU2hhZGVyUHJvZ3JhbShcbiAgICAgICAgc2hhZGVyUHJvZ3JhbSxcbiAgICAgICAga2V5d29yZFxuICAgICAgKTtcbiAgICAgIGlmICghZGVmaW5lZChyZWNlaXZlU2hhZGVyKSkge1xuICAgICAgICB2YXIgcmVjZWl2ZVZTID0gU2hhZG93TWFwU2hhZGVyLmNyZWF0ZVNoYWRvd1JlY2VpdmVWZXJ0ZXhTaGFkZXIoXG4gICAgICAgICAgdmVydGV4U2hhZGVyU291cmNlLFxuICAgICAgICAgIGlzVGVycmFpbixcbiAgICAgICAgICBoYXNUZXJyYWluTm9ybWFsXG4gICAgICAgICk7XG4gICAgICAgIHZhciByZWNlaXZlRlMgPSBTaGFkb3dNYXBTaGFkZXIuY3JlYXRlU2hhZG93UmVjZWl2ZUZyYWdtZW50U2hhZGVyKFxuICAgICAgICAgIGZyYWdtZW50U2hhZGVyU291cmNlLFxuICAgICAgICAgIGxpZ2h0U2hhZG93TWFwc1swXSxcbiAgICAgICAgICBjb21tYW5kLmNhc3RTaGFkb3dzLFxuICAgICAgICAgIGlzVGVycmFpbixcbiAgICAgICAgICBoYXNUZXJyYWluTm9ybWFsXG4gICAgICAgICk7XG5cbiAgICAgICAgcmVjZWl2ZVNoYWRlciA9IGNvbnRleHQuc2hhZGVyQ2FjaGUuY3JlYXRlRGVyaXZlZFNoYWRlclByb2dyYW0oXG4gICAgICAgICAgc2hhZGVyUHJvZ3JhbSxcbiAgICAgICAgICBrZXl3b3JkLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHZlcnRleFNoYWRlclNvdXJjZTogcmVjZWl2ZVZTLFxuICAgICAgICAgICAgZnJhZ21lbnRTaGFkZXJTb3VyY2U6IHJlY2VpdmVGUyxcbiAgICAgICAgICAgIGF0dHJpYnV0ZUxvY2F0aW9uczogc2hhZGVyUHJvZ3JhbS5fYXR0cmlidXRlTG9jYXRpb25zLFxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgcmVjZWl2ZVVuaWZvcm1NYXAgPSBjb21iaW5lVW5pZm9ybXMoXG4gICAgICAgIGxpZ2h0U2hhZG93TWFwc1swXSxcbiAgICAgICAgY29tbWFuZC51bmlmb3JtTWFwLFxuICAgICAgICBpc1RlcnJhaW5cbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmVzdWx0LnJlY2VpdmVDb21tYW5kLnNoYWRlclByb2dyYW0gPSByZWNlaXZlU2hhZGVyO1xuICAgIHJlc3VsdC5yZWNlaXZlQ29tbWFuZC51bmlmb3JtTWFwID0gcmVjZWl2ZVVuaWZvcm1NYXA7XG4gICAgcmVzdWx0LnJlY2VpdmVTaGFkZXJQcm9ncmFtSWQgPSBjb21tYW5kLnNoYWRlclByb2dyYW0uaWQ7XG4gICAgcmVzdWx0LnJlY2VpdmVTaGFkZXJDYXN0U2hhZG93cyA9IGNvbW1hbmQuY2FzdFNoYWRvd3M7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufTtcblxuU2hhZG93TWFwLmNyZWF0ZUNhc3REZXJpdmVkQ29tbWFuZCA9IGZ1bmN0aW9uIChcbiAgc2hhZG93TWFwcyxcbiAgY29tbWFuZCxcbiAgc2hhZG93c0RpcnR5LFxuICBjb250ZXh0LFxuICByZXN1bHRcbikge1xuICBpZiAoIWRlZmluZWQocmVzdWx0KSkge1xuICAgIHJlc3VsdCA9IHt9O1xuICB9XG5cbiAgaWYgKGNvbW1hbmQuY2FzdFNoYWRvd3MpIHtcbiAgICB2YXIgY2FzdENvbW1hbmRzID0gcmVzdWx0LmNhc3RDb21tYW5kcztcbiAgICBpZiAoIWRlZmluZWQoY2FzdENvbW1hbmRzKSkge1xuICAgICAgY2FzdENvbW1hbmRzID0gcmVzdWx0LmNhc3RDb21tYW5kcyA9IFtdO1xuICAgIH1cblxuICAgIHZhciBvbGRTaGFkZXJJZCA9IHJlc3VsdC5jYXN0U2hhZGVyUHJvZ3JhbUlkO1xuXG4gICAgdmFyIHNoYWRvd01hcExlbmd0aCA9IHNoYWRvd01hcHMubGVuZ3RoO1xuICAgIGNhc3RDb21tYW5kcy5sZW5ndGggPSBzaGFkb3dNYXBMZW5ndGg7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNoYWRvd01hcExlbmd0aDsgKytpKSB7XG4gICAgICBjYXN0Q29tbWFuZHNbaV0gPSBjcmVhdGVDYXN0RGVyaXZlZENvbW1hbmQoXG4gICAgICAgIHNoYWRvd01hcHNbaV0sXG4gICAgICAgIHNoYWRvd3NEaXJ0eSxcbiAgICAgICAgY29tbWFuZCxcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAgb2xkU2hhZGVySWQsXG4gICAgICAgIGNhc3RDb21tYW5kc1tpXVxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXN1bHQuY2FzdFNoYWRlclByb2dyYW1JZCA9IGNvbW1hbmQuc2hhZGVyUHJvZ3JhbS5pZDtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKi9cblNoYWRvd01hcC5wcm90b3R5cGUuaXNEZXN0cm95ZWQgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBmYWxzZTtcbn07XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuU2hhZG93TWFwLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICBkZXN0cm95RnJhbWVidWZmZXIodGhpcyk7XG5cbiAgdGhpcy5fZGVidWdMaWdodEZydXN0dW0gPVxuICAgIHRoaXMuX2RlYnVnTGlnaHRGcnVzdHVtICYmIHRoaXMuX2RlYnVnTGlnaHRGcnVzdHVtLmRlc3Ryb3koKTtcbiAgdGhpcy5fZGVidWdDYW1lcmFGcnVzdHVtID1cbiAgICB0aGlzLl9kZWJ1Z0NhbWVyYUZydXN0dW0gJiYgdGhpcy5fZGVidWdDYW1lcmFGcnVzdHVtLmRlc3Ryb3koKTtcbiAgdGhpcy5fZGVidWdTaGFkb3dWaWV3Q29tbWFuZCA9XG4gICAgdGhpcy5fZGVidWdTaGFkb3dWaWV3Q29tbWFuZCAmJlxuICAgIHRoaXMuX2RlYnVnU2hhZG93Vmlld0NvbW1hbmQuc2hhZGVyUHJvZ3JhbSAmJlxuICAgIHRoaXMuX2RlYnVnU2hhZG93Vmlld0NvbW1hbmQuc2hhZGVyUHJvZ3JhbS5kZXN0cm95KCk7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9udW1iZXJPZkNhc2NhZGVzOyArK2kpIHtcbiAgICB0aGlzLl9kZWJ1Z0Nhc2NhZGVGcnVzdHVtc1tpXSA9XG4gICAgICB0aGlzLl9kZWJ1Z0Nhc2NhZGVGcnVzdHVtc1tpXSAmJiB0aGlzLl9kZWJ1Z0Nhc2NhZGVGcnVzdHVtc1tpXS5kZXN0cm95KCk7XG4gIH1cblxuICByZXR1cm4gZGVzdHJveU9iamVjdCh0aGlzKTtcbn07XG5leHBvcnQgZGVmYXVsdCBTaGFkb3dNYXA7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///79162\n')},2143:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(82982);\n/* harmony import */ var _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(53642);\n\n\n\n/**\n * @private\n */\nfunction ShadowMapShader() {}\n\nShadowMapShader.getShadowCastShaderKeyword = function (\n  isPointLight,\n  isTerrain,\n  usesDepthTexture,\n  isOpaque\n) {\n  return (\n    "castShadow " +\n    isPointLight +\n    " " +\n    isTerrain +\n    " " +\n    usesDepthTexture +\n    " " +\n    isOpaque\n  );\n};\n\nShadowMapShader.createShadowCastVertexShader = function (\n  vs,\n  isPointLight,\n  isTerrain\n) {\n  var defines = vs.defines.slice(0);\n  var sources = vs.sources.slice(0);\n\n  defines.push("SHADOW_MAP");\n\n  if (isTerrain) {\n    defines.push("GENERATE_POSITION");\n  }\n\n  var positionVaryingName = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].findPositionVarying */ .Z.findPositionVarying(vs);\n  var hasPositionVarying = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(positionVaryingName);\n\n  if (isPointLight && !hasPositionVarying) {\n    var length = sources.length;\n    for (var j = 0; j < length; ++j) {\n      sources[j] = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].replaceMain */ .Z.replaceMain(sources[j], "czm_shadow_cast_main");\n    }\n\n    var shadowVS =\n      "varying vec3 v_positionEC; \\n" +\n      "void main() \\n" +\n      "{ \\n" +\n      "    czm_shadow_cast_main(); \\n" +\n      "    v_positionEC = (czm_inverseProjection * gl_Position).xyz; \\n" +\n      "}";\n    sources.push(shadowVS);\n  }\n\n  return new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z({\n    defines: defines,\n    sources: sources,\n  });\n};\n\nShadowMapShader.createShadowCastFragmentShader = function (\n  fs,\n  isPointLight,\n  usesDepthTexture,\n  opaque\n) {\n  var defines = fs.defines.slice(0);\n  var sources = fs.sources.slice(0);\n\n  var positionVaryingName = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].findPositionVarying */ .Z.findPositionVarying(fs);\n  var hasPositionVarying = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(positionVaryingName);\n  if (!hasPositionVarying) {\n    positionVaryingName = "v_positionEC";\n  }\n\n  var length = sources.length;\n  for (var i = 0; i < length; ++i) {\n    sources[i] = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].replaceMain */ .Z.replaceMain(sources[i], "czm_shadow_cast_main");\n  }\n\n  var fsSource = "";\n\n  if (isPointLight) {\n    if (!hasPositionVarying) {\n      fsSource += "varying vec3 v_positionEC; \\n";\n    }\n    fsSource += "uniform vec4 shadowMap_lightPositionEC; \\n";\n  }\n\n  if (opaque) {\n    fsSource += "void main() \\n" + "{ \\n";\n  } else {\n    fsSource +=\n      "void main() \\n" +\n      "{ \\n" +\n      "    czm_shadow_cast_main(); \\n" +\n      "    if (gl_FragColor.a == 0.0) \\n" +\n      "    { \\n" +\n      "       discard; \\n" +\n      "    } \\n";\n  }\n\n  if (isPointLight) {\n    fsSource +=\n      "    float distance = length(" +\n      positionVaryingName +\n      "); \\n" +\n      "    if (distance >= shadowMap_lightPositionEC.w) \\n" +\n      "    { \\n" +\n      "        discard; \\n" +\n      "    } \\n" +\n      "    distance /= shadowMap_lightPositionEC.w; // radius \\n" +\n      "    gl_FragColor = czm_packDepth(distance); \\n";\n  } else if (usesDepthTexture) {\n    fsSource += "    gl_FragColor = vec4(1.0); \\n";\n  } else {\n    fsSource += "    gl_FragColor = czm_packDepth(gl_FragCoord.z); \\n";\n  }\n\n  fsSource += "} \\n";\n\n  sources.push(fsSource);\n\n  return new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z({\n    defines: defines,\n    sources: sources,\n  });\n};\n\nShadowMapShader.getShadowReceiveShaderKeyword = function (\n  shadowMap,\n  castShadows,\n  isTerrain,\n  hasTerrainNormal\n) {\n  var usesDepthTexture = shadowMap._usesDepthTexture;\n  var polygonOffsetSupported = shadowMap._polygonOffsetSupported;\n  var isPointLight = shadowMap._isPointLight;\n  var isSpotLight = shadowMap._isSpotLight;\n  var hasCascades = shadowMap._numberOfCascades > 1;\n  var debugCascadeColors = shadowMap.debugCascadeColors;\n  var softShadows = shadowMap.softShadows;\n\n  return (\n    "receiveShadow " +\n    usesDepthTexture +\n    polygonOffsetSupported +\n    isPointLight +\n    isSpotLight +\n    hasCascades +\n    debugCascadeColors +\n    softShadows +\n    castShadows +\n    isTerrain +\n    hasTerrainNormal\n  );\n};\n\nShadowMapShader.createShadowReceiveVertexShader = function (\n  vs,\n  isTerrain,\n  hasTerrainNormal\n) {\n  var defines = vs.defines.slice(0);\n  var sources = vs.sources.slice(0);\n\n  defines.push("SHADOW_MAP");\n\n  if (isTerrain) {\n    if (hasTerrainNormal) {\n      defines.push("GENERATE_POSITION_AND_NORMAL");\n    } else {\n      defines.push("GENERATE_POSITION");\n    }\n  }\n\n  return new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z({\n    defines: defines,\n    sources: sources,\n  });\n};\n\nShadowMapShader.createShadowReceiveFragmentShader = function (\n  fs,\n  shadowMap,\n  castShadows,\n  isTerrain,\n  hasTerrainNormal\n) {\n  var normalVaryingName = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].findNormalVarying */ .Z.findNormalVarying(fs);\n  var hasNormalVarying =\n    (!isTerrain && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(normalVaryingName)) ||\n    (isTerrain && hasTerrainNormal);\n\n  var positionVaryingName = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].findPositionVarying */ .Z.findPositionVarying(fs);\n  var hasPositionVarying = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(positionVaryingName);\n\n  var usesDepthTexture = shadowMap._usesDepthTexture;\n  var polygonOffsetSupported = shadowMap._polygonOffsetSupported;\n  var isPointLight = shadowMap._isPointLight;\n  var isSpotLight = shadowMap._isSpotLight;\n  var hasCascades = shadowMap._numberOfCascades > 1;\n  var debugCascadeColors = shadowMap.debugCascadeColors;\n  var softShadows = shadowMap.softShadows;\n  var bias = isPointLight\n    ? shadowMap._pointBias\n    : isTerrain\n    ? shadowMap._terrainBias\n    : shadowMap._primitiveBias;\n\n  var defines = fs.defines.slice(0);\n  var sources = fs.sources.slice(0);\n\n  var length = sources.length;\n  for (var i = 0; i < length; ++i) {\n    sources[i] = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].replaceMain */ .Z.replaceMain(\n      sources[i],\n      "czm_shadow_receive_main"\n    );\n  }\n\n  if (isPointLight) {\n    defines.push("USE_CUBE_MAP_SHADOW");\n  } else if (usesDepthTexture) {\n    defines.push("USE_SHADOW_DEPTH_TEXTURE");\n  }\n\n  if (softShadows && !isPointLight) {\n    defines.push("USE_SOFT_SHADOWS");\n  }\n\n  // Enable day-night shading so that the globe is dark when the light is below the horizon\n  if (hasCascades && castShadows && isTerrain) {\n    if (hasNormalVarying) {\n      defines.push("ENABLE_VERTEX_LIGHTING");\n    } else {\n      defines.push("ENABLE_DAYNIGHT_SHADING");\n    }\n  }\n\n  if (castShadows && bias.normalShading && hasNormalVarying) {\n    defines.push("USE_NORMAL_SHADING");\n    if (bias.normalShadingSmooth > 0.0) {\n      defines.push("USE_NORMAL_SHADING_SMOOTH");\n    }\n  }\n\n  var fsSource = "";\n\n  if (isPointLight) {\n    fsSource += "uniform samplerCube shadowMap_textureCube; \\n";\n  } else {\n    fsSource += "uniform sampler2D shadowMap_texture; \\n";\n  }\n\n  var returnPositionEC;\n  if (hasPositionVarying) {\n    returnPositionEC = "    return vec4(" + positionVaryingName + ", 1.0); \\n";\n  } else {\n    returnPositionEC =\n      "#ifndef LOG_DEPTH \\n" +\n      "    return czm_windowToEyeCoordinates(gl_FragCoord); \\n" +\n      "#else \\n" +\n      "    return vec4(v_logPositionEC, 1.0); \\n" +\n      "#endif \\n";\n  }\n\n  fsSource +=\n    "uniform mat4 shadowMap_matrix; \\n" +\n    "uniform vec3 shadowMap_lightDirectionEC; \\n" +\n    "uniform vec4 shadowMap_lightPositionEC; \\n" +\n    "uniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness; \\n" +\n    "uniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth; \\n" +\n    "#ifdef LOG_DEPTH \\n" +\n    "varying vec3 v_logPositionEC; \\n" +\n    "#endif \\n" +\n    "vec4 getPositionEC() \\n" +\n    "{ \\n" +\n    returnPositionEC +\n    "} \\n" +\n    "vec3 getNormalEC() \\n" +\n    "{ \\n" +\n    (hasNormalVarying\n      ? "    return normalize(" + normalVaryingName + "); \\n"\n      : "    return vec3(1.0); \\n") +\n    "} \\n" +\n    // Offset the shadow position in the direction of the normal for perpendicular and back faces\n    "void applyNormalOffset(inout vec4 positionEC, vec3 normalEC, float nDotL) \\n" +\n    "{ \\n" +\n    (bias.normalOffset && hasNormalVarying\n      ? "    float normalOffset = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.x; \\n" +\n        "    float normalOffsetScale = 1.0 - nDotL; \\n" +\n        "    vec3 offset = normalOffset * normalOffsetScale * normalEC; \\n" +\n        "    positionEC.xyz += offset; \\n"\n      : "") +\n    "} \\n";\n\n  fsSource +=\n    "void main() \\n" +\n    "{ \\n" +\n    "    czm_shadow_receive_main(); \\n" +\n    "    vec4 positionEC = getPositionEC(); \\n" +\n    "    vec3 normalEC = getNormalEC(); \\n" +\n    "    float depth = -positionEC.z; \\n";\n\n  fsSource +=\n    "    czm_shadowParameters shadowParameters; \\n" +\n    "    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy; \\n" +\n    "    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z; \\n" +\n    "    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w; \\n" +\n    "    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w; \\n";\n\n  if (isTerrain) {\n    // Scale depth bias based on view distance to reduce z-fighting in distant terrain\n    fsSource += "    shadowParameters.depthBias *= max(depth * 0.01, 1.0); \\n";\n  } else if (!polygonOffsetSupported) {\n    // If polygon offset isn\'t supported push the depth back based on view, however this\n    // causes light leaking at further away views\n    fsSource +=\n      "    shadowParameters.depthBias *= mix(1.0, 100.0, depth * 0.0015); \\n";\n  }\n\n  if (isPointLight) {\n    fsSource +=\n      "    vec3 directionEC = positionEC.xyz - shadowMap_lightPositionEC.xyz; \\n" +\n      "    float distance = length(directionEC); \\n" +\n      "    directionEC = normalize(directionEC); \\n" +\n      "    float radius = shadowMap_lightPositionEC.w; \\n" +\n      "    // Stop early if the fragment is beyond the point light radius \\n" +\n      "    if (distance > radius) \\n" +\n      "    { \\n" +\n      "        return; \\n" +\n      "    } \\n" +\n      "    vec3 directionWC  = czm_inverseViewRotation * directionEC; \\n" +\n      "    shadowParameters.depth = distance / radius; \\n" +\n      "    shadowParameters.nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \\n" +\n      "    shadowParameters.texCoords = directionWC; \\n" +\n      "    float visibility = czm_shadowVisibility(shadowMap_textureCube, shadowParameters); \\n";\n  } else if (isSpotLight) {\n    fsSource +=\n      "    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz); \\n" +\n      "    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \\n" +\n      "    applyNormalOffset(positionEC, normalEC, nDotL); \\n" +\n      "    vec4 shadowPosition = shadowMap_matrix * positionEC; \\n" +\n      "    // Spot light uses a perspective projection, so perform the perspective divide \\n" +\n      "    shadowPosition /= shadowPosition.w; \\n" +\n      "    // Stop early if the fragment is not in the shadow bounds \\n" +\n      "    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \\n" +\n      "    { \\n" +\n      "        return; \\n" +\n      "    } \\n" +\n      "    shadowParameters.texCoords = shadowPosition.xy; \\n" +\n      "    shadowParameters.depth = shadowPosition.z; \\n" +\n      "    shadowParameters.nDotL = nDotL; \\n" +\n      "    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \\n";\n  } else if (hasCascades) {\n    fsSource +=\n      "    float maxDepth = shadowMap_cascadeSplits[1].w; \\n" +\n      "    // Stop early if the eye depth exceeds the last cascade \\n" +\n      "    if (depth > maxDepth) \\n" +\n      "    { \\n" +\n      "        return; \\n" +\n      "    } \\n" +\n      "    // Get the cascade based on the eye-space depth \\n" +\n      "    vec4 weights = czm_cascadeWeights(depth); \\n" +\n      "    // Apply normal offset \\n" +\n      "    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \\n" +\n      "    applyNormalOffset(positionEC, normalEC, nDotL); \\n" +\n      "    // Transform position into the cascade \\n" +\n      "    vec4 shadowPosition = czm_cascadeMatrix(weights) * positionEC; \\n" +\n      "    // Get visibility \\n" +\n      "    shadowParameters.texCoords = shadowPosition.xy; \\n" +\n      "    shadowParameters.depth = shadowPosition.z; \\n" +\n      "    shadowParameters.nDotL = nDotL; \\n" +\n      "    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \\n" +\n      "    // Fade out shadows that are far away \\n" +\n      "    float shadowMapMaximumDistance = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.z; \\n" +\n      "    float fade = max((depth - shadowMapMaximumDistance * 0.8) / (shadowMapMaximumDistance * 0.2), 0.0); \\n" +\n      "    visibility = mix(visibility, 1.0, fade); \\n" +\n      (debugCascadeColors\n        ? "    // Draw cascade colors for debugging \\n" +\n          "    gl_FragColor *= czm_cascadeColor(weights); \\n"\n        : "");\n  } else {\n    fsSource +=\n      "    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \\n" +\n      "    applyNormalOffset(positionEC, normalEC, nDotL); \\n" +\n      "    vec4 shadowPosition = shadowMap_matrix * positionEC; \\n" +\n      "    // Stop early if the fragment is not in the shadow bounds \\n" +\n      "    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \\n" +\n      "    { \\n" +\n      "        return; \\n" +\n      "    } \\n" +\n      "    shadowParameters.texCoords = shadowPosition.xy; \\n" +\n      "    shadowParameters.depth = shadowPosition.z; \\n" +\n      "    shadowParameters.nDotL = nDotL; \\n" +\n      "    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \\n";\n  }\n\n  fsSource += "    gl_FragColor.rgb *= visibility; \\n" + "} \\n";\n\n  sources.push(fsSource);\n\n  return new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z({\n    defines: defines,\n    sources: sources,\n  });\n};\n/* harmony default export */ __webpack_exports__["Z"] = (ShadowMapShader);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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MEVBQTBFO0FBQzFFO0FBQ0EsMkRBQTJEO0FBQzNELHNEQUFzRDtBQUN0RCwyQ0FBMkM7QUFDM0MseUZBQXlGO0FBQ3pGO0FBQ0EseUdBQXlHO0FBQ3pHLCtHQUErRztBQUMvRyxvREFBb0Q7QUFDcEQ7QUFDQTtBQUNBLDBEQUEwRDtBQUMxRDtBQUNBLElBQUk7QUFDSjtBQUNBLHFGQUFxRjtBQUNyRiwyREFBMkQ7QUFDM0QsZ0VBQWdFO0FBQ2hFO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsdUJBQXVCO0FBQ3ZCLGFBQWE7QUFDYiwyREFBMkQ7QUFDM0Qsc0RBQXNEO0FBQ3RELDJDQUEyQztBQUMzQyx5RkFBeUY7QUFDekY7O0FBRUEsbURBQW1ELFNBQVM7O0FBRTVEOztBQUVBLGFBQWEsMEVBQVk7QUFDekI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLHlEQUFlLGVBQWUsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9TY2VuZS9TaGFkb3dNYXBTaGFkZXIuanM/NDg2ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZGVmaW5lZCBmcm9tIFwiLi4vQ29yZS9kZWZpbmVkLmpzXCI7XG5pbXBvcnQgU2hhZGVyU291cmNlIGZyb20gXCIuLi9SZW5kZXJlci9TaGFkZXJTb3VyY2UuanNcIjtcblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBTaGFkb3dNYXBTaGFkZXIoKSB7fVxuXG5TaGFkb3dNYXBTaGFkZXIuZ2V0U2hhZG93Q2FzdFNoYWRlcktleXdvcmQgPSBmdW5jdGlvbiAoXG4gIGlzUG9pbnRMaWdodCxcbiAgaXNUZXJyYWluLFxuICB1c2VzRGVwdGhUZXh0dXJlLFxuICBpc09wYXF1ZVxuKSB7XG4gIHJldHVybiAoXG4gICAgXCJjYXN0U2hhZG93IFwiICtcbiAgICBpc1BvaW50TGlnaHQgK1xuICAgIFwiIFwiICtcbiAgICBpc1RlcnJhaW4gK1xuICAgIFwiIFwiICtcbiAgICB1c2VzRGVwdGhUZXh0dXJlICtcbiAgICBcIiBcIiArXG4gICAgaXNPcGFxdWVcbiAgKTtcbn07XG5cblNoYWRvd01hcFNoYWRlci5jcmVhdGVTaGFkb3dDYXN0VmVydGV4U2hhZGVyID0gZnVuY3Rpb24gKFxuICB2cyxcbiAgaXNQb2ludExpZ2h0LFxuICBpc1RlcnJhaW5cbikge1xuICB2YXIgZGVmaW5lcyA9IHZzLmRlZmluZXMuc2xpY2UoMCk7XG4gIHZhciBzb3VyY2VzID0gdnMuc291cmNlcy5zbGljZSgwKTtcblxuICBkZWZpbmVzLnB1c2goXCJTSEFET1dfTUFQXCIpO1xuXG4gIGlmIChpc1RlcnJhaW4pIHtcbiAgICBkZWZpbmVzLnB1c2goXCJHRU5FUkFURV9QT1NJVElPTlwiKTtcbiAgfVxuXG4gIHZhciBwb3NpdGlvblZhcnlpbmdOYW1lID0gU2hhZGVyU291cmNlLmZpbmRQb3NpdGlvblZhcnlpbmcodnMpO1xuICB2YXIgaGFzUG9zaXRpb25WYXJ5aW5nID0gZGVmaW5lZChwb3NpdGlvblZhcnlpbmdOYW1lKTtcblxuICBpZiAoaXNQb2ludExpZ2h0ICYmICFoYXNQb3NpdGlvblZhcnlpbmcpIHtcbiAgICB2YXIgbGVuZ3RoID0gc291cmNlcy5sZW5ndGg7XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBsZW5ndGg7ICsraikge1xuICAgICAgc291cmNlc1tqXSA9IFNoYWRlclNvdXJjZS5yZXBsYWNlTWFpbihzb3VyY2VzW2pdLCBcImN6bV9zaGFkb3dfY2FzdF9tYWluXCIpO1xuICAgIH1cblxuICAgIHZhciBzaGFkb3dWUyA9XG4gICAgICBcInZhcnlpbmcgdmVjMyB2X3Bvc2l0aW9uRUM7IFxcblwiICtcbiAgICAgIFwidm9pZCBtYWluKCkgXFxuXCIgK1xuICAgICAgXCJ7IFxcblwiICtcbiAgICAgIFwiICAgIGN6bV9zaGFkb3dfY2FzdF9tYWluKCk7IFxcblwiICtcbiAgICAgIFwiICAgIHZfcG9zaXRpb25FQyA9IChjem1faW52ZXJzZVByb2plY3Rpb24gKiBnbF9Qb3NpdGlvbikueHl6OyBcXG5cIiArXG4gICAgICBcIn1cIjtcbiAgICBzb3VyY2VzLnB1c2goc2hhZG93VlMpO1xuICB9XG5cbiAgcmV0dXJuIG5ldyBTaGFkZXJTb3VyY2Uoe1xuICAgIGRlZmluZXM6IGRlZmluZXMsXG4gICAgc291cmNlczogc291cmNlcyxcbiAgfSk7XG59O1xuXG5TaGFkb3dNYXBTaGFkZXIuY3JlYXRlU2hhZG93Q2FzdEZyYWdtZW50U2hhZGVyID0gZnVuY3Rpb24gKFxuICBmcyxcbiAgaXNQb2ludExpZ2h0LFxuICB1c2VzRGVwdGhUZXh0dXJlLFxuICBvcGFxdWVcbikge1xuICB2YXIgZGVmaW5lcyA9IGZzLmRlZmluZXMuc2xpY2UoMCk7XG4gIHZhciBzb3VyY2VzID0gZnMuc291cmNlcy5zbGljZSgwKTtcblxuICB2YXIgcG9zaXRpb25WYXJ5aW5nTmFtZSA9IFNoYWRlclNvdXJjZS5maW5kUG9zaXRpb25WYXJ5aW5nKGZzKTtcbiAgdmFyIGhhc1Bvc2l0aW9uVmFyeWluZyA9IGRlZmluZWQocG9zaXRpb25WYXJ5aW5nTmFtZSk7XG4gIGlmICghaGFzUG9zaXRpb25WYXJ5aW5nKSB7XG4gICAgcG9zaXRpb25WYXJ5aW5nTmFtZSA9IFwidl9wb3NpdGlvbkVDXCI7XG4gIH1cblxuICB2YXIgbGVuZ3RoID0gc291cmNlcy5sZW5ndGg7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICBzb3VyY2VzW2ldID0gU2hhZGVyU291cmNlLnJlcGxhY2VNYWluKHNvdXJjZXNbaV0sIFwiY3ptX3NoYWRvd19jYXN0X21haW5cIik7XG4gIH1cblxuICB2YXIgZnNTb3VyY2UgPSBcIlwiO1xuXG4gIGlmIChpc1BvaW50TGlnaHQpIHtcbiAgICBpZiAoIWhhc1Bvc2l0aW9uVmFyeWluZykge1xuICAgICAgZnNTb3VyY2UgKz0gXCJ2YXJ5aW5nIHZlYzMgdl9wb3NpdGlvbkVDOyBcXG5cIjtcbiAgICB9XG4gICAgZnNTb3VyY2UgKz0gXCJ1bmlmb3JtIHZlYzQgc2hhZG93TWFwX2xpZ2h0UG9zaXRpb25FQzsgXFxuXCI7XG4gIH1cblxuICBpZiAob3BhcXVlKSB7XG4gICAgZnNTb3VyY2UgKz0gXCJ2b2lkIG1haW4oKSBcXG5cIiArIFwieyBcXG5cIjtcbiAgfSBlbHNlIHtcbiAgICBmc1NvdXJjZSArPVxuICAgICAgXCJ2b2lkIG1haW4oKSBcXG5cIiArXG4gICAgICBcInsgXFxuXCIgK1xuICAgICAgXCIgICAgY3ptX3NoYWRvd19jYXN0X21haW4oKTsgXFxuXCIgK1xuICAgICAgXCIgICAgaWYgKGdsX0ZyYWdDb2xvci5hID09IDAuMCkgXFxuXCIgK1xuICAgICAgXCIgICAgeyBcXG5cIiArXG4gICAgICBcIiAgICAgICBkaXNjYXJkOyBcXG5cIiArXG4gICAgICBcIiAgICB9IFxcblwiO1xuICB9XG5cbiAgaWYgKGlzUG9pbnRMaWdodCkge1xuICAgIGZzU291cmNlICs9XG4gICAgICBcIiAgICBmbG9hdCBkaXN0YW5jZSA9IGxlbmd0aChcIiArXG4gICAgICBwb3NpdGlvblZhcnlpbmdOYW1lICtcbiAgICAgIFwiKTsgXFxuXCIgK1xuICAgICAgXCIgICAgaWYgKGRpc3RhbmNlID49IHNoYWRvd01hcF9saWdodFBvc2l0aW9uRUMudykgXFxuXCIgK1xuICAgICAgXCIgICAgeyBcXG5cIiArXG4gICAgICBcIiAgICAgICAgZGlzY2FyZDsgXFxuXCIgK1xuICAgICAgXCIgICAgfSBcXG5cIiArXG4gICAgICBcIiAgICBkaXN0YW5jZSAvPSBzaGFkb3dNYXBfbGlnaHRQb3NpdGlvbkVDLnc7IC8vIHJhZGl1cyBcXG5cIiArXG4gICAgICBcIiAgICBnbF9GcmFnQ29sb3IgPSBjem1fcGFja0RlcHRoKGRpc3RhbmNlKTsgXFxuXCI7XG4gIH0gZWxzZSBpZiAodXNlc0RlcHRoVGV4dHVyZSkge1xuICAgIGZzU291cmNlICs9IFwiICAgIGdsX0ZyYWdDb2xvciA9IHZlYzQoMS4wKTsgXFxuXCI7XG4gIH0gZWxzZSB7XG4gICAgZnNTb3VyY2UgKz0gXCIgICAgZ2xfRnJhZ0NvbG9yID0gY3ptX3BhY2tEZXB0aChnbF9GcmFnQ29vcmQueik7IFxcblwiO1xuICB9XG5cbiAgZnNTb3VyY2UgKz0gXCJ9IFxcblwiO1xuXG4gIHNvdXJjZXMucHVzaChmc1NvdXJjZSk7XG5cbiAgcmV0dXJuIG5ldyBTaGFkZXJTb3VyY2Uoe1xuICAgIGRlZmluZXM6IGRlZmluZXMsXG4gICAgc291cmNlczogc291cmNlcyxcbiAgfSk7XG59O1xuXG5TaGFkb3dNYXBTaGFkZXIuZ2V0U2hhZG93UmVjZWl2ZVNoYWRlcktleXdvcmQgPSBmdW5jdGlvbiAoXG4gIHNoYWRvd01hcCxcbiAgY2FzdFNoYWRvd3MsXG4gIGlzVGVycmFpbixcbiAgaGFzVGVycmFpbk5vcm1hbFxuKSB7XG4gIHZhciB1c2VzRGVwdGhUZXh0dXJlID0gc2hhZG93TWFwLl91c2VzRGVwdGhUZXh0dXJlO1xuICB2YXIgcG9seWdvbk9mZnNldFN1cHBvcnRlZCA9IHNoYWRvd01hcC5fcG9seWdvbk9mZnNldFN1cHBvcnRlZDtcbiAgdmFyIGlzUG9pbnRMaWdodCA9IHNoYWRvd01hcC5faXNQb2ludExpZ2h0O1xuICB2YXIgaXNTcG90TGlnaHQgPSBzaGFkb3dNYXAuX2lzU3BvdExpZ2h0O1xuICB2YXIgaGFzQ2FzY2FkZXMgPSBzaGFkb3dNYXAuX251bWJlck9mQ2FzY2FkZXMgPiAxO1xuICB2YXIgZGVidWdDYXNjYWRlQ29sb3JzID0gc2hhZG93TWFwLmRlYnVnQ2FzY2FkZUNvbG9ycztcbiAgdmFyIHNvZnRTaGFkb3dzID0gc2hhZG93TWFwLnNvZnRTaGFkb3dzO1xuXG4gIHJldHVybiAoXG4gICAgXCJyZWNlaXZlU2hhZG93IFwiICtcbiAgICB1c2VzRGVwdGhUZXh0dXJlICtcbiAgICBwb2x5Z29uT2Zmc2V0U3VwcG9ydGVkICtcbiAgICBpc1BvaW50TGlnaHQgK1xuICAgIGlzU3BvdExpZ2h0ICtcbiAgICBoYXNDYXNjYWRlcyArXG4gICAgZGVidWdDYXNjYWRlQ29sb3JzICtcbiAgICBzb2Z0U2hhZG93cyArXG4gICAgY2FzdFNoYWRvd3MgK1xuICAgIGlzVGVycmFpbiArXG4gICAgaGFzVGVycmFpbk5vcm1hbFxuICApO1xufTtcblxuU2hhZG93TWFwU2hhZGVyLmNyZWF0ZVNoYWRvd1JlY2VpdmVWZXJ0ZXhTaGFkZXIgPSBmdW5jdGlvbiAoXG4gIHZzLFxuICBpc1RlcnJhaW4sXG4gIGhhc1RlcnJhaW5Ob3JtYWxcbikge1xuICB2YXIgZGVmaW5lcyA9IHZzLmRlZmluZXMuc2xpY2UoMCk7XG4gIHZhciBzb3VyY2VzID0gdnMuc291cmNlcy5zbGljZSgwKTtcblxuICBkZWZpbmVzLnB1c2goXCJTSEFET1dfTUFQXCIpO1xuXG4gIGlmIChpc1RlcnJhaW4pIHtcbiAgICBpZiAoaGFzVGVycmFpbk5vcm1hbCkge1xuICAgICAgZGVmaW5lcy5wdXNoKFwiR0VORVJBVEVfUE9TSVRJT05fQU5EX05PUk1BTFwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGVmaW5lcy5wdXNoKFwiR0VORVJBVEVfUE9TSVRJT05cIik7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5ldyBTaGFkZXJTb3VyY2Uoe1xuICAgIGRlZmluZXM6IGRlZmluZXMsXG4gICAgc291cmNlczogc291cmNlcyxcbiAgfSk7XG59O1xuXG5TaGFkb3dNYXBTaGFkZXIuY3JlYXRlU2hhZG93UmVjZWl2ZUZyYWdtZW50U2hhZGVyID0gZnVuY3Rpb24gKFxuICBmcyxcbiAgc2hhZG93TWFwLFxuICBjYXN0U2hhZG93cyxcbiAgaXNUZXJyYWluLFxuICBoYXNUZXJyYWluTm9ybWFsXG4pIHtcbiAgdmFyIG5vcm1hbFZhcnlpbmdOYW1lID0gU2hhZGVyU291cmNlLmZpbmROb3JtYWxWYXJ5aW5nKGZzKTtcbiAgdmFyIGhhc05vcm1hbFZhcnlpbmcgPVxuICAgICghaXNUZXJyYWluICYmIGRlZmluZWQobm9ybWFsVmFyeWluZ05hbWUpKSB8fFxuICAgIChpc1RlcnJhaW4gJiYgaGFzVGVycmFpbk5vcm1hbCk7XG5cbiAgdmFyIHBvc2l0aW9uVmFyeWluZ05hbWUgPSBTaGFkZXJTb3VyY2UuZmluZFBvc2l0aW9uVmFyeWluZyhmcyk7XG4gIHZhciBoYXNQb3NpdGlvblZhcnlpbmcgPSBkZWZpbmVkKHBvc2l0aW9uVmFyeWluZ05hbWUpO1xuXG4gIHZhciB1c2VzRGVwdGhUZXh0dXJlID0gc2hhZG93TWFwLl91c2VzRGVwdGhUZXh0dXJlO1xuICB2YXIgcG9seWdvbk9mZnNldFN1cHBvcnRlZCA9IHNoYWRvd01hcC5fcG9seWdvbk9mZnNldFN1cHBvcnRlZDtcbiAgdmFyIGlzUG9pbnRMaWdodCA9IHNoYWRvd01hcC5faXNQb2ludExpZ2h0O1xuICB2YXIgaXNTcG90TGlnaHQgPSBzaGFkb3dNYXAuX2lzU3BvdExpZ2h0O1xuICB2YXIgaGFzQ2FzY2FkZXMgPSBzaGFkb3dNYXAuX251bWJlck9mQ2FzY2FkZXMgPiAxO1xuICB2YXIgZGVidWdDYXNjYWRlQ29sb3JzID0gc2hhZG93TWFwLmRlYnVnQ2FzY2FkZUNvbG9ycztcbiAgdmFyIHNvZnRTaGFkb3dzID0gc2hhZG93TWFwLnNvZnRTaGFkb3dzO1xuICB2YXIgYmlhcyA9IGlzUG9pbnRMaWdodFxuICAgID8gc2hhZG93TWFwLl9wb2ludEJpYXNcbiAgICA6IGlzVGVycmFpblxuICAgID8gc2hhZG93TWFwLl90ZXJyYWluQmlhc1xuICAgIDogc2hhZG93TWFwLl9wcmltaXRpdmVCaWFzO1xuXG4gIHZhciBkZWZpbmVzID0gZnMuZGVmaW5lcy5zbGljZSgwKTtcbiAgdmFyIHNvdXJjZXMgPSBmcy5zb3VyY2VzLnNsaWNlKDApO1xuXG4gIHZhciBsZW5ndGggPSBzb3VyY2VzLmxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIHNvdXJjZXNbaV0gPSBTaGFkZXJTb3VyY2UucmVwbGFjZU1haW4oXG4gICAgICBzb3VyY2VzW2ldLFxuICAgICAgXCJjem1fc2hhZG93X3JlY2VpdmVfbWFpblwiXG4gICAgKTtcbiAgfVxuXG4gIGlmIChpc1BvaW50TGlnaHQpIHtcbiAgICBkZWZpbmVzLnB1c2goXCJVU0VfQ1VCRV9NQVBfU0hBRE9XXCIpO1xuICB9IGVsc2UgaWYgKHVzZXNEZXB0aFRleHR1cmUpIHtcbiAgICBkZWZpbmVzLnB1c2goXCJVU0VfU0hBRE9XX0RFUFRIX1RFWFRVUkVcIik7XG4gIH1cblxuICBpZiAoc29mdFNoYWRvd3MgJiYgIWlzUG9pbnRMaWdodCkge1xuICAgIGRlZmluZXMucHVzaChcIlVTRV9TT0ZUX1NIQURPV1NcIik7XG4gIH1cblxuICAvLyBFbmFibGUgZGF5LW5pZ2h0IHNoYWRpbmcgc28gdGhhdCB0aGUgZ2xvYmUgaXMgZGFyayB3aGVuIHRoZSBsaWdodCBpcyBiZWxvdyB0aGUgaG9yaXpvblxuICBpZiAoaGFzQ2FzY2FkZXMgJiYgY2FzdFNoYWRvd3MgJiYgaXNUZXJyYWluKSB7XG4gICAgaWYgKGhhc05vcm1hbFZhcnlpbmcpIHtcbiAgICAgIGRlZmluZXMucHVzaChcIkVOQUJMRV9WRVJURVhfTElHSFRJTkdcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRlZmluZXMucHVzaChcIkVOQUJMRV9EQVlOSUdIVF9TSEFESU5HXCIpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChjYXN0U2hhZG93cyAmJiBiaWFzLm5vcm1hbFNoYWRpbmcgJiYgaGFzTm9ybWFsVmFyeWluZykge1xuICAgIGRlZmluZXMucHVzaChcIlVTRV9OT1JNQUxfU0hBRElOR1wiKTtcbiAgICBpZiAoYmlhcy5ub3JtYWxTaGFkaW5nU21vb3RoID4gMC4wKSB7XG4gICAgICBkZWZpbmVzLnB1c2goXCJVU0VfTk9STUFMX1NIQURJTkdfU01PT1RIXCIpO1xuICAgIH1cbiAgfVxuXG4gIHZhciBmc1NvdXJjZSA9IFwiXCI7XG5cbiAgaWYgKGlzUG9pbnRMaWdodCkge1xuICAgIGZzU291cmNlICs9IFwidW5pZm9ybSBzYW1wbGVyQ3ViZSBzaGFkb3dNYXBfdGV4dHVyZUN1YmU7IFxcblwiO1xuICB9IGVsc2Uge1xuICAgIGZzU291cmNlICs9IFwidW5pZm9ybSBzYW1wbGVyMkQgc2hhZG93TWFwX3RleHR1cmU7IFxcblwiO1xuICB9XG5cbiAgdmFyIHJldHVyblBvc2l0aW9uRUM7XG4gIGlmIChoYXNQb3NpdGlvblZhcnlpbmcpIHtcbiAgICByZXR1cm5Qb3NpdGlvbkVDID0gXCIgICAgcmV0dXJuIHZlYzQoXCIgKyBwb3NpdGlvblZhcnlpbmdOYW1lICsgXCIsIDEuMCk7IFxcblwiO1xuICB9IGVsc2Uge1xuICAgIHJldHVyblBvc2l0aW9uRUMgPVxuICAgICAgXCIjaWZuZGVmIExPR19ERVBUSCBcXG5cIiArXG4gICAgICBcIiAgICByZXR1cm4gY3ptX3dpbmRvd1RvRXllQ29vcmRpbmF0ZXMoZ2xfRnJhZ0Nvb3JkKTsgXFxuXCIgK1xuICAgICAgXCIjZWxzZSBcXG5cIiArXG4gICAgICBcIiAgICByZXR1cm4gdmVjNCh2X2xvZ1Bvc2l0aW9uRUMsIDEuMCk7IFxcblwiICtcbiAgICAgIFwiI2VuZGlmIFxcblwiO1xuICB9XG5cbiAgZnNTb3VyY2UgKz1cbiAgICBcInVuaWZvcm0gbWF0NCBzaGFkb3dNYXBfbWF0cml4OyBcXG5cIiArXG4gICAgXCJ1bmlmb3JtIHZlYzMgc2hhZG93TWFwX2xpZ2h0RGlyZWN0aW9uRUM7IFxcblwiICtcbiAgICBcInVuaWZvcm0gdmVjNCBzaGFkb3dNYXBfbGlnaHRQb3NpdGlvbkVDOyBcXG5cIiArXG4gICAgXCJ1bmlmb3JtIHZlYzQgc2hhZG93TWFwX25vcm1hbE9mZnNldFNjYWxlRGlzdGFuY2VNYXhEaXN0YW5jZUFuZERhcmtuZXNzOyBcXG5cIiArXG4gICAgXCJ1bmlmb3JtIHZlYzQgc2hhZG93TWFwX3RleGVsU2l6ZURlcHRoQmlhc0FuZE5vcm1hbFNoYWRpbmdTbW9vdGg7IFxcblwiICtcbiAgICBcIiNpZmRlZiBMT0dfREVQVEggXFxuXCIgK1xuICAgIFwidmFyeWluZyB2ZWMzIHZfbG9nUG9zaXRpb25FQzsgXFxuXCIgK1xuICAgIFwiI2VuZGlmIFxcblwiICtcbiAgICBcInZlYzQgZ2V0UG9zaXRpb25FQygpIFxcblwiICtcbiAgICBcInsgXFxuXCIgK1xuICAgIHJldHVyblBvc2l0aW9uRUMgK1xuICAgIFwifSBcXG5cIiArXG4gICAgXCJ2ZWMzIGdldE5vcm1hbEVDKCkgXFxuXCIgK1xuICAgIFwieyBcXG5cIiArXG4gICAgKGhhc05vcm1hbFZhcnlpbmdcbiAgICAgID8gXCIgICAgcmV0dXJuIG5vcm1hbGl6ZShcIiArIG5vcm1hbFZhcnlpbmdOYW1lICsgXCIpOyBcXG5cIlxuICAgICAgOiBcIiAgICByZXR1cm4gdmVjMygxLjApOyBcXG5cIikgK1xuICAgIFwifSBcXG5cIiArXG4gICAgLy8gT2Zmc2V0IHRoZSBzaGFkb3cgcG9zaXRpb24gaW4gdGhlIGRpcmVjdGlvbiBvZiB0aGUgbm9ybWFsIGZvciBwZXJwZW5kaWN1bGFyIGFuZCBiYWNrIGZhY2VzXG4gICAgXCJ2b2lkIGFwcGx5Tm9ybWFsT2Zmc2V0KGlub3V0IHZlYzQgcG9zaXRpb25FQywgdmVjMyBub3JtYWxFQywgZmxvYXQgbkRvdEwpIFxcblwiICtcbiAgICBcInsgXFxuXCIgK1xuICAgIChiaWFzLm5vcm1hbE9mZnNldCAmJiBoYXNOb3JtYWxWYXJ5aW5nXG4gICAgICA/IFwiICAgIGZsb2F0IG5vcm1hbE9mZnNldCA9IHNoYWRvd01hcF9ub3JtYWxPZmZzZXRTY2FsZURpc3RhbmNlTWF4RGlzdGFuY2VBbmREYXJrbmVzcy54OyBcXG5cIiArXG4gICAgICAgIFwiICAgIGZsb2F0IG5vcm1hbE9mZnNldFNjYWxlID0gMS4wIC0gbkRvdEw7IFxcblwiICtcbiAgICAgICAgXCIgICAgdmVjMyBvZmZzZXQgPSBub3JtYWxPZmZzZXQgKiBub3JtYWxPZmZzZXRTY2FsZSAqIG5vcm1hbEVDOyBcXG5cIiArXG4gICAgICAgIFwiICAgIHBvc2l0aW9uRUMueHl6ICs9IG9mZnNldDsgXFxuXCJcbiAgICAgIDogXCJcIikgK1xuICAgIFwifSBcXG5cIjtcblxuICBmc1NvdXJjZSArPVxuICAgIFwidm9pZCBtYWluKCkgXFxuXCIgK1xuICAgIFwieyBcXG5cIiArXG4gICAgXCIgICAgY3ptX3NoYWRvd19yZWNlaXZlX21haW4oKTsgXFxuXCIgK1xuICAgIFwiICAgIHZlYzQgcG9zaXRpb25FQyA9IGdldFBvc2l0aW9uRUMoKTsgXFxuXCIgK1xuICAgIFwiICAgIHZlYzMgbm9ybWFsRUMgPSBnZXROb3JtYWxFQygpOyBcXG5cIiArXG4gICAgXCIgICAgZmxvYXQgZGVwdGggPSAtcG9zaXRpb25FQy56OyBcXG5cIjtcblxuICBmc1NvdXJjZSArPVxuICAgIFwiICAgIGN6bV9zaGFkb3dQYXJhbWV0ZXJzIHNoYWRvd1BhcmFtZXRlcnM7IFxcblwiICtcbiAgICBcIiAgICBzaGFkb3dQYXJhbWV0ZXJzLnRleGVsU3RlcFNpemUgPSBzaGFkb3dNYXBfdGV4ZWxTaXplRGVwdGhCaWFzQW5kTm9ybWFsU2hhZGluZ1Ntb290aC54eTsgXFxuXCIgK1xuICAgIFwiICAgIHNoYWRvd1BhcmFtZXRlcnMuZGVwdGhCaWFzID0gc2hhZG93TWFwX3RleGVsU2l6ZURlcHRoQmlhc0FuZE5vcm1hbFNoYWRpbmdTbW9vdGguejsgXFxuXCIgK1xuICAgIFwiICAgIHNoYWRvd1BhcmFtZXRlcnMubm9ybWFsU2hhZGluZ1Ntb290aCA9IHNoYWRvd01hcF90ZXhlbFNpemVEZXB0aEJpYXNBbmROb3JtYWxTaGFkaW5nU21vb3RoLnc7IFxcblwiICtcbiAgICBcIiAgICBzaGFkb3dQYXJhbWV0ZXJzLmRhcmtuZXNzID0gc2hhZG93TWFwX25vcm1hbE9mZnNldFNjYWxlRGlzdGFuY2VNYXhEaXN0YW5jZUFuZERhcmtuZXNzLnc7IFxcblwiO1xuXG4gIGlmIChpc1RlcnJhaW4pIHtcbiAgICAvLyBTY2FsZSBkZXB0aCBiaWFzIGJhc2VkIG9uIHZpZXcgZGlzdGFuY2UgdG8gcmVkdWNlIHotZmlnaHRpbmcgaW4gZGlzdGFudCB0ZXJyYWluXG4gICAgZnNTb3VyY2UgKz0gXCIgICAgc2hhZG93UGFyYW1ldGVycy5kZXB0aEJpYXMgKj0gbWF4KGRlcHRoICogMC4wMSwgMS4wKTsgXFxuXCI7XG4gIH0gZWxzZSBpZiAoIXBvbHlnb25PZmZzZXRTdXBwb3J0ZWQpIHtcbiAgICAvLyBJZiBwb2x5Z29uIG9mZnNldCBpc24ndCBzdXBwb3J0ZWQgcHVzaCB0aGUgZGVwdGggYmFjayBiYXNlZCBvbiB2aWV3LCBob3dldmVyIHRoaXNcbiAgICAvLyBjYXVzZXMgbGlnaHQgbGVha2luZyBhdCBmdXJ0aGVyIGF3YXkgdmlld3NcbiAgICBmc1NvdXJjZSArPVxuICAgICAgXCIgICAgc2hhZG93UGFyYW1ldGVycy5kZXB0aEJpYXMgKj0gbWl4KDEuMCwgMTAwLjAsIGRlcHRoICogMC4wMDE1KTsgXFxuXCI7XG4gIH1cblxuICBpZiAoaXNQb2ludExpZ2h0KSB7XG4gICAgZnNTb3VyY2UgKz1cbiAgICAgIFwiICAgIHZlYzMgZGlyZWN0aW9uRUMgPSBwb3NpdGlvbkVDLnh5eiAtIHNoYWRvd01hcF9saWdodFBvc2l0aW9uRUMueHl6OyBcXG5cIiArXG4gICAgICBcIiAgICBmbG9hdCBkaXN0YW5jZSA9IGxlbmd0aChkaXJlY3Rpb25FQyk7IFxcblwiICtcbiAgICAgIFwiICAgIGRpcmVjdGlvbkVDID0gbm9ybWFsaXplKGRpcmVjdGlvbkVDKTsgXFxuXCIgK1xuICAgICAgXCIgICAgZmxvYXQgcmFkaXVzID0gc2hhZG93TWFwX2xpZ2h0UG9zaXRpb25FQy53OyBcXG5cIiArXG4gICAgICBcIiAgICAvLyBTdG9wIGVhcmx5IGlmIHRoZSBmcmFnbWVudCBpcyBiZXlvbmQgdGhlIHBvaW50IGxpZ2h0IHJhZGl1cyBcXG5cIiArXG4gICAgICBcIiAgICBpZiAoZGlzdGFuY2UgPiByYWRpdXMpIFxcblwiICtcbiAgICAgIFwiICAgIHsgXFxuXCIgK1xuICAgICAgXCIgICAgICAgIHJldHVybjsgXFxuXCIgK1xuICAgICAgXCIgICAgfSBcXG5cIiArXG4gICAgICBcIiAgICB2ZWMzIGRpcmVjdGlvbldDICA9IGN6bV9pbnZlcnNlVmlld1JvdGF0aW9uICogZGlyZWN0aW9uRUM7IFxcblwiICtcbiAgICAgIFwiICAgIHNoYWRvd1BhcmFtZXRlcnMuZGVwdGggPSBkaXN0YW5jZSAvIHJhZGl1czsgXFxuXCIgK1xuICAgICAgXCIgICAgc2hhZG93UGFyYW1ldGVycy5uRG90TCA9IGNsYW1wKGRvdChub3JtYWxFQywgLWRpcmVjdGlvbkVDKSwgMC4wLCAxLjApOyBcXG5cIiArXG4gICAgICBcIiAgICBzaGFkb3dQYXJhbWV0ZXJzLnRleENvb3JkcyA9IGRpcmVjdGlvbldDOyBcXG5cIiArXG4gICAgICBcIiAgICBmbG9hdCB2aXNpYmlsaXR5ID0gY3ptX3NoYWRvd1Zpc2liaWxpdHkoc2hhZG93TWFwX3RleHR1cmVDdWJlLCBzaGFkb3dQYXJhbWV0ZXJzKTsgXFxuXCI7XG4gIH0gZWxzZSBpZiAoaXNTcG90TGlnaHQpIHtcbiAgICBmc1NvdXJjZSArPVxuICAgICAgXCIgICAgdmVjMyBkaXJlY3Rpb25FQyA9IG5vcm1hbGl6ZShwb3NpdGlvbkVDLnh5eiAtIHNoYWRvd01hcF9saWdodFBvc2l0aW9uRUMueHl6KTsgXFxuXCIgK1xuICAgICAgXCIgICAgZmxvYXQgbkRvdEwgPSBjbGFtcChkb3Qobm9ybWFsRUMsIC1kaXJlY3Rpb25FQyksIDAuMCwgMS4wKTsgXFxuXCIgK1xuICAgICAgXCIgICAgYXBwbHlOb3JtYWxPZmZzZXQocG9zaXRpb25FQywgbm9ybWFsRUMsIG5Eb3RMKTsgXFxuXCIgK1xuICAgICAgXCIgICAgdmVjNCBzaGFkb3dQb3NpdGlvbiA9IHNoYWRvd01hcF9tYXRyaXggKiBwb3NpdGlvbkVDOyBcXG5cIiArXG4gICAgICBcIiAgICAvLyBTcG90IGxpZ2h0IHVzZXMgYSBwZXJzcGVjdGl2ZSBwcm9qZWN0aW9uLCBzbyBwZXJmb3JtIHRoZSBwZXJzcGVjdGl2ZSBkaXZpZGUgXFxuXCIgK1xuICAgICAgXCIgICAgc2hhZG93UG9zaXRpb24gLz0gc2hhZG93UG9zaXRpb24udzsgXFxuXCIgK1xuICAgICAgXCIgICAgLy8gU3RvcCBlYXJseSBpZiB0aGUgZnJhZ21lbnQgaXMgbm90IGluIHRoZSBzaGFkb3cgYm91bmRzIFxcblwiICtcbiAgICAgIFwiICAgIGlmIChhbnkobGVzc1RoYW4oc2hhZG93UG9zaXRpb24ueHl6LCB2ZWMzKDAuMCkpKSB8fCBhbnkoZ3JlYXRlclRoYW4oc2hhZG93UG9zaXRpb24ueHl6LCB2ZWMzKDEuMCkpKSkgXFxuXCIgK1xuICAgICAgXCIgICAgeyBcXG5cIiArXG4gICAgICBcIiAgICAgICAgcmV0dXJuOyBcXG5cIiArXG4gICAgICBcIiAgICB9IFxcblwiICtcbiAgICAgIFwiICAgIHNoYWRvd1BhcmFtZXRlcnMudGV4Q29vcmRzID0gc2hhZG93UG9zaXRpb24ueHk7IFxcblwiICtcbiAgICAgIFwiICAgIHNoYWRvd1BhcmFtZXRlcnMuZGVwdGggPSBzaGFkb3dQb3NpdGlvbi56OyBcXG5cIiArXG4gICAgICBcIiAgICBzaGFkb3dQYXJhbWV0ZXJzLm5Eb3RMID0gbkRvdEw7IFxcblwiICtcbiAgICAgIFwiICAgIGZsb2F0IHZpc2liaWxpdHkgPSBjem1fc2hhZG93VmlzaWJpbGl0eShzaGFkb3dNYXBfdGV4dHVyZSwgc2hhZG93UGFyYW1ldGVycyk7IFxcblwiO1xuICB9IGVsc2UgaWYgKGhhc0Nhc2NhZGVzKSB7XG4gICAgZnNTb3VyY2UgKz1cbiAgICAgIFwiICAgIGZsb2F0IG1heERlcHRoID0gc2hhZG93TWFwX2Nhc2NhZGVTcGxpdHNbMV0udzsgXFxuXCIgK1xuICAgICAgXCIgICAgLy8gU3RvcCBlYXJseSBpZiB0aGUgZXllIGRlcHRoIGV4Y2VlZHMgdGhlIGxhc3QgY2FzY2FkZSBcXG5cIiArXG4gICAgICBcIiAgICBpZiAoZGVwdGggPiBtYXhEZXB0aCkgXFxuXCIgK1xuICAgICAgXCIgICAgeyBcXG5cIiArXG4gICAgICBcIiAgICAgICAgcmV0dXJuOyBcXG5cIiArXG4gICAgICBcIiAgICB9IFxcblwiICtcbiAgICAgIFwiICAgIC8vIEdldCB0aGUgY2FzY2FkZSBiYXNlZCBvbiB0aGUgZXllLXNwYWNlIGRlcHRoIFxcblwiICtcbiAgICAgIFwiICAgIHZlYzQgd2VpZ2h0cyA9IGN6bV9jYXNjYWRlV2VpZ2h0cyhkZXB0aCk7IFxcblwiICtcbiAgICAgIFwiICAgIC8vIEFwcGx5IG5vcm1hbCBvZmZzZXQgXFxuXCIgK1xuICAgICAgXCIgICAgZmxvYXQgbkRvdEwgPSBjbGFtcChkb3Qobm9ybWFsRUMsIHNoYWRvd01hcF9saWdodERpcmVjdGlvbkVDKSwgMC4wLCAxLjApOyBcXG5cIiArXG4gICAgICBcIiAgICBhcHBseU5vcm1hbE9mZnNldChwb3NpdGlvbkVDLCBub3JtYWxFQywgbkRvdEwpOyBcXG5cIiArXG4gICAgICBcIiAgICAvLyBUcmFuc2Zvcm0gcG9zaXRpb24gaW50byB0aGUgY2FzY2FkZSBcXG5cIiArXG4gICAgICBcIiAgICB2ZWM0IHNoYWRvd1Bvc2l0aW9uID0gY3ptX2Nhc2NhZGVNYXRyaXgod2VpZ2h0cykgKiBwb3NpdGlvbkVDOyBcXG5cIiArXG4gICAgICBcIiAgICAvLyBHZXQgdmlzaWJpbGl0eSBcXG5cIiArXG4gICAgICBcIiAgICBzaGFkb3dQYXJhbWV0ZXJzLnRleENvb3JkcyA9IHNoYWRvd1Bvc2l0aW9uLnh5OyBcXG5cIiArXG4gICAgICBcIiAgICBzaGFkb3dQYXJhbWV0ZXJzLmRlcHRoID0gc2hhZG93UG9zaXRpb24uejsgXFxuXCIgK1xuICAgICAgXCIgICAgc2hhZG93UGFyYW1ldGVycy5uRG90TCA9IG5Eb3RMOyBcXG5cIiArXG4gICAgICBcIiAgICBmbG9hdCB2aXNpYmlsaXR5ID0gY3ptX3NoYWRvd1Zpc2liaWxpdHkoc2hhZG93TWFwX3RleHR1cmUsIHNoYWRvd1BhcmFtZXRlcnMpOyBcXG5cIiArXG4gICAgICBcIiAgICAvLyBGYWRlIG91dCBzaGFkb3dzIHRoYXQgYXJlIGZhciBhd2F5IFxcblwiICtcbiAgICAgIFwiICAgIGZsb2F0IHNoYWRvd01hcE1heGltdW1EaXN0YW5jZSA9IHNoYWRvd01hcF9ub3JtYWxPZmZzZXRTY2FsZURpc3RhbmNlTWF4RGlzdGFuY2VBbmREYXJrbmVzcy56OyBcXG5cIiArXG4gICAgICBcIiAgICBmbG9hdCBmYWRlID0gbWF4KChkZXB0aCAtIHNoYWRvd01hcE1heGltdW1EaXN0YW5jZSAqIDAuOCkgLyAoc2hhZG93TWFwTWF4aW11bURpc3RhbmNlICogMC4yKSwgMC4wKTsgXFxuXCIgK1xuICAgICAgXCIgICAgdmlzaWJpbGl0eSA9IG1peCh2aXNpYmlsaXR5LCAxLjAsIGZhZGUpOyBcXG5cIiArXG4gICAgICAoZGVidWdDYXNjYWRlQ29sb3JzXG4gICAgICAgID8gXCIgICAgLy8gRHJhdyBjYXNjYWRlIGNvbG9ycyBmb3IgZGVidWdnaW5nIFxcblwiICtcbiAgICAgICAgICBcIiAgICBnbF9GcmFnQ29sb3IgKj0gY3ptX2Nhc2NhZGVDb2xvcih3ZWlnaHRzKTsgXFxuXCJcbiAgICAgICAgOiBcIlwiKTtcbiAgfSBlbHNlIHtcbiAgICBmc1NvdXJjZSArPVxuICAgICAgXCIgICAgZmxvYXQgbkRvdEwgPSBjbGFtcChkb3Qobm9ybWFsRUMsIHNoYWRvd01hcF9saWdodERpcmVjdGlvbkVDKSwgMC4wLCAxLjApOyBcXG5cIiArXG4gICAgICBcIiAgICBhcHBseU5vcm1hbE9mZnNldChwb3NpdGlvbkVDLCBub3JtYWxFQywgbkRvdEwpOyBcXG5cIiArXG4gICAgICBcIiAgICB2ZWM0IHNoYWRvd1Bvc2l0aW9uID0gc2hhZG93TWFwX21hdHJpeCAqIHBvc2l0aW9uRUM7IFxcblwiICtcbiAgICAgIFwiICAgIC8vIFN0b3AgZWFybHkgaWYgdGhlIGZyYWdtZW50IGlzIG5vdCBpbiB0aGUgc2hhZG93IGJvdW5kcyBcXG5cIiArXG4gICAgICBcIiAgICBpZiAoYW55KGxlc3NUaGFuKHNoYWRvd1Bvc2l0aW9uLnh5eiwgdmVjMygwLjApKSkgfHwgYW55KGdyZWF0ZXJUaGFuKHNoYWRvd1Bvc2l0aW9uLnh5eiwgdmVjMygxLjApKSkpIFxcblwiICtcbiAgICAgIFwiICAgIHsgXFxuXCIgK1xuICAgICAgXCIgICAgICAgIHJldHVybjsgXFxuXCIgK1xuICAgICAgXCIgICAgfSBcXG5cIiArXG4gICAgICBcIiAgICBzaGFkb3dQYXJhbWV0ZXJzLnRleENvb3JkcyA9IHNoYWRvd1Bvc2l0aW9uLnh5OyBcXG5cIiArXG4gICAgICBcIiAgICBzaGFkb3dQYXJhbWV0ZXJzLmRlcHRoID0gc2hhZG93UG9zaXRpb24uejsgXFxuXCIgK1xuICAgICAgXCIgICAgc2hhZG93UGFyYW1ldGVycy5uRG90TCA9IG5Eb3RMOyBcXG5cIiArXG4gICAgICBcIiAgICBmbG9hdCB2aXNpYmlsaXR5ID0gY3ptX3NoYWRvd1Zpc2liaWxpdHkoc2hhZG93TWFwX3RleHR1cmUsIHNoYWRvd1BhcmFtZXRlcnMpOyBcXG5cIjtcbiAgfVxuXG4gIGZzU291cmNlICs9IFwiICAgIGdsX0ZyYWdDb2xvci5yZ2IgKj0gdmlzaWJpbGl0eTsgXFxuXCIgKyBcIn0gXFxuXCI7XG5cbiAgc291cmNlcy5wdXNoKGZzU291cmNlKTtcblxuICByZXR1cm4gbmV3IFNoYWRlclNvdXJjZSh7XG4gICAgZGVmaW5lczogZGVmaW5lcyxcbiAgICBzb3VyY2VzOiBzb3VyY2VzLFxuICB9KTtcbn07XG5leHBvcnQgZGVmYXVsdCBTaGFkb3dNYXBTaGFkZXI7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///2143\n')},34125:function(__unused_webpack___webpack_module__,__webpack_exports__){eval('/**\n * Specifies whether the object casts or receives shadows from light sources when\n * shadows are enabled.\n *\n * @enum {Number}\n */\nvar ShadowMode = {\n  /**\n   * The object does not cast or receive shadows.\n   *\n   * @type {Number}\n   * @constant\n   */\n  DISABLED: 0,\n\n  /**\n   * The object casts and receives shadows.\n   *\n   * @type {Number}\n   * @constant\n   */\n  ENABLED: 1,\n\n  /**\n   * The object casts shadows only.\n   *\n   * @type {Number}\n   * @constant\n   */\n  CAST_ONLY: 2,\n\n  /**\n   * The object receives shadows only.\n   *\n   * @type {Number}\n   * @constant\n   */\n  RECEIVE_ONLY: 3,\n};\n\n/**\n * @private\n */\nShadowMode.NUMBER_OF_SHADOW_MODES = 4;\n\n/**\n * @private\n */\nShadowMode.castShadows = function (shadowMode) {\n  return (\n    shadowMode === ShadowMode.ENABLED || shadowMode === ShadowMode.CAST_ONLY\n  );\n};\n\n/**\n * @private\n */\nShadowMode.receiveShadows = function (shadowMode) {\n  return (\n    shadowMode === ShadowMode.ENABLED || shadowMode === ShadowMode.RECEIVE_ONLY\n  );\n};\n\n/**\n * @private\n */\nShadowMode.fromCastReceive = function (castShadows, receiveShadows) {\n  if (castShadows && receiveShadows) {\n    return ShadowMode.ENABLED;\n  } else if (castShadows) {\n    return ShadowMode.CAST_ONLY;\n  } else if (receiveShadows) {\n    return ShadowMode.RECEIVE_ONLY;\n  }\n  return ShadowMode.DISABLED;\n};\n\n/* harmony default export */ __webpack_exports__["Z"] = (Object.freeze(ShadowMode));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzQxMjUuanMiLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHlEQUFlLHlCQUF5QixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnVlMy13ZWJwYWNrNS8uL25vZGVfbW9kdWxlcy9jZXNpdW0vU291cmNlL1NjZW5lL1NoYWRvd01vZGUuanM/Y2UxZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFNwZWNpZmllcyB3aGV0aGVyIHRoZSBvYmplY3QgY2FzdHMgb3IgcmVjZWl2ZXMgc2hhZG93cyBmcm9tIGxpZ2h0IHNvdXJjZXMgd2hlblxuICogc2hhZG93cyBhcmUgZW5hYmxlZC5cbiAqXG4gKiBAZW51bSB7TnVtYmVyfVxuICovXG52YXIgU2hhZG93TW9kZSA9IHtcbiAgLyoqXG4gICAqIFRoZSBvYmplY3QgZG9lcyBub3QgY2FzdCBvciByZWNlaXZlIHNoYWRvd3MuXG4gICAqXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqIEBjb25zdGFudFxuICAgKi9cbiAgRElTQUJMRUQ6IDAsXG5cbiAgLyoqXG4gICAqIFRoZSBvYmplY3QgY2FzdHMgYW5kIHJlY2VpdmVzIHNoYWRvd3MuXG4gICAqXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqIEBjb25zdGFudFxuICAgKi9cbiAgRU5BQkxFRDogMSxcblxuICAvKipcbiAgICogVGhlIG9iamVjdCBjYXN0cyBzaGFkb3dzIG9ubHkuXG4gICAqXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqIEBjb25zdGFudFxuICAgKi9cbiAgQ0FTVF9PTkxZOiAyLFxuXG4gIC8qKlxuICAgKiBUaGUgb2JqZWN0IHJlY2VpdmVzIHNoYWRvd3Mgb25seS5cbiAgICpcbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQGNvbnN0YW50XG4gICAqL1xuICBSRUNFSVZFX09OTFk6IDMsXG59O1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKi9cblNoYWRvd01vZGUuTlVNQkVSX09GX1NIQURPV19NT0RFUyA9IDQ7XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuU2hhZG93TW9kZS5jYXN0U2hhZG93cyA9IGZ1bmN0aW9uIChzaGFkb3dNb2RlKSB7XG4gIHJldHVybiAoXG4gICAgc2hhZG93TW9kZSA9PT0gU2hhZG93TW9kZS5FTkFCTEVEIHx8IHNoYWRvd01vZGUgPT09IFNoYWRvd01vZGUuQ0FTVF9PTkxZXG4gICk7XG59O1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKi9cblNoYWRvd01vZGUucmVjZWl2ZVNoYWRvd3MgPSBmdW5jdGlvbiAoc2hhZG93TW9kZSkge1xuICByZXR1cm4gKFxuICAgIHNoYWRvd01vZGUgPT09IFNoYWRvd01vZGUuRU5BQkxFRCB8fCBzaGFkb3dNb2RlID09PSBTaGFkb3dNb2RlLlJFQ0VJVkVfT05MWVxuICApO1xufTtcblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5TaGFkb3dNb2RlLmZyb21DYXN0UmVjZWl2ZSA9IGZ1bmN0aW9uIChjYXN0U2hhZG93cywgcmVjZWl2ZVNoYWRvd3MpIHtcbiAgaWYgKGNhc3RTaGFkb3dzICYmIHJlY2VpdmVTaGFkb3dzKSB7XG4gICAgcmV0dXJuIFNoYWRvd01vZGUuRU5BQkxFRDtcbiAgfSBlbHNlIGlmIChjYXN0U2hhZG93cykge1xuICAgIHJldHVybiBTaGFkb3dNb2RlLkNBU1RfT05MWTtcbiAgfSBlbHNlIGlmIChyZWNlaXZlU2hhZG93cykge1xuICAgIHJldHVybiBTaGFkb3dNb2RlLlJFQ0VJVkVfT05MWTtcbiAgfVxuICByZXR1cm4gU2hhZG93TW9kZS5ESVNBQkxFRDtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IE9iamVjdC5mcmVlemUoU2hhZG93TW9kZSk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///34125\n')},88472:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(60838);\n/* harmony import */ var _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(60216);\n/* harmony import */ var _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(51688);\n/* harmony import */ var _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(66553);\n/* harmony import */ var _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(84828);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(82982);\n/* harmony import */ var _Core_EncodedCartesian3_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(74938);\n/* harmony import */ var _Core_GeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(15361);\n/* harmony import */ var _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(99417);\n/* harmony import */ var _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(72248);\n/* harmony import */ var _Core_Rectangle_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(96190);\n/* harmony import */ var _Core_Transforms_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(95555);\n/* harmony import */ var _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(53642);\n/* harmony import */ var _Scene_PerInstanceColorAppearance_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(64060);\n/* harmony import */ var _Shaders_ShadowVolumeAppearanceFS_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(52965);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Creates shaders for a ClassificationPrimitive to use a given Appearance, as well as for picking.\n *\n * @param {Boolean} extentsCulling Discard fragments outside the instance\'s texture coordinate extents.\n * @param {Boolean} planarExtents If true, texture coordinates will be computed using planes instead of spherical coordinates.\n * @param {Appearance} appearance An Appearance to be used with a ClassificationPrimitive via GroundPrimitive.\n * @private\n */\nfunction ShadowVolumeAppearance(extentsCulling, planarExtents, appearance) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.bool */ .Z.typeOf.bool("extentsCulling", extentsCulling);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.bool */ .Z.typeOf.bool("planarExtents", planarExtents);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.object */ .Z.typeOf.object("appearance", appearance);\n  //>>includeEnd(\'debug\');\n\n  this._projectionExtentDefines = {\n    eastMostYhighDefine: "",\n    eastMostYlowDefine: "",\n    westMostYhighDefine: "",\n    westMostYlowDefine: "",\n  };\n\n  // Compute shader dependencies\n  var colorShaderDependencies = new ShaderDependencies();\n  colorShaderDependencies.requiresTextureCoordinates = extentsCulling;\n  colorShaderDependencies.requiresEC = !appearance.flat;\n\n  var pickShaderDependencies = new ShaderDependencies();\n  pickShaderDependencies.requiresTextureCoordinates = extentsCulling;\n\n  if (appearance instanceof _Scene_PerInstanceColorAppearance_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z) {\n    // PerInstanceColorAppearance doesn\'t have material.shaderSource, instead it has its own vertex and fragment shaders\n    colorShaderDependencies.requiresNormalEC = !appearance.flat;\n  } else {\n    // Scan material source for what hookups are needed. Assume czm_materialInput materialInput.\n    var materialShaderSource =\n      appearance.material.shaderSource + "\\n" + appearance.fragmentShaderSource;\n\n    colorShaderDependencies.normalEC =\n      materialShaderSource.indexOf("materialInput.normalEC") !== -1 ||\n      materialShaderSource.indexOf("czm_getDefaultMaterial") !== -1;\n    colorShaderDependencies.positionToEyeEC =\n      materialShaderSource.indexOf("materialInput.positionToEyeEC") !== -1;\n    colorShaderDependencies.tangentToEyeMatrix =\n      materialShaderSource.indexOf("materialInput.tangentToEyeMatrix") !== -1;\n    colorShaderDependencies.st =\n      materialShaderSource.indexOf("materialInput.st") !== -1;\n  }\n\n  this._colorShaderDependencies = colorShaderDependencies;\n  this._pickShaderDependencies = pickShaderDependencies;\n  this._appearance = appearance;\n  this._extentsCulling = extentsCulling;\n  this._planarExtents = planarExtents;\n}\n\n/**\n * Create the fragment shader for a ClassificationPrimitive\'s color pass when rendering for color.\n *\n * @param {Boolean} columbusView2D Whether the shader will be used for Columbus View or 2D.\n * @returns {ShaderSource} Shader source for the fragment shader.\n */\nShadowVolumeAppearance.prototype.createFragmentShader = function (\n  columbusView2D\n) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.bool */ .Z.typeOf.bool("columbusView2D", columbusView2D);\n  //>>includeEnd(\'debug\');\n\n  var appearance = this._appearance;\n  var dependencies = this._colorShaderDependencies;\n\n  var defines = [];\n  if (!columbusView2D && !this._planarExtents) {\n    defines.push("SPHERICAL");\n  }\n  if (dependencies.requiresEC) {\n    defines.push("REQUIRES_EC");\n  }\n  if (dependencies.requiresWC) {\n    defines.push("REQUIRES_WC");\n  }\n  if (dependencies.requiresTextureCoordinates) {\n    defines.push("TEXTURE_COORDINATES");\n  }\n  if (this._extentsCulling) {\n    defines.push("CULL_FRAGMENTS");\n  }\n  if (dependencies.requiresNormalEC) {\n    defines.push("NORMAL_EC");\n  }\n  if (appearance instanceof _Scene_PerInstanceColorAppearance_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z) {\n    defines.push("PER_INSTANCE_COLOR");\n  }\n\n  // Material inputs. Use of parameters in the material is different\n  // from requirement of the parameters in the overall shader, for example,\n  // texture coordinates may be used for fragment culling but not for the material itself.\n  if (dependencies.normalEC) {\n    defines.push("USES_NORMAL_EC");\n  }\n  if (dependencies.positionToEyeEC) {\n    defines.push("USES_POSITION_TO_EYE_EC");\n  }\n  if (dependencies.tangentToEyeMatrix) {\n    defines.push("USES_TANGENT_TO_EYE");\n  }\n  if (dependencies.st) {\n    defines.push("USES_ST");\n  }\n\n  if (appearance.flat) {\n    defines.push("FLAT");\n  }\n\n  var materialSource = "";\n  if (!(appearance instanceof _Scene_PerInstanceColorAppearance_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z)) {\n    materialSource = appearance.material.shaderSource;\n  }\n\n  return new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z({\n    defines: defines,\n    sources: [materialSource, _Shaders_ShadowVolumeAppearanceFS_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z],\n  });\n};\n\nShadowVolumeAppearance.prototype.createPickFragmentShader = function (\n  columbusView2D\n) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.bool */ .Z.typeOf.bool("columbusView2D", columbusView2D);\n  //>>includeEnd(\'debug\');\n\n  var dependencies = this._pickShaderDependencies;\n\n  var defines = ["PICK"];\n  if (!columbusView2D && !this._planarExtents) {\n    defines.push("SPHERICAL");\n  }\n  if (dependencies.requiresEC) {\n    defines.push("REQUIRES_EC");\n  }\n  if (dependencies.requiresWC) {\n    defines.push("REQUIRES_WC");\n  }\n  if (dependencies.requiresTextureCoordinates) {\n    defines.push("TEXTURE_COORDINATES");\n  }\n  if (this._extentsCulling) {\n    defines.push("CULL_FRAGMENTS");\n  }\n  return new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z({\n    defines: defines,\n    sources: [_Shaders_ShadowVolumeAppearanceFS_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z],\n    pickColorQualifier: "varying",\n  });\n};\n\n/**\n * Create the vertex shader for a ClassificationPrimitive\'s color pass on the final of 3 shadow volume passes\n *\n * @param {String[]} defines External defines to pass to the vertex shader.\n * @param {String} vertexShaderSource ShadowVolumeAppearanceVS with any required modifications for computing position.\n * @param {Boolean} columbusView2D Whether the shader will be used for Columbus View or 2D.\n * @param {MapProjection} mapProjection Current scene\'s map projection.\n * @returns {String} Shader source for the vertex shader.\n */\nShadowVolumeAppearance.prototype.createVertexShader = function (\n  defines,\n  vertexShaderSource,\n  columbusView2D,\n  mapProjection\n) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].defined */ .Z.defined("defines", defines);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.string */ .Z.typeOf.string("vertexShaderSource", vertexShaderSource);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.bool */ .Z.typeOf.bool("columbusView2D", columbusView2D);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].defined */ .Z.defined("mapProjection", mapProjection);\n  //>>includeEnd(\'debug\');\n  return createShadowVolumeAppearanceVS(\n    this._colorShaderDependencies,\n    this._planarExtents,\n    columbusView2D,\n    defines,\n    vertexShaderSource,\n    this._appearance,\n    mapProjection,\n    this._projectionExtentDefines\n  );\n};\n\n/**\n * Create the vertex shader for a ClassificationPrimitive\'s pick pass on the final of 3 shadow volume passes\n *\n * @param {String[]} defines External defines to pass to the vertex shader.\n * @param {String} vertexShaderSource ShadowVolumeAppearanceVS with any required modifications for computing position and picking.\n * @param {Boolean} columbusView2D Whether the shader will be used for Columbus View or 2D.\n * @param {MapProjection} mapProjection Current scene\'s map projection.\n * @returns {String} Shader source for the vertex shader.\n */\nShadowVolumeAppearance.prototype.createPickVertexShader = function (\n  defines,\n  vertexShaderSource,\n  columbusView2D,\n  mapProjection\n) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].defined */ .Z.defined("defines", defines);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.string */ .Z.typeOf.string("vertexShaderSource", vertexShaderSource);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.bool */ .Z.typeOf.bool("columbusView2D", columbusView2D);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].defined */ .Z.defined("mapProjection", mapProjection);\n  //>>includeEnd(\'debug\');\n  return createShadowVolumeAppearanceVS(\n    this._pickShaderDependencies,\n    this._planarExtents,\n    columbusView2D,\n    defines,\n    vertexShaderSource,\n    undefined,\n    mapProjection,\n    this._projectionExtentDefines\n  );\n};\n\nvar longitudeExtentsCartesianScratch = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\nvar longitudeExtentsCartographicScratch = new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\nvar longitudeExtentsEncodeScratch = {\n  high: 0.0,\n  low: 0.0,\n};\nfunction createShadowVolumeAppearanceVS(\n  shaderDependencies,\n  planarExtents,\n  columbusView2D,\n  defines,\n  vertexShaderSource,\n  appearance,\n  mapProjection,\n  projectionExtentDefines\n) {\n  var allDefines = defines.slice();\n\n  if (projectionExtentDefines.eastMostYhighDefine === "") {\n    var eastMostCartographic = longitudeExtentsCartographicScratch;\n    eastMostCartographic.longitude = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].PI */ .Z.PI;\n    eastMostCartographic.latitude = 0.0;\n    eastMostCartographic.height = 0.0;\n    var eastMostCartesian = mapProjection.project(\n      eastMostCartographic,\n      longitudeExtentsCartesianScratch\n    );\n    var encoded = _Core_EncodedCartesian3_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].encode */ .Z.encode(\n      eastMostCartesian.x,\n      longitudeExtentsEncodeScratch\n    );\n    projectionExtentDefines.eastMostYhighDefine =\n      "EAST_MOST_X_HIGH " +\n      encoded.high.toFixed((encoded.high + "").length + 1);\n    projectionExtentDefines.eastMostYlowDefine =\n      "EAST_MOST_X_LOW " + encoded.low.toFixed((encoded.low + "").length + 1);\n\n    var westMostCartographic = longitudeExtentsCartographicScratch;\n    westMostCartographic.longitude = -_Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].PI */ .Z.PI;\n    westMostCartographic.latitude = 0.0;\n    westMostCartographic.height = 0.0;\n    var westMostCartesian = mapProjection.project(\n      westMostCartographic,\n      longitudeExtentsCartesianScratch\n    );\n    encoded = _Core_EncodedCartesian3_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].encode */ .Z.encode(\n      westMostCartesian.x,\n      longitudeExtentsEncodeScratch\n    );\n    projectionExtentDefines.westMostYhighDefine =\n      "WEST_MOST_X_HIGH " +\n      encoded.high.toFixed((encoded.high + "").length + 1);\n    projectionExtentDefines.westMostYlowDefine =\n      "WEST_MOST_X_LOW " + encoded.low.toFixed((encoded.low + "").length + 1);\n  }\n\n  if (columbusView2D) {\n    allDefines.push(projectionExtentDefines.eastMostYhighDefine);\n    allDefines.push(projectionExtentDefines.eastMostYlowDefine);\n    allDefines.push(projectionExtentDefines.westMostYhighDefine);\n    allDefines.push(projectionExtentDefines.westMostYlowDefine);\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(appearance) && appearance instanceof _Scene_PerInstanceColorAppearance_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z) {\n    allDefines.push("PER_INSTANCE_COLOR");\n  }\n  if (shaderDependencies.requiresTextureCoordinates) {\n    allDefines.push("TEXTURE_COORDINATES");\n    if (!(planarExtents || columbusView2D)) {\n      allDefines.push("SPHERICAL");\n    }\n    if (columbusView2D) {\n      allDefines.push("COLUMBUS_VIEW_2D");\n    }\n  }\n\n  return new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z({\n    defines: allDefines,\n    sources: [vertexShaderSource],\n  });\n}\n\n/**\n * Tracks shader dependencies.\n * @private\n */\nfunction ShaderDependencies() {\n  this._requiresEC = false;\n  this._requiresWC = false; // depends on eye coordinates, needed for material and for phong\n  this._requiresNormalEC = false; // depends on eye coordinates, needed for material\n  this._requiresTextureCoordinates = false; // depends on world coordinates, needed for material and for culling\n\n  this._usesNormalEC = false;\n  this._usesPositionToEyeEC = false;\n  this._usesTangentToEyeMat = false;\n  this._usesSt = false;\n}\n\nObject.defineProperties(ShaderDependencies.prototype, {\n  // Set when assessing final shading (flat vs. phong) and culling using computed texture coordinates\n  requiresEC: {\n    get: function () {\n      return this._requiresEC;\n    },\n    set: function (value) {\n      this._requiresEC = value || this._requiresEC;\n    },\n  },\n  requiresWC: {\n    get: function () {\n      return this._requiresWC;\n    },\n    set: function (value) {\n      this._requiresWC = value || this._requiresWC;\n      this.requiresEC = this._requiresWC;\n    },\n  },\n  requiresNormalEC: {\n    get: function () {\n      return this._requiresNormalEC;\n    },\n    set: function (value) {\n      this._requiresNormalEC = value || this._requiresNormalEC;\n      this.requiresEC = this._requiresNormalEC;\n    },\n  },\n  requiresTextureCoordinates: {\n    get: function () {\n      return this._requiresTextureCoordinates;\n    },\n    set: function (value) {\n      this._requiresTextureCoordinates =\n        value || this._requiresTextureCoordinates;\n      this.requiresWC = this._requiresTextureCoordinates;\n    },\n  },\n  // Get/Set when assessing material hookups\n  normalEC: {\n    set: function (value) {\n      this.requiresNormalEC = value;\n      this._usesNormalEC = value;\n    },\n    get: function () {\n      return this._usesNormalEC;\n    },\n  },\n  tangentToEyeMatrix: {\n    set: function (value) {\n      this.requiresWC = value;\n      this.requiresNormalEC = value;\n      this._usesTangentToEyeMat = value;\n    },\n    get: function () {\n      return this._usesTangentToEyeMat;\n    },\n  },\n  positionToEyeEC: {\n    set: function (value) {\n      this.requiresEC = value;\n      this._usesPositionToEyeEC = value;\n    },\n    get: function () {\n      return this._usesPositionToEyeEC;\n    },\n  },\n  st: {\n    set: function (value) {\n      this.requiresTextureCoordinates = value;\n      this._usesSt = value;\n    },\n    get: function () {\n      return this._usesSt;\n    },\n  },\n});\n\nfunction pointLineDistance(point1, point2, point) {\n  return (\n    Math.abs(\n      (point2.y - point1.y) * point.x -\n        (point2.x - point1.x) * point.y +\n        point2.x * point1.y -\n        point2.y * point1.x\n    ) / _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].distance */ .Z.distance(point2, point1)\n  );\n}\n\nvar points2DScratch = [\n  new _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(),\n  new _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(),\n  new _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(),\n  new _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(),\n];\n\n// textureCoordinateRotationPoints form 2 lines in the computed UV space that remap to desired texture coordinates.\n// This allows simulation of baked texture coordinates for EllipseGeometry, RectangleGeometry, and PolygonGeometry.\nfunction addTextureCoordinateRotationAttributes(\n  attributes,\n  textureCoordinateRotationPoints\n) {\n  var points2D = points2DScratch;\n\n  var minXYCorner = _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].unpack */ .Z.unpack(\n    textureCoordinateRotationPoints,\n    0,\n    points2D[0]\n  );\n  var maxYCorner = _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].unpack */ .Z.unpack(\n    textureCoordinateRotationPoints,\n    2,\n    points2D[1]\n  );\n  var maxXCorner = _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].unpack */ .Z.unpack(\n    textureCoordinateRotationPoints,\n    4,\n    points2D[2]\n  );\n\n  attributes.uMaxVmax = new _Core_GeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n    componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].FLOAT */ .Z.FLOAT,\n    componentsPerAttribute: 4,\n    normalize: false,\n    value: [maxYCorner.x, maxYCorner.y, maxXCorner.x, maxXCorner.y],\n  });\n\n  var inverseExtentX =\n    1.0 / pointLineDistance(minXYCorner, maxYCorner, maxXCorner);\n  var inverseExtentY =\n    1.0 / pointLineDistance(minXYCorner, maxXCorner, maxYCorner);\n\n  attributes.uvMinAndExtents = new _Core_GeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n    componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].FLOAT */ .Z.FLOAT,\n    componentsPerAttribute: 4,\n    normalize: false,\n    value: [minXYCorner.x, minXYCorner.y, inverseExtentX, inverseExtentY],\n  });\n}\n\nvar cartographicScratch = new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\nvar cornerScratch = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\nvar northWestScratch = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\nvar southEastScratch = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\nvar highLowScratch = { high: 0.0, low: 0.0 };\nfunction add2DTextureCoordinateAttributes(rectangle, projection, attributes) {\n  // Compute corner positions in double precision\n  var carto = cartographicScratch;\n  carto.height = 0.0;\n\n  carto.longitude = rectangle.west;\n  carto.latitude = rectangle.south;\n\n  var southWestCorner = projection.project(carto, cornerScratch);\n\n  carto.latitude = rectangle.north;\n  var northWest = projection.project(carto, northWestScratch);\n\n  carto.longitude = rectangle.east;\n  carto.latitude = rectangle.south;\n  var southEast = projection.project(carto, southEastScratch);\n\n  // Since these positions are all in the 2D plane, there\'s a lot of zeros\n  // and a lot of repetition. So we only need to encode 4 values.\n  // Encode:\n  // x: x value for southWestCorner\n  // y: y value for southWestCorner\n  // z: y value for northWest\n  // w: x value for southEast\n\n  var valuesHigh = [0, 0, 0, 0];\n  var valuesLow = [0, 0, 0, 0];\n  var encoded = _Core_EncodedCartesian3_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].encode */ .Z.encode(southWestCorner.x, highLowScratch);\n  valuesHigh[0] = encoded.high;\n  valuesLow[0] = encoded.low;\n\n  encoded = _Core_EncodedCartesian3_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].encode */ .Z.encode(southWestCorner.y, highLowScratch);\n  valuesHigh[1] = encoded.high;\n  valuesLow[1] = encoded.low;\n\n  encoded = _Core_EncodedCartesian3_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].encode */ .Z.encode(northWest.y, highLowScratch);\n  valuesHigh[2] = encoded.high;\n  valuesLow[2] = encoded.low;\n\n  encoded = _Core_EncodedCartesian3_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].encode */ .Z.encode(southEast.x, highLowScratch);\n  valuesHigh[3] = encoded.high;\n  valuesLow[3] = encoded.low;\n\n  attributes.planes2D_HIGH = new _Core_GeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n    componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].FLOAT */ .Z.FLOAT,\n    componentsPerAttribute: 4,\n    normalize: false,\n    value: valuesHigh,\n  });\n\n  attributes.planes2D_LOW = new _Core_GeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n    componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].FLOAT */ .Z.FLOAT,\n    componentsPerAttribute: 4,\n    normalize: false,\n    value: valuesLow,\n  });\n}\n\nvar enuMatrixScratch = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z();\nvar inverseEnuScratch = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z();\nvar rectanglePointCartesianScratch = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\nvar rectangleCenterScratch = new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\nvar pointsCartographicScratch = [\n  new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(),\n  new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(),\n  new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(),\n  new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(),\n  new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(),\n  new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(),\n  new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(),\n  new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(),\n];\n/**\n * When computing planes to bound the rectangle,\n * need to factor in "bulge" and other distortion.\n * Flatten the ellipsoid-centered corners and edge-centers of the rectangle\n * into the plane of the local ENU system, compute bounds in 2D, and\n * project back to ellipsoid-centered.\n *\n * @private\n */\nfunction computeRectangleBounds(\n  rectangle,\n  ellipsoid,\n  height,\n  southWestCornerResult,\n  eastVectorResult,\n  northVectorResult\n) {\n  // Compute center of rectangle\n  var centerCartographic = _Core_Rectangle_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"].center */ .Z.center(rectangle, rectangleCenterScratch);\n  centerCartographic.height = height;\n  var centerCartesian = _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].toCartesian */ .Z.toCartesian(\n    centerCartographic,\n    ellipsoid,\n    rectanglePointCartesianScratch\n  );\n  var enuMatrix = _Core_Transforms_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"].eastNorthUpToFixedFrame */ .Z.eastNorthUpToFixedFrame(\n    centerCartesian,\n    ellipsoid,\n    enuMatrixScratch\n  );\n  var inverseEnu = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].inverse */ .Z.inverse(enuMatrix, inverseEnuScratch);\n\n  var west = rectangle.west;\n  var east = rectangle.east;\n  var north = rectangle.north;\n  var south = rectangle.south;\n\n  var cartographics = pointsCartographicScratch;\n  cartographics[0].latitude = south;\n  cartographics[0].longitude = west;\n  cartographics[1].latitude = north;\n  cartographics[1].longitude = west;\n  cartographics[2].latitude = north;\n  cartographics[2].longitude = east;\n  cartographics[3].latitude = south;\n  cartographics[3].longitude = east;\n\n  var longitudeCenter = (west + east) * 0.5;\n  var latitudeCenter = (north + south) * 0.5;\n\n  cartographics[4].latitude = south;\n  cartographics[4].longitude = longitudeCenter;\n  cartographics[5].latitude = north;\n  cartographics[5].longitude = longitudeCenter;\n  cartographics[6].latitude = latitudeCenter;\n  cartographics[6].longitude = west;\n  cartographics[7].latitude = latitudeCenter;\n  cartographics[7].longitude = east;\n\n  var minX = Number.POSITIVE_INFINITY;\n  var maxX = Number.NEGATIVE_INFINITY;\n  var minY = Number.POSITIVE_INFINITY;\n  var maxY = Number.NEGATIVE_INFINITY;\n  for (var i = 0; i < 8; i++) {\n    cartographics[i].height = height;\n    var pointCartesian = _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].toCartesian */ .Z.toCartesian(\n      cartographics[i],\n      ellipsoid,\n      rectanglePointCartesianScratch\n    );\n    _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].multiplyByPoint */ .Z.multiplyByPoint(inverseEnu, pointCartesian, pointCartesian);\n    pointCartesian.z = 0.0; // flatten into XY plane of ENU coordinate system\n    minX = Math.min(minX, pointCartesian.x);\n    maxX = Math.max(maxX, pointCartesian.x);\n    minY = Math.min(minY, pointCartesian.y);\n    maxY = Math.max(maxY, pointCartesian.y);\n  }\n\n  var southWestCorner = southWestCornerResult;\n  southWestCorner.x = minX;\n  southWestCorner.y = minY;\n  southWestCorner.z = 0.0;\n  _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].multiplyByPoint */ .Z.multiplyByPoint(enuMatrix, southWestCorner, southWestCorner);\n\n  var southEastCorner = eastVectorResult;\n  southEastCorner.x = maxX;\n  southEastCorner.y = minY;\n  southEastCorner.z = 0.0;\n  _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].multiplyByPoint */ .Z.multiplyByPoint(enuMatrix, southEastCorner, southEastCorner);\n  // make eastward vector\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].subtract */ .Z.subtract(southEastCorner, southWestCorner, eastVectorResult);\n\n  var northWestCorner = northVectorResult;\n  northWestCorner.x = minX;\n  northWestCorner.y = maxY;\n  northWestCorner.z = 0.0;\n  _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].multiplyByPoint */ .Z.multiplyByPoint(enuMatrix, northWestCorner, northWestCorner);\n  // make eastward vector\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].subtract */ .Z.subtract(northWestCorner, southWestCorner, northVectorResult);\n}\n\nvar eastwardScratch = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\nvar northwardScratch = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\nvar encodeScratch = new _Core_EncodedCartesian3_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z();\n/**\n * Gets an attributes object containing:\n * - 3 high-precision points as 6 GeometryInstanceAttributes. These points are used to compute eye-space planes.\n * - 1 texture coordinate rotation GeometryInstanceAttributes\n * - 2 GeometryInstanceAttributes used to compute high-precision points in 2D and Columbus View.\n *   These points are used to compute eye-space planes like above.\n *\n * Used to compute texture coordinates for small-area ClassificationPrimitives with materials or multiple non-overlapping instances.\n *\n * @see ShadowVolumeAppearance\n * @private\n *\n * @param {Rectangle} boundingRectangle Rectangle object that the points will approximately bound\n * @param {Number[]} textureCoordinateRotationPoints Points in the computed texture coordinate system for remapping texture coordinates\n * @param {Ellipsoid} ellipsoid Ellipsoid for converting Rectangle points to world coordinates\n * @param {MapProjection} projection The MapProjection used for 2D and Columbus View.\n * @param {Number} [height=0] The maximum height for the shadow volume.\n * @returns {Object} An attributes dictionary containing planar texture coordinate attributes.\n */\nShadowVolumeAppearance.getPlanarTextureCoordinateAttributes = function (\n  boundingRectangle,\n  textureCoordinateRotationPoints,\n  ellipsoid,\n  projection,\n  height\n) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.object */ .Z.typeOf.object("boundingRectangle", boundingRectangle);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].defined */ .Z.defined(\n    "textureCoordinateRotationPoints",\n    textureCoordinateRotationPoints\n  );\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.object */ .Z.typeOf.object("ellipsoid", ellipsoid);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.object */ .Z.typeOf.object("projection", projection);\n  //>>includeEnd(\'debug\');\n\n  var corner = cornerScratch;\n  var eastward = eastwardScratch;\n  var northward = northwardScratch;\n  computeRectangleBounds(\n    boundingRectangle,\n    ellipsoid,\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(height, 0.0),\n    corner,\n    eastward,\n    northward\n  );\n\n  var attributes = {};\n  addTextureCoordinateRotationAttributes(\n    attributes,\n    textureCoordinateRotationPoints\n  );\n\n  var encoded = _Core_EncodedCartesian3_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].fromCartesian */ .Z.fromCartesian(corner, encodeScratch);\n\n  attributes.southWest_HIGH = new _Core_GeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n    componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].FLOAT */ .Z.FLOAT,\n    componentsPerAttribute: 3,\n    normalize: false,\n    value: _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].pack */ .Z.pack(encoded.high, [0, 0, 0]),\n  });\n  attributes.southWest_LOW = new _Core_GeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n    componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].FLOAT */ .Z.FLOAT,\n    componentsPerAttribute: 3,\n    normalize: false,\n    value: _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].pack */ .Z.pack(encoded.low, [0, 0, 0]),\n  });\n  attributes.eastward = new _Core_GeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n    componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].FLOAT */ .Z.FLOAT,\n    componentsPerAttribute: 3,\n    normalize: false,\n    value: _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].pack */ .Z.pack(eastward, [0, 0, 0]),\n  });\n  attributes.northward = new _Core_GeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n    componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].FLOAT */ .Z.FLOAT,\n    componentsPerAttribute: 3,\n    normalize: false,\n    value: _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].pack */ .Z.pack(northward, [0, 0, 0]),\n  });\n\n  add2DTextureCoordinateAttributes(boundingRectangle, projection, attributes);\n  return attributes;\n};\n\nvar spherePointScratch = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\nfunction latLongToSpherical(latitude, longitude, ellipsoid, result) {\n  var cartographic = cartographicScratch;\n  cartographic.latitude = latitude;\n  cartographic.longitude = longitude;\n  cartographic.height = 0.0;\n\n  var spherePoint = _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].toCartesian */ .Z.toCartesian(\n    cartographic,\n    ellipsoid,\n    spherePointScratch\n  );\n\n  // Project into plane with vertical for latitude\n  var magXY = Math.sqrt(\n    spherePoint.x * spherePoint.x + spherePoint.y * spherePoint.y\n  );\n\n  // Use fastApproximateAtan2 for alignment with shader\n  var sphereLatitude = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].fastApproximateAtan2 */ .Z.fastApproximateAtan2(magXY, spherePoint.z);\n  var sphereLongitude = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].fastApproximateAtan2 */ .Z.fastApproximateAtan2(\n    spherePoint.x,\n    spherePoint.y\n  );\n\n  result.x = sphereLatitude;\n  result.y = sphereLongitude;\n\n  return result;\n}\n\nvar sphericalScratch = new _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\n/**\n * Gets an attributes object containing:\n * - the southwest corner of a rectangular area in spherical coordinates, as well as the inverse of the latitude/longitude range.\n *   These are computed using the same atan2 approximation used in the shader.\n * - 1 texture coordinate rotation GeometryInstanceAttributes\n * - 2 GeometryInstanceAttributes used to compute high-precision points in 2D and Columbus View.\n *   These points are used to compute eye-space planes like above.\n *\n * Used when computing texture coordinates for large-area ClassificationPrimitives with materials or\n * multiple non-overlapping instances.\n * @see ShadowVolumeAppearance\n * @private\n *\n * @param {Rectangle} boundingRectangle Rectangle object that the spherical extents will approximately bound\n * @param {Number[]} textureCoordinateRotationPoints Points in the computed texture coordinate system for remapping texture coordinates\n * @param {Ellipsoid} ellipsoid Ellipsoid for converting Rectangle points to world coordinates\n * @param {MapProjection} projection The MapProjection used for 2D and Columbus View.\n * @returns {Object} An attributes dictionary containing spherical texture coordinate attributes.\n */\nShadowVolumeAppearance.getSphericalExtentGeometryInstanceAttributes = function (\n  boundingRectangle,\n  textureCoordinateRotationPoints,\n  ellipsoid,\n  projection\n) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.object */ .Z.typeOf.object("boundingRectangle", boundingRectangle);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].defined */ .Z.defined(\n    "textureCoordinateRotationPoints",\n    textureCoordinateRotationPoints\n  );\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.object */ .Z.typeOf.object("ellipsoid", ellipsoid);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.object */ .Z.typeOf.object("projection", projection);\n  //>>includeEnd(\'debug\');\n\n  // rectangle cartographic coords !== spherical because it\'s on an ellipsoid\n  var southWestExtents = latLongToSpherical(\n    boundingRectangle.south,\n    boundingRectangle.west,\n    ellipsoid,\n    sphericalScratch\n  );\n\n  var south = southWestExtents.x;\n  var west = southWestExtents.y;\n\n  var northEastExtents = latLongToSpherical(\n    boundingRectangle.north,\n    boundingRectangle.east,\n    ellipsoid,\n    sphericalScratch\n  );\n  var north = northEastExtents.x;\n  var east = northEastExtents.y;\n\n  // If the bounding rectangle crosses the IDL, rotate the spherical extents so the cross no longer happens.\n  // This rotation must happen in the shader too.\n  var rotationRadians = 0.0;\n  if (west > east) {\n    rotationRadians = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].PI */ .Z.PI - west;\n    west = -_Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].PI */ .Z.PI;\n    east += rotationRadians;\n  }\n\n  // Slightly pad extents to avoid floating point error when fragment culling at edges.\n  south -= _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].EPSILON5 */ .Z.EPSILON5;\n  west -= _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].EPSILON5 */ .Z.EPSILON5;\n  north += _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].EPSILON5 */ .Z.EPSILON5;\n  east += _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].EPSILON5 */ .Z.EPSILON5;\n\n  var longitudeRangeInverse = 1.0 / (east - west);\n  var latitudeRangeInverse = 1.0 / (north - south);\n\n  var attributes = {\n    sphericalExtents: new _Core_GeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n      componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].FLOAT */ .Z.FLOAT,\n      componentsPerAttribute: 4,\n      normalize: false,\n      value: [south, west, latitudeRangeInverse, longitudeRangeInverse],\n    }),\n    longitudeRotation: new _Core_GeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n      componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].FLOAT */ .Z.FLOAT,\n      componentsPerAttribute: 1,\n      normalize: false,\n      value: [rotationRadians],\n    }),\n  };\n\n  addTextureCoordinateRotationAttributes(\n    attributes,\n    textureCoordinateRotationPoints\n  );\n  add2DTextureCoordinateAttributes(boundingRectangle, projection, attributes);\n  return attributes;\n};\n\nShadowVolumeAppearance.hasAttributesForTextureCoordinatePlanes = function (\n  attributes\n) {\n  return (\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(attributes.southWest_HIGH) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(attributes.southWest_LOW) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(attributes.northward) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(attributes.eastward) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(attributes.planes2D_HIGH) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(attributes.planes2D_LOW) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(attributes.uMaxVmax) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(attributes.uvMinAndExtents)\n  );\n};\n\nShadowVolumeAppearance.hasAttributesForSphericalExtents = function (\n  attributes\n) {\n  return (\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(attributes.sphericalExtents) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(attributes.longitudeRotation) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(attributes.planes2D_HIGH) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(attributes.planes2D_LOW) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(attributes.uMaxVmax) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(attributes.uvMinAndExtents)\n  );\n};\n\nfunction shouldUseSpherical(rectangle) {\n  return (\n    Math.max(rectangle.width, rectangle.height) >\n    ShadowVolumeAppearance.MAX_WIDTH_FOR_PLANAR_EXTENTS\n  );\n}\n\n/**\n * Computes whether the given rectangle is wide enough that texture coordinates\n * over its area should be computed using spherical extents instead of distance to planes.\n *\n * @param {Rectangle} rectangle A rectangle\n * @private\n */\nShadowVolumeAppearance.shouldUseSphericalCoordinates = function (rectangle) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  //>>includeEnd(\'debug\');\n\n  return shouldUseSpherical(rectangle);\n};\n\n/**\n * Texture coordinates for ground primitives are computed either using spherical coordinates for large areas or\n * using distance from planes for small areas.\n *\n * @type {Number}\n * @constant\n * @private\n */\nShadowVolumeAppearance.MAX_WIDTH_FOR_PLANAR_EXTENTS = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].toRadians */ .Z.toRadians(1.0);\n/* harmony default export */ __webpack_exports__["Z"] = (ShadowVolumeAppearance);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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c0VBQU87QUFDWCxJQUFJLHNFQUFPO0FBQ1gsSUFBSSxzRUFBTztBQUNYLElBQUksc0VBQU87QUFDWCxJQUFJLHNFQUFPO0FBQ1g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksc0VBQU87QUFDWCxJQUFJLHNFQUFPO0FBQ1gsSUFBSSxzRUFBTztBQUNYLElBQUksc0VBQU87QUFDWCxJQUFJLHNFQUFPO0FBQ1gsSUFBSSxzRUFBTztBQUNYO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxXQUFXO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRSwyRkFBbUI7QUFDckI7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQSxzREFBc0Qsa0ZBQW9CO0FBQzFFLHlEQUFlLHNCQUFzQixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnVlMy13ZWJwYWNrNS8uL25vZGVfbW9kdWxlcy9jZXNpdW0vU291cmNlL1NjZW5lL1NoYWRvd1ZvbHVtZUFwcGVhcmFuY2UuanM/MjhkOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ2FydGVzaWFuMiBmcm9tIFwiLi4vQ29yZS9DYXJ0ZXNpYW4yLmpzXCI7XG5pbXBvcnQgQ2FydGVzaWFuMyBmcm9tIFwiLi4vQ29yZS9DYXJ0ZXNpYW4zLmpzXCI7XG5pbXBvcnQgQ2FydG9ncmFwaGljIGZyb20gXCIuLi9Db3JlL0NhcnRvZ3JhcGhpYy5qc1wiO1xuaW1wb3J0IENoZWNrIGZyb20gXCIuLi9Db3JlL0NoZWNrLmpzXCI7XG5pbXBvcnQgQ29tcG9uZW50RGF0YXR5cGUgZnJvbSBcIi4uL0NvcmUvQ29tcG9uZW50RGF0YXR5cGUuanNcIjtcbmltcG9ydCBkZWZhdWx0VmFsdWUgZnJvbSBcIi4uL0NvcmUvZGVmYXVsdFZhbHVlLmpzXCI7XG5pbXBvcnQgZGVmaW5lZCBmcm9tIFwiLi4vQ29yZS9kZWZpbmVkLmpzXCI7XG5pbXBvcnQgRW5jb2RlZENhcnRlc2lhbjMgZnJvbSBcIi4uL0NvcmUvRW5jb2RlZENhcnRlc2lhbjMuanNcIjtcbmltcG9ydCBHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlIGZyb20gXCIuLi9Db3JlL0dlb21ldHJ5SW5zdGFuY2VBdHRyaWJ1dGUuanNcIjtcbmltcG9ydCBDZXNpdW1NYXRoIGZyb20gXCIuLi9Db3JlL01hdGguanNcIjtcbmltcG9ydCBNYXRyaXg0IGZyb20gXCIuLi9Db3JlL01hdHJpeDQuanNcIjtcbmltcG9ydCBSZWN0YW5nbGUgZnJvbSBcIi4uL0NvcmUvUmVjdGFuZ2xlLmpzXCI7XG5pbXBvcnQgVHJhbnNmb3JtcyBmcm9tIFwiLi4vQ29yZS9UcmFuc2Zvcm1zLmpzXCI7XG5pbXBvcnQgU2hhZGVyU291cmNlIGZyb20gXCIuLi9SZW5kZXJlci9TaGFkZXJTb3VyY2UuanNcIjtcbmltcG9ydCBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZSBmcm9tIFwiLi4vU2NlbmUvUGVySW5zdGFuY2VDb2xvckFwcGVhcmFuY2UuanNcIjtcbmltcG9ydCBTaGFkb3dWb2x1bWVBcHBlYXJhbmNlRlMgZnJvbSBcIi4uL1NoYWRlcnMvU2hhZG93Vm9sdW1lQXBwZWFyYW5jZUZTLmpzXCI7XG5cbi8qKlxuICogQ3JlYXRlcyBzaGFkZXJzIGZvciBhIENsYXNzaWZpY2F0aW9uUHJpbWl0aXZlIHRvIHVzZSBhIGdpdmVuIEFwcGVhcmFuY2UsIGFzIHdlbGwgYXMgZm9yIHBpY2tpbmcuXG4gKlxuICogQHBhcmFtIHtCb29sZWFufSBleHRlbnRzQ3VsbGluZyBEaXNjYXJkIGZyYWdtZW50cyBvdXRzaWRlIHRoZSBpbnN0YW5jZSdzIHRleHR1cmUgY29vcmRpbmF0ZSBleHRlbnRzLlxuICogQHBhcmFtIHtCb29sZWFufSBwbGFuYXJFeHRlbnRzIElmIHRydWUsIHRleHR1cmUgY29vcmRpbmF0ZXMgd2lsbCBiZSBjb21wdXRlZCB1c2luZyBwbGFuZXMgaW5zdGVhZCBvZiBzcGhlcmljYWwgY29vcmRpbmF0ZXMuXG4gKiBAcGFyYW0ge0FwcGVhcmFuY2V9IGFwcGVhcmFuY2UgQW4gQXBwZWFyYW5jZSB0byBiZSB1c2VkIHdpdGggYSBDbGFzc2lmaWNhdGlvblByaW1pdGl2ZSB2aWEgR3JvdW5kUHJpbWl0aXZlLlxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gU2hhZG93Vm9sdW1lQXBwZWFyYW5jZShleHRlbnRzQ3VsbGluZywgcGxhbmFyRXh0ZW50cywgYXBwZWFyYW5jZSkge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2YuYm9vbChcImV4dGVudHNDdWxsaW5nXCIsIGV4dGVudHNDdWxsaW5nKTtcbiAgQ2hlY2sudHlwZU9mLmJvb2woXCJwbGFuYXJFeHRlbnRzXCIsIHBsYW5hckV4dGVudHMpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwiYXBwZWFyYW5jZVwiLCBhcHBlYXJhbmNlKTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgdGhpcy5fcHJvamVjdGlvbkV4dGVudERlZmluZXMgPSB7XG4gICAgZWFzdE1vc3RZaGlnaERlZmluZTogXCJcIixcbiAgICBlYXN0TW9zdFlsb3dEZWZpbmU6IFwiXCIsXG4gICAgd2VzdE1vc3RZaGlnaERlZmluZTogXCJcIixcbiAgICB3ZXN0TW9zdFlsb3dEZWZpbmU6IFwiXCIsXG4gIH07XG5cbiAgLy8gQ29tcHV0ZSBzaGFkZXIgZGVwZW5kZW5jaWVzXG4gIHZhciBjb2xvclNoYWRlckRlcGVuZGVuY2llcyA9IG5ldyBTaGFkZXJEZXBlbmRlbmNpZXMoKTtcbiAgY29sb3JTaGFkZXJEZXBlbmRlbmNpZXMucmVxdWlyZXNUZXh0dXJlQ29vcmRpbmF0ZXMgPSBleHRlbnRzQ3VsbGluZztcbiAgY29sb3JTaGFkZXJEZXBlbmRlbmNpZXMucmVxdWlyZXNFQyA9ICFhcHBlYXJhbmNlLmZsYXQ7XG5cbiAgdmFyIHBpY2tTaGFkZXJEZXBlbmRlbmNpZXMgPSBuZXcgU2hhZGVyRGVwZW5kZW5jaWVzKCk7XG4gIHBpY2tTaGFkZXJEZXBlbmRlbmNpZXMucmVxdWlyZXNUZXh0dXJlQ29vcmRpbmF0ZXMgPSBleHRlbnRzQ3VsbGluZztcblxuICBpZiAoYXBwZWFyYW5jZSBpbnN0YW5jZW9mIFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlKSB7XG4gICAgLy8gUGVySW5zdGFuY2VDb2xvckFwcGVhcmFuY2UgZG9lc24ndCBoYXZlIG1hdGVyaWFsLnNoYWRlclNvdXJjZSwgaW5zdGVhZCBpdCBoYXMgaXRzIG93biB2ZXJ0ZXggYW5kIGZyYWdtZW50IHNoYWRlcnNcbiAgICBjb2xvclNoYWRlckRlcGVuZGVuY2llcy5yZXF1aXJlc05vcm1hbEVDID0gIWFwcGVhcmFuY2UuZmxhdDtcbiAgfSBlbHNlIHtcbiAgICAvLyBTY2FuIG1hdGVyaWFsIHNvdXJjZSBmb3Igd2hhdCBob29rdXBzIGFyZSBuZWVkZWQuIEFzc3VtZSBjem1fbWF0ZXJpYWxJbnB1dCBtYXRlcmlhbElucHV0LlxuICAgIHZhciBtYXRlcmlhbFNoYWRlclNvdXJjZSA9XG4gICAgICBhcHBlYXJhbmNlLm1hdGVyaWFsLnNoYWRlclNvdXJjZSArIFwiXFxuXCIgKyBhcHBlYXJhbmNlLmZyYWdtZW50U2hhZGVyU291cmNlO1xuXG4gICAgY29sb3JTaGFkZXJEZXBlbmRlbmNpZXMubm9ybWFsRUMgPVxuICAgICAgbWF0ZXJpYWxTaGFkZXJTb3VyY2UuaW5kZXhPZihcIm1hdGVyaWFsSW5wdXQubm9ybWFsRUNcIikgIT09IC0xIHx8XG4gICAgICBtYXRlcmlhbFNoYWRlclNvdXJjZS5pbmRleE9mKFwiY3ptX2dldERlZmF1bHRNYXRlcmlhbFwiKSAhPT0gLTE7XG4gICAgY29sb3JTaGFkZXJEZXBlbmRlbmNpZXMucG9zaXRpb25Ub0V5ZUVDID1cbiAgICAgIG1hdGVyaWFsU2hhZGVyU291cmNlLmluZGV4T2YoXCJtYXRlcmlhbElucHV0LnBvc2l0aW9uVG9FeWVFQ1wiKSAhPT0gLTE7XG4gICAgY29sb3JTaGFkZXJEZXBlbmRlbmNpZXMudGFuZ2VudFRvRXllTWF0cml4ID1cbiAgICAgIG1hdGVyaWFsU2hhZGVyU291cmNlLmluZGV4T2YoXCJtYXRlcmlhbElucHV0LnRhbmdlbnRUb0V5ZU1hdHJpeFwiKSAhPT0gLTE7XG4gICAgY29sb3JTaGFkZXJEZXBlbmRlbmNpZXMuc3QgPVxuICAgICAgbWF0ZXJpYWxTaGFkZXJTb3VyY2UuaW5kZXhPZihcIm1hdGVyaWFsSW5wdXQuc3RcIikgIT09IC0xO1xuICB9XG5cbiAgdGhpcy5fY29sb3JTaGFkZXJEZXBlbmRlbmNpZXMgPSBjb2xvclNoYWRlckRlcGVuZGVuY2llcztcbiAgdGhpcy5fcGlja1NoYWRlckRlcGVuZGVuY2llcyA9IHBpY2tTaGFkZXJEZXBlbmRlbmNpZXM7XG4gIHRoaXMuX2FwcGVhcmFuY2UgPSBhcHBlYXJhbmNlO1xuICB0aGlzLl9leHRlbnRzQ3VsbGluZyA9IGV4dGVudHNDdWxsaW5nO1xuICB0aGlzLl9wbGFuYXJFeHRlbnRzID0gcGxhbmFyRXh0ZW50cztcbn1cblxuLyoqXG4gKiBDcmVhdGUgdGhlIGZyYWdtZW50IHNoYWRlciBmb3IgYSBDbGFzc2lmaWNhdGlvblByaW1pdGl2ZSdzIGNvbG9yIHBhc3Mgd2hlbiByZW5kZXJpbmcgZm9yIGNvbG9yLlxuICpcbiAqIEBwYXJhbSB7Qm9vbGVhbn0gY29sdW1idXNWaWV3MkQgV2hldGhlciB0aGUgc2hhZGVyIHdpbGwgYmUgdXNlZCBmb3IgQ29sdW1idXMgVmlldyBvciAyRC5cbiAqIEByZXR1cm5zIHtTaGFkZXJTb3VyY2V9IFNoYWRlciBzb3VyY2UgZm9yIHRoZSBmcmFnbWVudCBzaGFkZXIuXG4gKi9cblNoYWRvd1ZvbHVtZUFwcGVhcmFuY2UucHJvdG90eXBlLmNyZWF0ZUZyYWdtZW50U2hhZGVyID0gZnVuY3Rpb24gKFxuICBjb2x1bWJ1c1ZpZXcyRFxuKSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLnR5cGVPZi5ib29sKFwiY29sdW1idXNWaWV3MkRcIiwgY29sdW1idXNWaWV3MkQpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB2YXIgYXBwZWFyYW5jZSA9IHRoaXMuX2FwcGVhcmFuY2U7XG4gIHZhciBkZXBlbmRlbmNpZXMgPSB0aGlzLl9jb2xvclNoYWRlckRlcGVuZGVuY2llcztcblxuICB2YXIgZGVmaW5lcyA9IFtdO1xuICBpZiAoIWNvbHVtYnVzVmlldzJEICYmICF0aGlzLl9wbGFuYXJFeHRlbnRzKSB7XG4gICAgZGVmaW5lcy5wdXNoKFwiU1BIRVJJQ0FMXCIpO1xuICB9XG4gIGlmIChkZXBlbmRlbmNpZXMucmVxdWlyZXNFQykge1xuICAgIGRlZmluZXMucHVzaChcIlJFUVVJUkVTX0VDXCIpO1xuICB9XG4gIGlmIChkZXBlbmRlbmNpZXMucmVxdWlyZXNXQykge1xuICAgIGRlZmluZXMucHVzaChcIlJFUVVJUkVTX1dDXCIpO1xuICB9XG4gIGlmIChkZXBlbmRlbmNpZXMucmVxdWlyZXNUZXh0dXJlQ29vcmRpbmF0ZXMpIHtcbiAgICBkZWZpbmVzLnB1c2goXCJURVhUVVJFX0NPT1JESU5BVEVTXCIpO1xuICB9XG4gIGlmICh0aGlzLl9leHRlbnRzQ3VsbGluZykge1xuICAgIGRlZmluZXMucHVzaChcIkNVTExfRlJBR01FTlRTXCIpO1xuICB9XG4gIGlmIChkZXBlbmRlbmNpZXMucmVxdWlyZXNOb3JtYWxFQykge1xuICAgIGRlZmluZXMucHVzaChcIk5PUk1BTF9FQ1wiKTtcbiAgfVxuICBpZiAoYXBwZWFyYW5jZSBpbnN0YW5jZW9mIFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlKSB7XG4gICAgZGVmaW5lcy5wdXNoKFwiUEVSX0lOU1RBTkNFX0NPTE9SXCIpO1xuICB9XG5cbiAgLy8gTWF0ZXJpYWwgaW5wdXRzLiBVc2Ugb2YgcGFyYW1ldGVycyBpbiB0aGUgbWF0ZXJpYWwgaXMgZGlmZmVyZW50XG4gIC8vIGZyb20gcmVxdWlyZW1lbnQgb2YgdGhlIHBhcmFtZXRlcnMgaW4gdGhlIG92ZXJhbGwgc2hhZGVyLCBmb3IgZXhhbXBsZSxcbiAgLy8gdGV4dHVyZSBjb29yZGluYXRlcyBtYXkgYmUgdXNlZCBmb3IgZnJhZ21lbnQgY3VsbGluZyBidXQgbm90IGZvciB0aGUgbWF0ZXJpYWwgaXRzZWxmLlxuICBpZiAoZGVwZW5kZW5jaWVzLm5vcm1hbEVDKSB7XG4gICAgZGVmaW5lcy5wdXNoKFwiVVNFU19OT1JNQUxfRUNcIik7XG4gIH1cbiAgaWYgKGRlcGVuZGVuY2llcy5wb3NpdGlvblRvRXllRUMpIHtcbiAgICBkZWZpbmVzLnB1c2goXCJVU0VTX1BPU0lUSU9OX1RPX0VZRV9FQ1wiKTtcbiAgfVxuICBpZiAoZGVwZW5kZW5jaWVzLnRhbmdlbnRUb0V5ZU1hdHJpeCkge1xuICAgIGRlZmluZXMucHVzaChcIlVTRVNfVEFOR0VOVF9UT19FWUVcIik7XG4gIH1cbiAgaWYgKGRlcGVuZGVuY2llcy5zdCkge1xuICAgIGRlZmluZXMucHVzaChcIlVTRVNfU1RcIik7XG4gIH1cblxuICBpZiAoYXBwZWFyYW5jZS5mbGF0KSB7XG4gICAgZGVmaW5lcy5wdXNoKFwiRkxBVFwiKTtcbiAgfVxuXG4gIHZhciBtYXRlcmlhbFNvdXJjZSA9IFwiXCI7XG4gIGlmICghKGFwcGVhcmFuY2UgaW5zdGFuY2VvZiBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZSkpIHtcbiAgICBtYXRlcmlhbFNvdXJjZSA9IGFwcGVhcmFuY2UubWF0ZXJpYWwuc2hhZGVyU291cmNlO1xuICB9XG5cbiAgcmV0dXJuIG5ldyBTaGFkZXJTb3VyY2Uoe1xuICAgIGRlZmluZXM6IGRlZmluZXMsXG4gICAgc291cmNlczogW21hdGVyaWFsU291cmNlLCBTaGFkb3dWb2x1bWVBcHBlYXJhbmNlRlNdLFxuICB9KTtcbn07XG5cblNoYWRvd1ZvbHVtZUFwcGVhcmFuY2UucHJvdG90eXBlLmNyZWF0ZVBpY2tGcmFnbWVudFNoYWRlciA9IGZ1bmN0aW9uIChcbiAgY29sdW1idXNWaWV3MkRcbikge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2YuYm9vbChcImNvbHVtYnVzVmlldzJEXCIsIGNvbHVtYnVzVmlldzJEKTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgdmFyIGRlcGVuZGVuY2llcyA9IHRoaXMuX3BpY2tTaGFkZXJEZXBlbmRlbmNpZXM7XG5cbiAgdmFyIGRlZmluZXMgPSBbXCJQSUNLXCJdO1xuICBpZiAoIWNvbHVtYnVzVmlldzJEICYmICF0aGlzLl9wbGFuYXJFeHRlbnRzKSB7XG4gICAgZGVmaW5lcy5wdXNoKFwiU1BIRVJJQ0FMXCIpO1xuICB9XG4gIGlmIChkZXBlbmRlbmNpZXMucmVxdWlyZXNFQykge1xuICAgIGRlZmluZXMucHVzaChcIlJFUVVJUkVTX0VDXCIpO1xuICB9XG4gIGlmIChkZXBlbmRlbmNpZXMucmVxdWlyZXNXQykge1xuICAgIGRlZmluZXMucHVzaChcIlJFUVVJUkVTX1dDXCIpO1xuICB9XG4gIGlmIChkZXBlbmRlbmNpZXMucmVxdWlyZXNUZXh0dXJlQ29vcmRpbmF0ZXMpIHtcbiAgICBkZWZpbmVzLnB1c2goXCJURVhUVVJFX0NPT1JESU5BVEVTXCIpO1xuICB9XG4gIGlmICh0aGlzLl9leHRlbnRzQ3VsbGluZykge1xuICAgIGRlZmluZXMucHVzaChcIkNVTExfRlJBR01FTlRTXCIpO1xuICB9XG4gIHJldHVybiBuZXcgU2hhZGVyU291cmNlKHtcbiAgICBkZWZpbmVzOiBkZWZpbmVzLFxuICAgIHNvdXJjZXM6IFtTaGFkb3dWb2x1bWVBcHBlYXJhbmNlRlNdLFxuICAgIHBpY2tDb2xvclF1YWxpZmllcjogXCJ2YXJ5aW5nXCIsXG4gIH0pO1xufTtcblxuLyoqXG4gKiBDcmVhdGUgdGhlIHZlcnRleCBzaGFkZXIgZm9yIGEgQ2xhc3NpZmljYXRpb25QcmltaXRpdmUncyBjb2xvciBwYXNzIG9uIHRoZSBmaW5hbCBvZiAzIHNoYWRvdyB2b2x1bWUgcGFzc2VzXG4gKlxuICogQHBhcmFtIHtTdHJpbmdbXX0gZGVmaW5lcyBFeHRlcm5hbCBkZWZpbmVzIHRvIHBhc3MgdG8gdGhlIHZlcnRleCBzaGFkZXIuXG4gKiBAcGFyYW0ge1N0cmluZ30gdmVydGV4U2hhZGVyU291cmNlIFNoYWRvd1ZvbHVtZUFwcGVhcmFuY2VWUyB3aXRoIGFueSByZXF1aXJlZCBtb2RpZmljYXRpb25zIGZvciBjb21wdXRpbmcgcG9zaXRpb24uXG4gKiBAcGFyYW0ge0Jvb2xlYW59IGNvbHVtYnVzVmlldzJEIFdoZXRoZXIgdGhlIHNoYWRlciB3aWxsIGJlIHVzZWQgZm9yIENvbHVtYnVzIFZpZXcgb3IgMkQuXG4gKiBAcGFyYW0ge01hcFByb2plY3Rpb259IG1hcFByb2plY3Rpb24gQ3VycmVudCBzY2VuZSdzIG1hcCBwcm9qZWN0aW9uLlxuICogQHJldHVybnMge1N0cmluZ30gU2hhZGVyIHNvdXJjZSBmb3IgdGhlIHZlcnRleCBzaGFkZXIuXG4gKi9cblNoYWRvd1ZvbHVtZUFwcGVhcmFuY2UucHJvdG90eXBlLmNyZWF0ZVZlcnRleFNoYWRlciA9IGZ1bmN0aW9uIChcbiAgZGVmaW5lcyxcbiAgdmVydGV4U2hhZGVyU291cmNlLFxuICBjb2x1bWJ1c1ZpZXcyRCxcbiAgbWFwUHJvamVjdGlvblxuKSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLmRlZmluZWQoXCJkZWZpbmVzXCIsIGRlZmluZXMpO1xuICBDaGVjay50eXBlT2Yuc3RyaW5nKFwidmVydGV4U2hhZGVyU291cmNlXCIsIHZlcnRleFNoYWRlclNvdXJjZSk7XG4gIENoZWNrLnR5cGVPZi5ib29sKFwiY29sdW1idXNWaWV3MkRcIiwgY29sdW1idXNWaWV3MkQpO1xuICBDaGVjay5kZWZpbmVkKFwibWFwUHJvamVjdGlvblwiLCBtYXBQcm9qZWN0aW9uKTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG4gIHJldHVybiBjcmVhdGVTaGFkb3dWb2x1bWVBcHBlYXJhbmNlVlMoXG4gICAgdGhpcy5fY29sb3JTaGFkZXJEZXBlbmRlbmNpZXMsXG4gICAgdGhpcy5fcGxhbmFyRXh0ZW50cyxcbiAgICBjb2x1bWJ1c1ZpZXcyRCxcbiAgICBkZWZpbmVzLFxuICAgIHZlcnRleFNoYWRlclNvdXJjZSxcbiAgICB0aGlzLl9hcHBlYXJhbmNlLFxuICAgIG1hcFByb2plY3Rpb24sXG4gICAgdGhpcy5fcHJvamVjdGlvbkV4dGVudERlZmluZXNcbiAgKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlIHRoZSB2ZXJ0ZXggc2hhZGVyIGZvciBhIENsYXNzaWZpY2F0aW9uUHJpbWl0aXZlJ3MgcGljayBwYXNzIG9uIHRoZSBmaW5hbCBvZiAzIHNoYWRvdyB2b2x1bWUgcGFzc2VzXG4gKlxuICogQHBhcmFtIHtTdHJpbmdbXX0gZGVmaW5lcyBFeHRlcm5hbCBkZWZpbmVzIHRvIHBhc3MgdG8gdGhlIHZlcnRleCBzaGFkZXIuXG4gKiBAcGFyYW0ge1N0cmluZ30gdmVydGV4U2hhZGVyU291cmNlIFNoYWRvd1ZvbHVtZUFwcGVhcmFuY2VWUyB3aXRoIGFueSByZXF1aXJlZCBtb2RpZmljYXRpb25zIGZvciBjb21wdXRpbmcgcG9zaXRpb24gYW5kIHBpY2tpbmcuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IGNvbHVtYnVzVmlldzJEIFdoZXRoZXIgdGhlIHNoYWRlciB3aWxsIGJlIHVzZWQgZm9yIENvbHVtYnVzIFZpZXcgb3IgMkQuXG4gKiBAcGFyYW0ge01hcFByb2plY3Rpb259IG1hcFByb2plY3Rpb24gQ3VycmVudCBzY2VuZSdzIG1hcCBwcm9qZWN0aW9uLlxuICogQHJldHVybnMge1N0cmluZ30gU2hhZGVyIHNvdXJjZSBmb3IgdGhlIHZlcnRleCBzaGFkZXIuXG4gKi9cblNoYWRvd1ZvbHVtZUFwcGVhcmFuY2UucHJvdG90eXBlLmNyZWF0ZVBpY2tWZXJ0ZXhTaGFkZXIgPSBmdW5jdGlvbiAoXG4gIGRlZmluZXMsXG4gIHZlcnRleFNoYWRlclNvdXJjZSxcbiAgY29sdW1idXNWaWV3MkQsXG4gIG1hcFByb2plY3Rpb25cbikge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay5kZWZpbmVkKFwiZGVmaW5lc1wiLCBkZWZpbmVzKTtcbiAgQ2hlY2sudHlwZU9mLnN0cmluZyhcInZlcnRleFNoYWRlclNvdXJjZVwiLCB2ZXJ0ZXhTaGFkZXJTb3VyY2UpO1xuICBDaGVjay50eXBlT2YuYm9vbChcImNvbHVtYnVzVmlldzJEXCIsIGNvbHVtYnVzVmlldzJEKTtcbiAgQ2hlY2suZGVmaW5lZChcIm1hcFByb2plY3Rpb25cIiwgbWFwUHJvamVjdGlvbik7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuICByZXR1cm4gY3JlYXRlU2hhZG93Vm9sdW1lQXBwZWFyYW5jZVZTKFxuICAgIHRoaXMuX3BpY2tTaGFkZXJEZXBlbmRlbmNpZXMsXG4gICAgdGhpcy5fcGxhbmFyRXh0ZW50cyxcbiAgICBjb2x1bWJ1c1ZpZXcyRCxcbiAgICBkZWZpbmVzLFxuICAgIHZlcnRleFNoYWRlclNvdXJjZSxcbiAgICB1bmRlZmluZWQsXG4gICAgbWFwUHJvamVjdGlvbixcbiAgICB0aGlzLl9wcm9qZWN0aW9uRXh0ZW50RGVmaW5lc1xuICApO1xufTtcblxudmFyIGxvbmdpdHVkZUV4dGVudHNDYXJ0ZXNpYW5TY3JhdGNoID0gbmV3IENhcnRlc2lhbjMoKTtcbnZhciBsb25naXR1ZGVFeHRlbnRzQ2FydG9ncmFwaGljU2NyYXRjaCA9IG5ldyBDYXJ0b2dyYXBoaWMoKTtcbnZhciBsb25naXR1ZGVFeHRlbnRzRW5jb2RlU2NyYXRjaCA9IHtcbiAgaGlnaDogMC4wLFxuICBsb3c6IDAuMCxcbn07XG5mdW5jdGlvbiBjcmVhdGVTaGFkb3dWb2x1bWVBcHBlYXJhbmNlVlMoXG4gIHNoYWRlckRlcGVuZGVuY2llcyxcbiAgcGxhbmFyRXh0ZW50cyxcbiAgY29sdW1idXNWaWV3MkQsXG4gIGRlZmluZXMsXG4gIHZlcnRleFNoYWRlclNvdXJjZSxcbiAgYXBwZWFyYW5jZSxcbiAgbWFwUHJvamVjdGlvbixcbiAgcHJvamVjdGlvbkV4dGVudERlZmluZXNcbikge1xuICB2YXIgYWxsRGVmaW5lcyA9IGRlZmluZXMuc2xpY2UoKTtcblxuICBpZiAocHJvamVjdGlvbkV4dGVudERlZmluZXMuZWFzdE1vc3RZaGlnaERlZmluZSA9PT0gXCJcIikge1xuICAgIHZhciBlYXN0TW9zdENhcnRvZ3JhcGhpYyA9IGxvbmdpdHVkZUV4dGVudHNDYXJ0b2dyYXBoaWNTY3JhdGNoO1xuICAgIGVhc3RNb3N0Q2FydG9ncmFwaGljLmxvbmdpdHVkZSA9IENlc2l1bU1hdGguUEk7XG4gICAgZWFzdE1vc3RDYXJ0b2dyYXBoaWMubGF0aXR1ZGUgPSAwLjA7XG4gICAgZWFzdE1vc3RDYXJ0b2dyYXBoaWMuaGVpZ2h0ID0gMC4wO1xuICAgIHZhciBlYXN0TW9zdENhcnRlc2lhbiA9IG1hcFByb2plY3Rpb24ucHJvamVjdChcbiAgICAgIGVhc3RNb3N0Q2FydG9ncmFwaGljLFxuICAgICAgbG9uZ2l0dWRlRXh0ZW50c0NhcnRlc2lhblNjcmF0Y2hcbiAgICApO1xuICAgIHZhciBlbmNvZGVkID0gRW5jb2RlZENhcnRlc2lhbjMuZW5jb2RlKFxuICAgICAgZWFzdE1vc3RDYXJ0ZXNpYW4ueCxcbiAgICAgIGxvbmdpdHVkZUV4dGVudHNFbmNvZGVTY3JhdGNoXG4gICAgKTtcbiAgICBwcm9qZWN0aW9uRXh0ZW50RGVmaW5lcy5lYXN0TW9zdFloaWdoRGVmaW5lID1cbiAgICAgIFwiRUFTVF9NT1NUX1hfSElHSCBcIiArXG4gICAgICBlbmNvZGVkLmhpZ2gudG9GaXhlZCgoZW5jb2RlZC5oaWdoICsgXCJcIikubGVuZ3RoICsgMSk7XG4gICAgcHJvamVjdGlvbkV4dGVudERlZmluZXMuZWFzdE1vc3RZbG93RGVmaW5lID1cbiAgICAgIFwiRUFTVF9NT1NUX1hfTE9XIFwiICsgZW5jb2RlZC5sb3cudG9GaXhlZCgoZW5jb2RlZC5sb3cgKyBcIlwiKS5sZW5ndGggKyAxKTtcblxuICAgIHZhciB3ZXN0TW9zdENhcnRvZ3JhcGhpYyA9IGxvbmdpdHVkZUV4dGVudHNDYXJ0b2dyYXBoaWNTY3JhdGNoO1xuICAgIHdlc3RNb3N0Q2FydG9ncmFwaGljLmxvbmdpdHVkZSA9IC1DZXNpdW1NYXRoLlBJO1xuICAgIHdlc3RNb3N0Q2FydG9ncmFwaGljLmxhdGl0dWRlID0gMC4wO1xuICAgIHdlc3RNb3N0Q2FydG9ncmFwaGljLmhlaWdodCA9IDAuMDtcbiAgICB2YXIgd2VzdE1vc3RDYXJ0ZXNpYW4gPSBtYXBQcm9qZWN0aW9uLnByb2plY3QoXG4gICAgICB3ZXN0TW9zdENhcnRvZ3JhcGhpYyxcbiAgICAgIGxvbmdpdHVkZUV4dGVudHNDYXJ0ZXNpYW5TY3JhdGNoXG4gICAgKTtcbiAgICBlbmNvZGVkID0gRW5jb2RlZENhcnRlc2lhbjMuZW5jb2RlKFxuICAgICAgd2VzdE1vc3RDYXJ0ZXNpYW4ueCxcbiAgICAgIGxvbmdpdHVkZUV4dGVudHNFbmNvZGVTY3JhdGNoXG4gICAgKTtcbiAgICBwcm9qZWN0aW9uRXh0ZW50RGVmaW5lcy53ZXN0TW9zdFloaWdoRGVmaW5lID1cbiAgICAgIFwiV0VTVF9NT1NUX1hfSElHSCBcIiArXG4gICAgICBlbmNvZGVkLmhpZ2gudG9GaXhlZCgoZW5jb2RlZC5oaWdoICsgXCJcIikubGVuZ3RoICsgMSk7XG4gICAgcHJvamVjdGlvbkV4dGVudERlZmluZXMud2VzdE1vc3RZbG93RGVmaW5lID1cbiAgICAgIFwiV0VTVF9NT1NUX1hfTE9XIFwiICsgZW5jb2RlZC5sb3cudG9GaXhlZCgoZW5jb2RlZC5sb3cgKyBcIlwiKS5sZW5ndGggKyAxKTtcbiAgfVxuXG4gIGlmIChjb2x1bWJ1c1ZpZXcyRCkge1xuICAgIGFsbERlZmluZXMucHVzaChwcm9qZWN0aW9uRXh0ZW50RGVmaW5lcy5lYXN0TW9zdFloaWdoRGVmaW5lKTtcbiAgICBhbGxEZWZpbmVzLnB1c2gocHJvamVjdGlvbkV4dGVudERlZmluZXMuZWFzdE1vc3RZbG93RGVmaW5lKTtcbiAgICBhbGxEZWZpbmVzLnB1c2gocHJvamVjdGlvbkV4dGVudERlZmluZXMud2VzdE1vc3RZaGlnaERlZmluZSk7XG4gICAgYWxsRGVmaW5lcy5wdXNoKHByb2plY3Rpb25FeHRlbnREZWZpbmVzLndlc3RNb3N0WWxvd0RlZmluZSk7XG4gIH1cblxuICBpZiAoZGVmaW5lZChhcHBlYXJhbmNlKSAmJiBhcHBlYXJhbmNlIGluc3RhbmNlb2YgUGVySW5zdGFuY2VDb2xvckFwcGVhcmFuY2UpIHtcbiAgICBhbGxEZWZpbmVzLnB1c2goXCJQRVJfSU5TVEFOQ0VfQ09MT1JcIik7XG4gIH1cbiAgaWYgKHNoYWRlckRlcGVuZGVuY2llcy5yZXF1aXJlc1RleHR1cmVDb29yZGluYXRlcykge1xuICAgIGFsbERlZmluZXMucHVzaChcIlRFWFRVUkVfQ09PUkRJTkFURVNcIik7XG4gICAgaWYgKCEocGxhbmFyRXh0ZW50cyB8fCBjb2x1bWJ1c1ZpZXcyRCkpIHtcbiAgICAgIGFsbERlZmluZXMucHVzaChcIlNQSEVSSUNBTFwiKTtcbiAgICB9XG4gICAgaWYgKGNvbHVtYnVzVmlldzJEKSB7XG4gICAgICBhbGxEZWZpbmVzLnB1c2goXCJDT0xVTUJVU19WSUVXXzJEXCIpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBuZXcgU2hhZGVyU291cmNlKHtcbiAgICBkZWZpbmVzOiBhbGxEZWZpbmVzLFxuICAgIHNvdXJjZXM6IFt2ZXJ0ZXhTaGFkZXJTb3VyY2VdLFxuICB9KTtcbn1cblxuLyoqXG4gKiBUcmFja3Mgc2hhZGVyIGRlcGVuZGVuY2llcy5cbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIFNoYWRlckRlcGVuZGVuY2llcygpIHtcbiAgdGhpcy5fcmVxdWlyZXNFQyA9IGZhbHNlO1xuICB0aGlzLl9yZXF1aXJlc1dDID0gZmFsc2U7IC8vIGRlcGVuZHMgb24gZXllIGNvb3JkaW5hdGVzLCBuZWVkZWQgZm9yIG1hdGVyaWFsIGFuZCBmb3IgcGhvbmdcbiAgdGhpcy5fcmVxdWlyZXNOb3JtYWxFQyA9IGZhbHNlOyAvLyBkZXBlbmRzIG9uIGV5ZSBjb29yZGluYXRlcywgbmVlZGVkIGZvciBtYXRlcmlhbFxuICB0aGlzLl9yZXF1aXJlc1RleHR1cmVDb29yZGluYXRlcyA9IGZhbHNlOyAvLyBkZXBlbmRzIG9uIHdvcmxkIGNvb3JkaW5hdGVzLCBuZWVkZWQgZm9yIG1hdGVyaWFsIGFuZCBmb3IgY3VsbGluZ1xuXG4gIHRoaXMuX3VzZXNOb3JtYWxFQyA9IGZhbHNlO1xuICB0aGlzLl91c2VzUG9zaXRpb25Ub0V5ZUVDID0gZmFsc2U7XG4gIHRoaXMuX3VzZXNUYW5nZW50VG9FeWVNYXQgPSBmYWxzZTtcbiAgdGhpcy5fdXNlc1N0ID0gZmFsc2U7XG59XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFNoYWRlckRlcGVuZGVuY2llcy5wcm90b3R5cGUsIHtcbiAgLy8gU2V0IHdoZW4gYXNzZXNzaW5nIGZpbmFsIHNoYWRpbmcgKGZsYXQgdnMuIHBob25nKSBhbmQgY3VsbGluZyB1c2luZyBjb21wdXRlZCB0ZXh0dXJlIGNvb3JkaW5hdGVzXG4gIHJlcXVpcmVzRUM6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9yZXF1aXJlc0VDO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHRoaXMuX3JlcXVpcmVzRUMgPSB2YWx1ZSB8fCB0aGlzLl9yZXF1aXJlc0VDO1xuICAgIH0sXG4gIH0sXG4gIHJlcXVpcmVzV0M6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9yZXF1aXJlc1dDO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHRoaXMuX3JlcXVpcmVzV0MgPSB2YWx1ZSB8fCB0aGlzLl9yZXF1aXJlc1dDO1xuICAgICAgdGhpcy5yZXF1aXJlc0VDID0gdGhpcy5fcmVxdWlyZXNXQztcbiAgICB9LFxuICB9LFxuICByZXF1aXJlc05vcm1hbEVDOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcmVxdWlyZXNOb3JtYWxFQztcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICB0aGlzLl9yZXF1aXJlc05vcm1hbEVDID0gdmFsdWUgfHwgdGhpcy5fcmVxdWlyZXNOb3JtYWxFQztcbiAgICAgIHRoaXMucmVxdWlyZXNFQyA9IHRoaXMuX3JlcXVpcmVzTm9ybWFsRUM7XG4gICAgfSxcbiAgfSxcbiAgcmVxdWlyZXNUZXh0dXJlQ29vcmRpbmF0ZXM6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9yZXF1aXJlc1RleHR1cmVDb29yZGluYXRlcztcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICB0aGlzLl9yZXF1aXJlc1RleHR1cmVDb29yZGluYXRlcyA9XG4gICAgICAgIHZhbHVlIHx8IHRoaXMuX3JlcXVpcmVzVGV4dHVyZUNvb3JkaW5hdGVzO1xuICAgICAgdGhpcy5yZXF1aXJlc1dDID0gdGhpcy5fcmVxdWlyZXNUZXh0dXJlQ29vcmRpbmF0ZXM7XG4gICAgfSxcbiAgfSxcbiAgLy8gR2V0L1NldCB3aGVuIGFzc2Vzc2luZyBtYXRlcmlhbCBob29rdXBzXG4gIG5vcm1hbEVDOiB7XG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHRoaXMucmVxdWlyZXNOb3JtYWxFQyA9IHZhbHVlO1xuICAgICAgdGhpcy5fdXNlc05vcm1hbEVDID0gdmFsdWU7XG4gICAgfSxcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl91c2VzTm9ybWFsRUM7XG4gICAgfSxcbiAgfSxcbiAgdGFuZ2VudFRvRXllTWF0cml4OiB7XG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHRoaXMucmVxdWlyZXNXQyA9IHZhbHVlO1xuICAgICAgdGhpcy5yZXF1aXJlc05vcm1hbEVDID0gdmFsdWU7XG4gICAgICB0aGlzLl91c2VzVGFuZ2VudFRvRXllTWF0ID0gdmFsdWU7XG4gICAgfSxcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl91c2VzVGFuZ2VudFRvRXllTWF0O1xuICAgIH0sXG4gIH0sXG4gIHBvc2l0aW9uVG9FeWVFQzoge1xuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICB0aGlzLnJlcXVpcmVzRUMgPSB2YWx1ZTtcbiAgICAgIHRoaXMuX3VzZXNQb3NpdGlvblRvRXllRUMgPSB2YWx1ZTtcbiAgICB9LFxuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3VzZXNQb3NpdGlvblRvRXllRUM7XG4gICAgfSxcbiAgfSxcbiAgc3Q6IHtcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgdGhpcy5yZXF1aXJlc1RleHR1cmVDb29yZGluYXRlcyA9IHZhbHVlO1xuICAgICAgdGhpcy5fdXNlc1N0ID0gdmFsdWU7XG4gICAgfSxcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl91c2VzU3Q7XG4gICAgfSxcbiAgfSxcbn0pO1xuXG5mdW5jdGlvbiBwb2ludExpbmVEaXN0YW5jZShwb2ludDEsIHBvaW50MiwgcG9pbnQpIHtcbiAgcmV0dXJuIChcbiAgICBNYXRoLmFicyhcbiAgICAgIChwb2ludDIueSAtIHBvaW50MS55KSAqIHBvaW50LnggLVxuICAgICAgICAocG9pbnQyLnggLSBwb2ludDEueCkgKiBwb2ludC55ICtcbiAgICAgICAgcG9pbnQyLnggKiBwb2ludDEueSAtXG4gICAgICAgIHBvaW50Mi55ICogcG9pbnQxLnhcbiAgICApIC8gQ2FydGVzaWFuMi5kaXN0YW5jZShwb2ludDIsIHBvaW50MSlcbiAgKTtcbn1cblxudmFyIHBvaW50czJEU2NyYXRjaCA9IFtcbiAgbmV3IENhcnRlc2lhbjIoKSxcbiAgbmV3IENhcnRlc2lhbjIoKSxcbiAgbmV3IENhcnRlc2lhbjIoKSxcbiAgbmV3IENhcnRlc2lhbjIoKSxcbl07XG5cbi8vIHRleHR1cmVDb29yZGluYXRlUm90YXRpb25Qb2ludHMgZm9ybSAyIGxpbmVzIGluIHRoZSBjb21wdXRlZCBVViBzcGFjZSB0aGF0IHJlbWFwIHRvIGRlc2lyZWQgdGV4dHVyZSBjb29yZGluYXRlcy5cbi8vIFRoaXMgYWxsb3dzIHNpbXVsYXRpb24gb2YgYmFrZWQgdGV4dHVyZSBjb29yZGluYXRlcyBmb3IgRWxsaXBzZUdlb21ldHJ5LCBSZWN0YW5nbGVHZW9tZXRyeSwgYW5kIFBvbHlnb25HZW9tZXRyeS5cbmZ1bmN0aW9uIGFkZFRleHR1cmVDb29yZGluYXRlUm90YXRpb25BdHRyaWJ1dGVzKFxuICBhdHRyaWJ1dGVzLFxuICB0ZXh0dXJlQ29vcmRpbmF0ZVJvdGF0aW9uUG9pbnRzXG4pIHtcbiAgdmFyIHBvaW50czJEID0gcG9pbnRzMkRTY3JhdGNoO1xuXG4gIHZhciBtaW5YWUNvcm5lciA9IENhcnRlc2lhbjIudW5wYWNrKFxuICAgIHRleHR1cmVDb29yZGluYXRlUm90YXRpb25Qb2ludHMsXG4gICAgMCxcbiAgICBwb2ludHMyRFswXVxuICApO1xuICB2YXIgbWF4WUNvcm5lciA9IENhcnRlc2lhbjIudW5wYWNrKFxuICAgIHRleHR1cmVDb29yZGluYXRlUm90YXRpb25Qb2ludHMsXG4gICAgMixcbiAgICBwb2ludHMyRFsxXVxuICApO1xuICB2YXIgbWF4WENvcm5lciA9IENhcnRlc2lhbjIudW5wYWNrKFxuICAgIHRleHR1cmVDb29yZGluYXRlUm90YXRpb25Qb2ludHMsXG4gICAgNCxcbiAgICBwb2ludHMyRFsyXVxuICApO1xuXG4gIGF0dHJpYnV0ZXMudU1heFZtYXggPSBuZXcgR2VvbWV0cnlJbnN0YW5jZUF0dHJpYnV0ZSh7XG4gICAgY29tcG9uZW50RGF0YXR5cGU6IENvbXBvbmVudERhdGF0eXBlLkZMT0FULFxuICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGU6IDQsXG4gICAgbm9ybWFsaXplOiBmYWxzZSxcbiAgICB2YWx1ZTogW21heFlDb3JuZXIueCwgbWF4WUNvcm5lci55LCBtYXhYQ29ybmVyLngsIG1heFhDb3JuZXIueV0sXG4gIH0pO1xuXG4gIHZhciBpbnZlcnNlRXh0ZW50WCA9XG4gICAgMS4wIC8gcG9pbnRMaW5lRGlzdGFuY2UobWluWFlDb3JuZXIsIG1heFlDb3JuZXIsIG1heFhDb3JuZXIpO1xuICB2YXIgaW52ZXJzZUV4dGVudFkgPVxuICAgIDEuMCAvIHBvaW50TGluZURpc3RhbmNlKG1pblhZQ29ybmVyLCBtYXhYQ29ybmVyLCBtYXhZQ29ybmVyKTtcblxuICBhdHRyaWJ1dGVzLnV2TWluQW5kRXh0ZW50cyA9IG5ldyBHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlKHtcbiAgICBjb21wb25lbnREYXRhdHlwZTogQ29tcG9uZW50RGF0YXR5cGUuRkxPQVQsXG4gICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogNCxcbiAgICBub3JtYWxpemU6IGZhbHNlLFxuICAgIHZhbHVlOiBbbWluWFlDb3JuZXIueCwgbWluWFlDb3JuZXIueSwgaW52ZXJzZUV4dGVudFgsIGludmVyc2VFeHRlbnRZXSxcbiAgfSk7XG59XG5cbnZhciBjYXJ0b2dyYXBoaWNTY3JhdGNoID0gbmV3IENhcnRvZ3JhcGhpYygpO1xudmFyIGNvcm5lclNjcmF0Y2ggPSBuZXcgQ2FydGVzaWFuMygpO1xudmFyIG5vcnRoV2VzdFNjcmF0Y2ggPSBuZXcgQ2FydGVzaWFuMygpO1xudmFyIHNvdXRoRWFzdFNjcmF0Y2ggPSBuZXcgQ2FydGVzaWFuMygpO1xudmFyIGhpZ2hMb3dTY3JhdGNoID0geyBoaWdoOiAwLjAsIGxvdzogMC4wIH07XG5mdW5jdGlvbiBhZGQyRFRleHR1cmVDb29yZGluYXRlQXR0cmlidXRlcyhyZWN0YW5nbGUsIHByb2plY3Rpb24sIGF0dHJpYnV0ZXMpIHtcbiAgLy8gQ29tcHV0ZSBjb3JuZXIgcG9zaXRpb25zIGluIGRvdWJsZSBwcmVjaXNpb25cbiAgdmFyIGNhcnRvID0gY2FydG9ncmFwaGljU2NyYXRjaDtcbiAgY2FydG8uaGVpZ2h0ID0gMC4wO1xuXG4gIGNhcnRvLmxvbmdpdHVkZSA9IHJlY3RhbmdsZS53ZXN0O1xuICBjYXJ0by5sYXRpdHVkZSA9IHJlY3RhbmdsZS5zb3V0aDtcblxuICB2YXIgc291dGhXZXN0Q29ybmVyID0gcHJvamVjdGlvbi5wcm9qZWN0KGNhcnRvLCBjb3JuZXJTY3JhdGNoKTtcblxuICBjYXJ0by5sYXRpdHVkZSA9IHJlY3RhbmdsZS5ub3J0aDtcbiAgdmFyIG5vcnRoV2VzdCA9IHByb2plY3Rpb24ucHJvamVjdChjYXJ0bywgbm9ydGhXZXN0U2NyYXRjaCk7XG5cbiAgY2FydG8ubG9uZ2l0dWRlID0gcmVjdGFuZ2xlLmVhc3Q7XG4gIGNhcnRvLmxhdGl0dWRlID0gcmVjdGFuZ2xlLnNvdXRoO1xuICB2YXIgc291dGhFYXN0ID0gcHJvamVjdGlvbi5wcm9qZWN0KGNhcnRvLCBzb3V0aEVhc3RTY3JhdGNoKTtcblxuICAvLyBTaW5jZSB0aGVzZSBwb3NpdGlvbnMgYXJlIGFsbCBpbiB0aGUgMkQgcGxhbmUsIHRoZXJlJ3MgYSBsb3Qgb2YgemVyb3NcbiAgLy8gYW5kIGEgbG90IG9mIHJlcGV0aXRpb24uIFNvIHdlIG9ubHkgbmVlZCB0byBlbmNvZGUgNCB2YWx1ZXMuXG4gIC8vIEVuY29kZTpcbiAgLy8geDogeCB2YWx1ZSBmb3Igc291dGhXZXN0Q29ybmVyXG4gIC8vIHk6IHkgdmFsdWUgZm9yIHNvdXRoV2VzdENvcm5lclxuICAvLyB6OiB5IHZhbHVlIGZvciBub3J0aFdlc3RcbiAgLy8gdzogeCB2YWx1ZSBmb3Igc291dGhFYXN0XG5cbiAgdmFyIHZhbHVlc0hpZ2ggPSBbMCwgMCwgMCwgMF07XG4gIHZhciB2YWx1ZXNMb3cgPSBbMCwgMCwgMCwgMF07XG4gIHZhciBlbmNvZGVkID0gRW5jb2RlZENhcnRlc2lhbjMuZW5jb2RlKHNvdXRoV2VzdENvcm5lci54LCBoaWdoTG93U2NyYXRjaCk7XG4gIHZhbHVlc0hpZ2hbMF0gPSBlbmNvZGVkLmhpZ2g7XG4gIHZhbHVlc0xvd1swXSA9IGVuY29kZWQubG93O1xuXG4gIGVuY29kZWQgPSBFbmNvZGVkQ2FydGVzaWFuMy5lbmNvZGUoc291dGhXZXN0Q29ybmVyLnksIGhpZ2hMb3dTY3JhdGNoKTtcbiAgdmFsdWVzSGlnaFsxXSA9IGVuY29kZWQuaGlnaDtcbiAgdmFsdWVzTG93WzFdID0gZW5jb2RlZC5sb3c7XG5cbiAgZW5jb2RlZCA9IEVuY29kZWRDYXJ0ZXNpYW4zLmVuY29kZShub3J0aFdlc3QueSwgaGlnaExvd1NjcmF0Y2gpO1xuICB2YWx1ZXNIaWdoWzJdID0gZW5jb2RlZC5oaWdoO1xuICB2YWx1ZXNMb3dbMl0gPSBlbmNvZGVkLmxvdztcblxuICBlbmNvZGVkID0gRW5jb2RlZENhcnRlc2lhbjMuZW5jb2RlKHNvdXRoRWFzdC54LCBoaWdoTG93U2NyYXRjaCk7XG4gIHZhbHVlc0hpZ2hbM10gPSBlbmNvZGVkLmhpZ2g7XG4gIHZhbHVlc0xvd1szXSA9IGVuY29kZWQubG93O1xuXG4gIGF0dHJpYnV0ZXMucGxhbmVzMkRfSElHSCA9IG5ldyBHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlKHtcbiAgICBjb21wb25lbnREYXRhdHlwZTogQ29tcG9uZW50RGF0YXR5cGUuRkxPQVQsXG4gICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogNCxcbiAgICBub3JtYWxpemU6IGZhbHNlLFxuICAgIHZhbHVlOiB2YWx1ZXNIaWdoLFxuICB9KTtcblxuICBhdHRyaWJ1dGVzLnBsYW5lczJEX0xPVyA9IG5ldyBHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlKHtcbiAgICBjb21wb25lbnREYXRhdHlwZTogQ29tcG9uZW50RGF0YXR5cGUuRkxPQVQsXG4gICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogNCxcbiAgICBub3JtYWxpemU6IGZhbHNlLFxuICAgIHZhbHVlOiB2YWx1ZXNMb3csXG4gIH0pO1xufVxuXG52YXIgZW51TWF0cml4U2NyYXRjaCA9IG5ldyBNYXRyaXg0KCk7XG52YXIgaW52ZXJzZUVudVNjcmF0Y2ggPSBuZXcgTWF0cml4NCgpO1xudmFyIHJlY3RhbmdsZVBvaW50Q2FydGVzaWFuU2NyYXRjaCA9IG5ldyBDYXJ0ZXNpYW4zKCk7XG52YXIgcmVjdGFuZ2xlQ2VudGVyU2NyYXRjaCA9IG5ldyBDYXJ0b2dyYXBoaWMoKTtcbnZhciBwb2ludHNDYXJ0b2dyYXBoaWNTY3JhdGNoID0gW1xuICBuZXcgQ2FydG9ncmFwaGljKCksXG4gIG5ldyBDYXJ0b2dyYXBoaWMoKSxcbiAgbmV3IENhcnRvZ3JhcGhpYygpLFxuICBuZXcgQ2FydG9ncmFwaGljKCksXG4gIG5ldyBDYXJ0b2dyYXBoaWMoKSxcbiAgbmV3IENhcnRvZ3JhcGhpYygpLFxuICBuZXcgQ2FydG9ncmFwaGljKCksXG4gIG5ldyBDYXJ0b2dyYXBoaWMoKSxcbl07XG4vKipcbiAqIFdoZW4gY29tcHV0aW5nIHBsYW5lcyB0byBib3VuZCB0aGUgcmVjdGFuZ2xlLFxuICogbmVlZCB0byBmYWN0b3IgaW4gXCJidWxnZVwiIGFuZCBvdGhlciBkaXN0b3J0aW9uLlxuICogRmxhdHRlbiB0aGUgZWxsaXBzb2lkLWNlbnRlcmVkIGNvcm5lcnMgYW5kIGVkZ2UtY2VudGVycyBvZiB0aGUgcmVjdGFuZ2xlXG4gKiBpbnRvIHRoZSBwbGFuZSBvZiB0aGUgbG9jYWwgRU5VIHN5c3RlbSwgY29tcHV0ZSBib3VuZHMgaW4gMkQsIGFuZFxuICogcHJvamVjdCBiYWNrIHRvIGVsbGlwc29pZC1jZW50ZXJlZC5cbiAqXG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBjb21wdXRlUmVjdGFuZ2xlQm91bmRzKFxuICByZWN0YW5nbGUsXG4gIGVsbGlwc29pZCxcbiAgaGVpZ2h0LFxuICBzb3V0aFdlc3RDb3JuZXJSZXN1bHQsXG4gIGVhc3RWZWN0b3JSZXN1bHQsXG4gIG5vcnRoVmVjdG9yUmVzdWx0XG4pIHtcbiAgLy8gQ29tcHV0ZSBjZW50ZXIgb2YgcmVjdGFuZ2xlXG4gIHZhciBjZW50ZXJDYXJ0b2dyYXBoaWMgPSBSZWN0YW5nbGUuY2VudGVyKHJlY3RhbmdsZSwgcmVjdGFuZ2xlQ2VudGVyU2NyYXRjaCk7XG4gIGNlbnRlckNhcnRvZ3JhcGhpYy5oZWlnaHQgPSBoZWlnaHQ7XG4gIHZhciBjZW50ZXJDYXJ0ZXNpYW4gPSBDYXJ0b2dyYXBoaWMudG9DYXJ0ZXNpYW4oXG4gICAgY2VudGVyQ2FydG9ncmFwaGljLFxuICAgIGVsbGlwc29pZCxcbiAgICByZWN0YW5nbGVQb2ludENhcnRlc2lhblNjcmF0Y2hcbiAgKTtcbiAgdmFyIGVudU1hdHJpeCA9IFRyYW5zZm9ybXMuZWFzdE5vcnRoVXBUb0ZpeGVkRnJhbWUoXG4gICAgY2VudGVyQ2FydGVzaWFuLFxuICAgIGVsbGlwc29pZCxcbiAgICBlbnVNYXRyaXhTY3JhdGNoXG4gICk7XG4gIHZhciBpbnZlcnNlRW51ID0gTWF0cml4NC5pbnZlcnNlKGVudU1hdHJpeCwgaW52ZXJzZUVudVNjcmF0Y2gpO1xuXG4gIHZhciB3ZXN0ID0gcmVjdGFuZ2xlLndlc3Q7XG4gIHZhciBlYXN0ID0gcmVjdGFuZ2xlLmVhc3Q7XG4gIHZhciBub3J0aCA9IHJlY3RhbmdsZS5ub3J0aDtcbiAgdmFyIHNvdXRoID0gcmVjdGFuZ2xlLnNvdXRoO1xuXG4gIHZhciBjYXJ0b2dyYXBoaWNzID0gcG9pbnRzQ2FydG9ncmFwaGljU2NyYXRjaDtcbiAgY2FydG9ncmFwaGljc1swXS5sYXRpdHVkZSA9IHNvdXRoO1xuICBjYXJ0b2dyYXBoaWNzWzBdLmxvbmdpdHVkZSA9IHdlc3Q7XG4gIGNhcnRvZ3JhcGhpY3NbMV0ubGF0aXR1ZGUgPSBub3J0aDtcbiAgY2FydG9ncmFwaGljc1sxXS5sb25naXR1ZGUgPSB3ZXN0O1xuICBjYXJ0b2dyYXBoaWNzWzJdLmxhdGl0dWRlID0gbm9ydGg7XG4gIGNhcnRvZ3JhcGhpY3NbMl0ubG9uZ2l0dWRlID0gZWFzdDtcbiAgY2FydG9ncmFwaGljc1szXS5sYXRpdHVkZSA9IHNvdXRoO1xuICBjYXJ0b2dyYXBoaWNzWzNdLmxvbmdpdHVkZSA9IGVhc3Q7XG5cbiAgdmFyIGxvbmdpdHVkZUNlbnRlciA9ICh3ZXN0ICsgZWFzdCkgKiAwLjU7XG4gIHZhciBsYXRpdHVkZUNlbnRlciA9IChub3J0aCArIHNvdXRoKSAqIDAuNTtcblxuICBjYXJ0b2dyYXBoaWNzWzRdLmxhdGl0dWRlID0gc291dGg7XG4gIGNhcnRvZ3JhcGhpY3NbNF0ubG9uZ2l0dWRlID0gbG9uZ2l0dWRlQ2VudGVyO1xuICBjYXJ0b2dyYXBoaWNzWzVdLmxhdGl0dWRlID0gbm9ydGg7XG4gIGNhcnRvZ3JhcGhpY3NbNV0ubG9uZ2l0dWRlID0gbG9uZ2l0dWRlQ2VudGVyO1xuICBjYXJ0b2dyYXBoaWNzWzZdLmxhdGl0dWRlID0gbGF0aXR1ZGVDZW50ZXI7XG4gIGNhcnRvZ3JhcGhpY3NbNl0ubG9uZ2l0dWRlID0gd2VzdDtcbiAgY2FydG9ncmFwaGljc1s3XS5sYXRpdHVkZSA9IGxhdGl0dWRlQ2VudGVyO1xuICBjYXJ0b2dyYXBoaWNzWzddLmxvbmdpdHVkZSA9IGVhc3Q7XG5cbiAgdmFyIG1pblggPSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFk7XG4gIHZhciBtYXhYID0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZO1xuICB2YXIgbWluWSA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWTtcbiAgdmFyIG1heFkgPSBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFk7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgODsgaSsrKSB7XG4gICAgY2FydG9ncmFwaGljc1tpXS5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgdmFyIHBvaW50Q2FydGVzaWFuID0gQ2FydG9ncmFwaGljLnRvQ2FydGVzaWFuKFxuICAgICAgY2FydG9ncmFwaGljc1tpXSxcbiAgICAgIGVsbGlwc29pZCxcbiAgICAgIHJlY3RhbmdsZVBvaW50Q2FydGVzaWFuU2NyYXRjaFxuICAgICk7XG4gICAgTWF0cml4NC5tdWx0aXBseUJ5UG9pbnQoaW52ZXJzZUVudSwgcG9pbnRDYXJ0ZXNpYW4sIHBvaW50Q2FydGVzaWFuKTtcbiAgICBwb2ludENhcnRlc2lhbi56ID0gMC4wOyAvLyBmbGF0dGVuIGludG8gWFkgcGxhbmUgb2YgRU5VIGNvb3JkaW5hdGUgc3lzdGVtXG4gICAgbWluWCA9IE1hdGgubWluKG1pblgsIHBvaW50Q2FydGVzaWFuLngpO1xuICAgIG1heFggPSBNYXRoLm1heChtYXhYLCBwb2ludENhcnRlc2lhbi54KTtcbiAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgcG9pbnRDYXJ0ZXNpYW4ueSk7XG4gICAgbWF4WSA9IE1hdGgubWF4KG1heFksIHBvaW50Q2FydGVzaWFuLnkpO1xuICB9XG5cbiAgdmFyIHNvdXRoV2VzdENvcm5lciA9IHNvdXRoV2VzdENvcm5lclJlc3VsdDtcbiAgc291dGhXZXN0Q29ybmVyLnggPSBtaW5YO1xuICBzb3V0aFdlc3RDb3JuZXIueSA9IG1pblk7XG4gIHNvdXRoV2VzdENvcm5lci56ID0gMC4wO1xuICBNYXRyaXg0Lm11bHRpcGx5QnlQb2ludChlbnVNYXRyaXgsIHNvdXRoV2VzdENvcm5lciwgc291dGhXZXN0Q29ybmVyKTtcblxuICB2YXIgc291dGhFYXN0Q29ybmVyID0gZWFzdFZlY3RvclJlc3VsdDtcbiAgc291dGhFYXN0Q29ybmVyLnggPSBtYXhYO1xuICBzb3V0aEVhc3RDb3JuZXIueSA9IG1pblk7XG4gIHNvdXRoRWFzdENvcm5lci56ID0gMC4wO1xuICBNYXRyaXg0Lm11bHRpcGx5QnlQb2ludChlbnVNYXRyaXgsIHNvdXRoRWFzdENvcm5lciwgc291dGhFYXN0Q29ybmVyKTtcbiAgLy8gbWFrZSBlYXN0d2FyZCB2ZWN0b3JcbiAgQ2FydGVzaWFuMy5zdWJ0cmFjdChzb3V0aEVhc3RDb3JuZXIsIHNvdXRoV2VzdENvcm5lciwgZWFzdFZlY3RvclJlc3VsdCk7XG5cbiAgdmFyIG5vcnRoV2VzdENvcm5lciA9IG5vcnRoVmVjdG9yUmVzdWx0O1xuICBub3J0aFdlc3RDb3JuZXIueCA9IG1pblg7XG4gIG5vcnRoV2VzdENvcm5lci55ID0gbWF4WTtcbiAgbm9ydGhXZXN0Q29ybmVyLnogPSAwLjA7XG4gIE1hdHJpeDQubXVsdGlwbHlCeVBvaW50KGVudU1hdHJpeCwgbm9ydGhXZXN0Q29ybmVyLCBub3J0aFdlc3RDb3JuZXIpO1xuICAvLyBtYWtlIGVhc3R3YXJkIHZlY3RvclxuICBDYXJ0ZXNpYW4zLnN1YnRyYWN0KG5vcnRoV2VzdENvcm5lciwgc291dGhXZXN0Q29ybmVyLCBub3J0aFZlY3RvclJlc3VsdCk7XG59XG5cbnZhciBlYXN0d2FyZFNjcmF0Y2ggPSBuZXcgQ2FydGVzaWFuMygpO1xudmFyIG5vcnRod2FyZFNjcmF0Y2ggPSBuZXcgQ2FydGVzaWFuMygpO1xudmFyIGVuY29kZVNjcmF0Y2ggPSBuZXcgRW5jb2RlZENhcnRlc2lhbjMoKTtcbi8qKlxuICogR2V0cyBhbiBhdHRyaWJ1dGVzIG9iamVjdCBjb250YWluaW5nOlxuICogLSAzIGhpZ2gtcHJlY2lzaW9uIHBvaW50cyBhcyA2IEdlb21ldHJ5SW5zdGFuY2VBdHRyaWJ1dGVzLiBUaGVzZSBwb2ludHMgYXJlIHVzZWQgdG8gY29tcHV0ZSBleWUtc3BhY2UgcGxhbmVzLlxuICogLSAxIHRleHR1cmUgY29vcmRpbmF0ZSByb3RhdGlvbiBHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlc1xuICogLSAyIEdlb21ldHJ5SW5zdGFuY2VBdHRyaWJ1dGVzIHVzZWQgdG8gY29tcHV0ZSBoaWdoLXByZWNpc2lvbiBwb2ludHMgaW4gMkQgYW5kIENvbHVtYnVzIFZpZXcuXG4gKiAgIFRoZXNlIHBvaW50cyBhcmUgdXNlZCB0byBjb21wdXRlIGV5ZS1zcGFjZSBwbGFuZXMgbGlrZSBhYm92ZS5cbiAqXG4gKiBVc2VkIHRvIGNvbXB1dGUgdGV4dHVyZSBjb29yZGluYXRlcyBmb3Igc21hbGwtYXJlYSBDbGFzc2lmaWNhdGlvblByaW1pdGl2ZXMgd2l0aCBtYXRlcmlhbHMgb3IgbXVsdGlwbGUgbm9uLW92ZXJsYXBwaW5nIGluc3RhbmNlcy5cbiAqXG4gKiBAc2VlIFNoYWRvd1ZvbHVtZUFwcGVhcmFuY2VcbiAqIEBwcml2YXRlXG4gKlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IGJvdW5kaW5nUmVjdGFuZ2xlIFJlY3RhbmdsZSBvYmplY3QgdGhhdCB0aGUgcG9pbnRzIHdpbGwgYXBwcm94aW1hdGVseSBib3VuZFxuICogQHBhcmFtIHtOdW1iZXJbXX0gdGV4dHVyZUNvb3JkaW5hdGVSb3RhdGlvblBvaW50cyBQb2ludHMgaW4gdGhlIGNvbXB1dGVkIHRleHR1cmUgY29vcmRpbmF0ZSBzeXN0ZW0gZm9yIHJlbWFwcGluZyB0ZXh0dXJlIGNvb3JkaW5hdGVzXG4gKiBAcGFyYW0ge0VsbGlwc29pZH0gZWxsaXBzb2lkIEVsbGlwc29pZCBmb3IgY29udmVydGluZyBSZWN0YW5nbGUgcG9pbnRzIHRvIHdvcmxkIGNvb3JkaW5hdGVzXG4gKiBAcGFyYW0ge01hcFByb2plY3Rpb259IHByb2plY3Rpb24gVGhlIE1hcFByb2plY3Rpb24gdXNlZCBmb3IgMkQgYW5kIENvbHVtYnVzIFZpZXcuXG4gKiBAcGFyYW0ge051bWJlcn0gW2hlaWdodD0wXSBUaGUgbWF4aW11bSBoZWlnaHQgZm9yIHRoZSBzaGFkb3cgdm9sdW1lLlxuICogQHJldHVybnMge09iamVjdH0gQW4gYXR0cmlidXRlcyBkaWN0aW9uYXJ5IGNvbnRhaW5pbmcgcGxhbmFyIHRleHR1cmUgY29vcmRpbmF0ZSBhdHRyaWJ1dGVzLlxuICovXG5TaGFkb3dWb2x1bWVBcHBlYXJhbmNlLmdldFBsYW5hclRleHR1cmVDb29yZGluYXRlQXR0cmlidXRlcyA9IGZ1bmN0aW9uIChcbiAgYm91bmRpbmdSZWN0YW5nbGUsXG4gIHRleHR1cmVDb29yZGluYXRlUm90YXRpb25Qb2ludHMsXG4gIGVsbGlwc29pZCxcbiAgcHJvamVjdGlvbixcbiAgaGVpZ2h0XG4pIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcImJvdW5kaW5nUmVjdGFuZ2xlXCIsIGJvdW5kaW5nUmVjdGFuZ2xlKTtcbiAgQ2hlY2suZGVmaW5lZChcbiAgICBcInRleHR1cmVDb29yZGluYXRlUm90YXRpb25Qb2ludHNcIixcbiAgICB0ZXh0dXJlQ29vcmRpbmF0ZVJvdGF0aW9uUG9pbnRzXG4gICk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJlbGxpcHNvaWRcIiwgZWxsaXBzb2lkKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcInByb2plY3Rpb25cIiwgcHJvamVjdGlvbik7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIHZhciBjb3JuZXIgPSBjb3JuZXJTY3JhdGNoO1xuICB2YXIgZWFzdHdhcmQgPSBlYXN0d2FyZFNjcmF0Y2g7XG4gIHZhciBub3J0aHdhcmQgPSBub3J0aHdhcmRTY3JhdGNoO1xuICBjb21wdXRlUmVjdGFuZ2xlQm91bmRzKFxuICAgIGJvdW5kaW5nUmVjdGFuZ2xlLFxuICAgIGVsbGlwc29pZCxcbiAgICBkZWZhdWx0VmFsdWUoaGVpZ2h0LCAwLjApLFxuICAgIGNvcm5lcixcbiAgICBlYXN0d2FyZCxcbiAgICBub3J0aHdhcmRcbiAgKTtcblxuICB2YXIgYXR0cmlidXRlcyA9IHt9O1xuICBhZGRUZXh0dXJlQ29vcmRpbmF0ZVJvdGF0aW9uQXR0cmlidXRlcyhcbiAgICBhdHRyaWJ1dGVzLFxuICAgIHRleHR1cmVDb29yZGluYXRlUm90YXRpb25Qb2ludHNcbiAgKTtcblxuICB2YXIgZW5jb2RlZCA9IEVuY29kZWRDYXJ0ZXNpYW4zLmZyb21DYXJ0ZXNpYW4oY29ybmVyLCBlbmNvZGVTY3JhdGNoKTtcblxuICBhdHRyaWJ1dGVzLnNvdXRoV2VzdF9ISUdIID0gbmV3IEdlb21ldHJ5SW5zdGFuY2VBdHRyaWJ1dGUoe1xuICAgIGNvbXBvbmVudERhdGF0eXBlOiBDb21wb25lbnREYXRhdHlwZS5GTE9BVCxcbiAgICBjb21wb25lbnRzUGVyQXR0cmlidXRlOiAzLFxuICAgIG5vcm1hbGl6ZTogZmFsc2UsXG4gICAgdmFsdWU6IENhcnRlc2lhbjMucGFjayhlbmNvZGVkLmhpZ2gsIFswLCAwLCAwXSksXG4gIH0pO1xuICBhdHRyaWJ1dGVzLnNvdXRoV2VzdF9MT1cgPSBuZXcgR2VvbWV0cnlJbnN0YW5jZUF0dHJpYnV0ZSh7XG4gICAgY29tcG9uZW50RGF0YXR5cGU6IENvbXBvbmVudERhdGF0eXBlLkZMT0FULFxuICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGU6IDMsXG4gICAgbm9ybWFsaXplOiBmYWxzZSxcbiAgICB2YWx1ZTogQ2FydGVzaWFuMy5wYWNrKGVuY29kZWQubG93LCBbMCwgMCwgMF0pLFxuICB9KTtcbiAgYXR0cmlidXRlcy5lYXN0d2FyZCA9IG5ldyBHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlKHtcbiAgICBjb21wb25lbnREYXRhdHlwZTogQ29tcG9uZW50RGF0YXR5cGUuRkxPQVQsXG4gICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogMyxcbiAgICBub3JtYWxpemU6IGZhbHNlLFxuICAgIHZhbHVlOiBDYXJ0ZXNpYW4zLnBhY2soZWFzdHdhcmQsIFswLCAwLCAwXSksXG4gIH0pO1xuICBhdHRyaWJ1dGVzLm5vcnRod2FyZCA9IG5ldyBHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlKHtcbiAgICBjb21wb25lbnREYXRhdHlwZTogQ29tcG9uZW50RGF0YXR5cGUuRkxPQVQsXG4gICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogMyxcbiAgICBub3JtYWxpemU6IGZhbHNlLFxuICAgIHZhbHVlOiBDYXJ0ZXNpYW4zLnBhY2sobm9ydGh3YXJkLCBbMCwgMCwgMF0pLFxuICB9KTtcblxuICBhZGQyRFRleHR1cmVDb29yZGluYXRlQXR0cmlidXRlcyhib3VuZGluZ1JlY3RhbmdsZSwgcHJvamVjdGlvbiwgYXR0cmlidXRlcyk7XG4gIHJldHVybiBhdHRyaWJ1dGVzO1xufTtcblxudmFyIHNwaGVyZVBvaW50U2NyYXRjaCA9IG5ldyBDYXJ0ZXNpYW4zKCk7XG5mdW5jdGlvbiBsYXRMb25nVG9TcGhlcmljYWwobGF0aXR1ZGUsIGxvbmdpdHVkZSwgZWxsaXBzb2lkLCByZXN1bHQpIHtcbiAgdmFyIGNhcnRvZ3JhcGhpYyA9IGNhcnRvZ3JhcGhpY1NjcmF0Y2g7XG4gIGNhcnRvZ3JhcGhpYy5sYXRpdHVkZSA9IGxhdGl0dWRlO1xuICBjYXJ0b2dyYXBoaWMubG9uZ2l0dWRlID0gbG9uZ2l0dWRlO1xuICBjYXJ0b2dyYXBoaWMuaGVpZ2h0ID0gMC4wO1xuXG4gIHZhciBzcGhlcmVQb2ludCA9IENhcnRvZ3JhcGhpYy50b0NhcnRlc2lhbihcbiAgICBjYXJ0b2dyYXBoaWMsXG4gICAgZWxsaXBzb2lkLFxuICAgIHNwaGVyZVBvaW50U2NyYXRjaFxuICApO1xuXG4gIC8vIFByb2plY3QgaW50byBwbGFuZSB3aXRoIHZlcnRpY2FsIGZvciBsYXRpdHVkZVxuICB2YXIgbWFnWFkgPSBNYXRoLnNxcnQoXG4gICAgc3BoZXJlUG9pbnQueCAqIHNwaGVyZVBvaW50LnggKyBzcGhlcmVQb2ludC55ICogc3BoZXJlUG9pbnQueVxuICApO1xuXG4gIC8vIFVzZSBmYXN0QXBwcm94aW1hdGVBdGFuMiBmb3IgYWxpZ25tZW50IHdpdGggc2hhZGVyXG4gIHZhciBzcGhlcmVMYXRpdHVkZSA9IENlc2l1bU1hdGguZmFzdEFwcHJveGltYXRlQXRhbjIobWFnWFksIHNwaGVyZVBvaW50LnopO1xuICB2YXIgc3BoZXJlTG9uZ2l0dWRlID0gQ2VzaXVtTWF0aC5mYXN0QXBwcm94aW1hdGVBdGFuMihcbiAgICBzcGhlcmVQb2ludC54LFxuICAgIHNwaGVyZVBvaW50LnlcbiAgKTtcblxuICByZXN1bHQueCA9IHNwaGVyZUxhdGl0dWRlO1xuICByZXN1bHQueSA9IHNwaGVyZUxvbmdpdHVkZTtcblxuICByZXR1cm4gcmVzdWx0O1xufVxuXG52YXIgc3BoZXJpY2FsU2NyYXRjaCA9IG5ldyBDYXJ0ZXNpYW4yKCk7XG4vKipcbiAqIEdldHMgYW4gYXR0cmlidXRlcyBvYmplY3QgY29udGFpbmluZzpcbiAqIC0gdGhlIHNvdXRod2VzdCBjb3JuZXIgb2YgYSByZWN0YW5ndWxhciBhcmVhIGluIHNwaGVyaWNhbCBjb29yZGluYXRlcywgYXMgd2VsbCBhcyB0aGUgaW52ZXJzZSBvZiB0aGUgbGF0aXR1ZGUvbG9uZ2l0dWRlIHJhbmdlLlxuICogICBUaGVzZSBhcmUgY29tcHV0ZWQgdXNpbmcgdGhlIHNhbWUgYXRhbjIgYXBwcm94aW1hdGlvbiB1c2VkIGluIHRoZSBzaGFkZXIuXG4gKiAtIDEgdGV4dHVyZSBjb29yZGluYXRlIHJvdGF0aW9uIEdlb21ldHJ5SW5zdGFuY2VBdHRyaWJ1dGVzXG4gKiAtIDIgR2VvbWV0cnlJbnN0YW5jZUF0dHJpYnV0ZXMgdXNlZCB0byBjb21wdXRlIGhpZ2gtcHJlY2lzaW9uIHBvaW50cyBpbiAyRCBhbmQgQ29sdW1idXMgVmlldy5cbiAqICAgVGhlc2UgcG9pbnRzIGFyZSB1c2VkIHRvIGNvbXB1dGUgZXllLXNwYWNlIHBsYW5lcyBsaWtlIGFib3ZlLlxuICpcbiAqIFVzZWQgd2hlbiBjb21wdXRpbmcgdGV4dHVyZSBjb29yZGluYXRlcyBmb3IgbGFyZ2UtYXJlYSBDbGFzc2lmaWNhdGlvblByaW1pdGl2ZXMgd2l0aCBtYXRlcmlhbHMgb3JcbiAqIG11bHRpcGxlIG5vbi1vdmVybGFwcGluZyBpbnN0YW5jZXMuXG4gKiBAc2VlIFNoYWRvd1ZvbHVtZUFwcGVhcmFuY2VcbiAqIEBwcml2YXRlXG4gKlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IGJvdW5kaW5nUmVjdGFuZ2xlIFJlY3RhbmdsZSBvYmplY3QgdGhhdCB0aGUgc3BoZXJpY2FsIGV4dGVudHMgd2lsbCBhcHByb3hpbWF0ZWx5IGJvdW5kXG4gKiBAcGFyYW0ge051bWJlcltdfSB0ZXh0dXJlQ29vcmRpbmF0ZVJvdGF0aW9uUG9pbnRzIFBvaW50cyBpbiB0aGUgY29tcHV0ZWQgdGV4dHVyZSBjb29yZGluYXRlIHN5c3RlbSBmb3IgcmVtYXBwaW5nIHRleHR1cmUgY29vcmRpbmF0ZXNcbiAqIEBwYXJhbSB7RWxsaXBzb2lkfSBlbGxpcHNvaWQgRWxsaXBzb2lkIGZvciBjb252ZXJ0aW5nIFJlY3RhbmdsZSBwb2ludHMgdG8gd29ybGQgY29vcmRpbmF0ZXNcbiAqIEBwYXJhbSB7TWFwUHJvamVjdGlvbn0gcHJvamVjdGlvbiBUaGUgTWFwUHJvamVjdGlvbiB1c2VkIGZvciAyRCBhbmQgQ29sdW1idXMgVmlldy5cbiAqIEByZXR1cm5zIHtPYmplY3R9IEFuIGF0dHJpYnV0ZXMgZGljdGlvbmFyeSBjb250YWluaW5nIHNwaGVyaWNhbCB0ZXh0dXJlIGNvb3JkaW5hdGUgYXR0cmlidXRlcy5cbiAqL1xuU2hhZG93Vm9sdW1lQXBwZWFyYW5jZS5nZXRTcGhlcmljYWxFeHRlbnRHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlcyA9IGZ1bmN0aW9uIChcbiAgYm91bmRpbmdSZWN0YW5nbGUsXG4gIHRleHR1cmVDb29yZGluYXRlUm90YXRpb25Qb2ludHMsXG4gIGVsbGlwc29pZCxcbiAgcHJvamVjdGlvblxuKSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJib3VuZGluZ1JlY3RhbmdsZVwiLCBib3VuZGluZ1JlY3RhbmdsZSk7XG4gIENoZWNrLmRlZmluZWQoXG4gICAgXCJ0ZXh0dXJlQ29vcmRpbmF0ZVJvdGF0aW9uUG9pbnRzXCIsXG4gICAgdGV4dHVyZUNvb3JkaW5hdGVSb3RhdGlvblBvaW50c1xuICApO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwiZWxsaXBzb2lkXCIsIGVsbGlwc29pZCk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJwcm9qZWN0aW9uXCIsIHByb2plY3Rpb24pO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICAvLyByZWN0YW5nbGUgY2FydG9ncmFwaGljIGNvb3JkcyAhPT0gc3BoZXJpY2FsIGJlY2F1c2UgaXQncyBvbiBhbiBlbGxpcHNvaWRcbiAgdmFyIHNvdXRoV2VzdEV4dGVudHMgPSBsYXRMb25nVG9TcGhlcmljYWwoXG4gICAgYm91bmRpbmdSZWN0YW5nbGUuc291dGgsXG4gICAgYm91bmRpbmdSZWN0YW5nbGUud2VzdCxcbiAgICBlbGxpcHNvaWQsXG4gICAgc3BoZXJpY2FsU2NyYXRjaFxuICApO1xuXG4gIHZhciBzb3V0aCA9IHNvdXRoV2VzdEV4dGVudHMueDtcbiAgdmFyIHdlc3QgPSBzb3V0aFdlc3RFeHRlbnRzLnk7XG5cbiAgdmFyIG5vcnRoRWFzdEV4dGVudHMgPSBsYXRMb25nVG9TcGhlcmljYWwoXG4gICAgYm91bmRpbmdSZWN0YW5nbGUubm9ydGgsXG4gICAgYm91bmRpbmdSZWN0YW5nbGUuZWFzdCxcbiAgICBlbGxpcHNvaWQsXG4gICAgc3BoZXJpY2FsU2NyYXRjaFxuICApO1xuICB2YXIgbm9ydGggPSBub3J0aEVhc3RFeHRlbnRzLng7XG4gIHZhciBlYXN0ID0gbm9ydGhFYXN0RXh0ZW50cy55O1xuXG4gIC8vIElmIHRoZSBib3VuZGluZyByZWN0YW5nbGUgY3Jvc3NlcyB0aGUgSURMLCByb3RhdGUgdGhlIHNwaGVyaWNhbCBleHRlbnRzIHNvIHRoZSBjcm9zcyBubyBsb25nZXIgaGFwcGVucy5cbiAgLy8gVGhpcyByb3RhdGlvbiBtdXN0IGhhcHBlbiBpbiB0aGUgc2hhZGVyIHRvby5cbiAgdmFyIHJvdGF0aW9uUmFkaWFucyA9IDAuMDtcbiAgaWYgKHdlc3QgPiBlYXN0KSB7XG4gICAgcm90YXRpb25SYWRpYW5zID0gQ2VzaXVtTWF0aC5QSSAtIHdlc3Q7XG4gICAgd2VzdCA9IC1DZXNpdW1NYXRoLlBJO1xuICAgIGVhc3QgKz0gcm90YXRpb25SYWRpYW5zO1xuICB9XG5cbiAgLy8gU2xpZ2h0bHkgcGFkIGV4dGVudHMgdG8gYXZvaWQgZmxvYXRpbmcgcG9pbnQgZXJyb3Igd2hlbiBmcmFnbWVudCBjdWxsaW5nIGF0IGVkZ2VzLlxuICBzb3V0aCAtPSBDZXNpdW1NYXRoLkVQU0lMT041O1xuICB3ZXN0IC09IENlc2l1bU1hdGguRVBTSUxPTjU7XG4gIG5vcnRoICs9IENlc2l1bU1hdGguRVBTSUxPTjU7XG4gIGVhc3QgKz0gQ2VzaXVtTWF0aC5FUFNJTE9ONTtcblxuICB2YXIgbG9uZ2l0dWRlUmFuZ2VJbnZlcnNlID0gMS4wIC8gKGVhc3QgLSB3ZXN0KTtcbiAgdmFyIGxhdGl0dWRlUmFuZ2VJbnZlcnNlID0gMS4wIC8gKG5vcnRoIC0gc291dGgpO1xuXG4gIHZhciBhdHRyaWJ1dGVzID0ge1xuICAgIHNwaGVyaWNhbEV4dGVudHM6IG5ldyBHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlKHtcbiAgICAgIGNvbXBvbmVudERhdGF0eXBlOiBDb21wb25lbnREYXRhdHlwZS5GTE9BVCxcbiAgICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGU6IDQsXG4gICAgICBub3JtYWxpemU6IGZhbHNlLFxuICAgICAgdmFsdWU6IFtzb3V0aCwgd2VzdCwgbGF0aXR1ZGVSYW5nZUludmVyc2UsIGxvbmdpdHVkZVJhbmdlSW52ZXJzZV0sXG4gICAgfSksXG4gICAgbG9uZ2l0dWRlUm90YXRpb246IG5ldyBHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlKHtcbiAgICAgIGNvbXBvbmVudERhdGF0eXBlOiBDb21wb25lbnREYXRhdHlwZS5GTE9BVCxcbiAgICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGU6IDEsXG4gICAgICBub3JtYWxpemU6IGZhbHNlLFxuICAgICAgdmFsdWU6IFtyb3RhdGlvblJhZGlhbnNdLFxuICAgIH0pLFxuICB9O1xuXG4gIGFkZFRleHR1cmVDb29yZGluYXRlUm90YXRpb25BdHRyaWJ1dGVzKFxuICAgIGF0dHJpYnV0ZXMsXG4gICAgdGV4dHVyZUNvb3JkaW5hdGVSb3RhdGlvblBvaW50c1xuICApO1xuICBhZGQyRFRleHR1cmVDb29yZGluYXRlQXR0cmlidXRlcyhib3VuZGluZ1JlY3RhbmdsZSwgcHJvamVjdGlvbiwgYXR0cmlidXRlcyk7XG4gIHJldHVybiBhdHRyaWJ1dGVzO1xufTtcblxuU2hhZG93Vm9sdW1lQXBwZWFyYW5jZS5oYXNBdHRyaWJ1dGVzRm9yVGV4dHVyZUNvb3JkaW5hdGVQbGFuZXMgPSBmdW5jdGlvbiAoXG4gIGF0dHJpYnV0ZXNcbikge1xuICByZXR1cm4gKFxuICAgIGRlZmluZWQoYXR0cmlidXRlcy5zb3V0aFdlc3RfSElHSCkgJiZcbiAgICBkZWZpbmVkKGF0dHJpYnV0ZXMuc291dGhXZXN0X0xPVykgJiZcbiAgICBkZWZpbmVkKGF0dHJpYnV0ZXMubm9ydGh3YXJkKSAmJlxuICAgIGRlZmluZWQoYXR0cmlidXRlcy5lYXN0d2FyZCkgJiZcbiAgICBkZWZpbmVkKGF0dHJpYnV0ZXMucGxhbmVzMkRfSElHSCkgJiZcbiAgICBkZWZpbmVkKGF0dHJpYnV0ZXMucGxhbmVzMkRfTE9XKSAmJlxuICAgIGRlZmluZWQoYXR0cmlidXRlcy51TWF4Vm1heCkgJiZcbiAgICBkZWZpbmVkKGF0dHJpYnV0ZXMudXZNaW5BbmRFeHRlbnRzKVxuICApO1xufTtcblxuU2hhZG93Vm9sdW1lQXBwZWFyYW5jZS5oYXNBdHRyaWJ1dGVzRm9yU3BoZXJpY2FsRXh0ZW50cyA9IGZ1bmN0aW9uIChcbiAgYXR0cmlidXRlc1xuKSB7XG4gIHJldHVybiAoXG4gICAgZGVmaW5lZChhdHRyaWJ1dGVzLnNwaGVyaWNhbEV4dGVudHMpICYmXG4gICAgZGVmaW5lZChhdHRyaWJ1dGVzLmxvbmdpdHVkZVJvdGF0aW9uKSAmJlxuICAgIGRlZmluZWQoYXR0cmlidXRlcy5wbGFuZXMyRF9ISUdIKSAmJlxuICAgIGRlZmluZWQoYXR0cmlidXRlcy5wbGFuZXMyRF9MT1cpICYmXG4gICAgZGVmaW5lZChhdHRyaWJ1dGVzLnVNYXhWbWF4KSAmJlxuICAgIGRlZmluZWQoYXR0cmlidXRlcy51dk1pbkFuZEV4dGVudHMpXG4gICk7XG59O1xuXG5mdW5jdGlvbiBzaG91bGRVc2VTcGhlcmljYWwocmVjdGFuZ2xlKSB7XG4gIHJldHVybiAoXG4gICAgTWF0aC5tYXgocmVjdGFuZ2xlLndpZHRoLCByZWN0YW5nbGUuaGVpZ2h0KSA+XG4gICAgU2hhZG93Vm9sdW1lQXBwZWFyYW5jZS5NQVhfV0lEVEhfRk9SX1BMQU5BUl9FWFRFTlRTXG4gICk7XG59XG5cbi8qKlxuICogQ29tcHV0ZXMgd2hldGhlciB0aGUgZ2l2ZW4gcmVjdGFuZ2xlIGlzIHdpZGUgZW5vdWdoIHRoYXQgdGV4dHVyZSBjb29yZGluYXRlc1xuICogb3ZlciBpdHMgYXJlYSBzaG91bGQgYmUgY29tcHV0ZWQgdXNpbmcgc3BoZXJpY2FsIGV4dGVudHMgaW5zdGVhZCBvZiBkaXN0YW5jZSB0byBwbGFuZXMuXG4gKlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IHJlY3RhbmdsZSBBIHJlY3RhbmdsZVxuICogQHByaXZhdGVcbiAqL1xuU2hhZG93Vm9sdW1lQXBwZWFyYW5jZS5zaG91bGRVc2VTcGhlcmljYWxDb29yZGluYXRlcyA9IGZ1bmN0aW9uIChyZWN0YW5nbGUpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcInJlY3RhbmdsZVwiLCByZWN0YW5nbGUpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICByZXR1cm4gc2hvdWxkVXNlU3BoZXJpY2FsKHJlY3RhbmdsZSk7XG59O1xuXG4vKipcbiAqIFRleHR1cmUgY29vcmRpbmF0ZXMgZm9yIGdyb3VuZCBwcmltaXRpdmVzIGFyZSBjb21wdXRlZCBlaXRoZXIgdXNpbmcgc3BoZXJpY2FsIGNvb3JkaW5hdGVzIGZvciBsYXJnZSBhcmVhcyBvclxuICogdXNpbmcgZGlzdGFuY2UgZnJvbSBwbGFuZXMgZm9yIHNtYWxsIGFyZWFzLlxuICpcbiAqIEB0eXBlIHtOdW1iZXJ9XG4gKiBAY29uc3RhbnRcbiAqIEBwcml2YXRlXG4gKi9cblNoYWRvd1ZvbHVtZUFwcGVhcmFuY2UuTUFYX1dJRFRIX0ZPUl9QTEFOQVJfRVhURU5UUyA9IENlc2l1bU1hdGgudG9SYWRpYW5zKDEuMCk7XG5leHBvcnQgZGVmYXVsdCBTaGFkb3dWb2x1bWVBcHBlYXJhbmNlO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///88472\n')},57018:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_Credit_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(52975);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(82982);\n/* harmony import */ var _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12572);\n/* harmony import */ var _Core_Event_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(14459);\n/* harmony import */ var _Core_GeographicTilingScheme_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(71351);\n/* harmony import */ var _Core_Rectangle_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(96190);\n/* harmony import */ var _Core_Resource_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(68985);\n/* harmony import */ var _Core_RuntimeError_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(9407);\n/* harmony import */ var _Core_TileProviderError_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(9121);\n/* harmony import */ var _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(13222);\n/* harmony import */ var _ImageryProvider_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(95451);\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * @typedef {Object} SingleTileImageryProvider.ConstructorOptions\n *\n * Initialization options for the SingleTileImageryProvider constructor\n *\n * @property {Resource|String} url The url for the tile.\n * @property {Rectangle} [rectangle=Rectangle.MAX_VALUE] The rectangle, in radians, covered by the image.\n * @property {Credit|String} [credit] A credit for the data source, which is displayed on the canvas.\n * @property {Ellipsoid} [ellipsoid] The ellipsoid.  If not specified, the WGS84 ellipsoid is used.\n */\n\n/**\n * Provides a single, top-level imagery tile.  The single image is assumed to use a\n * {@link GeographicTilingScheme}.\n *\n * @alias SingleTileImageryProvider\n * @constructor\n *\n * @param {SingleTileImageryProvider.ConstructorOptions} options Object describing initialization options\n *\n * @see ArcGisMapServerImageryProvider\n * @see BingMapsImageryProvider\n * @see GoogleEarthEnterpriseMapsProvider\n * @see OpenStreetMapImageryProvider\n * @see TileMapServiceImageryProvider\n * @see WebMapServiceImageryProvider\n * @see WebMapTileServiceImageryProvider\n * @see UrlTemplateImageryProvider\n */\nfunction SingleTileImageryProvider(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z)(options.url)) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z("options.url is required.");\n  }\n  //>>includeEnd(\'debug\');\n\n  /**\n   * The default alpha blending value of this provider, with 0.0 representing fully transparent and\n   * 1.0 representing fully opaque.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n  this.defaultAlpha = undefined;\n\n  /**\n   * The default alpha blending value on the night side of the globe of this provider, with 0.0 representing fully transparent and\n   * 1.0 representing fully opaque.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n  this.defaultNightAlpha = undefined;\n\n  /**\n   * The default alpha blending value on the day side of the globe of this provider, with 0.0 representing fully transparent and\n   * 1.0 representing fully opaque.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n  this.defaultDayAlpha = undefined;\n\n  /**\n   * The default brightness of this provider.  1.0 uses the unmodified imagery color.  Less than 1.0\n   * makes the imagery darker while greater than 1.0 makes it brighter.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n  this.defaultBrightness = undefined;\n\n  /**\n   * The default contrast of this provider.  1.0 uses the unmodified imagery color.  Less than 1.0 reduces\n   * the contrast while greater than 1.0 increases it.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n  this.defaultContrast = undefined;\n\n  /**\n   * The default hue of this provider in radians. 0.0 uses the unmodified imagery color.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n  this.defaultHue = undefined;\n\n  /**\n   * The default saturation of this provider. 1.0 uses the unmodified imagery color. Less than 1.0 reduces the\n   * saturation while greater than 1.0 increases it.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n  this.defaultSaturation = undefined;\n\n  /**\n   * The default gamma correction to apply to this provider.  1.0 uses the unmodified imagery color.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n  this.defaultGamma = undefined;\n\n  /**\n   * The default texture minification filter to apply to this provider.\n   *\n   * @type {TextureMinificationFilter}\n   * @default undefined\n   */\n  this.defaultMinificationFilter = undefined;\n\n  /**\n   * The default texture magnification filter to apply to this provider.\n   *\n   * @type {TextureMagnificationFilter}\n   * @default undefined\n   */\n  this.defaultMagnificationFilter = undefined;\n\n  var resource = _Core_Resource_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].createIfNeeded */ .Z.createIfNeeded(options.url);\n\n  var rectangle = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(options.rectangle, _Core_Rectangle_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].MAX_VALUE */ .Z.MAX_VALUE);\n  var tilingScheme = new _Core_GeographicTilingScheme_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z({\n    rectangle: rectangle,\n    numberOfLevelZeroTilesX: 1,\n    numberOfLevelZeroTilesY: 1,\n    ellipsoid: options.ellipsoid,\n  });\n  this._tilingScheme = tilingScheme;\n  this._resource = resource;\n  this._image = undefined;\n  this._texture = undefined;\n  this._tileWidth = 0;\n  this._tileHeight = 0;\n\n  this._errorEvent = new _Core_Event_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\n\n  this._ready = false;\n  this._readyPromise = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].defer */ .Z.defer();\n\n  var credit = options.credit;\n  if (typeof credit === "string") {\n    credit = new _Core_Credit_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(credit);\n  }\n  this._credit = credit;\n\n  var that = this;\n  var error;\n\n  function success(image) {\n    that._image = image;\n    that._tileWidth = image.width;\n    that._tileHeight = image.height;\n    that._ready = true;\n    that._readyPromise.resolve(true);\n    _Core_TileProviderError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].handleSuccess */ .Z.handleSuccess(that._errorEvent);\n  }\n\n  function failure(e) {\n    var message = "Failed to load image " + resource.url + ".";\n    error = _Core_TileProviderError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].handleError */ .Z.handleError(\n      error,\n      that,\n      that._errorEvent,\n      message,\n      0,\n      0,\n      0,\n      doRequest,\n      e\n    );\n    that._readyPromise.reject(new _Core_RuntimeError_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z(message));\n  }\n\n  function doRequest() {\n    _ImageryProvider_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"].loadImage */ .Z.loadImage(null, resource).then(success).otherwise(failure);\n  }\n\n  doRequest();\n}\n\nObject.defineProperties(SingleTileImageryProvider.prototype, {\n  /**\n   * Gets the URL of the single, top-level imagery tile.\n   * @memberof SingleTileImageryProvider.prototype\n   * @type {String}\n   * @readonly\n   */\n  url: {\n    get: function () {\n      return this._resource.url;\n    },\n  },\n\n  /**\n   * Gets the proxy used by this provider.\n   * @memberof SingleTileImageryProvider.prototype\n   * @type {Proxy}\n   * @readonly\n   */\n  proxy: {\n    get: function () {\n      return this._resource.proxy;\n    },\n  },\n\n  /**\n   * Gets the width of each tile, in pixels. This function should\n   * not be called before {@link SingleTileImageryProvider#ready} returns true.\n   * @memberof SingleTileImageryProvider.prototype\n   * @type {Number}\n   * @readonly\n   */\n  tileWidth: {\n    get: function () {\n      //>>includeStart(\'debug\', pragmas.debug);\n      if (!this._ready) {\n        throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(\n          "tileWidth must not be called before the imagery provider is ready."\n        );\n      }\n      //>>includeEnd(\'debug\');\n\n      return this._tileWidth;\n    },\n  },\n\n  /**\n   * Gets the height of each tile, in pixels.  This function should\n   * not be called before {@link SingleTileImageryProvider#ready} returns true.\n   * @memberof SingleTileImageryProvider.prototype\n   * @type {Number}\n   * @readonly\n   */\n  tileHeight: {\n    get: function () {\n      //>>includeStart(\'debug\', pragmas.debug);\n      if (!this._ready) {\n        throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(\n          "tileHeight must not be called before the imagery provider is ready."\n        );\n      }\n      //>>includeEnd(\'debug\');\n\n      return this._tileHeight;\n    },\n  },\n\n  /**\n   * Gets the maximum level-of-detail that can be requested.  This function should\n   * not be called before {@link SingleTileImageryProvider#ready} returns true.\n   * @memberof SingleTileImageryProvider.prototype\n   * @type {Number|undefined}\n   * @readonly\n   */\n  maximumLevel: {\n    get: function () {\n      //>>includeStart(\'debug\', pragmas.debug);\n      if (!this._ready) {\n        throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(\n          "maximumLevel must not be called before the imagery provider is ready."\n        );\n      }\n      //>>includeEnd(\'debug\');\n\n      return 0;\n    },\n  },\n\n  /**\n   * Gets the minimum level-of-detail that can be requested.  This function should\n   * not be called before {@link SingleTileImageryProvider#ready} returns true.\n   * @memberof SingleTileImageryProvider.prototype\n   * @type {Number}\n   * @readonly\n   */\n  minimumLevel: {\n    get: function () {\n      //>>includeStart(\'debug\', pragmas.debug);\n      if (!this._ready) {\n        throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(\n          "minimumLevel must not be called before the imagery provider is ready."\n        );\n      }\n      //>>includeEnd(\'debug\');\n\n      return 0;\n    },\n  },\n\n  /**\n   * Gets the tiling scheme used by this provider.  This function should\n   * not be called before {@link SingleTileImageryProvider#ready} returns true.\n   * @memberof SingleTileImageryProvider.prototype\n   * @type {TilingScheme}\n   * @readonly\n   */\n  tilingScheme: {\n    get: function () {\n      //>>includeStart(\'debug\', pragmas.debug);\n      if (!this._ready) {\n        throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(\n          "tilingScheme must not be called before the imagery provider is ready."\n        );\n      }\n      //>>includeEnd(\'debug\');\n\n      return this._tilingScheme;\n    },\n  },\n\n  /**\n   * Gets the rectangle, in radians, of the imagery provided by this instance.  This function should\n   * not be called before {@link SingleTileImageryProvider#ready} returns true.\n   * @memberof SingleTileImageryProvider.prototype\n   * @type {Rectangle}\n   * @readonly\n   */\n  rectangle: {\n    get: function () {\n      return this._tilingScheme.rectangle;\n    },\n  },\n\n  /**\n   * Gets the tile discard policy.  If not undefined, the discard policy is responsible\n   * for filtering out "missing" tiles via its shouldDiscardImage function.  If this function\n   * returns undefined, no tiles are filtered.  This function should\n   * not be called before {@link SingleTileImageryProvider#ready} returns true.\n   * @memberof SingleTileImageryProvider.prototype\n   * @type {TileDiscardPolicy}\n   * @readonly\n   */\n  tileDiscardPolicy: {\n    get: function () {\n      //>>includeStart(\'debug\', pragmas.debug);\n      if (!this._ready) {\n        throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(\n          "tileDiscardPolicy must not be called before the imagery provider is ready."\n        );\n      }\n      //>>includeEnd(\'debug\');\n\n      return undefined;\n    },\n  },\n\n  /**\n   * Gets an event that is raised when the imagery provider encounters an asynchronous error.  By subscribing\n   * to the event, you will be notified of the error and can potentially recover from it.  Event listeners\n   * are passed an instance of {@link TileProviderError}.\n   * @memberof SingleTileImageryProvider.prototype\n   * @type {Event}\n   * @readonly\n   */\n  errorEvent: {\n    get: function () {\n      return this._errorEvent;\n    },\n  },\n\n  /**\n   * Gets a value indicating whether or not the provider is ready for use.\n   * @memberof SingleTileImageryProvider.prototype\n   * @type {Boolean}\n   * @readonly\n   */\n  ready: {\n    get: function () {\n      return this._ready;\n    },\n  },\n\n  /**\n   * Gets a promise that resolves to true when the provider is ready for use.\n   * @memberof SingleTileImageryProvider.prototype\n   * @type {Promise.<Boolean>}\n   * @readonly\n   */\n  readyPromise: {\n    get: function () {\n      return this._readyPromise.promise;\n    },\n  },\n\n  /**\n   * Gets the credit to display when this imagery provider is active.  Typically this is used to credit\n   * the source of the imagery.  This function should not be called before {@link SingleTileImageryProvider#ready} returns true.\n   * @memberof SingleTileImageryProvider.prototype\n   * @type {Credit}\n   * @readonly\n   */\n  credit: {\n    get: function () {\n      return this._credit;\n    },\n  },\n\n  /**\n   * Gets a value indicating whether or not the images provided by this imagery provider\n   * include an alpha channel.  If this property is false, an alpha channel, if present, will\n   * be ignored.  If this property is true, any images without an alpha channel will be treated\n   * as if their alpha is 1.0 everywhere.  When this property is false, memory usage\n   * and texture upload time are reduced.\n   * @memberof SingleTileImageryProvider.prototype\n   * @type {Boolean}\n   * @readonly\n   */\n  hasAlphaChannel: {\n    get: function () {\n      return true;\n    },\n  },\n});\n\n/**\n * Gets the credits to be displayed when a given tile is displayed.\n *\n * @param {Number} x The tile X coordinate.\n * @param {Number} y The tile Y coordinate.\n * @param {Number} level The tile level;\n * @returns {Credit[]} The credits to be displayed when the tile is displayed.\n *\n * @exception {DeveloperError} <code>getTileCredits</code> must not be called before the imagery provider is ready.\n */\nSingleTileImageryProvider.prototype.getTileCredits = function (x, y, level) {\n  return undefined;\n};\n\n/**\n * Requests the image for a given tile.  This function should\n * not be called before {@link SingleTileImageryProvider#ready} returns true.\n *\n * @param {Number} x The tile X coordinate.\n * @param {Number} y The tile Y coordinate.\n * @param {Number} level The tile level.\n * @param {Request} [request] The request object. Intended for internal use only.\n * @returns {Promise.<HTMLImageElement|HTMLCanvasElement>|undefined} A promise for the image that will resolve when the image is available, or\n *          undefined if there are too many active requests to the server, and the request\n *          should be retried later.  The resolved image may be either an\n *          Image or a Canvas DOM object.\n *\n * @exception {DeveloperError} <code>requestImage</code> must not be called before the imagery provider is ready.\n */\nSingleTileImageryProvider.prototype.requestImage = function (\n  x,\n  y,\n  level,\n  request\n) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (!this._ready) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(\n      "requestImage must not be called before the imagery provider is ready."\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  return this._image;\n};\n\n/**\n * Picking features is not currently supported by this imagery provider, so this function simply returns\n * undefined.\n *\n * @param {Number} x The tile X coordinate.\n * @param {Number} y The tile Y coordinate.\n * @param {Number} level The tile level.\n * @param {Number} longitude The longitude at which to pick features.\n * @param {Number} latitude  The latitude at which to pick features.\n * @return {Promise.<ImageryLayerFeatureInfo[]>|undefined} A promise for the picked features that will resolve when the asynchronous\n *                   picking completes.  The resolved value is an array of {@link ImageryLayerFeatureInfo}\n *                   instances.  The array may be empty if no features are found at the given location.\n *                   It may also be undefined if picking is not supported.\n */\nSingleTileImageryProvider.prototype.pickFeatures = function (\n  x,\n  y,\n  level,\n  longitude,\n  latitude\n) {\n  return undefined;\n};\n/* harmony default export */ __webpack_exports__["Z"] = (SingleTileImageryProvider);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNBLEtBQUs7QUFDTCxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNILENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLFdBQVcsUUFBUTtBQUNuQixXQUFXLFFBQVE7QUFDbkIsYUFBYSxVQUFVO0FBQ3ZCO0FBQ0EsZUFBZSxnQkFBZ0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHlCQUF5Qix1Q0FBdUM7QUFDaEU7QUFDQSxXQUFXLFFBQVE7QUFDbkIsV0FBVyxRQUFRO0FBQ25CLFdBQVcsUUFBUTtBQUNuQixXQUFXLFNBQVM7QUFDcEIsYUFBYSx3REFBd0Q7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLHdFQUFjO0FBQzVCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsV0FBVyxRQUFRO0FBQ25CLFdBQVcsUUFBUTtBQUNuQixXQUFXLFFBQVE7QUFDbkIsV0FBVyxRQUFRO0FBQ25CLFlBQVksK0NBQStDO0FBQzNELDRFQUE0RTtBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBZSx5QkFBeUIsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9TY2VuZS9TaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyLmpzPzcxNGIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENyZWRpdCBmcm9tIFwiLi4vQ29yZS9DcmVkaXQuanNcIjtcbmltcG9ydCBkZWZhdWx0VmFsdWUgZnJvbSBcIi4uL0NvcmUvZGVmYXVsdFZhbHVlLmpzXCI7XG5pbXBvcnQgZGVmaW5lZCBmcm9tIFwiLi4vQ29yZS9kZWZpbmVkLmpzXCI7XG5pbXBvcnQgRGV2ZWxvcGVyRXJyb3IgZnJvbSBcIi4uL0NvcmUvRGV2ZWxvcGVyRXJyb3IuanNcIjtcbmltcG9ydCBFdmVudCBmcm9tIFwiLi4vQ29yZS9FdmVudC5qc1wiO1xuaW1wb3J0IEdlb2dyYXBoaWNUaWxpbmdTY2hlbWUgZnJvbSBcIi4uL0NvcmUvR2VvZ3JhcGhpY1RpbGluZ1NjaGVtZS5qc1wiO1xuaW1wb3J0IFJlY3RhbmdsZSBmcm9tIFwiLi4vQ29yZS9SZWN0YW5nbGUuanNcIjtcbmltcG9ydCBSZXNvdXJjZSBmcm9tIFwiLi4vQ29yZS9SZXNvdXJjZS5qc1wiO1xuaW1wb3J0IFJ1bnRpbWVFcnJvciBmcm9tIFwiLi4vQ29yZS9SdW50aW1lRXJyb3IuanNcIjtcbmltcG9ydCBUaWxlUHJvdmlkZXJFcnJvciBmcm9tIFwiLi4vQ29yZS9UaWxlUHJvdmlkZXJFcnJvci5qc1wiO1xuaW1wb3J0IHdoZW4gZnJvbSBcIi4uL1RoaXJkUGFydHkvd2hlbi5qc1wiO1xuaW1wb3J0IEltYWdlcnlQcm92aWRlciBmcm9tIFwiLi9JbWFnZXJ5UHJvdmlkZXIuanNcIjtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBTaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyLkNvbnN0cnVjdG9yT3B0aW9uc1xuICpcbiAqIEluaXRpYWxpemF0aW9uIG9wdGlvbnMgZm9yIHRoZSBTaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyIGNvbnN0cnVjdG9yXG4gKlxuICogQHByb3BlcnR5IHtSZXNvdXJjZXxTdHJpbmd9IHVybCBUaGUgdXJsIGZvciB0aGUgdGlsZS5cbiAqIEBwcm9wZXJ0eSB7UmVjdGFuZ2xlfSBbcmVjdGFuZ2xlPVJlY3RhbmdsZS5NQVhfVkFMVUVdIFRoZSByZWN0YW5nbGUsIGluIHJhZGlhbnMsIGNvdmVyZWQgYnkgdGhlIGltYWdlLlxuICogQHByb3BlcnR5IHtDcmVkaXR8U3RyaW5nfSBbY3JlZGl0XSBBIGNyZWRpdCBmb3IgdGhlIGRhdGEgc291cmNlLCB3aGljaCBpcyBkaXNwbGF5ZWQgb24gdGhlIGNhbnZhcy5cbiAqIEBwcm9wZXJ0eSB7RWxsaXBzb2lkfSBbZWxsaXBzb2lkXSBUaGUgZWxsaXBzb2lkLiAgSWYgbm90IHNwZWNpZmllZCwgdGhlIFdHUzg0IGVsbGlwc29pZCBpcyB1c2VkLlxuICovXG5cbi8qKlxuICogUHJvdmlkZXMgYSBzaW5nbGUsIHRvcC1sZXZlbCBpbWFnZXJ5IHRpbGUuICBUaGUgc2luZ2xlIGltYWdlIGlzIGFzc3VtZWQgdG8gdXNlIGFcbiAqIHtAbGluayBHZW9ncmFwaGljVGlsaW5nU2NoZW1lfS5cbiAqXG4gKiBAYWxpYXMgU2luZ2xlVGlsZUltYWdlcnlQcm92aWRlclxuICogQGNvbnN0cnVjdG9yXG4gKlxuICogQHBhcmFtIHtTaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyLkNvbnN0cnVjdG9yT3B0aW9uc30gb3B0aW9ucyBPYmplY3QgZGVzY3JpYmluZyBpbml0aWFsaXphdGlvbiBvcHRpb25zXG4gKlxuICogQHNlZSBBcmNHaXNNYXBTZXJ2ZXJJbWFnZXJ5UHJvdmlkZXJcbiAqIEBzZWUgQmluZ01hcHNJbWFnZXJ5UHJvdmlkZXJcbiAqIEBzZWUgR29vZ2xlRWFydGhFbnRlcnByaXNlTWFwc1Byb3ZpZGVyXG4gKiBAc2VlIE9wZW5TdHJlZXRNYXBJbWFnZXJ5UHJvdmlkZXJcbiAqIEBzZWUgVGlsZU1hcFNlcnZpY2VJbWFnZXJ5UHJvdmlkZXJcbiAqIEBzZWUgV2ViTWFwU2VydmljZUltYWdlcnlQcm92aWRlclxuICogQHNlZSBXZWJNYXBUaWxlU2VydmljZUltYWdlcnlQcm92aWRlclxuICogQHNlZSBVcmxUZW1wbGF0ZUltYWdlcnlQcm92aWRlclxuICovXG5mdW5jdGlvbiBTaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyKG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLCBkZWZhdWx0VmFsdWUuRU1QVFlfT0JKRUNUKTtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgaWYgKCFkZWZpbmVkKG9wdGlvbnMudXJsKSkge1xuICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcIm9wdGlvbnMudXJsIGlzIHJlcXVpcmVkLlwiKTtcbiAgfVxuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICAvKipcbiAgICogVGhlIGRlZmF1bHQgYWxwaGEgYmxlbmRpbmcgdmFsdWUgb2YgdGhpcyBwcm92aWRlciwgd2l0aCAwLjAgcmVwcmVzZW50aW5nIGZ1bGx5IHRyYW5zcGFyZW50IGFuZFxuICAgKiAxLjAgcmVwcmVzZW50aW5nIGZ1bGx5IG9wYXF1ZS5cbiAgICpcbiAgICogQHR5cGUge051bWJlcnx1bmRlZmluZWR9XG4gICAqIEBkZWZhdWx0IHVuZGVmaW5lZFxuICAgKi9cbiAgdGhpcy5kZWZhdWx0QWxwaGEgPSB1bmRlZmluZWQ7XG5cbiAgLyoqXG4gICAqIFRoZSBkZWZhdWx0IGFscGhhIGJsZW5kaW5nIHZhbHVlIG9uIHRoZSBuaWdodCBzaWRlIG9mIHRoZSBnbG9iZSBvZiB0aGlzIHByb3ZpZGVyLCB3aXRoIDAuMCByZXByZXNlbnRpbmcgZnVsbHkgdHJhbnNwYXJlbnQgYW5kXG4gICAqIDEuMCByZXByZXNlbnRpbmcgZnVsbHkgb3BhcXVlLlxuICAgKlxuICAgKiBAdHlwZSB7TnVtYmVyfHVuZGVmaW5lZH1cbiAgICogQGRlZmF1bHQgdW5kZWZpbmVkXG4gICAqL1xuICB0aGlzLmRlZmF1bHROaWdodEFscGhhID0gdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCBhbHBoYSBibGVuZGluZyB2YWx1ZSBvbiB0aGUgZGF5IHNpZGUgb2YgdGhlIGdsb2JlIG9mIHRoaXMgcHJvdmlkZXIsIHdpdGggMC4wIHJlcHJlc2VudGluZyBmdWxseSB0cmFuc3BhcmVudCBhbmRcbiAgICogMS4wIHJlcHJlc2VudGluZyBmdWxseSBvcGFxdWUuXG4gICAqXG4gICAqIEB0eXBlIHtOdW1iZXJ8dW5kZWZpbmVkfVxuICAgKiBAZGVmYXVsdCB1bmRlZmluZWRcbiAgICovXG4gIHRoaXMuZGVmYXVsdERheUFscGhhID0gdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCBicmlnaHRuZXNzIG9mIHRoaXMgcHJvdmlkZXIuICAxLjAgdXNlcyB0aGUgdW5tb2RpZmllZCBpbWFnZXJ5IGNvbG9yLiAgTGVzcyB0aGFuIDEuMFxuICAgKiBtYWtlcyB0aGUgaW1hZ2VyeSBkYXJrZXIgd2hpbGUgZ3JlYXRlciB0aGFuIDEuMCBtYWtlcyBpdCBicmlnaHRlci5cbiAgICpcbiAgICogQHR5cGUge051bWJlcnx1bmRlZmluZWR9XG4gICAqIEBkZWZhdWx0IHVuZGVmaW5lZFxuICAgKi9cbiAgdGhpcy5kZWZhdWx0QnJpZ2h0bmVzcyA9IHVuZGVmaW5lZDtcblxuICAvKipcbiAgICogVGhlIGRlZmF1bHQgY29udHJhc3Qgb2YgdGhpcyBwcm92aWRlci4gIDEuMCB1c2VzIHRoZSB1bm1vZGlmaWVkIGltYWdlcnkgY29sb3IuICBMZXNzIHRoYW4gMS4wIHJlZHVjZXNcbiAgICogdGhlIGNvbnRyYXN0IHdoaWxlIGdyZWF0ZXIgdGhhbiAxLjAgaW5jcmVhc2VzIGl0LlxuICAgKlxuICAgKiBAdHlwZSB7TnVtYmVyfHVuZGVmaW5lZH1cbiAgICogQGRlZmF1bHQgdW5kZWZpbmVkXG4gICAqL1xuICB0aGlzLmRlZmF1bHRDb250cmFzdCA9IHVuZGVmaW5lZDtcblxuICAvKipcbiAgICogVGhlIGRlZmF1bHQgaHVlIG9mIHRoaXMgcHJvdmlkZXIgaW4gcmFkaWFucy4gMC4wIHVzZXMgdGhlIHVubW9kaWZpZWQgaW1hZ2VyeSBjb2xvci5cbiAgICpcbiAgICogQHR5cGUge051bWJlcnx1bmRlZmluZWR9XG4gICAqIEBkZWZhdWx0IHVuZGVmaW5lZFxuICAgKi9cbiAgdGhpcy5kZWZhdWx0SHVlID0gdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCBzYXR1cmF0aW9uIG9mIHRoaXMgcHJvdmlkZXIuIDEuMCB1c2VzIHRoZSB1bm1vZGlmaWVkIGltYWdlcnkgY29sb3IuIExlc3MgdGhhbiAxLjAgcmVkdWNlcyB0aGVcbiAgICogc2F0dXJhdGlvbiB3aGlsZSBncmVhdGVyIHRoYW4gMS4wIGluY3JlYXNlcyBpdC5cbiAgICpcbiAgICogQHR5cGUge051bWJlcnx1bmRlZmluZWR9XG4gICAqIEBkZWZhdWx0IHVuZGVmaW5lZFxuICAgKi9cbiAgdGhpcy5kZWZhdWx0U2F0dXJhdGlvbiA9IHVuZGVmaW5lZDtcblxuICAvKipcbiAgICogVGhlIGRlZmF1bHQgZ2FtbWEgY29ycmVjdGlvbiB0byBhcHBseSB0byB0aGlzIHByb3ZpZGVyLiAgMS4wIHVzZXMgdGhlIHVubW9kaWZpZWQgaW1hZ2VyeSBjb2xvci5cbiAgICpcbiAgICogQHR5cGUge051bWJlcnx1bmRlZmluZWR9XG4gICAqIEBkZWZhdWx0IHVuZGVmaW5lZFxuICAgKi9cbiAgdGhpcy5kZWZhdWx0R2FtbWEgPSB1bmRlZmluZWQ7XG5cbiAgLyoqXG4gICAqIFRoZSBkZWZhdWx0IHRleHR1cmUgbWluaWZpY2F0aW9uIGZpbHRlciB0byBhcHBseSB0byB0aGlzIHByb3ZpZGVyLlxuICAgKlxuICAgKiBAdHlwZSB7VGV4dHVyZU1pbmlmaWNhdGlvbkZpbHRlcn1cbiAgICogQGRlZmF1bHQgdW5kZWZpbmVkXG4gICAqL1xuICB0aGlzLmRlZmF1bHRNaW5pZmljYXRpb25GaWx0ZXIgPSB1bmRlZmluZWQ7XG5cbiAgLyoqXG4gICAqIFRoZSBkZWZhdWx0IHRleHR1cmUgbWFnbmlmaWNhdGlvbiBmaWx0ZXIgdG8gYXBwbHkgdG8gdGhpcyBwcm92aWRlci5cbiAgICpcbiAgICogQHR5cGUge1RleHR1cmVNYWduaWZpY2F0aW9uRmlsdGVyfVxuICAgKiBAZGVmYXVsdCB1bmRlZmluZWRcbiAgICovXG4gIHRoaXMuZGVmYXVsdE1hZ25pZmljYXRpb25GaWx0ZXIgPSB1bmRlZmluZWQ7XG5cbiAgdmFyIHJlc291cmNlID0gUmVzb3VyY2UuY3JlYXRlSWZOZWVkZWQob3B0aW9ucy51cmwpO1xuXG4gIHZhciByZWN0YW5nbGUgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5yZWN0YW5nbGUsIFJlY3RhbmdsZS5NQVhfVkFMVUUpO1xuICB2YXIgdGlsaW5nU2NoZW1lID0gbmV3IEdlb2dyYXBoaWNUaWxpbmdTY2hlbWUoe1xuICAgIHJlY3RhbmdsZTogcmVjdGFuZ2xlLFxuICAgIG51bWJlck9mTGV2ZWxaZXJvVGlsZXNYOiAxLFxuICAgIG51bWJlck9mTGV2ZWxaZXJvVGlsZXNZOiAxLFxuICAgIGVsbGlwc29pZDogb3B0aW9ucy5lbGxpcHNvaWQsXG4gIH0pO1xuICB0aGlzLl90aWxpbmdTY2hlbWUgPSB0aWxpbmdTY2hlbWU7XG4gIHRoaXMuX3Jlc291cmNlID0gcmVzb3VyY2U7XG4gIHRoaXMuX2ltYWdlID0gdW5kZWZpbmVkO1xuICB0aGlzLl90ZXh0dXJlID0gdW5kZWZpbmVkO1xuICB0aGlzLl90aWxlV2lkdGggPSAwO1xuICB0aGlzLl90aWxlSGVpZ2h0ID0gMDtcblxuICB0aGlzLl9lcnJvckV2ZW50ID0gbmV3IEV2ZW50KCk7XG5cbiAgdGhpcy5fcmVhZHkgPSBmYWxzZTtcbiAgdGhpcy5fcmVhZHlQcm9taXNlID0gd2hlbi5kZWZlcigpO1xuXG4gIHZhciBjcmVkaXQgPSBvcHRpb25zLmNyZWRpdDtcbiAgaWYgKHR5cGVvZiBjcmVkaXQgPT09IFwic3RyaW5nXCIpIHtcbiAgICBjcmVkaXQgPSBuZXcgQ3JlZGl0KGNyZWRpdCk7XG4gIH1cbiAgdGhpcy5fY3JlZGl0ID0gY3JlZGl0O1xuXG4gIHZhciB0aGF0ID0gdGhpcztcbiAgdmFyIGVycm9yO1xuXG4gIGZ1bmN0aW9uIHN1Y2Nlc3MoaW1hZ2UpIHtcbiAgICB0aGF0Ll9pbWFnZSA9IGltYWdlO1xuICAgIHRoYXQuX3RpbGVXaWR0aCA9IGltYWdlLndpZHRoO1xuICAgIHRoYXQuX3RpbGVIZWlnaHQgPSBpbWFnZS5oZWlnaHQ7XG4gICAgdGhhdC5fcmVhZHkgPSB0cnVlO1xuICAgIHRoYXQuX3JlYWR5UHJvbWlzZS5yZXNvbHZlKHRydWUpO1xuICAgIFRpbGVQcm92aWRlckVycm9yLmhhbmRsZVN1Y2Nlc3ModGhhdC5fZXJyb3JFdmVudCk7XG4gIH1cblxuICBmdW5jdGlvbiBmYWlsdXJlKGUpIHtcbiAgICB2YXIgbWVzc2FnZSA9IFwiRmFpbGVkIHRvIGxvYWQgaW1hZ2UgXCIgKyByZXNvdXJjZS51cmwgKyBcIi5cIjtcbiAgICBlcnJvciA9IFRpbGVQcm92aWRlckVycm9yLmhhbmRsZUVycm9yKFxuICAgICAgZXJyb3IsXG4gICAgICB0aGF0LFxuICAgICAgdGhhdC5fZXJyb3JFdmVudCxcbiAgICAgIG1lc3NhZ2UsXG4gICAgICAwLFxuICAgICAgMCxcbiAgICAgIDAsXG4gICAgICBkb1JlcXVlc3QsXG4gICAgICBlXG4gICAgKTtcbiAgICB0aGF0Ll9yZWFkeVByb21pc2UucmVqZWN0KG5ldyBSdW50aW1lRXJyb3IobWVzc2FnZSkpO1xuICB9XG5cbiAgZnVuY3Rpb24gZG9SZXF1ZXN0KCkge1xuICAgIEltYWdlcnlQcm92aWRlci5sb2FkSW1hZ2UobnVsbCwgcmVzb3VyY2UpLnRoZW4oc3VjY2Vzcykub3RoZXJ3aXNlKGZhaWx1cmUpO1xuICB9XG5cbiAgZG9SZXF1ZXN0KCk7XG59XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFNpbmdsZVRpbGVJbWFnZXJ5UHJvdmlkZXIucHJvdG90eXBlLCB7XG4gIC8qKlxuICAgKiBHZXRzIHRoZSBVUkwgb2YgdGhlIHNpbmdsZSwgdG9wLWxldmVsIGltYWdlcnkgdGlsZS5cbiAgICogQG1lbWJlcm9mIFNpbmdsZVRpbGVJbWFnZXJ5UHJvdmlkZXIucHJvdG90eXBlXG4gICAqIEB0eXBlIHtTdHJpbmd9XG4gICAqIEByZWFkb25seVxuICAgKi9cbiAgdXJsOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcmVzb3VyY2UudXJsO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIHByb3h5IHVzZWQgYnkgdGhpcyBwcm92aWRlci5cbiAgICogQG1lbWJlcm9mIFNpbmdsZVRpbGVJbWFnZXJ5UHJvdmlkZXIucHJvdG90eXBlXG4gICAqIEB0eXBlIHtQcm94eX1cbiAgICogQHJlYWRvbmx5XG4gICAqL1xuICBwcm94eToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3Jlc291cmNlLnByb3h5O1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIHdpZHRoIG9mIGVhY2ggdGlsZSwgaW4gcGl4ZWxzLiBUaGlzIGZ1bmN0aW9uIHNob3VsZFxuICAgKiBub3QgYmUgY2FsbGVkIGJlZm9yZSB7QGxpbmsgU2luZ2xlVGlsZUltYWdlcnlQcm92aWRlciNyZWFkeX0gcmV0dXJucyB0cnVlLlxuICAgKiBAbWVtYmVyb2YgU2luZ2xlVGlsZUltYWdlcnlQcm92aWRlci5wcm90b3R5cGVcbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQHJlYWRvbmx5XG4gICAqL1xuICB0aWxlV2lkdGg6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gICAgICBpZiAoIXRoaXMuX3JlYWR5KSB7XG4gICAgICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcbiAgICAgICAgICBcInRpbGVXaWR0aCBtdXN0IG5vdCBiZSBjYWxsZWQgYmVmb3JlIHRoZSBpbWFnZXJ5IHByb3ZpZGVyIGlzIHJlYWR5LlwiXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICAgICAgcmV0dXJuIHRoaXMuX3RpbGVXaWR0aDtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBoZWlnaHQgb2YgZWFjaCB0aWxlLCBpbiBwaXhlbHMuICBUaGlzIGZ1bmN0aW9uIHNob3VsZFxuICAgKiBub3QgYmUgY2FsbGVkIGJlZm9yZSB7QGxpbmsgU2luZ2xlVGlsZUltYWdlcnlQcm92aWRlciNyZWFkeX0gcmV0dXJucyB0cnVlLlxuICAgKiBAbWVtYmVyb2YgU2luZ2xlVGlsZUltYWdlcnlQcm92aWRlci5wcm90b3R5cGVcbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQHJlYWRvbmx5XG4gICAqL1xuICB0aWxlSGVpZ2h0OiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICAgICAgaWYgKCF0aGlzLl9yZWFkeSkge1xuICAgICAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgICAgICAgXCJ0aWxlSGVpZ2h0IG11c3Qgbm90IGJlIGNhbGxlZCBiZWZvcmUgdGhlIGltYWdlcnkgcHJvdmlkZXIgaXMgcmVhZHkuXCJcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gICAgICByZXR1cm4gdGhpcy5fdGlsZUhlaWdodDtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBtYXhpbXVtIGxldmVsLW9mLWRldGFpbCB0aGF0IGNhbiBiZSByZXF1ZXN0ZWQuICBUaGlzIGZ1bmN0aW9uIHNob3VsZFxuICAgKiBub3QgYmUgY2FsbGVkIGJlZm9yZSB7QGxpbmsgU2luZ2xlVGlsZUltYWdlcnlQcm92aWRlciNyZWFkeX0gcmV0dXJucyB0cnVlLlxuICAgKiBAbWVtYmVyb2YgU2luZ2xlVGlsZUltYWdlcnlQcm92aWRlci5wcm90b3R5cGVcbiAgICogQHR5cGUge051bWJlcnx1bmRlZmluZWR9XG4gICAqIEByZWFkb25seVxuICAgKi9cbiAgbWF4aW11bUxldmVsOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICAgICAgaWYgKCF0aGlzLl9yZWFkeSkge1xuICAgICAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgICAgICAgXCJtYXhpbXVtTGV2ZWwgbXVzdCBub3QgYmUgY2FsbGVkIGJlZm9yZSB0aGUgaW1hZ2VyeSBwcm92aWRlciBpcyByZWFkeS5cIlxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgICAgIHJldHVybiAwO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIG1pbmltdW0gbGV2ZWwtb2YtZGV0YWlsIHRoYXQgY2FuIGJlIHJlcXVlc3RlZC4gIFRoaXMgZnVuY3Rpb24gc2hvdWxkXG4gICAqIG5vdCBiZSBjYWxsZWQgYmVmb3JlIHtAbGluayBTaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyI3JlYWR5fSByZXR1cm5zIHRydWUuXG4gICAqIEBtZW1iZXJvZiBTaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIG1pbmltdW1MZXZlbDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgICAgIGlmICghdGhpcy5fcmVhZHkpIHtcbiAgICAgICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFxuICAgICAgICAgIFwibWluaW11bUxldmVsIG11c3Qgbm90IGJlIGNhbGxlZCBiZWZvcmUgdGhlIGltYWdlcnkgcHJvdmlkZXIgaXMgcmVhZHkuXCJcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gICAgICByZXR1cm4gMDtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSB0aWxpbmcgc2NoZW1lIHVzZWQgYnkgdGhpcyBwcm92aWRlci4gIFRoaXMgZnVuY3Rpb24gc2hvdWxkXG4gICAqIG5vdCBiZSBjYWxsZWQgYmVmb3JlIHtAbGluayBTaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyI3JlYWR5fSByZXR1cm5zIHRydWUuXG4gICAqIEBtZW1iZXJvZiBTaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7VGlsaW5nU2NoZW1lfVxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIHRpbGluZ1NjaGVtZToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgICAgIGlmICghdGhpcy5fcmVhZHkpIHtcbiAgICAgICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFxuICAgICAgICAgIFwidGlsaW5nU2NoZW1lIG11c3Qgbm90IGJlIGNhbGxlZCBiZWZvcmUgdGhlIGltYWdlcnkgcHJvdmlkZXIgaXMgcmVhZHkuXCJcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gICAgICByZXR1cm4gdGhpcy5fdGlsaW5nU2NoZW1lO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIHJlY3RhbmdsZSwgaW4gcmFkaWFucywgb2YgdGhlIGltYWdlcnkgcHJvdmlkZWQgYnkgdGhpcyBpbnN0YW5jZS4gIFRoaXMgZnVuY3Rpb24gc2hvdWxkXG4gICAqIG5vdCBiZSBjYWxsZWQgYmVmb3JlIHtAbGluayBTaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyI3JlYWR5fSByZXR1cm5zIHRydWUuXG4gICAqIEBtZW1iZXJvZiBTaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7UmVjdGFuZ2xlfVxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIHJlY3RhbmdsZToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3RpbGluZ1NjaGVtZS5yZWN0YW5nbGU7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogR2V0cyB0aGUgdGlsZSBkaXNjYXJkIHBvbGljeS4gIElmIG5vdCB1bmRlZmluZWQsIHRoZSBkaXNjYXJkIHBvbGljeSBpcyByZXNwb25zaWJsZVxuICAgKiBmb3IgZmlsdGVyaW5nIG91dCBcIm1pc3NpbmdcIiB0aWxlcyB2aWEgaXRzIHNob3VsZERpc2NhcmRJbWFnZSBmdW5jdGlvbi4gIElmIHRoaXMgZnVuY3Rpb25cbiAgICogcmV0dXJucyB1bmRlZmluZWQsIG5vIHRpbGVzIGFyZSBmaWx0ZXJlZC4gIFRoaXMgZnVuY3Rpb24gc2hvdWxkXG4gICAqIG5vdCBiZSBjYWxsZWQgYmVmb3JlIHtAbGluayBTaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyI3JlYWR5fSByZXR1cm5zIHRydWUuXG4gICAqIEBtZW1iZXJvZiBTaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7VGlsZURpc2NhcmRQb2xpY3l9XG4gICAqIEByZWFkb25seVxuICAgKi9cbiAgdGlsZURpc2NhcmRQb2xpY3k6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gICAgICBpZiAoIXRoaXMuX3JlYWR5KSB7XG4gICAgICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcbiAgICAgICAgICBcInRpbGVEaXNjYXJkUG9saWN5IG11c3Qgbm90IGJlIGNhbGxlZCBiZWZvcmUgdGhlIGltYWdlcnkgcHJvdmlkZXIgaXMgcmVhZHkuXCJcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldHMgYW4gZXZlbnQgdGhhdCBpcyByYWlzZWQgd2hlbiB0aGUgaW1hZ2VyeSBwcm92aWRlciBlbmNvdW50ZXJzIGFuIGFzeW5jaHJvbm91cyBlcnJvci4gIEJ5IHN1YnNjcmliaW5nXG4gICAqIHRvIHRoZSBldmVudCwgeW91IHdpbGwgYmUgbm90aWZpZWQgb2YgdGhlIGVycm9yIGFuZCBjYW4gcG90ZW50aWFsbHkgcmVjb3ZlciBmcm9tIGl0LiAgRXZlbnQgbGlzdGVuZXJzXG4gICAqIGFyZSBwYXNzZWQgYW4gaW5zdGFuY2Ugb2Yge0BsaW5rIFRpbGVQcm92aWRlckVycm9yfS5cbiAgICogQG1lbWJlcm9mIFNpbmdsZVRpbGVJbWFnZXJ5UHJvdmlkZXIucHJvdG90eXBlXG4gICAqIEB0eXBlIHtFdmVudH1cbiAgICogQHJlYWRvbmx5XG4gICAqL1xuICBlcnJvckV2ZW50OiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZXJyb3JFdmVudDtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBHZXRzIGEgdmFsdWUgaW5kaWNhdGluZyB3aGV0aGVyIG9yIG5vdCB0aGUgcHJvdmlkZXIgaXMgcmVhZHkgZm9yIHVzZS5cbiAgICogQG1lbWJlcm9mIFNpbmdsZVRpbGVJbWFnZXJ5UHJvdmlkZXIucHJvdG90eXBlXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIHJlYWR5OiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcmVhZHk7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogR2V0cyBhIHByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0cnVlIHdoZW4gdGhlIHByb3ZpZGVyIGlzIHJlYWR5IGZvciB1c2UuXG4gICAqIEBtZW1iZXJvZiBTaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7UHJvbWlzZS48Qm9vbGVhbj59XG4gICAqIEByZWFkb25seVxuICAgKi9cbiAgcmVhZHlQcm9taXNlOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcmVhZHlQcm9taXNlLnByb21pc2U7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogR2V0cyB0aGUgY3JlZGl0IHRvIGRpc3BsYXkgd2hlbiB0aGlzIGltYWdlcnkgcHJvdmlkZXIgaXMgYWN0aXZlLiAgVHlwaWNhbGx5IHRoaXMgaXMgdXNlZCB0byBjcmVkaXRcbiAgICogdGhlIHNvdXJjZSBvZiB0aGUgaW1hZ2VyeS4gIFRoaXMgZnVuY3Rpb24gc2hvdWxkIG5vdCBiZSBjYWxsZWQgYmVmb3JlIHtAbGluayBTaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyI3JlYWR5fSByZXR1cm5zIHRydWUuXG4gICAqIEBtZW1iZXJvZiBTaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7Q3JlZGl0fVxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIGNyZWRpdDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NyZWRpdDtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBHZXRzIGEgdmFsdWUgaW5kaWNhdGluZyB3aGV0aGVyIG9yIG5vdCB0aGUgaW1hZ2VzIHByb3ZpZGVkIGJ5IHRoaXMgaW1hZ2VyeSBwcm92aWRlclxuICAgKiBpbmNsdWRlIGFuIGFscGhhIGNoYW5uZWwuICBJZiB0aGlzIHByb3BlcnR5IGlzIGZhbHNlLCBhbiBhbHBoYSBjaGFubmVsLCBpZiBwcmVzZW50LCB3aWxsXG4gICAqIGJlIGlnbm9yZWQuICBJZiB0aGlzIHByb3BlcnR5IGlzIHRydWUsIGFueSBpbWFnZXMgd2l0aG91dCBhbiBhbHBoYSBjaGFubmVsIHdpbGwgYmUgdHJlYXRlZFxuICAgKiBhcyBpZiB0aGVpciBhbHBoYSBpcyAxLjAgZXZlcnl3aGVyZS4gIFdoZW4gdGhpcyBwcm9wZXJ0eSBpcyBmYWxzZSwgbWVtb3J5IHVzYWdlXG4gICAqIGFuZCB0ZXh0dXJlIHVwbG9hZCB0aW1lIGFyZSByZWR1Y2VkLlxuICAgKiBAbWVtYmVyb2YgU2luZ2xlVGlsZUltYWdlcnlQcm92aWRlci5wcm90b3R5cGVcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqIEByZWFkb25seVxuICAgKi9cbiAgaGFzQWxwaGFDaGFubmVsOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICB9LFxufSk7XG5cbi8qKlxuICogR2V0cyB0aGUgY3JlZGl0cyB0byBiZSBkaXNwbGF5ZWQgd2hlbiBhIGdpdmVuIHRpbGUgaXMgZGlzcGxheWVkLlxuICpcbiAqIEBwYXJhbSB7TnVtYmVyfSB4IFRoZSB0aWxlIFggY29vcmRpbmF0ZS5cbiAqIEBwYXJhbSB7TnVtYmVyfSB5IFRoZSB0aWxlIFkgY29vcmRpbmF0ZS5cbiAqIEBwYXJhbSB7TnVtYmVyfSBsZXZlbCBUaGUgdGlsZSBsZXZlbDtcbiAqIEByZXR1cm5zIHtDcmVkaXRbXX0gVGhlIGNyZWRpdHMgdG8gYmUgZGlzcGxheWVkIHdoZW4gdGhlIHRpbGUgaXMgZGlzcGxheWVkLlxuICpcbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSA8Y29kZT5nZXRUaWxlQ3JlZGl0czwvY29kZT4gbXVzdCBub3QgYmUgY2FsbGVkIGJlZm9yZSB0aGUgaW1hZ2VyeSBwcm92aWRlciBpcyByZWFkeS5cbiAqL1xuU2luZ2xlVGlsZUltYWdlcnlQcm92aWRlci5wcm90b3R5cGUuZ2V0VGlsZUNyZWRpdHMgPSBmdW5jdGlvbiAoeCwgeSwgbGV2ZWwpIHtcbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn07XG5cbi8qKlxuICogUmVxdWVzdHMgdGhlIGltYWdlIGZvciBhIGdpdmVuIHRpbGUuICBUaGlzIGZ1bmN0aW9uIHNob3VsZFxuICogbm90IGJlIGNhbGxlZCBiZWZvcmUge0BsaW5rIFNpbmdsZVRpbGVJbWFnZXJ5UHJvdmlkZXIjcmVhZHl9IHJldHVybnMgdHJ1ZS5cbiAqXG4gKiBAcGFyYW0ge051bWJlcn0geCBUaGUgdGlsZSBYIGNvb3JkaW5hdGUuXG4gKiBAcGFyYW0ge051bWJlcn0geSBUaGUgdGlsZSBZIGNvb3JkaW5hdGUuXG4gKiBAcGFyYW0ge051bWJlcn0gbGV2ZWwgVGhlIHRpbGUgbGV2ZWwuXG4gKiBAcGFyYW0ge1JlcXVlc3R9IFtyZXF1ZXN0XSBUaGUgcmVxdWVzdCBvYmplY3QuIEludGVuZGVkIGZvciBpbnRlcm5hbCB1c2Ugb25seS5cbiAqIEByZXR1cm5zIHtQcm9taXNlLjxIVE1MSW1hZ2VFbGVtZW50fEhUTUxDYW52YXNFbGVtZW50Pnx1bmRlZmluZWR9IEEgcHJvbWlzZSBmb3IgdGhlIGltYWdlIHRoYXQgd2lsbCByZXNvbHZlIHdoZW4gdGhlIGltYWdlIGlzIGF2YWlsYWJsZSwgb3JcbiAqICAgICAgICAgIHVuZGVmaW5lZCBpZiB0aGVyZSBhcmUgdG9vIG1hbnkgYWN0aXZlIHJlcXVlc3RzIHRvIHRoZSBzZXJ2ZXIsIGFuZCB0aGUgcmVxdWVzdFxuICogICAgICAgICAgc2hvdWxkIGJlIHJldHJpZWQgbGF0ZXIuICBUaGUgcmVzb2x2ZWQgaW1hZ2UgbWF5IGJlIGVpdGhlciBhblxuICogICAgICAgICAgSW1hZ2Ugb3IgYSBDYW52YXMgRE9NIG9iamVjdC5cbiAqXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gPGNvZGU+cmVxdWVzdEltYWdlPC9jb2RlPiBtdXN0IG5vdCBiZSBjYWxsZWQgYmVmb3JlIHRoZSBpbWFnZXJ5IHByb3ZpZGVyIGlzIHJlYWR5LlxuICovXG5TaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyLnByb3RvdHlwZS5yZXF1ZXN0SW1hZ2UgPSBmdW5jdGlvbiAoXG4gIHgsXG4gIHksXG4gIGxldmVsLFxuICByZXF1ZXN0XG4pIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgaWYgKCF0aGlzLl9yZWFkeSkge1xuICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcbiAgICAgIFwicmVxdWVzdEltYWdlIG11c3Qgbm90IGJlIGNhbGxlZCBiZWZvcmUgdGhlIGltYWdlcnkgcHJvdmlkZXIgaXMgcmVhZHkuXCJcbiAgICApO1xuICB9XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIHJldHVybiB0aGlzLl9pbWFnZTtcbn07XG5cbi8qKlxuICogUGlja2luZyBmZWF0dXJlcyBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZCBieSB0aGlzIGltYWdlcnkgcHJvdmlkZXIsIHNvIHRoaXMgZnVuY3Rpb24gc2ltcGx5IHJldHVybnNcbiAqIHVuZGVmaW5lZC5cbiAqXG4gKiBAcGFyYW0ge051bWJlcn0geCBUaGUgdGlsZSBYIGNvb3JkaW5hdGUuXG4gKiBAcGFyYW0ge051bWJlcn0geSBUaGUgdGlsZSBZIGNvb3JkaW5hdGUuXG4gKiBAcGFyYW0ge051bWJlcn0gbGV2ZWwgVGhlIHRpbGUgbGV2ZWwuXG4gKiBAcGFyYW0ge051bWJlcn0gbG9uZ2l0dWRlIFRoZSBsb25naXR1ZGUgYXQgd2hpY2ggdG8gcGljayBmZWF0dXJlcy5cbiAqIEBwYXJhbSB7TnVtYmVyfSBsYXRpdHVkZSAgVGhlIGxhdGl0dWRlIGF0IHdoaWNoIHRvIHBpY2sgZmVhdHVyZXMuXG4gKiBAcmV0dXJuIHtQcm9taXNlLjxJbWFnZXJ5TGF5ZXJGZWF0dXJlSW5mb1tdPnx1bmRlZmluZWR9IEEgcHJvbWlzZSBmb3IgdGhlIHBpY2tlZCBmZWF0dXJlcyB0aGF0IHdpbGwgcmVzb2x2ZSB3aGVuIHRoZSBhc3luY2hyb25vdXNcbiAqICAgICAgICAgICAgICAgICAgIHBpY2tpbmcgY29tcGxldGVzLiAgVGhlIHJlc29sdmVkIHZhbHVlIGlzIGFuIGFycmF5IG9mIHtAbGluayBJbWFnZXJ5TGF5ZXJGZWF0dXJlSW5mb31cbiAqICAgICAgICAgICAgICAgICAgIGluc3RhbmNlcy4gIFRoZSBhcnJheSBtYXkgYmUgZW1wdHkgaWYgbm8gZmVhdHVyZXMgYXJlIGZvdW5kIGF0IHRoZSBnaXZlbiBsb2NhdGlvbi5cbiAqICAgICAgICAgICAgICAgICAgIEl0IG1heSBhbHNvIGJlIHVuZGVmaW5lZCBpZiBwaWNraW5nIGlzIG5vdCBzdXBwb3J0ZWQuXG4gKi9cblNpbmdsZVRpbGVJbWFnZXJ5UHJvdmlkZXIucHJvdG90eXBlLnBpY2tGZWF0dXJlcyA9IGZ1bmN0aW9uIChcbiAgeCxcbiAgeSxcbiAgbGV2ZWwsXG4gIGxvbmdpdHVkZSxcbiAgbGF0aXR1ZGVcbikge1xuICByZXR1cm4gdW5kZWZpbmVkO1xufTtcbmV4cG9ydCBkZWZhdWx0IFNpbmdsZVRpbGVJbWFnZXJ5UHJvdmlkZXI7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///57018\n')},80763:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(60216);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(82982);\n/* harmony import */ var _Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(86511);\n/* harmony import */ var _Core_Ellipsoid_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(50491);\n/* harmony import */ var _Core_EllipsoidGeometry_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(64727);\n/* harmony import */ var _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(57552);\n/* harmony import */ var _Core_Math_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(99417);\n/* harmony import */ var _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(72248);\n/* harmony import */ var _Core_VertexFormat_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(67252);\n/* harmony import */ var _Renderer_BufferUsage_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(58597);\n/* harmony import */ var _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(60072);\n/* harmony import */ var _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(10667);\n/* harmony import */ var _Renderer_ShaderProgram_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(46588);\n/* harmony import */ var _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(53642);\n/* harmony import */ var _Renderer_VertexArray_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(18192);\n/* harmony import */ var _Shaders_SkyAtmosphereCommon_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(66629);\n/* harmony import */ var _Shaders_SkyAtmosphereFS_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(79908);\n/* harmony import */ var _Shaders_SkyAtmosphereVS_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(4399);\n/* harmony import */ var _Axis_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(66577);\n/* harmony import */ var _BlendingState_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(13633);\n/* harmony import */ var _CullFace_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(71593);\n/* harmony import */ var _SceneMode_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(89917);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * An atmosphere drawn around the limb of the provided ellipsoid.  Based on\n * {@link https://developer.nvidia.com/gpugems/GPUGems2/gpugems2_chapter16.html|Accurate Atmospheric Scattering}\n * in GPU Gems 2.\n * <p>\n * This is only supported in 3D. Atmosphere is faded out when morphing to 2D or Columbus view.\n * </p>\n *\n * @alias SkyAtmosphere\n * @constructor\n *\n * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid that the atmosphere is drawn around.\n *\n * @example\n * scene.skyAtmosphere = new Cesium.SkyAtmosphere();\n *\n * @demo {@link https://sandcastle.cesium.com/index.html?src=Sky%20Atmosphere.html|Sky atmosphere demo in Sandcastle}\n *\n * @see Scene.skyAtmosphere\n */\nfunction SkyAtmosphere(ellipsoid) {\n  ellipsoid = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(ellipsoid, _Core_Ellipsoid_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].WGS84 */ .Z.WGS84);\n\n  /**\n   * Determines if the atmosphere is shown.\n   *\n   * @type {Boolean}\n   * @default true\n   */\n  this.show = true;\n\n  /**\n   * Compute atmosphere per-fragment instead of per-vertex.\n   * This produces better looking atmosphere with a slight performance penalty.\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.perFragmentAtmosphere = false;\n\n  this._ellipsoid = ellipsoid;\n\n  var outerEllipsoidScale = 1.025;\n  var scaleVector = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].multiplyByScalar */ .Z.multiplyByScalar(\n    ellipsoid.radii,\n    outerEllipsoidScale,\n    new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z()\n  );\n  this._scaleMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].fromScale */ .Z.fromScale(scaleVector);\n  this._modelMatrix = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z();\n\n  this._command = new _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z({\n    owner: this,\n    modelMatrix: this._modelMatrix,\n  });\n  this._spSkyFromSpace = undefined;\n  this._spSkyFromAtmosphere = undefined;\n\n  this._flags = undefined;\n\n  /**\n   * The hue shift to apply to the atmosphere. Defaults to 0.0 (no shift).\n   * A hue shift of 1.0 indicates a complete rotation of the hues available.\n   * @type {Number}\n   * @default 0.0\n   */\n  this.hueShift = 0.0;\n\n  /**\n   * The saturation shift to apply to the atmosphere. Defaults to 0.0 (no shift).\n   * A saturation shift of -1.0 is monochrome.\n   * @type {Number}\n   * @default 0.0\n   */\n  this.saturationShift = 0.0;\n\n  /**\n   * The brightness shift to apply to the atmosphere. Defaults to 0.0 (no shift).\n   * A brightness shift of -1.0 is complete darkness, which will let space show through.\n   * @type {Number}\n   * @default 0.0\n   */\n  this.brightnessShift = 0.0;\n\n  this._hueSaturationBrightness = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\n\n  // outer radius, inner radius, dynamic atmosphere color flag\n  var radiiAndDynamicAtmosphereColor = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\n\n  radiiAndDynamicAtmosphereColor.x =\n    ellipsoid.maximumRadius * outerEllipsoidScale;\n  radiiAndDynamicAtmosphereColor.y = ellipsoid.maximumRadius;\n\n  // Toggles whether the sun position is used. 0 treats the sun as always directly overhead.\n  radiiAndDynamicAtmosphereColor.z = 0;\n\n  this._radiiAndDynamicAtmosphereColor = radiiAndDynamicAtmosphereColor;\n\n  var that = this;\n\n  this._command.uniformMap = {\n    u_radiiAndDynamicAtmosphereColor: function () {\n      return that._radiiAndDynamicAtmosphereColor;\n    },\n    u_hsbShift: function () {\n      that._hueSaturationBrightness.x = that.hueShift;\n      that._hueSaturationBrightness.y = that.saturationShift;\n      that._hueSaturationBrightness.z = that.brightnessShift;\n      return that._hueSaturationBrightness;\n    },\n  };\n}\n\nObject.defineProperties(SkyAtmosphere.prototype, {\n  /**\n   * Gets the ellipsoid the atmosphere is drawn around.\n   * @memberof SkyAtmosphere.prototype\n   *\n   * @type {Ellipsoid}\n   * @readonly\n   */\n  ellipsoid: {\n    get: function () {\n      return this._ellipsoid;\n    },\n  },\n});\n\n/**\n * @private\n */\nSkyAtmosphere.prototype.setDynamicAtmosphereColor = function (\n  enableLighting,\n  useSunDirection\n) {\n  var lightEnum = enableLighting ? (useSunDirection ? 2.0 : 1.0) : 0.0;\n  this._radiiAndDynamicAtmosphereColor.z = lightEnum;\n};\n\nvar scratchModelMatrix = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z();\n\n/**\n * @private\n */\nSkyAtmosphere.prototype.update = function (frameState, globe) {\n  if (!this.show) {\n    return undefined;\n  }\n\n  var mode = frameState.mode;\n  if (mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].SCENE3D */ .Z.SCENE3D && mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].MORPHING */ .Z.MORPHING) {\n    return undefined;\n  }\n\n  // The atmosphere is only rendered during the render pass; it is not pickable, it doesn\'t cast shadows, etc.\n  if (!frameState.passes.render) {\n    return undefined;\n  }\n\n  // Align the ellipsoid geometry so it always faces the same direction as the\n  // camera to reduce artifacts when rendering atmosphere per-vertex\n  var rotationMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].fromRotationTranslation */ .Z.fromRotationTranslation(\n    frameState.context.uniformState.inverseViewRotation,\n    _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].ZERO */ .Z.ZERO,\n    scratchModelMatrix\n  );\n  var rotationOffsetMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].multiplyTransformation */ .Z.multiplyTransformation(\n    rotationMatrix,\n    _Axis_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"].Y_UP_TO_Z_UP */ .Z.Y_UP_TO_Z_UP,\n    scratchModelMatrix\n  );\n  var modelMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].multiply */ .Z.multiply(\n    this._scaleMatrix,\n    rotationOffsetMatrix,\n    scratchModelMatrix\n  );\n  _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].clone */ .Z.clone(modelMatrix, this._modelMatrix);\n\n  var context = frameState.context;\n\n  var colorCorrect = hasColorCorrection(this);\n  var translucent = frameState.globeTranslucencyState.translucent;\n  var perFragmentAtmosphere =\n    this.perFragmentAtmosphere || translucent || !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z)(globe) || !globe.show;\n\n  var command = this._command;\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z)(command.vertexArray)) {\n    var geometry = _Core_EllipsoidGeometry_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].createGeometry */ .Z.createGeometry(\n      new _Core_EllipsoidGeometry_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z({\n        radii: new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(1.0, 1.0, 1.0),\n        slicePartitions: 256,\n        stackPartitions: 256,\n        vertexFormat: _Core_VertexFormat_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].POSITION_ONLY */ .Z.POSITION_ONLY,\n      })\n    );\n    command.vertexArray = _Renderer_VertexArray_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].fromGeometry */ .Z.fromGeometry({\n      context: context,\n      geometry: geometry,\n      attributeLocations: _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].createAttributeLocations */ .Z.createAttributeLocations(geometry),\n      bufferUsage: _Renderer_BufferUsage_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].STATIC_DRAW */ .Z.STATIC_DRAW,\n    });\n    command.renderState = _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"].fromCache */ .Z.fromCache({\n      cull: {\n        enabled: true,\n        face: _CullFace_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].FRONT */ .Z.FRONT,\n      },\n      blending: _BlendingState_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].ALPHA_BLEND */ .Z.ALPHA_BLEND,\n      depthMask: false,\n    });\n  }\n\n  var flags = colorCorrect | (perFragmentAtmosphere << 2) | (translucent << 3);\n\n  if (flags !== this._flags) {\n    this._flags = flags;\n\n    var defines = [];\n\n    if (colorCorrect) {\n      defines.push("COLOR_CORRECT");\n    }\n\n    if (perFragmentAtmosphere) {\n      defines.push("PER_FRAGMENT_ATMOSPHERE");\n    }\n\n    if (translucent) {\n      defines.push("GLOBE_TRANSLUCENT");\n    }\n\n    var vs = new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z({\n      defines: defines.concat("SKY_FROM_SPACE"),\n      sources: [_Shaders_SkyAtmosphereCommon_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"] */ .Z, _Shaders_SkyAtmosphereVS_js__WEBPACK_IMPORTED_MODULE_21__/* ["default"] */ .Z],\n    });\n\n    var fs = new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z({\n      defines: defines.concat("SKY_FROM_SPACE"),\n      sources: [_Shaders_SkyAtmosphereCommon_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"] */ .Z, _Shaders_SkyAtmosphereFS_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z],\n    });\n\n    this._spSkyFromSpace = _Renderer_ShaderProgram_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].fromCache */ .Z.fromCache({\n      context: context,\n      vertexShaderSource: vs,\n      fragmentShaderSource: fs,\n    });\n\n    vs = new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z({\n      defines: defines.concat("SKY_FROM_ATMOSPHERE"),\n      sources: [_Shaders_SkyAtmosphereCommon_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"] */ .Z, _Shaders_SkyAtmosphereVS_js__WEBPACK_IMPORTED_MODULE_21__/* ["default"] */ .Z],\n    });\n\n    fs = new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z({\n      defines: defines.concat("SKY_FROM_ATMOSPHERE"),\n      sources: [_Shaders_SkyAtmosphereCommon_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"] */ .Z, _Shaders_SkyAtmosphereFS_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z],\n    });\n\n    this._spSkyFromAtmosphere = _Renderer_ShaderProgram_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].fromCache */ .Z.fromCache({\n      context: context,\n      vertexShaderSource: vs,\n      fragmentShaderSource: fs,\n    });\n  }\n\n  var cameraPosition = frameState.camera.positionWC;\n  var cameraHeight = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].magnitude */ .Z.magnitude(cameraPosition);\n\n  if (cameraHeight > this._radiiAndDynamicAtmosphereColor.x) {\n    // Camera in space\n    command.shaderProgram = this._spSkyFromSpace;\n  } else {\n    // Camera in atmosphere\n    command.shaderProgram = this._spSkyFromAtmosphere;\n  }\n\n  return command;\n};\n\nfunction hasColorCorrection(skyAtmosphere) {\n  return !(\n    _Core_Math_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].equalsEpsilon */ .Z.equalsEpsilon(\n      skyAtmosphere.hueShift,\n      0.0,\n      _Core_Math_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].EPSILON7 */ .Z.EPSILON7\n    ) &&\n    _Core_Math_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].equalsEpsilon */ .Z.equalsEpsilon(\n      skyAtmosphere.saturationShift,\n      0.0,\n      _Core_Math_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].EPSILON7 */ .Z.EPSILON7\n    ) &&\n    _Core_Math_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].equalsEpsilon */ .Z.equalsEpsilon(\n      skyAtmosphere.brightnessShift,\n      0.0,\n      _Core_Math_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].EPSILON7 */ .Z.EPSILON7\n    )\n  );\n}\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <br /><br />\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n *\n * @returns {Boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n *\n * @see SkyAtmosphere#destroy\n */\nSkyAtmosphere.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the WebGL resources held by this object.  Destroying an object allows for deterministic\n * release of WebGL resources, instead of relying on the garbage collector to destroy this object.\n * <br /><br />\n * Once an object is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n *\n * @example\n * skyAtmosphere = skyAtmosphere && skyAtmosphere.destroy();\n *\n * @see SkyAtmosphere#isDestroyed\n */\nSkyAtmosphere.prototype.destroy = function () {\n  var command = this._command;\n  command.vertexArray = command.vertexArray && command.vertexArray.destroy();\n  this._spSkyFromSpace = this._spSkyFromSpace && this._spSkyFromSpace.destroy();\n  this._spSkyFromAtmosphere =\n    this._spSkyFromAtmosphere && this._spSkyFromAtmosphere.destroy();\n  return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(this);\n};\n/* harmony default export */ __webpack_exports__["Z"] = (SkyAtmosphere);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dXJjZS9TY2VuZS9Ta3lBdG1vc3BoZXJlLmpzPzg5NjciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENhcnRlc2lhbjMgZnJvbSBcIi4uL0NvcmUvQ2FydGVzaWFuMy5qc1wiO1xuaW1wb3J0IGRlZmF1bHRWYWx1ZSBmcm9tIFwiLi4vQ29yZS9kZWZhdWx0VmFsdWUuanNcIjtcbmltcG9ydCBkZWZpbmVkIGZyb20gXCIuLi9Db3JlL2RlZmluZWQuanNcIjtcbmltcG9ydCBkZXN0cm95T2JqZWN0IGZyb20gXCIuLi9Db3JlL2Rlc3Ryb3lPYmplY3QuanNcIjtcbmltcG9ydCBFbGxpcHNvaWQgZnJvbSBcIi4uL0NvcmUvRWxsaXBzb2lkLmpzXCI7XG5pbXBvcnQgRWxsaXBzb2lkR2VvbWV0cnkgZnJvbSBcIi4uL0NvcmUvRWxsaXBzb2lkR2VvbWV0cnkuanNcIjtcbmltcG9ydCBHZW9tZXRyeVBpcGVsaW5lIGZyb20gXCIuLi9Db3JlL0dlb21ldHJ5UGlwZWxpbmUuanNcIjtcbmltcG9ydCBDZXNpdW1NYXRoIGZyb20gXCIuLi9Db3JlL01hdGguanNcIjtcbmltcG9ydCBNYXRyaXg0IGZyb20gXCIuLi9Db3JlL01hdHJpeDQuanNcIjtcbmltcG9ydCBWZXJ0ZXhGb3JtYXQgZnJvbSBcIi4uL0NvcmUvVmVydGV4Rm9ybWF0LmpzXCI7XG5pbXBvcnQgQnVmZmVyVXNhZ2UgZnJvbSBcIi4uL1JlbmRlcmVyL0J1ZmZlclVzYWdlLmpzXCI7XG5pbXBvcnQgRHJhd0NvbW1hbmQgZnJvbSBcIi4uL1JlbmRlcmVyL0RyYXdDb21tYW5kLmpzXCI7XG5pbXBvcnQgUmVuZGVyU3RhdGUgZnJvbSBcIi4uL1JlbmRlcmVyL1JlbmRlclN0YXRlLmpzXCI7XG5pbXBvcnQgU2hhZGVyUHJvZ3JhbSBmcm9tIFwiLi4vUmVuZGVyZXIvU2hhZGVyUHJvZ3JhbS5qc1wiO1xuaW1wb3J0IFNoYWRlclNvdXJjZSBmcm9tIFwiLi4vUmVuZGVyZXIvU2hhZGVyU291cmNlLmpzXCI7XG5pbXBvcnQgVmVydGV4QXJyYXkgZnJvbSBcIi4uL1JlbmRlcmVyL1ZlcnRleEFycmF5LmpzXCI7XG5pbXBvcnQgU2t5QXRtb3NwaGVyZUNvbW1vbiBmcm9tIFwiLi4vU2hhZGVycy9Ta3lBdG1vc3BoZXJlQ29tbW9uLmpzXCI7XG5pbXBvcnQgU2t5QXRtb3NwaGVyZUZTIGZyb20gXCIuLi9TaGFkZXJzL1NreUF0bW9zcGhlcmVGUy5qc1wiO1xuaW1wb3J0IFNreUF0bW9zcGhlcmVWUyBmcm9tIFwiLi4vU2hhZGVycy9Ta3lBdG1vc3BoZXJlVlMuanNcIjtcbmltcG9ydCBBeGlzIGZyb20gXCIuL0F4aXMuanNcIjtcbmltcG9ydCBCbGVuZGluZ1N0YXRlIGZyb20gXCIuL0JsZW5kaW5nU3RhdGUuanNcIjtcbmltcG9ydCBDdWxsRmFjZSBmcm9tIFwiLi9DdWxsRmFjZS5qc1wiO1xuaW1wb3J0IFNjZW5lTW9kZSBmcm9tIFwiLi9TY2VuZU1vZGUuanNcIjtcblxuLyoqXG4gKiBBbiBhdG1vc3BoZXJlIGRyYXduIGFyb3VuZCB0aGUgbGltYiBvZiB0aGUgcHJvdmlkZWQgZWxsaXBzb2lkLiAgQmFzZWQgb25cbiAqIHtAbGluayBodHRwczovL2RldmVsb3Blci5udmlkaWEuY29tL2dwdWdlbXMvR1BVR2VtczIvZ3B1Z2VtczJfY2hhcHRlcjE2Lmh0bWx8QWNjdXJhdGUgQXRtb3NwaGVyaWMgU2NhdHRlcmluZ31cbiAqIGluIEdQVSBHZW1zIDIuXG4gKiA8cD5cbiAqIFRoaXMgaXMgb25seSBzdXBwb3J0ZWQgaW4gM0QuIEF0bW9zcGhlcmUgaXMgZmFkZWQgb3V0IHdoZW4gbW9ycGhpbmcgdG8gMkQgb3IgQ29sdW1idXMgdmlldy5cbiAqIDwvcD5cbiAqXG4gKiBAYWxpYXMgU2t5QXRtb3NwaGVyZVxuICogQGNvbnN0cnVjdG9yXG4gKlxuICogQHBhcmFtIHtFbGxpcHNvaWR9IFtlbGxpcHNvaWQ9RWxsaXBzb2lkLldHUzg0XSBUaGUgZWxsaXBzb2lkIHRoYXQgdGhlIGF0bW9zcGhlcmUgaXMgZHJhd24gYXJvdW5kLlxuICpcbiAqIEBleGFtcGxlXG4gKiBzY2VuZS5za3lBdG1vc3BoZXJlID0gbmV3IENlc2l1bS5Ta3lBdG1vc3BoZXJlKCk7XG4gKlxuICogQGRlbW8ge0BsaW5rIGh0dHBzOi8vc2FuZGNhc3RsZS5jZXNpdW0uY29tL2luZGV4Lmh0bWw/c3JjPVNreSUyMEF0bW9zcGhlcmUuaHRtbHxTa3kgYXRtb3NwaGVyZSBkZW1vIGluIFNhbmRjYXN0bGV9XG4gKlxuICogQHNlZSBTY2VuZS5za3lBdG1vc3BoZXJlXG4gKi9cbmZ1bmN0aW9uIFNreUF0bW9zcGhlcmUoZWxsaXBzb2lkKSB7XG4gIGVsbGlwc29pZCA9IGRlZmF1bHRWYWx1ZShlbGxpcHNvaWQsIEVsbGlwc29pZC5XR1M4NCk7XG5cbiAgLyoqXG4gICAqIERldGVybWluZXMgaWYgdGhlIGF0bW9zcGhlcmUgaXMgc2hvd24uXG4gICAqXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKiBAZGVmYXVsdCB0cnVlXG4gICAqL1xuICB0aGlzLnNob3cgPSB0cnVlO1xuXG4gIC8qKlxuICAgKiBDb21wdXRlIGF0bW9zcGhlcmUgcGVyLWZyYWdtZW50IGluc3RlYWQgb2YgcGVyLXZlcnRleC5cbiAgICogVGhpcyBwcm9kdWNlcyBiZXR0ZXIgbG9va2luZyBhdG1vc3BoZXJlIHdpdGggYSBzbGlnaHQgcGVyZm9ybWFuY2UgcGVuYWx0eS5cbiAgICpcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqIEBkZWZhdWx0IGZhbHNlXG4gICAqL1xuICB0aGlzLnBlckZyYWdtZW50QXRtb3NwaGVyZSA9IGZhbHNlO1xuXG4gIHRoaXMuX2VsbGlwc29pZCA9IGVsbGlwc29pZDtcblxuICB2YXIgb3V0ZXJFbGxpcHNvaWRTY2FsZSA9IDEuMDI1O1xuICB2YXIgc2NhbGVWZWN0b3IgPSBDYXJ0ZXNpYW4zLm11bHRpcGx5QnlTY2FsYXIoXG4gICAgZWxsaXBzb2lkLnJhZGlpLFxuICAgIG91dGVyRWxsaXBzb2lkU2NhbGUsXG4gICAgbmV3IENhcnRlc2lhbjMoKVxuICApO1xuICB0aGlzLl9zY2FsZU1hdHJpeCA9IE1hdHJpeDQuZnJvbVNjYWxlKHNjYWxlVmVjdG9yKTtcbiAgdGhpcy5fbW9kZWxNYXRyaXggPSBuZXcgTWF0cml4NCgpO1xuXG4gIHRoaXMuX2NvbW1hbmQgPSBuZXcgRHJhd0NvbW1hbmQoe1xuICAgIG93bmVyOiB0aGlzLFxuICAgIG1vZGVsTWF0cml4OiB0aGlzLl9tb2RlbE1hdHJpeCxcbiAgfSk7XG4gIHRoaXMuX3NwU2t5RnJvbVNwYWNlID0gdW5kZWZpbmVkO1xuICB0aGlzLl9zcFNreUZyb21BdG1vc3BoZXJlID0gdW5kZWZpbmVkO1xuXG4gIHRoaXMuX2ZsYWdzID0gdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKiBUaGUgaHVlIHNoaWZ0IHRvIGFwcGx5IHRvIHRoZSBhdG1vc3BoZXJlLiBEZWZhdWx0cyB0byAwLjAgKG5vIHNoaWZ0KS5cbiAgICogQSBodWUgc2hpZnQgb2YgMS4wIGluZGljYXRlcyBhIGNvbXBsZXRlIHJvdGF0aW9uIG9mIHRoZSBodWVzIGF2YWlsYWJsZS5cbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQGRlZmF1bHQgMC4wXG4gICAqL1xuICB0aGlzLmh1ZVNoaWZ0ID0gMC4wO1xuXG4gIC8qKlxuICAgKiBUaGUgc2F0dXJhdGlvbiBzaGlmdCB0byBhcHBseSB0byB0aGUgYXRtb3NwaGVyZS4gRGVmYXVsdHMgdG8gMC4wIChubyBzaGlmdCkuXG4gICAqIEEgc2F0dXJhdGlvbiBzaGlmdCBvZiAtMS4wIGlzIG1vbm9jaHJvbWUuXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqIEBkZWZhdWx0IDAuMFxuICAgKi9cbiAgdGhpcy5zYXR1cmF0aW9uU2hpZnQgPSAwLjA7XG5cbiAgLyoqXG4gICAqIFRoZSBicmlnaHRuZXNzIHNoaWZ0IHRvIGFwcGx5IHRvIHRoZSBhdG1vc3BoZXJlLiBEZWZhdWx0cyB0byAwLjAgKG5vIHNoaWZ0KS5cbiAgICogQSBicmlnaHRuZXNzIHNoaWZ0IG9mIC0xLjAgaXMgY29tcGxldGUgZGFya25lc3MsIHdoaWNoIHdpbGwgbGV0IHNwYWNlIHNob3cgdGhyb3VnaC5cbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQGRlZmF1bHQgMC4wXG4gICAqL1xuICB0aGlzLmJyaWdodG5lc3NTaGlmdCA9IDAuMDtcblxuICB0aGlzLl9odWVTYXR1cmF0aW9uQnJpZ2h0bmVzcyA9IG5ldyBDYXJ0ZXNpYW4zKCk7XG5cbiAgLy8gb3V0ZXIgcmFkaXVzLCBpbm5lciByYWRpdXMsIGR5bmFtaWMgYXRtb3NwaGVyZSBjb2xvciBmbGFnXG4gIHZhciByYWRpaUFuZER5bmFtaWNBdG1vc3BoZXJlQ29sb3IgPSBuZXcgQ2FydGVzaWFuMygpO1xuXG4gIHJhZGlpQW5kRHluYW1pY0F0bW9zcGhlcmVDb2xvci54ID1cbiAgICBlbGxpcHNvaWQubWF4aW11bVJhZGl1cyAqIG91dGVyRWxsaXBzb2lkU2NhbGU7XG4gIHJhZGlpQW5kRHluYW1pY0F0bW9zcGhlcmVDb2xvci55ID0gZWxsaXBzb2lkLm1heGltdW1SYWRpdXM7XG5cbiAgLy8gVG9nZ2xlcyB3aGV0aGVyIHRoZSBzdW4gcG9zaXRpb24gaXMgdXNlZC4gMCB0cmVhdHMgdGhlIHN1biBhcyBhbHdheXMgZGlyZWN0bHkgb3ZlcmhlYWQuXG4gIHJhZGlpQW5kRHluYW1pY0F0bW9zcGhlcmVDb2xvci56ID0gMDtcblxuICB0aGlzLl9yYWRpaUFuZER5bmFtaWNBdG1vc3BoZXJlQ29sb3IgPSByYWRpaUFuZER5bmFtaWNBdG1vc3BoZXJlQ29sb3I7XG5cbiAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gIHRoaXMuX2NvbW1hbmQudW5pZm9ybU1hcCA9IHtcbiAgICB1X3JhZGlpQW5kRHluYW1pY0F0bW9zcGhlcmVDb2xvcjogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoYXQuX3JhZGlpQW5kRHluYW1pY0F0bW9zcGhlcmVDb2xvcjtcbiAgICB9LFxuICAgIHVfaHNiU2hpZnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoYXQuX2h1ZVNhdHVyYXRpb25CcmlnaHRuZXNzLnggPSB0aGF0Lmh1ZVNoaWZ0O1xuICAgICAgdGhhdC5faHVlU2F0dXJhdGlvbkJyaWdodG5lc3MueSA9IHRoYXQuc2F0dXJhdGlvblNoaWZ0O1xuICAgICAgdGhhdC5faHVlU2F0dXJhdGlvbkJyaWdodG5lc3MueiA9IHRoYXQuYnJpZ2h0bmVzc1NoaWZ0O1xuICAgICAgcmV0dXJuIHRoYXQuX2h1ZVNhdHVyYXRpb25CcmlnaHRuZXNzO1xuICAgIH0sXG4gIH07XG59XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFNreUF0bW9zcGhlcmUucHJvdG90eXBlLCB7XG4gIC8qKlxuICAgKiBHZXRzIHRoZSBlbGxpcHNvaWQgdGhlIGF0bW9zcGhlcmUgaXMgZHJhd24gYXJvdW5kLlxuICAgKiBAbWVtYmVyb2YgU2t5QXRtb3NwaGVyZS5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge0VsbGlwc29pZH1cbiAgICogQHJlYWRvbmx5XG4gICAqL1xuICBlbGxpcHNvaWQ6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9lbGxpcHNvaWQ7XG4gICAgfSxcbiAgfSxcbn0pO1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKi9cblNreUF0bW9zcGhlcmUucHJvdG90eXBlLnNldER5bmFtaWNBdG1vc3BoZXJlQ29sb3IgPSBmdW5jdGlvbiAoXG4gIGVuYWJsZUxpZ2h0aW5nLFxuICB1c2VTdW5EaXJlY3Rpb25cbikge1xuICB2YXIgbGlnaHRFbnVtID0gZW5hYmxlTGlnaHRpbmcgPyAodXNlU3VuRGlyZWN0aW9uID8gMi4wIDogMS4wKSA6IDAuMDtcbiAgdGhpcy5fcmFkaWlBbmREeW5hbWljQXRtb3NwaGVyZUNvbG9yLnogPSBsaWdodEVudW07XG59O1xuXG52YXIgc2NyYXRjaE1vZGVsTWF0cml4ID0gbmV3IE1hdHJpeDQoKTtcblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5Ta3lBdG1vc3BoZXJlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoZnJhbWVTdGF0ZSwgZ2xvYmUpIHtcbiAgaWYgKCF0aGlzLnNob3cpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgdmFyIG1vZGUgPSBmcmFtZVN0YXRlLm1vZGU7XG4gIGlmIChtb2RlICE9PSBTY2VuZU1vZGUuU0NFTkUzRCAmJiBtb2RlICE9PSBTY2VuZU1vZGUuTU9SUEhJTkcpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgLy8gVGhlIGF0bW9zcGhlcmUgaXMgb25seSByZW5kZXJlZCBkdXJpbmcgdGhlIHJlbmRlciBwYXNzOyBpdCBpcyBub3QgcGlja2FibGUsIGl0IGRvZXNuJ3QgY2FzdCBzaGFkb3dzLCBldGMuXG4gIGlmICghZnJhbWVTdGF0ZS5wYXNzZXMucmVuZGVyKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIC8vIEFsaWduIHRoZSBlbGxpcHNvaWQgZ2VvbWV0cnkgc28gaXQgYWx3YXlzIGZhY2VzIHRoZSBzYW1lIGRpcmVjdGlvbiBhcyB0aGVcbiAgLy8gY2FtZXJhIHRvIHJlZHVjZSBhcnRpZmFjdHMgd2hlbiByZW5kZXJpbmcgYXRtb3NwaGVyZSBwZXItdmVydGV4XG4gIHZhciByb3RhdGlvbk1hdHJpeCA9IE1hdHJpeDQuZnJvbVJvdGF0aW9uVHJhbnNsYXRpb24oXG4gICAgZnJhbWVTdGF0ZS5jb250ZXh0LnVuaWZvcm1TdGF0ZS5pbnZlcnNlVmlld1JvdGF0aW9uLFxuICAgIENhcnRlc2lhbjMuWkVSTyxcbiAgICBzY3JhdGNoTW9kZWxNYXRyaXhcbiAgKTtcbiAgdmFyIHJvdGF0aW9uT2Zmc2V0TWF0cml4ID0gTWF0cml4NC5tdWx0aXBseVRyYW5zZm9ybWF0aW9uKFxuICAgIHJvdGF0aW9uTWF0cml4LFxuICAgIEF4aXMuWV9VUF9UT19aX1VQLFxuICAgIHNjcmF0Y2hNb2RlbE1hdHJpeFxuICApO1xuICB2YXIgbW9kZWxNYXRyaXggPSBNYXRyaXg0Lm11bHRpcGx5KFxuICAgIHRoaXMuX3NjYWxlTWF0cml4LFxuICAgIHJvdGF0aW9uT2Zmc2V0TWF0cml4LFxuICAgIHNjcmF0Y2hNb2RlbE1hdHJpeFxuICApO1xuICBNYXRyaXg0LmNsb25lKG1vZGVsTWF0cml4LCB0aGlzLl9tb2RlbE1hdHJpeCk7XG5cbiAgdmFyIGNvbnRleHQgPSBmcmFtZVN0YXRlLmNvbnRleHQ7XG5cbiAgdmFyIGNvbG9yQ29ycmVjdCA9IGhhc0NvbG9yQ29ycmVjdGlvbih0aGlzKTtcbiAgdmFyIHRyYW5zbHVjZW50ID0gZnJhbWVTdGF0ZS5nbG9iZVRyYW5zbHVjZW5jeVN0YXRlLnRyYW5zbHVjZW50O1xuICB2YXIgcGVyRnJhZ21lbnRBdG1vc3BoZXJlID1cbiAgICB0aGlzLnBlckZyYWdtZW50QXRtb3NwaGVyZSB8fCB0cmFuc2x1Y2VudCB8fCAhZGVmaW5lZChnbG9iZSkgfHwgIWdsb2JlLnNob3c7XG5cbiAgdmFyIGNvbW1hbmQgPSB0aGlzLl9jb21tYW5kO1xuXG4gIGlmICghZGVmaW5lZChjb21tYW5kLnZlcnRleEFycmF5KSkge1xuICAgIHZhciBnZW9tZXRyeSA9IEVsbGlwc29pZEdlb21ldHJ5LmNyZWF0ZUdlb21ldHJ5KFxuICAgICAgbmV3IEVsbGlwc29pZEdlb21ldHJ5KHtcbiAgICAgICAgcmFkaWk6IG5ldyBDYXJ0ZXNpYW4zKDEuMCwgMS4wLCAxLjApLFxuICAgICAgICBzbGljZVBhcnRpdGlvbnM6IDI1NixcbiAgICAgICAgc3RhY2tQYXJ0aXRpb25zOiAyNTYsXG4gICAgICAgIHZlcnRleEZvcm1hdDogVmVydGV4Rm9ybWF0LlBPU0lUSU9OX09OTFksXG4gICAgICB9KVxuICAgICk7XG4gICAgY29tbWFuZC52ZXJ0ZXhBcnJheSA9IFZlcnRleEFycmF5LmZyb21HZW9tZXRyeSh7XG4gICAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgICAgZ2VvbWV0cnk6IGdlb21ldHJ5LFxuICAgICAgYXR0cmlidXRlTG9jYXRpb25zOiBHZW9tZXRyeVBpcGVsaW5lLmNyZWF0ZUF0dHJpYnV0ZUxvY2F0aW9ucyhnZW9tZXRyeSksXG4gICAgICBidWZmZXJVc2FnZTogQnVmZmVyVXNhZ2UuU1RBVElDX0RSQVcsXG4gICAgfSk7XG4gICAgY29tbWFuZC5yZW5kZXJTdGF0ZSA9IFJlbmRlclN0YXRlLmZyb21DYWNoZSh7XG4gICAgICBjdWxsOiB7XG4gICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgIGZhY2U6IEN1bGxGYWNlLkZST05ULFxuICAgICAgfSxcbiAgICAgIGJsZW5kaW5nOiBCbGVuZGluZ1N0YXRlLkFMUEhBX0JMRU5ELFxuICAgICAgZGVwdGhNYXNrOiBmYWxzZSxcbiAgICB9KTtcbiAgfVxuXG4gIHZhciBmbGFncyA9IGNvbG9yQ29ycmVjdCB8IChwZXJGcmFnbWVudEF0bW9zcGhlcmUgPDwgMikgfCAodHJhbnNsdWNlbnQgPDwgMyk7XG5cbiAgaWYgKGZsYWdzICE9PSB0aGlzLl9mbGFncykge1xuICAgIHRoaXMuX2ZsYWdzID0gZmxhZ3M7XG5cbiAgICB2YXIgZGVmaW5lcyA9IFtdO1xuXG4gICAgaWYgKGNvbG9yQ29ycmVjdCkge1xuICAgICAgZGVmaW5lcy5wdXNoKFwiQ09MT1JfQ09SUkVDVFwiKTtcbiAgICB9XG5cbiAgICBpZiAocGVyRnJhZ21lbnRBdG1vc3BoZXJlKSB7XG4gICAgICBkZWZpbmVzLnB1c2goXCJQRVJfRlJBR01FTlRfQVRNT1NQSEVSRVwiKTtcbiAgICB9XG5cbiAgICBpZiAodHJhbnNsdWNlbnQpIHtcbiAgICAgIGRlZmluZXMucHVzaChcIkdMT0JFX1RSQU5TTFVDRU5UXCIpO1xuICAgIH1cblxuICAgIHZhciB2cyA9IG5ldyBTaGFkZXJTb3VyY2Uoe1xuICAgICAgZGVmaW5lczogZGVmaW5lcy5jb25jYXQoXCJTS1lfRlJPTV9TUEFDRVwiKSxcbiAgICAgIHNvdXJjZXM6IFtTa3lBdG1vc3BoZXJlQ29tbW9uLCBTa3lBdG1vc3BoZXJlVlNdLFxuICAgIH0pO1xuXG4gICAgdmFyIGZzID0gbmV3IFNoYWRlclNvdXJjZSh7XG4gICAgICBkZWZpbmVzOiBkZWZpbmVzLmNvbmNhdChcIlNLWV9GUk9NX1NQQUNFXCIpLFxuICAgICAgc291cmNlczogW1NreUF0bW9zcGhlcmVDb21tb24sIFNreUF0bW9zcGhlcmVGU10sXG4gICAgfSk7XG5cbiAgICB0aGlzLl9zcFNreUZyb21TcGFjZSA9IFNoYWRlclByb2dyYW0uZnJvbUNhY2hlKHtcbiAgICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgICB2ZXJ0ZXhTaGFkZXJTb3VyY2U6IHZzLFxuICAgICAgZnJhZ21lbnRTaGFkZXJTb3VyY2U6IGZzLFxuICAgIH0pO1xuXG4gICAgdnMgPSBuZXcgU2hhZGVyU291cmNlKHtcbiAgICAgIGRlZmluZXM6IGRlZmluZXMuY29uY2F0KFwiU0tZX0ZST01fQVRNT1NQSEVSRVwiKSxcbiAgICAgIHNvdXJjZXM6IFtTa3lBdG1vc3BoZXJlQ29tbW9uLCBTa3lBdG1vc3BoZXJlVlNdLFxuICAgIH0pO1xuXG4gICAgZnMgPSBuZXcgU2hhZGVyU291cmNlKHtcbiAgICAgIGRlZmluZXM6IGRlZmluZXMuY29uY2F0KFwiU0tZX0ZST01fQVRNT1NQSEVSRVwiKSxcbiAgICAgIHNvdXJjZXM6IFtTa3lBdG1vc3BoZXJlQ29tbW9uLCBTa3lBdG1vc3BoZXJlRlNdLFxuICAgIH0pO1xuXG4gICAgdGhpcy5fc3BTa3lGcm9tQXRtb3NwaGVyZSA9IFNoYWRlclByb2dyYW0uZnJvbUNhY2hlKHtcbiAgICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgICB2ZXJ0ZXhTaGFkZXJTb3VyY2U6IHZzLFxuICAgICAgZnJhZ21lbnRTaGFkZXJTb3VyY2U6IGZzLFxuICAgIH0pO1xuICB9XG5cbiAgdmFyIGNhbWVyYVBvc2l0aW9uID0gZnJhbWVTdGF0ZS5jYW1lcmEucG9zaXRpb25XQztcbiAgdmFyIGNhbWVyYUhlaWdodCA9IENhcnRlc2lhbjMubWFnbml0dWRlKGNhbWVyYVBvc2l0aW9uKTtcblxuICBpZiAoY2FtZXJhSGVpZ2h0ID4gdGhpcy5fcmFkaWlBbmREeW5hbWljQXRtb3NwaGVyZUNvbG9yLngpIHtcbiAgICAvLyBDYW1lcmEgaW4gc3BhY2VcbiAgICBjb21tYW5kLnNoYWRlclByb2dyYW0gPSB0aGlzLl9zcFNreUZyb21TcGFjZTtcbiAgfSBlbHNlIHtcbiAgICAvLyBDYW1lcmEgaW4gYXRtb3NwaGVyZVxuICAgIGNvbW1hbmQuc2hhZGVyUHJvZ3JhbSA9IHRoaXMuX3NwU2t5RnJvbUF0bW9zcGhlcmU7XG4gIH1cblxuICByZXR1cm4gY29tbWFuZDtcbn07XG5cbmZ1bmN0aW9uIGhhc0NvbG9yQ29ycmVjdGlvbihza3lBdG1vc3BoZXJlKSB7XG4gIHJldHVybiAhKFxuICAgIENlc2l1bU1hdGguZXF1YWxzRXBzaWxvbihcbiAgICAgIHNreUF0bW9zcGhlcmUuaHVlU2hpZnQsXG4gICAgICAwLjAsXG4gICAgICBDZXNpdW1NYXRoLkVQU0lMT043XG4gICAgKSAmJlxuICAgIENlc2l1bU1hdGguZXF1YWxzRXBzaWxvbihcbiAgICAgIHNreUF0bW9zcGhlcmUuc2F0dXJhdGlvblNoaWZ0LFxuICAgICAgMC4wLFxuICAgICAgQ2VzaXVtTWF0aC5FUFNJTE9ON1xuICAgICkgJiZcbiAgICBDZXNpdW1NYXRoLmVxdWFsc0Vwc2lsb24oXG4gICAgICBza3lBdG1vc3BoZXJlLmJyaWdodG5lc3NTaGlmdCxcbiAgICAgIDAuMCxcbiAgICAgIENlc2l1bU1hdGguRVBTSUxPTjdcbiAgICApXG4gICk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQ7IG90aGVyd2lzZSwgZmFsc2UuXG4gKiA8YnIgLz48YnIgLz5cbiAqIElmIHRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQsIGl0IHNob3VsZCBub3QgYmUgdXNlZDsgY2FsbGluZyBhbnkgZnVuY3Rpb24gb3RoZXIgdGhhblxuICogPGNvZGU+aXNEZXN0cm95ZWQ8L2NvZGU+IHdpbGwgcmVzdWx0IGluIGEge0BsaW5rIERldmVsb3BlckVycm9yfSBleGNlcHRpb24uXG4gKlxuICogQHJldHVybnMge0Jvb2xlYW59IDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQ7IG90aGVyd2lzZSwgPGNvZGU+ZmFsc2U8L2NvZGU+LlxuICpcbiAqIEBzZWUgU2t5QXRtb3NwaGVyZSNkZXN0cm95XG4gKi9cblNreUF0bW9zcGhlcmUucHJvdG90eXBlLmlzRGVzdHJveWVkID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gZmFsc2U7XG59O1xuXG4vKipcbiAqIERlc3Ryb3lzIHRoZSBXZWJHTCByZXNvdXJjZXMgaGVsZCBieSB0aGlzIG9iamVjdC4gIERlc3Ryb3lpbmcgYW4gb2JqZWN0IGFsbG93cyBmb3IgZGV0ZXJtaW5pc3RpY1xuICogcmVsZWFzZSBvZiBXZWJHTCByZXNvdXJjZXMsIGluc3RlYWQgb2YgcmVseWluZyBvbiB0aGUgZ2FyYmFnZSBjb2xsZWN0b3IgdG8gZGVzdHJveSB0aGlzIG9iamVjdC5cbiAqIDxiciAvPjxiciAvPlxuICogT25jZSBhbiBvYmplY3QgaXMgZGVzdHJveWVkLCBpdCBzaG91bGQgbm90IGJlIHVzZWQ7IGNhbGxpbmcgYW55IGZ1bmN0aW9uIG90aGVyIHRoYW5cbiAqIDxjb2RlPmlzRGVzdHJveWVkPC9jb2RlPiB3aWxsIHJlc3VsdCBpbiBhIHtAbGluayBEZXZlbG9wZXJFcnJvcn0gZXhjZXB0aW9uLiAgVGhlcmVmb3JlLFxuICogYXNzaWduIHRoZSByZXR1cm4gdmFsdWUgKDxjb2RlPnVuZGVmaW5lZDwvY29kZT4pIHRvIHRoZSBvYmplY3QgYXMgZG9uZSBpbiB0aGUgZXhhbXBsZS5cbiAqXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gVGhpcyBvYmplY3Qgd2FzIGRlc3Ryb3llZCwgaS5lLiwgZGVzdHJveSgpIHdhcyBjYWxsZWQuXG4gKlxuICpcbiAqIEBleGFtcGxlXG4gKiBza3lBdG1vc3BoZXJlID0gc2t5QXRtb3NwaGVyZSAmJiBza3lBdG1vc3BoZXJlLmRlc3Ryb3koKTtcbiAqXG4gKiBAc2VlIFNreUF0bW9zcGhlcmUjaXNEZXN0cm95ZWRcbiAqL1xuU2t5QXRtb3NwaGVyZS5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGNvbW1hbmQgPSB0aGlzLl9jb21tYW5kO1xuICBjb21tYW5kLnZlcnRleEFycmF5ID0gY29tbWFuZC52ZXJ0ZXhBcnJheSAmJiBjb21tYW5kLnZlcnRleEFycmF5LmRlc3Ryb3koKTtcbiAgdGhpcy5fc3BTa3lGcm9tU3BhY2UgPSB0aGlzLl9zcFNreUZyb21TcGFjZSAmJiB0aGlzLl9zcFNreUZyb21TcGFjZS5kZXN0cm95KCk7XG4gIHRoaXMuX3NwU2t5RnJvbUF0bW9zcGhlcmUgPVxuICAgIHRoaXMuX3NwU2t5RnJvbUF0bW9zcGhlcmUgJiYgdGhpcy5fc3BTa3lGcm9tQXRtb3NwaGVyZS5kZXN0cm95KCk7XG4gIHJldHVybiBkZXN0cm95T2JqZWN0KHRoaXMpO1xufTtcbmV4cG9ydCBkZWZhdWx0IFNreUF0bW9zcGhlcmU7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///80763\n')},78149:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_BoxGeometry_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(20305);\n/* harmony import */ var _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(60216);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(82982);\n/* harmony import */ var _Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(86511);\n/* harmony import */ var _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(12572);\n/* harmony import */ var _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(57552);\n/* harmony import */ var _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(72248);\n/* harmony import */ var _Core_VertexFormat_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(67252);\n/* harmony import */ var _Renderer_BufferUsage_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(58597);\n/* harmony import */ var _Renderer_CubeMap_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(51107);\n/* harmony import */ var _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(60072);\n/* harmony import */ var _Renderer_loadCubeMap_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(93958);\n/* harmony import */ var _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(10667);\n/* harmony import */ var _Renderer_ShaderProgram_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(46588);\n/* harmony import */ var _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(53642);\n/* harmony import */ var _Renderer_VertexArray_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(18192);\n/* harmony import */ var _Shaders_SkyBoxFS_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(81277);\n/* harmony import */ var _Shaders_SkyBoxVS_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(8910);\n/* harmony import */ var _BlendingState_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(13633);\n/* harmony import */ var _SceneMode_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(89917);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * A sky box around the scene to draw stars.  The sky box is defined using the True Equator Mean Equinox (TEME) axes.\n * <p>\n * This is only supported in 3D.  The sky box is faded out when morphing to 2D or Columbus view.  The size of\n * the sky box must not exceed {@link Scene#maximumCubeMapSize}.\n * </p>\n *\n * @alias SkyBox\n * @constructor\n *\n * @param {Object} options Object with the following properties:\n * @param {Object} [options.sources] The source URL or <code>Image</code> object for each of the six cube map faces.  See the example below.\n * @param {Boolean} [options.show=true] Determines if this primitive will be shown.\n *\n *\n * @example\n * scene.skyBox = new Cesium.SkyBox({\n *   sources : {\n *     positiveX : \'skybox_px.png\',\n *     negativeX : \'skybox_nx.png\',\n *     positiveY : \'skybox_py.png\',\n *     negativeY : \'skybox_ny.png\',\n *     positiveZ : \'skybox_pz.png\',\n *     negativeZ : \'skybox_nz.png\'\n *   }\n * });\n *\n * @see Scene#skyBox\n * @see Transforms.computeTemeToPseudoFixedMatrix\n */\nfunction SkyBox(options) {\n  /**\n   * The sources used to create the cube map faces: an object\n   * with <code>positiveX</code>, <code>negativeX</code>, <code>positiveY</code>,\n   * <code>negativeY</code>, <code>positiveZ</code>, and <code>negativeZ</code> properties.\n   * These can be either URLs or <code>Image</code> objects.\n   *\n   * @type Object\n   * @default undefined\n   */\n  this.sources = options.sources;\n  this._sources = undefined;\n\n  /**\n   * Determines if the sky box will be shown.\n   *\n   * @type {Boolean}\n   * @default true\n   */\n  this.show = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(options.show, true);\n\n  this._command = new _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z({\n    modelMatrix: _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].clone */ .Z.clone(_Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].IDENTITY */ .Z.IDENTITY),\n    owner: this,\n  });\n  this._cubeMap = undefined;\n\n  this._attributeLocations = undefined;\n  this._useHdr = undefined;\n}\n\n/**\n * Called when {@link Viewer} or {@link CesiumWidget} render the scene to\n * get the draw commands needed to render this primitive.\n * <p>\n * Do not call this function directly.  This is documented just to\n * list the exceptions that may be propagated when the scene is rendered:\n * </p>\n *\n * @exception {DeveloperError} this.sources is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.\n * @exception {DeveloperError} this.sources properties must all be the same type.\n */\nSkyBox.prototype.update = function (frameState, useHdr) {\n  var that = this;\n\n  if (!this.show) {\n    return undefined;\n  }\n\n  if (\n    frameState.mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].SCENE3D */ .Z.SCENE3D &&\n    frameState.mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].MORPHING */ .Z.MORPHING\n  ) {\n    return undefined;\n  }\n\n  // The sky box is only rendered during the render pass; it is not pickable, it doesn\'t cast shadows, etc.\n  if (!frameState.passes.render) {\n    return undefined;\n  }\n\n  var context = frameState.context;\n\n  if (this._sources !== this.sources) {\n    this._sources = this.sources;\n    var sources = this.sources;\n\n    //>>includeStart(\'debug\', pragmas.debug);\n    if (\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(sources.positiveX) ||\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(sources.negativeX) ||\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(sources.positiveY) ||\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(sources.negativeY) ||\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(sources.positiveZ) ||\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(sources.negativeZ)\n    ) {\n      throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(\n        "this.sources is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties."\n      );\n    }\n\n    if (\n      typeof sources.positiveX !== typeof sources.negativeX ||\n      typeof sources.positiveX !== typeof sources.positiveY ||\n      typeof sources.positiveX !== typeof sources.negativeY ||\n      typeof sources.positiveX !== typeof sources.positiveZ ||\n      typeof sources.positiveX !== typeof sources.negativeZ\n    ) {\n      throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z(\n        "this.sources properties must all be the same type."\n      );\n    }\n    //>>includeEnd(\'debug\');\n\n    if (typeof sources.positiveX === "string") {\n      // Given urls for cube-map images.  Load them.\n      (0,_Renderer_loadCubeMap_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z)(context, this._sources).then(function (cubeMap) {\n        that._cubeMap = that._cubeMap && that._cubeMap.destroy();\n        that._cubeMap = cubeMap;\n      });\n    } else {\n      this._cubeMap = this._cubeMap && this._cubeMap.destroy();\n      this._cubeMap = new _Renderer_CubeMap_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z({\n        context: context,\n        source: sources,\n      });\n    }\n  }\n\n  var command = this._command;\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(command.vertexArray)) {\n    command.uniformMap = {\n      u_cubeMap: function () {\n        return that._cubeMap;\n      },\n    };\n\n    var geometry = _Core_BoxGeometry_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].createGeometry */ .Z.createGeometry(\n      _Core_BoxGeometry_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].fromDimensions */ .Z.fromDimensions({\n        dimensions: new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z(2.0, 2.0, 2.0),\n        vertexFormat: _Core_VertexFormat_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].POSITION_ONLY */ .Z.POSITION_ONLY,\n      })\n    );\n    var attributeLocations = (this._attributeLocations = _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].createAttributeLocations */ .Z.createAttributeLocations(\n      geometry\n    ));\n\n    command.vertexArray = _Renderer_VertexArray_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"].fromGeometry */ .Z.fromGeometry({\n      context: context,\n      geometry: geometry,\n      attributeLocations: attributeLocations,\n      bufferUsage: _Renderer_BufferUsage_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].STATIC_DRAW */ .Z.STATIC_DRAW,\n    });\n\n    command.renderState = _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].fromCache */ .Z.fromCache({\n      blending: _BlendingState_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].ALPHA_BLEND */ .Z.ALPHA_BLEND,\n    });\n  }\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(command.shaderProgram) || this._useHdr !== useHdr) {\n    var fs = new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z({\n      defines: [useHdr ? "HDR" : ""],\n      sources: [_Shaders_SkyBoxFS_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z],\n    });\n    command.shaderProgram = _Renderer_ShaderProgram_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].fromCache */ .Z.fromCache({\n      context: context,\n      vertexShaderSource: _Shaders_SkyBoxVS_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"] */ .Z,\n      fragmentShaderSource: fs,\n      attributeLocations: this._attributeLocations,\n    });\n    this._useHdr = useHdr;\n  }\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(this._cubeMap)) {\n    return undefined;\n  }\n\n  return command;\n};\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <br /><br />\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n *\n * @returns {Boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n *\n * @see SkyBox#destroy\n */\nSkyBox.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the WebGL resources held by this object.  Destroying an object allows for deterministic\n * release of WebGL resources, instead of relying on the garbage collector to destroy this object.\n * <br /><br />\n * Once an object is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n *\n * @example\n * skyBox = skyBox && skyBox.destroy();\n *\n * @see SkyBox#isDestroyed\n */\nSkyBox.prototype.destroy = function () {\n  var command = this._command;\n  command.vertexArray = command.vertexArray && command.vertexArray.destroy();\n  command.shaderProgram =\n    command.shaderProgram && command.shaderProgram.destroy();\n  this._cubeMap = this._cubeMap && this._cubeMap.destroy();\n  return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(this);\n};\n/* harmony default export */ __webpack_exports__["Z"] = (SkyBox);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QjtBQUNwRTtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLDJFQUFhO0FBQ3RCO0FBQ0EseURBQWUsTUFBTSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnVlMy13ZWJwYWNrNS8uL25vZGVfbW9kdWxlcy9jZXNpdW0vU291cmNlL1NjZW5lL1NreUJveC5qcz9lMWNmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBCb3hHZW9tZXRyeSBmcm9tIFwiLi4vQ29yZS9Cb3hHZW9tZXRyeS5qc1wiO1xuaW1wb3J0IENhcnRlc2lhbjMgZnJvbSBcIi4uL0NvcmUvQ2FydGVzaWFuMy5qc1wiO1xuaW1wb3J0IGRlZmF1bHRWYWx1ZSBmcm9tIFwiLi4vQ29yZS9kZWZhdWx0VmFsdWUuanNcIjtcbmltcG9ydCBkZWZpbmVkIGZyb20gXCIuLi9Db3JlL2RlZmluZWQuanNcIjtcbmltcG9ydCBkZXN0cm95T2JqZWN0IGZyb20gXCIuLi9Db3JlL2Rlc3Ryb3lPYmplY3QuanNcIjtcbmltcG9ydCBEZXZlbG9wZXJFcnJvciBmcm9tIFwiLi4vQ29yZS9EZXZlbG9wZXJFcnJvci5qc1wiO1xuaW1wb3J0IEdlb21ldHJ5UGlwZWxpbmUgZnJvbSBcIi4uL0NvcmUvR2VvbWV0cnlQaXBlbGluZS5qc1wiO1xuaW1wb3J0IE1hdHJpeDQgZnJvbSBcIi4uL0NvcmUvTWF0cml4NC5qc1wiO1xuaW1wb3J0IFZlcnRleEZvcm1hdCBmcm9tIFwiLi4vQ29yZS9WZXJ0ZXhGb3JtYXQuanNcIjtcbmltcG9ydCBCdWZmZXJVc2FnZSBmcm9tIFwiLi4vUmVuZGVyZXIvQnVmZmVyVXNhZ2UuanNcIjtcbmltcG9ydCBDdWJlTWFwIGZyb20gXCIuLi9SZW5kZXJlci9DdWJlTWFwLmpzXCI7XG5pbXBvcnQgRHJhd0NvbW1hbmQgZnJvbSBcIi4uL1JlbmRlcmVyL0RyYXdDb21tYW5kLmpzXCI7XG5pbXBvcnQgbG9hZEN1YmVNYXAgZnJvbSBcIi4uL1JlbmRlcmVyL2xvYWRDdWJlTWFwLmpzXCI7XG5pbXBvcnQgUmVuZGVyU3RhdGUgZnJvbSBcIi4uL1JlbmRlcmVyL1JlbmRlclN0YXRlLmpzXCI7XG5pbXBvcnQgU2hhZGVyUHJvZ3JhbSBmcm9tIFwiLi4vUmVuZGVyZXIvU2hhZGVyUHJvZ3JhbS5qc1wiO1xuaW1wb3J0IFNoYWRlclNvdXJjZSBmcm9tIFwiLi4vUmVuZGVyZXIvU2hhZGVyU291cmNlLmpzXCI7XG5pbXBvcnQgVmVydGV4QXJyYXkgZnJvbSBcIi4uL1JlbmRlcmVyL1ZlcnRleEFycmF5LmpzXCI7XG5pbXBvcnQgU2t5Qm94RlMgZnJvbSBcIi4uL1NoYWRlcnMvU2t5Qm94RlMuanNcIjtcbmltcG9ydCBTa3lCb3hWUyBmcm9tIFwiLi4vU2hhZGVycy9Ta3lCb3hWUy5qc1wiO1xuaW1wb3J0IEJsZW5kaW5nU3RhdGUgZnJvbSBcIi4vQmxlbmRpbmdTdGF0ZS5qc1wiO1xuaW1wb3J0IFNjZW5lTW9kZSBmcm9tIFwiLi9TY2VuZU1vZGUuanNcIjtcblxuLyoqXG4gKiBBIHNreSBib3ggYXJvdW5kIHRoZSBzY2VuZSB0byBkcmF3IHN0YXJzLiAgVGhlIHNreSBib3ggaXMgZGVmaW5lZCB1c2luZyB0aGUgVHJ1ZSBFcXVhdG9yIE1lYW4gRXF1aW5veCAoVEVNRSkgYXhlcy5cbiAqIDxwPlxuICogVGhpcyBpcyBvbmx5IHN1cHBvcnRlZCBpbiAzRC4gIFRoZSBza3kgYm94IGlzIGZhZGVkIG91dCB3aGVuIG1vcnBoaW5nIHRvIDJEIG9yIENvbHVtYnVzIHZpZXcuICBUaGUgc2l6ZSBvZlxuICogdGhlIHNreSBib3ggbXVzdCBub3QgZXhjZWVkIHtAbGluayBTY2VuZSNtYXhpbXVtQ3ViZU1hcFNpemV9LlxuICogPC9wPlxuICpcbiAqIEBhbGlhcyBTa3lCb3hcbiAqIEBjb25zdHJ1Y3RvclxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIE9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5zb3VyY2VzXSBUaGUgc291cmNlIFVSTCBvciA8Y29kZT5JbWFnZTwvY29kZT4gb2JqZWN0IGZvciBlYWNoIG9mIHRoZSBzaXggY3ViZSBtYXAgZmFjZXMuICBTZWUgdGhlIGV4YW1wbGUgYmVsb3cuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLnNob3c9dHJ1ZV0gRGV0ZXJtaW5lcyBpZiB0aGlzIHByaW1pdGl2ZSB3aWxsIGJlIHNob3duLlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogc2NlbmUuc2t5Qm94ID0gbmV3IENlc2l1bS5Ta3lCb3goe1xuICogICBzb3VyY2VzIDoge1xuICogICAgIHBvc2l0aXZlWCA6ICdza3lib3hfcHgucG5nJyxcbiAqICAgICBuZWdhdGl2ZVggOiAnc2t5Ym94X254LnBuZycsXG4gKiAgICAgcG9zaXRpdmVZIDogJ3NreWJveF9weS5wbmcnLFxuICogICAgIG5lZ2F0aXZlWSA6ICdza3lib3hfbnkucG5nJyxcbiAqICAgICBwb3NpdGl2ZVogOiAnc2t5Ym94X3B6LnBuZycsXG4gKiAgICAgbmVnYXRpdmVaIDogJ3NreWJveF9uei5wbmcnXG4gKiAgIH1cbiAqIH0pO1xuICpcbiAqIEBzZWUgU2NlbmUjc2t5Qm94XG4gKiBAc2VlIFRyYW5zZm9ybXMuY29tcHV0ZVRlbWVUb1BzZXVkb0ZpeGVkTWF0cml4XG4gKi9cbmZ1bmN0aW9uIFNreUJveChvcHRpb25zKSB7XG4gIC8qKlxuICAgKiBUaGUgc291cmNlcyB1c2VkIHRvIGNyZWF0ZSB0aGUgY3ViZSBtYXAgZmFjZXM6IGFuIG9iamVjdFxuICAgKiB3aXRoIDxjb2RlPnBvc2l0aXZlWDwvY29kZT4sIDxjb2RlPm5lZ2F0aXZlWDwvY29kZT4sIDxjb2RlPnBvc2l0aXZlWTwvY29kZT4sXG4gICAqIDxjb2RlPm5lZ2F0aXZlWTwvY29kZT4sIDxjb2RlPnBvc2l0aXZlWjwvY29kZT4sIGFuZCA8Y29kZT5uZWdhdGl2ZVo8L2NvZGU+IHByb3BlcnRpZXMuXG4gICAqIFRoZXNlIGNhbiBiZSBlaXRoZXIgVVJMcyBvciA8Y29kZT5JbWFnZTwvY29kZT4gb2JqZWN0cy5cbiAgICpcbiAgICogQHR5cGUgT2JqZWN0XG4gICAqIEBkZWZhdWx0IHVuZGVmaW5lZFxuICAgKi9cbiAgdGhpcy5zb3VyY2VzID0gb3B0aW9ucy5zb3VyY2VzO1xuICB0aGlzLl9zb3VyY2VzID0gdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIGlmIHRoZSBza3kgYm94IHdpbGwgYmUgc2hvd24uXG4gICAqXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKiBAZGVmYXVsdCB0cnVlXG4gICAqL1xuICB0aGlzLnNob3cgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5zaG93LCB0cnVlKTtcblxuICB0aGlzLl9jb21tYW5kID0gbmV3IERyYXdDb21tYW5kKHtcbiAgICBtb2RlbE1hdHJpeDogTWF0cml4NC5jbG9uZShNYXRyaXg0LklERU5USVRZKSxcbiAgICBvd25lcjogdGhpcyxcbiAgfSk7XG4gIHRoaXMuX2N1YmVNYXAgPSB1bmRlZmluZWQ7XG5cbiAgdGhpcy5fYXR0cmlidXRlTG9jYXRpb25zID0gdW5kZWZpbmVkO1xuICB0aGlzLl91c2VIZHIgPSB1bmRlZmluZWQ7XG59XG5cbi8qKlxuICogQ2FsbGVkIHdoZW4ge0BsaW5rIFZpZXdlcn0gb3Ige0BsaW5rIENlc2l1bVdpZGdldH0gcmVuZGVyIHRoZSBzY2VuZSB0b1xuICogZ2V0IHRoZSBkcmF3IGNvbW1hbmRzIG5lZWRlZCB0byByZW5kZXIgdGhpcyBwcmltaXRpdmUuXG4gKiA8cD5cbiAqIERvIG5vdCBjYWxsIHRoaXMgZnVuY3Rpb24gZGlyZWN0bHkuICBUaGlzIGlzIGRvY3VtZW50ZWQganVzdCB0b1xuICogbGlzdCB0aGUgZXhjZXB0aW9ucyB0aGF0IG1heSBiZSBwcm9wYWdhdGVkIHdoZW4gdGhlIHNjZW5lIGlzIHJlbmRlcmVkOlxuICogPC9wPlxuICpcbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSB0aGlzLnNvdXJjZXMgaXMgcmVxdWlyZWQgYW5kIG11c3QgaGF2ZSBwb3NpdGl2ZVgsIG5lZ2F0aXZlWCwgcG9zaXRpdmVZLCBuZWdhdGl2ZVksIHBvc2l0aXZlWiwgYW5kIG5lZ2F0aXZlWiBwcm9wZXJ0aWVzLlxuICogQGV4Y2VwdGlvbiB7RGV2ZWxvcGVyRXJyb3J9IHRoaXMuc291cmNlcyBwcm9wZXJ0aWVzIG11c3QgYWxsIGJlIHRoZSBzYW1lIHR5cGUuXG4gKi9cblNreUJveC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGZyYW1lU3RhdGUsIHVzZUhkcikge1xuICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgaWYgKCF0aGlzLnNob3cpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgaWYgKFxuICAgIGZyYW1lU3RhdGUubW9kZSAhPT0gU2NlbmVNb2RlLlNDRU5FM0QgJiZcbiAgICBmcmFtZVN0YXRlLm1vZGUgIT09IFNjZW5lTW9kZS5NT1JQSElOR1xuICApIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgLy8gVGhlIHNreSBib3ggaXMgb25seSByZW5kZXJlZCBkdXJpbmcgdGhlIHJlbmRlciBwYXNzOyBpdCBpcyBub3QgcGlja2FibGUsIGl0IGRvZXNuJ3QgY2FzdCBzaGFkb3dzLCBldGMuXG4gIGlmICghZnJhbWVTdGF0ZS5wYXNzZXMucmVuZGVyKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIHZhciBjb250ZXh0ID0gZnJhbWVTdGF0ZS5jb250ZXh0O1xuXG4gIGlmICh0aGlzLl9zb3VyY2VzICE9PSB0aGlzLnNvdXJjZXMpIHtcbiAgICB0aGlzLl9zb3VyY2VzID0gdGhpcy5zb3VyY2VzO1xuICAgIHZhciBzb3VyY2VzID0gdGhpcy5zb3VyY2VzO1xuXG4gICAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgICBpZiAoXG4gICAgICAhZGVmaW5lZChzb3VyY2VzLnBvc2l0aXZlWCkgfHxcbiAgICAgICFkZWZpbmVkKHNvdXJjZXMubmVnYXRpdmVYKSB8fFxuICAgICAgIWRlZmluZWQoc291cmNlcy5wb3NpdGl2ZVkpIHx8XG4gICAgICAhZGVmaW5lZChzb3VyY2VzLm5lZ2F0aXZlWSkgfHxcbiAgICAgICFkZWZpbmVkKHNvdXJjZXMucG9zaXRpdmVaKSB8fFxuICAgICAgIWRlZmluZWQoc291cmNlcy5uZWdhdGl2ZVopXG4gICAgKSB7XG4gICAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgICAgIFwidGhpcy5zb3VyY2VzIGlzIHJlcXVpcmVkIGFuZCBtdXN0IGhhdmUgcG9zaXRpdmVYLCBuZWdhdGl2ZVgsIHBvc2l0aXZlWSwgbmVnYXRpdmVZLCBwb3NpdGl2ZVosIGFuZCBuZWdhdGl2ZVogcHJvcGVydGllcy5cIlxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoXG4gICAgICB0eXBlb2Ygc291cmNlcy5wb3NpdGl2ZVggIT09IHR5cGVvZiBzb3VyY2VzLm5lZ2F0aXZlWCB8fFxuICAgICAgdHlwZW9mIHNvdXJjZXMucG9zaXRpdmVYICE9PSB0eXBlb2Ygc291cmNlcy5wb3NpdGl2ZVkgfHxcbiAgICAgIHR5cGVvZiBzb3VyY2VzLnBvc2l0aXZlWCAhPT0gdHlwZW9mIHNvdXJjZXMubmVnYXRpdmVZIHx8XG4gICAgICB0eXBlb2Ygc291cmNlcy5wb3NpdGl2ZVggIT09IHR5cGVvZiBzb3VyY2VzLnBvc2l0aXZlWiB8fFxuICAgICAgdHlwZW9mIHNvdXJjZXMucG9zaXRpdmVYICE9PSB0eXBlb2Ygc291cmNlcy5uZWdhdGl2ZVpcbiAgICApIHtcbiAgICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcbiAgICAgICAgXCJ0aGlzLnNvdXJjZXMgcHJvcGVydGllcyBtdXN0IGFsbCBiZSB0aGUgc2FtZSB0eXBlLlwiXG4gICAgICApO1xuICAgIH1cbiAgICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICAgIGlmICh0eXBlb2Ygc291cmNlcy5wb3NpdGl2ZVggPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIC8vIEdpdmVuIHVybHMgZm9yIGN1YmUtbWFwIGltYWdlcy4gIExvYWQgdGhlbS5cbiAgICAgIGxvYWRDdWJlTWFwKGNvbnRleHQsIHRoaXMuX3NvdXJjZXMpLnRoZW4oZnVuY3Rpb24gKGN1YmVNYXApIHtcbiAgICAgICAgdGhhdC5fY3ViZU1hcCA9IHRoYXQuX2N1YmVNYXAgJiYgdGhhdC5fY3ViZU1hcC5kZXN0cm95KCk7XG4gICAgICAgIHRoYXQuX2N1YmVNYXAgPSBjdWJlTWFwO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2N1YmVNYXAgPSB0aGlzLl9jdWJlTWFwICYmIHRoaXMuX2N1YmVNYXAuZGVzdHJveSgpO1xuICAgICAgdGhpcy5fY3ViZU1hcCA9IG5ldyBDdWJlTWFwKHtcbiAgICAgICAgY29udGV4dDogY29udGV4dCxcbiAgICAgICAgc291cmNlOiBzb3VyY2VzLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgdmFyIGNvbW1hbmQgPSB0aGlzLl9jb21tYW5kO1xuXG4gIGlmICghZGVmaW5lZChjb21tYW5kLnZlcnRleEFycmF5KSkge1xuICAgIGNvbW1hbmQudW5pZm9ybU1hcCA9IHtcbiAgICAgIHVfY3ViZU1hcDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhhdC5fY3ViZU1hcDtcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIHZhciBnZW9tZXRyeSA9IEJveEdlb21ldHJ5LmNyZWF0ZUdlb21ldHJ5KFxuICAgICAgQm94R2VvbWV0cnkuZnJvbURpbWVuc2lvbnMoe1xuICAgICAgICBkaW1lbnNpb25zOiBuZXcgQ2FydGVzaWFuMygyLjAsIDIuMCwgMi4wKSxcbiAgICAgICAgdmVydGV4Rm9ybWF0OiBWZXJ0ZXhGb3JtYXQuUE9TSVRJT05fT05MWSxcbiAgICAgIH0pXG4gICAgKTtcbiAgICB2YXIgYXR0cmlidXRlTG9jYXRpb25zID0gKHRoaXMuX2F0dHJpYnV0ZUxvY2F0aW9ucyA9IEdlb21ldHJ5UGlwZWxpbmUuY3JlYXRlQXR0cmlidXRlTG9jYXRpb25zKFxuICAgICAgZ2VvbWV0cnlcbiAgICApKTtcblxuICAgIGNvbW1hbmQudmVydGV4QXJyYXkgPSBWZXJ0ZXhBcnJheS5mcm9tR2VvbWV0cnkoe1xuICAgICAgY29udGV4dDogY29udGV4dCxcbiAgICAgIGdlb21ldHJ5OiBnZW9tZXRyeSxcbiAgICAgIGF0dHJpYnV0ZUxvY2F0aW9uczogYXR0cmlidXRlTG9jYXRpb25zLFxuICAgICAgYnVmZmVyVXNhZ2U6IEJ1ZmZlclVzYWdlLlNUQVRJQ19EUkFXLFxuICAgIH0pO1xuXG4gICAgY29tbWFuZC5yZW5kZXJTdGF0ZSA9IFJlbmRlclN0YXRlLmZyb21DYWNoZSh7XG4gICAgICBibGVuZGluZzogQmxlbmRpbmdTdGF0ZS5BTFBIQV9CTEVORCxcbiAgICB9KTtcbiAgfVxuXG4gIGlmICghZGVmaW5lZChjb21tYW5kLnNoYWRlclByb2dyYW0pIHx8IHRoaXMuX3VzZUhkciAhPT0gdXNlSGRyKSB7XG4gICAgdmFyIGZzID0gbmV3IFNoYWRlclNvdXJjZSh7XG4gICAgICBkZWZpbmVzOiBbdXNlSGRyID8gXCJIRFJcIiA6IFwiXCJdLFxuICAgICAgc291cmNlczogW1NreUJveEZTXSxcbiAgICB9KTtcbiAgICBjb21tYW5kLnNoYWRlclByb2dyYW0gPSBTaGFkZXJQcm9ncmFtLmZyb21DYWNoZSh7XG4gICAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgICAgdmVydGV4U2hhZGVyU291cmNlOiBTa3lCb3hWUyxcbiAgICAgIGZyYWdtZW50U2hhZGVyU291cmNlOiBmcyxcbiAgICAgIGF0dHJpYnV0ZUxvY2F0aW9uczogdGhpcy5fYXR0cmlidXRlTG9jYXRpb25zLFxuICAgIH0pO1xuICAgIHRoaXMuX3VzZUhkciA9IHVzZUhkcjtcbiAgfVxuXG4gIGlmICghZGVmaW5lZCh0aGlzLl9jdWJlTWFwKSkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICByZXR1cm4gY29tbWFuZDtcbn07XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQ7IG90aGVyd2lzZSwgZmFsc2UuXG4gKiA8YnIgLz48YnIgLz5cbiAqIElmIHRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQsIGl0IHNob3VsZCBub3QgYmUgdXNlZDsgY2FsbGluZyBhbnkgZnVuY3Rpb24gb3RoZXIgdGhhblxuICogPGNvZGU+aXNEZXN0cm95ZWQ8L2NvZGU+IHdpbGwgcmVzdWx0IGluIGEge0BsaW5rIERldmVsb3BlckVycm9yfSBleGNlcHRpb24uXG4gKlxuICogQHJldHVybnMge0Jvb2xlYW59IDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQ7IG90aGVyd2lzZSwgPGNvZGU+ZmFsc2U8L2NvZGU+LlxuICpcbiAqIEBzZWUgU2t5Qm94I2Rlc3Ryb3lcbiAqL1xuU2t5Qm94LnByb3RvdHlwZS5pc0Rlc3Ryb3llZCA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuLyoqXG4gKiBEZXN0cm95cyB0aGUgV2ViR0wgcmVzb3VyY2VzIGhlbGQgYnkgdGhpcyBvYmplY3QuICBEZXN0cm95aW5nIGFuIG9iamVjdCBhbGxvd3MgZm9yIGRldGVybWluaXN0aWNcbiAqIHJlbGVhc2Ugb2YgV2ViR0wgcmVzb3VyY2VzLCBpbnN0ZWFkIG9mIHJlbHlpbmcgb24gdGhlIGdhcmJhZ2UgY29sbGVjdG9yIHRvIGRlc3Ryb3kgdGhpcyBvYmplY3QuXG4gKiA8YnIgLz48YnIgLz5cbiAqIE9uY2UgYW4gb2JqZWN0IGlzIGRlc3Ryb3llZCwgaXQgc2hvdWxkIG5vdCBiZSB1c2VkOyBjYWxsaW5nIGFueSBmdW5jdGlvbiBvdGhlciB0aGFuXG4gKiA8Y29kZT5pc0Rlc3Ryb3llZDwvY29kZT4gd2lsbCByZXN1bHQgaW4gYSB7QGxpbmsgRGV2ZWxvcGVyRXJyb3J9IGV4Y2VwdGlvbi4gIFRoZXJlZm9yZSxcbiAqIGFzc2lnbiB0aGUgcmV0dXJuIHZhbHVlICg8Y29kZT51bmRlZmluZWQ8L2NvZGU+KSB0byB0aGUgb2JqZWN0IGFzIGRvbmUgaW4gdGhlIGV4YW1wbGUuXG4gKlxuICogQGV4Y2VwdGlvbiB7RGV2ZWxvcGVyRXJyb3J9IFRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQsIGkuZS4sIGRlc3Ryb3koKSB3YXMgY2FsbGVkLlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogc2t5Qm94ID0gc2t5Qm94ICYmIHNreUJveC5kZXN0cm95KCk7XG4gKlxuICogQHNlZSBTa3lCb3gjaXNEZXN0cm95ZWRcbiAqL1xuU2t5Qm94LnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICB2YXIgY29tbWFuZCA9IHRoaXMuX2NvbW1hbmQ7XG4gIGNvbW1hbmQudmVydGV4QXJyYXkgPSBjb21tYW5kLnZlcnRleEFycmF5ICYmIGNvbW1hbmQudmVydGV4QXJyYXkuZGVzdHJveSgpO1xuICBjb21tYW5kLnNoYWRlclByb2dyYW0gPVxuICAgIGNvbW1hbmQuc2hhZGVyUHJvZ3JhbSAmJiBjb21tYW5kLnNoYWRlclByb2dyYW0uZGVzdHJveSgpO1xuICB0aGlzLl9jdWJlTWFwID0gdGhpcy5fY3ViZU1hcCAmJiB0aGlzLl9jdWJlTWFwLmRlc3Ryb3koKTtcbiAgcmV0dXJuIGRlc3Ryb3lPYmplY3QodGhpcyk7XG59O1xuZXhwb3J0IGRlZmF1bHQgU2t5Qm94O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///78149\n')}}]);