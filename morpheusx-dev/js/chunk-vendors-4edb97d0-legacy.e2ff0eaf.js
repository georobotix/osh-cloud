"use strict";(self["webpackChunkvue3_webpack5"]=self["webpackChunkvue3_webpack5"]||[]).push([[3935],{34380:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(48243);\n/* harmony import */ var _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(60838);\n/* harmony import */ var _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(60216);\n/* harmony import */ var _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(63367);\n/* harmony import */ var _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(51688);\n/* harmony import */ var _Core_clone_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(83856);\n/* harmony import */ var _Core_Color_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(59947);\n/* harmony import */ var _Core_combine_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(8182);\n/* harmony import */ var _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(84828);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(82982);\n/* harmony import */ var _Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(86511);\n/* harmony import */ var _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(12572);\n/* harmony import */ var _Core_EncodedCartesian3_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(74938);\n/* harmony import */ var _Core_FeatureDetection_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(96037);\n/* harmony import */ var _Core_Geometry_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(82408);\n/* harmony import */ var _Core_GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(13616);\n/* harmony import */ var _Core_GeometryAttributes_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(56652);\n/* harmony import */ var _Core_GeometryOffsetAttribute_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(87379);\n/* harmony import */ var _Core_Intersect_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(84935);\n/* harmony import */ var _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(72248);\n/* harmony import */ var _Core_Plane_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(7749);\n/* harmony import */ var _Core_RuntimeError_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(9407);\n/* harmony import */ var _Core_subdivideArray_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(24072);\n/* harmony import */ var _Core_TaskProcessor_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(2819);\n/* harmony import */ var _Renderer_BufferUsage_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(58597);\n/* harmony import */ var _Renderer_ContextLimits_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(20521);\n/* harmony import */ var _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(60072);\n/* harmony import */ var _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(8379);\n/* harmony import */ var _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(10667);\n/* harmony import */ var _Renderer_ShaderProgram_js__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(46588);\n/* harmony import */ var _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(53642);\n/* harmony import */ var _Renderer_VertexArray_js__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(18192);\n/* harmony import */ var _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(13222);\n/* harmony import */ var _BatchTable_js__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(7164);\n/* harmony import */ var _CullFace_js__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(71593);\n/* harmony import */ var _DepthFunction_js__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(7976);\n/* harmony import */ var _PrimitivePipeline_js__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(1764);\n/* harmony import */ var _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(88736);\n/* harmony import */ var _SceneMode_js__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(89917);\n/* harmony import */ var _ShadowMode_js__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(34125);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * A primitive represents geometry in the {@link Scene}.  The geometry can be from a single {@link GeometryInstance}\n * as shown in example 1 below, or from an array of instances, even if the geometry is from different\n * geometry types, e.g., an {@link RectangleGeometry} and an {@link EllipsoidGeometry} as shown in Code Example 2.\n * <p>\n * A primitive combines geometry instances with an {@link Appearance} that describes the full shading, including\n * {@link Material} and {@link RenderState}.  Roughly, the geometry instance defines the structure and placement,\n * and the appearance defines the visual characteristics.  Decoupling geometry and appearance allows us to mix\n * and match most of them and add a new geometry or appearance independently of each other.\n * </p>\n * <p>\n * Combining multiple instances into one primitive is called batching, and significantly improves performance for static data.\n * Instances can be individually picked; {@link Scene#pick} returns their {@link GeometryInstance#id}.  Using\n * per-instance appearances like {@link PerInstanceColorAppearance}, each instance can also have a unique color.\n * </p>\n * <p>\n * {@link Geometry} can either be created and batched on a web worker or the main thread. The first two examples\n * show geometry that will be created on a web worker by using the descriptions of the geometry. The third example\n * shows how to create the geometry on the main thread by explicitly calling the <code>createGeometry</code> method.\n * </p>\n *\n * @alias Primitive\n * @constructor\n *\n * @param {Object} [options] Object with the following properties:\n * @param {GeometryInstance[]|GeometryInstance} [options.geometryInstances] The geometry instances - or a single geometry instance - to render.\n * @param {Appearance} [options.appearance] The appearance used to render the primitive.\n * @param {Appearance} [options.depthFailAppearance] The appearance used to shade this primitive when it fails the depth test.\n * @param {Boolean} [options.show=true] Determines if this primitive will be shown.\n * @param {Matrix4} [options.modelMatrix=Matrix4.IDENTITY] The 4x4 transformation matrix that transforms the primitive (all geometry instances) from model to world coordinates.\n * @param {Boolean} [options.vertexCacheOptimize=false] When <code>true</code>, geometry vertices are optimized for the pre and post-vertex-shader caches.\n * @param {Boolean} [options.interleave=false] When <code>true</code>, geometry vertex attributes are interleaved, which can slightly improve rendering performance but increases load time.\n * @param {Boolean} [options.compressVertices=true] When <code>true</code>, the geometry vertices are compressed, which will save memory.\n * @param {Boolean} [options.releaseGeometryInstances=true] When <code>true</code>, the primitive does not keep a reference to the input <code>geometryInstances</code> to save memory.\n * @param {Boolean} [options.allowPicking=true] When <code>true</code>, each geometry instance will only be pickable with {@link Scene#pick}.  When <code>false</code>, GPU memory is saved.\n * @param {Boolean} [options.cull=true] When <code>true</code>, the renderer frustum culls and horizon culls the primitive\'s commands based on their bounding volume.  Set this to <code>false</code> for a small performance gain if you are manually culling the primitive.\n * @param {Boolean} [options.asynchronous=true] Determines if the primitive will be created asynchronously or block until ready.\n * @param {Boolean} [options.debugShowBoundingVolume=false] For debugging only. Determines if this primitive\'s commands\' bounding spheres are shown.\n * @param {ShadowMode} [options.shadows=ShadowMode.DISABLED] Determines whether this primitive casts or receives shadows from light sources.\n *\n * @example\n * // 1. Draw a translucent ellipse on the surface with a checkerboard pattern\n * var instance = new Cesium.GeometryInstance({\n *   geometry : new Cesium.EllipseGeometry({\n *       center : Cesium.Cartesian3.fromDegrees(-100.0, 20.0),\n *       semiMinorAxis : 500000.0,\n *       semiMajorAxis : 1000000.0,\n *       rotation : Cesium.Math.PI_OVER_FOUR,\n *       vertexFormat : Cesium.VertexFormat.POSITION_AND_ST\n *   }),\n *   id : \'object returned when this instance is picked and to get/set per-instance attributes\'\n * });\n * scene.primitives.add(new Cesium.Primitive({\n *   geometryInstances : instance,\n *   appearance : new Cesium.EllipsoidSurfaceAppearance({\n *     material : Cesium.Material.fromType(\'Checkerboard\')\n *   })\n * }));\n *\n * @example\n * // 2. Draw different instances each with a unique color\n * var rectangleInstance = new Cesium.GeometryInstance({\n *   geometry : new Cesium.RectangleGeometry({\n *     rectangle : Cesium.Rectangle.fromDegrees(-140.0, 30.0, -100.0, 40.0),\n *     vertexFormat : Cesium.PerInstanceColorAppearance.VERTEX_FORMAT\n *   }),\n *   id : \'rectangle\',\n *   attributes : {\n *     color : new Cesium.ColorGeometryInstanceAttribute(0.0, 1.0, 1.0, 0.5)\n *   }\n * });\n * var ellipsoidInstance = new Cesium.GeometryInstance({\n *   geometry : new Cesium.EllipsoidGeometry({\n *     radii : new Cesium.Cartesian3(500000.0, 500000.0, 1000000.0),\n *     vertexFormat : Cesium.VertexFormat.POSITION_AND_NORMAL\n *   }),\n *   modelMatrix : Cesium.Matrix4.multiplyByTranslation(Cesium.Transforms.eastNorthUpToFixedFrame(\n *     Cesium.Cartesian3.fromDegrees(-95.59777, 40.03883)), new Cesium.Cartesian3(0.0, 0.0, 500000.0), new Cesium.Matrix4()),\n *   id : \'ellipsoid\',\n *   attributes : {\n *     color : Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.AQUA)\n *   }\n * });\n * scene.primitives.add(new Cesium.Primitive({\n *   geometryInstances : [rectangleInstance, ellipsoidInstance],\n *   appearance : new Cesium.PerInstanceColorAppearance()\n * }));\n *\n * @example\n * // 3. Create the geometry on the main thread.\n * scene.primitives.add(new Cesium.Primitive({\n *   geometryInstances : new Cesium.GeometryInstance({\n *     geometry : Cesium.EllipsoidGeometry.createGeometry(new Cesium.EllipsoidGeometry({\n *       radii : new Cesium.Cartesian3(500000.0, 500000.0, 1000000.0),\n *       vertexFormat : Cesium.VertexFormat.POSITION_AND_NORMAL\n *     })),\n *     modelMatrix : Cesium.Matrix4.multiplyByTranslation(Cesium.Transforms.eastNorthUpToFixedFrame(\n *       Cesium.Cartesian3.fromDegrees(-95.59777, 40.03883)), new Cesium.Cartesian3(0.0, 0.0, 500000.0), new Cesium.Matrix4()),\n *     id : \'ellipsoid\',\n *     attributes : {\n *       color : Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.AQUA)\n *     }\n *   }),\n *   appearance : new Cesium.PerInstanceColorAppearance(),\n *   asynchronous : false\n * }));\n *\n * @see GeometryInstance\n * @see Appearance\n * @see ClassificationPrimitive\n * @see GroundPrimitive\n */\nfunction Primitive(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n\n  /**\n   * The geometry instances rendered with this primitive.  This may\n   * be <code>undefined</code> if <code>options.releaseGeometryInstances</code>\n   * is <code>true</code> when the primitive is constructed.\n   * <p>\n   * Changing this property after the primitive is rendered has no effect.\n   * </p>\n   *\n   * @readonly\n   * @type GeometryInstance[]|GeometryInstance\n   *\n   * @default undefined\n   */\n  this.geometryInstances = options.geometryInstances;\n\n  /**\n   * The {@link Appearance} used to shade this primitive. Each geometry\n   * instance is shaded with the same appearance.  Some appearances, like\n   * {@link PerInstanceColorAppearance} allow giving each instance unique\n   * properties.\n   *\n   * @type Appearance\n   *\n   * @default undefined\n   */\n  this.appearance = options.appearance;\n  this._appearance = undefined;\n  this._material = undefined;\n\n  /**\n   * The {@link Appearance} used to shade this primitive when it fails the depth test. Each geometry\n   * instance is shaded with the same appearance.  Some appearances, like\n   * {@link PerInstanceColorAppearance} allow giving each instance unique\n   * properties.\n   *\n   * <p>\n   * When using an appearance that requires a color attribute, like PerInstanceColorAppearance,\n   * add a depthFailColor per-instance attribute instead.\n   * </p>\n   *\n   * <p>\n   * Requires the EXT_frag_depth WebGL extension to render properly. If the extension is not supported,\n   * there may be artifacts.\n   * </p>\n   * @type Appearance\n   *\n   * @default undefined\n   */\n  this.depthFailAppearance = options.depthFailAppearance;\n  this._depthFailAppearance = undefined;\n  this._depthFailMaterial = undefined;\n\n  /**\n   * The 4x4 transformation matrix that transforms the primitive (all geometry instances) from model to world coordinates.\n   * When this is the identity matrix, the primitive is drawn in world coordinates, i.e., Earth\'s WGS84 coordinates.\n   * Local reference frames can be used by providing a different transformation matrix, like that returned\n   * by {@link Transforms.eastNorthUpToFixedFrame}.\n   *\n   * <p>\n   * This property is only supported in 3D mode.\n   * </p>\n   *\n   * @type Matrix4\n   *\n   * @default Matrix4.IDENTITY\n   *\n   * @example\n   * var origin = Cesium.Cartesian3.fromDegrees(-95.0, 40.0, 200000.0);\n   * p.modelMatrix = Cesium.Transforms.eastNorthUpToFixedFrame(origin);\n   */\n  this.modelMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].clone */ .Z.clone(\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(options.modelMatrix, _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].IDENTITY */ .Z.IDENTITY)\n  );\n  this._modelMatrix = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z();\n\n  /**\n   * Determines if the primitive will be shown.  This affects all geometry\n   * instances in the primitive.\n   *\n   * @type Boolean\n   *\n   * @default true\n   */\n  this.show = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(options.show, true);\n\n  this._vertexCacheOptimize = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(options.vertexCacheOptimize, false);\n  this._interleave = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(options.interleave, false);\n  this._releaseGeometryInstances = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(\n    options.releaseGeometryInstances,\n    true\n  );\n  this._allowPicking = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(options.allowPicking, true);\n  this._asynchronous = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(options.asynchronous, true);\n  this._compressVertices = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(options.compressVertices, true);\n\n  /**\n   * When <code>true</code>, the renderer frustum culls and horizon culls the primitive\'s commands\n   * based on their bounding volume.  Set this to <code>false</code> for a small performance gain\n   * if you are manually culling the primitive.\n   *\n   * @type {Boolean}\n   *\n   * @default true\n   */\n  this.cull = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(options.cull, true);\n\n  /**\n   * This property is for debugging only; it is not for production use nor is it optimized.\n   * <p>\n   * Draws the bounding sphere for each draw command in the primitive.\n   * </p>\n   *\n   * @type {Boolean}\n   *\n   * @default false\n   */\n  this.debugShowBoundingVolume = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(\n    options.debugShowBoundingVolume,\n    false\n  );\n\n  /**\n   * @private\n   */\n  this.rtcCenter = options.rtcCenter;\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(this.rtcCenter) &&\n    (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(this.geometryInstances) ||\n      (Array.isArray(this.geometryInstances) &&\n        this.geometryInstances.length !== 1))\n  ) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z(\n      "Relative-to-center rendering only supports one geometry instance."\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  /**\n   * Determines whether this primitive casts or receives shadows from light sources.\n   *\n   * @type {ShadowMode}\n   *\n   * @default ShadowMode.DISABLED\n   */\n  this.shadows = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(options.shadows, _ShadowMode_js__WEBPACK_IMPORTED_MODULE_39__/* ["default"].DISABLED */ .Z.DISABLED);\n\n  this._translucent = undefined;\n\n  this._state = _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].READY */ .Z.READY;\n  this._geometries = [];\n  this._error = undefined;\n  this._numberOfInstances = 0;\n\n  this._boundingSpheres = [];\n  this._boundingSphereWC = [];\n  this._boundingSphereCV = [];\n  this._boundingSphere2D = [];\n  this._boundingSphereMorph = [];\n  this._perInstanceAttributeCache = [];\n  this._instanceIds = [];\n  this._lastPerInstanceAttributeIndex = 0;\n\n  this._va = [];\n  this._attributeLocations = undefined;\n  this._primitiveType = undefined;\n\n  this._frontFaceRS = undefined;\n  this._backFaceRS = undefined;\n  this._sp = undefined;\n\n  this._depthFailAppearance = undefined;\n  this._spDepthFail = undefined;\n  this._frontFaceDepthFailRS = undefined;\n  this._backFaceDepthFailRS = undefined;\n\n  this._pickIds = [];\n\n  this._colorCommands = [];\n  this._pickCommands = [];\n\n  this._createBoundingVolumeFunction = options._createBoundingVolumeFunction;\n  this._createRenderStatesFunction = options._createRenderStatesFunction;\n  this._createShaderProgramFunction = options._createShaderProgramFunction;\n  this._createCommandsFunction = options._createCommandsFunction;\n  this._updateAndQueueCommandsFunction =\n    options._updateAndQueueCommandsFunction;\n\n  this._createPickOffsets = options._createPickOffsets;\n  this._pickOffsets = undefined;\n\n  this._createGeometryResults = undefined;\n  this._ready = false;\n  this._readyPromise = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_32__/* ["default"].defer */ .Z.defer();\n\n  this._batchTable = undefined;\n  this._batchTableAttributeIndices = undefined;\n  this._offsetInstanceExtend = undefined;\n  this._batchTableOffsetAttribute2DIndex = undefined;\n  this._batchTableOffsetsUpdated = false;\n  this._instanceBoundingSpheres = undefined;\n  this._instanceBoundingSpheresCV = undefined;\n  this._tempBoundingSpheres = undefined;\n  this._recomputeBoundingSpheres = false;\n  this._batchTableBoundingSpheresUpdated = false;\n  this._batchTableBoundingSphereAttributeIndices = undefined;\n}\n\nObject.defineProperties(Primitive.prototype, {\n  /**\n   * When <code>true</code>, geometry vertices are optimized for the pre and post-vertex-shader caches.\n   *\n   * @memberof Primitive.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  vertexCacheOptimize: {\n    get: function () {\n      return this._vertexCacheOptimize;\n    },\n  },\n\n  /**\n   * Determines if geometry vertex attributes are interleaved, which can slightly improve rendering performance.\n   *\n   * @memberof Primitive.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default false\n   */\n  interleave: {\n    get: function () {\n      return this._interleave;\n    },\n  },\n\n  /**\n   * When <code>true</code>, the primitive does not keep a reference to the input <code>geometryInstances</code> to save memory.\n   *\n   * @memberof Primitive.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  releaseGeometryInstances: {\n    get: function () {\n      return this._releaseGeometryInstances;\n    },\n  },\n\n  /**\n   * When <code>true</code>, each geometry instance will only be pickable with {@link Scene#pick}.  When <code>false</code>, GPU memory is saved.         *\n   *\n   * @memberof Primitive.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  allowPicking: {\n    get: function () {\n      return this._allowPicking;\n    },\n  },\n\n  /**\n   * Determines if the geometry instances will be created and batched on a web worker.\n   *\n   * @memberof Primitive.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  asynchronous: {\n    get: function () {\n      return this._asynchronous;\n    },\n  },\n\n  /**\n   * When <code>true</code>, geometry vertices are compressed, which will save memory.\n   *\n   * @memberof Primitive.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  compressVertices: {\n    get: function () {\n      return this._compressVertices;\n    },\n  },\n\n  /**\n   * Determines if the primitive is complete and ready to render.  If this property is\n   * true, the primitive will be rendered the next time that {@link Primitive#update}\n   * is called.\n   *\n   * @memberof Primitive.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   */\n  ready: {\n    get: function () {\n      return this._ready;\n    },\n  },\n\n  /**\n   * Gets a promise that resolves when the primitive is ready to render.\n   * @memberof Primitive.prototype\n   * @type {Promise.<Primitive>}\n   * @readonly\n   */\n  readyPromise: {\n    get: function () {\n      return this._readyPromise.promise;\n    },\n  },\n});\n\nfunction getCommonPerInstanceAttributeNames(instances) {\n  var length = instances.length;\n\n  var attributesInAllInstances = [];\n  var attributes0 = instances[0].attributes;\n  var name;\n\n  for (name in attributes0) {\n    if (attributes0.hasOwnProperty(name) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(attributes0[name])) {\n      var attribute = attributes0[name];\n      var inAllInstances = true;\n\n      // Does this same attribute exist in all instances?\n      for (var i = 1; i < length; ++i) {\n        var otherAttribute = instances[i].attributes[name];\n\n        if (\n          !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(otherAttribute) ||\n          attribute.componentDatatype !== otherAttribute.componentDatatype ||\n          attribute.componentsPerAttribute !==\n            otherAttribute.componentsPerAttribute ||\n          attribute.normalize !== otherAttribute.normalize\n        ) {\n          inAllInstances = false;\n          break;\n        }\n      }\n\n      if (inAllInstances) {\n        attributesInAllInstances.push(name);\n      }\n    }\n  }\n\n  return attributesInAllInstances;\n}\n\nvar scratchGetAttributeCartesian2 = new _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\nvar scratchGetAttributeCartesian3 = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\nvar scratchGetAttributeCartesian4 = new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\n\nfunction getAttributeValue(value) {\n  var componentsPerAttribute = value.length;\n  if (componentsPerAttribute === 1) {\n    return value[0];\n  } else if (componentsPerAttribute === 2) {\n    return _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].unpack */ .Z.unpack(value, 0, scratchGetAttributeCartesian2);\n  } else if (componentsPerAttribute === 3) {\n    return _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].unpack */ .Z.unpack(value, 0, scratchGetAttributeCartesian3);\n  } else if (componentsPerAttribute === 4) {\n    return _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].unpack */ .Z.unpack(value, 0, scratchGetAttributeCartesian4);\n  }\n}\n\nfunction createBatchTable(primitive, context) {\n  var geometryInstances = primitive.geometryInstances;\n  var instances = Array.isArray(geometryInstances)\n    ? geometryInstances\n    : [geometryInstances];\n  var numberOfInstances = instances.length;\n  if (numberOfInstances === 0) {\n    return;\n  }\n\n  var names = getCommonPerInstanceAttributeNames(instances);\n  var length = names.length;\n\n  var attributes = [];\n  var attributeIndices = {};\n  var boundingSphereAttributeIndices = {};\n  var offset2DIndex;\n\n  var firstInstance = instances[0];\n  var instanceAttributes = firstInstance.attributes;\n\n  var i;\n  var name;\n  var attribute;\n\n  for (i = 0; i < length; ++i) {\n    name = names[i];\n    attribute = instanceAttributes[name];\n\n    attributeIndices[name] = i;\n    attributes.push({\n      functionName: "czm_batchTable_" + name,\n      componentDatatype: attribute.componentDatatype,\n      componentsPerAttribute: attribute.componentsPerAttribute,\n      normalize: attribute.normalize,\n    });\n  }\n\n  if (names.indexOf("distanceDisplayCondition") !== -1) {\n    attributes.push(\n      {\n        functionName: "czm_batchTable_boundingSphereCenter3DHigh",\n        componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].FLOAT */ .Z.FLOAT,\n        componentsPerAttribute: 3,\n      },\n      {\n        functionName: "czm_batchTable_boundingSphereCenter3DLow",\n        componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].FLOAT */ .Z.FLOAT,\n        componentsPerAttribute: 3,\n      },\n      {\n        functionName: "czm_batchTable_boundingSphereCenter2DHigh",\n        componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].FLOAT */ .Z.FLOAT,\n        componentsPerAttribute: 3,\n      },\n      {\n        functionName: "czm_batchTable_boundingSphereCenter2DLow",\n        componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].FLOAT */ .Z.FLOAT,\n        componentsPerAttribute: 3,\n      },\n      {\n        functionName: "czm_batchTable_boundingSphereRadius",\n        componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].FLOAT */ .Z.FLOAT,\n        componentsPerAttribute: 1,\n      }\n    );\n    boundingSphereAttributeIndices.center3DHigh = attributes.length - 5;\n    boundingSphereAttributeIndices.center3DLow = attributes.length - 4;\n    boundingSphereAttributeIndices.center2DHigh = attributes.length - 3;\n    boundingSphereAttributeIndices.center2DLow = attributes.length - 2;\n    boundingSphereAttributeIndices.radius = attributes.length - 1;\n  }\n\n  if (names.indexOf("offset") !== -1) {\n    attributes.push({\n      functionName: "czm_batchTable_offset2D",\n      componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].FLOAT */ .Z.FLOAT,\n      componentsPerAttribute: 3,\n    });\n    offset2DIndex = attributes.length - 1;\n  }\n\n  attributes.push({\n    functionName: "czm_batchTable_pickColor",\n    componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].UNSIGNED_BYTE */ .Z.UNSIGNED_BYTE,\n    componentsPerAttribute: 4,\n    normalize: true,\n  });\n\n  var attributesLength = attributes.length;\n  var batchTable = new _BatchTable_js__WEBPACK_IMPORTED_MODULE_33__/* ["default"] */ .Z(context, attributes, numberOfInstances);\n\n  for (i = 0; i < numberOfInstances; ++i) {\n    var instance = instances[i];\n    instanceAttributes = instance.attributes;\n\n    for (var j = 0; j < length; ++j) {\n      name = names[j];\n      attribute = instanceAttributes[name];\n      var value = getAttributeValue(attribute.value);\n      var attributeIndex = attributeIndices[name];\n      batchTable.setBatchedAttribute(i, attributeIndex, value);\n    }\n\n    var pickObject = {\n      primitive: (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(instance.pickPrimitive, primitive),\n    };\n\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(instance.id)) {\n      pickObject.id = instance.id;\n    }\n\n    var pickId = context.createPickId(pickObject);\n    primitive._pickIds.push(pickId);\n\n    var pickColor = pickId.color;\n    var color = scratchGetAttributeCartesian4;\n    color.x = _Core_Color_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].floatToByte */ .Z.floatToByte(pickColor.red);\n    color.y = _Core_Color_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].floatToByte */ .Z.floatToByte(pickColor.green);\n    color.z = _Core_Color_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].floatToByte */ .Z.floatToByte(pickColor.blue);\n    color.w = _Core_Color_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].floatToByte */ .Z.floatToByte(pickColor.alpha);\n\n    batchTable.setBatchedAttribute(i, attributesLength - 1, color);\n  }\n\n  primitive._batchTable = batchTable;\n  primitive._batchTableAttributeIndices = attributeIndices;\n  primitive._batchTableBoundingSphereAttributeIndices = boundingSphereAttributeIndices;\n  primitive._batchTableOffsetAttribute2DIndex = offset2DIndex;\n}\n\nfunction cloneAttribute(attribute) {\n  var clonedValues;\n  if (Array.isArray(attribute.values)) {\n    clonedValues = attribute.values.slice(0);\n  } else {\n    clonedValues = new attribute.values.constructor(attribute.values);\n  }\n  return new _Core_GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z({\n    componentDatatype: attribute.componentDatatype,\n    componentsPerAttribute: attribute.componentsPerAttribute,\n    normalize: attribute.normalize,\n    values: clonedValues,\n  });\n}\n\nfunction cloneGeometry(geometry) {\n  var attributes = geometry.attributes;\n  var newAttributes = new _Core_GeometryAttributes_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z();\n  for (var property in attributes) {\n    if (attributes.hasOwnProperty(property) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(attributes[property])) {\n      newAttributes[property] = cloneAttribute(attributes[property]);\n    }\n  }\n\n  var indices;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(geometry.indices)) {\n    var sourceValues = geometry.indices;\n    if (Array.isArray(sourceValues)) {\n      indices = sourceValues.slice(0);\n    } else {\n      indices = new sourceValues.constructor(sourceValues);\n    }\n  }\n\n  return new _Core_Geometry_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z({\n    attributes: newAttributes,\n    indices: indices,\n    primitiveType: geometry.primitiveType,\n    boundingSphere: _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone(geometry.boundingSphere),\n  });\n}\n\nfunction cloneInstance(instance, geometry) {\n  return {\n    geometry: geometry,\n    attributes: instance.attributes,\n    modelMatrix: _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].clone */ .Z.clone(instance.modelMatrix),\n    pickPrimitive: instance.pickPrimitive,\n    id: instance.id,\n  };\n}\n\nvar positionRegex = /attribute\\s+vec(?:3|4)\\s+(.*)3DHigh;/g;\n\nPrimitive._modifyShaderPosition = function (\n  primitive,\n  vertexShaderSource,\n  scene3DOnly\n) {\n  var match;\n\n  var forwardDecl = "";\n  var attributes = "";\n  var computeFunctions = "";\n\n  while ((match = positionRegex.exec(vertexShaderSource)) !== null) {\n    var name = match[1];\n\n    var functionName =\n      "vec4 czm_compute" + name[0].toUpperCase() + name.substr(1) + "()";\n\n    // Don\'t forward-declare czm_computePosition because computePosition.glsl already does.\n    if (functionName !== "vec4 czm_computePosition()") {\n      forwardDecl += functionName + ";\\n";\n    }\n\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive.rtcCenter)) {\n      // Use GPU RTE\n      if (!scene3DOnly) {\n        attributes +=\n          "attribute vec3 " +\n          name +\n          "2DHigh;\\n" +\n          "attribute vec3 " +\n          name +\n          "2DLow;\\n";\n\n        computeFunctions +=\n          functionName +\n          "\\n" +\n          "{\\n" +\n          "    vec4 p;\\n" +\n          "    if (czm_morphTime == 1.0)\\n" +\n          "    {\\n" +\n          "        p = czm_translateRelativeToEye(" +\n          name +\n          "3DHigh, " +\n          name +\n          "3DLow);\\n" +\n          "    }\\n" +\n          "    else if (czm_morphTime == 0.0)\\n" +\n          "    {\\n" +\n          "        p = czm_translateRelativeToEye(" +\n          name +\n          "2DHigh.zxy, " +\n          name +\n          "2DLow.zxy);\\n" +\n          "    }\\n" +\n          "    else\\n" +\n          "    {\\n" +\n          "        p = czm_columbusViewMorph(\\n" +\n          "                czm_translateRelativeToEye(" +\n          name +\n          "2DHigh.zxy, " +\n          name +\n          "2DLow.zxy),\\n" +\n          "                czm_translateRelativeToEye(" +\n          name +\n          "3DHigh, " +\n          name +\n          "3DLow),\\n" +\n          "                czm_morphTime);\\n" +\n          "    }\\n" +\n          "    return p;\\n" +\n          "}\\n\\n";\n      } else {\n        computeFunctions +=\n          functionName +\n          "\\n" +\n          "{\\n" +\n          "    return czm_translateRelativeToEye(" +\n          name +\n          "3DHigh, " +\n          name +\n          "3DLow);\\n" +\n          "}\\n\\n";\n      }\n    } else {\n      // Use RTC\n      vertexShaderSource = vertexShaderSource.replace(\n        /attribute\\s+vec(?:3|4)\\s+position3DHigh;/g,\n        ""\n      );\n      vertexShaderSource = vertexShaderSource.replace(\n        /attribute\\s+vec(?:3|4)\\s+position3DLow;/g,\n        ""\n      );\n\n      forwardDecl += "uniform mat4 u_modifiedModelView;\\n";\n      attributes += "attribute vec4 position;\\n";\n\n      computeFunctions +=\n        functionName +\n        "\\n" +\n        "{\\n" +\n        "    return u_modifiedModelView * position;\\n" +\n        "}\\n\\n";\n\n      vertexShaderSource = vertexShaderSource.replace(\n        /czm_modelViewRelativeToEye\\s+\\*\\s+/g,\n        ""\n      );\n      vertexShaderSource = vertexShaderSource.replace(\n        /czm_modelViewProjectionRelativeToEye/g,\n        "czm_projection"\n      );\n    }\n  }\n\n  return [forwardDecl, attributes, vertexShaderSource, computeFunctions].join(\n    "\\n"\n  );\n};\n\nPrimitive._appendShowToShader = function (primitive, vertexShaderSource) {\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._batchTableAttributeIndices.show)) {\n    return vertexShaderSource;\n  }\n\n  var renamedVS = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].replaceMain */ .Z.replaceMain(\n    vertexShaderSource,\n    "czm_non_show_main"\n  );\n  var showMain =\n    "void main() \\n" +\n    "{ \\n" +\n    "    czm_non_show_main(); \\n" +\n    "    gl_Position *= czm_batchTable_show(batchId); \\n" +\n    "}";\n\n  return renamedVS + "\\n" + showMain;\n};\n\nPrimitive._updateColorAttribute = function (\n  primitive,\n  vertexShaderSource,\n  isDepthFail\n) {\n  // some appearances have a color attribute for per vertex color.\n  // only remove if color is a per instance attribute.\n  if (\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._batchTableAttributeIndices.color) &&\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._batchTableAttributeIndices.depthFailColor)\n  ) {\n    return vertexShaderSource;\n  }\n\n  if (vertexShaderSource.search(/attribute\\s+vec4\\s+color;/g) === -1) {\n    return vertexShaderSource;\n  }\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (\n    isDepthFail &&\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._batchTableAttributeIndices.depthFailColor)\n  ) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z(\n      "A depthFailColor per-instance attribute is required when using a depth fail appearance that uses a color attribute."\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  var modifiedVS = vertexShaderSource;\n  modifiedVS = modifiedVS.replace(/attribute\\s+vec4\\s+color;/g, "");\n  if (!isDepthFail) {\n    modifiedVS = modifiedVS.replace(\n      /(\\b)color(\\b)/g,\n      "$1czm_batchTable_color(batchId)$2"\n    );\n  } else {\n    modifiedVS = modifiedVS.replace(\n      /(\\b)color(\\b)/g,\n      "$1czm_batchTable_depthFailColor(batchId)$2"\n    );\n  }\n  return modifiedVS;\n};\n\nfunction appendPickToVertexShader(source) {\n  var renamedVS = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].replaceMain */ .Z.replaceMain(source, "czm_non_pick_main");\n  var pickMain =\n    "varying vec4 v_pickColor; \\n" +\n    "void main() \\n" +\n    "{ \\n" +\n    "    czm_non_pick_main(); \\n" +\n    "    v_pickColor = czm_batchTable_pickColor(batchId); \\n" +\n    "}";\n\n  return renamedVS + "\\n" + pickMain;\n}\n\nfunction appendPickToFragmentShader(source) {\n  return "varying vec4 v_pickColor;\\n" + source;\n}\n\nPrimitive._updatePickColorAttribute = function (source) {\n  var vsPick = source.replace(/attribute\\s+vec4\\s+pickColor;/g, "");\n  vsPick = vsPick.replace(\n    /(\\b)pickColor(\\b)/g,\n    "$1czm_batchTable_pickColor(batchId)$2"\n  );\n  return vsPick;\n};\n\nPrimitive._appendOffsetToShader = function (primitive, vertexShaderSource) {\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._batchTableAttributeIndices.offset)) {\n    return vertexShaderSource;\n  }\n\n  var attr = "attribute float batchId;\\n";\n  attr += "attribute float applyOffset;";\n  var modifiedShader = vertexShaderSource.replace(\n    /attribute\\s+float\\s+batchId;/g,\n    attr\n  );\n\n  var str = "vec4 $1 = czm_computePosition();\\n";\n  str += "    if (czm_sceneMode == czm_sceneMode3D)\\n";\n  str += "    {\\n";\n  str +=\n    "        $1 = $1 + vec4(czm_batchTable_offset(batchId) * applyOffset, 0.0);";\n  str += "    }\\n";\n  str += "    else\\n";\n  str += "    {\\n";\n  str +=\n    "        $1 = $1 + vec4(czm_batchTable_offset2D(batchId) * applyOffset, 0.0);";\n  str += "    }\\n";\n  modifiedShader = modifiedShader.replace(\n    /vec4\\s+([A-Za-z0-9_]+)\\s+=\\s+czm_computePosition\\(\\);/g,\n    str\n  );\n  return modifiedShader;\n};\n\nPrimitive._appendDistanceDisplayConditionToShader = function (\n  primitive,\n  vertexShaderSource,\n  scene3DOnly\n) {\n  if (\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._batchTableAttributeIndices.distanceDisplayCondition)\n  ) {\n    return vertexShaderSource;\n  }\n\n  var renamedVS = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].replaceMain */ .Z.replaceMain(\n    vertexShaderSource,\n    "czm_non_distanceDisplayCondition_main"\n  );\n  var distanceDisplayConditionMain =\n    "void main() \\n" +\n    "{ \\n" +\n    "    czm_non_distanceDisplayCondition_main(); \\n" +\n    "    vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId);\\n" +\n    "    vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId);\\n" +\n    "    vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId);\\n" +\n    "    float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId);\\n";\n\n  if (!scene3DOnly) {\n    distanceDisplayConditionMain +=\n      "    vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId);\\n" +\n      "    vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId);\\n" +\n      "    vec4 centerRTE;\\n" +\n      "    if (czm_morphTime == 1.0)\\n" +\n      "    {\\n" +\n      "        centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\\n" +\n      "    }\\n" +\n      "    else if (czm_morphTime == 0.0)\\n" +\n      "    {\\n" +\n      "        centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy);\\n" +\n      "    }\\n" +\n      "    else\\n" +\n      "    {\\n" +\n      "        centerRTE = czm_columbusViewMorph(\\n" +\n      "                czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy),\\n" +\n      "                czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow),\\n" +\n      "                czm_morphTime);\\n" +\n      "    }\\n";\n  } else {\n    distanceDisplayConditionMain +=\n      "    vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\\n";\n  }\n\n  distanceDisplayConditionMain +=\n    "    float radiusSq = boundingSphereRadius * boundingSphereRadius; \\n" +\n    "    float distanceSq; \\n" +\n    "    if (czm_sceneMode == czm_sceneMode2D) \\n" +\n    "    { \\n" +\n    "        distanceSq = czm_eyeHeight2D.y - radiusSq; \\n" +\n    "    } \\n" +\n    "    else \\n" +\n    "    { \\n" +\n    "        distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; \\n" +\n    "    } \\n" +\n    "    distanceSq = max(distanceSq, 0.0); \\n" +\n    "    float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; \\n" +\n    "    float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; \\n" +\n    "    float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; \\n" +\n    "    gl_Position *= show; \\n" +\n    "}";\n  return renamedVS + "\\n" + distanceDisplayConditionMain;\n};\n\nfunction modifyForEncodedNormals(primitive, vertexShaderSource) {\n  if (!primitive.compressVertices) {\n    return vertexShaderSource;\n  }\n\n  var containsNormal =\n    vertexShaderSource.search(/attribute\\s+vec3\\s+normal;/g) !== -1;\n  var containsSt = vertexShaderSource.search(/attribute\\s+vec2\\s+st;/g) !== -1;\n  if (!containsNormal && !containsSt) {\n    return vertexShaderSource;\n  }\n\n  var containsTangent =\n    vertexShaderSource.search(/attribute\\s+vec3\\s+tangent;/g) !== -1;\n  var containsBitangent =\n    vertexShaderSource.search(/attribute\\s+vec3\\s+bitangent;/g) !== -1;\n\n  var numComponents = containsSt && containsNormal ? 2.0 : 1.0;\n  numComponents += containsTangent || containsBitangent ? 1 : 0;\n\n  var type = numComponents > 1 ? "vec" + numComponents : "float";\n\n  var attributeName = "compressedAttributes";\n  var attributeDecl = "attribute " + type + " " + attributeName + ";";\n\n  var globalDecl = "";\n  var decode = "";\n\n  if (containsSt) {\n    globalDecl += "vec2 st;\\n";\n    var stComponent = numComponents > 1 ? attributeName + ".x" : attributeName;\n    decode +=\n      "    st = czm_decompressTextureCoordinates(" + stComponent + ");\\n";\n  }\n\n  if (containsNormal && containsTangent && containsBitangent) {\n    globalDecl += "vec3 normal;\\n" + "vec3 tangent;\\n" + "vec3 bitangent;\\n";\n    decode +=\n      "    czm_octDecode(" +\n      attributeName +\n      "." +\n      (containsSt ? "yz" : "xy") +\n      ", normal, tangent, bitangent);\\n";\n  } else {\n    if (containsNormal) {\n      globalDecl += "vec3 normal;\\n";\n      decode +=\n        "    normal = czm_octDecode(" +\n        attributeName +\n        (numComponents > 1 ? "." + (containsSt ? "y" : "x") : "") +\n        ");\\n";\n    }\n\n    if (containsTangent) {\n      globalDecl += "vec3 tangent;\\n";\n      decode +=\n        "    tangent = czm_octDecode(" +\n        attributeName +\n        "." +\n        (containsSt && containsNormal ? "z" : "y") +\n        ");\\n";\n    }\n\n    if (containsBitangent) {\n      globalDecl += "vec3 bitangent;\\n";\n      decode +=\n        "    bitangent = czm_octDecode(" +\n        attributeName +\n        "." +\n        (containsSt && containsNormal ? "z" : "y") +\n        ");\\n";\n    }\n  }\n\n  var modifiedVS = vertexShaderSource;\n  modifiedVS = modifiedVS.replace(/attribute\\s+vec3\\s+normal;/g, "");\n  modifiedVS = modifiedVS.replace(/attribute\\s+vec2\\s+st;/g, "");\n  modifiedVS = modifiedVS.replace(/attribute\\s+vec3\\s+tangent;/g, "");\n  modifiedVS = modifiedVS.replace(/attribute\\s+vec3\\s+bitangent;/g, "");\n  modifiedVS = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].replaceMain */ .Z.replaceMain(modifiedVS, "czm_non_compressed_main");\n  var compressedMain =\n    "void main() \\n" +\n    "{ \\n" +\n    decode +\n    "    czm_non_compressed_main(); \\n" +\n    "}";\n\n  return [attributeDecl, globalDecl, modifiedVS, compressedMain].join("\\n");\n}\n\nfunction depthClampVS(vertexShaderSource) {\n  var modifiedVS = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].replaceMain */ .Z.replaceMain(\n    vertexShaderSource,\n    "czm_non_depth_clamp_main"\n  );\n  modifiedVS +=\n    "void main() {\\n" +\n    "    czm_non_depth_clamp_main();\\n" +\n    "    gl_Position = czm_depthClamp(gl_Position);" +\n    "}\\n";\n  return modifiedVS;\n}\n\nfunction depthClampFS(fragmentShaderSource) {\n  var modifiedFS = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].replaceMain */ .Z.replaceMain(\n    fragmentShaderSource,\n    "czm_non_depth_clamp_main"\n  );\n  modifiedFS +=\n    "void main() {\\n" +\n    "    czm_non_depth_clamp_main();\\n" +\n    "#if defined(GL_EXT_frag_depth)\\n" +\n    "    #if defined(LOG_DEPTH)\\n" +\n    "        czm_writeLogDepth();\\n" +\n    "    #else\\n" +\n    "        czm_writeDepthClamp();\\n" +\n    "    #endif\\n" +\n    "#endif\\n" +\n    "}\\n";\n  modifiedFS =\n    "#ifdef GL_EXT_frag_depth\\n" +\n    "#extension GL_EXT_frag_depth : enable\\n" +\n    "#endif\\n" +\n    modifiedFS;\n  return modifiedFS;\n}\n\nfunction validateShaderMatching(shaderProgram, attributeLocations) {\n  // For a VAO and shader program to be compatible, the VAO must have\n  // all active attribute in the shader program.  The VAO may have\n  // extra attributes with the only concern being a potential\n  // performance hit due to extra memory bandwidth and cache pollution.\n  // The shader source could have extra attributes that are not used,\n  // but there is no guarantee they will be optimized out.\n  //\n  // Here, we validate that the VAO has all attributes required\n  // to match the shader program.\n  var shaderAttributes = shaderProgram.vertexAttributes;\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  for (var name in shaderAttributes) {\n    if (shaderAttributes.hasOwnProperty(name)) {\n      if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(attributeLocations[name])) {\n        throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z(\n          "Appearance/Geometry mismatch.  The appearance requires vertex shader attribute input \'" +\n            name +\n            "\', which was not computed as part of the Geometry.  Use the appearance\'s vertexFormat property when constructing the geometry."\n        );\n      }\n    }\n  }\n  //>>includeEnd(\'debug\');\n}\n\nfunction getUniformFunction(uniforms, name) {\n  return function () {\n    return uniforms[name];\n  };\n}\n\nvar numberOfCreationWorkers = Math.max(\n  _Core_FeatureDetection_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].hardwareConcurrency */ .Z.hardwareConcurrency - 1,\n  1\n);\nvar createGeometryTaskProcessors;\nvar combineGeometryTaskProcessor = new _Core_TaskProcessor_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z("combineGeometry");\n\nfunction loadAsynchronous(primitive, frameState) {\n  var instances;\n  var geometry;\n  var i;\n  var j;\n\n  var instanceIds = primitive._instanceIds;\n\n  if (primitive._state === _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].READY */ .Z.READY) {\n    instances = Array.isArray(primitive.geometryInstances)\n      ? primitive.geometryInstances\n      : [primitive.geometryInstances];\n    var length = (primitive._numberOfInstances = instances.length);\n\n    var promises = [];\n    var subTasks = [];\n    for (i = 0; i < length; ++i) {\n      geometry = instances[i].geometry;\n      instanceIds.push(instances[i].id);\n\n      //>>includeStart(\'debug\', pragmas.debug);\n      if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(geometry._workerName)) {\n        throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z(\n          "_workerName must be defined for asynchronous geometry."\n        );\n      }\n      //>>includeEnd(\'debug\');\n\n      subTasks.push({\n        moduleName: geometry._workerName,\n        geometry: geometry,\n      });\n    }\n\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(createGeometryTaskProcessors)) {\n      createGeometryTaskProcessors = new Array(numberOfCreationWorkers);\n      for (i = 0; i < numberOfCreationWorkers; i++) {\n        createGeometryTaskProcessors[i] = new _Core_TaskProcessor_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z("createGeometry");\n      }\n    }\n\n    var subTask;\n    subTasks = (0,_Core_subdivideArray_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(subTasks, numberOfCreationWorkers);\n\n    for (i = 0; i < subTasks.length; i++) {\n      var packedLength = 0;\n      var workerSubTasks = subTasks[i];\n      var workerSubTasksLength = workerSubTasks.length;\n      for (j = 0; j < workerSubTasksLength; ++j) {\n        subTask = workerSubTasks[j];\n        geometry = subTask.geometry;\n        if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(geometry.constructor.pack)) {\n          subTask.offset = packedLength;\n          packedLength += (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(\n            geometry.constructor.packedLength,\n            geometry.packedLength\n          );\n        }\n      }\n\n      var subTaskTransferableObjects;\n\n      if (packedLength > 0) {\n        var array = new Float64Array(packedLength);\n        subTaskTransferableObjects = [array.buffer];\n\n        for (j = 0; j < workerSubTasksLength; ++j) {\n          subTask = workerSubTasks[j];\n          geometry = subTask.geometry;\n          if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(geometry.constructor.pack)) {\n            geometry.constructor.pack(geometry, array, subTask.offset);\n            subTask.geometry = array;\n          }\n        }\n      }\n\n      promises.push(\n        createGeometryTaskProcessors[i].scheduleTask(\n          {\n            subTasks: subTasks[i],\n          },\n          subTaskTransferableObjects\n        )\n      );\n    }\n\n    primitive._state = _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].CREATING */ .Z.CREATING;\n\n    _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_32__/* ["default"].all */ .Z.all(promises, function (results) {\n        primitive._createGeometryResults = results;\n        primitive._state = _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].CREATED */ .Z.CREATED;\n      })\n      .otherwise(function (error) {\n        setReady(primitive, frameState, _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].FAILED */ .Z.FAILED, error);\n      });\n  } else if (primitive._state === _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].CREATED */ .Z.CREATED) {\n    var transferableObjects = [];\n    instances = Array.isArray(primitive.geometryInstances)\n      ? primitive.geometryInstances\n      : [primitive.geometryInstances];\n\n    var scene3DOnly = frameState.scene3DOnly;\n    var projection = frameState.mapProjection;\n\n    var promise = combineGeometryTaskProcessor.scheduleTask(\n      _PrimitivePipeline_js__WEBPACK_IMPORTED_MODULE_36__/* ["default"].packCombineGeometryParameters */ .Z.packCombineGeometryParameters(\n        {\n          createGeometryResults: primitive._createGeometryResults,\n          instances: instances,\n          ellipsoid: projection.ellipsoid,\n          projection: projection,\n          elementIndexUintSupported: frameState.context.elementIndexUint,\n          scene3DOnly: scene3DOnly,\n          vertexCacheOptimize: primitive.vertexCacheOptimize,\n          compressVertices: primitive.compressVertices,\n          modelMatrix: primitive.modelMatrix,\n          createPickOffsets: primitive._createPickOffsets,\n        },\n        transferableObjects\n      ),\n      transferableObjects\n    );\n\n    primitive._createGeometryResults = undefined;\n    primitive._state = _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].COMBINING */ .Z.COMBINING;\n\n    (0,_ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_32__/* ["default"] */ .Z)(promise, function (packedResult) {\n      var result = _PrimitivePipeline_js__WEBPACK_IMPORTED_MODULE_36__/* ["default"].unpackCombineGeometryResults */ .Z.unpackCombineGeometryResults(packedResult);\n      primitive._geometries = result.geometries;\n      primitive._attributeLocations = result.attributeLocations;\n      primitive.modelMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].clone */ .Z.clone(\n        result.modelMatrix,\n        primitive.modelMatrix\n      );\n      primitive._pickOffsets = result.pickOffsets;\n      primitive._offsetInstanceExtend = result.offsetInstanceExtend;\n      primitive._instanceBoundingSpheres = result.boundingSpheres;\n      primitive._instanceBoundingSpheresCV = result.boundingSpheresCV;\n\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._geometries) && primitive._geometries.length > 0) {\n        primitive._recomputeBoundingSpheres = true;\n        primitive._state = _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].COMBINED */ .Z.COMBINED;\n      } else {\n        setReady(primitive, frameState, _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].FAILED */ .Z.FAILED, undefined);\n      }\n    }).otherwise(function (error) {\n      setReady(primitive, frameState, _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].FAILED */ .Z.FAILED, error);\n    });\n  }\n}\n\nfunction loadSynchronous(primitive, frameState) {\n  var instances = Array.isArray(primitive.geometryInstances)\n    ? primitive.geometryInstances\n    : [primitive.geometryInstances];\n  var length = (primitive._numberOfInstances = instances.length);\n  var clonedInstances = new Array(length);\n  var instanceIds = primitive._instanceIds;\n\n  var instance;\n  var i;\n\n  var geometryIndex = 0;\n  for (i = 0; i < length; i++) {\n    instance = instances[i];\n    var geometry = instance.geometry;\n\n    var createdGeometry;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(geometry.attributes) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(geometry.primitiveType)) {\n      createdGeometry = cloneGeometry(geometry);\n    } else {\n      createdGeometry = geometry.constructor.createGeometry(geometry);\n    }\n\n    clonedInstances[geometryIndex++] = cloneInstance(instance, createdGeometry);\n    instanceIds.push(instance.id);\n  }\n\n  clonedInstances.length = geometryIndex;\n\n  var scene3DOnly = frameState.scene3DOnly;\n  var projection = frameState.mapProjection;\n\n  var result = _PrimitivePipeline_js__WEBPACK_IMPORTED_MODULE_36__/* ["default"].combineGeometry */ .Z.combineGeometry({\n    instances: clonedInstances,\n    ellipsoid: projection.ellipsoid,\n    projection: projection,\n    elementIndexUintSupported: frameState.context.elementIndexUint,\n    scene3DOnly: scene3DOnly,\n    vertexCacheOptimize: primitive.vertexCacheOptimize,\n    compressVertices: primitive.compressVertices,\n    modelMatrix: primitive.modelMatrix,\n    createPickOffsets: primitive._createPickOffsets,\n  });\n\n  primitive._geometries = result.geometries;\n  primitive._attributeLocations = result.attributeLocations;\n  primitive.modelMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].clone */ .Z.clone(\n    result.modelMatrix,\n    primitive.modelMatrix\n  );\n  primitive._pickOffsets = result.pickOffsets;\n  primitive._offsetInstanceExtend = result.offsetInstanceExtend;\n  primitive._instanceBoundingSpheres = result.boundingSpheres;\n  primitive._instanceBoundingSpheresCV = result.boundingSpheresCV;\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._geometries) && primitive._geometries.length > 0) {\n    primitive._recomputeBoundingSpheres = true;\n    primitive._state = _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].COMBINED */ .Z.COMBINED;\n  } else {\n    setReady(primitive, frameState, _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].FAILED */ .Z.FAILED, undefined);\n  }\n}\n\nfunction recomputeBoundingSpheres(primitive, frameState) {\n  var offsetIndex = primitive._batchTableAttributeIndices.offset;\n  if (!primitive._recomputeBoundingSpheres || !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(offsetIndex)) {\n    primitive._recomputeBoundingSpheres = false;\n    return;\n  }\n\n  var i;\n  var offsetInstanceExtend = primitive._offsetInstanceExtend;\n  var boundingSpheres = primitive._instanceBoundingSpheres;\n  var length = boundingSpheres.length;\n  var newBoundingSpheres = primitive._tempBoundingSpheres;\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(newBoundingSpheres)) {\n    newBoundingSpheres = new Array(length);\n    for (i = 0; i < length; i++) {\n      newBoundingSpheres[i] = new _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\n    }\n    primitive._tempBoundingSpheres = newBoundingSpheres;\n  }\n  for (i = 0; i < length; ++i) {\n    var newBS = newBoundingSpheres[i];\n    var offset = primitive._batchTable.getBatchedAttribute(\n      i,\n      offsetIndex,\n      new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z()\n    );\n    newBS = boundingSpheres[i].clone(newBS);\n    transformBoundingSphere(newBS, offset, offsetInstanceExtend[i]);\n  }\n  var combinedBS = [];\n  var combinedWestBS = [];\n  var combinedEastBS = [];\n\n  for (i = 0; i < length; ++i) {\n    var bs = newBoundingSpheres[i];\n\n    var minX = bs.center.x - bs.radius;\n    if (\n      minX > 0 ||\n      _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].intersectPlane */ .Z.intersectPlane(bs, _Core_Plane_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"].ORIGIN_ZX_PLANE */ .Z.ORIGIN_ZX_PLANE) !==\n        _Core_Intersect_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].INTERSECTING */ .Z.INTERSECTING\n    ) {\n      combinedBS.push(bs);\n    } else {\n      combinedWestBS.push(bs);\n      combinedEastBS.push(bs);\n    }\n  }\n\n  var resultBS1 = combinedBS[0];\n  var resultBS2 = combinedEastBS[0];\n  var resultBS3 = combinedWestBS[0];\n\n  for (i = 1; i < combinedBS.length; i++) {\n    resultBS1 = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].union */ .Z.union(resultBS1, combinedBS[i]);\n  }\n  for (i = 1; i < combinedEastBS.length; i++) {\n    resultBS2 = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].union */ .Z.union(resultBS2, combinedEastBS[i]);\n  }\n  for (i = 1; i < combinedWestBS.length; i++) {\n    resultBS3 = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].union */ .Z.union(resultBS3, combinedWestBS[i]);\n  }\n  var result = [];\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(resultBS1)) {\n    result.push(resultBS1);\n  }\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(resultBS2)) {\n    result.push(resultBS2);\n  }\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(resultBS3)) {\n    result.push(resultBS3);\n  }\n\n  for (i = 0; i < result.length; i++) {\n    var boundingSphere = result[i].clone(primitive._boundingSpheres[i]);\n    primitive._boundingSpheres[i] = boundingSphere;\n    primitive._boundingSphereCV[i] = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].projectTo2D */ .Z.projectTo2D(\n      boundingSphere,\n      frameState.mapProjection,\n      primitive._boundingSphereCV[i]\n    );\n  }\n\n  Primitive._updateBoundingVolumes(\n    primitive,\n    frameState,\n    primitive.modelMatrix,\n    true\n  );\n  primitive._recomputeBoundingSpheres = false;\n}\n\nvar scratchBoundingSphereCenterEncoded = new _Core_EncodedCartesian3_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z();\nvar scratchBoundingSphereCartographic = new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\nvar scratchBoundingSphereCenter2D = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\nvar scratchBoundingSphere = new _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\n\nfunction updateBatchTableBoundingSpheres(primitive, frameState) {\n  var hasDistanceDisplayCondition = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(\n    primitive._batchTableAttributeIndices.distanceDisplayCondition\n  );\n  if (\n    !hasDistanceDisplayCondition ||\n    primitive._batchTableBoundingSpheresUpdated\n  ) {\n    return;\n  }\n\n  var indices = primitive._batchTableBoundingSphereAttributeIndices;\n  var center3DHighIndex = indices.center3DHigh;\n  var center3DLowIndex = indices.center3DLow;\n  var center2DHighIndex = indices.center2DHigh;\n  var center2DLowIndex = indices.center2DLow;\n  var radiusIndex = indices.radius;\n\n  var projection = frameState.mapProjection;\n  var ellipsoid = projection.ellipsoid;\n\n  var batchTable = primitive._batchTable;\n  var boundingSpheres = primitive._instanceBoundingSpheres;\n  var length = boundingSpheres.length;\n\n  for (var i = 0; i < length; ++i) {\n    var boundingSphere = boundingSpheres[i];\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(boundingSphere)) {\n      continue;\n    }\n\n    var modelMatrix = primitive.modelMatrix;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(modelMatrix)) {\n      boundingSphere = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].transform */ .Z.transform(\n        boundingSphere,\n        modelMatrix,\n        scratchBoundingSphere\n      );\n    }\n\n    var center = boundingSphere.center;\n    var radius = boundingSphere.radius;\n\n    var encodedCenter = _Core_EncodedCartesian3_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].fromCartesian */ .Z.fromCartesian(\n      center,\n      scratchBoundingSphereCenterEncoded\n    );\n    batchTable.setBatchedAttribute(i, center3DHighIndex, encodedCenter.high);\n    batchTable.setBatchedAttribute(i, center3DLowIndex, encodedCenter.low);\n\n    if (!frameState.scene3DOnly) {\n      var cartographic = ellipsoid.cartesianToCartographic(\n        center,\n        scratchBoundingSphereCartographic\n      );\n      var center2D = projection.project(\n        cartographic,\n        scratchBoundingSphereCenter2D\n      );\n      encodedCenter = _Core_EncodedCartesian3_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].fromCartesian */ .Z.fromCartesian(\n        center2D,\n        scratchBoundingSphereCenterEncoded\n      );\n      batchTable.setBatchedAttribute(i, center2DHighIndex, encodedCenter.high);\n      batchTable.setBatchedAttribute(i, center2DLowIndex, encodedCenter.low);\n    }\n\n    batchTable.setBatchedAttribute(i, radiusIndex, radius);\n  }\n\n  primitive._batchTableBoundingSpheresUpdated = true;\n}\n\nvar offsetScratchCartesian = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\nvar offsetCenterScratch = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\nfunction updateBatchTableOffsets(primitive, frameState) {\n  var hasOffset = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._batchTableAttributeIndices.offset);\n  if (\n    !hasOffset ||\n    primitive._batchTableOffsetsUpdated ||\n    frameState.scene3DOnly\n  ) {\n    return;\n  }\n\n  var index2D = primitive._batchTableOffsetAttribute2DIndex;\n\n  var projection = frameState.mapProjection;\n  var ellipsoid = projection.ellipsoid;\n\n  var batchTable = primitive._batchTable;\n  var boundingSpheres = primitive._instanceBoundingSpheres;\n  var length = boundingSpheres.length;\n\n  for (var i = 0; i < length; ++i) {\n    var boundingSphere = boundingSpheres[i];\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(boundingSphere)) {\n      continue;\n    }\n    var offset = batchTable.getBatchedAttribute(\n      i,\n      primitive._batchTableAttributeIndices.offset\n    );\n    if (_Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].equals */ .Z.equals(offset, _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].ZERO */ .Z.ZERO)) {\n      batchTable.setBatchedAttribute(i, index2D, _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].ZERO */ .Z.ZERO);\n      continue;\n    }\n\n    var modelMatrix = primitive.modelMatrix;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(modelMatrix)) {\n      boundingSphere = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].transform */ .Z.transform(\n        boundingSphere,\n        modelMatrix,\n        scratchBoundingSphere\n      );\n    }\n\n    var center = boundingSphere.center;\n    center = ellipsoid.scaleToGeodeticSurface(center, offsetCenterScratch);\n    var cartographic = ellipsoid.cartesianToCartographic(\n      center,\n      scratchBoundingSphereCartographic\n    );\n    var center2D = projection.project(\n      cartographic,\n      scratchBoundingSphereCenter2D\n    );\n\n    var newPoint = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].add */ .Z.add(offset, center, offsetScratchCartesian);\n    cartographic = ellipsoid.cartesianToCartographic(newPoint, cartographic);\n\n    var newPointProjected = projection.project(\n      cartographic,\n      offsetScratchCartesian\n    );\n\n    var newVector = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].subtract */ .Z.subtract(\n      newPointProjected,\n      center2D,\n      offsetScratchCartesian\n    );\n\n    var x = newVector.x;\n    newVector.x = newVector.z;\n    newVector.z = newVector.y;\n    newVector.y = x;\n\n    batchTable.setBatchedAttribute(i, index2D, newVector);\n  }\n\n  primitive._batchTableOffsetsUpdated = true;\n}\n\nfunction createVertexArray(primitive, frameState) {\n  var attributeLocations = primitive._attributeLocations;\n  var geometries = primitive._geometries;\n  var scene3DOnly = frameState.scene3DOnly;\n  var context = frameState.context;\n\n  var va = [];\n  var length = geometries.length;\n  for (var i = 0; i < length; ++i) {\n    var geometry = geometries[i];\n\n    va.push(\n      _Renderer_VertexArray_js__WEBPACK_IMPORTED_MODULE_31__/* ["default"].fromGeometry */ .Z.fromGeometry({\n        context: context,\n        geometry: geometry,\n        attributeLocations: attributeLocations,\n        bufferUsage: _Renderer_BufferUsage_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].STATIC_DRAW */ .Z.STATIC_DRAW,\n        interleave: primitive._interleave,\n      })\n    );\n\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._createBoundingVolumeFunction)) {\n      primitive._createBoundingVolumeFunction(frameState, geometry);\n    } else {\n      primitive._boundingSpheres.push(\n        _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone(geometry.boundingSphere)\n      );\n      primitive._boundingSphereWC.push(new _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z());\n\n      if (!scene3DOnly) {\n        var center = geometry.boundingSphereCV.center;\n        var x = center.x;\n        var y = center.y;\n        var z = center.z;\n        center.x = z;\n        center.y = x;\n        center.z = y;\n\n        primitive._boundingSphereCV.push(\n          _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone(geometry.boundingSphereCV)\n        );\n        primitive._boundingSphere2D.push(new _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z());\n        primitive._boundingSphereMorph.push(new _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z());\n      }\n    }\n  }\n\n  primitive._va = va;\n  primitive._primitiveType = geometries[0].primitiveType;\n\n  if (primitive.releaseGeometryInstances) {\n    primitive.geometryInstances = undefined;\n  }\n\n  primitive._geometries = undefined;\n  setReady(primitive, frameState, _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].COMPLETE */ .Z.COMPLETE, undefined);\n}\n\nfunction createRenderStates(primitive, context, appearance, twoPasses) {\n  var renderState = appearance.getRenderState();\n  var rs;\n\n  if (twoPasses) {\n    rs = (0,_Core_clone_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(renderState, false);\n    rs.cull = {\n      enabled: true,\n      face: _CullFace_js__WEBPACK_IMPORTED_MODULE_34__/* ["default"].BACK */ .Z.BACK,\n    };\n    primitive._frontFaceRS = _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_28__/* ["default"].fromCache */ .Z.fromCache(rs);\n\n    rs.cull.face = _CullFace_js__WEBPACK_IMPORTED_MODULE_34__/* ["default"].FRONT */ .Z.FRONT;\n    primitive._backFaceRS = _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_28__/* ["default"].fromCache */ .Z.fromCache(rs);\n  } else {\n    primitive._frontFaceRS = _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_28__/* ["default"].fromCache */ .Z.fromCache(renderState);\n    primitive._backFaceRS = primitive._frontFaceRS;\n  }\n\n  rs = (0,_Core_clone_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(renderState, false);\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._depthFailAppearance)) {\n    rs.depthTest.enabled = false;\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._depthFailAppearance)) {\n    renderState = primitive._depthFailAppearance.getRenderState();\n    rs = (0,_Core_clone_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(renderState, false);\n    rs.depthTest.func = _DepthFunction_js__WEBPACK_IMPORTED_MODULE_35__/* ["default"].GREATER */ .Z.GREATER;\n    if (twoPasses) {\n      rs.cull = {\n        enabled: true,\n        face: _CullFace_js__WEBPACK_IMPORTED_MODULE_34__/* ["default"].BACK */ .Z.BACK,\n      };\n      primitive._frontFaceDepthFailRS = _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_28__/* ["default"].fromCache */ .Z.fromCache(rs);\n\n      rs.cull.face = _CullFace_js__WEBPACK_IMPORTED_MODULE_34__/* ["default"].FRONT */ .Z.FRONT;\n      primitive._backFaceDepthFailRS = _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_28__/* ["default"].fromCache */ .Z.fromCache(rs);\n    } else {\n      primitive._frontFaceDepthFailRS = _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_28__/* ["default"].fromCache */ .Z.fromCache(rs);\n      primitive._backFaceDepthFailRS = primitive._frontFaceRS;\n    }\n  }\n}\n\nfunction createShaderProgram(primitive, frameState, appearance) {\n  var context = frameState.context;\n\n  var attributeLocations = primitive._attributeLocations;\n\n  var vs = primitive._batchTable.getVertexShaderCallback()(\n    appearance.vertexShaderSource\n  );\n  vs = Primitive._appendOffsetToShader(primitive, vs);\n  vs = Primitive._appendShowToShader(primitive, vs);\n  vs = Primitive._appendDistanceDisplayConditionToShader(\n    primitive,\n    vs,\n    frameState.scene3DOnly\n  );\n  vs = appendPickToVertexShader(vs);\n  vs = Primitive._updateColorAttribute(primitive, vs, false);\n  vs = modifyForEncodedNormals(primitive, vs);\n  vs = Primitive._modifyShaderPosition(primitive, vs, frameState.scene3DOnly);\n  var fs = appearance.getFragmentShaderSource();\n  fs = appendPickToFragmentShader(fs);\n\n  primitive._sp = _Renderer_ShaderProgram_js__WEBPACK_IMPORTED_MODULE_29__/* ["default"].replaceCache */ .Z.replaceCache({\n    context: context,\n    shaderProgram: primitive._sp,\n    vertexShaderSource: vs,\n    fragmentShaderSource: fs,\n    attributeLocations: attributeLocations,\n  });\n  validateShaderMatching(primitive._sp, attributeLocations);\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._depthFailAppearance)) {\n    vs = primitive._batchTable.getVertexShaderCallback()(\n      primitive._depthFailAppearance.vertexShaderSource\n    );\n    vs = Primitive._appendShowToShader(primitive, vs);\n    vs = Primitive._appendDistanceDisplayConditionToShader(\n      primitive,\n      vs,\n      frameState.scene3DOnly\n    );\n    vs = appendPickToVertexShader(vs);\n    vs = Primitive._updateColorAttribute(primitive, vs, true);\n    vs = modifyForEncodedNormals(primitive, vs);\n    vs = Primitive._modifyShaderPosition(primitive, vs, frameState.scene3DOnly);\n    vs = depthClampVS(vs);\n\n    fs = primitive._depthFailAppearance.getFragmentShaderSource();\n    fs = appendPickToFragmentShader(fs);\n    fs = depthClampFS(fs);\n\n    primitive._spDepthFail = _Renderer_ShaderProgram_js__WEBPACK_IMPORTED_MODULE_29__/* ["default"].replaceCache */ .Z.replaceCache({\n      context: context,\n      shaderProgram: primitive._spDepthFail,\n      vertexShaderSource: vs,\n      fragmentShaderSource: fs,\n      attributeLocations: attributeLocations,\n    });\n    validateShaderMatching(primitive._spDepthFail, attributeLocations);\n  }\n}\n\nvar modifiedModelViewScratch = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z();\nvar rtcScratch = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\n\nfunction getUniforms(primitive, appearance, material, frameState) {\n  // Create uniform map by combining uniforms from the appearance and material if either have uniforms.\n  var materialUniformMap = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(material) ? material._uniforms : undefined;\n  var appearanceUniformMap = {};\n  var appearanceUniforms = appearance.uniforms;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(appearanceUniforms)) {\n    // Convert to uniform map of functions for the renderer\n    for (var name in appearanceUniforms) {\n      if (appearanceUniforms.hasOwnProperty(name)) {\n        //>>includeStart(\'debug\', pragmas.debug);\n        if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(materialUniformMap) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(materialUniformMap[name])) {\n          // Later, we could rename uniforms behind-the-scenes if needed.\n          throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z(\n            "Appearance and material have a uniform with the same name: " + name\n          );\n        }\n        //>>includeEnd(\'debug\');\n\n        appearanceUniformMap[name] = getUniformFunction(\n          appearanceUniforms,\n          name\n        );\n      }\n    }\n  }\n  var uniforms = (0,_Core_combine_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(appearanceUniformMap, materialUniformMap);\n  uniforms = primitive._batchTable.getUniformMapCallback()(uniforms);\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive.rtcCenter)) {\n    uniforms.u_modifiedModelView = function () {\n      var viewMatrix = frameState.context.uniformState.view;\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiply */ .Z.multiply(\n        viewMatrix,\n        primitive._modelMatrix,\n        modifiedModelViewScratch\n      );\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiplyByPoint */ .Z.multiplyByPoint(\n        modifiedModelViewScratch,\n        primitive.rtcCenter,\n        rtcScratch\n      );\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].setTranslation */ .Z.setTranslation(\n        modifiedModelViewScratch,\n        rtcScratch,\n        modifiedModelViewScratch\n      );\n      return modifiedModelViewScratch;\n    };\n  }\n\n  return uniforms;\n}\n\nfunction createCommands(\n  primitive,\n  appearance,\n  material,\n  translucent,\n  twoPasses,\n  colorCommands,\n  pickCommands,\n  frameState\n) {\n  var uniforms = getUniforms(primitive, appearance, material, frameState);\n\n  var depthFailUniforms;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._depthFailAppearance)) {\n    depthFailUniforms = getUniforms(\n      primitive,\n      primitive._depthFailAppearance,\n      primitive._depthFailAppearance.material,\n      frameState\n    );\n  }\n\n  var pass = translucent ? _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_27__/* ["default"].TRANSLUCENT */ .Z.TRANSLUCENT : _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_27__/* ["default"].OPAQUE */ .Z.OPAQUE;\n\n  var multiplier = twoPasses ? 2 : 1;\n  multiplier *= (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._depthFailAppearance) ? 2 : 1;\n  colorCommands.length = primitive._va.length * multiplier;\n\n  var length = colorCommands.length;\n  var vaIndex = 0;\n  for (var i = 0; i < length; ++i) {\n    var colorCommand;\n\n    if (twoPasses) {\n      colorCommand = colorCommands[i];\n      if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(colorCommand)) {\n        colorCommand = colorCommands[i] = new _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z({\n          owner: primitive,\n          primitiveType: primitive._primitiveType,\n        });\n      }\n      colorCommand.vertexArray = primitive._va[vaIndex];\n      colorCommand.renderState = primitive._backFaceRS;\n      colorCommand.shaderProgram = primitive._sp;\n      colorCommand.uniformMap = uniforms;\n      colorCommand.pass = pass;\n\n      ++i;\n    }\n\n    colorCommand = colorCommands[i];\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(colorCommand)) {\n      colorCommand = colorCommands[i] = new _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z({\n        owner: primitive,\n        primitiveType: primitive._primitiveType,\n      });\n    }\n    colorCommand.vertexArray = primitive._va[vaIndex];\n    colorCommand.renderState = primitive._frontFaceRS;\n    colorCommand.shaderProgram = primitive._sp;\n    colorCommand.uniformMap = uniforms;\n    colorCommand.pass = pass;\n\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._depthFailAppearance)) {\n      if (twoPasses) {\n        ++i;\n\n        colorCommand = colorCommands[i];\n        if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(colorCommand)) {\n          colorCommand = colorCommands[i] = new _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z({\n            owner: primitive,\n            primitiveType: primitive._primitiveType,\n          });\n        }\n        colorCommand.vertexArray = primitive._va[vaIndex];\n        colorCommand.renderState = primitive._backFaceDepthFailRS;\n        colorCommand.shaderProgram = primitive._spDepthFail;\n        colorCommand.uniformMap = depthFailUniforms;\n        colorCommand.pass = pass;\n      }\n\n      ++i;\n\n      colorCommand = colorCommands[i];\n      if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(colorCommand)) {\n        colorCommand = colorCommands[i] = new _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z({\n          owner: primitive,\n          primitiveType: primitive._primitiveType,\n        });\n      }\n      colorCommand.vertexArray = primitive._va[vaIndex];\n      colorCommand.renderState = primitive._frontFaceDepthFailRS;\n      colorCommand.shaderProgram = primitive._spDepthFail;\n      colorCommand.uniformMap = depthFailUniforms;\n      colorCommand.pass = pass;\n    }\n\n    ++vaIndex;\n  }\n}\n\nPrimitive._updateBoundingVolumes = function (\n  primitive,\n  frameState,\n  modelMatrix,\n  forceUpdate\n) {\n  var i;\n  var length;\n  var boundingSphere;\n\n  if (forceUpdate || !_Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].equals */ .Z.equals(modelMatrix, primitive._modelMatrix)) {\n    _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].clone */ .Z.clone(modelMatrix, primitive._modelMatrix);\n    length = primitive._boundingSpheres.length;\n    for (i = 0; i < length; ++i) {\n      boundingSphere = primitive._boundingSpheres[i];\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(boundingSphere)) {\n        primitive._boundingSphereWC[i] = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].transform */ .Z.transform(\n          boundingSphere,\n          modelMatrix,\n          primitive._boundingSphereWC[i]\n        );\n        if (!frameState.scene3DOnly) {\n          primitive._boundingSphere2D[i] = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone(\n            primitive._boundingSphereCV[i],\n            primitive._boundingSphere2D[i]\n          );\n          primitive._boundingSphere2D[i].center.x = 0.0;\n          primitive._boundingSphereMorph[i] = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].union */ .Z.union(\n            primitive._boundingSphereWC[i],\n            primitive._boundingSphereCV[i]\n          );\n        }\n      }\n    }\n  }\n\n  // Update bounding volumes for primitives that are sized in pixels.\n  // The pixel size in meters varies based on the distance from the camera.\n  var pixelSize = primitive.appearance.pixelSize;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(pixelSize)) {\n    length = primitive._boundingSpheres.length;\n    for (i = 0; i < length; ++i) {\n      boundingSphere = primitive._boundingSpheres[i];\n      var boundingSphereWC = primitive._boundingSphereWC[i];\n      var pixelSizeInMeters = frameState.camera.getPixelSize(\n        boundingSphere,\n        frameState.context.drawingBufferWidth,\n        frameState.context.drawingBufferHeight\n      );\n      var sizeInMeters = pixelSizeInMeters * pixelSize;\n      boundingSphereWC.radius = boundingSphere.radius + sizeInMeters;\n    }\n  }\n};\n\nfunction updateAndQueueCommands(\n  primitive,\n  frameState,\n  colorCommands,\n  pickCommands,\n  modelMatrix,\n  cull,\n  debugShowBoundingVolume,\n  twoPasses\n) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (\n    frameState.mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_38__/* ["default"].SCENE3D */ .Z.SCENE3D &&\n    !_Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].equals */ .Z.equals(modelMatrix, _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].IDENTITY */ .Z.IDENTITY)\n  ) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z(\n      "Primitive.modelMatrix is only supported in 3D mode."\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  Primitive._updateBoundingVolumes(primitive, frameState, modelMatrix);\n\n  var boundingSpheres;\n  if (frameState.mode === _SceneMode_js__WEBPACK_IMPORTED_MODULE_38__/* ["default"].SCENE3D */ .Z.SCENE3D) {\n    boundingSpheres = primitive._boundingSphereWC;\n  } else if (frameState.mode === _SceneMode_js__WEBPACK_IMPORTED_MODULE_38__/* ["default"].COLUMBUS_VIEW */ .Z.COLUMBUS_VIEW) {\n    boundingSpheres = primitive._boundingSphereCV;\n  } else if (\n    frameState.mode === _SceneMode_js__WEBPACK_IMPORTED_MODULE_38__/* ["default"].SCENE2D */ .Z.SCENE2D &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._boundingSphere2D)\n  ) {\n    boundingSpheres = primitive._boundingSphere2D;\n  } else if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._boundingSphereMorph)) {\n    boundingSpheres = primitive._boundingSphereMorph;\n  }\n\n  var commandList = frameState.commandList;\n  var passes = frameState.passes;\n  if (passes.render || passes.pick) {\n    var allowPicking = primitive.allowPicking;\n    var castShadows = _ShadowMode_js__WEBPACK_IMPORTED_MODULE_39__/* ["default"].castShadows */ .Z.castShadows(primitive.shadows);\n    var receiveShadows = _ShadowMode_js__WEBPACK_IMPORTED_MODULE_39__/* ["default"].receiveShadows */ .Z.receiveShadows(primitive.shadows);\n    var colorLength = colorCommands.length;\n\n    var factor = twoPasses ? 2 : 1;\n    factor *= (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(primitive._depthFailAppearance) ? 2 : 1;\n\n    for (var j = 0; j < colorLength; ++j) {\n      var sphereIndex = Math.floor(j / factor);\n      var colorCommand = colorCommands[j];\n      colorCommand.modelMatrix = modelMatrix;\n      colorCommand.boundingVolume = boundingSpheres[sphereIndex];\n      colorCommand.cull = cull;\n      colorCommand.debugShowBoundingVolume = debugShowBoundingVolume;\n      colorCommand.castShadows = castShadows;\n      colorCommand.receiveShadows = receiveShadows;\n\n      if (allowPicking) {\n        colorCommand.pickId = "v_pickColor";\n      } else {\n        colorCommand.pickId = undefined;\n      }\n\n      commandList.push(colorCommand);\n    }\n  }\n}\n\n/**\n * Called when {@link Viewer} or {@link CesiumWidget} render the scene to\n * get the draw commands needed to render this primitive.\n * <p>\n * Do not call this function directly.  This is documented just to\n * list the exceptions that may be propagated when the scene is rendered:\n * </p>\n *\n * @exception {DeveloperError} All instance geometries must have the same primitiveType.\n * @exception {DeveloperError} Appearance and material have a uniform with the same name.\n * @exception {DeveloperError} Primitive.modelMatrix is only supported in 3D mode.\n * @exception {RuntimeError} Vertex texture fetch support is required to render primitives with per-instance attributes. The maximum number of vertex texture image units must be greater than zero.\n */\nPrimitive.prototype.update = function (frameState) {\n  if (\n    (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(this.geometryInstances) && this._va.length === 0) ||\n    ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(this.geometryInstances) &&\n      Array.isArray(this.geometryInstances) &&\n      this.geometryInstances.length === 0) ||\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(this.appearance) ||\n    (frameState.mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_38__/* ["default"].SCENE3D */ .Z.SCENE3D && frameState.scene3DOnly) ||\n    (!frameState.passes.render && !frameState.passes.pick)\n  ) {\n    return;\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(this._error)) {\n    throw this._error;\n  }\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(this.rtcCenter) && !frameState.scene3DOnly) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z(\n      "RTC rendering is only available for 3D only scenes."\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  if (this._state === _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].FAILED */ .Z.FAILED) {\n    return;\n  }\n\n  var context = frameState.context;\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(this._batchTable)) {\n    createBatchTable(this, context);\n  }\n  if (this._batchTable.attributes.length > 0) {\n    if (_Renderer_ContextLimits_js__WEBPACK_IMPORTED_MODULE_25__/* ["default"].maximumVertexTextureImageUnits */ .Z.maximumVertexTextureImageUnits === 0) {\n      throw new _Core_RuntimeError_js__WEBPACK_IMPORTED_MODULE_21__/* ["default"] */ .Z(\n        "Vertex texture fetch support is required to render primitives with per-instance attributes. The maximum number of vertex texture image units must be greater than zero."\n      );\n    }\n    this._batchTable.update(frameState);\n  }\n\n  if (\n    this._state !== _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].COMPLETE */ .Z.COMPLETE &&\n    this._state !== _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].COMBINED */ .Z.COMBINED\n  ) {\n    if (this.asynchronous) {\n      loadAsynchronous(this, frameState);\n    } else {\n      loadSynchronous(this, frameState);\n    }\n  }\n\n  if (this._state === _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].COMBINED */ .Z.COMBINED) {\n    updateBatchTableBoundingSpheres(this, frameState);\n    updateBatchTableOffsets(this, frameState);\n    createVertexArray(this, frameState);\n  }\n\n  if (!this.show || this._state !== _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].COMPLETE */ .Z.COMPLETE) {\n    return;\n  }\n\n  if (!this._batchTableOffsetsUpdated) {\n    updateBatchTableOffsets(this, frameState);\n  }\n  if (this._recomputeBoundingSpheres) {\n    recomputeBoundingSpheres(this, frameState);\n  }\n\n  // Create or recreate render state and shader program if appearance/material changed\n  var appearance = this.appearance;\n  var material = appearance.material;\n  var createRS = false;\n  var createSP = false;\n\n  if (this._appearance !== appearance) {\n    this._appearance = appearance;\n    this._material = material;\n    createRS = true;\n    createSP = true;\n  } else if (this._material !== material) {\n    this._material = material;\n    createSP = true;\n  }\n\n  var depthFailAppearance = this.depthFailAppearance;\n  var depthFailMaterial = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(depthFailAppearance)\n    ? depthFailAppearance.material\n    : undefined;\n\n  if (this._depthFailAppearance !== depthFailAppearance) {\n    this._depthFailAppearance = depthFailAppearance;\n    this._depthFailMaterial = depthFailMaterial;\n    createRS = true;\n    createSP = true;\n  } else if (this._depthFailMaterial !== depthFailMaterial) {\n    this._depthFailMaterial = depthFailMaterial;\n    createSP = true;\n  }\n\n  var translucent = this._appearance.isTranslucent();\n  if (this._translucent !== translucent) {\n    this._translucent = translucent;\n    createRS = true;\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(this._material)) {\n    this._material.update(context);\n  }\n\n  var twoPasses = appearance.closed && translucent;\n\n  if (createRS) {\n    var rsFunc = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(\n      this._createRenderStatesFunction,\n      createRenderStates\n    );\n    rsFunc(this, context, appearance, twoPasses);\n  }\n\n  if (createSP) {\n    var spFunc = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(\n      this._createShaderProgramFunction,\n      createShaderProgram\n    );\n    spFunc(this, frameState, appearance);\n  }\n\n  if (createRS || createSP) {\n    var commandFunc = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(\n      this._createCommandsFunction,\n      createCommands\n    );\n    commandFunc(\n      this,\n      appearance,\n      material,\n      translucent,\n      twoPasses,\n      this._colorCommands,\n      this._pickCommands,\n      frameState\n    );\n  }\n\n  var updateAndQueueCommandsFunc = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(\n    this._updateAndQueueCommandsFunction,\n    updateAndQueueCommands\n  );\n  updateAndQueueCommandsFunc(\n    this,\n    frameState,\n    this._colorCommands,\n    this._pickCommands,\n    this.modelMatrix,\n    this.cull,\n    this.debugShowBoundingVolume,\n    twoPasses\n  );\n};\n\nvar offsetBoundingSphereScratch1 = new _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\nvar offsetBoundingSphereScratch2 = new _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\nfunction transformBoundingSphere(boundingSphere, offset, offsetAttribute) {\n  if (offsetAttribute === _Core_GeometryOffsetAttribute_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].TOP */ .Z.TOP) {\n    var origBS = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone(\n      boundingSphere,\n      offsetBoundingSphereScratch1\n    );\n    var offsetBS = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone(\n      boundingSphere,\n      offsetBoundingSphereScratch2\n    );\n    offsetBS.center = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].add */ .Z.add(offsetBS.center, offset, offsetBS.center);\n    boundingSphere = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].union */ .Z.union(origBS, offsetBS, boundingSphere);\n  } else if (offsetAttribute === _Core_GeometryOffsetAttribute_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].ALL */ .Z.ALL) {\n    boundingSphere.center = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].add */ .Z.add(\n      boundingSphere.center,\n      offset,\n      boundingSphere.center\n    );\n  }\n\n  return boundingSphere;\n}\n\nfunction createGetFunction(batchTable, instanceIndex, attributeIndex) {\n  return function () {\n    var attributeValue = batchTable.getBatchedAttribute(\n      instanceIndex,\n      attributeIndex\n    );\n    var attribute = batchTable.attributes[attributeIndex];\n    var componentsPerAttribute = attribute.componentsPerAttribute;\n    var value = _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].createTypedArray */ .Z.createTypedArray(\n      attribute.componentDatatype,\n      componentsPerAttribute\n    );\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(attributeValue.constructor.pack)) {\n      attributeValue.constructor.pack(attributeValue, value, 0);\n    } else {\n      value[0] = attributeValue;\n    }\n    return value;\n  };\n}\n\nfunction createSetFunction(\n  batchTable,\n  instanceIndex,\n  attributeIndex,\n  primitive,\n  name\n) {\n  return function (value) {\n    //>>includeStart(\'debug\', pragmas.debug);\n    if (\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(value) ||\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(value.length) ||\n      value.length < 1 ||\n      value.length > 4\n    ) {\n      throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z(\n        "value must be and array with length between 1 and 4."\n      );\n    }\n    //>>includeEnd(\'debug\');\n    var attributeValue = getAttributeValue(value);\n    batchTable.setBatchedAttribute(\n      instanceIndex,\n      attributeIndex,\n      attributeValue\n    );\n    if (name === "offset") {\n      primitive._recomputeBoundingSpheres = true;\n      primitive._batchTableOffsetsUpdated = false;\n    }\n  };\n}\n\nvar offsetScratch = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\n\nfunction createBoundingSphereProperties(primitive, properties, index) {\n  properties.boundingSphere = {\n    get: function () {\n      var boundingSphere = primitive._instanceBoundingSpheres[index];\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(boundingSphere)) {\n        boundingSphere = boundingSphere.clone();\n        var modelMatrix = primitive.modelMatrix;\n        var offset = properties.offset;\n        if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(offset)) {\n          transformBoundingSphere(\n            boundingSphere,\n            _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].fromArray */ .Z.fromArray(offset.get(), 0, offsetScratch),\n            primitive._offsetInstanceExtend[index]\n          );\n        }\n        if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(modelMatrix)) {\n          boundingSphere = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].transform */ .Z.transform(\n            boundingSphere,\n            modelMatrix\n          );\n        }\n      }\n\n      return boundingSphere;\n    },\n  };\n  properties.boundingSphereCV = {\n    get: function () {\n      return primitive._instanceBoundingSpheresCV[index];\n    },\n  };\n}\n\nfunction createPickIdProperty(primitive, properties, index) {\n  properties.pickId = {\n    get: function () {\n      return primitive._pickIds[index];\n    },\n  };\n}\n\n/**\n * Returns the modifiable per-instance attributes for a {@link GeometryInstance}.\n *\n * @param {*} id The id of the {@link GeometryInstance}.\n * @returns {Object} The typed array in the attribute\'s format or undefined if the is no instance with id.\n *\n * @exception {DeveloperError} must call update before calling getGeometryInstanceAttributes.\n *\n * @example\n * var attributes = primitive.getGeometryInstanceAttributes(\'an id\');\n * attributes.color = Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.AQUA);\n * attributes.show = Cesium.ShowGeometryInstanceAttribute.toValue(true);\n * attributes.distanceDisplayCondition = Cesium.DistanceDisplayConditionGeometryInstanceAttribute.toValue(100.0, 10000.0);\n * attributes.offset = Cesium.OffsetGeometryInstanceAttribute.toValue(Cartesian3.IDENTITY);\n */\nPrimitive.prototype.getGeometryInstanceAttributes = function (id) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(id)) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z("id is required");\n  }\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(this._batchTable)) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z(\n      "must call update before calling getGeometryInstanceAttributes"\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  var index = -1;\n  var lastIndex = this._lastPerInstanceAttributeIndex;\n  var ids = this._instanceIds;\n  var length = ids.length;\n  for (var i = 0; i < length; ++i) {\n    var curIndex = (lastIndex + i) % length;\n    if (id === ids[curIndex]) {\n      index = curIndex;\n      break;\n    }\n  }\n\n  if (index === -1) {\n    return undefined;\n  }\n\n  var attributes = this._perInstanceAttributeCache[index];\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(attributes)) {\n    return attributes;\n  }\n\n  var batchTable = this._batchTable;\n  var perInstanceAttributeIndices = this._batchTableAttributeIndices;\n  attributes = {};\n  var properties = {};\n\n  for (var name in perInstanceAttributeIndices) {\n    if (perInstanceAttributeIndices.hasOwnProperty(name)) {\n      var attributeIndex = perInstanceAttributeIndices[name];\n      properties[name] = {\n        get: createGetFunction(batchTable, index, attributeIndex),\n        set: createSetFunction(batchTable, index, attributeIndex, this, name),\n      };\n    }\n  }\n\n  createBoundingSphereProperties(this, properties, index);\n  createPickIdProperty(this, properties, index);\n  Object.defineProperties(attributes, properties);\n\n  this._lastPerInstanceAttributeIndex = index;\n  this._perInstanceAttributeCache[index] = attributes;\n  return attributes;\n};\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <p>\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n * </p>\n *\n * @returns {Boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n *\n * @see Primitive#destroy\n */\nPrimitive.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the WebGL resources held by this object.  Destroying an object allows for deterministic\n * release of WebGL resources, instead of relying on the garbage collector to destroy this object.\n * <p>\n * Once an object is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n * </p>\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n *\n * @example\n * e = e && e.destroy();\n *\n * @see Primitive#isDestroyed\n */\nPrimitive.prototype.destroy = function () {\n  var length;\n  var i;\n\n  this._sp = this._sp && this._sp.destroy();\n  this._spDepthFail = this._spDepthFail && this._spDepthFail.destroy();\n\n  var va = this._va;\n  length = va.length;\n  for (i = 0; i < length; ++i) {\n    va[i].destroy();\n  }\n  this._va = undefined;\n\n  var pickIds = this._pickIds;\n  length = pickIds.length;\n  for (i = 0; i < length; ++i) {\n    pickIds[i].destroy();\n  }\n  this._pickIds = undefined;\n\n  this._batchTable = this._batchTable && this._batchTable.destroy();\n\n  //These objects may be fairly large and reference other large objects (like Entities)\n  //We explicitly set them to undefined here so that the memory can be freed\n  //even if a reference to the destroyed Primitive has been kept around.\n  this._instanceIds = undefined;\n  this._perInstanceAttributeCache = undefined;\n  this._attributeLocations = undefined;\n\n  return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(this);\n};\n\nfunction setReady(primitive, frameState, state, error) {\n  primitive._error = error;\n  primitive._state = state;\n  frameState.afterRender.push(function () {\n    primitive._ready =\n      primitive._state === _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].COMPLETE */ .Z.COMPLETE ||\n      primitive._state === _PrimitiveState_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].FAILED */ .Z.FAILED;\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z)(error)) {\n      primitive._readyPromise.resolve(primitive);\n    } else {\n      primitive._readyPromise.reject(error);\n    }\n  });\n}\n/* harmony default export */ __webpack_exports__["Z"] = (Primitive);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVEO0FBQ3ZELDhDQUE4QyxzQkFBc0I7QUFDcEU7QUFDQTtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsY0FBYyxZQUFZO0FBQzFCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsY0FBYyxZQUFZO0FBQzFCO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsU0FBUyw0RUFBYTtBQUN0Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHNGQUF1QjtBQUNsRCwyQkFBMkIsa0ZBQXFCO0FBQ2hELFNBQVMsc0VBQU87QUFDaEI7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLHlEQUFlLFNBQVMsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9TY2VuZS9QcmltaXRpdmUuanM/NWYwZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQm91bmRpbmdTcGhlcmUgZnJvbSBcIi4uL0NvcmUvQm91bmRpbmdTcGhlcmUuanNcIjtcbmltcG9ydCBDYXJ0ZXNpYW4yIGZyb20gXCIuLi9Db3JlL0NhcnRlc2lhbjIuanNcIjtcbmltcG9ydCBDYXJ0ZXNpYW4zIGZyb20gXCIuLi9Db3JlL0NhcnRlc2lhbjMuanNcIjtcbmltcG9ydCBDYXJ0ZXNpYW40IGZyb20gXCIuLi9Db3JlL0NhcnRlc2lhbjQuanNcIjtcbmltcG9ydCBDYXJ0b2dyYXBoaWMgZnJvbSBcIi4uL0NvcmUvQ2FydG9ncmFwaGljLmpzXCI7XG5pbXBvcnQgY2xvbmUgZnJvbSBcIi4uL0NvcmUvY2xvbmUuanNcIjtcbmltcG9ydCBDb2xvciBmcm9tIFwiLi4vQ29yZS9Db2xvci5qc1wiO1xuaW1wb3J0IGNvbWJpbmUgZnJvbSBcIi4uL0NvcmUvY29tYmluZS5qc1wiO1xuaW1wb3J0IENvbXBvbmVudERhdGF0eXBlIGZyb20gXCIuLi9Db3JlL0NvbXBvbmVudERhdGF0eXBlLmpzXCI7XG5pbXBvcnQgZGVmYXVsdFZhbHVlIGZyb20gXCIuLi9Db3JlL2RlZmF1bHRWYWx1ZS5qc1wiO1xuaW1wb3J0IGRlZmluZWQgZnJvbSBcIi4uL0NvcmUvZGVmaW5lZC5qc1wiO1xuaW1wb3J0IGRlc3Ryb3lPYmplY3QgZnJvbSBcIi4uL0NvcmUvZGVzdHJveU9iamVjdC5qc1wiO1xuaW1wb3J0IERldmVsb3BlckVycm9yIGZyb20gXCIuLi9Db3JlL0RldmVsb3BlckVycm9yLmpzXCI7XG5pbXBvcnQgRW5jb2RlZENhcnRlc2lhbjMgZnJvbSBcIi4uL0NvcmUvRW5jb2RlZENhcnRlc2lhbjMuanNcIjtcbmltcG9ydCBGZWF0dXJlRGV0ZWN0aW9uIGZyb20gXCIuLi9Db3JlL0ZlYXR1cmVEZXRlY3Rpb24uanNcIjtcbmltcG9ydCBHZW9tZXRyeSBmcm9tIFwiLi4vQ29yZS9HZW9tZXRyeS5qc1wiO1xuaW1wb3J0IEdlb21ldHJ5QXR0cmlidXRlIGZyb20gXCIuLi9Db3JlL0dlb21ldHJ5QXR0cmlidXRlLmpzXCI7XG5pbXBvcnQgR2VvbWV0cnlBdHRyaWJ1dGVzIGZyb20gXCIuLi9Db3JlL0dlb21ldHJ5QXR0cmlidXRlcy5qc1wiO1xuaW1wb3J0IEdlb21ldHJ5T2Zmc2V0QXR0cmlidXRlIGZyb20gXCIuLi9Db3JlL0dlb21ldHJ5T2Zmc2V0QXR0cmlidXRlLmpzXCI7XG5pbXBvcnQgSW50ZXJzZWN0IGZyb20gXCIuLi9Db3JlL0ludGVyc2VjdC5qc1wiO1xuaW1wb3J0IE1hdHJpeDQgZnJvbSBcIi4uL0NvcmUvTWF0cml4NC5qc1wiO1xuaW1wb3J0IFBsYW5lIGZyb20gXCIuLi9Db3JlL1BsYW5lLmpzXCI7XG5pbXBvcnQgUnVudGltZUVycm9yIGZyb20gXCIuLi9Db3JlL1J1bnRpbWVFcnJvci5qc1wiO1xuaW1wb3J0IHN1YmRpdmlkZUFycmF5IGZyb20gXCIuLi9Db3JlL3N1YmRpdmlkZUFycmF5LmpzXCI7XG5pbXBvcnQgVGFza1Byb2Nlc3NvciBmcm9tIFwiLi4vQ29yZS9UYXNrUHJvY2Vzc29yLmpzXCI7XG5pbXBvcnQgQnVmZmVyVXNhZ2UgZnJvbSBcIi4uL1JlbmRlcmVyL0J1ZmZlclVzYWdlLmpzXCI7XG5pbXBvcnQgQ29udGV4dExpbWl0cyBmcm9tIFwiLi4vUmVuZGVyZXIvQ29udGV4dExpbWl0cy5qc1wiO1xuaW1wb3J0IERyYXdDb21tYW5kIGZyb20gXCIuLi9SZW5kZXJlci9EcmF3Q29tbWFuZC5qc1wiO1xuaW1wb3J0IFBhc3MgZnJvbSBcIi4uL1JlbmRlcmVyL1Bhc3MuanNcIjtcbmltcG9ydCBSZW5kZXJTdGF0ZSBmcm9tIFwiLi4vUmVuZGVyZXIvUmVuZGVyU3RhdGUuanNcIjtcbmltcG9ydCBTaGFkZXJQcm9ncmFtIGZyb20gXCIuLi9SZW5kZXJlci9TaGFkZXJQcm9ncmFtLmpzXCI7XG5pbXBvcnQgU2hhZGVyU291cmNlIGZyb20gXCIuLi9SZW5kZXJlci9TaGFkZXJTb3VyY2UuanNcIjtcbmltcG9ydCBWZXJ0ZXhBcnJheSBmcm9tIFwiLi4vUmVuZGVyZXIvVmVydGV4QXJyYXkuanNcIjtcbmltcG9ydCB3aGVuIGZyb20gXCIuLi9UaGlyZFBhcnR5L3doZW4uanNcIjtcbmltcG9ydCBCYXRjaFRhYmxlIGZyb20gXCIuL0JhdGNoVGFibGUuanNcIjtcbmltcG9ydCBDdWxsRmFjZSBmcm9tIFwiLi9DdWxsRmFjZS5qc1wiO1xuaW1wb3J0IERlcHRoRnVuY3Rpb24gZnJvbSBcIi4vRGVwdGhGdW5jdGlvbi5qc1wiO1xuaW1wb3J0IFByaW1pdGl2ZVBpcGVsaW5lIGZyb20gXCIuL1ByaW1pdGl2ZVBpcGVsaW5lLmpzXCI7XG5pbXBvcnQgUHJpbWl0aXZlU3RhdGUgZnJvbSBcIi4vUHJpbWl0aXZlU3RhdGUuanNcIjtcbmltcG9ydCBTY2VuZU1vZGUgZnJvbSBcIi4vU2NlbmVNb2RlLmpzXCI7XG5pbXBvcnQgU2hhZG93TW9kZSBmcm9tIFwiLi9TaGFkb3dNb2RlLmpzXCI7XG5cbi8qKlxuICogQSBwcmltaXRpdmUgcmVwcmVzZW50cyBnZW9tZXRyeSBpbiB0aGUge0BsaW5rIFNjZW5lfS4gIFRoZSBnZW9tZXRyeSBjYW4gYmUgZnJvbSBhIHNpbmdsZSB7QGxpbmsgR2VvbWV0cnlJbnN0YW5jZX1cbiAqIGFzIHNob3duIGluIGV4YW1wbGUgMSBiZWxvdywgb3IgZnJvbSBhbiBhcnJheSBvZiBpbnN0YW5jZXMsIGV2ZW4gaWYgdGhlIGdlb21ldHJ5IGlzIGZyb20gZGlmZmVyZW50XG4gKiBnZW9tZXRyeSB0eXBlcywgZS5nLiwgYW4ge0BsaW5rIFJlY3RhbmdsZUdlb21ldHJ5fSBhbmQgYW4ge0BsaW5rIEVsbGlwc29pZEdlb21ldHJ5fSBhcyBzaG93biBpbiBDb2RlIEV4YW1wbGUgMi5cbiAqIDxwPlxuICogQSBwcmltaXRpdmUgY29tYmluZXMgZ2VvbWV0cnkgaW5zdGFuY2VzIHdpdGggYW4ge0BsaW5rIEFwcGVhcmFuY2V9IHRoYXQgZGVzY3JpYmVzIHRoZSBmdWxsIHNoYWRpbmcsIGluY2x1ZGluZ1xuICoge0BsaW5rIE1hdGVyaWFsfSBhbmQge0BsaW5rIFJlbmRlclN0YXRlfS4gIFJvdWdobHksIHRoZSBnZW9tZXRyeSBpbnN0YW5jZSBkZWZpbmVzIHRoZSBzdHJ1Y3R1cmUgYW5kIHBsYWNlbWVudCxcbiAqIGFuZCB0aGUgYXBwZWFyYW5jZSBkZWZpbmVzIHRoZSB2aXN1YWwgY2hhcmFjdGVyaXN0aWNzLiAgRGVjb3VwbGluZyBnZW9tZXRyeSBhbmQgYXBwZWFyYW5jZSBhbGxvd3MgdXMgdG8gbWl4XG4gKiBhbmQgbWF0Y2ggbW9zdCBvZiB0aGVtIGFuZCBhZGQgYSBuZXcgZ2VvbWV0cnkgb3IgYXBwZWFyYW5jZSBpbmRlcGVuZGVudGx5IG9mIGVhY2ggb3RoZXIuXG4gKiA8L3A+XG4gKiA8cD5cbiAqIENvbWJpbmluZyBtdWx0aXBsZSBpbnN0YW5jZXMgaW50byBvbmUgcHJpbWl0aXZlIGlzIGNhbGxlZCBiYXRjaGluZywgYW5kIHNpZ25pZmljYW50bHkgaW1wcm92ZXMgcGVyZm9ybWFuY2UgZm9yIHN0YXRpYyBkYXRhLlxuICogSW5zdGFuY2VzIGNhbiBiZSBpbmRpdmlkdWFsbHkgcGlja2VkOyB7QGxpbmsgU2NlbmUjcGlja30gcmV0dXJucyB0aGVpciB7QGxpbmsgR2VvbWV0cnlJbnN0YW5jZSNpZH0uICBVc2luZ1xuICogcGVyLWluc3RhbmNlIGFwcGVhcmFuY2VzIGxpa2Uge0BsaW5rIFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlfSwgZWFjaCBpbnN0YW5jZSBjYW4gYWxzbyBoYXZlIGEgdW5pcXVlIGNvbG9yLlxuICogPC9wPlxuICogPHA+XG4gKiB7QGxpbmsgR2VvbWV0cnl9IGNhbiBlaXRoZXIgYmUgY3JlYXRlZCBhbmQgYmF0Y2hlZCBvbiBhIHdlYiB3b3JrZXIgb3IgdGhlIG1haW4gdGhyZWFkLiBUaGUgZmlyc3QgdHdvIGV4YW1wbGVzXG4gKiBzaG93IGdlb21ldHJ5IHRoYXQgd2lsbCBiZSBjcmVhdGVkIG9uIGEgd2ViIHdvcmtlciBieSB1c2luZyB0aGUgZGVzY3JpcHRpb25zIG9mIHRoZSBnZW9tZXRyeS4gVGhlIHRoaXJkIGV4YW1wbGVcbiAqIHNob3dzIGhvdyB0byBjcmVhdGUgdGhlIGdlb21ldHJ5IG9uIHRoZSBtYWluIHRocmVhZCBieSBleHBsaWNpdGx5IGNhbGxpbmcgdGhlIDxjb2RlPmNyZWF0ZUdlb21ldHJ5PC9jb2RlPiBtZXRob2QuXG4gKiA8L3A+XG4gKlxuICogQGFsaWFzIFByaW1pdGl2ZVxuICogQGNvbnN0cnVjdG9yXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXSBPYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gKiBAcGFyYW0ge0dlb21ldHJ5SW5zdGFuY2VbXXxHZW9tZXRyeUluc3RhbmNlfSBbb3B0aW9ucy5nZW9tZXRyeUluc3RhbmNlc10gVGhlIGdlb21ldHJ5IGluc3RhbmNlcyAtIG9yIGEgc2luZ2xlIGdlb21ldHJ5IGluc3RhbmNlIC0gdG8gcmVuZGVyLlxuICogQHBhcmFtIHtBcHBlYXJhbmNlfSBbb3B0aW9ucy5hcHBlYXJhbmNlXSBUaGUgYXBwZWFyYW5jZSB1c2VkIHRvIHJlbmRlciB0aGUgcHJpbWl0aXZlLlxuICogQHBhcmFtIHtBcHBlYXJhbmNlfSBbb3B0aW9ucy5kZXB0aEZhaWxBcHBlYXJhbmNlXSBUaGUgYXBwZWFyYW5jZSB1c2VkIHRvIHNoYWRlIHRoaXMgcHJpbWl0aXZlIHdoZW4gaXQgZmFpbHMgdGhlIGRlcHRoIHRlc3QuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLnNob3c9dHJ1ZV0gRGV0ZXJtaW5lcyBpZiB0aGlzIHByaW1pdGl2ZSB3aWxsIGJlIHNob3duLlxuICogQHBhcmFtIHtNYXRyaXg0fSBbb3B0aW9ucy5tb2RlbE1hdHJpeD1NYXRyaXg0LklERU5USVRZXSBUaGUgNHg0IHRyYW5zZm9ybWF0aW9uIG1hdHJpeCB0aGF0IHRyYW5zZm9ybXMgdGhlIHByaW1pdGl2ZSAoYWxsIGdlb21ldHJ5IGluc3RhbmNlcykgZnJvbSBtb2RlbCB0byB3b3JsZCBjb29yZGluYXRlcy5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMudmVydGV4Q2FjaGVPcHRpbWl6ZT1mYWxzZV0gV2hlbiA8Y29kZT50cnVlPC9jb2RlPiwgZ2VvbWV0cnkgdmVydGljZXMgYXJlIG9wdGltaXplZCBmb3IgdGhlIHByZSBhbmQgcG9zdC12ZXJ0ZXgtc2hhZGVyIGNhY2hlcy5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuaW50ZXJsZWF2ZT1mYWxzZV0gV2hlbiA8Y29kZT50cnVlPC9jb2RlPiwgZ2VvbWV0cnkgdmVydGV4IGF0dHJpYnV0ZXMgYXJlIGludGVybGVhdmVkLCB3aGljaCBjYW4gc2xpZ2h0bHkgaW1wcm92ZSByZW5kZXJpbmcgcGVyZm9ybWFuY2UgYnV0IGluY3JlYXNlcyBsb2FkIHRpbWUuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmNvbXByZXNzVmVydGljZXM9dHJ1ZV0gV2hlbiA8Y29kZT50cnVlPC9jb2RlPiwgdGhlIGdlb21ldHJ5IHZlcnRpY2VzIGFyZSBjb21wcmVzc2VkLCB3aGljaCB3aWxsIHNhdmUgbWVtb3J5LlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5yZWxlYXNlR2VvbWV0cnlJbnN0YW5jZXM9dHJ1ZV0gV2hlbiA8Y29kZT50cnVlPC9jb2RlPiwgdGhlIHByaW1pdGl2ZSBkb2VzIG5vdCBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZSBpbnB1dCA8Y29kZT5nZW9tZXRyeUluc3RhbmNlczwvY29kZT4gdG8gc2F2ZSBtZW1vcnkuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmFsbG93UGlja2luZz10cnVlXSBXaGVuIDxjb2RlPnRydWU8L2NvZGU+LCBlYWNoIGdlb21ldHJ5IGluc3RhbmNlIHdpbGwgb25seSBiZSBwaWNrYWJsZSB3aXRoIHtAbGluayBTY2VuZSNwaWNrfS4gIFdoZW4gPGNvZGU+ZmFsc2U8L2NvZGU+LCBHUFUgbWVtb3J5IGlzIHNhdmVkLlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5jdWxsPXRydWVdIFdoZW4gPGNvZGU+dHJ1ZTwvY29kZT4sIHRoZSByZW5kZXJlciBmcnVzdHVtIGN1bGxzIGFuZCBob3Jpem9uIGN1bGxzIHRoZSBwcmltaXRpdmUncyBjb21tYW5kcyBiYXNlZCBvbiB0aGVpciBib3VuZGluZyB2b2x1bWUuICBTZXQgdGhpcyB0byA8Y29kZT5mYWxzZTwvY29kZT4gZm9yIGEgc21hbGwgcGVyZm9ybWFuY2UgZ2FpbiBpZiB5b3UgYXJlIG1hbnVhbGx5IGN1bGxpbmcgdGhlIHByaW1pdGl2ZS5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuYXN5bmNocm9ub3VzPXRydWVdIERldGVybWluZXMgaWYgdGhlIHByaW1pdGl2ZSB3aWxsIGJlIGNyZWF0ZWQgYXN5bmNocm9ub3VzbHkgb3IgYmxvY2sgdW50aWwgcmVhZHkuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmRlYnVnU2hvd0JvdW5kaW5nVm9sdW1lPWZhbHNlXSBGb3IgZGVidWdnaW5nIG9ubHkuIERldGVybWluZXMgaWYgdGhpcyBwcmltaXRpdmUncyBjb21tYW5kcycgYm91bmRpbmcgc3BoZXJlcyBhcmUgc2hvd24uXG4gKiBAcGFyYW0ge1NoYWRvd01vZGV9IFtvcHRpb25zLnNoYWRvd3M9U2hhZG93TW9kZS5ESVNBQkxFRF0gRGV0ZXJtaW5lcyB3aGV0aGVyIHRoaXMgcHJpbWl0aXZlIGNhc3RzIG9yIHJlY2VpdmVzIHNoYWRvd3MgZnJvbSBsaWdodCBzb3VyY2VzLlxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyAxLiBEcmF3IGEgdHJhbnNsdWNlbnQgZWxsaXBzZSBvbiB0aGUgc3VyZmFjZSB3aXRoIGEgY2hlY2tlcmJvYXJkIHBhdHRlcm5cbiAqIHZhciBpbnN0YW5jZSA9IG5ldyBDZXNpdW0uR2VvbWV0cnlJbnN0YW5jZSh7XG4gKiAgIGdlb21ldHJ5IDogbmV3IENlc2l1bS5FbGxpcHNlR2VvbWV0cnkoe1xuICogICAgICAgY2VudGVyIDogQ2VzaXVtLkNhcnRlc2lhbjMuZnJvbURlZ3JlZXMoLTEwMC4wLCAyMC4wKSxcbiAqICAgICAgIHNlbWlNaW5vckF4aXMgOiA1MDAwMDAuMCxcbiAqICAgICAgIHNlbWlNYWpvckF4aXMgOiAxMDAwMDAwLjAsXG4gKiAgICAgICByb3RhdGlvbiA6IENlc2l1bS5NYXRoLlBJX09WRVJfRk9VUixcbiAqICAgICAgIHZlcnRleEZvcm1hdCA6IENlc2l1bS5WZXJ0ZXhGb3JtYXQuUE9TSVRJT05fQU5EX1NUXG4gKiAgIH0pLFxuICogICBpZCA6ICdvYmplY3QgcmV0dXJuZWQgd2hlbiB0aGlzIGluc3RhbmNlIGlzIHBpY2tlZCBhbmQgdG8gZ2V0L3NldCBwZXItaW5zdGFuY2UgYXR0cmlidXRlcydcbiAqIH0pO1xuICogc2NlbmUucHJpbWl0aXZlcy5hZGQobmV3IENlc2l1bS5QcmltaXRpdmUoe1xuICogICBnZW9tZXRyeUluc3RhbmNlcyA6IGluc3RhbmNlLFxuICogICBhcHBlYXJhbmNlIDogbmV3IENlc2l1bS5FbGxpcHNvaWRTdXJmYWNlQXBwZWFyYW5jZSh7XG4gKiAgICAgbWF0ZXJpYWwgOiBDZXNpdW0uTWF0ZXJpYWwuZnJvbVR5cGUoJ0NoZWNrZXJib2FyZCcpXG4gKiAgIH0pXG4gKiB9KSk7XG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIDIuIERyYXcgZGlmZmVyZW50IGluc3RhbmNlcyBlYWNoIHdpdGggYSB1bmlxdWUgY29sb3JcbiAqIHZhciByZWN0YW5nbGVJbnN0YW5jZSA9IG5ldyBDZXNpdW0uR2VvbWV0cnlJbnN0YW5jZSh7XG4gKiAgIGdlb21ldHJ5IDogbmV3IENlc2l1bS5SZWN0YW5nbGVHZW9tZXRyeSh7XG4gKiAgICAgcmVjdGFuZ2xlIDogQ2VzaXVtLlJlY3RhbmdsZS5mcm9tRGVncmVlcygtMTQwLjAsIDMwLjAsIC0xMDAuMCwgNDAuMCksXG4gKiAgICAgdmVydGV4Rm9ybWF0IDogQ2VzaXVtLlBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlLlZFUlRFWF9GT1JNQVRcbiAqICAgfSksXG4gKiAgIGlkIDogJ3JlY3RhbmdsZScsXG4gKiAgIGF0dHJpYnV0ZXMgOiB7XG4gKiAgICAgY29sb3IgOiBuZXcgQ2VzaXVtLkNvbG9yR2VvbWV0cnlJbnN0YW5jZUF0dHJpYnV0ZSgwLjAsIDEuMCwgMS4wLCAwLjUpXG4gKiAgIH1cbiAqIH0pO1xuICogdmFyIGVsbGlwc29pZEluc3RhbmNlID0gbmV3IENlc2l1bS5HZW9tZXRyeUluc3RhbmNlKHtcbiAqICAgZ2VvbWV0cnkgOiBuZXcgQ2VzaXVtLkVsbGlwc29pZEdlb21ldHJ5KHtcbiAqICAgICByYWRpaSA6IG5ldyBDZXNpdW0uQ2FydGVzaWFuMyg1MDAwMDAuMCwgNTAwMDAwLjAsIDEwMDAwMDAuMCksXG4gKiAgICAgdmVydGV4Rm9ybWF0IDogQ2VzaXVtLlZlcnRleEZvcm1hdC5QT1NJVElPTl9BTkRfTk9STUFMXG4gKiAgIH0pLFxuICogICBtb2RlbE1hdHJpeCA6IENlc2l1bS5NYXRyaXg0Lm11bHRpcGx5QnlUcmFuc2xhdGlvbihDZXNpdW0uVHJhbnNmb3Jtcy5lYXN0Tm9ydGhVcFRvRml4ZWRGcmFtZShcbiAqICAgICBDZXNpdW0uQ2FydGVzaWFuMy5mcm9tRGVncmVlcygtOTUuNTk3NzcsIDQwLjAzODgzKSksIG5ldyBDZXNpdW0uQ2FydGVzaWFuMygwLjAsIDAuMCwgNTAwMDAwLjApLCBuZXcgQ2VzaXVtLk1hdHJpeDQoKSksXG4gKiAgIGlkIDogJ2VsbGlwc29pZCcsXG4gKiAgIGF0dHJpYnV0ZXMgOiB7XG4gKiAgICAgY29sb3IgOiBDZXNpdW0uQ29sb3JHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlLmZyb21Db2xvcihDZXNpdW0uQ29sb3IuQVFVQSlcbiAqICAgfVxuICogfSk7XG4gKiBzY2VuZS5wcmltaXRpdmVzLmFkZChuZXcgQ2VzaXVtLlByaW1pdGl2ZSh7XG4gKiAgIGdlb21ldHJ5SW5zdGFuY2VzIDogW3JlY3RhbmdsZUluc3RhbmNlLCBlbGxpcHNvaWRJbnN0YW5jZV0sXG4gKiAgIGFwcGVhcmFuY2UgOiBuZXcgQ2VzaXVtLlBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlKClcbiAqIH0pKTtcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gMy4gQ3JlYXRlIHRoZSBnZW9tZXRyeSBvbiB0aGUgbWFpbiB0aHJlYWQuXG4gKiBzY2VuZS5wcmltaXRpdmVzLmFkZChuZXcgQ2VzaXVtLlByaW1pdGl2ZSh7XG4gKiAgIGdlb21ldHJ5SW5zdGFuY2VzIDogbmV3IENlc2l1bS5HZW9tZXRyeUluc3RhbmNlKHtcbiAqICAgICBnZW9tZXRyeSA6IENlc2l1bS5FbGxpcHNvaWRHZW9tZXRyeS5jcmVhdGVHZW9tZXRyeShuZXcgQ2VzaXVtLkVsbGlwc29pZEdlb21ldHJ5KHtcbiAqICAgICAgIHJhZGlpIDogbmV3IENlc2l1bS5DYXJ0ZXNpYW4zKDUwMDAwMC4wLCA1MDAwMDAuMCwgMTAwMDAwMC4wKSxcbiAqICAgICAgIHZlcnRleEZvcm1hdCA6IENlc2l1bS5WZXJ0ZXhGb3JtYXQuUE9TSVRJT05fQU5EX05PUk1BTFxuICogICAgIH0pKSxcbiAqICAgICBtb2RlbE1hdHJpeCA6IENlc2l1bS5NYXRyaXg0Lm11bHRpcGx5QnlUcmFuc2xhdGlvbihDZXNpdW0uVHJhbnNmb3Jtcy5lYXN0Tm9ydGhVcFRvRml4ZWRGcmFtZShcbiAqICAgICAgIENlc2l1bS5DYXJ0ZXNpYW4zLmZyb21EZWdyZWVzKC05NS41OTc3NywgNDAuMDM4ODMpKSwgbmV3IENlc2l1bS5DYXJ0ZXNpYW4zKDAuMCwgMC4wLCA1MDAwMDAuMCksIG5ldyBDZXNpdW0uTWF0cml4NCgpKSxcbiAqICAgICBpZCA6ICdlbGxpcHNvaWQnLFxuICogICAgIGF0dHJpYnV0ZXMgOiB7XG4gKiAgICAgICBjb2xvciA6IENlc2l1bS5Db2xvckdlb21ldHJ5SW5zdGFuY2VBdHRyaWJ1dGUuZnJvbUNvbG9yKENlc2l1bS5Db2xvci5BUVVBKVxuICogICAgIH1cbiAqICAgfSksXG4gKiAgIGFwcGVhcmFuY2UgOiBuZXcgQ2VzaXVtLlBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlKCksXG4gKiAgIGFzeW5jaHJvbm91cyA6IGZhbHNlXG4gKiB9KSk7XG4gKlxuICogQHNlZSBHZW9tZXRyeUluc3RhbmNlXG4gKiBAc2VlIEFwcGVhcmFuY2VcbiAqIEBzZWUgQ2xhc3NpZmljYXRpb25QcmltaXRpdmVcbiAqIEBzZWUgR3JvdW5kUHJpbWl0aXZlXG4gKi9cbmZ1bmN0aW9uIFByaW1pdGl2ZShvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBkZWZhdWx0VmFsdWUob3B0aW9ucywgZGVmYXVsdFZhbHVlLkVNUFRZX09CSkVDVCk7XG5cbiAgLyoqXG4gICAqIFRoZSBnZW9tZXRyeSBpbnN0YW5jZXMgcmVuZGVyZWQgd2l0aCB0aGlzIHByaW1pdGl2ZS4gIFRoaXMgbWF5XG4gICAqIGJlIDxjb2RlPnVuZGVmaW5lZDwvY29kZT4gaWYgPGNvZGU+b3B0aW9ucy5yZWxlYXNlR2VvbWV0cnlJbnN0YW5jZXM8L2NvZGU+XG4gICAqIGlzIDxjb2RlPnRydWU8L2NvZGU+IHdoZW4gdGhlIHByaW1pdGl2ZSBpcyBjb25zdHJ1Y3RlZC5cbiAgICogPHA+XG4gICAqIENoYW5naW5nIHRoaXMgcHJvcGVydHkgYWZ0ZXIgdGhlIHByaW1pdGl2ZSBpcyByZW5kZXJlZCBoYXMgbm8gZWZmZWN0LlxuICAgKiA8L3A+XG4gICAqXG4gICAqIEByZWFkb25seVxuICAgKiBAdHlwZSBHZW9tZXRyeUluc3RhbmNlW118R2VvbWV0cnlJbnN0YW5jZVxuICAgKlxuICAgKiBAZGVmYXVsdCB1bmRlZmluZWRcbiAgICovXG4gIHRoaXMuZ2VvbWV0cnlJbnN0YW5jZXMgPSBvcHRpb25zLmdlb21ldHJ5SW5zdGFuY2VzO1xuXG4gIC8qKlxuICAgKiBUaGUge0BsaW5rIEFwcGVhcmFuY2V9IHVzZWQgdG8gc2hhZGUgdGhpcyBwcmltaXRpdmUuIEVhY2ggZ2VvbWV0cnlcbiAgICogaW5zdGFuY2UgaXMgc2hhZGVkIHdpdGggdGhlIHNhbWUgYXBwZWFyYW5jZS4gIFNvbWUgYXBwZWFyYW5jZXMsIGxpa2VcbiAgICoge0BsaW5rIFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlfSBhbGxvdyBnaXZpbmcgZWFjaCBpbnN0YW5jZSB1bmlxdWVcbiAgICogcHJvcGVydGllcy5cbiAgICpcbiAgICogQHR5cGUgQXBwZWFyYW5jZVxuICAgKlxuICAgKiBAZGVmYXVsdCB1bmRlZmluZWRcbiAgICovXG4gIHRoaXMuYXBwZWFyYW5jZSA9IG9wdGlvbnMuYXBwZWFyYW5jZTtcbiAgdGhpcy5fYXBwZWFyYW5jZSA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fbWF0ZXJpYWwgPSB1bmRlZmluZWQ7XG5cbiAgLyoqXG4gICAqIFRoZSB7QGxpbmsgQXBwZWFyYW5jZX0gdXNlZCB0byBzaGFkZSB0aGlzIHByaW1pdGl2ZSB3aGVuIGl0IGZhaWxzIHRoZSBkZXB0aCB0ZXN0LiBFYWNoIGdlb21ldHJ5XG4gICAqIGluc3RhbmNlIGlzIHNoYWRlZCB3aXRoIHRoZSBzYW1lIGFwcGVhcmFuY2UuICBTb21lIGFwcGVhcmFuY2VzLCBsaWtlXG4gICAqIHtAbGluayBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZX0gYWxsb3cgZ2l2aW5nIGVhY2ggaW5zdGFuY2UgdW5pcXVlXG4gICAqIHByb3BlcnRpZXMuXG4gICAqXG4gICAqIDxwPlxuICAgKiBXaGVuIHVzaW5nIGFuIGFwcGVhcmFuY2UgdGhhdCByZXF1aXJlcyBhIGNvbG9yIGF0dHJpYnV0ZSwgbGlrZSBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZSxcbiAgICogYWRkIGEgZGVwdGhGYWlsQ29sb3IgcGVyLWluc3RhbmNlIGF0dHJpYnV0ZSBpbnN0ZWFkLlxuICAgKiA8L3A+XG4gICAqXG4gICAqIDxwPlxuICAgKiBSZXF1aXJlcyB0aGUgRVhUX2ZyYWdfZGVwdGggV2ViR0wgZXh0ZW5zaW9uIHRvIHJlbmRlciBwcm9wZXJseS4gSWYgdGhlIGV4dGVuc2lvbiBpcyBub3Qgc3VwcG9ydGVkLFxuICAgKiB0aGVyZSBtYXkgYmUgYXJ0aWZhY3RzLlxuICAgKiA8L3A+XG4gICAqIEB0eXBlIEFwcGVhcmFuY2VcbiAgICpcbiAgICogQGRlZmF1bHQgdW5kZWZpbmVkXG4gICAqL1xuICB0aGlzLmRlcHRoRmFpbEFwcGVhcmFuY2UgPSBvcHRpb25zLmRlcHRoRmFpbEFwcGVhcmFuY2U7XG4gIHRoaXMuX2RlcHRoRmFpbEFwcGVhcmFuY2UgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2RlcHRoRmFpbE1hdGVyaWFsID0gdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKiBUaGUgNHg0IHRyYW5zZm9ybWF0aW9uIG1hdHJpeCB0aGF0IHRyYW5zZm9ybXMgdGhlIHByaW1pdGl2ZSAoYWxsIGdlb21ldHJ5IGluc3RhbmNlcykgZnJvbSBtb2RlbCB0byB3b3JsZCBjb29yZGluYXRlcy5cbiAgICogV2hlbiB0aGlzIGlzIHRoZSBpZGVudGl0eSBtYXRyaXgsIHRoZSBwcmltaXRpdmUgaXMgZHJhd24gaW4gd29ybGQgY29vcmRpbmF0ZXMsIGkuZS4sIEVhcnRoJ3MgV0dTODQgY29vcmRpbmF0ZXMuXG4gICAqIExvY2FsIHJlZmVyZW5jZSBmcmFtZXMgY2FuIGJlIHVzZWQgYnkgcHJvdmlkaW5nIGEgZGlmZmVyZW50IHRyYW5zZm9ybWF0aW9uIG1hdHJpeCwgbGlrZSB0aGF0IHJldHVybmVkXG4gICAqIGJ5IHtAbGluayBUcmFuc2Zvcm1zLmVhc3ROb3J0aFVwVG9GaXhlZEZyYW1lfS5cbiAgICpcbiAgICogPHA+XG4gICAqIFRoaXMgcHJvcGVydHkgaXMgb25seSBzdXBwb3J0ZWQgaW4gM0QgbW9kZS5cbiAgICogPC9wPlxuICAgKlxuICAgKiBAdHlwZSBNYXRyaXg0XG4gICAqXG4gICAqIEBkZWZhdWx0IE1hdHJpeDQuSURFTlRJVFlcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdmFyIG9yaWdpbiA9IENlc2l1bS5DYXJ0ZXNpYW4zLmZyb21EZWdyZWVzKC05NS4wLCA0MC4wLCAyMDAwMDAuMCk7XG4gICAqIHAubW9kZWxNYXRyaXggPSBDZXNpdW0uVHJhbnNmb3Jtcy5lYXN0Tm9ydGhVcFRvRml4ZWRGcmFtZShvcmlnaW4pO1xuICAgKi9cbiAgdGhpcy5tb2RlbE1hdHJpeCA9IE1hdHJpeDQuY2xvbmUoXG4gICAgZGVmYXVsdFZhbHVlKG9wdGlvbnMubW9kZWxNYXRyaXgsIE1hdHJpeDQuSURFTlRJVFkpXG4gICk7XG4gIHRoaXMuX21vZGVsTWF0cml4ID0gbmV3IE1hdHJpeDQoKTtcblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiB0aGUgcHJpbWl0aXZlIHdpbGwgYmUgc2hvd24uICBUaGlzIGFmZmVjdHMgYWxsIGdlb21ldHJ5XG4gICAqIGluc3RhbmNlcyBpbiB0aGUgcHJpbWl0aXZlLlxuICAgKlxuICAgKiBAdHlwZSBCb29sZWFuXG4gICAqXG4gICAqIEBkZWZhdWx0IHRydWVcbiAgICovXG4gIHRoaXMuc2hvdyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLnNob3csIHRydWUpO1xuXG4gIHRoaXMuX3ZlcnRleENhY2hlT3B0aW1pemUgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy52ZXJ0ZXhDYWNoZU9wdGltaXplLCBmYWxzZSk7XG4gIHRoaXMuX2ludGVybGVhdmUgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5pbnRlcmxlYXZlLCBmYWxzZSk7XG4gIHRoaXMuX3JlbGVhc2VHZW9tZXRyeUluc3RhbmNlcyA9IGRlZmF1bHRWYWx1ZShcbiAgICBvcHRpb25zLnJlbGVhc2VHZW9tZXRyeUluc3RhbmNlcyxcbiAgICB0cnVlXG4gICk7XG4gIHRoaXMuX2FsbG93UGlja2luZyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmFsbG93UGlja2luZywgdHJ1ZSk7XG4gIHRoaXMuX2FzeW5jaHJvbm91cyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmFzeW5jaHJvbm91cywgdHJ1ZSk7XG4gIHRoaXMuX2NvbXByZXNzVmVydGljZXMgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5jb21wcmVzc1ZlcnRpY2VzLCB0cnVlKTtcblxuICAvKipcbiAgICogV2hlbiA8Y29kZT50cnVlPC9jb2RlPiwgdGhlIHJlbmRlcmVyIGZydXN0dW0gY3VsbHMgYW5kIGhvcml6b24gY3VsbHMgdGhlIHByaW1pdGl2ZSdzIGNvbW1hbmRzXG4gICAqIGJhc2VkIG9uIHRoZWlyIGJvdW5kaW5nIHZvbHVtZS4gIFNldCB0aGlzIHRvIDxjb2RlPmZhbHNlPC9jb2RlPiBmb3IgYSBzbWFsbCBwZXJmb3JtYW5jZSBnYWluXG4gICAqIGlmIHlvdSBhcmUgbWFudWFsbHkgY3VsbGluZyB0aGUgcHJpbWl0aXZlLlxuICAgKlxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICpcbiAgICogQGRlZmF1bHQgdHJ1ZVxuICAgKi9cbiAgdGhpcy5jdWxsID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuY3VsbCwgdHJ1ZSk7XG5cbiAgLyoqXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgZm9yIGRlYnVnZ2luZyBvbmx5OyBpdCBpcyBub3QgZm9yIHByb2R1Y3Rpb24gdXNlIG5vciBpcyBpdCBvcHRpbWl6ZWQuXG4gICAqIDxwPlxuICAgKiBEcmF3cyB0aGUgYm91bmRpbmcgc3BoZXJlIGZvciBlYWNoIGRyYXcgY29tbWFuZCBpbiB0aGUgcHJpbWl0aXZlLlxuICAgKiA8L3A+XG4gICAqXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKlxuICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgKi9cbiAgdGhpcy5kZWJ1Z1Nob3dCb3VuZGluZ1ZvbHVtZSA9IGRlZmF1bHRWYWx1ZShcbiAgICBvcHRpb25zLmRlYnVnU2hvd0JvdW5kaW5nVm9sdW1lLFxuICAgIGZhbHNlXG4gICk7XG5cbiAgLyoqXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB0aGlzLnJ0Y0NlbnRlciA9IG9wdGlvbnMucnRjQ2VudGVyO1xuXG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIGlmIChcbiAgICBkZWZpbmVkKHRoaXMucnRjQ2VudGVyKSAmJlxuICAgICghZGVmaW5lZCh0aGlzLmdlb21ldHJ5SW5zdGFuY2VzKSB8fFxuICAgICAgKEFycmF5LmlzQXJyYXkodGhpcy5nZW9tZXRyeUluc3RhbmNlcykgJiZcbiAgICAgICAgdGhpcy5nZW9tZXRyeUluc3RhbmNlcy5sZW5ndGggIT09IDEpKVxuICApIHtcbiAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgICBcIlJlbGF0aXZlLXRvLWNlbnRlciByZW5kZXJpbmcgb25seSBzdXBwb3J0cyBvbmUgZ2VvbWV0cnkgaW5zdGFuY2UuXCJcbiAgICApO1xuICB9XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIHdoZXRoZXIgdGhpcyBwcmltaXRpdmUgY2FzdHMgb3IgcmVjZWl2ZXMgc2hhZG93cyBmcm9tIGxpZ2h0IHNvdXJjZXMuXG4gICAqXG4gICAqIEB0eXBlIHtTaGFkb3dNb2RlfVxuICAgKlxuICAgKiBAZGVmYXVsdCBTaGFkb3dNb2RlLkRJU0FCTEVEXG4gICAqL1xuICB0aGlzLnNoYWRvd3MgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5zaGFkb3dzLCBTaGFkb3dNb2RlLkRJU0FCTEVEKTtcblxuICB0aGlzLl90cmFuc2x1Y2VudCA9IHVuZGVmaW5lZDtcblxuICB0aGlzLl9zdGF0ZSA9IFByaW1pdGl2ZVN0YXRlLlJFQURZO1xuICB0aGlzLl9nZW9tZXRyaWVzID0gW107XG4gIHRoaXMuX2Vycm9yID0gdW5kZWZpbmVkO1xuICB0aGlzLl9udW1iZXJPZkluc3RhbmNlcyA9IDA7XG5cbiAgdGhpcy5fYm91bmRpbmdTcGhlcmVzID0gW107XG4gIHRoaXMuX2JvdW5kaW5nU3BoZXJlV0MgPSBbXTtcbiAgdGhpcy5fYm91bmRpbmdTcGhlcmVDViA9IFtdO1xuICB0aGlzLl9ib3VuZGluZ1NwaGVyZTJEID0gW107XG4gIHRoaXMuX2JvdW5kaW5nU3BoZXJlTW9ycGggPSBbXTtcbiAgdGhpcy5fcGVySW5zdGFuY2VBdHRyaWJ1dGVDYWNoZSA9IFtdO1xuICB0aGlzLl9pbnN0YW5jZUlkcyA9IFtdO1xuICB0aGlzLl9sYXN0UGVySW5zdGFuY2VBdHRyaWJ1dGVJbmRleCA9IDA7XG5cbiAgdGhpcy5fdmEgPSBbXTtcbiAgdGhpcy5fYXR0cmlidXRlTG9jYXRpb25zID0gdW5kZWZpbmVkO1xuICB0aGlzLl9wcmltaXRpdmVUeXBlID0gdW5kZWZpbmVkO1xuXG4gIHRoaXMuX2Zyb250RmFjZVJTID0gdW5kZWZpbmVkO1xuICB0aGlzLl9iYWNrRmFjZVJTID0gdW5kZWZpbmVkO1xuICB0aGlzLl9zcCA9IHVuZGVmaW5lZDtcblxuICB0aGlzLl9kZXB0aEZhaWxBcHBlYXJhbmNlID0gdW5kZWZpbmVkO1xuICB0aGlzLl9zcERlcHRoRmFpbCA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fZnJvbnRGYWNlRGVwdGhGYWlsUlMgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2JhY2tGYWNlRGVwdGhGYWlsUlMgPSB1bmRlZmluZWQ7XG5cbiAgdGhpcy5fcGlja0lkcyA9IFtdO1xuXG4gIHRoaXMuX2NvbG9yQ29tbWFuZHMgPSBbXTtcbiAgdGhpcy5fcGlja0NvbW1hbmRzID0gW107XG5cbiAgdGhpcy5fY3JlYXRlQm91bmRpbmdWb2x1bWVGdW5jdGlvbiA9IG9wdGlvbnMuX2NyZWF0ZUJvdW5kaW5nVm9sdW1lRnVuY3Rpb247XG4gIHRoaXMuX2NyZWF0ZVJlbmRlclN0YXRlc0Z1bmN0aW9uID0gb3B0aW9ucy5fY3JlYXRlUmVuZGVyU3RhdGVzRnVuY3Rpb247XG4gIHRoaXMuX2NyZWF0ZVNoYWRlclByb2dyYW1GdW5jdGlvbiA9IG9wdGlvbnMuX2NyZWF0ZVNoYWRlclByb2dyYW1GdW5jdGlvbjtcbiAgdGhpcy5fY3JlYXRlQ29tbWFuZHNGdW5jdGlvbiA9IG9wdGlvbnMuX2NyZWF0ZUNvbW1hbmRzRnVuY3Rpb247XG4gIHRoaXMuX3VwZGF0ZUFuZFF1ZXVlQ29tbWFuZHNGdW5jdGlvbiA9XG4gICAgb3B0aW9ucy5fdXBkYXRlQW5kUXVldWVDb21tYW5kc0Z1bmN0aW9uO1xuXG4gIHRoaXMuX2NyZWF0ZVBpY2tPZmZzZXRzID0gb3B0aW9ucy5fY3JlYXRlUGlja09mZnNldHM7XG4gIHRoaXMuX3BpY2tPZmZzZXRzID0gdW5kZWZpbmVkO1xuXG4gIHRoaXMuX2NyZWF0ZUdlb21ldHJ5UmVzdWx0cyA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fcmVhZHkgPSBmYWxzZTtcbiAgdGhpcy5fcmVhZHlQcm9taXNlID0gd2hlbi5kZWZlcigpO1xuXG4gIHRoaXMuX2JhdGNoVGFibGUgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2JhdGNoVGFibGVBdHRyaWJ1dGVJbmRpY2VzID0gdW5kZWZpbmVkO1xuICB0aGlzLl9vZmZzZXRJbnN0YW5jZUV4dGVuZCA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fYmF0Y2hUYWJsZU9mZnNldEF0dHJpYnV0ZTJESW5kZXggPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2JhdGNoVGFibGVPZmZzZXRzVXBkYXRlZCA9IGZhbHNlO1xuICB0aGlzLl9pbnN0YW5jZUJvdW5kaW5nU3BoZXJlcyA9IHVuZGVmaW5lZDtcbiAgdGhpcy5faW5zdGFuY2VCb3VuZGluZ1NwaGVyZXNDViA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fdGVtcEJvdW5kaW5nU3BoZXJlcyA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fcmVjb21wdXRlQm91bmRpbmdTcGhlcmVzID0gZmFsc2U7XG4gIHRoaXMuX2JhdGNoVGFibGVCb3VuZGluZ1NwaGVyZXNVcGRhdGVkID0gZmFsc2U7XG4gIHRoaXMuX2JhdGNoVGFibGVCb3VuZGluZ1NwaGVyZUF0dHJpYnV0ZUluZGljZXMgPSB1bmRlZmluZWQ7XG59XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFByaW1pdGl2ZS5wcm90b3R5cGUsIHtcbiAgLyoqXG4gICAqIFdoZW4gPGNvZGU+dHJ1ZTwvY29kZT4sIGdlb21ldHJ5IHZlcnRpY2VzIGFyZSBvcHRpbWl6ZWQgZm9yIHRoZSBwcmUgYW5kIHBvc3QtdmVydGV4LXNoYWRlciBjYWNoZXMuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBQcmltaXRpdmUucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKiBAcmVhZG9ubHlcbiAgICpcbiAgICogQGRlZmF1bHQgdHJ1ZVxuICAgKi9cbiAgdmVydGV4Q2FjaGVPcHRpbWl6ZToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3ZlcnRleENhY2hlT3B0aW1pemU7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiBnZW9tZXRyeSB2ZXJ0ZXggYXR0cmlidXRlcyBhcmUgaW50ZXJsZWF2ZWQsIHdoaWNoIGNhbiBzbGlnaHRseSBpbXByb3ZlIHJlbmRlcmluZyBwZXJmb3JtYW5jZS5cbiAgICpcbiAgICogQG1lbWJlcm9mIFByaW1pdGl2ZS5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqIEByZWFkb25seVxuICAgKlxuICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgKi9cbiAgaW50ZXJsZWF2ZToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2ludGVybGVhdmU7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogV2hlbiA8Y29kZT50cnVlPC9jb2RlPiwgdGhlIHByaW1pdGl2ZSBkb2VzIG5vdCBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZSBpbnB1dCA8Y29kZT5nZW9tZXRyeUluc3RhbmNlczwvY29kZT4gdG8gc2F2ZSBtZW1vcnkuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBQcmltaXRpdmUucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKiBAcmVhZG9ubHlcbiAgICpcbiAgICogQGRlZmF1bHQgdHJ1ZVxuICAgKi9cbiAgcmVsZWFzZUdlb21ldHJ5SW5zdGFuY2VzOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcmVsZWFzZUdlb21ldHJ5SW5zdGFuY2VzO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFdoZW4gPGNvZGU+dHJ1ZTwvY29kZT4sIGVhY2ggZ2VvbWV0cnkgaW5zdGFuY2Ugd2lsbCBvbmx5IGJlIHBpY2thYmxlIHdpdGgge0BsaW5rIFNjZW5lI3BpY2t9LiAgV2hlbiA8Y29kZT5mYWxzZTwvY29kZT4sIEdQVSBtZW1vcnkgaXMgc2F2ZWQuICAgICAgICAgKlxuICAgKlxuICAgKiBAbWVtYmVyb2YgUHJpbWl0aXZlLnByb3RvdHlwZVxuICAgKlxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEBkZWZhdWx0IHRydWVcbiAgICovXG4gIGFsbG93UGlja2luZzoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2FsbG93UGlja2luZztcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIGlmIHRoZSBnZW9tZXRyeSBpbnN0YW5jZXMgd2lsbCBiZSBjcmVhdGVkIGFuZCBiYXRjaGVkIG9uIGEgd2ViIHdvcmtlci5cbiAgICpcbiAgICogQG1lbWJlcm9mIFByaW1pdGl2ZS5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqIEByZWFkb25seVxuICAgKlxuICAgKiBAZGVmYXVsdCB0cnVlXG4gICAqL1xuICBhc3luY2hyb25vdXM6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9hc3luY2hyb25vdXM7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogV2hlbiA8Y29kZT50cnVlPC9jb2RlPiwgZ2VvbWV0cnkgdmVydGljZXMgYXJlIGNvbXByZXNzZWQsIHdoaWNoIHdpbGwgc2F2ZSBtZW1vcnkuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBQcmltaXRpdmUucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKiBAcmVhZG9ubHlcbiAgICpcbiAgICogQGRlZmF1bHQgdHJ1ZVxuICAgKi9cbiAgY29tcHJlc3NWZXJ0aWNlczoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NvbXByZXNzVmVydGljZXM7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiB0aGUgcHJpbWl0aXZlIGlzIGNvbXBsZXRlIGFuZCByZWFkeSB0byByZW5kZXIuICBJZiB0aGlzIHByb3BlcnR5IGlzXG4gICAqIHRydWUsIHRoZSBwcmltaXRpdmUgd2lsbCBiZSByZW5kZXJlZCB0aGUgbmV4dCB0aW1lIHRoYXQge0BsaW5rIFByaW1pdGl2ZSN1cGRhdGV9XG4gICAqIGlzIGNhbGxlZC5cbiAgICpcbiAgICogQG1lbWJlcm9mIFByaW1pdGl2ZS5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqIEByZWFkb25seVxuICAgKi9cbiAgcmVhZHk6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9yZWFkeTtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBHZXRzIGEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIHdoZW4gdGhlIHByaW1pdGl2ZSBpcyByZWFkeSB0byByZW5kZXIuXG4gICAqIEBtZW1iZXJvZiBQcmltaXRpdmUucHJvdG90eXBlXG4gICAqIEB0eXBlIHtQcm9taXNlLjxQcmltaXRpdmU+fVxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIHJlYWR5UHJvbWlzZToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3JlYWR5UHJvbWlzZS5wcm9taXNlO1xuICAgIH0sXG4gIH0sXG59KTtcblxuZnVuY3Rpb24gZ2V0Q29tbW9uUGVySW5zdGFuY2VBdHRyaWJ1dGVOYW1lcyhpbnN0YW5jZXMpIHtcbiAgdmFyIGxlbmd0aCA9IGluc3RhbmNlcy5sZW5ndGg7XG5cbiAgdmFyIGF0dHJpYnV0ZXNJbkFsbEluc3RhbmNlcyA9IFtdO1xuICB2YXIgYXR0cmlidXRlczAgPSBpbnN0YW5jZXNbMF0uYXR0cmlidXRlcztcbiAgdmFyIG5hbWU7XG5cbiAgZm9yIChuYW1lIGluIGF0dHJpYnV0ZXMwKSB7XG4gICAgaWYgKGF0dHJpYnV0ZXMwLmhhc093blByb3BlcnR5KG5hbWUpICYmIGRlZmluZWQoYXR0cmlidXRlczBbbmFtZV0pKSB7XG4gICAgICB2YXIgYXR0cmlidXRlID0gYXR0cmlidXRlczBbbmFtZV07XG4gICAgICB2YXIgaW5BbGxJbnN0YW5jZXMgPSB0cnVlO1xuXG4gICAgICAvLyBEb2VzIHRoaXMgc2FtZSBhdHRyaWJ1dGUgZXhpc3QgaW4gYWxsIGluc3RhbmNlcz9cbiAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIG90aGVyQXR0cmlidXRlID0gaW5zdGFuY2VzW2ldLmF0dHJpYnV0ZXNbbmFtZV07XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICFkZWZpbmVkKG90aGVyQXR0cmlidXRlKSB8fFxuICAgICAgICAgIGF0dHJpYnV0ZS5jb21wb25lbnREYXRhdHlwZSAhPT0gb3RoZXJBdHRyaWJ1dGUuY29tcG9uZW50RGF0YXR5cGUgfHxcbiAgICAgICAgICBhdHRyaWJ1dGUuY29tcG9uZW50c1BlckF0dHJpYnV0ZSAhPT1cbiAgICAgICAgICAgIG90aGVyQXR0cmlidXRlLmNvbXBvbmVudHNQZXJBdHRyaWJ1dGUgfHxcbiAgICAgICAgICBhdHRyaWJ1dGUubm9ybWFsaXplICE9PSBvdGhlckF0dHJpYnV0ZS5ub3JtYWxpemVcbiAgICAgICAgKSB7XG4gICAgICAgICAgaW5BbGxJbnN0YW5jZXMgPSBmYWxzZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoaW5BbGxJbnN0YW5jZXMpIHtcbiAgICAgICAgYXR0cmlidXRlc0luQWxsSW5zdGFuY2VzLnB1c2gobmFtZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGF0dHJpYnV0ZXNJbkFsbEluc3RhbmNlcztcbn1cblxudmFyIHNjcmF0Y2hHZXRBdHRyaWJ1dGVDYXJ0ZXNpYW4yID0gbmV3IENhcnRlc2lhbjIoKTtcbnZhciBzY3JhdGNoR2V0QXR0cmlidXRlQ2FydGVzaWFuMyA9IG5ldyBDYXJ0ZXNpYW4zKCk7XG52YXIgc2NyYXRjaEdldEF0dHJpYnV0ZUNhcnRlc2lhbjQgPSBuZXcgQ2FydGVzaWFuNCgpO1xuXG5mdW5jdGlvbiBnZXRBdHRyaWJ1dGVWYWx1ZSh2YWx1ZSkge1xuICB2YXIgY29tcG9uZW50c1BlckF0dHJpYnV0ZSA9IHZhbHVlLmxlbmd0aDtcbiAgaWYgKGNvbXBvbmVudHNQZXJBdHRyaWJ1dGUgPT09IDEpIHtcbiAgICByZXR1cm4gdmFsdWVbMF07XG4gIH0gZWxzZSBpZiAoY29tcG9uZW50c1BlckF0dHJpYnV0ZSA9PT0gMikge1xuICAgIHJldHVybiBDYXJ0ZXNpYW4yLnVucGFjayh2YWx1ZSwgMCwgc2NyYXRjaEdldEF0dHJpYnV0ZUNhcnRlc2lhbjIpO1xuICB9IGVsc2UgaWYgKGNvbXBvbmVudHNQZXJBdHRyaWJ1dGUgPT09IDMpIHtcbiAgICByZXR1cm4gQ2FydGVzaWFuMy51bnBhY2sodmFsdWUsIDAsIHNjcmF0Y2hHZXRBdHRyaWJ1dGVDYXJ0ZXNpYW4zKTtcbiAgfSBlbHNlIGlmIChjb21wb25lbnRzUGVyQXR0cmlidXRlID09PSA0KSB7XG4gICAgcmV0dXJuIENhcnRlc2lhbjQudW5wYWNrKHZhbHVlLCAwLCBzY3JhdGNoR2V0QXR0cmlidXRlQ2FydGVzaWFuNCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlQmF0Y2hUYWJsZShwcmltaXRpdmUsIGNvbnRleHQpIHtcbiAgdmFyIGdlb21ldHJ5SW5zdGFuY2VzID0gcHJpbWl0aXZlLmdlb21ldHJ5SW5zdGFuY2VzO1xuICB2YXIgaW5zdGFuY2VzID0gQXJyYXkuaXNBcnJheShnZW9tZXRyeUluc3RhbmNlcylcbiAgICA/IGdlb21ldHJ5SW5zdGFuY2VzXG4gICAgOiBbZ2VvbWV0cnlJbnN0YW5jZXNdO1xuICB2YXIgbnVtYmVyT2ZJbnN0YW5jZXMgPSBpbnN0YW5jZXMubGVuZ3RoO1xuICBpZiAobnVtYmVyT2ZJbnN0YW5jZXMgPT09IDApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgbmFtZXMgPSBnZXRDb21tb25QZXJJbnN0YW5jZUF0dHJpYnV0ZU5hbWVzKGluc3RhbmNlcyk7XG4gIHZhciBsZW5ndGggPSBuYW1lcy5sZW5ndGg7XG5cbiAgdmFyIGF0dHJpYnV0ZXMgPSBbXTtcbiAgdmFyIGF0dHJpYnV0ZUluZGljZXMgPSB7fTtcbiAgdmFyIGJvdW5kaW5nU3BoZXJlQXR0cmlidXRlSW5kaWNlcyA9IHt9O1xuICB2YXIgb2Zmc2V0MkRJbmRleDtcblxuICB2YXIgZmlyc3RJbnN0YW5jZSA9IGluc3RhbmNlc1swXTtcbiAgdmFyIGluc3RhbmNlQXR0cmlidXRlcyA9IGZpcnN0SW5zdGFuY2UuYXR0cmlidXRlcztcblxuICB2YXIgaTtcbiAgdmFyIG5hbWU7XG4gIHZhciBhdHRyaWJ1dGU7XG5cbiAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgbmFtZSA9IG5hbWVzW2ldO1xuICAgIGF0dHJpYnV0ZSA9IGluc3RhbmNlQXR0cmlidXRlc1tuYW1lXTtcblxuICAgIGF0dHJpYnV0ZUluZGljZXNbbmFtZV0gPSBpO1xuICAgIGF0dHJpYnV0ZXMucHVzaCh7XG4gICAgICBmdW5jdGlvbk5hbWU6IFwiY3ptX2JhdGNoVGFibGVfXCIgKyBuYW1lLFxuICAgICAgY29tcG9uZW50RGF0YXR5cGU6IGF0dHJpYnV0ZS5jb21wb25lbnREYXRhdHlwZSxcbiAgICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGU6IGF0dHJpYnV0ZS5jb21wb25lbnRzUGVyQXR0cmlidXRlLFxuICAgICAgbm9ybWFsaXplOiBhdHRyaWJ1dGUubm9ybWFsaXplLFxuICAgIH0pO1xuICB9XG5cbiAgaWYgKG5hbWVzLmluZGV4T2YoXCJkaXN0YW5jZURpc3BsYXlDb25kaXRpb25cIikgIT09IC0xKSB7XG4gICAgYXR0cmlidXRlcy5wdXNoKFxuICAgICAge1xuICAgICAgICBmdW5jdGlvbk5hbWU6IFwiY3ptX2JhdGNoVGFibGVfYm91bmRpbmdTcGhlcmVDZW50ZXIzREhpZ2hcIixcbiAgICAgICAgY29tcG9uZW50RGF0YXR5cGU6IENvbXBvbmVudERhdGF0eXBlLkZMT0FULFxuICAgICAgICBjb21wb25lbnRzUGVyQXR0cmlidXRlOiAzLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgZnVuY3Rpb25OYW1lOiBcImN6bV9iYXRjaFRhYmxlX2JvdW5kaW5nU3BoZXJlQ2VudGVyM0RMb3dcIixcbiAgICAgICAgY29tcG9uZW50RGF0YXR5cGU6IENvbXBvbmVudERhdGF0eXBlLkZMT0FULFxuICAgICAgICBjb21wb25lbnRzUGVyQXR0cmlidXRlOiAzLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgZnVuY3Rpb25OYW1lOiBcImN6bV9iYXRjaFRhYmxlX2JvdW5kaW5nU3BoZXJlQ2VudGVyMkRIaWdoXCIsXG4gICAgICAgIGNvbXBvbmVudERhdGF0eXBlOiBDb21wb25lbnREYXRhdHlwZS5GTE9BVCxcbiAgICAgICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogMyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGZ1bmN0aW9uTmFtZTogXCJjem1fYmF0Y2hUYWJsZV9ib3VuZGluZ1NwaGVyZUNlbnRlcjJETG93XCIsXG4gICAgICAgIGNvbXBvbmVudERhdGF0eXBlOiBDb21wb25lbnREYXRhdHlwZS5GTE9BVCxcbiAgICAgICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogMyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGZ1bmN0aW9uTmFtZTogXCJjem1fYmF0Y2hUYWJsZV9ib3VuZGluZ1NwaGVyZVJhZGl1c1wiLFxuICAgICAgICBjb21wb25lbnREYXRhdHlwZTogQ29tcG9uZW50RGF0YXR5cGUuRkxPQVQsXG4gICAgICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGU6IDEsXG4gICAgICB9XG4gICAgKTtcbiAgICBib3VuZGluZ1NwaGVyZUF0dHJpYnV0ZUluZGljZXMuY2VudGVyM0RIaWdoID0gYXR0cmlidXRlcy5sZW5ndGggLSA1O1xuICAgIGJvdW5kaW5nU3BoZXJlQXR0cmlidXRlSW5kaWNlcy5jZW50ZXIzRExvdyA9IGF0dHJpYnV0ZXMubGVuZ3RoIC0gNDtcbiAgICBib3VuZGluZ1NwaGVyZUF0dHJpYnV0ZUluZGljZXMuY2VudGVyMkRIaWdoID0gYXR0cmlidXRlcy5sZW5ndGggLSAzO1xuICAgIGJvdW5kaW5nU3BoZXJlQXR0cmlidXRlSW5kaWNlcy5jZW50ZXIyRExvdyA9IGF0dHJpYnV0ZXMubGVuZ3RoIC0gMjtcbiAgICBib3VuZGluZ1NwaGVyZUF0dHJpYnV0ZUluZGljZXMucmFkaXVzID0gYXR0cmlidXRlcy5sZW5ndGggLSAxO1xuICB9XG5cbiAgaWYgKG5hbWVzLmluZGV4T2YoXCJvZmZzZXRcIikgIT09IC0xKSB7XG4gICAgYXR0cmlidXRlcy5wdXNoKHtcbiAgICAgIGZ1bmN0aW9uTmFtZTogXCJjem1fYmF0Y2hUYWJsZV9vZmZzZXQyRFwiLFxuICAgICAgY29tcG9uZW50RGF0YXR5cGU6IENvbXBvbmVudERhdGF0eXBlLkZMT0FULFxuICAgICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogMyxcbiAgICB9KTtcbiAgICBvZmZzZXQyREluZGV4ID0gYXR0cmlidXRlcy5sZW5ndGggLSAxO1xuICB9XG5cbiAgYXR0cmlidXRlcy5wdXNoKHtcbiAgICBmdW5jdGlvbk5hbWU6IFwiY3ptX2JhdGNoVGFibGVfcGlja0NvbG9yXCIsXG4gICAgY29tcG9uZW50RGF0YXR5cGU6IENvbXBvbmVudERhdGF0eXBlLlVOU0lHTkVEX0JZVEUsXG4gICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogNCxcbiAgICBub3JtYWxpemU6IHRydWUsXG4gIH0pO1xuXG4gIHZhciBhdHRyaWJ1dGVzTGVuZ3RoID0gYXR0cmlidXRlcy5sZW5ndGg7XG4gIHZhciBiYXRjaFRhYmxlID0gbmV3IEJhdGNoVGFibGUoY29udGV4dCwgYXR0cmlidXRlcywgbnVtYmVyT2ZJbnN0YW5jZXMpO1xuXG4gIGZvciAoaSA9IDA7IGkgPCBudW1iZXJPZkluc3RhbmNlczsgKytpKSB7XG4gICAgdmFyIGluc3RhbmNlID0gaW5zdGFuY2VzW2ldO1xuICAgIGluc3RhbmNlQXR0cmlidXRlcyA9IGluc3RhbmNlLmF0dHJpYnV0ZXM7XG5cbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IGxlbmd0aDsgKytqKSB7XG4gICAgICBuYW1lID0gbmFtZXNbal07XG4gICAgICBhdHRyaWJ1dGUgPSBpbnN0YW5jZUF0dHJpYnV0ZXNbbmFtZV07XG4gICAgICB2YXIgdmFsdWUgPSBnZXRBdHRyaWJ1dGVWYWx1ZShhdHRyaWJ1dGUudmFsdWUpO1xuICAgICAgdmFyIGF0dHJpYnV0ZUluZGV4ID0gYXR0cmlidXRlSW5kaWNlc1tuYW1lXTtcbiAgICAgIGJhdGNoVGFibGUuc2V0QmF0Y2hlZEF0dHJpYnV0ZShpLCBhdHRyaWJ1dGVJbmRleCwgdmFsdWUpO1xuICAgIH1cblxuICAgIHZhciBwaWNrT2JqZWN0ID0ge1xuICAgICAgcHJpbWl0aXZlOiBkZWZhdWx0VmFsdWUoaW5zdGFuY2UucGlja1ByaW1pdGl2ZSwgcHJpbWl0aXZlKSxcbiAgICB9O1xuXG4gICAgaWYgKGRlZmluZWQoaW5zdGFuY2UuaWQpKSB7XG4gICAgICBwaWNrT2JqZWN0LmlkID0gaW5zdGFuY2UuaWQ7XG4gICAgfVxuXG4gICAgdmFyIHBpY2tJZCA9IGNvbnRleHQuY3JlYXRlUGlja0lkKHBpY2tPYmplY3QpO1xuICAgIHByaW1pdGl2ZS5fcGlja0lkcy5wdXNoKHBpY2tJZCk7XG5cbiAgICB2YXIgcGlja0NvbG9yID0gcGlja0lkLmNvbG9yO1xuICAgIHZhciBjb2xvciA9IHNjcmF0Y2hHZXRBdHRyaWJ1dGVDYXJ0ZXNpYW40O1xuICAgIGNvbG9yLnggPSBDb2xvci5mbG9hdFRvQnl0ZShwaWNrQ29sb3IucmVkKTtcbiAgICBjb2xvci55ID0gQ29sb3IuZmxvYXRUb0J5dGUocGlja0NvbG9yLmdyZWVuKTtcbiAgICBjb2xvci56ID0gQ29sb3IuZmxvYXRUb0J5dGUocGlja0NvbG9yLmJsdWUpO1xuICAgIGNvbG9yLncgPSBDb2xvci5mbG9hdFRvQnl0ZShwaWNrQ29sb3IuYWxwaGEpO1xuXG4gICAgYmF0Y2hUYWJsZS5zZXRCYXRjaGVkQXR0cmlidXRlKGksIGF0dHJpYnV0ZXNMZW5ndGggLSAxLCBjb2xvcik7XG4gIH1cblxuICBwcmltaXRpdmUuX2JhdGNoVGFibGUgPSBiYXRjaFRhYmxlO1xuICBwcmltaXRpdmUuX2JhdGNoVGFibGVBdHRyaWJ1dGVJbmRpY2VzID0gYXR0cmlidXRlSW5kaWNlcztcbiAgcHJpbWl0aXZlLl9iYXRjaFRhYmxlQm91bmRpbmdTcGhlcmVBdHRyaWJ1dGVJbmRpY2VzID0gYm91bmRpbmdTcGhlcmVBdHRyaWJ1dGVJbmRpY2VzO1xuICBwcmltaXRpdmUuX2JhdGNoVGFibGVPZmZzZXRBdHRyaWJ1dGUyREluZGV4ID0gb2Zmc2V0MkRJbmRleDtcbn1cblxuZnVuY3Rpb24gY2xvbmVBdHRyaWJ1dGUoYXR0cmlidXRlKSB7XG4gIHZhciBjbG9uZWRWYWx1ZXM7XG4gIGlmIChBcnJheS5pc0FycmF5KGF0dHJpYnV0ZS52YWx1ZXMpKSB7XG4gICAgY2xvbmVkVmFsdWVzID0gYXR0cmlidXRlLnZhbHVlcy5zbGljZSgwKTtcbiAgfSBlbHNlIHtcbiAgICBjbG9uZWRWYWx1ZXMgPSBuZXcgYXR0cmlidXRlLnZhbHVlcy5jb25zdHJ1Y3RvcihhdHRyaWJ1dGUudmFsdWVzKTtcbiAgfVxuICByZXR1cm4gbmV3IEdlb21ldHJ5QXR0cmlidXRlKHtcbiAgICBjb21wb25lbnREYXRhdHlwZTogYXR0cmlidXRlLmNvbXBvbmVudERhdGF0eXBlLFxuICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGU6IGF0dHJpYnV0ZS5jb21wb25lbnRzUGVyQXR0cmlidXRlLFxuICAgIG5vcm1hbGl6ZTogYXR0cmlidXRlLm5vcm1hbGl6ZSxcbiAgICB2YWx1ZXM6IGNsb25lZFZhbHVlcyxcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGNsb25lR2VvbWV0cnkoZ2VvbWV0cnkpIHtcbiAgdmFyIGF0dHJpYnV0ZXMgPSBnZW9tZXRyeS5hdHRyaWJ1dGVzO1xuICB2YXIgbmV3QXR0cmlidXRlcyA9IG5ldyBHZW9tZXRyeUF0dHJpYnV0ZXMoKTtcbiAgZm9yICh2YXIgcHJvcGVydHkgaW4gYXR0cmlidXRlcykge1xuICAgIGlmIChhdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KHByb3BlcnR5KSAmJiBkZWZpbmVkKGF0dHJpYnV0ZXNbcHJvcGVydHldKSkge1xuICAgICAgbmV3QXR0cmlidXRlc1twcm9wZXJ0eV0gPSBjbG9uZUF0dHJpYnV0ZShhdHRyaWJ1dGVzW3Byb3BlcnR5XSk7XG4gICAgfVxuICB9XG5cbiAgdmFyIGluZGljZXM7XG4gIGlmIChkZWZpbmVkKGdlb21ldHJ5LmluZGljZXMpKSB7XG4gICAgdmFyIHNvdXJjZVZhbHVlcyA9IGdlb21ldHJ5LmluZGljZXM7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoc291cmNlVmFsdWVzKSkge1xuICAgICAgaW5kaWNlcyA9IHNvdXJjZVZhbHVlcy5zbGljZSgwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaW5kaWNlcyA9IG5ldyBzb3VyY2VWYWx1ZXMuY29uc3RydWN0b3Ioc291cmNlVmFsdWVzKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbmV3IEdlb21ldHJ5KHtcbiAgICBhdHRyaWJ1dGVzOiBuZXdBdHRyaWJ1dGVzLFxuICAgIGluZGljZXM6IGluZGljZXMsXG4gICAgcHJpbWl0aXZlVHlwZTogZ2VvbWV0cnkucHJpbWl0aXZlVHlwZSxcbiAgICBib3VuZGluZ1NwaGVyZTogQm91bmRpbmdTcGhlcmUuY2xvbmUoZ2VvbWV0cnkuYm91bmRpbmdTcGhlcmUpLFxuICB9KTtcbn1cblxuZnVuY3Rpb24gY2xvbmVJbnN0YW5jZShpbnN0YW5jZSwgZ2VvbWV0cnkpIHtcbiAgcmV0dXJuIHtcbiAgICBnZW9tZXRyeTogZ2VvbWV0cnksXG4gICAgYXR0cmlidXRlczogaW5zdGFuY2UuYXR0cmlidXRlcyxcbiAgICBtb2RlbE1hdHJpeDogTWF0cml4NC5jbG9uZShpbnN0YW5jZS5tb2RlbE1hdHJpeCksXG4gICAgcGlja1ByaW1pdGl2ZTogaW5zdGFuY2UucGlja1ByaW1pdGl2ZSxcbiAgICBpZDogaW5zdGFuY2UuaWQsXG4gIH07XG59XG5cbnZhciBwb3NpdGlvblJlZ2V4ID0gL2F0dHJpYnV0ZVxccyt2ZWMoPzozfDQpXFxzKyguKikzREhpZ2g7L2c7XG5cblByaW1pdGl2ZS5fbW9kaWZ5U2hhZGVyUG9zaXRpb24gPSBmdW5jdGlvbiAoXG4gIHByaW1pdGl2ZSxcbiAgdmVydGV4U2hhZGVyU291cmNlLFxuICBzY2VuZTNET25seVxuKSB7XG4gIHZhciBtYXRjaDtcblxuICB2YXIgZm9yd2FyZERlY2wgPSBcIlwiO1xuICB2YXIgYXR0cmlidXRlcyA9IFwiXCI7XG4gIHZhciBjb21wdXRlRnVuY3Rpb25zID0gXCJcIjtcblxuICB3aGlsZSAoKG1hdGNoID0gcG9zaXRpb25SZWdleC5leGVjKHZlcnRleFNoYWRlclNvdXJjZSkpICE9PSBudWxsKSB7XG4gICAgdmFyIG5hbWUgPSBtYXRjaFsxXTtcblxuICAgIHZhciBmdW5jdGlvbk5hbWUgPVxuICAgICAgXCJ2ZWM0IGN6bV9jb21wdXRlXCIgKyBuYW1lWzBdLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnN1YnN0cigxKSArIFwiKClcIjtcblxuICAgIC8vIERvbid0IGZvcndhcmQtZGVjbGFyZSBjem1fY29tcHV0ZVBvc2l0aW9uIGJlY2F1c2UgY29tcHV0ZVBvc2l0aW9uLmdsc2wgYWxyZWFkeSBkb2VzLlxuICAgIGlmIChmdW5jdGlvbk5hbWUgIT09IFwidmVjNCBjem1fY29tcHV0ZVBvc2l0aW9uKClcIikge1xuICAgICAgZm9yd2FyZERlY2wgKz0gZnVuY3Rpb25OYW1lICsgXCI7XFxuXCI7XG4gICAgfVxuXG4gICAgaWYgKCFkZWZpbmVkKHByaW1pdGl2ZS5ydGNDZW50ZXIpKSB7XG4gICAgICAvLyBVc2UgR1BVIFJURVxuICAgICAgaWYgKCFzY2VuZTNET25seSkge1xuICAgICAgICBhdHRyaWJ1dGVzICs9XG4gICAgICAgICAgXCJhdHRyaWJ1dGUgdmVjMyBcIiArXG4gICAgICAgICAgbmFtZSArXG4gICAgICAgICAgXCIyREhpZ2g7XFxuXCIgK1xuICAgICAgICAgIFwiYXR0cmlidXRlIHZlYzMgXCIgK1xuICAgICAgICAgIG5hbWUgK1xuICAgICAgICAgIFwiMkRMb3c7XFxuXCI7XG5cbiAgICAgICAgY29tcHV0ZUZ1bmN0aW9ucyArPVxuICAgICAgICAgIGZ1bmN0aW9uTmFtZSArXG4gICAgICAgICAgXCJcXG5cIiArXG4gICAgICAgICAgXCJ7XFxuXCIgK1xuICAgICAgICAgIFwiICAgIHZlYzQgcDtcXG5cIiArXG4gICAgICAgICAgXCIgICAgaWYgKGN6bV9tb3JwaFRpbWUgPT0gMS4wKVxcblwiICtcbiAgICAgICAgICBcIiAgICB7XFxuXCIgK1xuICAgICAgICAgIFwiICAgICAgICBwID0gY3ptX3RyYW5zbGF0ZVJlbGF0aXZlVG9FeWUoXCIgK1xuICAgICAgICAgIG5hbWUgK1xuICAgICAgICAgIFwiM0RIaWdoLCBcIiArXG4gICAgICAgICAgbmFtZSArXG4gICAgICAgICAgXCIzRExvdyk7XFxuXCIgK1xuICAgICAgICAgIFwiICAgIH1cXG5cIiArXG4gICAgICAgICAgXCIgICAgZWxzZSBpZiAoY3ptX21vcnBoVGltZSA9PSAwLjApXFxuXCIgK1xuICAgICAgICAgIFwiICAgIHtcXG5cIiArXG4gICAgICAgICAgXCIgICAgICAgIHAgPSBjem1fdHJhbnNsYXRlUmVsYXRpdmVUb0V5ZShcIiArXG4gICAgICAgICAgbmFtZSArXG4gICAgICAgICAgXCIyREhpZ2guenh5LCBcIiArXG4gICAgICAgICAgbmFtZSArXG4gICAgICAgICAgXCIyRExvdy56eHkpO1xcblwiICtcbiAgICAgICAgICBcIiAgICB9XFxuXCIgK1xuICAgICAgICAgIFwiICAgIGVsc2VcXG5cIiArXG4gICAgICAgICAgXCIgICAge1xcblwiICtcbiAgICAgICAgICBcIiAgICAgICAgcCA9IGN6bV9jb2x1bWJ1c1ZpZXdNb3JwaChcXG5cIiArXG4gICAgICAgICAgXCIgICAgICAgICAgICAgICAgY3ptX3RyYW5zbGF0ZVJlbGF0aXZlVG9FeWUoXCIgK1xuICAgICAgICAgIG5hbWUgK1xuICAgICAgICAgIFwiMkRIaWdoLnp4eSwgXCIgK1xuICAgICAgICAgIG5hbWUgK1xuICAgICAgICAgIFwiMkRMb3cuenh5KSxcXG5cIiArXG4gICAgICAgICAgXCIgICAgICAgICAgICAgICAgY3ptX3RyYW5zbGF0ZVJlbGF0aXZlVG9FeWUoXCIgK1xuICAgICAgICAgIG5hbWUgK1xuICAgICAgICAgIFwiM0RIaWdoLCBcIiArXG4gICAgICAgICAgbmFtZSArXG4gICAgICAgICAgXCIzRExvdyksXFxuXCIgK1xuICAgICAgICAgIFwiICAgICAgICAgICAgICAgIGN6bV9tb3JwaFRpbWUpO1xcblwiICtcbiAgICAgICAgICBcIiAgICB9XFxuXCIgK1xuICAgICAgICAgIFwiICAgIHJldHVybiBwO1xcblwiICtcbiAgICAgICAgICBcIn1cXG5cXG5cIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbXB1dGVGdW5jdGlvbnMgKz1cbiAgICAgICAgICBmdW5jdGlvbk5hbWUgK1xuICAgICAgICAgIFwiXFxuXCIgK1xuICAgICAgICAgIFwie1xcblwiICtcbiAgICAgICAgICBcIiAgICByZXR1cm4gY3ptX3RyYW5zbGF0ZVJlbGF0aXZlVG9FeWUoXCIgK1xuICAgICAgICAgIG5hbWUgK1xuICAgICAgICAgIFwiM0RIaWdoLCBcIiArXG4gICAgICAgICAgbmFtZSArXG4gICAgICAgICAgXCIzRExvdyk7XFxuXCIgK1xuICAgICAgICAgIFwifVxcblxcblwiO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBVc2UgUlRDXG4gICAgICB2ZXJ0ZXhTaGFkZXJTb3VyY2UgPSB2ZXJ0ZXhTaGFkZXJTb3VyY2UucmVwbGFjZShcbiAgICAgICAgL2F0dHJpYnV0ZVxccyt2ZWMoPzozfDQpXFxzK3Bvc2l0aW9uM0RIaWdoOy9nLFxuICAgICAgICBcIlwiXG4gICAgICApO1xuICAgICAgdmVydGV4U2hhZGVyU291cmNlID0gdmVydGV4U2hhZGVyU291cmNlLnJlcGxhY2UoXG4gICAgICAgIC9hdHRyaWJ1dGVcXHMrdmVjKD86M3w0KVxccytwb3NpdGlvbjNETG93Oy9nLFxuICAgICAgICBcIlwiXG4gICAgICApO1xuXG4gICAgICBmb3J3YXJkRGVjbCArPSBcInVuaWZvcm0gbWF0NCB1X21vZGlmaWVkTW9kZWxWaWV3O1xcblwiO1xuICAgICAgYXR0cmlidXRlcyArPSBcImF0dHJpYnV0ZSB2ZWM0IHBvc2l0aW9uO1xcblwiO1xuXG4gICAgICBjb21wdXRlRnVuY3Rpb25zICs9XG4gICAgICAgIGZ1bmN0aW9uTmFtZSArXG4gICAgICAgIFwiXFxuXCIgK1xuICAgICAgICBcIntcXG5cIiArXG4gICAgICAgIFwiICAgIHJldHVybiB1X21vZGlmaWVkTW9kZWxWaWV3ICogcG9zaXRpb247XFxuXCIgK1xuICAgICAgICBcIn1cXG5cXG5cIjtcblxuICAgICAgdmVydGV4U2hhZGVyU291cmNlID0gdmVydGV4U2hhZGVyU291cmNlLnJlcGxhY2UoXG4gICAgICAgIC9jem1fbW9kZWxWaWV3UmVsYXRpdmVUb0V5ZVxccytcXCpcXHMrL2csXG4gICAgICAgIFwiXCJcbiAgICAgICk7XG4gICAgICB2ZXJ0ZXhTaGFkZXJTb3VyY2UgPSB2ZXJ0ZXhTaGFkZXJTb3VyY2UucmVwbGFjZShcbiAgICAgICAgL2N6bV9tb2RlbFZpZXdQcm9qZWN0aW9uUmVsYXRpdmVUb0V5ZS9nLFxuICAgICAgICBcImN6bV9wcm9qZWN0aW9uXCJcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIFtmb3J3YXJkRGVjbCwgYXR0cmlidXRlcywgdmVydGV4U2hhZGVyU291cmNlLCBjb21wdXRlRnVuY3Rpb25zXS5qb2luKFxuICAgIFwiXFxuXCJcbiAgKTtcbn07XG5cblByaW1pdGl2ZS5fYXBwZW5kU2hvd1RvU2hhZGVyID0gZnVuY3Rpb24gKHByaW1pdGl2ZSwgdmVydGV4U2hhZGVyU291cmNlKSB7XG4gIGlmICghZGVmaW5lZChwcmltaXRpdmUuX2JhdGNoVGFibGVBdHRyaWJ1dGVJbmRpY2VzLnNob3cpKSB7XG4gICAgcmV0dXJuIHZlcnRleFNoYWRlclNvdXJjZTtcbiAgfVxuXG4gIHZhciByZW5hbWVkVlMgPSBTaGFkZXJTb3VyY2UucmVwbGFjZU1haW4oXG4gICAgdmVydGV4U2hhZGVyU291cmNlLFxuICAgIFwiY3ptX25vbl9zaG93X21haW5cIlxuICApO1xuICB2YXIgc2hvd01haW4gPVxuICAgIFwidm9pZCBtYWluKCkgXFxuXCIgK1xuICAgIFwieyBcXG5cIiArXG4gICAgXCIgICAgY3ptX25vbl9zaG93X21haW4oKTsgXFxuXCIgK1xuICAgIFwiICAgIGdsX1Bvc2l0aW9uICo9IGN6bV9iYXRjaFRhYmxlX3Nob3coYmF0Y2hJZCk7IFxcblwiICtcbiAgICBcIn1cIjtcblxuICByZXR1cm4gcmVuYW1lZFZTICsgXCJcXG5cIiArIHNob3dNYWluO1xufTtcblxuUHJpbWl0aXZlLl91cGRhdGVDb2xvckF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChcbiAgcHJpbWl0aXZlLFxuICB2ZXJ0ZXhTaGFkZXJTb3VyY2UsXG4gIGlzRGVwdGhGYWlsXG4pIHtcbiAgLy8gc29tZSBhcHBlYXJhbmNlcyBoYXZlIGEgY29sb3IgYXR0cmlidXRlIGZvciBwZXIgdmVydGV4IGNvbG9yLlxuICAvLyBvbmx5IHJlbW92ZSBpZiBjb2xvciBpcyBhIHBlciBpbnN0YW5jZSBhdHRyaWJ1dGUuXG4gIGlmIChcbiAgICAhZGVmaW5lZChwcmltaXRpdmUuX2JhdGNoVGFibGVBdHRyaWJ1dGVJbmRpY2VzLmNvbG9yKSAmJlxuICAgICFkZWZpbmVkKHByaW1pdGl2ZS5fYmF0Y2hUYWJsZUF0dHJpYnV0ZUluZGljZXMuZGVwdGhGYWlsQ29sb3IpXG4gICkge1xuICAgIHJldHVybiB2ZXJ0ZXhTaGFkZXJTb3VyY2U7XG4gIH1cblxuICBpZiAodmVydGV4U2hhZGVyU291cmNlLnNlYXJjaCgvYXR0cmlidXRlXFxzK3ZlYzRcXHMrY29sb3I7L2cpID09PSAtMSkge1xuICAgIHJldHVybiB2ZXJ0ZXhTaGFkZXJTb3VyY2U7XG4gIH1cblxuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBpZiAoXG4gICAgaXNEZXB0aEZhaWwgJiZcbiAgICAhZGVmaW5lZChwcmltaXRpdmUuX2JhdGNoVGFibGVBdHRyaWJ1dGVJbmRpY2VzLmRlcHRoRmFpbENvbG9yKVxuICApIHtcbiAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgICBcIkEgZGVwdGhGYWlsQ29sb3IgcGVyLWluc3RhbmNlIGF0dHJpYnV0ZSBpcyByZXF1aXJlZCB3aGVuIHVzaW5nIGEgZGVwdGggZmFpbCBhcHBlYXJhbmNlIHRoYXQgdXNlcyBhIGNvbG9yIGF0dHJpYnV0ZS5cIlxuICAgICk7XG4gIH1cbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgdmFyIG1vZGlmaWVkVlMgPSB2ZXJ0ZXhTaGFkZXJTb3VyY2U7XG4gIG1vZGlmaWVkVlMgPSBtb2RpZmllZFZTLnJlcGxhY2UoL2F0dHJpYnV0ZVxccyt2ZWM0XFxzK2NvbG9yOy9nLCBcIlwiKTtcbiAgaWYgKCFpc0RlcHRoRmFpbCkge1xuICAgIG1vZGlmaWVkVlMgPSBtb2RpZmllZFZTLnJlcGxhY2UoXG4gICAgICAvKFxcYiljb2xvcihcXGIpL2csXG4gICAgICBcIiQxY3ptX2JhdGNoVGFibGVfY29sb3IoYmF0Y2hJZCkkMlwiXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICBtb2RpZmllZFZTID0gbW9kaWZpZWRWUy5yZXBsYWNlKFxuICAgICAgLyhcXGIpY29sb3IoXFxiKS9nLFxuICAgICAgXCIkMWN6bV9iYXRjaFRhYmxlX2RlcHRoRmFpbENvbG9yKGJhdGNoSWQpJDJcIlxuICAgICk7XG4gIH1cbiAgcmV0dXJuIG1vZGlmaWVkVlM7XG59O1xuXG5mdW5jdGlvbiBhcHBlbmRQaWNrVG9WZXJ0ZXhTaGFkZXIoc291cmNlKSB7XG4gIHZhciByZW5hbWVkVlMgPSBTaGFkZXJTb3VyY2UucmVwbGFjZU1haW4oc291cmNlLCBcImN6bV9ub25fcGlja19tYWluXCIpO1xuICB2YXIgcGlja01haW4gPVxuICAgIFwidmFyeWluZyB2ZWM0IHZfcGlja0NvbG9yOyBcXG5cIiArXG4gICAgXCJ2b2lkIG1haW4oKSBcXG5cIiArXG4gICAgXCJ7IFxcblwiICtcbiAgICBcIiAgICBjem1fbm9uX3BpY2tfbWFpbigpOyBcXG5cIiArXG4gICAgXCIgICAgdl9waWNrQ29sb3IgPSBjem1fYmF0Y2hUYWJsZV9waWNrQ29sb3IoYmF0Y2hJZCk7IFxcblwiICtcbiAgICBcIn1cIjtcblxuICByZXR1cm4gcmVuYW1lZFZTICsgXCJcXG5cIiArIHBpY2tNYWluO1xufVxuXG5mdW5jdGlvbiBhcHBlbmRQaWNrVG9GcmFnbWVudFNoYWRlcihzb3VyY2UpIHtcbiAgcmV0dXJuIFwidmFyeWluZyB2ZWM0IHZfcGlja0NvbG9yO1xcblwiICsgc291cmNlO1xufVxuXG5QcmltaXRpdmUuX3VwZGF0ZVBpY2tDb2xvckF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgdmFyIHZzUGljayA9IHNvdXJjZS5yZXBsYWNlKC9hdHRyaWJ1dGVcXHMrdmVjNFxccytwaWNrQ29sb3I7L2csIFwiXCIpO1xuICB2c1BpY2sgPSB2c1BpY2sucmVwbGFjZShcbiAgICAvKFxcYilwaWNrQ29sb3IoXFxiKS9nLFxuICAgIFwiJDFjem1fYmF0Y2hUYWJsZV9waWNrQ29sb3IoYmF0Y2hJZCkkMlwiXG4gICk7XG4gIHJldHVybiB2c1BpY2s7XG59O1xuXG5QcmltaXRpdmUuX2FwcGVuZE9mZnNldFRvU2hhZGVyID0gZnVuY3Rpb24gKHByaW1pdGl2ZSwgdmVydGV4U2hhZGVyU291cmNlKSB7XG4gIGlmICghZGVmaW5lZChwcmltaXRpdmUuX2JhdGNoVGFibGVBdHRyaWJ1dGVJbmRpY2VzLm9mZnNldCkpIHtcbiAgICByZXR1cm4gdmVydGV4U2hhZGVyU291cmNlO1xuICB9XG5cbiAgdmFyIGF0dHIgPSBcImF0dHJpYnV0ZSBmbG9hdCBiYXRjaElkO1xcblwiO1xuICBhdHRyICs9IFwiYXR0cmlidXRlIGZsb2F0IGFwcGx5T2Zmc2V0O1wiO1xuICB2YXIgbW9kaWZpZWRTaGFkZXIgPSB2ZXJ0ZXhTaGFkZXJTb3VyY2UucmVwbGFjZShcbiAgICAvYXR0cmlidXRlXFxzK2Zsb2F0XFxzK2JhdGNoSWQ7L2csXG4gICAgYXR0clxuICApO1xuXG4gIHZhciBzdHIgPSBcInZlYzQgJDEgPSBjem1fY29tcHV0ZVBvc2l0aW9uKCk7XFxuXCI7XG4gIHN0ciArPSBcIiAgICBpZiAoY3ptX3NjZW5lTW9kZSA9PSBjem1fc2NlbmVNb2RlM0QpXFxuXCI7XG4gIHN0ciArPSBcIiAgICB7XFxuXCI7XG4gIHN0ciArPVxuICAgIFwiICAgICAgICAkMSA9ICQxICsgdmVjNChjem1fYmF0Y2hUYWJsZV9vZmZzZXQoYmF0Y2hJZCkgKiBhcHBseU9mZnNldCwgMC4wKTtcIjtcbiAgc3RyICs9IFwiICAgIH1cXG5cIjtcbiAgc3RyICs9IFwiICAgIGVsc2VcXG5cIjtcbiAgc3RyICs9IFwiICAgIHtcXG5cIjtcbiAgc3RyICs9XG4gICAgXCIgICAgICAgICQxID0gJDEgKyB2ZWM0KGN6bV9iYXRjaFRhYmxlX29mZnNldDJEKGJhdGNoSWQpICogYXBwbHlPZmZzZXQsIDAuMCk7XCI7XG4gIHN0ciArPSBcIiAgICB9XFxuXCI7XG4gIG1vZGlmaWVkU2hhZGVyID0gbW9kaWZpZWRTaGFkZXIucmVwbGFjZShcbiAgICAvdmVjNFxccysoW0EtWmEtejAtOV9dKylcXHMrPVxccytjem1fY29tcHV0ZVBvc2l0aW9uXFwoXFwpOy9nLFxuICAgIHN0clxuICApO1xuICByZXR1cm4gbW9kaWZpZWRTaGFkZXI7XG59O1xuXG5QcmltaXRpdmUuX2FwcGVuZERpc3RhbmNlRGlzcGxheUNvbmRpdGlvblRvU2hhZGVyID0gZnVuY3Rpb24gKFxuICBwcmltaXRpdmUsXG4gIHZlcnRleFNoYWRlclNvdXJjZSxcbiAgc2NlbmUzRE9ubHlcbikge1xuICBpZiAoXG4gICAgIWRlZmluZWQocHJpbWl0aXZlLl9iYXRjaFRhYmxlQXR0cmlidXRlSW5kaWNlcy5kaXN0YW5jZURpc3BsYXlDb25kaXRpb24pXG4gICkge1xuICAgIHJldHVybiB2ZXJ0ZXhTaGFkZXJTb3VyY2U7XG4gIH1cblxuICB2YXIgcmVuYW1lZFZTID0gU2hhZGVyU291cmNlLnJlcGxhY2VNYWluKFxuICAgIHZlcnRleFNoYWRlclNvdXJjZSxcbiAgICBcImN6bV9ub25fZGlzdGFuY2VEaXNwbGF5Q29uZGl0aW9uX21haW5cIlxuICApO1xuICB2YXIgZGlzdGFuY2VEaXNwbGF5Q29uZGl0aW9uTWFpbiA9XG4gICAgXCJ2b2lkIG1haW4oKSBcXG5cIiArXG4gICAgXCJ7IFxcblwiICtcbiAgICBcIiAgICBjem1fbm9uX2Rpc3RhbmNlRGlzcGxheUNvbmRpdGlvbl9tYWluKCk7IFxcblwiICtcbiAgICBcIiAgICB2ZWMyIGRpc3RhbmNlRGlzcGxheUNvbmRpdGlvbiA9IGN6bV9iYXRjaFRhYmxlX2Rpc3RhbmNlRGlzcGxheUNvbmRpdGlvbihiYXRjaElkKTtcXG5cIiArXG4gICAgXCIgICAgdmVjMyBib3VuZGluZ1NwaGVyZUNlbnRlcjNESGlnaCA9IGN6bV9iYXRjaFRhYmxlX2JvdW5kaW5nU3BoZXJlQ2VudGVyM0RIaWdoKGJhdGNoSWQpO1xcblwiICtcbiAgICBcIiAgICB2ZWMzIGJvdW5kaW5nU3BoZXJlQ2VudGVyM0RMb3cgPSBjem1fYmF0Y2hUYWJsZV9ib3VuZGluZ1NwaGVyZUNlbnRlcjNETG93KGJhdGNoSWQpO1xcblwiICtcbiAgICBcIiAgICBmbG9hdCBib3VuZGluZ1NwaGVyZVJhZGl1cyA9IGN6bV9iYXRjaFRhYmxlX2JvdW5kaW5nU3BoZXJlUmFkaXVzKGJhdGNoSWQpO1xcblwiO1xuXG4gIGlmICghc2NlbmUzRE9ubHkpIHtcbiAgICBkaXN0YW5jZURpc3BsYXlDb25kaXRpb25NYWluICs9XG4gICAgICBcIiAgICB2ZWMzIGJvdW5kaW5nU3BoZXJlQ2VudGVyMkRIaWdoID0gY3ptX2JhdGNoVGFibGVfYm91bmRpbmdTcGhlcmVDZW50ZXIyREhpZ2goYmF0Y2hJZCk7XFxuXCIgK1xuICAgICAgXCIgICAgdmVjMyBib3VuZGluZ1NwaGVyZUNlbnRlcjJETG93ID0gY3ptX2JhdGNoVGFibGVfYm91bmRpbmdTcGhlcmVDZW50ZXIyRExvdyhiYXRjaElkKTtcXG5cIiArXG4gICAgICBcIiAgICB2ZWM0IGNlbnRlclJURTtcXG5cIiArXG4gICAgICBcIiAgICBpZiAoY3ptX21vcnBoVGltZSA9PSAxLjApXFxuXCIgK1xuICAgICAgXCIgICAge1xcblwiICtcbiAgICAgIFwiICAgICAgICBjZW50ZXJSVEUgPSBjem1fdHJhbnNsYXRlUmVsYXRpdmVUb0V5ZShib3VuZGluZ1NwaGVyZUNlbnRlcjNESGlnaCwgYm91bmRpbmdTcGhlcmVDZW50ZXIzRExvdyk7XFxuXCIgK1xuICAgICAgXCIgICAgfVxcblwiICtcbiAgICAgIFwiICAgIGVsc2UgaWYgKGN6bV9tb3JwaFRpbWUgPT0gMC4wKVxcblwiICtcbiAgICAgIFwiICAgIHtcXG5cIiArXG4gICAgICBcIiAgICAgICAgY2VudGVyUlRFID0gY3ptX3RyYW5zbGF0ZVJlbGF0aXZlVG9FeWUoYm91bmRpbmdTcGhlcmVDZW50ZXIyREhpZ2guenh5LCBib3VuZGluZ1NwaGVyZUNlbnRlcjJETG93Lnp4eSk7XFxuXCIgK1xuICAgICAgXCIgICAgfVxcblwiICtcbiAgICAgIFwiICAgIGVsc2VcXG5cIiArXG4gICAgICBcIiAgICB7XFxuXCIgK1xuICAgICAgXCIgICAgICAgIGNlbnRlclJURSA9IGN6bV9jb2x1bWJ1c1ZpZXdNb3JwaChcXG5cIiArXG4gICAgICBcIiAgICAgICAgICAgICAgICBjem1fdHJhbnNsYXRlUmVsYXRpdmVUb0V5ZShib3VuZGluZ1NwaGVyZUNlbnRlcjJESGlnaC56eHksIGJvdW5kaW5nU3BoZXJlQ2VudGVyMkRMb3cuenh5KSxcXG5cIiArXG4gICAgICBcIiAgICAgICAgICAgICAgICBjem1fdHJhbnNsYXRlUmVsYXRpdmVUb0V5ZShib3VuZGluZ1NwaGVyZUNlbnRlcjNESGlnaCwgYm91bmRpbmdTcGhlcmVDZW50ZXIzRExvdyksXFxuXCIgK1xuICAgICAgXCIgICAgICAgICAgICAgICAgY3ptX21vcnBoVGltZSk7XFxuXCIgK1xuICAgICAgXCIgICAgfVxcblwiO1xuICB9IGVsc2Uge1xuICAgIGRpc3RhbmNlRGlzcGxheUNvbmRpdGlvbk1haW4gKz1cbiAgICAgIFwiICAgIHZlYzQgY2VudGVyUlRFID0gY3ptX3RyYW5zbGF0ZVJlbGF0aXZlVG9FeWUoYm91bmRpbmdTcGhlcmVDZW50ZXIzREhpZ2gsIGJvdW5kaW5nU3BoZXJlQ2VudGVyM0RMb3cpO1xcblwiO1xuICB9XG5cbiAgZGlzdGFuY2VEaXNwbGF5Q29uZGl0aW9uTWFpbiArPVxuICAgIFwiICAgIGZsb2F0IHJhZGl1c1NxID0gYm91bmRpbmdTcGhlcmVSYWRpdXMgKiBib3VuZGluZ1NwaGVyZVJhZGl1czsgXFxuXCIgK1xuICAgIFwiICAgIGZsb2F0IGRpc3RhbmNlU3E7IFxcblwiICtcbiAgICBcIiAgICBpZiAoY3ptX3NjZW5lTW9kZSA9PSBjem1fc2NlbmVNb2RlMkQpIFxcblwiICtcbiAgICBcIiAgICB7IFxcblwiICtcbiAgICBcIiAgICAgICAgZGlzdGFuY2VTcSA9IGN6bV9leWVIZWlnaHQyRC55IC0gcmFkaXVzU3E7IFxcblwiICtcbiAgICBcIiAgICB9IFxcblwiICtcbiAgICBcIiAgICBlbHNlIFxcblwiICtcbiAgICBcIiAgICB7IFxcblwiICtcbiAgICBcIiAgICAgICAgZGlzdGFuY2VTcSA9IGRvdChjZW50ZXJSVEUueHl6LCBjZW50ZXJSVEUueHl6KSAtIHJhZGl1c1NxOyBcXG5cIiArXG4gICAgXCIgICAgfSBcXG5cIiArXG4gICAgXCIgICAgZGlzdGFuY2VTcSA9IG1heChkaXN0YW5jZVNxLCAwLjApOyBcXG5cIiArXG4gICAgXCIgICAgZmxvYXQgbmVhclNxID0gZGlzdGFuY2VEaXNwbGF5Q29uZGl0aW9uLnggKiBkaXN0YW5jZURpc3BsYXlDb25kaXRpb24ueDsgXFxuXCIgK1xuICAgIFwiICAgIGZsb2F0IGZhclNxID0gZGlzdGFuY2VEaXNwbGF5Q29uZGl0aW9uLnkgKiBkaXN0YW5jZURpc3BsYXlDb25kaXRpb24ueTsgXFxuXCIgK1xuICAgIFwiICAgIGZsb2F0IHNob3cgPSAoZGlzdGFuY2VTcSA+PSBuZWFyU3EgJiYgZGlzdGFuY2VTcSA8PSBmYXJTcSkgPyAxLjAgOiAwLjA7IFxcblwiICtcbiAgICBcIiAgICBnbF9Qb3NpdGlvbiAqPSBzaG93OyBcXG5cIiArXG4gICAgXCJ9XCI7XG4gIHJldHVybiByZW5hbWVkVlMgKyBcIlxcblwiICsgZGlzdGFuY2VEaXNwbGF5Q29uZGl0aW9uTWFpbjtcbn07XG5cbmZ1bmN0aW9uIG1vZGlmeUZvckVuY29kZWROb3JtYWxzKHByaW1pdGl2ZSwgdmVydGV4U2hhZGVyU291cmNlKSB7XG4gIGlmICghcHJpbWl0aXZlLmNvbXByZXNzVmVydGljZXMpIHtcbiAgICByZXR1cm4gdmVydGV4U2hhZGVyU291cmNlO1xuICB9XG5cbiAgdmFyIGNvbnRhaW5zTm9ybWFsID1cbiAgICB2ZXJ0ZXhTaGFkZXJTb3VyY2Uuc2VhcmNoKC9hdHRyaWJ1dGVcXHMrdmVjM1xccytub3JtYWw7L2cpICE9PSAtMTtcbiAgdmFyIGNvbnRhaW5zU3QgPSB2ZXJ0ZXhTaGFkZXJTb3VyY2Uuc2VhcmNoKC9hdHRyaWJ1dGVcXHMrdmVjMlxccytzdDsvZykgIT09IC0xO1xuICBpZiAoIWNvbnRhaW5zTm9ybWFsICYmICFjb250YWluc1N0KSB7XG4gICAgcmV0dXJuIHZlcnRleFNoYWRlclNvdXJjZTtcbiAgfVxuXG4gIHZhciBjb250YWluc1RhbmdlbnQgPVxuICAgIHZlcnRleFNoYWRlclNvdXJjZS5zZWFyY2goL2F0dHJpYnV0ZVxccyt2ZWMzXFxzK3RhbmdlbnQ7L2cpICE9PSAtMTtcbiAgdmFyIGNvbnRhaW5zQml0YW5nZW50ID1cbiAgICB2ZXJ0ZXhTaGFkZXJTb3VyY2Uuc2VhcmNoKC9hdHRyaWJ1dGVcXHMrdmVjM1xccytiaXRhbmdlbnQ7L2cpICE9PSAtMTtcblxuICB2YXIgbnVtQ29tcG9uZW50cyA9IGNvbnRhaW5zU3QgJiYgY29udGFpbnNOb3JtYWwgPyAyLjAgOiAxLjA7XG4gIG51bUNvbXBvbmVudHMgKz0gY29udGFpbnNUYW5nZW50IHx8IGNvbnRhaW5zQml0YW5nZW50ID8gMSA6IDA7XG5cbiAgdmFyIHR5cGUgPSBudW1Db21wb25lbnRzID4gMSA/IFwidmVjXCIgKyBudW1Db21wb25lbnRzIDogXCJmbG9hdFwiO1xuXG4gIHZhciBhdHRyaWJ1dGVOYW1lID0gXCJjb21wcmVzc2VkQXR0cmlidXRlc1wiO1xuICB2YXIgYXR0cmlidXRlRGVjbCA9IFwiYXR0cmlidXRlIFwiICsgdHlwZSArIFwiIFwiICsgYXR0cmlidXRlTmFtZSArIFwiO1wiO1xuXG4gIHZhciBnbG9iYWxEZWNsID0gXCJcIjtcbiAgdmFyIGRlY29kZSA9IFwiXCI7XG5cbiAgaWYgKGNvbnRhaW5zU3QpIHtcbiAgICBnbG9iYWxEZWNsICs9IFwidmVjMiBzdDtcXG5cIjtcbiAgICB2YXIgc3RDb21wb25lbnQgPSBudW1Db21wb25lbnRzID4gMSA/IGF0dHJpYnV0ZU5hbWUgKyBcIi54XCIgOiBhdHRyaWJ1dGVOYW1lO1xuICAgIGRlY29kZSArPVxuICAgICAgXCIgICAgc3QgPSBjem1fZGVjb21wcmVzc1RleHR1cmVDb29yZGluYXRlcyhcIiArIHN0Q29tcG9uZW50ICsgXCIpO1xcblwiO1xuICB9XG5cbiAgaWYgKGNvbnRhaW5zTm9ybWFsICYmIGNvbnRhaW5zVGFuZ2VudCAmJiBjb250YWluc0JpdGFuZ2VudCkge1xuICAgIGdsb2JhbERlY2wgKz0gXCJ2ZWMzIG5vcm1hbDtcXG5cIiArIFwidmVjMyB0YW5nZW50O1xcblwiICsgXCJ2ZWMzIGJpdGFuZ2VudDtcXG5cIjtcbiAgICBkZWNvZGUgKz1cbiAgICAgIFwiICAgIGN6bV9vY3REZWNvZGUoXCIgK1xuICAgICAgYXR0cmlidXRlTmFtZSArXG4gICAgICBcIi5cIiArXG4gICAgICAoY29udGFpbnNTdCA/IFwieXpcIiA6IFwieHlcIikgK1xuICAgICAgXCIsIG5vcm1hbCwgdGFuZ2VudCwgYml0YW5nZW50KTtcXG5cIjtcbiAgfSBlbHNlIHtcbiAgICBpZiAoY29udGFpbnNOb3JtYWwpIHtcbiAgICAgIGdsb2JhbERlY2wgKz0gXCJ2ZWMzIG5vcm1hbDtcXG5cIjtcbiAgICAgIGRlY29kZSArPVxuICAgICAgICBcIiAgICBub3JtYWwgPSBjem1fb2N0RGVjb2RlKFwiICtcbiAgICAgICAgYXR0cmlidXRlTmFtZSArXG4gICAgICAgIChudW1Db21wb25lbnRzID4gMSA/IFwiLlwiICsgKGNvbnRhaW5zU3QgPyBcInlcIiA6IFwieFwiKSA6IFwiXCIpICtcbiAgICAgICAgXCIpO1xcblwiO1xuICAgIH1cblxuICAgIGlmIChjb250YWluc1RhbmdlbnQpIHtcbiAgICAgIGdsb2JhbERlY2wgKz0gXCJ2ZWMzIHRhbmdlbnQ7XFxuXCI7XG4gICAgICBkZWNvZGUgKz1cbiAgICAgICAgXCIgICAgdGFuZ2VudCA9IGN6bV9vY3REZWNvZGUoXCIgK1xuICAgICAgICBhdHRyaWJ1dGVOYW1lICtcbiAgICAgICAgXCIuXCIgK1xuICAgICAgICAoY29udGFpbnNTdCAmJiBjb250YWluc05vcm1hbCA/IFwielwiIDogXCJ5XCIpICtcbiAgICAgICAgXCIpO1xcblwiO1xuICAgIH1cblxuICAgIGlmIChjb250YWluc0JpdGFuZ2VudCkge1xuICAgICAgZ2xvYmFsRGVjbCArPSBcInZlYzMgYml0YW5nZW50O1xcblwiO1xuICAgICAgZGVjb2RlICs9XG4gICAgICAgIFwiICAgIGJpdGFuZ2VudCA9IGN6bV9vY3REZWNvZGUoXCIgK1xuICAgICAgICBhdHRyaWJ1dGVOYW1lICtcbiAgICAgICAgXCIuXCIgK1xuICAgICAgICAoY29udGFpbnNTdCAmJiBjb250YWluc05vcm1hbCA/IFwielwiIDogXCJ5XCIpICtcbiAgICAgICAgXCIpO1xcblwiO1xuICAgIH1cbiAgfVxuXG4gIHZhciBtb2RpZmllZFZTID0gdmVydGV4U2hhZGVyU291cmNlO1xuICBtb2RpZmllZFZTID0gbW9kaWZpZWRWUy5yZXBsYWNlKC9hdHRyaWJ1dGVcXHMrdmVjM1xccytub3JtYWw7L2csIFwiXCIpO1xuICBtb2RpZmllZFZTID0gbW9kaWZpZWRWUy5yZXBsYWNlKC9hdHRyaWJ1dGVcXHMrdmVjMlxccytzdDsvZywgXCJcIik7XG4gIG1vZGlmaWVkVlMgPSBtb2RpZmllZFZTLnJlcGxhY2UoL2F0dHJpYnV0ZVxccyt2ZWMzXFxzK3RhbmdlbnQ7L2csIFwiXCIpO1xuICBtb2RpZmllZFZTID0gbW9kaWZpZWRWUy5yZXBsYWNlKC9hdHRyaWJ1dGVcXHMrdmVjM1xccytiaXRhbmdlbnQ7L2csIFwiXCIpO1xuICBtb2RpZmllZFZTID0gU2hhZGVyU291cmNlLnJlcGxhY2VNYWluKG1vZGlmaWVkVlMsIFwiY3ptX25vbl9jb21wcmVzc2VkX21haW5cIik7XG4gIHZhciBjb21wcmVzc2VkTWFpbiA9XG4gICAgXCJ2b2lkIG1haW4oKSBcXG5cIiArXG4gICAgXCJ7IFxcblwiICtcbiAgICBkZWNvZGUgK1xuICAgIFwiICAgIGN6bV9ub25fY29tcHJlc3NlZF9tYWluKCk7IFxcblwiICtcbiAgICBcIn1cIjtcblxuICByZXR1cm4gW2F0dHJpYnV0ZURlY2wsIGdsb2JhbERlY2wsIG1vZGlmaWVkVlMsIGNvbXByZXNzZWRNYWluXS5qb2luKFwiXFxuXCIpO1xufVxuXG5mdW5jdGlvbiBkZXB0aENsYW1wVlModmVydGV4U2hhZGVyU291cmNlKSB7XG4gIHZhciBtb2RpZmllZFZTID0gU2hhZGVyU291cmNlLnJlcGxhY2VNYWluKFxuICAgIHZlcnRleFNoYWRlclNvdXJjZSxcbiAgICBcImN6bV9ub25fZGVwdGhfY2xhbXBfbWFpblwiXG4gICk7XG4gIG1vZGlmaWVkVlMgKz1cbiAgICBcInZvaWQgbWFpbigpIHtcXG5cIiArXG4gICAgXCIgICAgY3ptX25vbl9kZXB0aF9jbGFtcF9tYWluKCk7XFxuXCIgK1xuICAgIFwiICAgIGdsX1Bvc2l0aW9uID0gY3ptX2RlcHRoQ2xhbXAoZ2xfUG9zaXRpb24pO1wiICtcbiAgICBcIn1cXG5cIjtcbiAgcmV0dXJuIG1vZGlmaWVkVlM7XG59XG5cbmZ1bmN0aW9uIGRlcHRoQ2xhbXBGUyhmcmFnbWVudFNoYWRlclNvdXJjZSkge1xuICB2YXIgbW9kaWZpZWRGUyA9IFNoYWRlclNvdXJjZS5yZXBsYWNlTWFpbihcbiAgICBmcmFnbWVudFNoYWRlclNvdXJjZSxcbiAgICBcImN6bV9ub25fZGVwdGhfY2xhbXBfbWFpblwiXG4gICk7XG4gIG1vZGlmaWVkRlMgKz1cbiAgICBcInZvaWQgbWFpbigpIHtcXG5cIiArXG4gICAgXCIgICAgY3ptX25vbl9kZXB0aF9jbGFtcF9tYWluKCk7XFxuXCIgK1xuICAgIFwiI2lmIGRlZmluZWQoR0xfRVhUX2ZyYWdfZGVwdGgpXFxuXCIgK1xuICAgIFwiICAgICNpZiBkZWZpbmVkKExPR19ERVBUSClcXG5cIiArXG4gICAgXCIgICAgICAgIGN6bV93cml0ZUxvZ0RlcHRoKCk7XFxuXCIgK1xuICAgIFwiICAgICNlbHNlXFxuXCIgK1xuICAgIFwiICAgICAgICBjem1fd3JpdGVEZXB0aENsYW1wKCk7XFxuXCIgK1xuICAgIFwiICAgICNlbmRpZlxcblwiICtcbiAgICBcIiNlbmRpZlxcblwiICtcbiAgICBcIn1cXG5cIjtcbiAgbW9kaWZpZWRGUyA9XG4gICAgXCIjaWZkZWYgR0xfRVhUX2ZyYWdfZGVwdGhcXG5cIiArXG4gICAgXCIjZXh0ZW5zaW9uIEdMX0VYVF9mcmFnX2RlcHRoIDogZW5hYmxlXFxuXCIgK1xuICAgIFwiI2VuZGlmXFxuXCIgK1xuICAgIG1vZGlmaWVkRlM7XG4gIHJldHVybiBtb2RpZmllZEZTO1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZVNoYWRlck1hdGNoaW5nKHNoYWRlclByb2dyYW0sIGF0dHJpYnV0ZUxvY2F0aW9ucykge1xuICAvLyBGb3IgYSBWQU8gYW5kIHNoYWRlciBwcm9ncmFtIHRvIGJlIGNvbXBhdGlibGUsIHRoZSBWQU8gbXVzdCBoYXZlXG4gIC8vIGFsbCBhY3RpdmUgYXR0cmlidXRlIGluIHRoZSBzaGFkZXIgcHJvZ3JhbS4gIFRoZSBWQU8gbWF5IGhhdmVcbiAgLy8gZXh0cmEgYXR0cmlidXRlcyB3aXRoIHRoZSBvbmx5IGNvbmNlcm4gYmVpbmcgYSBwb3RlbnRpYWxcbiAgLy8gcGVyZm9ybWFuY2UgaGl0IGR1ZSB0byBleHRyYSBtZW1vcnkgYmFuZHdpZHRoIGFuZCBjYWNoZSBwb2xsdXRpb24uXG4gIC8vIFRoZSBzaGFkZXIgc291cmNlIGNvdWxkIGhhdmUgZXh0cmEgYXR0cmlidXRlcyB0aGF0IGFyZSBub3QgdXNlZCxcbiAgLy8gYnV0IHRoZXJlIGlzIG5vIGd1YXJhbnRlZSB0aGV5IHdpbGwgYmUgb3B0aW1pemVkIG91dC5cbiAgLy9cbiAgLy8gSGVyZSwgd2UgdmFsaWRhdGUgdGhhdCB0aGUgVkFPIGhhcyBhbGwgYXR0cmlidXRlcyByZXF1aXJlZFxuICAvLyB0byBtYXRjaCB0aGUgc2hhZGVyIHByb2dyYW0uXG4gIHZhciBzaGFkZXJBdHRyaWJ1dGVzID0gc2hhZGVyUHJvZ3JhbS52ZXJ0ZXhBdHRyaWJ1dGVzO1xuXG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIGZvciAodmFyIG5hbWUgaW4gc2hhZGVyQXR0cmlidXRlcykge1xuICAgIGlmIChzaGFkZXJBdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICBpZiAoIWRlZmluZWQoYXR0cmlidXRlTG9jYXRpb25zW25hbWVdKSkge1xuICAgICAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgICAgICAgXCJBcHBlYXJhbmNlL0dlb21ldHJ5IG1pc21hdGNoLiAgVGhlIGFwcGVhcmFuY2UgcmVxdWlyZXMgdmVydGV4IHNoYWRlciBhdHRyaWJ1dGUgaW5wdXQgJ1wiICtcbiAgICAgICAgICAgIG5hbWUgK1xuICAgICAgICAgICAgXCInLCB3aGljaCB3YXMgbm90IGNvbXB1dGVkIGFzIHBhcnQgb2YgdGhlIEdlb21ldHJ5LiAgVXNlIHRoZSBhcHBlYXJhbmNlJ3MgdmVydGV4Rm9ybWF0IHByb3BlcnR5IHdoZW4gY29uc3RydWN0aW5nIHRoZSBnZW9tZXRyeS5cIlxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcbn1cblxuZnVuY3Rpb24gZ2V0VW5pZm9ybUZ1bmN0aW9uKHVuaWZvcm1zLCBuYW1lKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHVuaWZvcm1zW25hbWVdO1xuICB9O1xufVxuXG52YXIgbnVtYmVyT2ZDcmVhdGlvbldvcmtlcnMgPSBNYXRoLm1heChcbiAgRmVhdHVyZURldGVjdGlvbi5oYXJkd2FyZUNvbmN1cnJlbmN5IC0gMSxcbiAgMVxuKTtcbnZhciBjcmVhdGVHZW9tZXRyeVRhc2tQcm9jZXNzb3JzO1xudmFyIGNvbWJpbmVHZW9tZXRyeVRhc2tQcm9jZXNzb3IgPSBuZXcgVGFza1Byb2Nlc3NvcihcImNvbWJpbmVHZW9tZXRyeVwiKTtcblxuZnVuY3Rpb24gbG9hZEFzeW5jaHJvbm91cyhwcmltaXRpdmUsIGZyYW1lU3RhdGUpIHtcbiAgdmFyIGluc3RhbmNlcztcbiAgdmFyIGdlb21ldHJ5O1xuICB2YXIgaTtcbiAgdmFyIGo7XG5cbiAgdmFyIGluc3RhbmNlSWRzID0gcHJpbWl0aXZlLl9pbnN0YW5jZUlkcztcblxuICBpZiAocHJpbWl0aXZlLl9zdGF0ZSA9PT0gUHJpbWl0aXZlU3RhdGUuUkVBRFkpIHtcbiAgICBpbnN0YW5jZXMgPSBBcnJheS5pc0FycmF5KHByaW1pdGl2ZS5nZW9tZXRyeUluc3RhbmNlcylcbiAgICAgID8gcHJpbWl0aXZlLmdlb21ldHJ5SW5zdGFuY2VzXG4gICAgICA6IFtwcmltaXRpdmUuZ2VvbWV0cnlJbnN0YW5jZXNdO1xuICAgIHZhciBsZW5ndGggPSAocHJpbWl0aXZlLl9udW1iZXJPZkluc3RhbmNlcyA9IGluc3RhbmNlcy5sZW5ndGgpO1xuXG4gICAgdmFyIHByb21pc2VzID0gW107XG4gICAgdmFyIHN1YlRhc2tzID0gW107XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgICBnZW9tZXRyeSA9IGluc3RhbmNlc1tpXS5nZW9tZXRyeTtcbiAgICAgIGluc3RhbmNlSWRzLnB1c2goaW5zdGFuY2VzW2ldLmlkKTtcblxuICAgICAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgICAgIGlmICghZGVmaW5lZChnZW9tZXRyeS5fd29ya2VyTmFtZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFxuICAgICAgICAgIFwiX3dvcmtlck5hbWUgbXVzdCBiZSBkZWZpbmVkIGZvciBhc3luY2hyb25vdXMgZ2VvbWV0cnkuXCJcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gICAgICBzdWJUYXNrcy5wdXNoKHtcbiAgICAgICAgbW9kdWxlTmFtZTogZ2VvbWV0cnkuX3dvcmtlck5hbWUsXG4gICAgICAgIGdlb21ldHJ5OiBnZW9tZXRyeSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICghZGVmaW5lZChjcmVhdGVHZW9tZXRyeVRhc2tQcm9jZXNzb3JzKSkge1xuICAgICAgY3JlYXRlR2VvbWV0cnlUYXNrUHJvY2Vzc29ycyA9IG5ldyBBcnJheShudW1iZXJPZkNyZWF0aW9uV29ya2Vycyk7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtYmVyT2ZDcmVhdGlvbldvcmtlcnM7IGkrKykge1xuICAgICAgICBjcmVhdGVHZW9tZXRyeVRhc2tQcm9jZXNzb3JzW2ldID0gbmV3IFRhc2tQcm9jZXNzb3IoXCJjcmVhdGVHZW9tZXRyeVwiKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgc3ViVGFzaztcbiAgICBzdWJUYXNrcyA9IHN1YmRpdmlkZUFycmF5KHN1YlRhc2tzLCBudW1iZXJPZkNyZWF0aW9uV29ya2Vycyk7XG5cbiAgICBmb3IgKGkgPSAwOyBpIDwgc3ViVGFza3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBwYWNrZWRMZW5ndGggPSAwO1xuICAgICAgdmFyIHdvcmtlclN1YlRhc2tzID0gc3ViVGFza3NbaV07XG4gICAgICB2YXIgd29ya2VyU3ViVGFza3NMZW5ndGggPSB3b3JrZXJTdWJUYXNrcy5sZW5ndGg7XG4gICAgICBmb3IgKGogPSAwOyBqIDwgd29ya2VyU3ViVGFza3NMZW5ndGg7ICsraikge1xuICAgICAgICBzdWJUYXNrID0gd29ya2VyU3ViVGFza3Nbal07XG4gICAgICAgIGdlb21ldHJ5ID0gc3ViVGFzay5nZW9tZXRyeTtcbiAgICAgICAgaWYgKGRlZmluZWQoZ2VvbWV0cnkuY29uc3RydWN0b3IucGFjaykpIHtcbiAgICAgICAgICBzdWJUYXNrLm9mZnNldCA9IHBhY2tlZExlbmd0aDtcbiAgICAgICAgICBwYWNrZWRMZW5ndGggKz0gZGVmYXVsdFZhbHVlKFxuICAgICAgICAgICAgZ2VvbWV0cnkuY29uc3RydWN0b3IucGFja2VkTGVuZ3RoLFxuICAgICAgICAgICAgZ2VvbWV0cnkucGFja2VkTGVuZ3RoXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB2YXIgc3ViVGFza1RyYW5zZmVyYWJsZU9iamVjdHM7XG5cbiAgICAgIGlmIChwYWNrZWRMZW5ndGggPiAwKSB7XG4gICAgICAgIHZhciBhcnJheSA9IG5ldyBGbG9hdDY0QXJyYXkocGFja2VkTGVuZ3RoKTtcbiAgICAgICAgc3ViVGFza1RyYW5zZmVyYWJsZU9iamVjdHMgPSBbYXJyYXkuYnVmZmVyXTtcblxuICAgICAgICBmb3IgKGogPSAwOyBqIDwgd29ya2VyU3ViVGFza3NMZW5ndGg7ICsraikge1xuICAgICAgICAgIHN1YlRhc2sgPSB3b3JrZXJTdWJUYXNrc1tqXTtcbiAgICAgICAgICBnZW9tZXRyeSA9IHN1YlRhc2suZ2VvbWV0cnk7XG4gICAgICAgICAgaWYgKGRlZmluZWQoZ2VvbWV0cnkuY29uc3RydWN0b3IucGFjaykpIHtcbiAgICAgICAgICAgIGdlb21ldHJ5LmNvbnN0cnVjdG9yLnBhY2soZ2VvbWV0cnksIGFycmF5LCBzdWJUYXNrLm9mZnNldCk7XG4gICAgICAgICAgICBzdWJUYXNrLmdlb21ldHJ5ID0gYXJyYXk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHByb21pc2VzLnB1c2goXG4gICAgICAgIGNyZWF0ZUdlb21ldHJ5VGFza1Byb2Nlc3NvcnNbaV0uc2NoZWR1bGVUYXNrKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHN1YlRhc2tzOiBzdWJUYXNrc1tpXSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHN1YlRhc2tUcmFuc2ZlcmFibGVPYmplY3RzXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcHJpbWl0aXZlLl9zdGF0ZSA9IFByaW1pdGl2ZVN0YXRlLkNSRUFUSU5HO1xuXG4gICAgd2hlblxuICAgICAgLmFsbChwcm9taXNlcywgZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgcHJpbWl0aXZlLl9jcmVhdGVHZW9tZXRyeVJlc3VsdHMgPSByZXN1bHRzO1xuICAgICAgICBwcmltaXRpdmUuX3N0YXRlID0gUHJpbWl0aXZlU3RhdGUuQ1JFQVRFRDtcbiAgICAgIH0pXG4gICAgICAub3RoZXJ3aXNlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICBzZXRSZWFkeShwcmltaXRpdmUsIGZyYW1lU3RhdGUsIFByaW1pdGl2ZVN0YXRlLkZBSUxFRCwgZXJyb3IpO1xuICAgICAgfSk7XG4gIH0gZWxzZSBpZiAocHJpbWl0aXZlLl9zdGF0ZSA9PT0gUHJpbWl0aXZlU3RhdGUuQ1JFQVRFRCkge1xuICAgIHZhciB0cmFuc2ZlcmFibGVPYmplY3RzID0gW107XG4gICAgaW5zdGFuY2VzID0gQXJyYXkuaXNBcnJheShwcmltaXRpdmUuZ2VvbWV0cnlJbnN0YW5jZXMpXG4gICAgICA/IHByaW1pdGl2ZS5nZW9tZXRyeUluc3RhbmNlc1xuICAgICAgOiBbcHJpbWl0aXZlLmdlb21ldHJ5SW5zdGFuY2VzXTtcblxuICAgIHZhciBzY2VuZTNET25seSA9IGZyYW1lU3RhdGUuc2NlbmUzRE9ubHk7XG4gICAgdmFyIHByb2plY3Rpb24gPSBmcmFtZVN0YXRlLm1hcFByb2plY3Rpb247XG5cbiAgICB2YXIgcHJvbWlzZSA9IGNvbWJpbmVHZW9tZXRyeVRhc2tQcm9jZXNzb3Iuc2NoZWR1bGVUYXNrKFxuICAgICAgUHJpbWl0aXZlUGlwZWxpbmUucGFja0NvbWJpbmVHZW9tZXRyeVBhcmFtZXRlcnMoXG4gICAgICAgIHtcbiAgICAgICAgICBjcmVhdGVHZW9tZXRyeVJlc3VsdHM6IHByaW1pdGl2ZS5fY3JlYXRlR2VvbWV0cnlSZXN1bHRzLFxuICAgICAgICAgIGluc3RhbmNlczogaW5zdGFuY2VzLFxuICAgICAgICAgIGVsbGlwc29pZDogcHJvamVjdGlvbi5lbGxpcHNvaWQsXG4gICAgICAgICAgcHJvamVjdGlvbjogcHJvamVjdGlvbixcbiAgICAgICAgICBlbGVtZW50SW5kZXhVaW50U3VwcG9ydGVkOiBmcmFtZVN0YXRlLmNvbnRleHQuZWxlbWVudEluZGV4VWludCxcbiAgICAgICAgICBzY2VuZTNET25seTogc2NlbmUzRE9ubHksXG4gICAgICAgICAgdmVydGV4Q2FjaGVPcHRpbWl6ZTogcHJpbWl0aXZlLnZlcnRleENhY2hlT3B0aW1pemUsXG4gICAgICAgICAgY29tcHJlc3NWZXJ0aWNlczogcHJpbWl0aXZlLmNvbXByZXNzVmVydGljZXMsXG4gICAgICAgICAgbW9kZWxNYXRyaXg6IHByaW1pdGl2ZS5tb2RlbE1hdHJpeCxcbiAgICAgICAgICBjcmVhdGVQaWNrT2Zmc2V0czogcHJpbWl0aXZlLl9jcmVhdGVQaWNrT2Zmc2V0cyxcbiAgICAgICAgfSxcbiAgICAgICAgdHJhbnNmZXJhYmxlT2JqZWN0c1xuICAgICAgKSxcbiAgICAgIHRyYW5zZmVyYWJsZU9iamVjdHNcbiAgICApO1xuXG4gICAgcHJpbWl0aXZlLl9jcmVhdGVHZW9tZXRyeVJlc3VsdHMgPSB1bmRlZmluZWQ7XG4gICAgcHJpbWl0aXZlLl9zdGF0ZSA9IFByaW1pdGl2ZVN0YXRlLkNPTUJJTklORztcblxuICAgIHdoZW4ocHJvbWlzZSwgZnVuY3Rpb24gKHBhY2tlZFJlc3VsdCkge1xuICAgICAgdmFyIHJlc3VsdCA9IFByaW1pdGl2ZVBpcGVsaW5lLnVucGFja0NvbWJpbmVHZW9tZXRyeVJlc3VsdHMocGFja2VkUmVzdWx0KTtcbiAgICAgIHByaW1pdGl2ZS5fZ2VvbWV0cmllcyA9IHJlc3VsdC5nZW9tZXRyaWVzO1xuICAgICAgcHJpbWl0aXZlLl9hdHRyaWJ1dGVMb2NhdGlvbnMgPSByZXN1bHQuYXR0cmlidXRlTG9jYXRpb25zO1xuICAgICAgcHJpbWl0aXZlLm1vZGVsTWF0cml4ID0gTWF0cml4NC5jbG9uZShcbiAgICAgICAgcmVzdWx0Lm1vZGVsTWF0cml4LFxuICAgICAgICBwcmltaXRpdmUubW9kZWxNYXRyaXhcbiAgICAgICk7XG4gICAgICBwcmltaXRpdmUuX3BpY2tPZmZzZXRzID0gcmVzdWx0LnBpY2tPZmZzZXRzO1xuICAgICAgcHJpbWl0aXZlLl9vZmZzZXRJbnN0YW5jZUV4dGVuZCA9IHJlc3VsdC5vZmZzZXRJbnN0YW5jZUV4dGVuZDtcbiAgICAgIHByaW1pdGl2ZS5faW5zdGFuY2VCb3VuZGluZ1NwaGVyZXMgPSByZXN1bHQuYm91bmRpbmdTcGhlcmVzO1xuICAgICAgcHJpbWl0aXZlLl9pbnN0YW5jZUJvdW5kaW5nU3BoZXJlc0NWID0gcmVzdWx0LmJvdW5kaW5nU3BoZXJlc0NWO1xuXG4gICAgICBpZiAoZGVmaW5lZChwcmltaXRpdmUuX2dlb21ldHJpZXMpICYmIHByaW1pdGl2ZS5fZ2VvbWV0cmllcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHByaW1pdGl2ZS5fcmVjb21wdXRlQm91bmRpbmdTcGhlcmVzID0gdHJ1ZTtcbiAgICAgICAgcHJpbWl0aXZlLl9zdGF0ZSA9IFByaW1pdGl2ZVN0YXRlLkNPTUJJTkVEO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2V0UmVhZHkocHJpbWl0aXZlLCBmcmFtZVN0YXRlLCBQcmltaXRpdmVTdGF0ZS5GQUlMRUQsIHVuZGVmaW5lZCk7XG4gICAgICB9XG4gICAgfSkub3RoZXJ3aXNlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgc2V0UmVhZHkocHJpbWl0aXZlLCBmcmFtZVN0YXRlLCBQcmltaXRpdmVTdGF0ZS5GQUlMRUQsIGVycm9yKTtcbiAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBsb2FkU3luY2hyb25vdXMocHJpbWl0aXZlLCBmcmFtZVN0YXRlKSB7XG4gIHZhciBpbnN0YW5jZXMgPSBBcnJheS5pc0FycmF5KHByaW1pdGl2ZS5nZW9tZXRyeUluc3RhbmNlcylcbiAgICA/IHByaW1pdGl2ZS5nZW9tZXRyeUluc3RhbmNlc1xuICAgIDogW3ByaW1pdGl2ZS5nZW9tZXRyeUluc3RhbmNlc107XG4gIHZhciBsZW5ndGggPSAocHJpbWl0aXZlLl9udW1iZXJPZkluc3RhbmNlcyA9IGluc3RhbmNlcy5sZW5ndGgpO1xuICB2YXIgY2xvbmVkSW5zdGFuY2VzID0gbmV3IEFycmF5KGxlbmd0aCk7XG4gIHZhciBpbnN0YW5jZUlkcyA9IHByaW1pdGl2ZS5faW5zdGFuY2VJZHM7XG5cbiAgdmFyIGluc3RhbmNlO1xuICB2YXIgaTtcblxuICB2YXIgZ2VvbWV0cnlJbmRleCA9IDA7XG4gIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGluc3RhbmNlID0gaW5zdGFuY2VzW2ldO1xuICAgIHZhciBnZW9tZXRyeSA9IGluc3RhbmNlLmdlb21ldHJ5O1xuXG4gICAgdmFyIGNyZWF0ZWRHZW9tZXRyeTtcbiAgICBpZiAoZGVmaW5lZChnZW9tZXRyeS5hdHRyaWJ1dGVzKSAmJiBkZWZpbmVkKGdlb21ldHJ5LnByaW1pdGl2ZVR5cGUpKSB7XG4gICAgICBjcmVhdGVkR2VvbWV0cnkgPSBjbG9uZUdlb21ldHJ5KGdlb21ldHJ5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY3JlYXRlZEdlb21ldHJ5ID0gZ2VvbWV0cnkuY29uc3RydWN0b3IuY3JlYXRlR2VvbWV0cnkoZ2VvbWV0cnkpO1xuICAgIH1cblxuICAgIGNsb25lZEluc3RhbmNlc1tnZW9tZXRyeUluZGV4KytdID0gY2xvbmVJbnN0YW5jZShpbnN0YW5jZSwgY3JlYXRlZEdlb21ldHJ5KTtcbiAgICBpbnN0YW5jZUlkcy5wdXNoKGluc3RhbmNlLmlkKTtcbiAgfVxuXG4gIGNsb25lZEluc3RhbmNlcy5sZW5ndGggPSBnZW9tZXRyeUluZGV4O1xuXG4gIHZhciBzY2VuZTNET25seSA9IGZyYW1lU3RhdGUuc2NlbmUzRE9ubHk7XG4gIHZhciBwcm9qZWN0aW9uID0gZnJhbWVTdGF0ZS5tYXBQcm9qZWN0aW9uO1xuXG4gIHZhciByZXN1bHQgPSBQcmltaXRpdmVQaXBlbGluZS5jb21iaW5lR2VvbWV0cnkoe1xuICAgIGluc3RhbmNlczogY2xvbmVkSW5zdGFuY2VzLFxuICAgIGVsbGlwc29pZDogcHJvamVjdGlvbi5lbGxpcHNvaWQsXG4gICAgcHJvamVjdGlvbjogcHJvamVjdGlvbixcbiAgICBlbGVtZW50SW5kZXhVaW50U3VwcG9ydGVkOiBmcmFtZVN0YXRlLmNvbnRleHQuZWxlbWVudEluZGV4VWludCxcbiAgICBzY2VuZTNET25seTogc2NlbmUzRE9ubHksXG4gICAgdmVydGV4Q2FjaGVPcHRpbWl6ZTogcHJpbWl0aXZlLnZlcnRleENhY2hlT3B0aW1pemUsXG4gICAgY29tcHJlc3NWZXJ0aWNlczogcHJpbWl0aXZlLmNvbXByZXNzVmVydGljZXMsXG4gICAgbW9kZWxNYXRyaXg6IHByaW1pdGl2ZS5tb2RlbE1hdHJpeCxcbiAgICBjcmVhdGVQaWNrT2Zmc2V0czogcHJpbWl0aXZlLl9jcmVhdGVQaWNrT2Zmc2V0cyxcbiAgfSk7XG5cbiAgcHJpbWl0aXZlLl9nZW9tZXRyaWVzID0gcmVzdWx0Lmdlb21ldHJpZXM7XG4gIHByaW1pdGl2ZS5fYXR0cmlidXRlTG9jYXRpb25zID0gcmVzdWx0LmF0dHJpYnV0ZUxvY2F0aW9ucztcbiAgcHJpbWl0aXZlLm1vZGVsTWF0cml4ID0gTWF0cml4NC5jbG9uZShcbiAgICByZXN1bHQubW9kZWxNYXRyaXgsXG4gICAgcHJpbWl0aXZlLm1vZGVsTWF0cml4XG4gICk7XG4gIHByaW1pdGl2ZS5fcGlja09mZnNldHMgPSByZXN1bHQucGlja09mZnNldHM7XG4gIHByaW1pdGl2ZS5fb2Zmc2V0SW5zdGFuY2VFeHRlbmQgPSByZXN1bHQub2Zmc2V0SW5zdGFuY2VFeHRlbmQ7XG4gIHByaW1pdGl2ZS5faW5zdGFuY2VCb3VuZGluZ1NwaGVyZXMgPSByZXN1bHQuYm91bmRpbmdTcGhlcmVzO1xuICBwcmltaXRpdmUuX2luc3RhbmNlQm91bmRpbmdTcGhlcmVzQ1YgPSByZXN1bHQuYm91bmRpbmdTcGhlcmVzQ1Y7XG5cbiAgaWYgKGRlZmluZWQocHJpbWl0aXZlLl9nZW9tZXRyaWVzKSAmJiBwcmltaXRpdmUuX2dlb21ldHJpZXMubGVuZ3RoID4gMCkge1xuICAgIHByaW1pdGl2ZS5fcmVjb21wdXRlQm91bmRpbmdTcGhlcmVzID0gdHJ1ZTtcbiAgICBwcmltaXRpdmUuX3N0YXRlID0gUHJpbWl0aXZlU3RhdGUuQ09NQklORUQ7XG4gIH0gZWxzZSB7XG4gICAgc2V0UmVhZHkocHJpbWl0aXZlLCBmcmFtZVN0YXRlLCBQcmltaXRpdmVTdGF0ZS5GQUlMRUQsIHVuZGVmaW5lZCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcmVjb21wdXRlQm91bmRpbmdTcGhlcmVzKHByaW1pdGl2ZSwgZnJhbWVTdGF0ZSkge1xuICB2YXIgb2Zmc2V0SW5kZXggPSBwcmltaXRpdmUuX2JhdGNoVGFibGVBdHRyaWJ1dGVJbmRpY2VzLm9mZnNldDtcbiAgaWYgKCFwcmltaXRpdmUuX3JlY29tcHV0ZUJvdW5kaW5nU3BoZXJlcyB8fCAhZGVmaW5lZChvZmZzZXRJbmRleCkpIHtcbiAgICBwcmltaXRpdmUuX3JlY29tcHV0ZUJvdW5kaW5nU3BoZXJlcyA9IGZhbHNlO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBpO1xuICB2YXIgb2Zmc2V0SW5zdGFuY2VFeHRlbmQgPSBwcmltaXRpdmUuX29mZnNldEluc3RhbmNlRXh0ZW5kO1xuICB2YXIgYm91bmRpbmdTcGhlcmVzID0gcHJpbWl0aXZlLl9pbnN0YW5jZUJvdW5kaW5nU3BoZXJlcztcbiAgdmFyIGxlbmd0aCA9IGJvdW5kaW5nU3BoZXJlcy5sZW5ndGg7XG4gIHZhciBuZXdCb3VuZGluZ1NwaGVyZXMgPSBwcmltaXRpdmUuX3RlbXBCb3VuZGluZ1NwaGVyZXM7XG4gIGlmICghZGVmaW5lZChuZXdCb3VuZGluZ1NwaGVyZXMpKSB7XG4gICAgbmV3Qm91bmRpbmdTcGhlcmVzID0gbmV3IEFycmF5KGxlbmd0aCk7XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBuZXdCb3VuZGluZ1NwaGVyZXNbaV0gPSBuZXcgQm91bmRpbmdTcGhlcmUoKTtcbiAgICB9XG4gICAgcHJpbWl0aXZlLl90ZW1wQm91bmRpbmdTcGhlcmVzID0gbmV3Qm91bmRpbmdTcGhlcmVzO1xuICB9XG4gIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIHZhciBuZXdCUyA9IG5ld0JvdW5kaW5nU3BoZXJlc1tpXTtcbiAgICB2YXIgb2Zmc2V0ID0gcHJpbWl0aXZlLl9iYXRjaFRhYmxlLmdldEJhdGNoZWRBdHRyaWJ1dGUoXG4gICAgICBpLFxuICAgICAgb2Zmc2V0SW5kZXgsXG4gICAgICBuZXcgQ2FydGVzaWFuMygpXG4gICAgKTtcbiAgICBuZXdCUyA9IGJvdW5kaW5nU3BoZXJlc1tpXS5jbG9uZShuZXdCUyk7XG4gICAgdHJhbnNmb3JtQm91bmRpbmdTcGhlcmUobmV3QlMsIG9mZnNldCwgb2Zmc2V0SW5zdGFuY2VFeHRlbmRbaV0pO1xuICB9XG4gIHZhciBjb21iaW5lZEJTID0gW107XG4gIHZhciBjb21iaW5lZFdlc3RCUyA9IFtdO1xuICB2YXIgY29tYmluZWRFYXN0QlMgPSBbXTtcblxuICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgYnMgPSBuZXdCb3VuZGluZ1NwaGVyZXNbaV07XG5cbiAgICB2YXIgbWluWCA9IGJzLmNlbnRlci54IC0gYnMucmFkaXVzO1xuICAgIGlmIChcbiAgICAgIG1pblggPiAwIHx8XG4gICAgICBCb3VuZGluZ1NwaGVyZS5pbnRlcnNlY3RQbGFuZShicywgUGxhbmUuT1JJR0lOX1pYX1BMQU5FKSAhPT1cbiAgICAgICAgSW50ZXJzZWN0LklOVEVSU0VDVElOR1xuICAgICkge1xuICAgICAgY29tYmluZWRCUy5wdXNoKGJzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29tYmluZWRXZXN0QlMucHVzaChicyk7XG4gICAgICBjb21iaW5lZEVhc3RCUy5wdXNoKGJzKTtcbiAgICB9XG4gIH1cblxuICB2YXIgcmVzdWx0QlMxID0gY29tYmluZWRCU1swXTtcbiAgdmFyIHJlc3VsdEJTMiA9IGNvbWJpbmVkRWFzdEJTWzBdO1xuICB2YXIgcmVzdWx0QlMzID0gY29tYmluZWRXZXN0QlNbMF07XG5cbiAgZm9yIChpID0gMTsgaSA8IGNvbWJpbmVkQlMubGVuZ3RoOyBpKyspIHtcbiAgICByZXN1bHRCUzEgPSBCb3VuZGluZ1NwaGVyZS51bmlvbihyZXN1bHRCUzEsIGNvbWJpbmVkQlNbaV0pO1xuICB9XG4gIGZvciAoaSA9IDE7IGkgPCBjb21iaW5lZEVhc3RCUy5sZW5ndGg7IGkrKykge1xuICAgIHJlc3VsdEJTMiA9IEJvdW5kaW5nU3BoZXJlLnVuaW9uKHJlc3VsdEJTMiwgY29tYmluZWRFYXN0QlNbaV0pO1xuICB9XG4gIGZvciAoaSA9IDE7IGkgPCBjb21iaW5lZFdlc3RCUy5sZW5ndGg7IGkrKykge1xuICAgIHJlc3VsdEJTMyA9IEJvdW5kaW5nU3BoZXJlLnVuaW9uKHJlc3VsdEJTMywgY29tYmluZWRXZXN0QlNbaV0pO1xuICB9XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgaWYgKGRlZmluZWQocmVzdWx0QlMxKSkge1xuICAgIHJlc3VsdC5wdXNoKHJlc3VsdEJTMSk7XG4gIH1cbiAgaWYgKGRlZmluZWQocmVzdWx0QlMyKSkge1xuICAgIHJlc3VsdC5wdXNoKHJlc3VsdEJTMik7XG4gIH1cbiAgaWYgKGRlZmluZWQocmVzdWx0QlMzKSkge1xuICAgIHJlc3VsdC5wdXNoKHJlc3VsdEJTMyk7XG4gIH1cblxuICBmb3IgKGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGJvdW5kaW5nU3BoZXJlID0gcmVzdWx0W2ldLmNsb25lKHByaW1pdGl2ZS5fYm91bmRpbmdTcGhlcmVzW2ldKTtcbiAgICBwcmltaXRpdmUuX2JvdW5kaW5nU3BoZXJlc1tpXSA9IGJvdW5kaW5nU3BoZXJlO1xuICAgIHByaW1pdGl2ZS5fYm91bmRpbmdTcGhlcmVDVltpXSA9IEJvdW5kaW5nU3BoZXJlLnByb2plY3RUbzJEKFxuICAgICAgYm91bmRpbmdTcGhlcmUsXG4gICAgICBmcmFtZVN0YXRlLm1hcFByb2plY3Rpb24sXG4gICAgICBwcmltaXRpdmUuX2JvdW5kaW5nU3BoZXJlQ1ZbaV1cbiAgICApO1xuICB9XG5cbiAgUHJpbWl0aXZlLl91cGRhdGVCb3VuZGluZ1ZvbHVtZXMoXG4gICAgcHJpbWl0aXZlLFxuICAgIGZyYW1lU3RhdGUsXG4gICAgcHJpbWl0aXZlLm1vZGVsTWF0cml4LFxuICAgIHRydWVcbiAgKTtcbiAgcHJpbWl0aXZlLl9yZWNvbXB1dGVCb3VuZGluZ1NwaGVyZXMgPSBmYWxzZTtcbn1cblxudmFyIHNjcmF0Y2hCb3VuZGluZ1NwaGVyZUNlbnRlckVuY29kZWQgPSBuZXcgRW5jb2RlZENhcnRlc2lhbjMoKTtcbnZhciBzY3JhdGNoQm91bmRpbmdTcGhlcmVDYXJ0b2dyYXBoaWMgPSBuZXcgQ2FydG9ncmFwaGljKCk7XG52YXIgc2NyYXRjaEJvdW5kaW5nU3BoZXJlQ2VudGVyMkQgPSBuZXcgQ2FydGVzaWFuMygpO1xudmFyIHNjcmF0Y2hCb3VuZGluZ1NwaGVyZSA9IG5ldyBCb3VuZGluZ1NwaGVyZSgpO1xuXG5mdW5jdGlvbiB1cGRhdGVCYXRjaFRhYmxlQm91bmRpbmdTcGhlcmVzKHByaW1pdGl2ZSwgZnJhbWVTdGF0ZSkge1xuICB2YXIgaGFzRGlzdGFuY2VEaXNwbGF5Q29uZGl0aW9uID0gZGVmaW5lZChcbiAgICBwcmltaXRpdmUuX2JhdGNoVGFibGVBdHRyaWJ1dGVJbmRpY2VzLmRpc3RhbmNlRGlzcGxheUNvbmRpdGlvblxuICApO1xuICBpZiAoXG4gICAgIWhhc0Rpc3RhbmNlRGlzcGxheUNvbmRpdGlvbiB8fFxuICAgIHByaW1pdGl2ZS5fYmF0Y2hUYWJsZUJvdW5kaW5nU3BoZXJlc1VwZGF0ZWRcbiAgKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGluZGljZXMgPSBwcmltaXRpdmUuX2JhdGNoVGFibGVCb3VuZGluZ1NwaGVyZUF0dHJpYnV0ZUluZGljZXM7XG4gIHZhciBjZW50ZXIzREhpZ2hJbmRleCA9IGluZGljZXMuY2VudGVyM0RIaWdoO1xuICB2YXIgY2VudGVyM0RMb3dJbmRleCA9IGluZGljZXMuY2VudGVyM0RMb3c7XG4gIHZhciBjZW50ZXIyREhpZ2hJbmRleCA9IGluZGljZXMuY2VudGVyMkRIaWdoO1xuICB2YXIgY2VudGVyMkRMb3dJbmRleCA9IGluZGljZXMuY2VudGVyMkRMb3c7XG4gIHZhciByYWRpdXNJbmRleCA9IGluZGljZXMucmFkaXVzO1xuXG4gIHZhciBwcm9qZWN0aW9uID0gZnJhbWVTdGF0ZS5tYXBQcm9qZWN0aW9uO1xuICB2YXIgZWxsaXBzb2lkID0gcHJvamVjdGlvbi5lbGxpcHNvaWQ7XG5cbiAgdmFyIGJhdGNoVGFibGUgPSBwcmltaXRpdmUuX2JhdGNoVGFibGU7XG4gIHZhciBib3VuZGluZ1NwaGVyZXMgPSBwcmltaXRpdmUuX2luc3RhbmNlQm91bmRpbmdTcGhlcmVzO1xuICB2YXIgbGVuZ3RoID0gYm91bmRpbmdTcGhlcmVzLmxlbmd0aDtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgdmFyIGJvdW5kaW5nU3BoZXJlID0gYm91bmRpbmdTcGhlcmVzW2ldO1xuICAgIGlmICghZGVmaW5lZChib3VuZGluZ1NwaGVyZSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIHZhciBtb2RlbE1hdHJpeCA9IHByaW1pdGl2ZS5tb2RlbE1hdHJpeDtcbiAgICBpZiAoZGVmaW5lZChtb2RlbE1hdHJpeCkpIHtcbiAgICAgIGJvdW5kaW5nU3BoZXJlID0gQm91bmRpbmdTcGhlcmUudHJhbnNmb3JtKFxuICAgICAgICBib3VuZGluZ1NwaGVyZSxcbiAgICAgICAgbW9kZWxNYXRyaXgsXG4gICAgICAgIHNjcmF0Y2hCb3VuZGluZ1NwaGVyZVxuICAgICAgKTtcbiAgICB9XG5cbiAgICB2YXIgY2VudGVyID0gYm91bmRpbmdTcGhlcmUuY2VudGVyO1xuICAgIHZhciByYWRpdXMgPSBib3VuZGluZ1NwaGVyZS5yYWRpdXM7XG5cbiAgICB2YXIgZW5jb2RlZENlbnRlciA9IEVuY29kZWRDYXJ0ZXNpYW4zLmZyb21DYXJ0ZXNpYW4oXG4gICAgICBjZW50ZXIsXG4gICAgICBzY3JhdGNoQm91bmRpbmdTcGhlcmVDZW50ZXJFbmNvZGVkXG4gICAgKTtcbiAgICBiYXRjaFRhYmxlLnNldEJhdGNoZWRBdHRyaWJ1dGUoaSwgY2VudGVyM0RIaWdoSW5kZXgsIGVuY29kZWRDZW50ZXIuaGlnaCk7XG4gICAgYmF0Y2hUYWJsZS5zZXRCYXRjaGVkQXR0cmlidXRlKGksIGNlbnRlcjNETG93SW5kZXgsIGVuY29kZWRDZW50ZXIubG93KTtcblxuICAgIGlmICghZnJhbWVTdGF0ZS5zY2VuZTNET25seSkge1xuICAgICAgdmFyIGNhcnRvZ3JhcGhpYyA9IGVsbGlwc29pZC5jYXJ0ZXNpYW5Ub0NhcnRvZ3JhcGhpYyhcbiAgICAgICAgY2VudGVyLFxuICAgICAgICBzY3JhdGNoQm91bmRpbmdTcGhlcmVDYXJ0b2dyYXBoaWNcbiAgICAgICk7XG4gICAgICB2YXIgY2VudGVyMkQgPSBwcm9qZWN0aW9uLnByb2plY3QoXG4gICAgICAgIGNhcnRvZ3JhcGhpYyxcbiAgICAgICAgc2NyYXRjaEJvdW5kaW5nU3BoZXJlQ2VudGVyMkRcbiAgICAgICk7XG4gICAgICBlbmNvZGVkQ2VudGVyID0gRW5jb2RlZENhcnRlc2lhbjMuZnJvbUNhcnRlc2lhbihcbiAgICAgICAgY2VudGVyMkQsXG4gICAgICAgIHNjcmF0Y2hCb3VuZGluZ1NwaGVyZUNlbnRlckVuY29kZWRcbiAgICAgICk7XG4gICAgICBiYXRjaFRhYmxlLnNldEJhdGNoZWRBdHRyaWJ1dGUoaSwgY2VudGVyMkRIaWdoSW5kZXgsIGVuY29kZWRDZW50ZXIuaGlnaCk7XG4gICAgICBiYXRjaFRhYmxlLnNldEJhdGNoZWRBdHRyaWJ1dGUoaSwgY2VudGVyMkRMb3dJbmRleCwgZW5jb2RlZENlbnRlci5sb3cpO1xuICAgIH1cblxuICAgIGJhdGNoVGFibGUuc2V0QmF0Y2hlZEF0dHJpYnV0ZShpLCByYWRpdXNJbmRleCwgcmFkaXVzKTtcbiAgfVxuXG4gIHByaW1pdGl2ZS5fYmF0Y2hUYWJsZUJvdW5kaW5nU3BoZXJlc1VwZGF0ZWQgPSB0cnVlO1xufVxuXG52YXIgb2Zmc2V0U2NyYXRjaENhcnRlc2lhbiA9IG5ldyBDYXJ0ZXNpYW4zKCk7XG52YXIgb2Zmc2V0Q2VudGVyU2NyYXRjaCA9IG5ldyBDYXJ0ZXNpYW4zKCk7XG5mdW5jdGlvbiB1cGRhdGVCYXRjaFRhYmxlT2Zmc2V0cyhwcmltaXRpdmUsIGZyYW1lU3RhdGUpIHtcbiAgdmFyIGhhc09mZnNldCA9IGRlZmluZWQocHJpbWl0aXZlLl9iYXRjaFRhYmxlQXR0cmlidXRlSW5kaWNlcy5vZmZzZXQpO1xuICBpZiAoXG4gICAgIWhhc09mZnNldCB8fFxuICAgIHByaW1pdGl2ZS5fYmF0Y2hUYWJsZU9mZnNldHNVcGRhdGVkIHx8XG4gICAgZnJhbWVTdGF0ZS5zY2VuZTNET25seVxuICApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgaW5kZXgyRCA9IHByaW1pdGl2ZS5fYmF0Y2hUYWJsZU9mZnNldEF0dHJpYnV0ZTJESW5kZXg7XG5cbiAgdmFyIHByb2plY3Rpb24gPSBmcmFtZVN0YXRlLm1hcFByb2plY3Rpb247XG4gIHZhciBlbGxpcHNvaWQgPSBwcm9qZWN0aW9uLmVsbGlwc29pZDtcblxuICB2YXIgYmF0Y2hUYWJsZSA9IHByaW1pdGl2ZS5fYmF0Y2hUYWJsZTtcbiAgdmFyIGJvdW5kaW5nU3BoZXJlcyA9IHByaW1pdGl2ZS5faW5zdGFuY2VCb3VuZGluZ1NwaGVyZXM7XG4gIHZhciBsZW5ndGggPSBib3VuZGluZ1NwaGVyZXMubGVuZ3RoO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgYm91bmRpbmdTcGhlcmUgPSBib3VuZGluZ1NwaGVyZXNbaV07XG4gICAgaWYgKCFkZWZpbmVkKGJvdW5kaW5nU3BoZXJlKSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHZhciBvZmZzZXQgPSBiYXRjaFRhYmxlLmdldEJhdGNoZWRBdHRyaWJ1dGUoXG4gICAgICBpLFxuICAgICAgcHJpbWl0aXZlLl9iYXRjaFRhYmxlQXR0cmlidXRlSW5kaWNlcy5vZmZzZXRcbiAgICApO1xuICAgIGlmIChDYXJ0ZXNpYW4zLmVxdWFscyhvZmZzZXQsIENhcnRlc2lhbjMuWkVSTykpIHtcbiAgICAgIGJhdGNoVGFibGUuc2V0QmF0Y2hlZEF0dHJpYnV0ZShpLCBpbmRleDJELCBDYXJ0ZXNpYW4zLlpFUk8pO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgdmFyIG1vZGVsTWF0cml4ID0gcHJpbWl0aXZlLm1vZGVsTWF0cml4O1xuICAgIGlmIChkZWZpbmVkKG1vZGVsTWF0cml4KSkge1xuICAgICAgYm91bmRpbmdTcGhlcmUgPSBCb3VuZGluZ1NwaGVyZS50cmFuc2Zvcm0oXG4gICAgICAgIGJvdW5kaW5nU3BoZXJlLFxuICAgICAgICBtb2RlbE1hdHJpeCxcbiAgICAgICAgc2NyYXRjaEJvdW5kaW5nU3BoZXJlXG4gICAgICApO1xuICAgIH1cblxuICAgIHZhciBjZW50ZXIgPSBib3VuZGluZ1NwaGVyZS5jZW50ZXI7XG4gICAgY2VudGVyID0gZWxsaXBzb2lkLnNjYWxlVG9HZW9kZXRpY1N1cmZhY2UoY2VudGVyLCBvZmZzZXRDZW50ZXJTY3JhdGNoKTtcbiAgICB2YXIgY2FydG9ncmFwaGljID0gZWxsaXBzb2lkLmNhcnRlc2lhblRvQ2FydG9ncmFwaGljKFxuICAgICAgY2VudGVyLFxuICAgICAgc2NyYXRjaEJvdW5kaW5nU3BoZXJlQ2FydG9ncmFwaGljXG4gICAgKTtcbiAgICB2YXIgY2VudGVyMkQgPSBwcm9qZWN0aW9uLnByb2plY3QoXG4gICAgICBjYXJ0b2dyYXBoaWMsXG4gICAgICBzY3JhdGNoQm91bmRpbmdTcGhlcmVDZW50ZXIyRFxuICAgICk7XG5cbiAgICB2YXIgbmV3UG9pbnQgPSBDYXJ0ZXNpYW4zLmFkZChvZmZzZXQsIGNlbnRlciwgb2Zmc2V0U2NyYXRjaENhcnRlc2lhbik7XG4gICAgY2FydG9ncmFwaGljID0gZWxsaXBzb2lkLmNhcnRlc2lhblRvQ2FydG9ncmFwaGljKG5ld1BvaW50LCBjYXJ0b2dyYXBoaWMpO1xuXG4gICAgdmFyIG5ld1BvaW50UHJvamVjdGVkID0gcHJvamVjdGlvbi5wcm9qZWN0KFxuICAgICAgY2FydG9ncmFwaGljLFxuICAgICAgb2Zmc2V0U2NyYXRjaENhcnRlc2lhblxuICAgICk7XG5cbiAgICB2YXIgbmV3VmVjdG9yID0gQ2FydGVzaWFuMy5zdWJ0cmFjdChcbiAgICAgIG5ld1BvaW50UHJvamVjdGVkLFxuICAgICAgY2VudGVyMkQsXG4gICAgICBvZmZzZXRTY3JhdGNoQ2FydGVzaWFuXG4gICAgKTtcblxuICAgIHZhciB4ID0gbmV3VmVjdG9yLng7XG4gICAgbmV3VmVjdG9yLnggPSBuZXdWZWN0b3IuejtcbiAgICBuZXdWZWN0b3IueiA9IG5ld1ZlY3Rvci55O1xuICAgIG5ld1ZlY3Rvci55ID0geDtcblxuICAgIGJhdGNoVGFibGUuc2V0QmF0Y2hlZEF0dHJpYnV0ZShpLCBpbmRleDJELCBuZXdWZWN0b3IpO1xuICB9XG5cbiAgcHJpbWl0aXZlLl9iYXRjaFRhYmxlT2Zmc2V0c1VwZGF0ZWQgPSB0cnVlO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVWZXJ0ZXhBcnJheShwcmltaXRpdmUsIGZyYW1lU3RhdGUpIHtcbiAgdmFyIGF0dHJpYnV0ZUxvY2F0aW9ucyA9IHByaW1pdGl2ZS5fYXR0cmlidXRlTG9jYXRpb25zO1xuICB2YXIgZ2VvbWV0cmllcyA9IHByaW1pdGl2ZS5fZ2VvbWV0cmllcztcbiAgdmFyIHNjZW5lM0RPbmx5ID0gZnJhbWVTdGF0ZS5zY2VuZTNET25seTtcbiAgdmFyIGNvbnRleHQgPSBmcmFtZVN0YXRlLmNvbnRleHQ7XG5cbiAgdmFyIHZhID0gW107XG4gIHZhciBsZW5ndGggPSBnZW9tZXRyaWVzLmxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIHZhciBnZW9tZXRyeSA9IGdlb21ldHJpZXNbaV07XG5cbiAgICB2YS5wdXNoKFxuICAgICAgVmVydGV4QXJyYXkuZnJvbUdlb21ldHJ5KHtcbiAgICAgICAgY29udGV4dDogY29udGV4dCxcbiAgICAgICAgZ2VvbWV0cnk6IGdlb21ldHJ5LFxuICAgICAgICBhdHRyaWJ1dGVMb2NhdGlvbnM6IGF0dHJpYnV0ZUxvY2F0aW9ucyxcbiAgICAgICAgYnVmZmVyVXNhZ2U6IEJ1ZmZlclVzYWdlLlNUQVRJQ19EUkFXLFxuICAgICAgICBpbnRlcmxlYXZlOiBwcmltaXRpdmUuX2ludGVybGVhdmUsXG4gICAgICB9KVxuICAgICk7XG5cbiAgICBpZiAoZGVmaW5lZChwcmltaXRpdmUuX2NyZWF0ZUJvdW5kaW5nVm9sdW1lRnVuY3Rpb24pKSB7XG4gICAgICBwcmltaXRpdmUuX2NyZWF0ZUJvdW5kaW5nVm9sdW1lRnVuY3Rpb24oZnJhbWVTdGF0ZSwgZ2VvbWV0cnkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBwcmltaXRpdmUuX2JvdW5kaW5nU3BoZXJlcy5wdXNoKFxuICAgICAgICBCb3VuZGluZ1NwaGVyZS5jbG9uZShnZW9tZXRyeS5ib3VuZGluZ1NwaGVyZSlcbiAgICAgICk7XG4gICAgICBwcmltaXRpdmUuX2JvdW5kaW5nU3BoZXJlV0MucHVzaChuZXcgQm91bmRpbmdTcGhlcmUoKSk7XG5cbiAgICAgIGlmICghc2NlbmUzRE9ubHkpIHtcbiAgICAgICAgdmFyIGNlbnRlciA9IGdlb21ldHJ5LmJvdW5kaW5nU3BoZXJlQ1YuY2VudGVyO1xuICAgICAgICB2YXIgeCA9IGNlbnRlci54O1xuICAgICAgICB2YXIgeSA9IGNlbnRlci55O1xuICAgICAgICB2YXIgeiA9IGNlbnRlci56O1xuICAgICAgICBjZW50ZXIueCA9IHo7XG4gICAgICAgIGNlbnRlci55ID0geDtcbiAgICAgICAgY2VudGVyLnogPSB5O1xuXG4gICAgICAgIHByaW1pdGl2ZS5fYm91bmRpbmdTcGhlcmVDVi5wdXNoKFxuICAgICAgICAgIEJvdW5kaW5nU3BoZXJlLmNsb25lKGdlb21ldHJ5LmJvdW5kaW5nU3BoZXJlQ1YpXG4gICAgICAgICk7XG4gICAgICAgIHByaW1pdGl2ZS5fYm91bmRpbmdTcGhlcmUyRC5wdXNoKG5ldyBCb3VuZGluZ1NwaGVyZSgpKTtcbiAgICAgICAgcHJpbWl0aXZlLl9ib3VuZGluZ1NwaGVyZU1vcnBoLnB1c2gobmV3IEJvdW5kaW5nU3BoZXJlKCkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaW1pdGl2ZS5fdmEgPSB2YTtcbiAgcHJpbWl0aXZlLl9wcmltaXRpdmVUeXBlID0gZ2VvbWV0cmllc1swXS5wcmltaXRpdmVUeXBlO1xuXG4gIGlmIChwcmltaXRpdmUucmVsZWFzZUdlb21ldHJ5SW5zdGFuY2VzKSB7XG4gICAgcHJpbWl0aXZlLmdlb21ldHJ5SW5zdGFuY2VzID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgcHJpbWl0aXZlLl9nZW9tZXRyaWVzID0gdW5kZWZpbmVkO1xuICBzZXRSZWFkeShwcmltaXRpdmUsIGZyYW1lU3RhdGUsIFByaW1pdGl2ZVN0YXRlLkNPTVBMRVRFLCB1bmRlZmluZWQpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVSZW5kZXJTdGF0ZXMocHJpbWl0aXZlLCBjb250ZXh0LCBhcHBlYXJhbmNlLCB0d29QYXNzZXMpIHtcbiAgdmFyIHJlbmRlclN0YXRlID0gYXBwZWFyYW5jZS5nZXRSZW5kZXJTdGF0ZSgpO1xuICB2YXIgcnM7XG5cbiAgaWYgKHR3b1Bhc3Nlcykge1xuICAgIHJzID0gY2xvbmUocmVuZGVyU3RhdGUsIGZhbHNlKTtcbiAgICBycy5jdWxsID0ge1xuICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgIGZhY2U6IEN1bGxGYWNlLkJBQ0ssXG4gICAgfTtcbiAgICBwcmltaXRpdmUuX2Zyb250RmFjZVJTID0gUmVuZGVyU3RhdGUuZnJvbUNhY2hlKHJzKTtcblxuICAgIHJzLmN1bGwuZmFjZSA9IEN1bGxGYWNlLkZST05UO1xuICAgIHByaW1pdGl2ZS5fYmFja0ZhY2VSUyA9IFJlbmRlclN0YXRlLmZyb21DYWNoZShycyk7XG4gIH0gZWxzZSB7XG4gICAgcHJpbWl0aXZlLl9mcm9udEZhY2VSUyA9IFJlbmRlclN0YXRlLmZyb21DYWNoZShyZW5kZXJTdGF0ZSk7XG4gICAgcHJpbWl0aXZlLl9iYWNrRmFjZVJTID0gcHJpbWl0aXZlLl9mcm9udEZhY2VSUztcbiAgfVxuXG4gIHJzID0gY2xvbmUocmVuZGVyU3RhdGUsIGZhbHNlKTtcbiAgaWYgKGRlZmluZWQocHJpbWl0aXZlLl9kZXB0aEZhaWxBcHBlYXJhbmNlKSkge1xuICAgIHJzLmRlcHRoVGVzdC5lbmFibGVkID0gZmFsc2U7XG4gIH1cblxuICBpZiAoZGVmaW5lZChwcmltaXRpdmUuX2RlcHRoRmFpbEFwcGVhcmFuY2UpKSB7XG4gICAgcmVuZGVyU3RhdGUgPSBwcmltaXRpdmUuX2RlcHRoRmFpbEFwcGVhcmFuY2UuZ2V0UmVuZGVyU3RhdGUoKTtcbiAgICBycyA9IGNsb25lKHJlbmRlclN0YXRlLCBmYWxzZSk7XG4gICAgcnMuZGVwdGhUZXN0LmZ1bmMgPSBEZXB0aEZ1bmN0aW9uLkdSRUFURVI7XG4gICAgaWYgKHR3b1Bhc3Nlcykge1xuICAgICAgcnMuY3VsbCA9IHtcbiAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgZmFjZTogQ3VsbEZhY2UuQkFDSyxcbiAgICAgIH07XG4gICAgICBwcmltaXRpdmUuX2Zyb250RmFjZURlcHRoRmFpbFJTID0gUmVuZGVyU3RhdGUuZnJvbUNhY2hlKHJzKTtcblxuICAgICAgcnMuY3VsbC5mYWNlID0gQ3VsbEZhY2UuRlJPTlQ7XG4gICAgICBwcmltaXRpdmUuX2JhY2tGYWNlRGVwdGhGYWlsUlMgPSBSZW5kZXJTdGF0ZS5mcm9tQ2FjaGUocnMpO1xuICAgIH0gZWxzZSB7XG4gICAgICBwcmltaXRpdmUuX2Zyb250RmFjZURlcHRoRmFpbFJTID0gUmVuZGVyU3RhdGUuZnJvbUNhY2hlKHJzKTtcbiAgICAgIHByaW1pdGl2ZS5fYmFja0ZhY2VEZXB0aEZhaWxSUyA9IHByaW1pdGl2ZS5fZnJvbnRGYWNlUlM7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVNoYWRlclByb2dyYW0ocHJpbWl0aXZlLCBmcmFtZVN0YXRlLCBhcHBlYXJhbmNlKSB7XG4gIHZhciBjb250ZXh0ID0gZnJhbWVTdGF0ZS5jb250ZXh0O1xuXG4gIHZhciBhdHRyaWJ1dGVMb2NhdGlvbnMgPSBwcmltaXRpdmUuX2F0dHJpYnV0ZUxvY2F0aW9ucztcblxuICB2YXIgdnMgPSBwcmltaXRpdmUuX2JhdGNoVGFibGUuZ2V0VmVydGV4U2hhZGVyQ2FsbGJhY2soKShcbiAgICBhcHBlYXJhbmNlLnZlcnRleFNoYWRlclNvdXJjZVxuICApO1xuICB2cyA9IFByaW1pdGl2ZS5fYXBwZW5kT2Zmc2V0VG9TaGFkZXIocHJpbWl0aXZlLCB2cyk7XG4gIHZzID0gUHJpbWl0aXZlLl9hcHBlbmRTaG93VG9TaGFkZXIocHJpbWl0aXZlLCB2cyk7XG4gIHZzID0gUHJpbWl0aXZlLl9hcHBlbmREaXN0YW5jZURpc3BsYXlDb25kaXRpb25Ub1NoYWRlcihcbiAgICBwcmltaXRpdmUsXG4gICAgdnMsXG4gICAgZnJhbWVTdGF0ZS5zY2VuZTNET25seVxuICApO1xuICB2cyA9IGFwcGVuZFBpY2tUb1ZlcnRleFNoYWRlcih2cyk7XG4gIHZzID0gUHJpbWl0aXZlLl91cGRhdGVDb2xvckF0dHJpYnV0ZShwcmltaXRpdmUsIHZzLCBmYWxzZSk7XG4gIHZzID0gbW9kaWZ5Rm9yRW5jb2RlZE5vcm1hbHMocHJpbWl0aXZlLCB2cyk7XG4gIHZzID0gUHJpbWl0aXZlLl9tb2RpZnlTaGFkZXJQb3NpdGlvbihwcmltaXRpdmUsIHZzLCBmcmFtZVN0YXRlLnNjZW5lM0RPbmx5KTtcbiAgdmFyIGZzID0gYXBwZWFyYW5jZS5nZXRGcmFnbWVudFNoYWRlclNvdXJjZSgpO1xuICBmcyA9IGFwcGVuZFBpY2tUb0ZyYWdtZW50U2hhZGVyKGZzKTtcblxuICBwcmltaXRpdmUuX3NwID0gU2hhZGVyUHJvZ3JhbS5yZXBsYWNlQ2FjaGUoe1xuICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgc2hhZGVyUHJvZ3JhbTogcHJpbWl0aXZlLl9zcCxcbiAgICB2ZXJ0ZXhTaGFkZXJTb3VyY2U6IHZzLFxuICAgIGZyYWdtZW50U2hhZGVyU291cmNlOiBmcyxcbiAgICBhdHRyaWJ1dGVMb2NhdGlvbnM6IGF0dHJpYnV0ZUxvY2F0aW9ucyxcbiAgfSk7XG4gIHZhbGlkYXRlU2hhZGVyTWF0Y2hpbmcocHJpbWl0aXZlLl9zcCwgYXR0cmlidXRlTG9jYXRpb25zKTtcblxuICBpZiAoZGVmaW5lZChwcmltaXRpdmUuX2RlcHRoRmFpbEFwcGVhcmFuY2UpKSB7XG4gICAgdnMgPSBwcmltaXRpdmUuX2JhdGNoVGFibGUuZ2V0VmVydGV4U2hhZGVyQ2FsbGJhY2soKShcbiAgICAgIHByaW1pdGl2ZS5fZGVwdGhGYWlsQXBwZWFyYW5jZS52ZXJ0ZXhTaGFkZXJTb3VyY2VcbiAgICApO1xuICAgIHZzID0gUHJpbWl0aXZlLl9hcHBlbmRTaG93VG9TaGFkZXIocHJpbWl0aXZlLCB2cyk7XG4gICAgdnMgPSBQcmltaXRpdmUuX2FwcGVuZERpc3RhbmNlRGlzcGxheUNvbmRpdGlvblRvU2hhZGVyKFxuICAgICAgcHJpbWl0aXZlLFxuICAgICAgdnMsXG4gICAgICBmcmFtZVN0YXRlLnNjZW5lM0RPbmx5XG4gICAgKTtcbiAgICB2cyA9IGFwcGVuZFBpY2tUb1ZlcnRleFNoYWRlcih2cyk7XG4gICAgdnMgPSBQcmltaXRpdmUuX3VwZGF0ZUNvbG9yQXR0cmlidXRlKHByaW1pdGl2ZSwgdnMsIHRydWUpO1xuICAgIHZzID0gbW9kaWZ5Rm9yRW5jb2RlZE5vcm1hbHMocHJpbWl0aXZlLCB2cyk7XG4gICAgdnMgPSBQcmltaXRpdmUuX21vZGlmeVNoYWRlclBvc2l0aW9uKHByaW1pdGl2ZSwgdnMsIGZyYW1lU3RhdGUuc2NlbmUzRE9ubHkpO1xuICAgIHZzID0gZGVwdGhDbGFtcFZTKHZzKTtcblxuICAgIGZzID0gcHJpbWl0aXZlLl9kZXB0aEZhaWxBcHBlYXJhbmNlLmdldEZyYWdtZW50U2hhZGVyU291cmNlKCk7XG4gICAgZnMgPSBhcHBlbmRQaWNrVG9GcmFnbWVudFNoYWRlcihmcyk7XG4gICAgZnMgPSBkZXB0aENsYW1wRlMoZnMpO1xuXG4gICAgcHJpbWl0aXZlLl9zcERlcHRoRmFpbCA9IFNoYWRlclByb2dyYW0ucmVwbGFjZUNhY2hlKHtcbiAgICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgICBzaGFkZXJQcm9ncmFtOiBwcmltaXRpdmUuX3NwRGVwdGhGYWlsLFxuICAgICAgdmVydGV4U2hhZGVyU291cmNlOiB2cyxcbiAgICAgIGZyYWdtZW50U2hhZGVyU291cmNlOiBmcyxcbiAgICAgIGF0dHJpYnV0ZUxvY2F0aW9uczogYXR0cmlidXRlTG9jYXRpb25zLFxuICAgIH0pO1xuICAgIHZhbGlkYXRlU2hhZGVyTWF0Y2hpbmcocHJpbWl0aXZlLl9zcERlcHRoRmFpbCwgYXR0cmlidXRlTG9jYXRpb25zKTtcbiAgfVxufVxuXG52YXIgbW9kaWZpZWRNb2RlbFZpZXdTY3JhdGNoID0gbmV3IE1hdHJpeDQoKTtcbnZhciBydGNTY3JhdGNoID0gbmV3IENhcnRlc2lhbjMoKTtcblxuZnVuY3Rpb24gZ2V0VW5pZm9ybXMocHJpbWl0aXZlLCBhcHBlYXJhbmNlLCBtYXRlcmlhbCwgZnJhbWVTdGF0ZSkge1xuICAvLyBDcmVhdGUgdW5pZm9ybSBtYXAgYnkgY29tYmluaW5nIHVuaWZvcm1zIGZyb20gdGhlIGFwcGVhcmFuY2UgYW5kIG1hdGVyaWFsIGlmIGVpdGhlciBoYXZlIHVuaWZvcm1zLlxuICB2YXIgbWF0ZXJpYWxVbmlmb3JtTWFwID0gZGVmaW5lZChtYXRlcmlhbCkgPyBtYXRlcmlhbC5fdW5pZm9ybXMgOiB1bmRlZmluZWQ7XG4gIHZhciBhcHBlYXJhbmNlVW5pZm9ybU1hcCA9IHt9O1xuICB2YXIgYXBwZWFyYW5jZVVuaWZvcm1zID0gYXBwZWFyYW5jZS51bmlmb3JtcztcbiAgaWYgKGRlZmluZWQoYXBwZWFyYW5jZVVuaWZvcm1zKSkge1xuICAgIC8vIENvbnZlcnQgdG8gdW5pZm9ybSBtYXAgb2YgZnVuY3Rpb25zIGZvciB0aGUgcmVuZGVyZXJcbiAgICBmb3IgKHZhciBuYW1lIGluIGFwcGVhcmFuY2VVbmlmb3Jtcykge1xuICAgICAgaWYgKGFwcGVhcmFuY2VVbmlmb3Jtcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgICAgICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICAgICAgICBpZiAoZGVmaW5lZChtYXRlcmlhbFVuaWZvcm1NYXApICYmIGRlZmluZWQobWF0ZXJpYWxVbmlmb3JtTWFwW25hbWVdKSkge1xuICAgICAgICAgIC8vIExhdGVyLCB3ZSBjb3VsZCByZW5hbWUgdW5pZm9ybXMgYmVoaW5kLXRoZS1zY2VuZXMgaWYgbmVlZGVkLlxuICAgICAgICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcbiAgICAgICAgICAgIFwiQXBwZWFyYW5jZSBhbmQgbWF0ZXJpYWwgaGF2ZSBhIHVuaWZvcm0gd2l0aCB0aGUgc2FtZSBuYW1lOiBcIiArIG5hbWVcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gICAgICAgIGFwcGVhcmFuY2VVbmlmb3JtTWFwW25hbWVdID0gZ2V0VW5pZm9ybUZ1bmN0aW9uKFxuICAgICAgICAgIGFwcGVhcmFuY2VVbmlmb3JtcyxcbiAgICAgICAgICBuYW1lXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHZhciB1bmlmb3JtcyA9IGNvbWJpbmUoYXBwZWFyYW5jZVVuaWZvcm1NYXAsIG1hdGVyaWFsVW5pZm9ybU1hcCk7XG4gIHVuaWZvcm1zID0gcHJpbWl0aXZlLl9iYXRjaFRhYmxlLmdldFVuaWZvcm1NYXBDYWxsYmFjaygpKHVuaWZvcm1zKTtcblxuICBpZiAoZGVmaW5lZChwcmltaXRpdmUucnRjQ2VudGVyKSkge1xuICAgIHVuaWZvcm1zLnVfbW9kaWZpZWRNb2RlbFZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdmlld01hdHJpeCA9IGZyYW1lU3RhdGUuY29udGV4dC51bmlmb3JtU3RhdGUudmlldztcbiAgICAgIE1hdHJpeDQubXVsdGlwbHkoXG4gICAgICAgIHZpZXdNYXRyaXgsXG4gICAgICAgIHByaW1pdGl2ZS5fbW9kZWxNYXRyaXgsXG4gICAgICAgIG1vZGlmaWVkTW9kZWxWaWV3U2NyYXRjaFxuICAgICAgKTtcbiAgICAgIE1hdHJpeDQubXVsdGlwbHlCeVBvaW50KFxuICAgICAgICBtb2RpZmllZE1vZGVsVmlld1NjcmF0Y2gsXG4gICAgICAgIHByaW1pdGl2ZS5ydGNDZW50ZXIsXG4gICAgICAgIHJ0Y1NjcmF0Y2hcbiAgICAgICk7XG4gICAgICBNYXRyaXg0LnNldFRyYW5zbGF0aW9uKFxuICAgICAgICBtb2RpZmllZE1vZGVsVmlld1NjcmF0Y2gsXG4gICAgICAgIHJ0Y1NjcmF0Y2gsXG4gICAgICAgIG1vZGlmaWVkTW9kZWxWaWV3U2NyYXRjaFxuICAgICAgKTtcbiAgICAgIHJldHVybiBtb2RpZmllZE1vZGVsVmlld1NjcmF0Y2g7XG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB1bmlmb3Jtcztcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ29tbWFuZHMoXG4gIHByaW1pdGl2ZSxcbiAgYXBwZWFyYW5jZSxcbiAgbWF0ZXJpYWwsXG4gIHRyYW5zbHVjZW50LFxuICB0d29QYXNzZXMsXG4gIGNvbG9yQ29tbWFuZHMsXG4gIHBpY2tDb21tYW5kcyxcbiAgZnJhbWVTdGF0ZVxuKSB7XG4gIHZhciB1bmlmb3JtcyA9IGdldFVuaWZvcm1zKHByaW1pdGl2ZSwgYXBwZWFyYW5jZSwgbWF0ZXJpYWwsIGZyYW1lU3RhdGUpO1xuXG4gIHZhciBkZXB0aEZhaWxVbmlmb3JtcztcbiAgaWYgKGRlZmluZWQocHJpbWl0aXZlLl9kZXB0aEZhaWxBcHBlYXJhbmNlKSkge1xuICAgIGRlcHRoRmFpbFVuaWZvcm1zID0gZ2V0VW5pZm9ybXMoXG4gICAgICBwcmltaXRpdmUsXG4gICAgICBwcmltaXRpdmUuX2RlcHRoRmFpbEFwcGVhcmFuY2UsXG4gICAgICBwcmltaXRpdmUuX2RlcHRoRmFpbEFwcGVhcmFuY2UubWF0ZXJpYWwsXG4gICAgICBmcmFtZVN0YXRlXG4gICAgKTtcbiAgfVxuXG4gIHZhciBwYXNzID0gdHJhbnNsdWNlbnQgPyBQYXNzLlRSQU5TTFVDRU5UIDogUGFzcy5PUEFRVUU7XG5cbiAgdmFyIG11bHRpcGxpZXIgPSB0d29QYXNzZXMgPyAyIDogMTtcbiAgbXVsdGlwbGllciAqPSBkZWZpbmVkKHByaW1pdGl2ZS5fZGVwdGhGYWlsQXBwZWFyYW5jZSkgPyAyIDogMTtcbiAgY29sb3JDb21tYW5kcy5sZW5ndGggPSBwcmltaXRpdmUuX3ZhLmxlbmd0aCAqIG11bHRpcGxpZXI7XG5cbiAgdmFyIGxlbmd0aCA9IGNvbG9yQ29tbWFuZHMubGVuZ3RoO1xuICB2YXIgdmFJbmRleCA9IDA7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgY29sb3JDb21tYW5kO1xuXG4gICAgaWYgKHR3b1Bhc3Nlcykge1xuICAgICAgY29sb3JDb21tYW5kID0gY29sb3JDb21tYW5kc1tpXTtcbiAgICAgIGlmICghZGVmaW5lZChjb2xvckNvbW1hbmQpKSB7XG4gICAgICAgIGNvbG9yQ29tbWFuZCA9IGNvbG9yQ29tbWFuZHNbaV0gPSBuZXcgRHJhd0NvbW1hbmQoe1xuICAgICAgICAgIG93bmVyOiBwcmltaXRpdmUsXG4gICAgICAgICAgcHJpbWl0aXZlVHlwZTogcHJpbWl0aXZlLl9wcmltaXRpdmVUeXBlLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbG9yQ29tbWFuZC52ZXJ0ZXhBcnJheSA9IHByaW1pdGl2ZS5fdmFbdmFJbmRleF07XG4gICAgICBjb2xvckNvbW1hbmQucmVuZGVyU3RhdGUgPSBwcmltaXRpdmUuX2JhY2tGYWNlUlM7XG4gICAgICBjb2xvckNvbW1hbmQuc2hhZGVyUHJvZ3JhbSA9IHByaW1pdGl2ZS5fc3A7XG4gICAgICBjb2xvckNvbW1hbmQudW5pZm9ybU1hcCA9IHVuaWZvcm1zO1xuICAgICAgY29sb3JDb21tYW5kLnBhc3MgPSBwYXNzO1xuXG4gICAgICArK2k7XG4gICAgfVxuXG4gICAgY29sb3JDb21tYW5kID0gY29sb3JDb21tYW5kc1tpXTtcbiAgICBpZiAoIWRlZmluZWQoY29sb3JDb21tYW5kKSkge1xuICAgICAgY29sb3JDb21tYW5kID0gY29sb3JDb21tYW5kc1tpXSA9IG5ldyBEcmF3Q29tbWFuZCh7XG4gICAgICAgIG93bmVyOiBwcmltaXRpdmUsXG4gICAgICAgIHByaW1pdGl2ZVR5cGU6IHByaW1pdGl2ZS5fcHJpbWl0aXZlVHlwZSxcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb2xvckNvbW1hbmQudmVydGV4QXJyYXkgPSBwcmltaXRpdmUuX3ZhW3ZhSW5kZXhdO1xuICAgIGNvbG9yQ29tbWFuZC5yZW5kZXJTdGF0ZSA9IHByaW1pdGl2ZS5fZnJvbnRGYWNlUlM7XG4gICAgY29sb3JDb21tYW5kLnNoYWRlclByb2dyYW0gPSBwcmltaXRpdmUuX3NwO1xuICAgIGNvbG9yQ29tbWFuZC51bmlmb3JtTWFwID0gdW5pZm9ybXM7XG4gICAgY29sb3JDb21tYW5kLnBhc3MgPSBwYXNzO1xuXG4gICAgaWYgKGRlZmluZWQocHJpbWl0aXZlLl9kZXB0aEZhaWxBcHBlYXJhbmNlKSkge1xuICAgICAgaWYgKHR3b1Bhc3Nlcykge1xuICAgICAgICArK2k7XG5cbiAgICAgICAgY29sb3JDb21tYW5kID0gY29sb3JDb21tYW5kc1tpXTtcbiAgICAgICAgaWYgKCFkZWZpbmVkKGNvbG9yQ29tbWFuZCkpIHtcbiAgICAgICAgICBjb2xvckNvbW1hbmQgPSBjb2xvckNvbW1hbmRzW2ldID0gbmV3IERyYXdDb21tYW5kKHtcbiAgICAgICAgICAgIG93bmVyOiBwcmltaXRpdmUsXG4gICAgICAgICAgICBwcmltaXRpdmVUeXBlOiBwcmltaXRpdmUuX3ByaW1pdGl2ZVR5cGUsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY29sb3JDb21tYW5kLnZlcnRleEFycmF5ID0gcHJpbWl0aXZlLl92YVt2YUluZGV4XTtcbiAgICAgICAgY29sb3JDb21tYW5kLnJlbmRlclN0YXRlID0gcHJpbWl0aXZlLl9iYWNrRmFjZURlcHRoRmFpbFJTO1xuICAgICAgICBjb2xvckNvbW1hbmQuc2hhZGVyUHJvZ3JhbSA9IHByaW1pdGl2ZS5fc3BEZXB0aEZhaWw7XG4gICAgICAgIGNvbG9yQ29tbWFuZC51bmlmb3JtTWFwID0gZGVwdGhGYWlsVW5pZm9ybXM7XG4gICAgICAgIGNvbG9yQ29tbWFuZC5wYXNzID0gcGFzcztcbiAgICAgIH1cblxuICAgICAgKytpO1xuXG4gICAgICBjb2xvckNvbW1hbmQgPSBjb2xvckNvbW1hbmRzW2ldO1xuICAgICAgaWYgKCFkZWZpbmVkKGNvbG9yQ29tbWFuZCkpIHtcbiAgICAgICAgY29sb3JDb21tYW5kID0gY29sb3JDb21tYW5kc1tpXSA9IG5ldyBEcmF3Q29tbWFuZCh7XG4gICAgICAgICAgb3duZXI6IHByaW1pdGl2ZSxcbiAgICAgICAgICBwcmltaXRpdmVUeXBlOiBwcmltaXRpdmUuX3ByaW1pdGl2ZVR5cGUsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29sb3JDb21tYW5kLnZlcnRleEFycmF5ID0gcHJpbWl0aXZlLl92YVt2YUluZGV4XTtcbiAgICAgIGNvbG9yQ29tbWFuZC5yZW5kZXJTdGF0ZSA9IHByaW1pdGl2ZS5fZnJvbnRGYWNlRGVwdGhGYWlsUlM7XG4gICAgICBjb2xvckNvbW1hbmQuc2hhZGVyUHJvZ3JhbSA9IHByaW1pdGl2ZS5fc3BEZXB0aEZhaWw7XG4gICAgICBjb2xvckNvbW1hbmQudW5pZm9ybU1hcCA9IGRlcHRoRmFpbFVuaWZvcm1zO1xuICAgICAgY29sb3JDb21tYW5kLnBhc3MgPSBwYXNzO1xuICAgIH1cblxuICAgICsrdmFJbmRleDtcbiAgfVxufVxuXG5QcmltaXRpdmUuX3VwZGF0ZUJvdW5kaW5nVm9sdW1lcyA9IGZ1bmN0aW9uIChcbiAgcHJpbWl0aXZlLFxuICBmcmFtZVN0YXRlLFxuICBtb2RlbE1hdHJpeCxcbiAgZm9yY2VVcGRhdGVcbikge1xuICB2YXIgaTtcbiAgdmFyIGxlbmd0aDtcbiAgdmFyIGJvdW5kaW5nU3BoZXJlO1xuXG4gIGlmIChmb3JjZVVwZGF0ZSB8fCAhTWF0cml4NC5lcXVhbHMobW9kZWxNYXRyaXgsIHByaW1pdGl2ZS5fbW9kZWxNYXRyaXgpKSB7XG4gICAgTWF0cml4NC5jbG9uZShtb2RlbE1hdHJpeCwgcHJpbWl0aXZlLl9tb2RlbE1hdHJpeCk7XG4gICAgbGVuZ3RoID0gcHJpbWl0aXZlLl9ib3VuZGluZ1NwaGVyZXMubGVuZ3RoO1xuICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgICAgYm91bmRpbmdTcGhlcmUgPSBwcmltaXRpdmUuX2JvdW5kaW5nU3BoZXJlc1tpXTtcbiAgICAgIGlmIChkZWZpbmVkKGJvdW5kaW5nU3BoZXJlKSkge1xuICAgICAgICBwcmltaXRpdmUuX2JvdW5kaW5nU3BoZXJlV0NbaV0gPSBCb3VuZGluZ1NwaGVyZS50cmFuc2Zvcm0oXG4gICAgICAgICAgYm91bmRpbmdTcGhlcmUsXG4gICAgICAgICAgbW9kZWxNYXRyaXgsXG4gICAgICAgICAgcHJpbWl0aXZlLl9ib3VuZGluZ1NwaGVyZVdDW2ldXG4gICAgICAgICk7XG4gICAgICAgIGlmICghZnJhbWVTdGF0ZS5zY2VuZTNET25seSkge1xuICAgICAgICAgIHByaW1pdGl2ZS5fYm91bmRpbmdTcGhlcmUyRFtpXSA9IEJvdW5kaW5nU3BoZXJlLmNsb25lKFxuICAgICAgICAgICAgcHJpbWl0aXZlLl9ib3VuZGluZ1NwaGVyZUNWW2ldLFxuICAgICAgICAgICAgcHJpbWl0aXZlLl9ib3VuZGluZ1NwaGVyZTJEW2ldXG4gICAgICAgICAgKTtcbiAgICAgICAgICBwcmltaXRpdmUuX2JvdW5kaW5nU3BoZXJlMkRbaV0uY2VudGVyLnggPSAwLjA7XG4gICAgICAgICAgcHJpbWl0aXZlLl9ib3VuZGluZ1NwaGVyZU1vcnBoW2ldID0gQm91bmRpbmdTcGhlcmUudW5pb24oXG4gICAgICAgICAgICBwcmltaXRpdmUuX2JvdW5kaW5nU3BoZXJlV0NbaV0sXG4gICAgICAgICAgICBwcmltaXRpdmUuX2JvdW5kaW5nU3BoZXJlQ1ZbaV1cbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gVXBkYXRlIGJvdW5kaW5nIHZvbHVtZXMgZm9yIHByaW1pdGl2ZXMgdGhhdCBhcmUgc2l6ZWQgaW4gcGl4ZWxzLlxuICAvLyBUaGUgcGl4ZWwgc2l6ZSBpbiBtZXRlcnMgdmFyaWVzIGJhc2VkIG9uIHRoZSBkaXN0YW5jZSBmcm9tIHRoZSBjYW1lcmEuXG4gIHZhciBwaXhlbFNpemUgPSBwcmltaXRpdmUuYXBwZWFyYW5jZS5waXhlbFNpemU7XG4gIGlmIChkZWZpbmVkKHBpeGVsU2l6ZSkpIHtcbiAgICBsZW5ndGggPSBwcmltaXRpdmUuX2JvdW5kaW5nU3BoZXJlcy5sZW5ndGg7XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgICBib3VuZGluZ1NwaGVyZSA9IHByaW1pdGl2ZS5fYm91bmRpbmdTcGhlcmVzW2ldO1xuICAgICAgdmFyIGJvdW5kaW5nU3BoZXJlV0MgPSBwcmltaXRpdmUuX2JvdW5kaW5nU3BoZXJlV0NbaV07XG4gICAgICB2YXIgcGl4ZWxTaXplSW5NZXRlcnMgPSBmcmFtZVN0YXRlLmNhbWVyYS5nZXRQaXhlbFNpemUoXG4gICAgICAgIGJvdW5kaW5nU3BoZXJlLFxuICAgICAgICBmcmFtZVN0YXRlLmNvbnRleHQuZHJhd2luZ0J1ZmZlcldpZHRoLFxuICAgICAgICBmcmFtZVN0YXRlLmNvbnRleHQuZHJhd2luZ0J1ZmZlckhlaWdodFxuICAgICAgKTtcbiAgICAgIHZhciBzaXplSW5NZXRlcnMgPSBwaXhlbFNpemVJbk1ldGVycyAqIHBpeGVsU2l6ZTtcbiAgICAgIGJvdW5kaW5nU3BoZXJlV0MucmFkaXVzID0gYm91bmRpbmdTcGhlcmUucmFkaXVzICsgc2l6ZUluTWV0ZXJzO1xuICAgIH1cbiAgfVxufTtcblxuZnVuY3Rpb24gdXBkYXRlQW5kUXVldWVDb21tYW5kcyhcbiAgcHJpbWl0aXZlLFxuICBmcmFtZVN0YXRlLFxuICBjb2xvckNvbW1hbmRzLFxuICBwaWNrQ29tbWFuZHMsXG4gIG1vZGVsTWF0cml4LFxuICBjdWxsLFxuICBkZWJ1Z1Nob3dCb3VuZGluZ1ZvbHVtZSxcbiAgdHdvUGFzc2VzXG4pIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgaWYgKFxuICAgIGZyYW1lU3RhdGUubW9kZSAhPT0gU2NlbmVNb2RlLlNDRU5FM0QgJiZcbiAgICAhTWF0cml4NC5lcXVhbHMobW9kZWxNYXRyaXgsIE1hdHJpeDQuSURFTlRJVFkpXG4gICkge1xuICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcbiAgICAgIFwiUHJpbWl0aXZlLm1vZGVsTWF0cml4IGlzIG9ubHkgc3VwcG9ydGVkIGluIDNEIG1vZGUuXCJcbiAgICApO1xuICB9XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIFByaW1pdGl2ZS5fdXBkYXRlQm91bmRpbmdWb2x1bWVzKHByaW1pdGl2ZSwgZnJhbWVTdGF0ZSwgbW9kZWxNYXRyaXgpO1xuXG4gIHZhciBib3VuZGluZ1NwaGVyZXM7XG4gIGlmIChmcmFtZVN0YXRlLm1vZGUgPT09IFNjZW5lTW9kZS5TQ0VORTNEKSB7XG4gICAgYm91bmRpbmdTcGhlcmVzID0gcHJpbWl0aXZlLl9ib3VuZGluZ1NwaGVyZVdDO1xuICB9IGVsc2UgaWYgKGZyYW1lU3RhdGUubW9kZSA9PT0gU2NlbmVNb2RlLkNPTFVNQlVTX1ZJRVcpIHtcbiAgICBib3VuZGluZ1NwaGVyZXMgPSBwcmltaXRpdmUuX2JvdW5kaW5nU3BoZXJlQ1Y7XG4gIH0gZWxzZSBpZiAoXG4gICAgZnJhbWVTdGF0ZS5tb2RlID09PSBTY2VuZU1vZGUuU0NFTkUyRCAmJlxuICAgIGRlZmluZWQocHJpbWl0aXZlLl9ib3VuZGluZ1NwaGVyZTJEKVxuICApIHtcbiAgICBib3VuZGluZ1NwaGVyZXMgPSBwcmltaXRpdmUuX2JvdW5kaW5nU3BoZXJlMkQ7XG4gIH0gZWxzZSBpZiAoZGVmaW5lZChwcmltaXRpdmUuX2JvdW5kaW5nU3BoZXJlTW9ycGgpKSB7XG4gICAgYm91bmRpbmdTcGhlcmVzID0gcHJpbWl0aXZlLl9ib3VuZGluZ1NwaGVyZU1vcnBoO1xuICB9XG5cbiAgdmFyIGNvbW1hbmRMaXN0ID0gZnJhbWVTdGF0ZS5jb21tYW5kTGlzdDtcbiAgdmFyIHBhc3NlcyA9IGZyYW1lU3RhdGUucGFzc2VzO1xuICBpZiAocGFzc2VzLnJlbmRlciB8fCBwYXNzZXMucGljaykge1xuICAgIHZhciBhbGxvd1BpY2tpbmcgPSBwcmltaXRpdmUuYWxsb3dQaWNraW5nO1xuICAgIHZhciBjYXN0U2hhZG93cyA9IFNoYWRvd01vZGUuY2FzdFNoYWRvd3MocHJpbWl0aXZlLnNoYWRvd3MpO1xuICAgIHZhciByZWNlaXZlU2hhZG93cyA9IFNoYWRvd01vZGUucmVjZWl2ZVNoYWRvd3MocHJpbWl0aXZlLnNoYWRvd3MpO1xuICAgIHZhciBjb2xvckxlbmd0aCA9IGNvbG9yQ29tbWFuZHMubGVuZ3RoO1xuXG4gICAgdmFyIGZhY3RvciA9IHR3b1Bhc3NlcyA/IDIgOiAxO1xuICAgIGZhY3RvciAqPSBkZWZpbmVkKHByaW1pdGl2ZS5fZGVwdGhGYWlsQXBwZWFyYW5jZSkgPyAyIDogMTtcblxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgY29sb3JMZW5ndGg7ICsraikge1xuICAgICAgdmFyIHNwaGVyZUluZGV4ID0gTWF0aC5mbG9vcihqIC8gZmFjdG9yKTtcbiAgICAgIHZhciBjb2xvckNvbW1hbmQgPSBjb2xvckNvbW1hbmRzW2pdO1xuICAgICAgY29sb3JDb21tYW5kLm1vZGVsTWF0cml4ID0gbW9kZWxNYXRyaXg7XG4gICAgICBjb2xvckNvbW1hbmQuYm91bmRpbmdWb2x1bWUgPSBib3VuZGluZ1NwaGVyZXNbc3BoZXJlSW5kZXhdO1xuICAgICAgY29sb3JDb21tYW5kLmN1bGwgPSBjdWxsO1xuICAgICAgY29sb3JDb21tYW5kLmRlYnVnU2hvd0JvdW5kaW5nVm9sdW1lID0gZGVidWdTaG93Qm91bmRpbmdWb2x1bWU7XG4gICAgICBjb2xvckNvbW1hbmQuY2FzdFNoYWRvd3MgPSBjYXN0U2hhZG93cztcbiAgICAgIGNvbG9yQ29tbWFuZC5yZWNlaXZlU2hhZG93cyA9IHJlY2VpdmVTaGFkb3dzO1xuXG4gICAgICBpZiAoYWxsb3dQaWNraW5nKSB7XG4gICAgICAgIGNvbG9yQ29tbWFuZC5waWNrSWQgPSBcInZfcGlja0NvbG9yXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb2xvckNvbW1hbmQucGlja0lkID0gdW5kZWZpbmVkO1xuICAgICAgfVxuXG4gICAgICBjb21tYW5kTGlzdC5wdXNoKGNvbG9yQ29tbWFuZCk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogQ2FsbGVkIHdoZW4ge0BsaW5rIFZpZXdlcn0gb3Ige0BsaW5rIENlc2l1bVdpZGdldH0gcmVuZGVyIHRoZSBzY2VuZSB0b1xuICogZ2V0IHRoZSBkcmF3IGNvbW1hbmRzIG5lZWRlZCB0byByZW5kZXIgdGhpcyBwcmltaXRpdmUuXG4gKiA8cD5cbiAqIERvIG5vdCBjYWxsIHRoaXMgZnVuY3Rpb24gZGlyZWN0bHkuICBUaGlzIGlzIGRvY3VtZW50ZWQganVzdCB0b1xuICogbGlzdCB0aGUgZXhjZXB0aW9ucyB0aGF0IG1heSBiZSBwcm9wYWdhdGVkIHdoZW4gdGhlIHNjZW5lIGlzIHJlbmRlcmVkOlxuICogPC9wPlxuICpcbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSBBbGwgaW5zdGFuY2UgZ2VvbWV0cmllcyBtdXN0IGhhdmUgdGhlIHNhbWUgcHJpbWl0aXZlVHlwZS5cbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSBBcHBlYXJhbmNlIGFuZCBtYXRlcmlhbCBoYXZlIGEgdW5pZm9ybSB3aXRoIHRoZSBzYW1lIG5hbWUuXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gUHJpbWl0aXZlLm1vZGVsTWF0cml4IGlzIG9ubHkgc3VwcG9ydGVkIGluIDNEIG1vZGUuXG4gKiBAZXhjZXB0aW9uIHtSdW50aW1lRXJyb3J9IFZlcnRleCB0ZXh0dXJlIGZldGNoIHN1cHBvcnQgaXMgcmVxdWlyZWQgdG8gcmVuZGVyIHByaW1pdGl2ZXMgd2l0aCBwZXItaW5zdGFuY2UgYXR0cmlidXRlcy4gVGhlIG1heGltdW0gbnVtYmVyIG9mIHZlcnRleCB0ZXh0dXJlIGltYWdlIHVuaXRzIG11c3QgYmUgZ3JlYXRlciB0aGFuIHplcm8uXG4gKi9cblByaW1pdGl2ZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGZyYW1lU3RhdGUpIHtcbiAgaWYgKFxuICAgICghZGVmaW5lZCh0aGlzLmdlb21ldHJ5SW5zdGFuY2VzKSAmJiB0aGlzLl92YS5sZW5ndGggPT09IDApIHx8XG4gICAgKGRlZmluZWQodGhpcy5nZW9tZXRyeUluc3RhbmNlcykgJiZcbiAgICAgIEFycmF5LmlzQXJyYXkodGhpcy5nZW9tZXRyeUluc3RhbmNlcykgJiZcbiAgICAgIHRoaXMuZ2VvbWV0cnlJbnN0YW5jZXMubGVuZ3RoID09PSAwKSB8fFxuICAgICFkZWZpbmVkKHRoaXMuYXBwZWFyYW5jZSkgfHxcbiAgICAoZnJhbWVTdGF0ZS5tb2RlICE9PSBTY2VuZU1vZGUuU0NFTkUzRCAmJiBmcmFtZVN0YXRlLnNjZW5lM0RPbmx5KSB8fFxuICAgICghZnJhbWVTdGF0ZS5wYXNzZXMucmVuZGVyICYmICFmcmFtZVN0YXRlLnBhc3Nlcy5waWNrKVxuICApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoZGVmaW5lZCh0aGlzLl9lcnJvcikpIHtcbiAgICB0aHJvdyB0aGlzLl9lcnJvcjtcbiAgfVxuXG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIGlmIChkZWZpbmVkKHRoaXMucnRjQ2VudGVyKSAmJiAhZnJhbWVTdGF0ZS5zY2VuZTNET25seSkge1xuICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcbiAgICAgIFwiUlRDIHJlbmRlcmluZyBpcyBvbmx5IGF2YWlsYWJsZSBmb3IgM0Qgb25seSBzY2VuZXMuXCJcbiAgICApO1xuICB9XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIGlmICh0aGlzLl9zdGF0ZSA9PT0gUHJpbWl0aXZlU3RhdGUuRkFJTEVEKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGNvbnRleHQgPSBmcmFtZVN0YXRlLmNvbnRleHQ7XG4gIGlmICghZGVmaW5lZCh0aGlzLl9iYXRjaFRhYmxlKSkge1xuICAgIGNyZWF0ZUJhdGNoVGFibGUodGhpcywgY29udGV4dCk7XG4gIH1cbiAgaWYgKHRoaXMuX2JhdGNoVGFibGUuYXR0cmlidXRlcy5sZW5ndGggPiAwKSB7XG4gICAgaWYgKENvbnRleHRMaW1pdHMubWF4aW11bVZlcnRleFRleHR1cmVJbWFnZVVuaXRzID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKFxuICAgICAgICBcIlZlcnRleCB0ZXh0dXJlIGZldGNoIHN1cHBvcnQgaXMgcmVxdWlyZWQgdG8gcmVuZGVyIHByaW1pdGl2ZXMgd2l0aCBwZXItaW5zdGFuY2UgYXR0cmlidXRlcy4gVGhlIG1heGltdW0gbnVtYmVyIG9mIHZlcnRleCB0ZXh0dXJlIGltYWdlIHVuaXRzIG11c3QgYmUgZ3JlYXRlciB0aGFuIHplcm8uXCJcbiAgICAgICk7XG4gICAgfVxuICAgIHRoaXMuX2JhdGNoVGFibGUudXBkYXRlKGZyYW1lU3RhdGUpO1xuICB9XG5cbiAgaWYgKFxuICAgIHRoaXMuX3N0YXRlICE9PSBQcmltaXRpdmVTdGF0ZS5DT01QTEVURSAmJlxuICAgIHRoaXMuX3N0YXRlICE9PSBQcmltaXRpdmVTdGF0ZS5DT01CSU5FRFxuICApIHtcbiAgICBpZiAodGhpcy5hc3luY2hyb25vdXMpIHtcbiAgICAgIGxvYWRBc3luY2hyb25vdXModGhpcywgZnJhbWVTdGF0ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvYWRTeW5jaHJvbm91cyh0aGlzLCBmcmFtZVN0YXRlKTtcbiAgICB9XG4gIH1cblxuICBpZiAodGhpcy5fc3RhdGUgPT09IFByaW1pdGl2ZVN0YXRlLkNPTUJJTkVEKSB7XG4gICAgdXBkYXRlQmF0Y2hUYWJsZUJvdW5kaW5nU3BoZXJlcyh0aGlzLCBmcmFtZVN0YXRlKTtcbiAgICB1cGRhdGVCYXRjaFRhYmxlT2Zmc2V0cyh0aGlzLCBmcmFtZVN0YXRlKTtcbiAgICBjcmVhdGVWZXJ0ZXhBcnJheSh0aGlzLCBmcmFtZVN0YXRlKTtcbiAgfVxuXG4gIGlmICghdGhpcy5zaG93IHx8IHRoaXMuX3N0YXRlICE9PSBQcmltaXRpdmVTdGF0ZS5DT01QTEVURSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICghdGhpcy5fYmF0Y2hUYWJsZU9mZnNldHNVcGRhdGVkKSB7XG4gICAgdXBkYXRlQmF0Y2hUYWJsZU9mZnNldHModGhpcywgZnJhbWVTdGF0ZSk7XG4gIH1cbiAgaWYgKHRoaXMuX3JlY29tcHV0ZUJvdW5kaW5nU3BoZXJlcykge1xuICAgIHJlY29tcHV0ZUJvdW5kaW5nU3BoZXJlcyh0aGlzLCBmcmFtZVN0YXRlKTtcbiAgfVxuXG4gIC8vIENyZWF0ZSBvciByZWNyZWF0ZSByZW5kZXIgc3RhdGUgYW5kIHNoYWRlciBwcm9ncmFtIGlmIGFwcGVhcmFuY2UvbWF0ZXJpYWwgY2hhbmdlZFxuICB2YXIgYXBwZWFyYW5jZSA9IHRoaXMuYXBwZWFyYW5jZTtcbiAgdmFyIG1hdGVyaWFsID0gYXBwZWFyYW5jZS5tYXRlcmlhbDtcbiAgdmFyIGNyZWF0ZVJTID0gZmFsc2U7XG4gIHZhciBjcmVhdGVTUCA9IGZhbHNlO1xuXG4gIGlmICh0aGlzLl9hcHBlYXJhbmNlICE9PSBhcHBlYXJhbmNlKSB7XG4gICAgdGhpcy5fYXBwZWFyYW5jZSA9IGFwcGVhcmFuY2U7XG4gICAgdGhpcy5fbWF0ZXJpYWwgPSBtYXRlcmlhbDtcbiAgICBjcmVhdGVSUyA9IHRydWU7XG4gICAgY3JlYXRlU1AgPSB0cnVlO1xuICB9IGVsc2UgaWYgKHRoaXMuX21hdGVyaWFsICE9PSBtYXRlcmlhbCkge1xuICAgIHRoaXMuX21hdGVyaWFsID0gbWF0ZXJpYWw7XG4gICAgY3JlYXRlU1AgPSB0cnVlO1xuICB9XG5cbiAgdmFyIGRlcHRoRmFpbEFwcGVhcmFuY2UgPSB0aGlzLmRlcHRoRmFpbEFwcGVhcmFuY2U7XG4gIHZhciBkZXB0aEZhaWxNYXRlcmlhbCA9IGRlZmluZWQoZGVwdGhGYWlsQXBwZWFyYW5jZSlcbiAgICA/IGRlcHRoRmFpbEFwcGVhcmFuY2UubWF0ZXJpYWxcbiAgICA6IHVuZGVmaW5lZDtcblxuICBpZiAodGhpcy5fZGVwdGhGYWlsQXBwZWFyYW5jZSAhPT0gZGVwdGhGYWlsQXBwZWFyYW5jZSkge1xuICAgIHRoaXMuX2RlcHRoRmFpbEFwcGVhcmFuY2UgPSBkZXB0aEZhaWxBcHBlYXJhbmNlO1xuICAgIHRoaXMuX2RlcHRoRmFpbE1hdGVyaWFsID0gZGVwdGhGYWlsTWF0ZXJpYWw7XG4gICAgY3JlYXRlUlMgPSB0cnVlO1xuICAgIGNyZWF0ZVNQID0gdHJ1ZTtcbiAgfSBlbHNlIGlmICh0aGlzLl9kZXB0aEZhaWxNYXRlcmlhbCAhPT0gZGVwdGhGYWlsTWF0ZXJpYWwpIHtcbiAgICB0aGlzLl9kZXB0aEZhaWxNYXRlcmlhbCA9IGRlcHRoRmFpbE1hdGVyaWFsO1xuICAgIGNyZWF0ZVNQID0gdHJ1ZTtcbiAgfVxuXG4gIHZhciB0cmFuc2x1Y2VudCA9IHRoaXMuX2FwcGVhcmFuY2UuaXNUcmFuc2x1Y2VudCgpO1xuICBpZiAodGhpcy5fdHJhbnNsdWNlbnQgIT09IHRyYW5zbHVjZW50KSB7XG4gICAgdGhpcy5fdHJhbnNsdWNlbnQgPSB0cmFuc2x1Y2VudDtcbiAgICBjcmVhdGVSUyA9IHRydWU7XG4gIH1cblxuICBpZiAoZGVmaW5lZCh0aGlzLl9tYXRlcmlhbCkpIHtcbiAgICB0aGlzLl9tYXRlcmlhbC51cGRhdGUoY29udGV4dCk7XG4gIH1cblxuICB2YXIgdHdvUGFzc2VzID0gYXBwZWFyYW5jZS5jbG9zZWQgJiYgdHJhbnNsdWNlbnQ7XG5cbiAgaWYgKGNyZWF0ZVJTKSB7XG4gICAgdmFyIHJzRnVuYyA9IGRlZmF1bHRWYWx1ZShcbiAgICAgIHRoaXMuX2NyZWF0ZVJlbmRlclN0YXRlc0Z1bmN0aW9uLFxuICAgICAgY3JlYXRlUmVuZGVyU3RhdGVzXG4gICAgKTtcbiAgICByc0Z1bmModGhpcywgY29udGV4dCwgYXBwZWFyYW5jZSwgdHdvUGFzc2VzKTtcbiAgfVxuXG4gIGlmIChjcmVhdGVTUCkge1xuICAgIHZhciBzcEZ1bmMgPSBkZWZhdWx0VmFsdWUoXG4gICAgICB0aGlzLl9jcmVhdGVTaGFkZXJQcm9ncmFtRnVuY3Rpb24sXG4gICAgICBjcmVhdGVTaGFkZXJQcm9ncmFtXG4gICAgKTtcbiAgICBzcEZ1bmModGhpcywgZnJhbWVTdGF0ZSwgYXBwZWFyYW5jZSk7XG4gIH1cblxuICBpZiAoY3JlYXRlUlMgfHwgY3JlYXRlU1ApIHtcbiAgICB2YXIgY29tbWFuZEZ1bmMgPSBkZWZhdWx0VmFsdWUoXG4gICAgICB0aGlzLl9jcmVhdGVDb21tYW5kc0Z1bmN0aW9uLFxuICAgICAgY3JlYXRlQ29tbWFuZHNcbiAgICApO1xuICAgIGNvbW1hbmRGdW5jKFxuICAgICAgdGhpcyxcbiAgICAgIGFwcGVhcmFuY2UsXG4gICAgICBtYXRlcmlhbCxcbiAgICAgIHRyYW5zbHVjZW50LFxuICAgICAgdHdvUGFzc2VzLFxuICAgICAgdGhpcy5fY29sb3JDb21tYW5kcyxcbiAgICAgIHRoaXMuX3BpY2tDb21tYW5kcyxcbiAgICAgIGZyYW1lU3RhdGVcbiAgICApO1xuICB9XG5cbiAgdmFyIHVwZGF0ZUFuZFF1ZXVlQ29tbWFuZHNGdW5jID0gZGVmYXVsdFZhbHVlKFxuICAgIHRoaXMuX3VwZGF0ZUFuZFF1ZXVlQ29tbWFuZHNGdW5jdGlvbixcbiAgICB1cGRhdGVBbmRRdWV1ZUNvbW1hbmRzXG4gICk7XG4gIHVwZGF0ZUFuZFF1ZXVlQ29tbWFuZHNGdW5jKFxuICAgIHRoaXMsXG4gICAgZnJhbWVTdGF0ZSxcbiAgICB0aGlzLl9jb2xvckNvbW1hbmRzLFxuICAgIHRoaXMuX3BpY2tDb21tYW5kcyxcbiAgICB0aGlzLm1vZGVsTWF0cml4LFxuICAgIHRoaXMuY3VsbCxcbiAgICB0aGlzLmRlYnVnU2hvd0JvdW5kaW5nVm9sdW1lLFxuICAgIHR3b1Bhc3Nlc1xuICApO1xufTtcblxudmFyIG9mZnNldEJvdW5kaW5nU3BoZXJlU2NyYXRjaDEgPSBuZXcgQm91bmRpbmdTcGhlcmUoKTtcbnZhciBvZmZzZXRCb3VuZGluZ1NwaGVyZVNjcmF0Y2gyID0gbmV3IEJvdW5kaW5nU3BoZXJlKCk7XG5mdW5jdGlvbiB0cmFuc2Zvcm1Cb3VuZGluZ1NwaGVyZShib3VuZGluZ1NwaGVyZSwgb2Zmc2V0LCBvZmZzZXRBdHRyaWJ1dGUpIHtcbiAgaWYgKG9mZnNldEF0dHJpYnV0ZSA9PT0gR2VvbWV0cnlPZmZzZXRBdHRyaWJ1dGUuVE9QKSB7XG4gICAgdmFyIG9yaWdCUyA9IEJvdW5kaW5nU3BoZXJlLmNsb25lKFxuICAgICAgYm91bmRpbmdTcGhlcmUsXG4gICAgICBvZmZzZXRCb3VuZGluZ1NwaGVyZVNjcmF0Y2gxXG4gICAgKTtcbiAgICB2YXIgb2Zmc2V0QlMgPSBCb3VuZGluZ1NwaGVyZS5jbG9uZShcbiAgICAgIGJvdW5kaW5nU3BoZXJlLFxuICAgICAgb2Zmc2V0Qm91bmRpbmdTcGhlcmVTY3JhdGNoMlxuICAgICk7XG4gICAgb2Zmc2V0QlMuY2VudGVyID0gQ2FydGVzaWFuMy5hZGQob2Zmc2V0QlMuY2VudGVyLCBvZmZzZXQsIG9mZnNldEJTLmNlbnRlcik7XG4gICAgYm91bmRpbmdTcGhlcmUgPSBCb3VuZGluZ1NwaGVyZS51bmlvbihvcmlnQlMsIG9mZnNldEJTLCBib3VuZGluZ1NwaGVyZSk7XG4gIH0gZWxzZSBpZiAob2Zmc2V0QXR0cmlidXRlID09PSBHZW9tZXRyeU9mZnNldEF0dHJpYnV0ZS5BTEwpIHtcbiAgICBib3VuZGluZ1NwaGVyZS5jZW50ZXIgPSBDYXJ0ZXNpYW4zLmFkZChcbiAgICAgIGJvdW5kaW5nU3BoZXJlLmNlbnRlcixcbiAgICAgIG9mZnNldCxcbiAgICAgIGJvdW5kaW5nU3BoZXJlLmNlbnRlclxuICAgICk7XG4gIH1cblxuICByZXR1cm4gYm91bmRpbmdTcGhlcmU7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUdldEZ1bmN0aW9uKGJhdGNoVGFibGUsIGluc3RhbmNlSW5kZXgsIGF0dHJpYnV0ZUluZGV4KSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGF0dHJpYnV0ZVZhbHVlID0gYmF0Y2hUYWJsZS5nZXRCYXRjaGVkQXR0cmlidXRlKFxuICAgICAgaW5zdGFuY2VJbmRleCxcbiAgICAgIGF0dHJpYnV0ZUluZGV4XG4gICAgKTtcbiAgICB2YXIgYXR0cmlidXRlID0gYmF0Y2hUYWJsZS5hdHRyaWJ1dGVzW2F0dHJpYnV0ZUluZGV4XTtcbiAgICB2YXIgY29tcG9uZW50c1BlckF0dHJpYnV0ZSA9IGF0dHJpYnV0ZS5jb21wb25lbnRzUGVyQXR0cmlidXRlO1xuICAgIHZhciB2YWx1ZSA9IENvbXBvbmVudERhdGF0eXBlLmNyZWF0ZVR5cGVkQXJyYXkoXG4gICAgICBhdHRyaWJ1dGUuY29tcG9uZW50RGF0YXR5cGUsXG4gICAgICBjb21wb25lbnRzUGVyQXR0cmlidXRlXG4gICAgKTtcbiAgICBpZiAoZGVmaW5lZChhdHRyaWJ1dGVWYWx1ZS5jb25zdHJ1Y3Rvci5wYWNrKSkge1xuICAgICAgYXR0cmlidXRlVmFsdWUuY29uc3RydWN0b3IucGFjayhhdHRyaWJ1dGVWYWx1ZSwgdmFsdWUsIDApO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZVswXSA9IGF0dHJpYnV0ZVZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVNldEZ1bmN0aW9uKFxuICBiYXRjaFRhYmxlLFxuICBpbnN0YW5jZUluZGV4LFxuICBhdHRyaWJ1dGVJbmRleCxcbiAgcHJpbWl0aXZlLFxuICBuYW1lXG4pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gICAgaWYgKFxuICAgICAgIWRlZmluZWQodmFsdWUpIHx8XG4gICAgICAhZGVmaW5lZCh2YWx1ZS5sZW5ndGgpIHx8XG4gICAgICB2YWx1ZS5sZW5ndGggPCAxIHx8XG4gICAgICB2YWx1ZS5sZW5ndGggPiA0XG4gICAgKSB7XG4gICAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgICAgIFwidmFsdWUgbXVzdCBiZSBhbmQgYXJyYXkgd2l0aCBsZW5ndGggYmV0d2VlbiAxIGFuZCA0LlwiXG4gICAgICApO1xuICAgIH1cbiAgICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcbiAgICB2YXIgYXR0cmlidXRlVmFsdWUgPSBnZXRBdHRyaWJ1dGVWYWx1ZSh2YWx1ZSk7XG4gICAgYmF0Y2hUYWJsZS5zZXRCYXRjaGVkQXR0cmlidXRlKFxuICAgICAgaW5zdGFuY2VJbmRleCxcbiAgICAgIGF0dHJpYnV0ZUluZGV4LFxuICAgICAgYXR0cmlidXRlVmFsdWVcbiAgICApO1xuICAgIGlmIChuYW1lID09PSBcIm9mZnNldFwiKSB7XG4gICAgICBwcmltaXRpdmUuX3JlY29tcHV0ZUJvdW5kaW5nU3BoZXJlcyA9IHRydWU7XG4gICAgICBwcmltaXRpdmUuX2JhdGNoVGFibGVPZmZzZXRzVXBkYXRlZCA9IGZhbHNlO1xuICAgIH1cbiAgfTtcbn1cblxudmFyIG9mZnNldFNjcmF0Y2ggPSBuZXcgQ2FydGVzaWFuMygpO1xuXG5mdW5jdGlvbiBjcmVhdGVCb3VuZGluZ1NwaGVyZVByb3BlcnRpZXMocHJpbWl0aXZlLCBwcm9wZXJ0aWVzLCBpbmRleCkge1xuICBwcm9wZXJ0aWVzLmJvdW5kaW5nU3BoZXJlID0ge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGJvdW5kaW5nU3BoZXJlID0gcHJpbWl0aXZlLl9pbnN0YW5jZUJvdW5kaW5nU3BoZXJlc1tpbmRleF07XG4gICAgICBpZiAoZGVmaW5lZChib3VuZGluZ1NwaGVyZSkpIHtcbiAgICAgICAgYm91bmRpbmdTcGhlcmUgPSBib3VuZGluZ1NwaGVyZS5jbG9uZSgpO1xuICAgICAgICB2YXIgbW9kZWxNYXRyaXggPSBwcmltaXRpdmUubW9kZWxNYXRyaXg7XG4gICAgICAgIHZhciBvZmZzZXQgPSBwcm9wZXJ0aWVzLm9mZnNldDtcbiAgICAgICAgaWYgKGRlZmluZWQob2Zmc2V0KSkge1xuICAgICAgICAgIHRyYW5zZm9ybUJvdW5kaW5nU3BoZXJlKFxuICAgICAgICAgICAgYm91bmRpbmdTcGhlcmUsXG4gICAgICAgICAgICBDYXJ0ZXNpYW4zLmZyb21BcnJheShvZmZzZXQuZ2V0KCksIDAsIG9mZnNldFNjcmF0Y2gpLFxuICAgICAgICAgICAgcHJpbWl0aXZlLl9vZmZzZXRJbnN0YW5jZUV4dGVuZFtpbmRleF1cbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWZpbmVkKG1vZGVsTWF0cml4KSkge1xuICAgICAgICAgIGJvdW5kaW5nU3BoZXJlID0gQm91bmRpbmdTcGhlcmUudHJhbnNmb3JtKFxuICAgICAgICAgICAgYm91bmRpbmdTcGhlcmUsXG4gICAgICAgICAgICBtb2RlbE1hdHJpeFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGJvdW5kaW5nU3BoZXJlO1xuICAgIH0sXG4gIH07XG4gIHByb3BlcnRpZXMuYm91bmRpbmdTcGhlcmVDViA9IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBwcmltaXRpdmUuX2luc3RhbmNlQm91bmRpbmdTcGhlcmVzQ1ZbaW5kZXhdO1xuICAgIH0sXG4gIH07XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVBpY2tJZFByb3BlcnR5KHByaW1pdGl2ZSwgcHJvcGVydGllcywgaW5kZXgpIHtcbiAgcHJvcGVydGllcy5waWNrSWQgPSB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcHJpbWl0aXZlLl9waWNrSWRzW2luZGV4XTtcbiAgICB9LFxuICB9O1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIG1vZGlmaWFibGUgcGVyLWluc3RhbmNlIGF0dHJpYnV0ZXMgZm9yIGEge0BsaW5rIEdlb21ldHJ5SW5zdGFuY2V9LlxuICpcbiAqIEBwYXJhbSB7Kn0gaWQgVGhlIGlkIG9mIHRoZSB7QGxpbmsgR2VvbWV0cnlJbnN0YW5jZX0uXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBUaGUgdHlwZWQgYXJyYXkgaW4gdGhlIGF0dHJpYnV0ZSdzIGZvcm1hdCBvciB1bmRlZmluZWQgaWYgdGhlIGlzIG5vIGluc3RhbmNlIHdpdGggaWQuXG4gKlxuICogQGV4Y2VwdGlvbiB7RGV2ZWxvcGVyRXJyb3J9IG11c3QgY2FsbCB1cGRhdGUgYmVmb3JlIGNhbGxpbmcgZ2V0R2VvbWV0cnlJbnN0YW5jZUF0dHJpYnV0ZXMuXG4gKlxuICogQGV4YW1wbGVcbiAqIHZhciBhdHRyaWJ1dGVzID0gcHJpbWl0aXZlLmdldEdlb21ldHJ5SW5zdGFuY2VBdHRyaWJ1dGVzKCdhbiBpZCcpO1xuICogYXR0cmlidXRlcy5jb2xvciA9IENlc2l1bS5Db2xvckdlb21ldHJ5SW5zdGFuY2VBdHRyaWJ1dGUudG9WYWx1ZShDZXNpdW0uQ29sb3IuQVFVQSk7XG4gKiBhdHRyaWJ1dGVzLnNob3cgPSBDZXNpdW0uU2hvd0dlb21ldHJ5SW5zdGFuY2VBdHRyaWJ1dGUudG9WYWx1ZSh0cnVlKTtcbiAqIGF0dHJpYnV0ZXMuZGlzdGFuY2VEaXNwbGF5Q29uZGl0aW9uID0gQ2VzaXVtLkRpc3RhbmNlRGlzcGxheUNvbmRpdGlvbkdlb21ldHJ5SW5zdGFuY2VBdHRyaWJ1dGUudG9WYWx1ZSgxMDAuMCwgMTAwMDAuMCk7XG4gKiBhdHRyaWJ1dGVzLm9mZnNldCA9IENlc2l1bS5PZmZzZXRHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlLnRvVmFsdWUoQ2FydGVzaWFuMy5JREVOVElUWSk7XG4gKi9cblByaW1pdGl2ZS5wcm90b3R5cGUuZ2V0R2VvbWV0cnlJbnN0YW5jZUF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoaWQpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgaWYgKCFkZWZpbmVkKGlkKSkge1xuICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcImlkIGlzIHJlcXVpcmVkXCIpO1xuICB9XG4gIGlmICghZGVmaW5lZCh0aGlzLl9iYXRjaFRhYmxlKSkge1xuICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcbiAgICAgIFwibXVzdCBjYWxsIHVwZGF0ZSBiZWZvcmUgY2FsbGluZyBnZXRHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlc1wiXG4gICAgKTtcbiAgfVxuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB2YXIgaW5kZXggPSAtMTtcbiAgdmFyIGxhc3RJbmRleCA9IHRoaXMuX2xhc3RQZXJJbnN0YW5jZUF0dHJpYnV0ZUluZGV4O1xuICB2YXIgaWRzID0gdGhpcy5faW5zdGFuY2VJZHM7XG4gIHZhciBsZW5ndGggPSBpZHMubGVuZ3RoO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgdmFyIGN1ckluZGV4ID0gKGxhc3RJbmRleCArIGkpICUgbGVuZ3RoO1xuICAgIGlmIChpZCA9PT0gaWRzW2N1ckluZGV4XSkge1xuICAgICAgaW5kZXggPSBjdXJJbmRleDtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgdmFyIGF0dHJpYnV0ZXMgPSB0aGlzLl9wZXJJbnN0YW5jZUF0dHJpYnV0ZUNhY2hlW2luZGV4XTtcbiAgaWYgKGRlZmluZWQoYXR0cmlidXRlcykpIHtcbiAgICByZXR1cm4gYXR0cmlidXRlcztcbiAgfVxuXG4gIHZhciBiYXRjaFRhYmxlID0gdGhpcy5fYmF0Y2hUYWJsZTtcbiAgdmFyIHBlckluc3RhbmNlQXR0cmlidXRlSW5kaWNlcyA9IHRoaXMuX2JhdGNoVGFibGVBdHRyaWJ1dGVJbmRpY2VzO1xuICBhdHRyaWJ1dGVzID0ge307XG4gIHZhciBwcm9wZXJ0aWVzID0ge307XG5cbiAgZm9yICh2YXIgbmFtZSBpbiBwZXJJbnN0YW5jZUF0dHJpYnV0ZUluZGljZXMpIHtcbiAgICBpZiAocGVySW5zdGFuY2VBdHRyaWJ1dGVJbmRpY2VzLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICB2YXIgYXR0cmlidXRlSW5kZXggPSBwZXJJbnN0YW5jZUF0dHJpYnV0ZUluZGljZXNbbmFtZV07XG4gICAgICBwcm9wZXJ0aWVzW25hbWVdID0ge1xuICAgICAgICBnZXQ6IGNyZWF0ZUdldEZ1bmN0aW9uKGJhdGNoVGFibGUsIGluZGV4LCBhdHRyaWJ1dGVJbmRleCksXG4gICAgICAgIHNldDogY3JlYXRlU2V0RnVuY3Rpb24oYmF0Y2hUYWJsZSwgaW5kZXgsIGF0dHJpYnV0ZUluZGV4LCB0aGlzLCBuYW1lKSxcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgY3JlYXRlQm91bmRpbmdTcGhlcmVQcm9wZXJ0aWVzKHRoaXMsIHByb3BlcnRpZXMsIGluZGV4KTtcbiAgY3JlYXRlUGlja0lkUHJvcGVydHkodGhpcywgcHJvcGVydGllcywgaW5kZXgpO1xuICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhhdHRyaWJ1dGVzLCBwcm9wZXJ0aWVzKTtcblxuICB0aGlzLl9sYXN0UGVySW5zdGFuY2VBdHRyaWJ1dGVJbmRleCA9IGluZGV4O1xuICB0aGlzLl9wZXJJbnN0YW5jZUF0dHJpYnV0ZUNhY2hlW2luZGV4XSA9IGF0dHJpYnV0ZXM7XG4gIHJldHVybiBhdHRyaWJ1dGVzO1xufTtcblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBvYmplY3Qgd2FzIGRlc3Ryb3llZDsgb3RoZXJ3aXNlLCBmYWxzZS5cbiAqIDxwPlxuICogSWYgdGhpcyBvYmplY3Qgd2FzIGRlc3Ryb3llZCwgaXQgc2hvdWxkIG5vdCBiZSB1c2VkOyBjYWxsaW5nIGFueSBmdW5jdGlvbiBvdGhlciB0aGFuXG4gKiA8Y29kZT5pc0Rlc3Ryb3llZDwvY29kZT4gd2lsbCByZXN1bHQgaW4gYSB7QGxpbmsgRGV2ZWxvcGVyRXJyb3J9IGV4Y2VwdGlvbi5cbiAqIDwvcD5cbiAqXG4gKiBAcmV0dXJucyB7Qm9vbGVhbn0gPGNvZGU+dHJ1ZTwvY29kZT4gaWYgdGhpcyBvYmplY3Qgd2FzIGRlc3Ryb3llZDsgb3RoZXJ3aXNlLCA8Y29kZT5mYWxzZTwvY29kZT4uXG4gKlxuICogQHNlZSBQcmltaXRpdmUjZGVzdHJveVxuICovXG5QcmltaXRpdmUucHJvdG90eXBlLmlzRGVzdHJveWVkID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gZmFsc2U7XG59O1xuXG4vKipcbiAqIERlc3Ryb3lzIHRoZSBXZWJHTCByZXNvdXJjZXMgaGVsZCBieSB0aGlzIG9iamVjdC4gIERlc3Ryb3lpbmcgYW4gb2JqZWN0IGFsbG93cyBmb3IgZGV0ZXJtaW5pc3RpY1xuICogcmVsZWFzZSBvZiBXZWJHTCByZXNvdXJjZXMsIGluc3RlYWQgb2YgcmVseWluZyBvbiB0aGUgZ2FyYmFnZSBjb2xsZWN0b3IgdG8gZGVzdHJveSB0aGlzIG9iamVjdC5cbiAqIDxwPlxuICogT25jZSBhbiBvYmplY3QgaXMgZGVzdHJveWVkLCBpdCBzaG91bGQgbm90IGJlIHVzZWQ7IGNhbGxpbmcgYW55IGZ1bmN0aW9uIG90aGVyIHRoYW5cbiAqIDxjb2RlPmlzRGVzdHJveWVkPC9jb2RlPiB3aWxsIHJlc3VsdCBpbiBhIHtAbGluayBEZXZlbG9wZXJFcnJvcn0gZXhjZXB0aW9uLiAgVGhlcmVmb3JlLFxuICogYXNzaWduIHRoZSByZXR1cm4gdmFsdWUgKDxjb2RlPnVuZGVmaW5lZDwvY29kZT4pIHRvIHRoZSBvYmplY3QgYXMgZG9uZSBpbiB0aGUgZXhhbXBsZS5cbiAqIDwvcD5cbiAqXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gVGhpcyBvYmplY3Qgd2FzIGRlc3Ryb3llZCwgaS5lLiwgZGVzdHJveSgpIHdhcyBjYWxsZWQuXG4gKlxuICpcbiAqIEBleGFtcGxlXG4gKiBlID0gZSAmJiBlLmRlc3Ryb3koKTtcbiAqXG4gKiBAc2VlIFByaW1pdGl2ZSNpc0Rlc3Ryb3llZFxuICovXG5QcmltaXRpdmUucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBsZW5ndGg7XG4gIHZhciBpO1xuXG4gIHRoaXMuX3NwID0gdGhpcy5fc3AgJiYgdGhpcy5fc3AuZGVzdHJveSgpO1xuICB0aGlzLl9zcERlcHRoRmFpbCA9IHRoaXMuX3NwRGVwdGhGYWlsICYmIHRoaXMuX3NwRGVwdGhGYWlsLmRlc3Ryb3koKTtcblxuICB2YXIgdmEgPSB0aGlzLl92YTtcbiAgbGVuZ3RoID0gdmEubGVuZ3RoO1xuICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICB2YVtpXS5kZXN0cm95KCk7XG4gIH1cbiAgdGhpcy5fdmEgPSB1bmRlZmluZWQ7XG5cbiAgdmFyIHBpY2tJZHMgPSB0aGlzLl9waWNrSWRzO1xuICBsZW5ndGggPSBwaWNrSWRzLmxlbmd0aDtcbiAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgcGlja0lkc1tpXS5kZXN0cm95KCk7XG4gIH1cbiAgdGhpcy5fcGlja0lkcyA9IHVuZGVmaW5lZDtcblxuICB0aGlzLl9iYXRjaFRhYmxlID0gdGhpcy5fYmF0Y2hUYWJsZSAmJiB0aGlzLl9iYXRjaFRhYmxlLmRlc3Ryb3koKTtcblxuICAvL1RoZXNlIG9iamVjdHMgbWF5IGJlIGZhaXJseSBsYXJnZSBhbmQgcmVmZXJlbmNlIG90aGVyIGxhcmdlIG9iamVjdHMgKGxpa2UgRW50aXRpZXMpXG4gIC8vV2UgZXhwbGljaXRseSBzZXQgdGhlbSB0byB1bmRlZmluZWQgaGVyZSBzbyB0aGF0IHRoZSBtZW1vcnkgY2FuIGJlIGZyZWVkXG4gIC8vZXZlbiBpZiBhIHJlZmVyZW5jZSB0byB0aGUgZGVzdHJveWVkIFByaW1pdGl2ZSBoYXMgYmVlbiBrZXB0IGFyb3VuZC5cbiAgdGhpcy5faW5zdGFuY2VJZHMgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX3Blckluc3RhbmNlQXR0cmlidXRlQ2FjaGUgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2F0dHJpYnV0ZUxvY2F0aW9ucyA9IHVuZGVmaW5lZDtcblxuICByZXR1cm4gZGVzdHJveU9iamVjdCh0aGlzKTtcbn07XG5cbmZ1bmN0aW9uIHNldFJlYWR5KHByaW1pdGl2ZSwgZnJhbWVTdGF0ZSwgc3RhdGUsIGVycm9yKSB7XG4gIHByaW1pdGl2ZS5fZXJyb3IgPSBlcnJvcjtcbiAgcHJpbWl0aXZlLl9zdGF0ZSA9IHN0YXRlO1xuICBmcmFtZVN0YXRlLmFmdGVyUmVuZGVyLnB1c2goZnVuY3Rpb24gKCkge1xuICAgIHByaW1pdGl2ZS5fcmVhZHkgPVxuICAgICAgcHJpbWl0aXZlLl9zdGF0ZSA9PT0gUHJpbWl0aXZlU3RhdGUuQ09NUExFVEUgfHxcbiAgICAgIHByaW1pdGl2ZS5fc3RhdGUgPT09IFByaW1pdGl2ZVN0YXRlLkZBSUxFRDtcbiAgICBpZiAoIWRlZmluZWQoZXJyb3IpKSB7XG4gICAgICBwcmltaXRpdmUuX3JlYWR5UHJvbWlzZS5yZXNvbHZlKHByaW1pdGl2ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHByaW1pdGl2ZS5fcmVhZHlQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgfVxuICB9KTtcbn1cbmV4cG9ydCBkZWZhdWx0IFByaW1pdGl2ZTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///34380\n')},73316:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_createGuid_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(39960);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(82982);\n/* harmony import */ var _Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(86511);\n/* harmony import */ var _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12572);\n\n\n\n\n\n\n/**\n * A collection of primitives.  This is most often used with {@link Scene#primitives},\n * but <code>PrimitiveCollection</code> is also a primitive itself so collections can\n * be added to collections forming a hierarchy.\n *\n * @alias PrimitiveCollection\n * @constructor\n *\n * @param {Object} [options] Object with the following properties:\n * @param {Boolean} [options.show=true] Determines if the primitives in the collection will be shown.\n * @param {Boolean} [options.destroyPrimitives=true] Determines if primitives in the collection are destroyed when they are removed.\n *\n * @example\n * var billboards = new Cesium.BillboardCollection();\n * var labels = new Cesium.LabelCollection();\n *\n * var collection = new Cesium.PrimitiveCollection();\n * collection.add(billboards);\n *\n * scene.primitives.add(collection);  // Add collection\n * scene.primitives.add(labels);      // Add regular primitive\n */\nfunction PrimitiveCollection(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n\n  this._primitives = [];\n  this._guid = (0,_Core_createGuid_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)();\n\n  // Used by the OrderedGroundPrimitiveCollection\n  this._zIndex = undefined;\n\n  /**\n   * Determines if primitives in this collection will be shown.\n   *\n   * @type {Boolean}\n   * @default true\n   */\n  this.show = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options.show, true);\n\n  /**\n   * Determines if primitives in the collection are destroyed when they are removed by\n   * {@link PrimitiveCollection#destroy} or  {@link PrimitiveCollection#remove} or implicitly\n   * by {@link PrimitiveCollection#removeAll}.\n   *\n   * @type {Boolean}\n   * @default true\n   *\n   * @example\n   * // Example 1. Primitives are destroyed by default.\n   * var primitives = new Cesium.PrimitiveCollection();\n   * var labels = primitives.add(new Cesium.LabelCollection());\n   * primitives = primitives.destroy();\n   * var b = labels.isDestroyed(); // true\n   *\n   * @example\n   * // Example 2. Do not destroy primitives in a collection.\n   * var primitives = new Cesium.PrimitiveCollection();\n   * primitives.destroyPrimitives = false;\n   * var labels = primitives.add(new Cesium.LabelCollection());\n   * primitives = primitives.destroy();\n   * var b = labels.isDestroyed(); // false\n   * labels = labels.destroy();    // explicitly destroy\n   */\n  this.destroyPrimitives = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options.destroyPrimitives, true);\n}\n\nObject.defineProperties(PrimitiveCollection.prototype, {\n  /**\n   * Gets the number of primitives in the collection.\n   *\n   * @memberof PrimitiveCollection.prototype\n   *\n   * @type {Number}\n   * @readonly\n   */\n  length: {\n    get: function () {\n      return this._primitives.length;\n    },\n  },\n});\n\n/**\n * Adds a primitive to the collection.\n *\n * @param {Object} primitive The primitive to add.\n * @param {Number} [index] The index to add the layer at.  If omitted, the primitive will be added at the bottom of all existing primitives.\n * @returns {Object} The primitive added to the collection.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n * @example\n * var billboards = scene.primitives.add(new Cesium.BillboardCollection());\n */\nPrimitiveCollection.prototype.add = function (primitive, index) {\n  var hasIndex = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(index);\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(primitive)) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z("primitive is required.");\n  }\n  if (hasIndex) {\n    if (index < 0) {\n      throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z("index must be greater than or equal to zero.");\n    } else if (index > this._primitives.length) {\n      throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(\n        "index must be less than or equal to the number of primitives."\n      );\n    }\n  }\n  //>>includeEnd(\'debug\');\n\n  var external = (primitive._external = primitive._external || {});\n  var composites = (external._composites = external._composites || {});\n  composites[this._guid] = {\n    collection: this,\n  };\n\n  if (!hasIndex) {\n    this._primitives.push(primitive);\n  } else {\n    this._primitives.splice(index, 0, primitive);\n  }\n\n  return primitive;\n};\n\n/**\n * Removes a primitive from the collection.\n *\n * @param {Object} [primitive] The primitive to remove.\n * @returns {Boolean} <code>true</code> if the primitive was removed; <code>false</code> if the primitive is <code>undefined</code> or was not found in the collection.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n *\n * @example\n * var billboards = scene.primitives.add(new Cesium.BillboardCollection());\n * scene.primitives.remove(billboards);  // Returns true\n *\n * @see PrimitiveCollection#destroyPrimitives\n */\nPrimitiveCollection.prototype.remove = function (primitive) {\n  // PERFORMANCE_IDEA:  We can obviously make this a lot faster.\n  if (this.contains(primitive)) {\n    var index = this._primitives.indexOf(primitive);\n    if (index !== -1) {\n      this._primitives.splice(index, 1);\n\n      delete primitive._external._composites[this._guid];\n\n      if (this.destroyPrimitives) {\n        primitive.destroy();\n      }\n\n      return true;\n    }\n    // else ... this is not possible, I swear.\n  }\n\n  return false;\n};\n\n/**\n * Removes and destroys a primitive, regardless of destroyPrimitives setting.\n * @private\n */\nPrimitiveCollection.prototype.removeAndDestroy = function (primitive) {\n  var removed = this.remove(primitive);\n  if (removed && !this.destroyPrimitives) {\n    primitive.destroy();\n  }\n  return removed;\n};\n\n/**\n * Removes all primitives in the collection.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n * @see PrimitiveCollection#destroyPrimitives\n */\nPrimitiveCollection.prototype.removeAll = function () {\n  var primitives = this._primitives;\n  var length = primitives.length;\n  for (var i = 0; i < length; ++i) {\n    delete primitives[i]._external._composites[this._guid];\n    if (this.destroyPrimitives) {\n      primitives[i].destroy();\n    }\n  }\n  this._primitives = [];\n};\n\n/**\n * Determines if this collection contains a primitive.\n *\n * @param {Object} [primitive] The primitive to check for.\n * @returns {Boolean} <code>true</code> if the primitive is in the collection; <code>false</code> if the primitive is <code>undefined</code> or was not found in the collection.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n * @see PrimitiveCollection#get\n */\nPrimitiveCollection.prototype.contains = function (primitive) {\n  return !!(\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(primitive) &&\n    primitive._external &&\n    primitive._external._composites &&\n    primitive._external._composites[this._guid]\n  );\n};\n\nfunction getPrimitiveIndex(compositePrimitive, primitive) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (!compositePrimitive.contains(primitive)) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z("primitive is not in this collection.");\n  }\n  //>>includeEnd(\'debug\');\n\n  return compositePrimitive._primitives.indexOf(primitive);\n}\n\n/**\n * Raises a primitive "up one" in the collection.  If all primitives in the collection are drawn\n * on the globe surface, this visually moves the primitive up one.\n *\n * @param {Object} [primitive] The primitive to raise.\n *\n * @exception {DeveloperError} primitive is not in this collection.\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n * @see PrimitiveCollection#raiseToTop\n * @see PrimitiveCollection#lower\n * @see PrimitiveCollection#lowerToBottom\n */\nPrimitiveCollection.prototype.raise = function (primitive) {\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(primitive)) {\n    var index = getPrimitiveIndex(this, primitive);\n    var primitives = this._primitives;\n\n    if (index !== primitives.length - 1) {\n      var p = primitives[index];\n      primitives[index] = primitives[index + 1];\n      primitives[index + 1] = p;\n    }\n  }\n};\n\n/**\n * Raises a primitive to the "top" of the collection.  If all primitives in the collection are drawn\n * on the globe surface, this visually moves the primitive to the top.\n *\n * @param {Object} [primitive] The primitive to raise the top.\n *\n * @exception {DeveloperError} primitive is not in this collection.\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n * @see PrimitiveCollection#raise\n * @see PrimitiveCollection#lower\n * @see PrimitiveCollection#lowerToBottom\n */\nPrimitiveCollection.prototype.raiseToTop = function (primitive) {\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(primitive)) {\n    var index = getPrimitiveIndex(this, primitive);\n    var primitives = this._primitives;\n\n    if (index !== primitives.length - 1) {\n      // PERFORMANCE_IDEA:  Could be faster\n      primitives.splice(index, 1);\n      primitives.push(primitive);\n    }\n  }\n};\n\n/**\n * Lowers a primitive "down one" in the collection.  If all primitives in the collection are drawn\n * on the globe surface, this visually moves the primitive down one.\n *\n * @param {Object} [primitive] The primitive to lower.\n *\n * @exception {DeveloperError} primitive is not in this collection.\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n * @see PrimitiveCollection#lowerToBottom\n * @see PrimitiveCollection#raise\n * @see PrimitiveCollection#raiseToTop\n */\nPrimitiveCollection.prototype.lower = function (primitive) {\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(primitive)) {\n    var index = getPrimitiveIndex(this, primitive);\n    var primitives = this._primitives;\n\n    if (index !== 0) {\n      var p = primitives[index];\n      primitives[index] = primitives[index - 1];\n      primitives[index - 1] = p;\n    }\n  }\n};\n\n/**\n * Lowers a primitive to the "bottom" of the collection.  If all primitives in the collection are drawn\n * on the globe surface, this visually moves the primitive to the bottom.\n *\n * @param {Object} [primitive] The primitive to lower to the bottom.\n *\n * @exception {DeveloperError} primitive is not in this collection.\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n * @see PrimitiveCollection#lower\n * @see PrimitiveCollection#raise\n * @see PrimitiveCollection#raiseToTop\n */\nPrimitiveCollection.prototype.lowerToBottom = function (primitive) {\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(primitive)) {\n    var index = getPrimitiveIndex(this, primitive);\n    var primitives = this._primitives;\n\n    if (index !== 0) {\n      // PERFORMANCE_IDEA:  Could be faster\n      primitives.splice(index, 1);\n      primitives.unshift(primitive);\n    }\n  }\n};\n\n/**\n * Returns the primitive in the collection at the specified index.\n *\n * @param {Number} index The zero-based index of the primitive to return.\n * @returns {Object} The primitive at the <code>index</code>.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n *\n * @example\n * // Toggle the show property of every primitive in the collection.\n * var primitives = scene.primitives;\n * var length = primitives.length;\n * for (var i = 0; i < length; ++i) {\n *   var p = primitives.get(i);\n *   p.show = !p.show;\n * }\n *\n * @see PrimitiveCollection#length\n */\nPrimitiveCollection.prototype.get = function (index) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(index)) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z("index is required.");\n  }\n  //>>includeEnd(\'debug\');\n\n  return this._primitives[index];\n};\n\n/**\n * @private\n */\nPrimitiveCollection.prototype.update = function (frameState) {\n  if (!this.show) {\n    return;\n  }\n\n  var primitives = this._primitives;\n  // Using primitives.length in the loop is a temporary workaround\n  // to allow quadtree updates to add and remove primitives in\n  // update().  This will be changed to manage added and removed lists.\n  for (var i = 0; i < primitives.length; ++i) {\n    primitives[i].update(frameState);\n  }\n};\n\n/**\n * @private\n */\nPrimitiveCollection.prototype.prePassesUpdate = function (frameState) {\n  var primitives = this._primitives;\n  // Using primitives.length in the loop is a temporary workaround\n  // to allow quadtree updates to add and remove primitives in\n  // update().  This will be changed to manage added and removed lists.\n  for (var i = 0; i < primitives.length; ++i) {\n    var primitive = primitives[i];\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(primitive.prePassesUpdate)) {\n      primitive.prePassesUpdate(frameState);\n    }\n  }\n};\n\n/**\n * @private\n */\nPrimitiveCollection.prototype.updateForPass = function (frameState, passState) {\n  var primitives = this._primitives;\n  // Using primitives.length in the loop is a temporary workaround\n  // to allow quadtree updates to add and remove primitives in\n  // update().  This will be changed to manage added and removed lists.\n  for (var i = 0; i < primitives.length; ++i) {\n    var primitive = primitives[i];\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(primitive.updateForPass)) {\n      primitive.updateForPass(frameState, passState);\n    }\n  }\n};\n\n/**\n * @private\n */\nPrimitiveCollection.prototype.postPassesUpdate = function (frameState) {\n  var primitives = this._primitives;\n  // Using primitives.length in the loop is a temporary workaround\n  // to allow quadtree updates to add and remove primitives in\n  // update().  This will be changed to manage added and removed lists.\n  for (var i = 0; i < primitives.length; ++i) {\n    var primitive = primitives[i];\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(primitive.postPassesUpdate)) {\n      primitive.postPassesUpdate(frameState);\n    }\n  }\n};\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <br /><br />\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n *\n * @returns {Boolean} True if this object was destroyed; otherwise, false.\n *\n * @see PrimitiveCollection#destroy\n */\nPrimitiveCollection.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the WebGL resources held by each primitive in this collection.  Explicitly destroying this\n * collection allows for deterministic release of WebGL resources, instead of relying on the garbage\n * collector to destroy this collection.\n * <br /><br />\n * Since destroying a collection destroys all the contained primitives, only destroy a collection\n * when you are sure no other code is still using any of the contained primitives.\n * <br /><br />\n * Once this collection is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n *\n * @example\n * primitives = primitives && primitives.destroy();\n *\n * @see PrimitiveCollection#isDestroyed\n */\nPrimitiveCollection.prototype.destroy = function () {\n  this.removeAll();\n  return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(this);\n};\n/* harmony default export */ __webpack_exports__["Z"] = (PrimitiveCollection);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsdUJBQXVCO0FBQ3pDO0FBQ0EsUUFBUSxxRUFBTztBQUNmO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsdUJBQXVCO0FBQ3pDO0FBQ0EsUUFBUSxxRUFBTztBQUNmO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsOENBQThDO0FBQzlDO0FBQ0Esd0RBQXdEO0FBQ3hELDhDQUE4QyxzQkFBc0I7QUFDcEU7QUFDQSxhQUFhLFNBQVMsbUNBQW1DO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZEO0FBQzdELDhDQUE4QyxzQkFBc0I7QUFDcEU7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsMkVBQWE7QUFDdEI7QUFDQSx5REFBZSxtQkFBbUIsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9TY2VuZS9QcmltaXRpdmVDb2xsZWN0aW9uLmpzPzNmY2IiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNyZWF0ZUd1aWQgZnJvbSBcIi4uL0NvcmUvY3JlYXRlR3VpZC5qc1wiO1xuaW1wb3J0IGRlZmF1bHRWYWx1ZSBmcm9tIFwiLi4vQ29yZS9kZWZhdWx0VmFsdWUuanNcIjtcbmltcG9ydCBkZWZpbmVkIGZyb20gXCIuLi9Db3JlL2RlZmluZWQuanNcIjtcbmltcG9ydCBkZXN0cm95T2JqZWN0IGZyb20gXCIuLi9Db3JlL2Rlc3Ryb3lPYmplY3QuanNcIjtcbmltcG9ydCBEZXZlbG9wZXJFcnJvciBmcm9tIFwiLi4vQ29yZS9EZXZlbG9wZXJFcnJvci5qc1wiO1xuXG4vKipcbiAqIEEgY29sbGVjdGlvbiBvZiBwcmltaXRpdmVzLiAgVGhpcyBpcyBtb3N0IG9mdGVuIHVzZWQgd2l0aCB7QGxpbmsgU2NlbmUjcHJpbWl0aXZlc30sXG4gKiBidXQgPGNvZGU+UHJpbWl0aXZlQ29sbGVjdGlvbjwvY29kZT4gaXMgYWxzbyBhIHByaW1pdGl2ZSBpdHNlbGYgc28gY29sbGVjdGlvbnMgY2FuXG4gKiBiZSBhZGRlZCB0byBjb2xsZWN0aW9ucyBmb3JtaW5nIGEgaGllcmFyY2h5LlxuICpcbiAqIEBhbGlhcyBQcmltaXRpdmVDb2xsZWN0aW9uXG4gKiBAY29uc3RydWN0b3JcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIE9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuc2hvdz10cnVlXSBEZXRlcm1pbmVzIGlmIHRoZSBwcmltaXRpdmVzIGluIHRoZSBjb2xsZWN0aW9uIHdpbGwgYmUgc2hvd24uXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmRlc3Ryb3lQcmltaXRpdmVzPXRydWVdIERldGVybWluZXMgaWYgcHJpbWl0aXZlcyBpbiB0aGUgY29sbGVjdGlvbiBhcmUgZGVzdHJveWVkIHdoZW4gdGhleSBhcmUgcmVtb3ZlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogdmFyIGJpbGxib2FyZHMgPSBuZXcgQ2VzaXVtLkJpbGxib2FyZENvbGxlY3Rpb24oKTtcbiAqIHZhciBsYWJlbHMgPSBuZXcgQ2VzaXVtLkxhYmVsQ29sbGVjdGlvbigpO1xuICpcbiAqIHZhciBjb2xsZWN0aW9uID0gbmV3IENlc2l1bS5QcmltaXRpdmVDb2xsZWN0aW9uKCk7XG4gKiBjb2xsZWN0aW9uLmFkZChiaWxsYm9hcmRzKTtcbiAqXG4gKiBzY2VuZS5wcmltaXRpdmVzLmFkZChjb2xsZWN0aW9uKTsgIC8vIEFkZCBjb2xsZWN0aW9uXG4gKiBzY2VuZS5wcmltaXRpdmVzLmFkZChsYWJlbHMpOyAgICAgIC8vIEFkZCByZWd1bGFyIHByaW1pdGl2ZVxuICovXG5mdW5jdGlvbiBQcmltaXRpdmVDb2xsZWN0aW9uKG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLCBkZWZhdWx0VmFsdWUuRU1QVFlfT0JKRUNUKTtcblxuICB0aGlzLl9wcmltaXRpdmVzID0gW107XG4gIHRoaXMuX2d1aWQgPSBjcmVhdGVHdWlkKCk7XG5cbiAgLy8gVXNlZCBieSB0aGUgT3JkZXJlZEdyb3VuZFByaW1pdGl2ZUNvbGxlY3Rpb25cbiAgdGhpcy5fekluZGV4ID0gdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIGlmIHByaW1pdGl2ZXMgaW4gdGhpcyBjb2xsZWN0aW9uIHdpbGwgYmUgc2hvd24uXG4gICAqXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKiBAZGVmYXVsdCB0cnVlXG4gICAqL1xuICB0aGlzLnNob3cgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5zaG93LCB0cnVlKTtcblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiBwcmltaXRpdmVzIGluIHRoZSBjb2xsZWN0aW9uIGFyZSBkZXN0cm95ZWQgd2hlbiB0aGV5IGFyZSByZW1vdmVkIGJ5XG4gICAqIHtAbGluayBQcmltaXRpdmVDb2xsZWN0aW9uI2Rlc3Ryb3l9IG9yICB7QGxpbmsgUHJpbWl0aXZlQ29sbGVjdGlvbiNyZW1vdmV9IG9yIGltcGxpY2l0bHlcbiAgICogYnkge0BsaW5rIFByaW1pdGl2ZUNvbGxlY3Rpb24jcmVtb3ZlQWxsfS5cbiAgICpcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqIEBkZWZhdWx0IHRydWVcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogLy8gRXhhbXBsZSAxLiBQcmltaXRpdmVzIGFyZSBkZXN0cm95ZWQgYnkgZGVmYXVsdC5cbiAgICogdmFyIHByaW1pdGl2ZXMgPSBuZXcgQ2VzaXVtLlByaW1pdGl2ZUNvbGxlY3Rpb24oKTtcbiAgICogdmFyIGxhYmVscyA9IHByaW1pdGl2ZXMuYWRkKG5ldyBDZXNpdW0uTGFiZWxDb2xsZWN0aW9uKCkpO1xuICAgKiBwcmltaXRpdmVzID0gcHJpbWl0aXZlcy5kZXN0cm95KCk7XG4gICAqIHZhciBiID0gbGFiZWxzLmlzRGVzdHJveWVkKCk7IC8vIHRydWVcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogLy8gRXhhbXBsZSAyLiBEbyBub3QgZGVzdHJveSBwcmltaXRpdmVzIGluIGEgY29sbGVjdGlvbi5cbiAgICogdmFyIHByaW1pdGl2ZXMgPSBuZXcgQ2VzaXVtLlByaW1pdGl2ZUNvbGxlY3Rpb24oKTtcbiAgICogcHJpbWl0aXZlcy5kZXN0cm95UHJpbWl0aXZlcyA9IGZhbHNlO1xuICAgKiB2YXIgbGFiZWxzID0gcHJpbWl0aXZlcy5hZGQobmV3IENlc2l1bS5MYWJlbENvbGxlY3Rpb24oKSk7XG4gICAqIHByaW1pdGl2ZXMgPSBwcmltaXRpdmVzLmRlc3Ryb3koKTtcbiAgICogdmFyIGIgPSBsYWJlbHMuaXNEZXN0cm95ZWQoKTsgLy8gZmFsc2VcbiAgICogbGFiZWxzID0gbGFiZWxzLmRlc3Ryb3koKTsgICAgLy8gZXhwbGljaXRseSBkZXN0cm95XG4gICAqL1xuICB0aGlzLmRlc3Ryb3lQcmltaXRpdmVzID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuZGVzdHJveVByaW1pdGl2ZXMsIHRydWUpO1xufVxuXG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhQcmltaXRpdmVDb2xsZWN0aW9uLnByb3RvdHlwZSwge1xuICAvKipcbiAgICogR2V0cyB0aGUgbnVtYmVyIG9mIHByaW1pdGl2ZXMgaW4gdGhlIGNvbGxlY3Rpb24uXG4gICAqXG4gICAqIEBtZW1iZXJvZiBQcmltaXRpdmVDb2xsZWN0aW9uLnByb3RvdHlwZVxuICAgKlxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIGxlbmd0aDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3ByaW1pdGl2ZXMubGVuZ3RoO1xuICAgIH0sXG4gIH0sXG59KTtcblxuLyoqXG4gKiBBZGRzIGEgcHJpbWl0aXZlIHRvIHRoZSBjb2xsZWN0aW9uLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBwcmltaXRpdmUgVGhlIHByaW1pdGl2ZSB0byBhZGQuXG4gKiBAcGFyYW0ge051bWJlcn0gW2luZGV4XSBUaGUgaW5kZXggdG8gYWRkIHRoZSBsYXllciBhdC4gIElmIG9taXR0ZWQsIHRoZSBwcmltaXRpdmUgd2lsbCBiZSBhZGRlZCBhdCB0aGUgYm90dG9tIG9mIGFsbCBleGlzdGluZyBwcmltaXRpdmVzLlxuICogQHJldHVybnMge09iamVjdH0gVGhlIHByaW1pdGl2ZSBhZGRlZCB0byB0aGUgY29sbGVjdGlvbi5cbiAqXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gVGhpcyBvYmplY3Qgd2FzIGRlc3Ryb3llZCwgaS5lLiwgZGVzdHJveSgpIHdhcyBjYWxsZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIHZhciBiaWxsYm9hcmRzID0gc2NlbmUucHJpbWl0aXZlcy5hZGQobmV3IENlc2l1bS5CaWxsYm9hcmRDb2xsZWN0aW9uKCkpO1xuICovXG5QcmltaXRpdmVDb2xsZWN0aW9uLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAocHJpbWl0aXZlLCBpbmRleCkge1xuICB2YXIgaGFzSW5kZXggPSBkZWZpbmVkKGluZGV4KTtcblxuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBpZiAoIWRlZmluZWQocHJpbWl0aXZlKSkge1xuICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcInByaW1pdGl2ZSBpcyByZXF1aXJlZC5cIik7XG4gIH1cbiAgaWYgKGhhc0luZGV4KSB7XG4gICAgaWYgKGluZGV4IDwgMCkge1xuICAgICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFwiaW5kZXggbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gemVyby5cIik7XG4gICAgfSBlbHNlIGlmIChpbmRleCA+IHRoaXMuX3ByaW1pdGl2ZXMubGVuZ3RoKSB7XG4gICAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgICAgIFwiaW5kZXggbXVzdCBiZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGhlIG51bWJlciBvZiBwcmltaXRpdmVzLlwiXG4gICAgICApO1xuICAgIH1cbiAgfVxuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB2YXIgZXh0ZXJuYWwgPSAocHJpbWl0aXZlLl9leHRlcm5hbCA9IHByaW1pdGl2ZS5fZXh0ZXJuYWwgfHwge30pO1xuICB2YXIgY29tcG9zaXRlcyA9IChleHRlcm5hbC5fY29tcG9zaXRlcyA9IGV4dGVybmFsLl9jb21wb3NpdGVzIHx8IHt9KTtcbiAgY29tcG9zaXRlc1t0aGlzLl9ndWlkXSA9IHtcbiAgICBjb2xsZWN0aW9uOiB0aGlzLFxuICB9O1xuXG4gIGlmICghaGFzSW5kZXgpIHtcbiAgICB0aGlzLl9wcmltaXRpdmVzLnB1c2gocHJpbWl0aXZlKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLl9wcmltaXRpdmVzLnNwbGljZShpbmRleCwgMCwgcHJpbWl0aXZlKTtcbiAgfVxuXG4gIHJldHVybiBwcmltaXRpdmU7XG59O1xuXG4vKipcbiAqIFJlbW92ZXMgYSBwcmltaXRpdmUgZnJvbSB0aGUgY29sbGVjdGlvbi5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gW3ByaW1pdGl2ZV0gVGhlIHByaW1pdGl2ZSB0byByZW1vdmUuXG4gKiBAcmV0dXJucyB7Qm9vbGVhbn0gPGNvZGU+dHJ1ZTwvY29kZT4gaWYgdGhlIHByaW1pdGl2ZSB3YXMgcmVtb3ZlZDsgPGNvZGU+ZmFsc2U8L2NvZGU+IGlmIHRoZSBwcmltaXRpdmUgaXMgPGNvZGU+dW5kZWZpbmVkPC9jb2RlPiBvciB3YXMgbm90IGZvdW5kIGluIHRoZSBjb2xsZWN0aW9uLlxuICpcbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSBUaGlzIG9iamVjdCB3YXMgZGVzdHJveWVkLCBpLmUuLCBkZXN0cm95KCkgd2FzIGNhbGxlZC5cbiAqXG4gKlxuICogQGV4YW1wbGVcbiAqIHZhciBiaWxsYm9hcmRzID0gc2NlbmUucHJpbWl0aXZlcy5hZGQobmV3IENlc2l1bS5CaWxsYm9hcmRDb2xsZWN0aW9uKCkpO1xuICogc2NlbmUucHJpbWl0aXZlcy5yZW1vdmUoYmlsbGJvYXJkcyk7ICAvLyBSZXR1cm5zIHRydWVcbiAqXG4gKiBAc2VlIFByaW1pdGl2ZUNvbGxlY3Rpb24jZGVzdHJveVByaW1pdGl2ZXNcbiAqL1xuUHJpbWl0aXZlQ29sbGVjdGlvbi5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKHByaW1pdGl2ZSkge1xuICAvLyBQRVJGT1JNQU5DRV9JREVBOiAgV2UgY2FuIG9idmlvdXNseSBtYWtlIHRoaXMgYSBsb3QgZmFzdGVyLlxuICBpZiAodGhpcy5jb250YWlucyhwcmltaXRpdmUpKSB7XG4gICAgdmFyIGluZGV4ID0gdGhpcy5fcHJpbWl0aXZlcy5pbmRleE9mKHByaW1pdGl2ZSk7XG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgdGhpcy5fcHJpbWl0aXZlcy5zcGxpY2UoaW5kZXgsIDEpO1xuXG4gICAgICBkZWxldGUgcHJpbWl0aXZlLl9leHRlcm5hbC5fY29tcG9zaXRlc1t0aGlzLl9ndWlkXTtcblxuICAgICAgaWYgKHRoaXMuZGVzdHJveVByaW1pdGl2ZXMpIHtcbiAgICAgICAgcHJpbWl0aXZlLmRlc3Ryb3koKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIC8vIGVsc2UgLi4uIHRoaXMgaXMgbm90IHBvc3NpYmxlLCBJIHN3ZWFyLlxuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuLyoqXG4gKiBSZW1vdmVzIGFuZCBkZXN0cm95cyBhIHByaW1pdGl2ZSwgcmVnYXJkbGVzcyBvZiBkZXN0cm95UHJpbWl0aXZlcyBzZXR0aW5nLlxuICogQHByaXZhdGVcbiAqL1xuUHJpbWl0aXZlQ29sbGVjdGlvbi5wcm90b3R5cGUucmVtb3ZlQW5kRGVzdHJveSA9IGZ1bmN0aW9uIChwcmltaXRpdmUpIHtcbiAgdmFyIHJlbW92ZWQgPSB0aGlzLnJlbW92ZShwcmltaXRpdmUpO1xuICBpZiAocmVtb3ZlZCAmJiAhdGhpcy5kZXN0cm95UHJpbWl0aXZlcykge1xuICAgIHByaW1pdGl2ZS5kZXN0cm95KCk7XG4gIH1cbiAgcmV0dXJuIHJlbW92ZWQ7XG59O1xuXG4vKipcbiAqIFJlbW92ZXMgYWxsIHByaW1pdGl2ZXMgaW4gdGhlIGNvbGxlY3Rpb24uXG4gKlxuICogQGV4Y2VwdGlvbiB7RGV2ZWxvcGVyRXJyb3J9IFRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQsIGkuZS4sIGRlc3Ryb3koKSB3YXMgY2FsbGVkLlxuICpcbiAqIEBzZWUgUHJpbWl0aXZlQ29sbGVjdGlvbiNkZXN0cm95UHJpbWl0aXZlc1xuICovXG5QcmltaXRpdmVDb2xsZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVBbGwgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBwcmltaXRpdmVzID0gdGhpcy5fcHJpbWl0aXZlcztcbiAgdmFyIGxlbmd0aCA9IHByaW1pdGl2ZXMubGVuZ3RoO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgZGVsZXRlIHByaW1pdGl2ZXNbaV0uX2V4dGVybmFsLl9jb21wb3NpdGVzW3RoaXMuX2d1aWRdO1xuICAgIGlmICh0aGlzLmRlc3Ryb3lQcmltaXRpdmVzKSB7XG4gICAgICBwcmltaXRpdmVzW2ldLmRlc3Ryb3koKTtcbiAgICB9XG4gIH1cbiAgdGhpcy5fcHJpbWl0aXZlcyA9IFtdO1xufTtcblxuLyoqXG4gKiBEZXRlcm1pbmVzIGlmIHRoaXMgY29sbGVjdGlvbiBjb250YWlucyBhIHByaW1pdGl2ZS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gW3ByaW1pdGl2ZV0gVGhlIHByaW1pdGl2ZSB0byBjaGVjayBmb3IuXG4gKiBAcmV0dXJucyB7Qm9vbGVhbn0gPGNvZGU+dHJ1ZTwvY29kZT4gaWYgdGhlIHByaW1pdGl2ZSBpcyBpbiB0aGUgY29sbGVjdGlvbjsgPGNvZGU+ZmFsc2U8L2NvZGU+IGlmIHRoZSBwcmltaXRpdmUgaXMgPGNvZGU+dW5kZWZpbmVkPC9jb2RlPiBvciB3YXMgbm90IGZvdW5kIGluIHRoZSBjb2xsZWN0aW9uLlxuICpcbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSBUaGlzIG9iamVjdCB3YXMgZGVzdHJveWVkLCBpLmUuLCBkZXN0cm95KCkgd2FzIGNhbGxlZC5cbiAqXG4gKiBAc2VlIFByaW1pdGl2ZUNvbGxlY3Rpb24jZ2V0XG4gKi9cblByaW1pdGl2ZUNvbGxlY3Rpb24ucHJvdG90eXBlLmNvbnRhaW5zID0gZnVuY3Rpb24gKHByaW1pdGl2ZSkge1xuICByZXR1cm4gISEoXG4gICAgZGVmaW5lZChwcmltaXRpdmUpICYmXG4gICAgcHJpbWl0aXZlLl9leHRlcm5hbCAmJlxuICAgIHByaW1pdGl2ZS5fZXh0ZXJuYWwuX2NvbXBvc2l0ZXMgJiZcbiAgICBwcmltaXRpdmUuX2V4dGVybmFsLl9jb21wb3NpdGVzW3RoaXMuX2d1aWRdXG4gICk7XG59O1xuXG5mdW5jdGlvbiBnZXRQcmltaXRpdmVJbmRleChjb21wb3NpdGVQcmltaXRpdmUsIHByaW1pdGl2ZSkge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBpZiAoIWNvbXBvc2l0ZVByaW1pdGl2ZS5jb250YWlucyhwcmltaXRpdmUpKSB7XG4gICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFwicHJpbWl0aXZlIGlzIG5vdCBpbiB0aGlzIGNvbGxlY3Rpb24uXCIpO1xuICB9XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIHJldHVybiBjb21wb3NpdGVQcmltaXRpdmUuX3ByaW1pdGl2ZXMuaW5kZXhPZihwcmltaXRpdmUpO1xufVxuXG4vKipcbiAqIFJhaXNlcyBhIHByaW1pdGl2ZSBcInVwIG9uZVwiIGluIHRoZSBjb2xsZWN0aW9uLiAgSWYgYWxsIHByaW1pdGl2ZXMgaW4gdGhlIGNvbGxlY3Rpb24gYXJlIGRyYXduXG4gKiBvbiB0aGUgZ2xvYmUgc3VyZmFjZSwgdGhpcyB2aXN1YWxseSBtb3ZlcyB0aGUgcHJpbWl0aXZlIHVwIG9uZS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gW3ByaW1pdGl2ZV0gVGhlIHByaW1pdGl2ZSB0byByYWlzZS5cbiAqXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gcHJpbWl0aXZlIGlzIG5vdCBpbiB0aGlzIGNvbGxlY3Rpb24uXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gVGhpcyBvYmplY3Qgd2FzIGRlc3Ryb3llZCwgaS5lLiwgZGVzdHJveSgpIHdhcyBjYWxsZWQuXG4gKlxuICogQHNlZSBQcmltaXRpdmVDb2xsZWN0aW9uI3JhaXNlVG9Ub3BcbiAqIEBzZWUgUHJpbWl0aXZlQ29sbGVjdGlvbiNsb3dlclxuICogQHNlZSBQcmltaXRpdmVDb2xsZWN0aW9uI2xvd2VyVG9Cb3R0b21cbiAqL1xuUHJpbWl0aXZlQ29sbGVjdGlvbi5wcm90b3R5cGUucmFpc2UgPSBmdW5jdGlvbiAocHJpbWl0aXZlKSB7XG4gIGlmIChkZWZpbmVkKHByaW1pdGl2ZSkpIHtcbiAgICB2YXIgaW5kZXggPSBnZXRQcmltaXRpdmVJbmRleCh0aGlzLCBwcmltaXRpdmUpO1xuICAgIHZhciBwcmltaXRpdmVzID0gdGhpcy5fcHJpbWl0aXZlcztcblxuICAgIGlmIChpbmRleCAhPT0gcHJpbWl0aXZlcy5sZW5ndGggLSAxKSB7XG4gICAgICB2YXIgcCA9IHByaW1pdGl2ZXNbaW5kZXhdO1xuICAgICAgcHJpbWl0aXZlc1tpbmRleF0gPSBwcmltaXRpdmVzW2luZGV4ICsgMV07XG4gICAgICBwcmltaXRpdmVzW2luZGV4ICsgMV0gPSBwO1xuICAgIH1cbiAgfVxufTtcblxuLyoqXG4gKiBSYWlzZXMgYSBwcmltaXRpdmUgdG8gdGhlIFwidG9wXCIgb2YgdGhlIGNvbGxlY3Rpb24uICBJZiBhbGwgcHJpbWl0aXZlcyBpbiB0aGUgY29sbGVjdGlvbiBhcmUgZHJhd25cbiAqIG9uIHRoZSBnbG9iZSBzdXJmYWNlLCB0aGlzIHZpc3VhbGx5IG1vdmVzIHRoZSBwcmltaXRpdmUgdG8gdGhlIHRvcC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gW3ByaW1pdGl2ZV0gVGhlIHByaW1pdGl2ZSB0byByYWlzZSB0aGUgdG9wLlxuICpcbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSBwcmltaXRpdmUgaXMgbm90IGluIHRoaXMgY29sbGVjdGlvbi5cbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSBUaGlzIG9iamVjdCB3YXMgZGVzdHJveWVkLCBpLmUuLCBkZXN0cm95KCkgd2FzIGNhbGxlZC5cbiAqXG4gKiBAc2VlIFByaW1pdGl2ZUNvbGxlY3Rpb24jcmFpc2VcbiAqIEBzZWUgUHJpbWl0aXZlQ29sbGVjdGlvbiNsb3dlclxuICogQHNlZSBQcmltaXRpdmVDb2xsZWN0aW9uI2xvd2VyVG9Cb3R0b21cbiAqL1xuUHJpbWl0aXZlQ29sbGVjdGlvbi5wcm90b3R5cGUucmFpc2VUb1RvcCA9IGZ1bmN0aW9uIChwcmltaXRpdmUpIHtcbiAgaWYgKGRlZmluZWQocHJpbWl0aXZlKSkge1xuICAgIHZhciBpbmRleCA9IGdldFByaW1pdGl2ZUluZGV4KHRoaXMsIHByaW1pdGl2ZSk7XG4gICAgdmFyIHByaW1pdGl2ZXMgPSB0aGlzLl9wcmltaXRpdmVzO1xuXG4gICAgaWYgKGluZGV4ICE9PSBwcmltaXRpdmVzLmxlbmd0aCAtIDEpIHtcbiAgICAgIC8vIFBFUkZPUk1BTkNFX0lERUE6ICBDb3VsZCBiZSBmYXN0ZXJcbiAgICAgIHByaW1pdGl2ZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIHByaW1pdGl2ZXMucHVzaChwcmltaXRpdmUpO1xuICAgIH1cbiAgfVxufTtcblxuLyoqXG4gKiBMb3dlcnMgYSBwcmltaXRpdmUgXCJkb3duIG9uZVwiIGluIHRoZSBjb2xsZWN0aW9uLiAgSWYgYWxsIHByaW1pdGl2ZXMgaW4gdGhlIGNvbGxlY3Rpb24gYXJlIGRyYXduXG4gKiBvbiB0aGUgZ2xvYmUgc3VyZmFjZSwgdGhpcyB2aXN1YWxseSBtb3ZlcyB0aGUgcHJpbWl0aXZlIGRvd24gb25lLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBbcHJpbWl0aXZlXSBUaGUgcHJpbWl0aXZlIHRvIGxvd2VyLlxuICpcbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSBwcmltaXRpdmUgaXMgbm90IGluIHRoaXMgY29sbGVjdGlvbi5cbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSBUaGlzIG9iamVjdCB3YXMgZGVzdHJveWVkLCBpLmUuLCBkZXN0cm95KCkgd2FzIGNhbGxlZC5cbiAqXG4gKiBAc2VlIFByaW1pdGl2ZUNvbGxlY3Rpb24jbG93ZXJUb0JvdHRvbVxuICogQHNlZSBQcmltaXRpdmVDb2xsZWN0aW9uI3JhaXNlXG4gKiBAc2VlIFByaW1pdGl2ZUNvbGxlY3Rpb24jcmFpc2VUb1RvcFxuICovXG5QcmltaXRpdmVDb2xsZWN0aW9uLnByb3RvdHlwZS5sb3dlciA9IGZ1bmN0aW9uIChwcmltaXRpdmUpIHtcbiAgaWYgKGRlZmluZWQocHJpbWl0aXZlKSkge1xuICAgIHZhciBpbmRleCA9IGdldFByaW1pdGl2ZUluZGV4KHRoaXMsIHByaW1pdGl2ZSk7XG4gICAgdmFyIHByaW1pdGl2ZXMgPSB0aGlzLl9wcmltaXRpdmVzO1xuXG4gICAgaWYgKGluZGV4ICE9PSAwKSB7XG4gICAgICB2YXIgcCA9IHByaW1pdGl2ZXNbaW5kZXhdO1xuICAgICAgcHJpbWl0aXZlc1tpbmRleF0gPSBwcmltaXRpdmVzW2luZGV4IC0gMV07XG4gICAgICBwcmltaXRpdmVzW2luZGV4IC0gMV0gPSBwO1xuICAgIH1cbiAgfVxufTtcblxuLyoqXG4gKiBMb3dlcnMgYSBwcmltaXRpdmUgdG8gdGhlIFwiYm90dG9tXCIgb2YgdGhlIGNvbGxlY3Rpb24uICBJZiBhbGwgcHJpbWl0aXZlcyBpbiB0aGUgY29sbGVjdGlvbiBhcmUgZHJhd25cbiAqIG9uIHRoZSBnbG9iZSBzdXJmYWNlLCB0aGlzIHZpc3VhbGx5IG1vdmVzIHRoZSBwcmltaXRpdmUgdG8gdGhlIGJvdHRvbS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gW3ByaW1pdGl2ZV0gVGhlIHByaW1pdGl2ZSB0byBsb3dlciB0byB0aGUgYm90dG9tLlxuICpcbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSBwcmltaXRpdmUgaXMgbm90IGluIHRoaXMgY29sbGVjdGlvbi5cbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSBUaGlzIG9iamVjdCB3YXMgZGVzdHJveWVkLCBpLmUuLCBkZXN0cm95KCkgd2FzIGNhbGxlZC5cbiAqXG4gKiBAc2VlIFByaW1pdGl2ZUNvbGxlY3Rpb24jbG93ZXJcbiAqIEBzZWUgUHJpbWl0aXZlQ29sbGVjdGlvbiNyYWlzZVxuICogQHNlZSBQcmltaXRpdmVDb2xsZWN0aW9uI3JhaXNlVG9Ub3BcbiAqL1xuUHJpbWl0aXZlQ29sbGVjdGlvbi5wcm90b3R5cGUubG93ZXJUb0JvdHRvbSA9IGZ1bmN0aW9uIChwcmltaXRpdmUpIHtcbiAgaWYgKGRlZmluZWQocHJpbWl0aXZlKSkge1xuICAgIHZhciBpbmRleCA9IGdldFByaW1pdGl2ZUluZGV4KHRoaXMsIHByaW1pdGl2ZSk7XG4gICAgdmFyIHByaW1pdGl2ZXMgPSB0aGlzLl9wcmltaXRpdmVzO1xuXG4gICAgaWYgKGluZGV4ICE9PSAwKSB7XG4gICAgICAvLyBQRVJGT1JNQU5DRV9JREVBOiAgQ291bGQgYmUgZmFzdGVyXG4gICAgICBwcmltaXRpdmVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICBwcmltaXRpdmVzLnVuc2hpZnQocHJpbWl0aXZlKTtcbiAgICB9XG4gIH1cbn07XG5cbi8qKlxuICogUmV0dXJucyB0aGUgcHJpbWl0aXZlIGluIHRoZSBjb2xsZWN0aW9uIGF0IHRoZSBzcGVjaWZpZWQgaW5kZXguXG4gKlxuICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4IFRoZSB6ZXJvLWJhc2VkIGluZGV4IG9mIHRoZSBwcmltaXRpdmUgdG8gcmV0dXJuLlxuICogQHJldHVybnMge09iamVjdH0gVGhlIHByaW1pdGl2ZSBhdCB0aGUgPGNvZGU+aW5kZXg8L2NvZGU+LlxuICpcbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSBUaGlzIG9iamVjdCB3YXMgZGVzdHJveWVkLCBpLmUuLCBkZXN0cm95KCkgd2FzIGNhbGxlZC5cbiAqXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIFRvZ2dsZSB0aGUgc2hvdyBwcm9wZXJ0eSBvZiBldmVyeSBwcmltaXRpdmUgaW4gdGhlIGNvbGxlY3Rpb24uXG4gKiB2YXIgcHJpbWl0aXZlcyA9IHNjZW5lLnByaW1pdGl2ZXM7XG4gKiB2YXIgbGVuZ3RoID0gcHJpbWl0aXZlcy5sZW5ndGg7XG4gKiBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gKiAgIHZhciBwID0gcHJpbWl0aXZlcy5nZXQoaSk7XG4gKiAgIHAuc2hvdyA9ICFwLnNob3c7XG4gKiB9XG4gKlxuICogQHNlZSBQcmltaXRpdmVDb2xsZWN0aW9uI2xlbmd0aFxuICovXG5QcmltaXRpdmVDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgaWYgKCFkZWZpbmVkKGluZGV4KSkge1xuICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcImluZGV4IGlzIHJlcXVpcmVkLlwiKTtcbiAgfVxuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICByZXR1cm4gdGhpcy5fcHJpbWl0aXZlc1tpbmRleF07XG59O1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKi9cblByaW1pdGl2ZUNvbGxlY3Rpb24ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChmcmFtZVN0YXRlKSB7XG4gIGlmICghdGhpcy5zaG93KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIHByaW1pdGl2ZXMgPSB0aGlzLl9wcmltaXRpdmVzO1xuICAvLyBVc2luZyBwcmltaXRpdmVzLmxlbmd0aCBpbiB0aGUgbG9vcCBpcyBhIHRlbXBvcmFyeSB3b3JrYXJvdW5kXG4gIC8vIHRvIGFsbG93IHF1YWR0cmVlIHVwZGF0ZXMgdG8gYWRkIGFuZCByZW1vdmUgcHJpbWl0aXZlcyBpblxuICAvLyB1cGRhdGUoKS4gIFRoaXMgd2lsbCBiZSBjaGFuZ2VkIHRvIG1hbmFnZSBhZGRlZCBhbmQgcmVtb3ZlZCBsaXN0cy5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcmltaXRpdmVzLmxlbmd0aDsgKytpKSB7XG4gICAgcHJpbWl0aXZlc1tpXS51cGRhdGUoZnJhbWVTdGF0ZSk7XG4gIH1cbn07XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuUHJpbWl0aXZlQ29sbGVjdGlvbi5wcm90b3R5cGUucHJlUGFzc2VzVXBkYXRlID0gZnVuY3Rpb24gKGZyYW1lU3RhdGUpIHtcbiAgdmFyIHByaW1pdGl2ZXMgPSB0aGlzLl9wcmltaXRpdmVzO1xuICAvLyBVc2luZyBwcmltaXRpdmVzLmxlbmd0aCBpbiB0aGUgbG9vcCBpcyBhIHRlbXBvcmFyeSB3b3JrYXJvdW5kXG4gIC8vIHRvIGFsbG93IHF1YWR0cmVlIHVwZGF0ZXMgdG8gYWRkIGFuZCByZW1vdmUgcHJpbWl0aXZlcyBpblxuICAvLyB1cGRhdGUoKS4gIFRoaXMgd2lsbCBiZSBjaGFuZ2VkIHRvIG1hbmFnZSBhZGRlZCBhbmQgcmVtb3ZlZCBsaXN0cy5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcmltaXRpdmVzLmxlbmd0aDsgKytpKSB7XG4gICAgdmFyIHByaW1pdGl2ZSA9IHByaW1pdGl2ZXNbaV07XG4gICAgaWYgKGRlZmluZWQocHJpbWl0aXZlLnByZVBhc3Nlc1VwZGF0ZSkpIHtcbiAgICAgIHByaW1pdGl2ZS5wcmVQYXNzZXNVcGRhdGUoZnJhbWVTdGF0ZSk7XG4gICAgfVxuICB9XG59O1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKi9cblByaW1pdGl2ZUNvbGxlY3Rpb24ucHJvdG90eXBlLnVwZGF0ZUZvclBhc3MgPSBmdW5jdGlvbiAoZnJhbWVTdGF0ZSwgcGFzc1N0YXRlKSB7XG4gIHZhciBwcmltaXRpdmVzID0gdGhpcy5fcHJpbWl0aXZlcztcbiAgLy8gVXNpbmcgcHJpbWl0aXZlcy5sZW5ndGggaW4gdGhlIGxvb3AgaXMgYSB0ZW1wb3Jhcnkgd29ya2Fyb3VuZFxuICAvLyB0byBhbGxvdyBxdWFkdHJlZSB1cGRhdGVzIHRvIGFkZCBhbmQgcmVtb3ZlIHByaW1pdGl2ZXMgaW5cbiAgLy8gdXBkYXRlKCkuICBUaGlzIHdpbGwgYmUgY2hhbmdlZCB0byBtYW5hZ2UgYWRkZWQgYW5kIHJlbW92ZWQgbGlzdHMuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcHJpbWl0aXZlcy5sZW5ndGg7ICsraSkge1xuICAgIHZhciBwcmltaXRpdmUgPSBwcmltaXRpdmVzW2ldO1xuICAgIGlmIChkZWZpbmVkKHByaW1pdGl2ZS51cGRhdGVGb3JQYXNzKSkge1xuICAgICAgcHJpbWl0aXZlLnVwZGF0ZUZvclBhc3MoZnJhbWVTdGF0ZSwgcGFzc1N0YXRlKTtcbiAgICB9XG4gIH1cbn07XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuUHJpbWl0aXZlQ29sbGVjdGlvbi5wcm90b3R5cGUucG9zdFBhc3Nlc1VwZGF0ZSA9IGZ1bmN0aW9uIChmcmFtZVN0YXRlKSB7XG4gIHZhciBwcmltaXRpdmVzID0gdGhpcy5fcHJpbWl0aXZlcztcbiAgLy8gVXNpbmcgcHJpbWl0aXZlcy5sZW5ndGggaW4gdGhlIGxvb3AgaXMgYSB0ZW1wb3Jhcnkgd29ya2Fyb3VuZFxuICAvLyB0byBhbGxvdyBxdWFkdHJlZSB1cGRhdGVzIHRvIGFkZCBhbmQgcmVtb3ZlIHByaW1pdGl2ZXMgaW5cbiAgLy8gdXBkYXRlKCkuICBUaGlzIHdpbGwgYmUgY2hhbmdlZCB0byBtYW5hZ2UgYWRkZWQgYW5kIHJlbW92ZWQgbGlzdHMuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcHJpbWl0aXZlcy5sZW5ndGg7ICsraSkge1xuICAgIHZhciBwcmltaXRpdmUgPSBwcmltaXRpdmVzW2ldO1xuICAgIGlmIChkZWZpbmVkKHByaW1pdGl2ZS5wb3N0UGFzc2VzVXBkYXRlKSkge1xuICAgICAgcHJpbWl0aXZlLnBvc3RQYXNzZXNVcGRhdGUoZnJhbWVTdGF0ZSk7XG4gICAgfVxuICB9XG59O1xuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIG9iamVjdCB3YXMgZGVzdHJveWVkOyBvdGhlcndpc2UsIGZhbHNlLlxuICogPGJyIC8+PGJyIC8+XG4gKiBJZiB0aGlzIG9iamVjdCB3YXMgZGVzdHJveWVkLCBpdCBzaG91bGQgbm90IGJlIHVzZWQ7IGNhbGxpbmcgYW55IGZ1bmN0aW9uIG90aGVyIHRoYW5cbiAqIDxjb2RlPmlzRGVzdHJveWVkPC9jb2RlPiB3aWxsIHJlc3VsdCBpbiBhIHtAbGluayBEZXZlbG9wZXJFcnJvcn0gZXhjZXB0aW9uLlxuICpcbiAqIEByZXR1cm5zIHtCb29sZWFufSBUcnVlIGlmIHRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQ7IG90aGVyd2lzZSwgZmFsc2UuXG4gKlxuICogQHNlZSBQcmltaXRpdmVDb2xsZWN0aW9uI2Rlc3Ryb3lcbiAqL1xuUHJpbWl0aXZlQ29sbGVjdGlvbi5wcm90b3R5cGUuaXNEZXN0cm95ZWQgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBmYWxzZTtcbn07XG5cbi8qKlxuICogRGVzdHJveXMgdGhlIFdlYkdMIHJlc291cmNlcyBoZWxkIGJ5IGVhY2ggcHJpbWl0aXZlIGluIHRoaXMgY29sbGVjdGlvbi4gIEV4cGxpY2l0bHkgZGVzdHJveWluZyB0aGlzXG4gKiBjb2xsZWN0aW9uIGFsbG93cyBmb3IgZGV0ZXJtaW5pc3RpYyByZWxlYXNlIG9mIFdlYkdMIHJlc291cmNlcywgaW5zdGVhZCBvZiByZWx5aW5nIG9uIHRoZSBnYXJiYWdlXG4gKiBjb2xsZWN0b3IgdG8gZGVzdHJveSB0aGlzIGNvbGxlY3Rpb24uXG4gKiA8YnIgLz48YnIgLz5cbiAqIFNpbmNlIGRlc3Ryb3lpbmcgYSBjb2xsZWN0aW9uIGRlc3Ryb3lzIGFsbCB0aGUgY29udGFpbmVkIHByaW1pdGl2ZXMsIG9ubHkgZGVzdHJveSBhIGNvbGxlY3Rpb25cbiAqIHdoZW4geW91IGFyZSBzdXJlIG5vIG90aGVyIGNvZGUgaXMgc3RpbGwgdXNpbmcgYW55IG9mIHRoZSBjb250YWluZWQgcHJpbWl0aXZlcy5cbiAqIDxiciAvPjxiciAvPlxuICogT25jZSB0aGlzIGNvbGxlY3Rpb24gaXMgZGVzdHJveWVkLCBpdCBzaG91bGQgbm90IGJlIHVzZWQ7IGNhbGxpbmcgYW55IGZ1bmN0aW9uIG90aGVyIHRoYW5cbiAqIDxjb2RlPmlzRGVzdHJveWVkPC9jb2RlPiB3aWxsIHJlc3VsdCBpbiBhIHtAbGluayBEZXZlbG9wZXJFcnJvcn0gZXhjZXB0aW9uLiAgVGhlcmVmb3JlLFxuICogYXNzaWduIHRoZSByZXR1cm4gdmFsdWUgKDxjb2RlPnVuZGVmaW5lZDwvY29kZT4pIHRvIHRoZSBvYmplY3QgYXMgZG9uZSBpbiB0aGUgZXhhbXBsZS5cbiAqXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gVGhpcyBvYmplY3Qgd2FzIGRlc3Ryb3llZCwgaS5lLiwgZGVzdHJveSgpIHdhcyBjYWxsZWQuXG4gKlxuICpcbiAqIEBleGFtcGxlXG4gKiBwcmltaXRpdmVzID0gcHJpbWl0aXZlcyAmJiBwcmltaXRpdmVzLmRlc3Ryb3koKTtcbiAqXG4gKiBAc2VlIFByaW1pdGl2ZUNvbGxlY3Rpb24jaXNEZXN0cm95ZWRcbiAqL1xuUHJpbWl0aXZlQ29sbGVjdGlvbi5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5yZW1vdmVBbGwoKTtcbiAgcmV0dXJuIGRlc3Ryb3lPYmplY3QodGhpcyk7XG59O1xuZXhwb3J0IGRlZmF1bHQgUHJpbWl0aXZlQ29sbGVjdGlvbjtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///73316\n')},1764:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(48243);\n/* harmony import */ var _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(84828);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(82982);\n/* harmony import */ var _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(12572);\n/* harmony import */ var _Core_Ellipsoid_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(50491);\n/* harmony import */ var _Core_GeographicProjection_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(39756);\n/* harmony import */ var _Core_Geometry_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(82408);\n/* harmony import */ var _Core_GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(13616);\n/* harmony import */ var _Core_GeometryAttributes_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(56652);\n/* harmony import */ var _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(57552);\n/* harmony import */ var _Core_IndexDatatype_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(22832);\n/* harmony import */ var _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(72248);\n/* harmony import */ var _Core_OffsetGeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(82223);\n/* harmony import */ var _Core_WebMercatorProjection_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(79962);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction transformToWorldCoordinates(\n  instances,\n  primitiveModelMatrix,\n  scene3DOnly\n) {\n  var toWorld = !scene3DOnly;\n  var length = instances.length;\n  var i;\n\n  if (!toWorld && length > 1) {\n    var modelMatrix = instances[0].modelMatrix;\n\n    for (i = 1; i < length; ++i) {\n      if (!_Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"].equals */ .Z.equals(modelMatrix, instances[i].modelMatrix)) {\n        toWorld = true;\n        break;\n      }\n    }\n  }\n\n  if (toWorld) {\n    for (i = 0; i < length; ++i) {\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(instances[i].geometry)) {\n        _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].transformToWorldCoordinates */ .Z.transformToWorldCoordinates(instances[i]);\n      }\n    }\n  } else {\n    // Leave geometry in local coordinate system; auto update model-matrix.\n    _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"].multiplyTransformation */ .Z.multiplyTransformation(\n      primitiveModelMatrix,\n      instances[0].modelMatrix,\n      primitiveModelMatrix\n    );\n  }\n}\n\nfunction addGeometryBatchId(geometry, batchId) {\n  var attributes = geometry.attributes;\n  var positionAttr = attributes.position;\n  var numberOfComponents =\n    positionAttr.values.length / positionAttr.componentsPerAttribute;\n\n  attributes.batchId = new _Core_GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n    componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].FLOAT */ .Z.FLOAT,\n    componentsPerAttribute: 1,\n    values: new Float32Array(numberOfComponents),\n  });\n\n  var values = attributes.batchId.values;\n  for (var j = 0; j < numberOfComponents; ++j) {\n    values[j] = batchId;\n  }\n}\n\nfunction addBatchIds(instances) {\n  var length = instances.length;\n\n  for (var i = 0; i < length; ++i) {\n    var instance = instances[i];\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(instance.geometry)) {\n      addGeometryBatchId(instance.geometry, i);\n    } else if (\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(instance.westHemisphereGeometry) &&\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(instance.eastHemisphereGeometry)\n    ) {\n      addGeometryBatchId(instance.westHemisphereGeometry, i);\n      addGeometryBatchId(instance.eastHemisphereGeometry, i);\n    }\n  }\n}\n\nfunction geometryPipeline(parameters) {\n  var instances = parameters.instances;\n  var projection = parameters.projection;\n  var uintIndexSupport = parameters.elementIndexUintSupported;\n  var scene3DOnly = parameters.scene3DOnly;\n  var vertexCacheOptimize = parameters.vertexCacheOptimize;\n  var compressVertices = parameters.compressVertices;\n  var modelMatrix = parameters.modelMatrix;\n\n  var i;\n  var geometry;\n  var primitiveType;\n  var length = instances.length;\n\n  for (i = 0; i < length; ++i) {\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(instances[i].geometry)) {\n      primitiveType = instances[i].geometry.primitiveType;\n      break;\n    }\n  }\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  for (i = 1; i < length; ++i) {\n    if (\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(instances[i].geometry) &&\n      instances[i].geometry.primitiveType !== primitiveType\n    ) {\n      throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z(\n        "All instance geometries must have the same primitiveType."\n      );\n    }\n  }\n  //>>includeEnd(\'debug\');\n\n  // Unify to world coordinates before combining.\n  transformToWorldCoordinates(instances, modelMatrix, scene3DOnly);\n\n  // Clip to IDL\n  if (!scene3DOnly) {\n    for (i = 0; i < length; ++i) {\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(instances[i].geometry)) {\n        _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].splitLongitude */ .Z.splitLongitude(instances[i]);\n      }\n    }\n  }\n\n  addBatchIds(instances);\n\n  // Optimize for vertex shader caches\n  if (vertexCacheOptimize) {\n    for (i = 0; i < length; ++i) {\n      var instance = instances[i];\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(instance.geometry)) {\n        _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].reorderForPostVertexCache */ .Z.reorderForPostVertexCache(instance.geometry);\n        _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].reorderForPreVertexCache */ .Z.reorderForPreVertexCache(instance.geometry);\n      } else if (\n        (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(instance.westHemisphereGeometry) &&\n        (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(instance.eastHemisphereGeometry)\n      ) {\n        _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].reorderForPostVertexCache */ .Z.reorderForPostVertexCache(\n          instance.westHemisphereGeometry\n        );\n        _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].reorderForPreVertexCache */ .Z.reorderForPreVertexCache(\n          instance.westHemisphereGeometry\n        );\n\n        _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].reorderForPostVertexCache */ .Z.reorderForPostVertexCache(\n          instance.eastHemisphereGeometry\n        );\n        _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].reorderForPreVertexCache */ .Z.reorderForPreVertexCache(\n          instance.eastHemisphereGeometry\n        );\n      }\n    }\n  }\n\n  // Combine into single geometry for better rendering performance.\n  var geometries = _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].combineInstances */ .Z.combineInstances(instances);\n\n  length = geometries.length;\n  for (i = 0; i < length; ++i) {\n    geometry = geometries[i];\n\n    // Split positions for GPU RTE\n    var attributes = geometry.attributes;\n    var name;\n    if (!scene3DOnly) {\n      for (name in attributes) {\n        if (\n          attributes.hasOwnProperty(name) &&\n          attributes[name].componentDatatype === _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].DOUBLE */ .Z.DOUBLE\n        ) {\n          var name3D = name + "3D";\n          var name2D = name + "2D";\n\n          // Compute 2D positions\n          _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].projectTo2D */ .Z.projectTo2D(\n            geometry,\n            name,\n            name3D,\n            name2D,\n            projection\n          );\n          if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(geometry.boundingSphere) && name === "position") {\n            geometry.boundingSphereCV = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].fromVertices */ .Z.fromVertices(\n              geometry.attributes.position2D.values\n            );\n          }\n\n          _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].encodeAttribute */ .Z.encodeAttribute(\n            geometry,\n            name3D,\n            name3D + "High",\n            name3D + "Low"\n          );\n          _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].encodeAttribute */ .Z.encodeAttribute(\n            geometry,\n            name2D,\n            name2D + "High",\n            name2D + "Low"\n          );\n        }\n      }\n    } else {\n      for (name in attributes) {\n        if (\n          attributes.hasOwnProperty(name) &&\n          attributes[name].componentDatatype === _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].DOUBLE */ .Z.DOUBLE\n        ) {\n          _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].encodeAttribute */ .Z.encodeAttribute(\n            geometry,\n            name,\n            name + "3DHigh",\n            name + "3DLow"\n          );\n        }\n      }\n    }\n\n    // oct encode and pack normals, compress texture coordinates\n    if (compressVertices) {\n      _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].compressVertices */ .Z.compressVertices(geometry);\n    }\n  }\n\n  if (!uintIndexSupport) {\n    // Break into multiple geometries to fit within unsigned short indices if needed\n    var splitGeometries = [];\n    length = geometries.length;\n    for (i = 0; i < length; ++i) {\n      geometry = geometries[i];\n      splitGeometries = splitGeometries.concat(\n        _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].fitToUnsignedShortIndices */ .Z.fitToUnsignedShortIndices(geometry)\n      );\n    }\n\n    geometries = splitGeometries;\n  }\n\n  return geometries;\n}\n\nfunction createPickOffsets(instances, geometryName, geometries, pickOffsets) {\n  var offset;\n  var indexCount;\n  var geometryIndex;\n\n  var offsetIndex = pickOffsets.length - 1;\n  if (offsetIndex >= 0) {\n    var pickOffset = pickOffsets[offsetIndex];\n    offset = pickOffset.offset + pickOffset.count;\n    geometryIndex = pickOffset.index;\n    indexCount = geometries[geometryIndex].indices.length;\n  } else {\n    offset = 0;\n    geometryIndex = 0;\n    indexCount = geometries[geometryIndex].indices.length;\n  }\n\n  var length = instances.length;\n  for (var i = 0; i < length; ++i) {\n    var instance = instances[i];\n    var geometry = instance[geometryName];\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(geometry)) {\n      continue;\n    }\n\n    var count = geometry.indices.length;\n\n    if (offset + count > indexCount) {\n      offset = 0;\n      indexCount = geometries[++geometryIndex].indices.length;\n    }\n\n    pickOffsets.push({\n      index: geometryIndex,\n      offset: offset,\n      count: count,\n    });\n    offset += count;\n  }\n}\n\nfunction createInstancePickOffsets(instances, geometries) {\n  var pickOffsets = [];\n  createPickOffsets(instances, "geometry", geometries, pickOffsets);\n  createPickOffsets(\n    instances,\n    "westHemisphereGeometry",\n    geometries,\n    pickOffsets\n  );\n  createPickOffsets(\n    instances,\n    "eastHemisphereGeometry",\n    geometries,\n    pickOffsets\n  );\n  return pickOffsets;\n}\n\n/**\n * @private\n */\nvar PrimitivePipeline = {};\n\n/**\n * @private\n */\nPrimitivePipeline.combineGeometry = function (parameters) {\n  var geometries;\n  var attributeLocations;\n  var instances = parameters.instances;\n  var length = instances.length;\n  var pickOffsets;\n\n  var offsetInstanceExtend;\n  var hasOffset = false;\n  if (length > 0) {\n    geometries = geometryPipeline(parameters);\n    if (geometries.length > 0) {\n      attributeLocations = _Core_GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].createAttributeLocations */ .Z.createAttributeLocations(\n        geometries[0]\n      );\n      if (parameters.createPickOffsets) {\n        pickOffsets = createInstancePickOffsets(instances, geometries);\n      }\n    }\n    if (\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(instances[0].attributes) &&\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(instances[0].attributes.offset)\n    ) {\n      offsetInstanceExtend = new Array(length);\n      hasOffset = true;\n    }\n  }\n\n  var boundingSpheres = new Array(length);\n  var boundingSpheresCV = new Array(length);\n  for (var i = 0; i < length; ++i) {\n    var instance = instances[i];\n    var geometry = instance.geometry;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(geometry)) {\n      boundingSpheres[i] = geometry.boundingSphere;\n      boundingSpheresCV[i] = geometry.boundingSphereCV;\n      if (hasOffset) {\n        offsetInstanceExtend[i] = instance.geometry.offsetAttribute;\n      }\n    }\n\n    var eastHemisphereGeometry = instance.eastHemisphereGeometry;\n    var westHemisphereGeometry = instance.westHemisphereGeometry;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(eastHemisphereGeometry) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(westHemisphereGeometry)) {\n      if (\n        (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(eastHemisphereGeometry.boundingSphere) &&\n        (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(westHemisphereGeometry.boundingSphere)\n      ) {\n        boundingSpheres[i] = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].union */ .Z.union(\n          eastHemisphereGeometry.boundingSphere,\n          westHemisphereGeometry.boundingSphere\n        );\n      }\n      if (\n        (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(eastHemisphereGeometry.boundingSphereCV) &&\n        (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(westHemisphereGeometry.boundingSphereCV)\n      ) {\n        boundingSpheresCV[i] = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].union */ .Z.union(\n          eastHemisphereGeometry.boundingSphereCV,\n          westHemisphereGeometry.boundingSphereCV\n        );\n      }\n    }\n  }\n\n  return {\n    geometries: geometries,\n    modelMatrix: parameters.modelMatrix,\n    attributeLocations: attributeLocations,\n    pickOffsets: pickOffsets,\n    offsetInstanceExtend: offsetInstanceExtend,\n    boundingSpheres: boundingSpheres,\n    boundingSpheresCV: boundingSpheresCV,\n  };\n};\n\nfunction transferGeometry(geometry, transferableObjects) {\n  var attributes = geometry.attributes;\n  for (var name in attributes) {\n    if (attributes.hasOwnProperty(name)) {\n      var attribute = attributes[name];\n\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(attribute) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(attribute.values)) {\n        transferableObjects.push(attribute.values.buffer);\n      }\n    }\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(geometry.indices)) {\n    transferableObjects.push(geometry.indices.buffer);\n  }\n}\n\nfunction transferGeometries(geometries, transferableObjects) {\n  var length = geometries.length;\n  for (var i = 0; i < length; ++i) {\n    transferGeometry(geometries[i], transferableObjects);\n  }\n}\n\n// This function was created by simplifying packCreateGeometryResults into a count-only operation.\nfunction countCreateGeometryResults(items) {\n  var count = 1;\n  var length = items.length;\n  for (var i = 0; i < length; i++) {\n    var geometry = items[i];\n    ++count;\n\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(geometry)) {\n      continue;\n    }\n\n    var attributes = geometry.attributes;\n\n    count +=\n      7 +\n      2 * _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].packedLength */ .Z.packedLength +\n      ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(geometry.indices) ? geometry.indices.length : 0);\n\n    for (var property in attributes) {\n      if (\n        attributes.hasOwnProperty(property) &&\n        (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(attributes[property])\n      ) {\n        var attribute = attributes[property];\n        count += 5 + attribute.values.length;\n      }\n    }\n  }\n\n  return count;\n}\n\n/**\n * @private\n */\nPrimitivePipeline.packCreateGeometryResults = function (\n  items,\n  transferableObjects\n) {\n  var packedData = new Float64Array(countCreateGeometryResults(items));\n  var stringTable = [];\n  var stringHash = {};\n\n  var length = items.length;\n  var count = 0;\n  packedData[count++] = length;\n  for (var i = 0; i < length; i++) {\n    var geometry = items[i];\n\n    var validGeometry = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(geometry);\n    packedData[count++] = validGeometry ? 1.0 : 0.0;\n\n    if (!validGeometry) {\n      continue;\n    }\n\n    packedData[count++] = geometry.primitiveType;\n    packedData[count++] = geometry.geometryType;\n    packedData[count++] = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(geometry.offsetAttribute, -1);\n\n    var validBoundingSphere = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(geometry.boundingSphere) ? 1.0 : 0.0;\n    packedData[count++] = validBoundingSphere;\n    if (validBoundingSphere) {\n      _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].pack */ .Z.pack(geometry.boundingSphere, packedData, count);\n    }\n\n    count += _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].packedLength */ .Z.packedLength;\n\n    var validBoundingSphereCV = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(geometry.boundingSphereCV) ? 1.0 : 0.0;\n    packedData[count++] = validBoundingSphereCV;\n    if (validBoundingSphereCV) {\n      _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].pack */ .Z.pack(geometry.boundingSphereCV, packedData, count);\n    }\n\n    count += _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].packedLength */ .Z.packedLength;\n\n    var attributes = geometry.attributes;\n    var attributesToWrite = [];\n    for (var property in attributes) {\n      if (\n        attributes.hasOwnProperty(property) &&\n        (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(attributes[property])\n      ) {\n        attributesToWrite.push(property);\n        if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(stringHash[property])) {\n          stringHash[property] = stringTable.length;\n          stringTable.push(property);\n        }\n      }\n    }\n\n    packedData[count++] = attributesToWrite.length;\n    for (var q = 0; q < attributesToWrite.length; q++) {\n      var name = attributesToWrite[q];\n      var attribute = attributes[name];\n      packedData[count++] = stringHash[name];\n      packedData[count++] = attribute.componentDatatype;\n      packedData[count++] = attribute.componentsPerAttribute;\n      packedData[count++] = attribute.normalize ? 1 : 0;\n      packedData[count++] = attribute.values.length;\n      packedData.set(attribute.values, count);\n      count += attribute.values.length;\n    }\n\n    var indicesLength = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(geometry.indices) ? geometry.indices.length : 0;\n    packedData[count++] = indicesLength;\n\n    if (indicesLength > 0) {\n      packedData.set(geometry.indices, count);\n      count += indicesLength;\n    }\n  }\n\n  transferableObjects.push(packedData.buffer);\n\n  return {\n    stringTable: stringTable,\n    packedData: packedData,\n  };\n};\n\n/**\n * @private\n */\nPrimitivePipeline.unpackCreateGeometryResults = function (\n  createGeometryResult\n) {\n  var stringTable = createGeometryResult.stringTable;\n  var packedGeometry = createGeometryResult.packedData;\n\n  var i;\n  var result = new Array(packedGeometry[0]);\n  var resultIndex = 0;\n\n  var packedGeometryIndex = 1;\n  while (packedGeometryIndex < packedGeometry.length) {\n    var valid = packedGeometry[packedGeometryIndex++] === 1.0;\n    if (!valid) {\n      result[resultIndex++] = undefined;\n      continue;\n    }\n\n    var primitiveType = packedGeometry[packedGeometryIndex++];\n    var geometryType = packedGeometry[packedGeometryIndex++];\n    var offsetAttribute = packedGeometry[packedGeometryIndex++];\n    if (offsetAttribute === -1) {\n      offsetAttribute = undefined;\n    }\n\n    var boundingSphere;\n    var boundingSphereCV;\n\n    var validBoundingSphere = packedGeometry[packedGeometryIndex++] === 1.0;\n    if (validBoundingSphere) {\n      boundingSphere = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].unpack */ .Z.unpack(\n        packedGeometry,\n        packedGeometryIndex\n      );\n    }\n\n    packedGeometryIndex += _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].packedLength */ .Z.packedLength;\n\n    var validBoundingSphereCV = packedGeometry[packedGeometryIndex++] === 1.0;\n    if (validBoundingSphereCV) {\n      boundingSphereCV = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].unpack */ .Z.unpack(\n        packedGeometry,\n        packedGeometryIndex\n      );\n    }\n\n    packedGeometryIndex += _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].packedLength */ .Z.packedLength;\n\n    var length;\n    var values;\n    var componentsPerAttribute;\n    var attributes = new _Core_GeometryAttributes_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z();\n    var numAttributes = packedGeometry[packedGeometryIndex++];\n    for (i = 0; i < numAttributes; i++) {\n      var name = stringTable[packedGeometry[packedGeometryIndex++]];\n      var componentDatatype = packedGeometry[packedGeometryIndex++];\n      componentsPerAttribute = packedGeometry[packedGeometryIndex++];\n      var normalize = packedGeometry[packedGeometryIndex++] !== 0;\n\n      length = packedGeometry[packedGeometryIndex++];\n      values = _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].createTypedArray */ .Z.createTypedArray(componentDatatype, length);\n      for (var valuesIndex = 0; valuesIndex < length; valuesIndex++) {\n        values[valuesIndex] = packedGeometry[packedGeometryIndex++];\n      }\n\n      attributes[name] = new _Core_GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n        componentDatatype: componentDatatype,\n        componentsPerAttribute: componentsPerAttribute,\n        normalize: normalize,\n        values: values,\n      });\n    }\n\n    var indices;\n    length = packedGeometry[packedGeometryIndex++];\n\n    if (length > 0) {\n      var numberOfVertices = values.length / componentsPerAttribute;\n      indices = _Core_IndexDatatype_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"].createTypedArray */ .Z.createTypedArray(numberOfVertices, length);\n      for (i = 0; i < length; i++) {\n        indices[i] = packedGeometry[packedGeometryIndex++];\n      }\n    }\n\n    result[resultIndex++] = new _Core_Geometry_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z({\n      primitiveType: primitiveType,\n      geometryType: geometryType,\n      boundingSphere: boundingSphere,\n      boundingSphereCV: boundingSphereCV,\n      indices: indices,\n      attributes: attributes,\n      offsetAttribute: offsetAttribute,\n    });\n  }\n\n  return result;\n};\n\nfunction packInstancesForCombine(instances, transferableObjects) {\n  var length = instances.length;\n  var packedData = new Float64Array(1 + length * 19);\n  var count = 0;\n  packedData[count++] = length;\n  for (var i = 0; i < length; i++) {\n    var instance = instances[i];\n    _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"].pack */ .Z.pack(instance.modelMatrix, packedData, count);\n    count += _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"].packedLength */ .Z.packedLength;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(instance.attributes) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(instance.attributes.offset)) {\n      var values = instance.attributes.offset.value;\n      packedData[count] = values[0];\n      packedData[count + 1] = values[1];\n      packedData[count + 2] = values[2];\n    }\n    count += 3;\n  }\n  transferableObjects.push(packedData.buffer);\n\n  return packedData;\n}\n\nfunction unpackInstancesForCombine(data) {\n  var packedInstances = data;\n  var result = new Array(packedInstances[0]);\n  var count = 0;\n\n  var i = 1;\n  while (i < packedInstances.length) {\n    var modelMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"].unpack */ .Z.unpack(packedInstances, i);\n    var attributes;\n    i += _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"].packedLength */ .Z.packedLength;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(packedInstances[i])) {\n      attributes = {\n        offset: new _Core_OffsetGeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z(\n          packedInstances[i],\n          packedInstances[i + 1],\n          packedInstances[i + 2]\n        ),\n      };\n    }\n    i += 3;\n\n    result[count++] = {\n      modelMatrix: modelMatrix,\n      attributes: attributes,\n    };\n  }\n\n  return result;\n}\n\n/**\n * @private\n */\nPrimitivePipeline.packCombineGeometryParameters = function (\n  parameters,\n  transferableObjects\n) {\n  var createGeometryResults = parameters.createGeometryResults;\n  var length = createGeometryResults.length;\n\n  for (var i = 0; i < length; i++) {\n    transferableObjects.push(createGeometryResults[i].packedData.buffer);\n  }\n\n  return {\n    createGeometryResults: parameters.createGeometryResults,\n    packedInstances: packInstancesForCombine(\n      parameters.instances,\n      transferableObjects\n    ),\n    ellipsoid: parameters.ellipsoid,\n    isGeographic: parameters.projection instanceof _Core_GeographicProjection_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z,\n    elementIndexUintSupported: parameters.elementIndexUintSupported,\n    scene3DOnly: parameters.scene3DOnly,\n    vertexCacheOptimize: parameters.vertexCacheOptimize,\n    compressVertices: parameters.compressVertices,\n    modelMatrix: parameters.modelMatrix,\n    createPickOffsets: parameters.createPickOffsets,\n  };\n};\n\n/**\n * @private\n */\nPrimitivePipeline.unpackCombineGeometryParameters = function (\n  packedParameters\n) {\n  var instances = unpackInstancesForCombine(packedParameters.packedInstances);\n  var createGeometryResults = packedParameters.createGeometryResults;\n  var length = createGeometryResults.length;\n  var instanceIndex = 0;\n\n  for (var resultIndex = 0; resultIndex < length; resultIndex++) {\n    var geometries = PrimitivePipeline.unpackCreateGeometryResults(\n      createGeometryResults[resultIndex]\n    );\n    var geometriesLength = geometries.length;\n    for (\n      var geometryIndex = 0;\n      geometryIndex < geometriesLength;\n      geometryIndex++\n    ) {\n      var geometry = geometries[geometryIndex];\n      var instance = instances[instanceIndex];\n      instance.geometry = geometry;\n      ++instanceIndex;\n    }\n  }\n\n  var ellipsoid = _Core_Ellipsoid_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].clone */ .Z.clone(packedParameters.ellipsoid);\n  var projection = packedParameters.isGeographic\n    ? new _Core_GeographicProjection_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z(ellipsoid)\n    : new _Core_WebMercatorProjection_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z(ellipsoid);\n\n  return {\n    instances: instances,\n    ellipsoid: ellipsoid,\n    projection: projection,\n    elementIndexUintSupported: packedParameters.elementIndexUintSupported,\n    scene3DOnly: packedParameters.scene3DOnly,\n    vertexCacheOptimize: packedParameters.vertexCacheOptimize,\n    compressVertices: packedParameters.compressVertices,\n    modelMatrix: _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"].clone */ .Z.clone(packedParameters.modelMatrix),\n    createPickOffsets: packedParameters.createPickOffsets,\n  };\n};\n\nfunction packBoundingSpheres(boundingSpheres) {\n  var length = boundingSpheres.length;\n  var bufferLength = 1 + (_Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].packedLength */ .Z.packedLength + 1) * length;\n  var buffer = new Float32Array(bufferLength);\n\n  var bufferIndex = 0;\n  buffer[bufferIndex++] = length;\n\n  for (var i = 0; i < length; ++i) {\n    var bs = boundingSpheres[i];\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(bs)) {\n      buffer[bufferIndex++] = 0.0;\n    } else {\n      buffer[bufferIndex++] = 1.0;\n      _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].pack */ .Z.pack(boundingSpheres[i], buffer, bufferIndex);\n    }\n    bufferIndex += _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].packedLength */ .Z.packedLength;\n  }\n\n  return buffer;\n}\n\nfunction unpackBoundingSpheres(buffer) {\n  var result = new Array(buffer[0]);\n  var count = 0;\n\n  var i = 1;\n  while (i < buffer.length) {\n    if (buffer[i++] === 1.0) {\n      result[count] = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].unpack */ .Z.unpack(buffer, i);\n    }\n    ++count;\n    i += _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].packedLength */ .Z.packedLength;\n  }\n\n  return result;\n}\n\n/**\n * @private\n */\nPrimitivePipeline.packCombineGeometryResults = function (\n  results,\n  transferableObjects\n) {\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(results.geometries)) {\n    transferGeometries(results.geometries, transferableObjects);\n  }\n\n  var packedBoundingSpheres = packBoundingSpheres(results.boundingSpheres);\n  var packedBoundingSpheresCV = packBoundingSpheres(results.boundingSpheresCV);\n  transferableObjects.push(\n    packedBoundingSpheres.buffer,\n    packedBoundingSpheresCV.buffer\n  );\n\n  return {\n    geometries: results.geometries,\n    attributeLocations: results.attributeLocations,\n    modelMatrix: results.modelMatrix,\n    pickOffsets: results.pickOffsets,\n    offsetInstanceExtend: results.offsetInstanceExtend,\n    boundingSpheres: packedBoundingSpheres,\n    boundingSpheresCV: packedBoundingSpheresCV,\n  };\n};\n\n/**\n * @private\n */\nPrimitivePipeline.unpackCombineGeometryResults = function (packedResult) {\n  return {\n    geometries: packedResult.geometries,\n    attributeLocations: packedResult.attributeLocations,\n    modelMatrix: packedResult.modelMatrix,\n    pickOffsets: packedResult.pickOffsets,\n    offsetInstanceExtend: packedResult.offsetInstanceExtend,\n    boundingSpheres: unpackBoundingSpheres(packedResult.boundingSpheres),\n    boundingSpheresCV: unpackBoundingSpheres(packedResult.boundingSpheresCV),\n  };\n};\n/* harmony default export */ __webpack_exports__["Z"] = (PrimitivePipeline);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBZSxpQkFBaUIsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9TY2VuZS9QcmltaXRpdmVQaXBlbGluZS5qcz9mNGM0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBCb3VuZGluZ1NwaGVyZSBmcm9tIFwiLi4vQ29yZS9Cb3VuZGluZ1NwaGVyZS5qc1wiO1xuaW1wb3J0IENvbXBvbmVudERhdGF0eXBlIGZyb20gXCIuLi9Db3JlL0NvbXBvbmVudERhdGF0eXBlLmpzXCI7XG5pbXBvcnQgZGVmYXVsdFZhbHVlIGZyb20gXCIuLi9Db3JlL2RlZmF1bHRWYWx1ZS5qc1wiO1xuaW1wb3J0IGRlZmluZWQgZnJvbSBcIi4uL0NvcmUvZGVmaW5lZC5qc1wiO1xuaW1wb3J0IERldmVsb3BlckVycm9yIGZyb20gXCIuLi9Db3JlL0RldmVsb3BlckVycm9yLmpzXCI7XG5pbXBvcnQgRWxsaXBzb2lkIGZyb20gXCIuLi9Db3JlL0VsbGlwc29pZC5qc1wiO1xuaW1wb3J0IEdlb2dyYXBoaWNQcm9qZWN0aW9uIGZyb20gXCIuLi9Db3JlL0dlb2dyYXBoaWNQcm9qZWN0aW9uLmpzXCI7XG5pbXBvcnQgR2VvbWV0cnkgZnJvbSBcIi4uL0NvcmUvR2VvbWV0cnkuanNcIjtcbmltcG9ydCBHZW9tZXRyeUF0dHJpYnV0ZSBmcm9tIFwiLi4vQ29yZS9HZW9tZXRyeUF0dHJpYnV0ZS5qc1wiO1xuaW1wb3J0IEdlb21ldHJ5QXR0cmlidXRlcyBmcm9tIFwiLi4vQ29yZS9HZW9tZXRyeUF0dHJpYnV0ZXMuanNcIjtcbmltcG9ydCBHZW9tZXRyeVBpcGVsaW5lIGZyb20gXCIuLi9Db3JlL0dlb21ldHJ5UGlwZWxpbmUuanNcIjtcbmltcG9ydCBJbmRleERhdGF0eXBlIGZyb20gXCIuLi9Db3JlL0luZGV4RGF0YXR5cGUuanNcIjtcbmltcG9ydCBNYXRyaXg0IGZyb20gXCIuLi9Db3JlL01hdHJpeDQuanNcIjtcbmltcG9ydCBPZmZzZXRHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlIGZyb20gXCIuLi9Db3JlL09mZnNldEdlb21ldHJ5SW5zdGFuY2VBdHRyaWJ1dGUuanNcIjtcbmltcG9ydCBXZWJNZXJjYXRvclByb2plY3Rpb24gZnJvbSBcIi4uL0NvcmUvV2ViTWVyY2F0b3JQcm9qZWN0aW9uLmpzXCI7XG5cbmZ1bmN0aW9uIHRyYW5zZm9ybVRvV29ybGRDb29yZGluYXRlcyhcbiAgaW5zdGFuY2VzLFxuICBwcmltaXRpdmVNb2RlbE1hdHJpeCxcbiAgc2NlbmUzRE9ubHlcbikge1xuICB2YXIgdG9Xb3JsZCA9ICFzY2VuZTNET25seTtcbiAgdmFyIGxlbmd0aCA9IGluc3RhbmNlcy5sZW5ndGg7XG4gIHZhciBpO1xuXG4gIGlmICghdG9Xb3JsZCAmJiBsZW5ndGggPiAxKSB7XG4gICAgdmFyIG1vZGVsTWF0cml4ID0gaW5zdGFuY2VzWzBdLm1vZGVsTWF0cml4O1xuXG4gICAgZm9yIChpID0gMTsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgICBpZiAoIU1hdHJpeDQuZXF1YWxzKG1vZGVsTWF0cml4LCBpbnN0YW5jZXNbaV0ubW9kZWxNYXRyaXgpKSB7XG4gICAgICAgIHRvV29ybGQgPSB0cnVlO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAodG9Xb3JsZCkge1xuICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgICAgaWYgKGRlZmluZWQoaW5zdGFuY2VzW2ldLmdlb21ldHJ5KSkge1xuICAgICAgICBHZW9tZXRyeVBpcGVsaW5lLnRyYW5zZm9ybVRvV29ybGRDb29yZGluYXRlcyhpbnN0YW5jZXNbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICAvLyBMZWF2ZSBnZW9tZXRyeSBpbiBsb2NhbCBjb29yZGluYXRlIHN5c3RlbTsgYXV0byB1cGRhdGUgbW9kZWwtbWF0cml4LlxuICAgIE1hdHJpeDQubXVsdGlwbHlUcmFuc2Zvcm1hdGlvbihcbiAgICAgIHByaW1pdGl2ZU1vZGVsTWF0cml4LFxuICAgICAgaW5zdGFuY2VzWzBdLm1vZGVsTWF0cml4LFxuICAgICAgcHJpbWl0aXZlTW9kZWxNYXRyaXhcbiAgICApO1xuICB9XG59XG5cbmZ1bmN0aW9uIGFkZEdlb21ldHJ5QmF0Y2hJZChnZW9tZXRyeSwgYmF0Y2hJZCkge1xuICB2YXIgYXR0cmlidXRlcyA9IGdlb21ldHJ5LmF0dHJpYnV0ZXM7XG4gIHZhciBwb3NpdGlvbkF0dHIgPSBhdHRyaWJ1dGVzLnBvc2l0aW9uO1xuICB2YXIgbnVtYmVyT2ZDb21wb25lbnRzID1cbiAgICBwb3NpdGlvbkF0dHIudmFsdWVzLmxlbmd0aCAvIHBvc2l0aW9uQXR0ci5jb21wb25lbnRzUGVyQXR0cmlidXRlO1xuXG4gIGF0dHJpYnV0ZXMuYmF0Y2hJZCA9IG5ldyBHZW9tZXRyeUF0dHJpYnV0ZSh7XG4gICAgY29tcG9uZW50RGF0YXR5cGU6IENvbXBvbmVudERhdGF0eXBlLkZMT0FULFxuICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGU6IDEsXG4gICAgdmFsdWVzOiBuZXcgRmxvYXQzMkFycmF5KG51bWJlck9mQ29tcG9uZW50cyksXG4gIH0pO1xuXG4gIHZhciB2YWx1ZXMgPSBhdHRyaWJ1dGVzLmJhdGNoSWQudmFsdWVzO1xuICBmb3IgKHZhciBqID0gMDsgaiA8IG51bWJlck9mQ29tcG9uZW50czsgKytqKSB7XG4gICAgdmFsdWVzW2pdID0gYmF0Y2hJZDtcbiAgfVxufVxuXG5mdW5jdGlvbiBhZGRCYXRjaElkcyhpbnN0YW5jZXMpIHtcbiAgdmFyIGxlbmd0aCA9IGluc3RhbmNlcy5sZW5ndGg7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIHZhciBpbnN0YW5jZSA9IGluc3RhbmNlc1tpXTtcbiAgICBpZiAoZGVmaW5lZChpbnN0YW5jZS5nZW9tZXRyeSkpIHtcbiAgICAgIGFkZEdlb21ldHJ5QmF0Y2hJZChpbnN0YW5jZS5nZW9tZXRyeSwgaSk7XG4gICAgfSBlbHNlIGlmIChcbiAgICAgIGRlZmluZWQoaW5zdGFuY2Uud2VzdEhlbWlzcGhlcmVHZW9tZXRyeSkgJiZcbiAgICAgIGRlZmluZWQoaW5zdGFuY2UuZWFzdEhlbWlzcGhlcmVHZW9tZXRyeSlcbiAgICApIHtcbiAgICAgIGFkZEdlb21ldHJ5QmF0Y2hJZChpbnN0YW5jZS53ZXN0SGVtaXNwaGVyZUdlb21ldHJ5LCBpKTtcbiAgICAgIGFkZEdlb21ldHJ5QmF0Y2hJZChpbnN0YW5jZS5lYXN0SGVtaXNwaGVyZUdlb21ldHJ5LCBpKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2VvbWV0cnlQaXBlbGluZShwYXJhbWV0ZXJzKSB7XG4gIHZhciBpbnN0YW5jZXMgPSBwYXJhbWV0ZXJzLmluc3RhbmNlcztcbiAgdmFyIHByb2plY3Rpb24gPSBwYXJhbWV0ZXJzLnByb2plY3Rpb247XG4gIHZhciB1aW50SW5kZXhTdXBwb3J0ID0gcGFyYW1ldGVycy5lbGVtZW50SW5kZXhVaW50U3VwcG9ydGVkO1xuICB2YXIgc2NlbmUzRE9ubHkgPSBwYXJhbWV0ZXJzLnNjZW5lM0RPbmx5O1xuICB2YXIgdmVydGV4Q2FjaGVPcHRpbWl6ZSA9IHBhcmFtZXRlcnMudmVydGV4Q2FjaGVPcHRpbWl6ZTtcbiAgdmFyIGNvbXByZXNzVmVydGljZXMgPSBwYXJhbWV0ZXJzLmNvbXByZXNzVmVydGljZXM7XG4gIHZhciBtb2RlbE1hdHJpeCA9IHBhcmFtZXRlcnMubW9kZWxNYXRyaXg7XG5cbiAgdmFyIGk7XG4gIHZhciBnZW9tZXRyeTtcbiAgdmFyIHByaW1pdGl2ZVR5cGU7XG4gIHZhciBsZW5ndGggPSBpbnN0YW5jZXMubGVuZ3RoO1xuXG4gIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIGlmIChkZWZpbmVkKGluc3RhbmNlc1tpXS5nZW9tZXRyeSkpIHtcbiAgICAgIHByaW1pdGl2ZVR5cGUgPSBpbnN0YW5jZXNbaV0uZ2VvbWV0cnkucHJpbWl0aXZlVHlwZTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIGZvciAoaSA9IDE7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIGlmIChcbiAgICAgIGRlZmluZWQoaW5zdGFuY2VzW2ldLmdlb21ldHJ5KSAmJlxuICAgICAgaW5zdGFuY2VzW2ldLmdlb21ldHJ5LnByaW1pdGl2ZVR5cGUgIT09IHByaW1pdGl2ZVR5cGVcbiAgICApIHtcbiAgICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcbiAgICAgICAgXCJBbGwgaW5zdGFuY2UgZ2VvbWV0cmllcyBtdXN0IGhhdmUgdGhlIHNhbWUgcHJpbWl0aXZlVHlwZS5cIlxuICAgICAgKTtcbiAgICB9XG4gIH1cbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgLy8gVW5pZnkgdG8gd29ybGQgY29vcmRpbmF0ZXMgYmVmb3JlIGNvbWJpbmluZy5cbiAgdHJhbnNmb3JtVG9Xb3JsZENvb3JkaW5hdGVzKGluc3RhbmNlcywgbW9kZWxNYXRyaXgsIHNjZW5lM0RPbmx5KTtcblxuICAvLyBDbGlwIHRvIElETFxuICBpZiAoIXNjZW5lM0RPbmx5KSB7XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgICBpZiAoZGVmaW5lZChpbnN0YW5jZXNbaV0uZ2VvbWV0cnkpKSB7XG4gICAgICAgIEdlb21ldHJ5UGlwZWxpbmUuc3BsaXRMb25naXR1ZGUoaW5zdGFuY2VzW2ldKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhZGRCYXRjaElkcyhpbnN0YW5jZXMpO1xuXG4gIC8vIE9wdGltaXplIGZvciB2ZXJ0ZXggc2hhZGVyIGNhY2hlc1xuICBpZiAodmVydGV4Q2FjaGVPcHRpbWl6ZSkge1xuICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgICAgdmFyIGluc3RhbmNlID0gaW5zdGFuY2VzW2ldO1xuICAgICAgaWYgKGRlZmluZWQoaW5zdGFuY2UuZ2VvbWV0cnkpKSB7XG4gICAgICAgIEdlb21ldHJ5UGlwZWxpbmUucmVvcmRlckZvclBvc3RWZXJ0ZXhDYWNoZShpbnN0YW5jZS5nZW9tZXRyeSk7XG4gICAgICAgIEdlb21ldHJ5UGlwZWxpbmUucmVvcmRlckZvclByZVZlcnRleENhY2hlKGluc3RhbmNlLmdlb21ldHJ5KTtcbiAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgIGRlZmluZWQoaW5zdGFuY2Uud2VzdEhlbWlzcGhlcmVHZW9tZXRyeSkgJiZcbiAgICAgICAgZGVmaW5lZChpbnN0YW5jZS5lYXN0SGVtaXNwaGVyZUdlb21ldHJ5KVxuICAgICAgKSB7XG4gICAgICAgIEdlb21ldHJ5UGlwZWxpbmUucmVvcmRlckZvclBvc3RWZXJ0ZXhDYWNoZShcbiAgICAgICAgICBpbnN0YW5jZS53ZXN0SGVtaXNwaGVyZUdlb21ldHJ5XG4gICAgICAgICk7XG4gICAgICAgIEdlb21ldHJ5UGlwZWxpbmUucmVvcmRlckZvclByZVZlcnRleENhY2hlKFxuICAgICAgICAgIGluc3RhbmNlLndlc3RIZW1pc3BoZXJlR2VvbWV0cnlcbiAgICAgICAgKTtcblxuICAgICAgICBHZW9tZXRyeVBpcGVsaW5lLnJlb3JkZXJGb3JQb3N0VmVydGV4Q2FjaGUoXG4gICAgICAgICAgaW5zdGFuY2UuZWFzdEhlbWlzcGhlcmVHZW9tZXRyeVxuICAgICAgICApO1xuICAgICAgICBHZW9tZXRyeVBpcGVsaW5lLnJlb3JkZXJGb3JQcmVWZXJ0ZXhDYWNoZShcbiAgICAgICAgICBpbnN0YW5jZS5lYXN0SGVtaXNwaGVyZUdlb21ldHJ5XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gQ29tYmluZSBpbnRvIHNpbmdsZSBnZW9tZXRyeSBmb3IgYmV0dGVyIHJlbmRlcmluZyBwZXJmb3JtYW5jZS5cbiAgdmFyIGdlb21ldHJpZXMgPSBHZW9tZXRyeVBpcGVsaW5lLmNvbWJpbmVJbnN0YW5jZXMoaW5zdGFuY2VzKTtcblxuICBsZW5ndGggPSBnZW9tZXRyaWVzLmxlbmd0aDtcbiAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgZ2VvbWV0cnkgPSBnZW9tZXRyaWVzW2ldO1xuXG4gICAgLy8gU3BsaXQgcG9zaXRpb25zIGZvciBHUFUgUlRFXG4gICAgdmFyIGF0dHJpYnV0ZXMgPSBnZW9tZXRyeS5hdHRyaWJ1dGVzO1xuICAgIHZhciBuYW1lO1xuICAgIGlmICghc2NlbmUzRE9ubHkpIHtcbiAgICAgIGZvciAobmFtZSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICBhdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KG5hbWUpICYmXG4gICAgICAgICAgYXR0cmlidXRlc1tuYW1lXS5jb21wb25lbnREYXRhdHlwZSA9PT0gQ29tcG9uZW50RGF0YXR5cGUuRE9VQkxFXG4gICAgICAgICkge1xuICAgICAgICAgIHZhciBuYW1lM0QgPSBuYW1lICsgXCIzRFwiO1xuICAgICAgICAgIHZhciBuYW1lMkQgPSBuYW1lICsgXCIyRFwiO1xuXG4gICAgICAgICAgLy8gQ29tcHV0ZSAyRCBwb3NpdGlvbnNcbiAgICAgICAgICBHZW9tZXRyeVBpcGVsaW5lLnByb2plY3RUbzJEKFxuICAgICAgICAgICAgZ2VvbWV0cnksXG4gICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgbmFtZTNELFxuICAgICAgICAgICAgbmFtZTJELFxuICAgICAgICAgICAgcHJvamVjdGlvblxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKGRlZmluZWQoZ2VvbWV0cnkuYm91bmRpbmdTcGhlcmUpICYmIG5hbWUgPT09IFwicG9zaXRpb25cIikge1xuICAgICAgICAgICAgZ2VvbWV0cnkuYm91bmRpbmdTcGhlcmVDViA9IEJvdW5kaW5nU3BoZXJlLmZyb21WZXJ0aWNlcyhcbiAgICAgICAgICAgICAgZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbjJELnZhbHVlc1xuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBHZW9tZXRyeVBpcGVsaW5lLmVuY29kZUF0dHJpYnV0ZShcbiAgICAgICAgICAgIGdlb21ldHJ5LFxuICAgICAgICAgICAgbmFtZTNELFxuICAgICAgICAgICAgbmFtZTNEICsgXCJIaWdoXCIsXG4gICAgICAgICAgICBuYW1lM0QgKyBcIkxvd1wiXG4gICAgICAgICAgKTtcbiAgICAgICAgICBHZW9tZXRyeVBpcGVsaW5lLmVuY29kZUF0dHJpYnV0ZShcbiAgICAgICAgICAgIGdlb21ldHJ5LFxuICAgICAgICAgICAgbmFtZTJELFxuICAgICAgICAgICAgbmFtZTJEICsgXCJIaWdoXCIsXG4gICAgICAgICAgICBuYW1lMkQgKyBcIkxvd1wiXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKG5hbWUgaW4gYXR0cmlidXRlcykge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgYXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSAmJlxuICAgICAgICAgIGF0dHJpYnV0ZXNbbmFtZV0uY29tcG9uZW50RGF0YXR5cGUgPT09IENvbXBvbmVudERhdGF0eXBlLkRPVUJMRVxuICAgICAgICApIHtcbiAgICAgICAgICBHZW9tZXRyeVBpcGVsaW5lLmVuY29kZUF0dHJpYnV0ZShcbiAgICAgICAgICAgIGdlb21ldHJ5LFxuICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgIG5hbWUgKyBcIjNESGlnaFwiLFxuICAgICAgICAgICAgbmFtZSArIFwiM0RMb3dcIlxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBvY3QgZW5jb2RlIGFuZCBwYWNrIG5vcm1hbHMsIGNvbXByZXNzIHRleHR1cmUgY29vcmRpbmF0ZXNcbiAgICBpZiAoY29tcHJlc3NWZXJ0aWNlcykge1xuICAgICAgR2VvbWV0cnlQaXBlbGluZS5jb21wcmVzc1ZlcnRpY2VzKGdlb21ldHJ5KTtcbiAgICB9XG4gIH1cblxuICBpZiAoIXVpbnRJbmRleFN1cHBvcnQpIHtcbiAgICAvLyBCcmVhayBpbnRvIG11bHRpcGxlIGdlb21ldHJpZXMgdG8gZml0IHdpdGhpbiB1bnNpZ25lZCBzaG9ydCBpbmRpY2VzIGlmIG5lZWRlZFxuICAgIHZhciBzcGxpdEdlb21ldHJpZXMgPSBbXTtcbiAgICBsZW5ndGggPSBnZW9tZXRyaWVzLmxlbmd0aDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICAgIGdlb21ldHJ5ID0gZ2VvbWV0cmllc1tpXTtcbiAgICAgIHNwbGl0R2VvbWV0cmllcyA9IHNwbGl0R2VvbWV0cmllcy5jb25jYXQoXG4gICAgICAgIEdlb21ldHJ5UGlwZWxpbmUuZml0VG9VbnNpZ25lZFNob3J0SW5kaWNlcyhnZW9tZXRyeSlcbiAgICAgICk7XG4gICAgfVxuXG4gICAgZ2VvbWV0cmllcyA9IHNwbGl0R2VvbWV0cmllcztcbiAgfVxuXG4gIHJldHVybiBnZW9tZXRyaWVzO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVQaWNrT2Zmc2V0cyhpbnN0YW5jZXMsIGdlb21ldHJ5TmFtZSwgZ2VvbWV0cmllcywgcGlja09mZnNldHMpIHtcbiAgdmFyIG9mZnNldDtcbiAgdmFyIGluZGV4Q291bnQ7XG4gIHZhciBnZW9tZXRyeUluZGV4O1xuXG4gIHZhciBvZmZzZXRJbmRleCA9IHBpY2tPZmZzZXRzLmxlbmd0aCAtIDE7XG4gIGlmIChvZmZzZXRJbmRleCA+PSAwKSB7XG4gICAgdmFyIHBpY2tPZmZzZXQgPSBwaWNrT2Zmc2V0c1tvZmZzZXRJbmRleF07XG4gICAgb2Zmc2V0ID0gcGlja09mZnNldC5vZmZzZXQgKyBwaWNrT2Zmc2V0LmNvdW50O1xuICAgIGdlb21ldHJ5SW5kZXggPSBwaWNrT2Zmc2V0LmluZGV4O1xuICAgIGluZGV4Q291bnQgPSBnZW9tZXRyaWVzW2dlb21ldHJ5SW5kZXhdLmluZGljZXMubGVuZ3RoO1xuICB9IGVsc2Uge1xuICAgIG9mZnNldCA9IDA7XG4gICAgZ2VvbWV0cnlJbmRleCA9IDA7XG4gICAgaW5kZXhDb3VudCA9IGdlb21ldHJpZXNbZ2VvbWV0cnlJbmRleF0uaW5kaWNlcy5sZW5ndGg7XG4gIH1cblxuICB2YXIgbGVuZ3RoID0gaW5zdGFuY2VzLmxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIHZhciBpbnN0YW5jZSA9IGluc3RhbmNlc1tpXTtcbiAgICB2YXIgZ2VvbWV0cnkgPSBpbnN0YW5jZVtnZW9tZXRyeU5hbWVdO1xuICAgIGlmICghZGVmaW5lZChnZW9tZXRyeSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIHZhciBjb3VudCA9IGdlb21ldHJ5LmluZGljZXMubGVuZ3RoO1xuXG4gICAgaWYgKG9mZnNldCArIGNvdW50ID4gaW5kZXhDb3VudCkge1xuICAgICAgb2Zmc2V0ID0gMDtcbiAgICAgIGluZGV4Q291bnQgPSBnZW9tZXRyaWVzWysrZ2VvbWV0cnlJbmRleF0uaW5kaWNlcy5sZW5ndGg7XG4gICAgfVxuXG4gICAgcGlja09mZnNldHMucHVzaCh7XG4gICAgICBpbmRleDogZ2VvbWV0cnlJbmRleCxcbiAgICAgIG9mZnNldDogb2Zmc2V0LFxuICAgICAgY291bnQ6IGNvdW50LFxuICAgIH0pO1xuICAgIG9mZnNldCArPSBjb3VudDtcbiAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVJbnN0YW5jZVBpY2tPZmZzZXRzKGluc3RhbmNlcywgZ2VvbWV0cmllcykge1xuICB2YXIgcGlja09mZnNldHMgPSBbXTtcbiAgY3JlYXRlUGlja09mZnNldHMoaW5zdGFuY2VzLCBcImdlb21ldHJ5XCIsIGdlb21ldHJpZXMsIHBpY2tPZmZzZXRzKTtcbiAgY3JlYXRlUGlja09mZnNldHMoXG4gICAgaW5zdGFuY2VzLFxuICAgIFwid2VzdEhlbWlzcGhlcmVHZW9tZXRyeVwiLFxuICAgIGdlb21ldHJpZXMsXG4gICAgcGlja09mZnNldHNcbiAgKTtcbiAgY3JlYXRlUGlja09mZnNldHMoXG4gICAgaW5zdGFuY2VzLFxuICAgIFwiZWFzdEhlbWlzcGhlcmVHZW9tZXRyeVwiLFxuICAgIGdlb21ldHJpZXMsXG4gICAgcGlja09mZnNldHNcbiAgKTtcbiAgcmV0dXJuIHBpY2tPZmZzZXRzO1xufVxuXG4vKipcbiAqIEBwcml2YXRlXG4gKi9cbnZhciBQcmltaXRpdmVQaXBlbGluZSA9IHt9O1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKi9cblByaW1pdGl2ZVBpcGVsaW5lLmNvbWJpbmVHZW9tZXRyeSA9IGZ1bmN0aW9uIChwYXJhbWV0ZXJzKSB7XG4gIHZhciBnZW9tZXRyaWVzO1xuICB2YXIgYXR0cmlidXRlTG9jYXRpb25zO1xuICB2YXIgaW5zdGFuY2VzID0gcGFyYW1ldGVycy5pbnN0YW5jZXM7XG4gIHZhciBsZW5ndGggPSBpbnN0YW5jZXMubGVuZ3RoO1xuICB2YXIgcGlja09mZnNldHM7XG5cbiAgdmFyIG9mZnNldEluc3RhbmNlRXh0ZW5kO1xuICB2YXIgaGFzT2Zmc2V0ID0gZmFsc2U7XG4gIGlmIChsZW5ndGggPiAwKSB7XG4gICAgZ2VvbWV0cmllcyA9IGdlb21ldHJ5UGlwZWxpbmUocGFyYW1ldGVycyk7XG4gICAgaWYgKGdlb21ldHJpZXMubGVuZ3RoID4gMCkge1xuICAgICAgYXR0cmlidXRlTG9jYXRpb25zID0gR2VvbWV0cnlQaXBlbGluZS5jcmVhdGVBdHRyaWJ1dGVMb2NhdGlvbnMoXG4gICAgICAgIGdlb21ldHJpZXNbMF1cbiAgICAgICk7XG4gICAgICBpZiAocGFyYW1ldGVycy5jcmVhdGVQaWNrT2Zmc2V0cykge1xuICAgICAgICBwaWNrT2Zmc2V0cyA9IGNyZWF0ZUluc3RhbmNlUGlja09mZnNldHMoaW5zdGFuY2VzLCBnZW9tZXRyaWVzKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKFxuICAgICAgZGVmaW5lZChpbnN0YW5jZXNbMF0uYXR0cmlidXRlcykgJiZcbiAgICAgIGRlZmluZWQoaW5zdGFuY2VzWzBdLmF0dHJpYnV0ZXMub2Zmc2V0KVxuICAgICkge1xuICAgICAgb2Zmc2V0SW5zdGFuY2VFeHRlbmQgPSBuZXcgQXJyYXkobGVuZ3RoKTtcbiAgICAgIGhhc09mZnNldCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgdmFyIGJvdW5kaW5nU3BoZXJlcyA9IG5ldyBBcnJheShsZW5ndGgpO1xuICB2YXIgYm91bmRpbmdTcGhlcmVzQ1YgPSBuZXcgQXJyYXkobGVuZ3RoKTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIHZhciBpbnN0YW5jZSA9IGluc3RhbmNlc1tpXTtcbiAgICB2YXIgZ2VvbWV0cnkgPSBpbnN0YW5jZS5nZW9tZXRyeTtcbiAgICBpZiAoZGVmaW5lZChnZW9tZXRyeSkpIHtcbiAgICAgIGJvdW5kaW5nU3BoZXJlc1tpXSA9IGdlb21ldHJ5LmJvdW5kaW5nU3BoZXJlO1xuICAgICAgYm91bmRpbmdTcGhlcmVzQ1ZbaV0gPSBnZW9tZXRyeS5ib3VuZGluZ1NwaGVyZUNWO1xuICAgICAgaWYgKGhhc09mZnNldCkge1xuICAgICAgICBvZmZzZXRJbnN0YW5jZUV4dGVuZFtpXSA9IGluc3RhbmNlLmdlb21ldHJ5Lm9mZnNldEF0dHJpYnV0ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgZWFzdEhlbWlzcGhlcmVHZW9tZXRyeSA9IGluc3RhbmNlLmVhc3RIZW1pc3BoZXJlR2VvbWV0cnk7XG4gICAgdmFyIHdlc3RIZW1pc3BoZXJlR2VvbWV0cnkgPSBpbnN0YW5jZS53ZXN0SGVtaXNwaGVyZUdlb21ldHJ5O1xuICAgIGlmIChkZWZpbmVkKGVhc3RIZW1pc3BoZXJlR2VvbWV0cnkpICYmIGRlZmluZWQod2VzdEhlbWlzcGhlcmVHZW9tZXRyeSkpIHtcbiAgICAgIGlmIChcbiAgICAgICAgZGVmaW5lZChlYXN0SGVtaXNwaGVyZUdlb21ldHJ5LmJvdW5kaW5nU3BoZXJlKSAmJlxuICAgICAgICBkZWZpbmVkKHdlc3RIZW1pc3BoZXJlR2VvbWV0cnkuYm91bmRpbmdTcGhlcmUpXG4gICAgICApIHtcbiAgICAgICAgYm91bmRpbmdTcGhlcmVzW2ldID0gQm91bmRpbmdTcGhlcmUudW5pb24oXG4gICAgICAgICAgZWFzdEhlbWlzcGhlcmVHZW9tZXRyeS5ib3VuZGluZ1NwaGVyZSxcbiAgICAgICAgICB3ZXN0SGVtaXNwaGVyZUdlb21ldHJ5LmJvdW5kaW5nU3BoZXJlXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBpZiAoXG4gICAgICAgIGRlZmluZWQoZWFzdEhlbWlzcGhlcmVHZW9tZXRyeS5ib3VuZGluZ1NwaGVyZUNWKSAmJlxuICAgICAgICBkZWZpbmVkKHdlc3RIZW1pc3BoZXJlR2VvbWV0cnkuYm91bmRpbmdTcGhlcmVDVilcbiAgICAgICkge1xuICAgICAgICBib3VuZGluZ1NwaGVyZXNDVltpXSA9IEJvdW5kaW5nU3BoZXJlLnVuaW9uKFxuICAgICAgICAgIGVhc3RIZW1pc3BoZXJlR2VvbWV0cnkuYm91bmRpbmdTcGhlcmVDVixcbiAgICAgICAgICB3ZXN0SGVtaXNwaGVyZUdlb21ldHJ5LmJvdW5kaW5nU3BoZXJlQ1ZcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGdlb21ldHJpZXM6IGdlb21ldHJpZXMsXG4gICAgbW9kZWxNYXRyaXg6IHBhcmFtZXRlcnMubW9kZWxNYXRyaXgsXG4gICAgYXR0cmlidXRlTG9jYXRpb25zOiBhdHRyaWJ1dGVMb2NhdGlvbnMsXG4gICAgcGlja09mZnNldHM6IHBpY2tPZmZzZXRzLFxuICAgIG9mZnNldEluc3RhbmNlRXh0ZW5kOiBvZmZzZXRJbnN0YW5jZUV4dGVuZCxcbiAgICBib3VuZGluZ1NwaGVyZXM6IGJvdW5kaW5nU3BoZXJlcyxcbiAgICBib3VuZGluZ1NwaGVyZXNDVjogYm91bmRpbmdTcGhlcmVzQ1YsXG4gIH07XG59O1xuXG5mdW5jdGlvbiB0cmFuc2Zlckdlb21ldHJ5KGdlb21ldHJ5LCB0cmFuc2ZlcmFibGVPYmplY3RzKSB7XG4gIHZhciBhdHRyaWJ1dGVzID0gZ2VvbWV0cnkuYXR0cmlidXRlcztcbiAgZm9yICh2YXIgbmFtZSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgaWYgKGF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgIHZhciBhdHRyaWJ1dGUgPSBhdHRyaWJ1dGVzW25hbWVdO1xuXG4gICAgICBpZiAoZGVmaW5lZChhdHRyaWJ1dGUpICYmIGRlZmluZWQoYXR0cmlidXRlLnZhbHVlcykpIHtcbiAgICAgICAgdHJhbnNmZXJhYmxlT2JqZWN0cy5wdXNoKGF0dHJpYnV0ZS52YWx1ZXMuYnVmZmVyKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAoZGVmaW5lZChnZW9tZXRyeS5pbmRpY2VzKSkge1xuICAgIHRyYW5zZmVyYWJsZU9iamVjdHMucHVzaChnZW9tZXRyeS5pbmRpY2VzLmJ1ZmZlcik7XG4gIH1cbn1cblxuZnVuY3Rpb24gdHJhbnNmZXJHZW9tZXRyaWVzKGdlb21ldHJpZXMsIHRyYW5zZmVyYWJsZU9iamVjdHMpIHtcbiAgdmFyIGxlbmd0aCA9IGdlb21ldHJpZXMubGVuZ3RoO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgdHJhbnNmZXJHZW9tZXRyeShnZW9tZXRyaWVzW2ldLCB0cmFuc2ZlcmFibGVPYmplY3RzKTtcbiAgfVxufVxuXG4vLyBUaGlzIGZ1bmN0aW9uIHdhcyBjcmVhdGVkIGJ5IHNpbXBsaWZ5aW5nIHBhY2tDcmVhdGVHZW9tZXRyeVJlc3VsdHMgaW50byBhIGNvdW50LW9ubHkgb3BlcmF0aW9uLlxuZnVuY3Rpb24gY291bnRDcmVhdGVHZW9tZXRyeVJlc3VsdHMoaXRlbXMpIHtcbiAgdmFyIGNvdW50ID0gMTtcbiAgdmFyIGxlbmd0aCA9IGl0ZW1zLmxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIHZhciBnZW9tZXRyeSA9IGl0ZW1zW2ldO1xuICAgICsrY291bnQ7XG5cbiAgICBpZiAoIWRlZmluZWQoZ2VvbWV0cnkpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICB2YXIgYXR0cmlidXRlcyA9IGdlb21ldHJ5LmF0dHJpYnV0ZXM7XG5cbiAgICBjb3VudCArPVxuICAgICAgNyArXG4gICAgICAyICogQm91bmRpbmdTcGhlcmUucGFja2VkTGVuZ3RoICtcbiAgICAgIChkZWZpbmVkKGdlb21ldHJ5LmluZGljZXMpID8gZ2VvbWV0cnkuaW5kaWNlcy5sZW5ndGggOiAwKTtcblxuICAgIGZvciAodmFyIHByb3BlcnR5IGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgIGlmIChcbiAgICAgICAgYXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eSkgJiZcbiAgICAgICAgZGVmaW5lZChhdHRyaWJ1dGVzW3Byb3BlcnR5XSlcbiAgICAgICkge1xuICAgICAgICB2YXIgYXR0cmlidXRlID0gYXR0cmlidXRlc1twcm9wZXJ0eV07XG4gICAgICAgIGNvdW50ICs9IDUgKyBhdHRyaWJ1dGUudmFsdWVzLmxlbmd0aDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gY291bnQ7XG59XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuUHJpbWl0aXZlUGlwZWxpbmUucGFja0NyZWF0ZUdlb21ldHJ5UmVzdWx0cyA9IGZ1bmN0aW9uIChcbiAgaXRlbXMsXG4gIHRyYW5zZmVyYWJsZU9iamVjdHNcbikge1xuICB2YXIgcGFja2VkRGF0YSA9IG5ldyBGbG9hdDY0QXJyYXkoY291bnRDcmVhdGVHZW9tZXRyeVJlc3VsdHMoaXRlbXMpKTtcbiAgdmFyIHN0cmluZ1RhYmxlID0gW107XG4gIHZhciBzdHJpbmdIYXNoID0ge307XG5cbiAgdmFyIGxlbmd0aCA9IGl0ZW1zLmxlbmd0aDtcbiAgdmFyIGNvdW50ID0gMDtcbiAgcGFja2VkRGF0YVtjb3VudCsrXSA9IGxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIHZhciBnZW9tZXRyeSA9IGl0ZW1zW2ldO1xuXG4gICAgdmFyIHZhbGlkR2VvbWV0cnkgPSBkZWZpbmVkKGdlb21ldHJ5KTtcbiAgICBwYWNrZWREYXRhW2NvdW50KytdID0gdmFsaWRHZW9tZXRyeSA/IDEuMCA6IDAuMDtcblxuICAgIGlmICghdmFsaWRHZW9tZXRyeSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgcGFja2VkRGF0YVtjb3VudCsrXSA9IGdlb21ldHJ5LnByaW1pdGl2ZVR5cGU7XG4gICAgcGFja2VkRGF0YVtjb3VudCsrXSA9IGdlb21ldHJ5Lmdlb21ldHJ5VHlwZTtcbiAgICBwYWNrZWREYXRhW2NvdW50KytdID0gZGVmYXVsdFZhbHVlKGdlb21ldHJ5Lm9mZnNldEF0dHJpYnV0ZSwgLTEpO1xuXG4gICAgdmFyIHZhbGlkQm91bmRpbmdTcGhlcmUgPSBkZWZpbmVkKGdlb21ldHJ5LmJvdW5kaW5nU3BoZXJlKSA/IDEuMCA6IDAuMDtcbiAgICBwYWNrZWREYXRhW2NvdW50KytdID0gdmFsaWRCb3VuZGluZ1NwaGVyZTtcbiAgICBpZiAodmFsaWRCb3VuZGluZ1NwaGVyZSkge1xuICAgICAgQm91bmRpbmdTcGhlcmUucGFjayhnZW9tZXRyeS5ib3VuZGluZ1NwaGVyZSwgcGFja2VkRGF0YSwgY291bnQpO1xuICAgIH1cblxuICAgIGNvdW50ICs9IEJvdW5kaW5nU3BoZXJlLnBhY2tlZExlbmd0aDtcblxuICAgIHZhciB2YWxpZEJvdW5kaW5nU3BoZXJlQ1YgPSBkZWZpbmVkKGdlb21ldHJ5LmJvdW5kaW5nU3BoZXJlQ1YpID8gMS4wIDogMC4wO1xuICAgIHBhY2tlZERhdGFbY291bnQrK10gPSB2YWxpZEJvdW5kaW5nU3BoZXJlQ1Y7XG4gICAgaWYgKHZhbGlkQm91bmRpbmdTcGhlcmVDVikge1xuICAgICAgQm91bmRpbmdTcGhlcmUucGFjayhnZW9tZXRyeS5ib3VuZGluZ1NwaGVyZUNWLCBwYWNrZWREYXRhLCBjb3VudCk7XG4gICAgfVxuXG4gICAgY291bnQgKz0gQm91bmRpbmdTcGhlcmUucGFja2VkTGVuZ3RoO1xuXG4gICAgdmFyIGF0dHJpYnV0ZXMgPSBnZW9tZXRyeS5hdHRyaWJ1dGVzO1xuICAgIHZhciBhdHRyaWJ1dGVzVG9Xcml0ZSA9IFtdO1xuICAgIGZvciAodmFyIHByb3BlcnR5IGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgIGlmIChcbiAgICAgICAgYXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eSkgJiZcbiAgICAgICAgZGVmaW5lZChhdHRyaWJ1dGVzW3Byb3BlcnR5XSlcbiAgICAgICkge1xuICAgICAgICBhdHRyaWJ1dGVzVG9Xcml0ZS5wdXNoKHByb3BlcnR5KTtcbiAgICAgICAgaWYgKCFkZWZpbmVkKHN0cmluZ0hhc2hbcHJvcGVydHldKSkge1xuICAgICAgICAgIHN0cmluZ0hhc2hbcHJvcGVydHldID0gc3RyaW5nVGFibGUubGVuZ3RoO1xuICAgICAgICAgIHN0cmluZ1RhYmxlLnB1c2gocHJvcGVydHkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcGFja2VkRGF0YVtjb3VudCsrXSA9IGF0dHJpYnV0ZXNUb1dyaXRlLmxlbmd0aDtcbiAgICBmb3IgKHZhciBxID0gMDsgcSA8IGF0dHJpYnV0ZXNUb1dyaXRlLmxlbmd0aDsgcSsrKSB7XG4gICAgICB2YXIgbmFtZSA9IGF0dHJpYnV0ZXNUb1dyaXRlW3FdO1xuICAgICAgdmFyIGF0dHJpYnV0ZSA9IGF0dHJpYnV0ZXNbbmFtZV07XG4gICAgICBwYWNrZWREYXRhW2NvdW50KytdID0gc3RyaW5nSGFzaFtuYW1lXTtcbiAgICAgIHBhY2tlZERhdGFbY291bnQrK10gPSBhdHRyaWJ1dGUuY29tcG9uZW50RGF0YXR5cGU7XG4gICAgICBwYWNrZWREYXRhW2NvdW50KytdID0gYXR0cmlidXRlLmNvbXBvbmVudHNQZXJBdHRyaWJ1dGU7XG4gICAgICBwYWNrZWREYXRhW2NvdW50KytdID0gYXR0cmlidXRlLm5vcm1hbGl6ZSA/IDEgOiAwO1xuICAgICAgcGFja2VkRGF0YVtjb3VudCsrXSA9IGF0dHJpYnV0ZS52YWx1ZXMubGVuZ3RoO1xuICAgICAgcGFja2VkRGF0YS5zZXQoYXR0cmlidXRlLnZhbHVlcywgY291bnQpO1xuICAgICAgY291bnQgKz0gYXR0cmlidXRlLnZhbHVlcy5sZW5ndGg7XG4gICAgfVxuXG4gICAgdmFyIGluZGljZXNMZW5ndGggPSBkZWZpbmVkKGdlb21ldHJ5LmluZGljZXMpID8gZ2VvbWV0cnkuaW5kaWNlcy5sZW5ndGggOiAwO1xuICAgIHBhY2tlZERhdGFbY291bnQrK10gPSBpbmRpY2VzTGVuZ3RoO1xuXG4gICAgaWYgKGluZGljZXNMZW5ndGggPiAwKSB7XG4gICAgICBwYWNrZWREYXRhLnNldChnZW9tZXRyeS5pbmRpY2VzLCBjb3VudCk7XG4gICAgICBjb3VudCArPSBpbmRpY2VzTGVuZ3RoO1xuICAgIH1cbiAgfVxuXG4gIHRyYW5zZmVyYWJsZU9iamVjdHMucHVzaChwYWNrZWREYXRhLmJ1ZmZlcik7XG5cbiAgcmV0dXJuIHtcbiAgICBzdHJpbmdUYWJsZTogc3RyaW5nVGFibGUsXG4gICAgcGFja2VkRGF0YTogcGFja2VkRGF0YSxcbiAgfTtcbn07XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuUHJpbWl0aXZlUGlwZWxpbmUudW5wYWNrQ3JlYXRlR2VvbWV0cnlSZXN1bHRzID0gZnVuY3Rpb24gKFxuICBjcmVhdGVHZW9tZXRyeVJlc3VsdFxuKSB7XG4gIHZhciBzdHJpbmdUYWJsZSA9IGNyZWF0ZUdlb21ldHJ5UmVzdWx0LnN0cmluZ1RhYmxlO1xuICB2YXIgcGFja2VkR2VvbWV0cnkgPSBjcmVhdGVHZW9tZXRyeVJlc3VsdC5wYWNrZWREYXRhO1xuXG4gIHZhciBpO1xuICB2YXIgcmVzdWx0ID0gbmV3IEFycmF5KHBhY2tlZEdlb21ldHJ5WzBdKTtcbiAgdmFyIHJlc3VsdEluZGV4ID0gMDtcblxuICB2YXIgcGFja2VkR2VvbWV0cnlJbmRleCA9IDE7XG4gIHdoaWxlIChwYWNrZWRHZW9tZXRyeUluZGV4IDwgcGFja2VkR2VvbWV0cnkubGVuZ3RoKSB7XG4gICAgdmFyIHZhbGlkID0gcGFja2VkR2VvbWV0cnlbcGFja2VkR2VvbWV0cnlJbmRleCsrXSA9PT0gMS4wO1xuICAgIGlmICghdmFsaWQpIHtcbiAgICAgIHJlc3VsdFtyZXN1bHRJbmRleCsrXSA9IHVuZGVmaW5lZDtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIHZhciBwcmltaXRpdmVUeXBlID0gcGFja2VkR2VvbWV0cnlbcGFja2VkR2VvbWV0cnlJbmRleCsrXTtcbiAgICB2YXIgZ2VvbWV0cnlUeXBlID0gcGFja2VkR2VvbWV0cnlbcGFja2VkR2VvbWV0cnlJbmRleCsrXTtcbiAgICB2YXIgb2Zmc2V0QXR0cmlidXRlID0gcGFja2VkR2VvbWV0cnlbcGFja2VkR2VvbWV0cnlJbmRleCsrXTtcbiAgICBpZiAob2Zmc2V0QXR0cmlidXRlID09PSAtMSkge1xuICAgICAgb2Zmc2V0QXR0cmlidXRlID0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHZhciBib3VuZGluZ1NwaGVyZTtcbiAgICB2YXIgYm91bmRpbmdTcGhlcmVDVjtcblxuICAgIHZhciB2YWxpZEJvdW5kaW5nU3BoZXJlID0gcGFja2VkR2VvbWV0cnlbcGFja2VkR2VvbWV0cnlJbmRleCsrXSA9PT0gMS4wO1xuICAgIGlmICh2YWxpZEJvdW5kaW5nU3BoZXJlKSB7XG4gICAgICBib3VuZGluZ1NwaGVyZSA9IEJvdW5kaW5nU3BoZXJlLnVucGFjayhcbiAgICAgICAgcGFja2VkR2VvbWV0cnksXG4gICAgICAgIHBhY2tlZEdlb21ldHJ5SW5kZXhcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcGFja2VkR2VvbWV0cnlJbmRleCArPSBCb3VuZGluZ1NwaGVyZS5wYWNrZWRMZW5ndGg7XG5cbiAgICB2YXIgdmFsaWRCb3VuZGluZ1NwaGVyZUNWID0gcGFja2VkR2VvbWV0cnlbcGFja2VkR2VvbWV0cnlJbmRleCsrXSA9PT0gMS4wO1xuICAgIGlmICh2YWxpZEJvdW5kaW5nU3BoZXJlQ1YpIHtcbiAgICAgIGJvdW5kaW5nU3BoZXJlQ1YgPSBCb3VuZGluZ1NwaGVyZS51bnBhY2soXG4gICAgICAgIHBhY2tlZEdlb21ldHJ5LFxuICAgICAgICBwYWNrZWRHZW9tZXRyeUluZGV4XG4gICAgICApO1xuICAgIH1cblxuICAgIHBhY2tlZEdlb21ldHJ5SW5kZXggKz0gQm91bmRpbmdTcGhlcmUucGFja2VkTGVuZ3RoO1xuXG4gICAgdmFyIGxlbmd0aDtcbiAgICB2YXIgdmFsdWVzO1xuICAgIHZhciBjb21wb25lbnRzUGVyQXR0cmlidXRlO1xuICAgIHZhciBhdHRyaWJ1dGVzID0gbmV3IEdlb21ldHJ5QXR0cmlidXRlcygpO1xuICAgIHZhciBudW1BdHRyaWJ1dGVzID0gcGFja2VkR2VvbWV0cnlbcGFja2VkR2VvbWV0cnlJbmRleCsrXTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbnVtQXR0cmlidXRlczsgaSsrKSB7XG4gICAgICB2YXIgbmFtZSA9IHN0cmluZ1RhYmxlW3BhY2tlZEdlb21ldHJ5W3BhY2tlZEdlb21ldHJ5SW5kZXgrK11dO1xuICAgICAgdmFyIGNvbXBvbmVudERhdGF0eXBlID0gcGFja2VkR2VvbWV0cnlbcGFja2VkR2VvbWV0cnlJbmRleCsrXTtcbiAgICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGUgPSBwYWNrZWRHZW9tZXRyeVtwYWNrZWRHZW9tZXRyeUluZGV4KytdO1xuICAgICAgdmFyIG5vcm1hbGl6ZSA9IHBhY2tlZEdlb21ldHJ5W3BhY2tlZEdlb21ldHJ5SW5kZXgrK10gIT09IDA7XG5cbiAgICAgIGxlbmd0aCA9IHBhY2tlZEdlb21ldHJ5W3BhY2tlZEdlb21ldHJ5SW5kZXgrK107XG4gICAgICB2YWx1ZXMgPSBDb21wb25lbnREYXRhdHlwZS5jcmVhdGVUeXBlZEFycmF5KGNvbXBvbmVudERhdGF0eXBlLCBsZW5ndGgpO1xuICAgICAgZm9yICh2YXIgdmFsdWVzSW5kZXggPSAwOyB2YWx1ZXNJbmRleCA8IGxlbmd0aDsgdmFsdWVzSW5kZXgrKykge1xuICAgICAgICB2YWx1ZXNbdmFsdWVzSW5kZXhdID0gcGFja2VkR2VvbWV0cnlbcGFja2VkR2VvbWV0cnlJbmRleCsrXTtcbiAgICAgIH1cblxuICAgICAgYXR0cmlidXRlc1tuYW1lXSA9IG5ldyBHZW9tZXRyeUF0dHJpYnV0ZSh7XG4gICAgICAgIGNvbXBvbmVudERhdGF0eXBlOiBjb21wb25lbnREYXRhdHlwZSxcbiAgICAgICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogY29tcG9uZW50c1BlckF0dHJpYnV0ZSxcbiAgICAgICAgbm9ybWFsaXplOiBub3JtYWxpemUsXG4gICAgICAgIHZhbHVlczogdmFsdWVzLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdmFyIGluZGljZXM7XG4gICAgbGVuZ3RoID0gcGFja2VkR2VvbWV0cnlbcGFja2VkR2VvbWV0cnlJbmRleCsrXTtcblxuICAgIGlmIChsZW5ndGggPiAwKSB7XG4gICAgICB2YXIgbnVtYmVyT2ZWZXJ0aWNlcyA9IHZhbHVlcy5sZW5ndGggLyBjb21wb25lbnRzUGVyQXR0cmlidXRlO1xuICAgICAgaW5kaWNlcyA9IEluZGV4RGF0YXR5cGUuY3JlYXRlVHlwZWRBcnJheShudW1iZXJPZlZlcnRpY2VzLCBsZW5ndGgpO1xuICAgICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGluZGljZXNbaV0gPSBwYWNrZWRHZW9tZXRyeVtwYWNrZWRHZW9tZXRyeUluZGV4KytdO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJlc3VsdFtyZXN1bHRJbmRleCsrXSA9IG5ldyBHZW9tZXRyeSh7XG4gICAgICBwcmltaXRpdmVUeXBlOiBwcmltaXRpdmVUeXBlLFxuICAgICAgZ2VvbWV0cnlUeXBlOiBnZW9tZXRyeVR5cGUsXG4gICAgICBib3VuZGluZ1NwaGVyZTogYm91bmRpbmdTcGhlcmUsXG4gICAgICBib3VuZGluZ1NwaGVyZUNWOiBib3VuZGluZ1NwaGVyZUNWLFxuICAgICAgaW5kaWNlczogaW5kaWNlcyxcbiAgICAgIGF0dHJpYnV0ZXM6IGF0dHJpYnV0ZXMsXG4gICAgICBvZmZzZXRBdHRyaWJ1dGU6IG9mZnNldEF0dHJpYnV0ZSxcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5mdW5jdGlvbiBwYWNrSW5zdGFuY2VzRm9yQ29tYmluZShpbnN0YW5jZXMsIHRyYW5zZmVyYWJsZU9iamVjdHMpIHtcbiAgdmFyIGxlbmd0aCA9IGluc3RhbmNlcy5sZW5ndGg7XG4gIHZhciBwYWNrZWREYXRhID0gbmV3IEZsb2F0NjRBcnJheSgxICsgbGVuZ3RoICogMTkpO1xuICB2YXIgY291bnQgPSAwO1xuICBwYWNrZWREYXRhW2NvdW50KytdID0gbGVuZ3RoO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGluc3RhbmNlID0gaW5zdGFuY2VzW2ldO1xuICAgIE1hdHJpeDQucGFjayhpbnN0YW5jZS5tb2RlbE1hdHJpeCwgcGFja2VkRGF0YSwgY291bnQpO1xuICAgIGNvdW50ICs9IE1hdHJpeDQucGFja2VkTGVuZ3RoO1xuICAgIGlmIChkZWZpbmVkKGluc3RhbmNlLmF0dHJpYnV0ZXMpICYmIGRlZmluZWQoaW5zdGFuY2UuYXR0cmlidXRlcy5vZmZzZXQpKSB7XG4gICAgICB2YXIgdmFsdWVzID0gaW5zdGFuY2UuYXR0cmlidXRlcy5vZmZzZXQudmFsdWU7XG4gICAgICBwYWNrZWREYXRhW2NvdW50XSA9IHZhbHVlc1swXTtcbiAgICAgIHBhY2tlZERhdGFbY291bnQgKyAxXSA9IHZhbHVlc1sxXTtcbiAgICAgIHBhY2tlZERhdGFbY291bnQgKyAyXSA9IHZhbHVlc1syXTtcbiAgICB9XG4gICAgY291bnQgKz0gMztcbiAgfVxuICB0cmFuc2ZlcmFibGVPYmplY3RzLnB1c2gocGFja2VkRGF0YS5idWZmZXIpO1xuXG4gIHJldHVybiBwYWNrZWREYXRhO1xufVxuXG5mdW5jdGlvbiB1bnBhY2tJbnN0YW5jZXNGb3JDb21iaW5lKGRhdGEpIHtcbiAgdmFyIHBhY2tlZEluc3RhbmNlcyA9IGRhdGE7XG4gIHZhciByZXN1bHQgPSBuZXcgQXJyYXkocGFja2VkSW5zdGFuY2VzWzBdKTtcbiAgdmFyIGNvdW50ID0gMDtcblxuICB2YXIgaSA9IDE7XG4gIHdoaWxlIChpIDwgcGFja2VkSW5zdGFuY2VzLmxlbmd0aCkge1xuICAgIHZhciBtb2RlbE1hdHJpeCA9IE1hdHJpeDQudW5wYWNrKHBhY2tlZEluc3RhbmNlcywgaSk7XG4gICAgdmFyIGF0dHJpYnV0ZXM7XG4gICAgaSArPSBNYXRyaXg0LnBhY2tlZExlbmd0aDtcbiAgICBpZiAoZGVmaW5lZChwYWNrZWRJbnN0YW5jZXNbaV0pKSB7XG4gICAgICBhdHRyaWJ1dGVzID0ge1xuICAgICAgICBvZmZzZXQ6IG5ldyBPZmZzZXRHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlKFxuICAgICAgICAgIHBhY2tlZEluc3RhbmNlc1tpXSxcbiAgICAgICAgICBwYWNrZWRJbnN0YW5jZXNbaSArIDFdLFxuICAgICAgICAgIHBhY2tlZEluc3RhbmNlc1tpICsgMl1cbiAgICAgICAgKSxcbiAgICAgIH07XG4gICAgfVxuICAgIGkgKz0gMztcblxuICAgIHJlc3VsdFtjb3VudCsrXSA9IHtcbiAgICAgIG1vZGVsTWF0cml4OiBtb2RlbE1hdHJpeCxcbiAgICAgIGF0dHJpYnV0ZXM6IGF0dHJpYnV0ZXMsXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuUHJpbWl0aXZlUGlwZWxpbmUucGFja0NvbWJpbmVHZW9tZXRyeVBhcmFtZXRlcnMgPSBmdW5jdGlvbiAoXG4gIHBhcmFtZXRlcnMsXG4gIHRyYW5zZmVyYWJsZU9iamVjdHNcbikge1xuICB2YXIgY3JlYXRlR2VvbWV0cnlSZXN1bHRzID0gcGFyYW1ldGVycy5jcmVhdGVHZW9tZXRyeVJlc3VsdHM7XG4gIHZhciBsZW5ndGggPSBjcmVhdGVHZW9tZXRyeVJlc3VsdHMubGVuZ3RoO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICB0cmFuc2ZlcmFibGVPYmplY3RzLnB1c2goY3JlYXRlR2VvbWV0cnlSZXN1bHRzW2ldLnBhY2tlZERhdGEuYnVmZmVyKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgY3JlYXRlR2VvbWV0cnlSZXN1bHRzOiBwYXJhbWV0ZXJzLmNyZWF0ZUdlb21ldHJ5UmVzdWx0cyxcbiAgICBwYWNrZWRJbnN0YW5jZXM6IHBhY2tJbnN0YW5jZXNGb3JDb21iaW5lKFxuICAgICAgcGFyYW1ldGVycy5pbnN0YW5jZXMsXG4gICAgICB0cmFuc2ZlcmFibGVPYmplY3RzXG4gICAgKSxcbiAgICBlbGxpcHNvaWQ6IHBhcmFtZXRlcnMuZWxsaXBzb2lkLFxuICAgIGlzR2VvZ3JhcGhpYzogcGFyYW1ldGVycy5wcm9qZWN0aW9uIGluc3RhbmNlb2YgR2VvZ3JhcGhpY1Byb2plY3Rpb24sXG4gICAgZWxlbWVudEluZGV4VWludFN1cHBvcnRlZDogcGFyYW1ldGVycy5lbGVtZW50SW5kZXhVaW50U3VwcG9ydGVkLFxuICAgIHNjZW5lM0RPbmx5OiBwYXJhbWV0ZXJzLnNjZW5lM0RPbmx5LFxuICAgIHZlcnRleENhY2hlT3B0aW1pemU6IHBhcmFtZXRlcnMudmVydGV4Q2FjaGVPcHRpbWl6ZSxcbiAgICBjb21wcmVzc1ZlcnRpY2VzOiBwYXJhbWV0ZXJzLmNvbXByZXNzVmVydGljZXMsXG4gICAgbW9kZWxNYXRyaXg6IHBhcmFtZXRlcnMubW9kZWxNYXRyaXgsXG4gICAgY3JlYXRlUGlja09mZnNldHM6IHBhcmFtZXRlcnMuY3JlYXRlUGlja09mZnNldHMsXG4gIH07XG59O1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKi9cblByaW1pdGl2ZVBpcGVsaW5lLnVucGFja0NvbWJpbmVHZW9tZXRyeVBhcmFtZXRlcnMgPSBmdW5jdGlvbiAoXG4gIHBhY2tlZFBhcmFtZXRlcnNcbikge1xuICB2YXIgaW5zdGFuY2VzID0gdW5wYWNrSW5zdGFuY2VzRm9yQ29tYmluZShwYWNrZWRQYXJhbWV0ZXJzLnBhY2tlZEluc3RhbmNlcyk7XG4gIHZhciBjcmVhdGVHZW9tZXRyeVJlc3VsdHMgPSBwYWNrZWRQYXJhbWV0ZXJzLmNyZWF0ZUdlb21ldHJ5UmVzdWx0cztcbiAgdmFyIGxlbmd0aCA9IGNyZWF0ZUdlb21ldHJ5UmVzdWx0cy5sZW5ndGg7XG4gIHZhciBpbnN0YW5jZUluZGV4ID0gMDtcblxuICBmb3IgKHZhciByZXN1bHRJbmRleCA9IDA7IHJlc3VsdEluZGV4IDwgbGVuZ3RoOyByZXN1bHRJbmRleCsrKSB7XG4gICAgdmFyIGdlb21ldHJpZXMgPSBQcmltaXRpdmVQaXBlbGluZS51bnBhY2tDcmVhdGVHZW9tZXRyeVJlc3VsdHMoXG4gICAgICBjcmVhdGVHZW9tZXRyeVJlc3VsdHNbcmVzdWx0SW5kZXhdXG4gICAgKTtcbiAgICB2YXIgZ2VvbWV0cmllc0xlbmd0aCA9IGdlb21ldHJpZXMubGVuZ3RoO1xuICAgIGZvciAoXG4gICAgICB2YXIgZ2VvbWV0cnlJbmRleCA9IDA7XG4gICAgICBnZW9tZXRyeUluZGV4IDwgZ2VvbWV0cmllc0xlbmd0aDtcbiAgICAgIGdlb21ldHJ5SW5kZXgrK1xuICAgICkge1xuICAgICAgdmFyIGdlb21ldHJ5ID0gZ2VvbWV0cmllc1tnZW9tZXRyeUluZGV4XTtcbiAgICAgIHZhciBpbnN0YW5jZSA9IGluc3RhbmNlc1tpbnN0YW5jZUluZGV4XTtcbiAgICAgIGluc3RhbmNlLmdlb21ldHJ5ID0gZ2VvbWV0cnk7XG4gICAgICArK2luc3RhbmNlSW5kZXg7XG4gICAgfVxuICB9XG5cbiAgdmFyIGVsbGlwc29pZCA9IEVsbGlwc29pZC5jbG9uZShwYWNrZWRQYXJhbWV0ZXJzLmVsbGlwc29pZCk7XG4gIHZhciBwcm9qZWN0aW9uID0gcGFja2VkUGFyYW1ldGVycy5pc0dlb2dyYXBoaWNcbiAgICA/IG5ldyBHZW9ncmFwaGljUHJvamVjdGlvbihlbGxpcHNvaWQpXG4gICAgOiBuZXcgV2ViTWVyY2F0b3JQcm9qZWN0aW9uKGVsbGlwc29pZCk7XG5cbiAgcmV0dXJuIHtcbiAgICBpbnN0YW5jZXM6IGluc3RhbmNlcyxcbiAgICBlbGxpcHNvaWQ6IGVsbGlwc29pZCxcbiAgICBwcm9qZWN0aW9uOiBwcm9qZWN0aW9uLFxuICAgIGVsZW1lbnRJbmRleFVpbnRTdXBwb3J0ZWQ6IHBhY2tlZFBhcmFtZXRlcnMuZWxlbWVudEluZGV4VWludFN1cHBvcnRlZCxcbiAgICBzY2VuZTNET25seTogcGFja2VkUGFyYW1ldGVycy5zY2VuZTNET25seSxcbiAgICB2ZXJ0ZXhDYWNoZU9wdGltaXplOiBwYWNrZWRQYXJhbWV0ZXJzLnZlcnRleENhY2hlT3B0aW1pemUsXG4gICAgY29tcHJlc3NWZXJ0aWNlczogcGFja2VkUGFyYW1ldGVycy5jb21wcmVzc1ZlcnRpY2VzLFxuICAgIG1vZGVsTWF0cml4OiBNYXRyaXg0LmNsb25lKHBhY2tlZFBhcmFtZXRlcnMubW9kZWxNYXRyaXgpLFxuICAgIGNyZWF0ZVBpY2tPZmZzZXRzOiBwYWNrZWRQYXJhbWV0ZXJzLmNyZWF0ZVBpY2tPZmZzZXRzLFxuICB9O1xufTtcblxuZnVuY3Rpb24gcGFja0JvdW5kaW5nU3BoZXJlcyhib3VuZGluZ1NwaGVyZXMpIHtcbiAgdmFyIGxlbmd0aCA9IGJvdW5kaW5nU3BoZXJlcy5sZW5ndGg7XG4gIHZhciBidWZmZXJMZW5ndGggPSAxICsgKEJvdW5kaW5nU3BoZXJlLnBhY2tlZExlbmd0aCArIDEpICogbGVuZ3RoO1xuICB2YXIgYnVmZmVyID0gbmV3IEZsb2F0MzJBcnJheShidWZmZXJMZW5ndGgpO1xuXG4gIHZhciBidWZmZXJJbmRleCA9IDA7XG4gIGJ1ZmZlcltidWZmZXJJbmRleCsrXSA9IGxlbmd0aDtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgdmFyIGJzID0gYm91bmRpbmdTcGhlcmVzW2ldO1xuICAgIGlmICghZGVmaW5lZChicykpIHtcbiAgICAgIGJ1ZmZlcltidWZmZXJJbmRleCsrXSA9IDAuMDtcbiAgICB9IGVsc2Uge1xuICAgICAgYnVmZmVyW2J1ZmZlckluZGV4KytdID0gMS4wO1xuICAgICAgQm91bmRpbmdTcGhlcmUucGFjayhib3VuZGluZ1NwaGVyZXNbaV0sIGJ1ZmZlciwgYnVmZmVySW5kZXgpO1xuICAgIH1cbiAgICBidWZmZXJJbmRleCArPSBCb3VuZGluZ1NwaGVyZS5wYWNrZWRMZW5ndGg7XG4gIH1cblxuICByZXR1cm4gYnVmZmVyO1xufVxuXG5mdW5jdGlvbiB1bnBhY2tCb3VuZGluZ1NwaGVyZXMoYnVmZmVyKSB7XG4gIHZhciByZXN1bHQgPSBuZXcgQXJyYXkoYnVmZmVyWzBdKTtcbiAgdmFyIGNvdW50ID0gMDtcblxuICB2YXIgaSA9IDE7XG4gIHdoaWxlIChpIDwgYnVmZmVyLmxlbmd0aCkge1xuICAgIGlmIChidWZmZXJbaSsrXSA9PT0gMS4wKSB7XG4gICAgICByZXN1bHRbY291bnRdID0gQm91bmRpbmdTcGhlcmUudW5wYWNrKGJ1ZmZlciwgaSk7XG4gICAgfVxuICAgICsrY291bnQ7XG4gICAgaSArPSBCb3VuZGluZ1NwaGVyZS5wYWNrZWRMZW5ndGg7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufVxuXG4vKipcbiAqIEBwcml2YXRlXG4gKi9cblByaW1pdGl2ZVBpcGVsaW5lLnBhY2tDb21iaW5lR2VvbWV0cnlSZXN1bHRzID0gZnVuY3Rpb24gKFxuICByZXN1bHRzLFxuICB0cmFuc2ZlcmFibGVPYmplY3RzXG4pIHtcbiAgaWYgKGRlZmluZWQocmVzdWx0cy5nZW9tZXRyaWVzKSkge1xuICAgIHRyYW5zZmVyR2VvbWV0cmllcyhyZXN1bHRzLmdlb21ldHJpZXMsIHRyYW5zZmVyYWJsZU9iamVjdHMpO1xuICB9XG5cbiAgdmFyIHBhY2tlZEJvdW5kaW5nU3BoZXJlcyA9IHBhY2tCb3VuZGluZ1NwaGVyZXMocmVzdWx0cy5ib3VuZGluZ1NwaGVyZXMpO1xuICB2YXIgcGFja2VkQm91bmRpbmdTcGhlcmVzQ1YgPSBwYWNrQm91bmRpbmdTcGhlcmVzKHJlc3VsdHMuYm91bmRpbmdTcGhlcmVzQ1YpO1xuICB0cmFuc2ZlcmFibGVPYmplY3RzLnB1c2goXG4gICAgcGFja2VkQm91bmRpbmdTcGhlcmVzLmJ1ZmZlcixcbiAgICBwYWNrZWRCb3VuZGluZ1NwaGVyZXNDVi5idWZmZXJcbiAgKTtcblxuICByZXR1cm4ge1xuICAgIGdlb21ldHJpZXM6IHJlc3VsdHMuZ2VvbWV0cmllcyxcbiAgICBhdHRyaWJ1dGVMb2NhdGlvbnM6IHJlc3VsdHMuYXR0cmlidXRlTG9jYXRpb25zLFxuICAgIG1vZGVsTWF0cml4OiByZXN1bHRzLm1vZGVsTWF0cml4LFxuICAgIHBpY2tPZmZzZXRzOiByZXN1bHRzLnBpY2tPZmZzZXRzLFxuICAgIG9mZnNldEluc3RhbmNlRXh0ZW5kOiByZXN1bHRzLm9mZnNldEluc3RhbmNlRXh0ZW5kLFxuICAgIGJvdW5kaW5nU3BoZXJlczogcGFja2VkQm91bmRpbmdTcGhlcmVzLFxuICAgIGJvdW5kaW5nU3BoZXJlc0NWOiBwYWNrZWRCb3VuZGluZ1NwaGVyZXNDVixcbiAgfTtcbn07XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuUHJpbWl0aXZlUGlwZWxpbmUudW5wYWNrQ29tYmluZUdlb21ldHJ5UmVzdWx0cyA9IGZ1bmN0aW9uIChwYWNrZWRSZXN1bHQpIHtcbiAgcmV0dXJuIHtcbiAgICBnZW9tZXRyaWVzOiBwYWNrZWRSZXN1bHQuZ2VvbWV0cmllcyxcbiAgICBhdHRyaWJ1dGVMb2NhdGlvbnM6IHBhY2tlZFJlc3VsdC5hdHRyaWJ1dGVMb2NhdGlvbnMsXG4gICAgbW9kZWxNYXRyaXg6IHBhY2tlZFJlc3VsdC5tb2RlbE1hdHJpeCxcbiAgICBwaWNrT2Zmc2V0czogcGFja2VkUmVzdWx0LnBpY2tPZmZzZXRzLFxuICAgIG9mZnNldEluc3RhbmNlRXh0ZW5kOiBwYWNrZWRSZXN1bHQub2Zmc2V0SW5zdGFuY2VFeHRlbmQsXG4gICAgYm91bmRpbmdTcGhlcmVzOiB1bnBhY2tCb3VuZGluZ1NwaGVyZXMocGFja2VkUmVzdWx0LmJvdW5kaW5nU3BoZXJlcyksXG4gICAgYm91bmRpbmdTcGhlcmVzQ1Y6IHVucGFja0JvdW5kaW5nU3BoZXJlcyhwYWNrZWRSZXN1bHQuYm91bmRpbmdTcGhlcmVzQ1YpLFxuICB9O1xufTtcbmV4cG9ydCBkZWZhdWx0IFByaW1pdGl2ZVBpcGVsaW5lO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///1764\n')},88736:function(__unused_webpack___webpack_module__,__webpack_exports__){eval('/**\n * @private\n */\nvar PrimitiveState = {\n  READY: 0,\n  CREATING: 1,\n  CREATED: 2,\n  COMBINING: 3,\n  COMBINED: 4,\n  COMPLETE: 5,\n  FAILED: 6,\n};\n/* harmony default export */ __webpack_exports__["Z"] = (Object.freeze(PrimitiveState));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODg3MzYuanMiLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQWUsNkJBQTZCLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92dWUzLXdlYnBhY2s1Ly4vbm9kZV9tb2R1bGVzL2Nlc2l1bS9Tb3VyY2UvU2NlbmUvUHJpbWl0aXZlU3RhdGUuanM/ZjgxYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBwcml2YXRlXG4gKi9cbnZhciBQcmltaXRpdmVTdGF0ZSA9IHtcbiAgUkVBRFk6IDAsXG4gIENSRUFUSU5HOiAxLFxuICBDUkVBVEVEOiAyLFxuICBDT01CSU5JTkc6IDMsXG4gIENPTUJJTkVEOiA0LFxuICBDT01QTEVURTogNSxcbiAgRkFJTEVEOiA2LFxufTtcbmV4cG9ydCBkZWZhdWx0IE9iamVjdC5mcmVlemUoUHJpbWl0aXZlU3RhdGUpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///88736\n')}}]);