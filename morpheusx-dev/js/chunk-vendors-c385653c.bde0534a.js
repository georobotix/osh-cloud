"use strict";(self["webpackChunkvue3_webpack5"]=self["webpackChunkvue3_webpack5"]||[]).push([[2207],{68457:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(60216);\n/* harmony import */ var _Check_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(66553);\n/* harmony import */ var _defaultValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(62200);\n/* harmony import */ var _defined_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(82982);\n\n\n\n\n\n/**\n * Represents a ray that extends infinitely from the provided origin in the provided direction.\n * @alias Ray\n * @constructor\n *\n * @param {Cartesian3} [origin=Cartesian3.ZERO] The origin of the ray.\n * @param {Cartesian3} [direction=Cartesian3.ZERO] The direction of the ray.\n */\nfunction Ray(origin, direction) {\n  direction = _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone((0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(direction, _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].ZERO */ .Z.ZERO));\n  if (!_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].equals */ .Z.equals(direction, _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].ZERO */ .Z.ZERO)) {\n    _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].normalize */ .Z.normalize(direction, direction);\n  }\n\n  /**\n   * The origin of the ray.\n   * @type {Cartesian3}\n   * @default {@link Cartesian3.ZERO}\n   */\n  this.origin = _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone((0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(origin, _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].ZERO */ .Z.ZERO));\n\n  /**\n   * The direction of the ray.\n   * @type {Cartesian3}\n   */\n  this.direction = direction;\n}\n\n/**\n * Duplicates a Ray instance.\n *\n * @param {Ray} ray The ray to duplicate.\n * @param {Ray} [result] The object onto which to store the result.\n * @returns {Ray} The modified result parameter or a new Ray instance if one was not provided. (Returns undefined if ray is undefined)\n */\nRay.clone = function (ray, result) {\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(ray)) {\n    return undefined;\n  }\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(result)) {\n    return new Ray(ray.origin, ray.direction);\n  }\n  result.origin = _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone(ray.origin);\n  result.direction = _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone(ray.direction);\n  return result;\n};\n\n/**\n * Computes the point along the ray given by r(t) = o + t*d,\n * where o is the origin of the ray and d is the direction.\n *\n * @param {Ray} ray The ray.\n * @param {Number} t A scalar value.\n * @param {Cartesian3} [result] The object in which the result will be stored.\n * @returns {Cartesian3} The modified result parameter, or a new instance if none was provided.\n *\n * @example\n * //Get the first intersection point of a ray and an ellipsoid.\n * var intersection = Cesium.IntersectionTests.rayEllipsoid(ray, ellipsoid);\n * var point = Cesium.Ray.getPoint(ray, intersection.start);\n */\nRay.getPoint = function (ray, t, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("ray", ray);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.number */ .Z.typeOf.number("t", t);\n  //>>includeEnd(\'debug\');\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(result)) {\n    result = new _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\n  }\n\n  result = _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].multiplyByScalar */ .Z.multiplyByScalar(ray.direction, t, result);\n  return _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].add */ .Z.add(ray.origin, result, result);\n};\n/* harmony default export */ __webpack_exports__["Z"] = (Ray);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjg0NTcuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUF5QztBQUNWO0FBQ2M7QUFDVjs7QUFFbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsWUFBWTtBQUN2QixXQUFXLFlBQVk7QUFDdkI7QUFDQTtBQUNBLGNBQWMsMkVBQWdCLENBQUMscUVBQVksWUFBWSx5RUFBZTtBQUN0RSxPQUFPLDZFQUFpQixZQUFZLHlFQUFlO0FBQ25ELElBQUksbUZBQW9CO0FBQ3hCOztBQUVBO0FBQ0E7QUFDQSxZQUFZO0FBQ1osZUFBZTtBQUNmO0FBQ0EsZ0JBQWdCLDJFQUFnQixDQUFDLHFFQUFZLFNBQVMseUVBQWU7O0FBRXJFO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsS0FBSztBQUNoQixXQUFXLEtBQUs7QUFDaEIsYUFBYSxLQUFLO0FBQ2xCO0FBQ0E7QUFDQSxPQUFPLGdFQUFPO0FBQ2Q7QUFDQTtBQUNBLE9BQU8sZ0VBQU87QUFDZDtBQUNBO0FBQ0Esa0JBQWtCLDJFQUFnQjtBQUNsQyxxQkFBcUIsMkVBQWdCO0FBQ3JDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLEtBQUs7QUFDaEIsV0FBVyxRQUFRO0FBQ25CLFdBQVcsWUFBWTtBQUN2QixhQUFhLFlBQVk7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUUsc0ZBQW1CO0FBQ3JCLEVBQUUsc0ZBQW1CO0FBQ3JCOztBQUVBLE9BQU8sZ0VBQU87QUFDZCxpQkFBaUIsK0RBQVU7QUFDM0I7O0FBRUEsV0FBVyxpR0FBMkI7QUFDdEMsU0FBUyx1RUFBYztBQUN2QjtBQUNBLHlEQUFlLEdBQUcsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9Db3JlL1JheS5qcz8zZjRlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDYXJ0ZXNpYW4zIGZyb20gXCIuL0NhcnRlc2lhbjMuanNcIjtcbmltcG9ydCBDaGVjayBmcm9tIFwiLi9DaGVjay5qc1wiO1xuaW1wb3J0IGRlZmF1bHRWYWx1ZSBmcm9tIFwiLi9kZWZhdWx0VmFsdWUuanNcIjtcbmltcG9ydCBkZWZpbmVkIGZyb20gXCIuL2RlZmluZWQuanNcIjtcblxuLyoqXG4gKiBSZXByZXNlbnRzIGEgcmF5IHRoYXQgZXh0ZW5kcyBpbmZpbml0ZWx5IGZyb20gdGhlIHByb3ZpZGVkIG9yaWdpbiBpbiB0aGUgcHJvdmlkZWQgZGlyZWN0aW9uLlxuICogQGFsaWFzIFJheVxuICogQGNvbnN0cnVjdG9yXG4gKlxuICogQHBhcmFtIHtDYXJ0ZXNpYW4zfSBbb3JpZ2luPUNhcnRlc2lhbjMuWkVST10gVGhlIG9yaWdpbiBvZiB0aGUgcmF5LlxuICogQHBhcmFtIHtDYXJ0ZXNpYW4zfSBbZGlyZWN0aW9uPUNhcnRlc2lhbjMuWkVST10gVGhlIGRpcmVjdGlvbiBvZiB0aGUgcmF5LlxuICovXG5mdW5jdGlvbiBSYXkob3JpZ2luLCBkaXJlY3Rpb24pIHtcbiAgZGlyZWN0aW9uID0gQ2FydGVzaWFuMy5jbG9uZShkZWZhdWx0VmFsdWUoZGlyZWN0aW9uLCBDYXJ0ZXNpYW4zLlpFUk8pKTtcbiAgaWYgKCFDYXJ0ZXNpYW4zLmVxdWFscyhkaXJlY3Rpb24sIENhcnRlc2lhbjMuWkVSTykpIHtcbiAgICBDYXJ0ZXNpYW4zLm5vcm1hbGl6ZShkaXJlY3Rpb24sIGRpcmVjdGlvbik7XG4gIH1cblxuICAvKipcbiAgICogVGhlIG9yaWdpbiBvZiB0aGUgcmF5LlxuICAgKiBAdHlwZSB7Q2FydGVzaWFuM31cbiAgICogQGRlZmF1bHQge0BsaW5rIENhcnRlc2lhbjMuWkVST31cbiAgICovXG4gIHRoaXMub3JpZ2luID0gQ2FydGVzaWFuMy5jbG9uZShkZWZhdWx0VmFsdWUob3JpZ2luLCBDYXJ0ZXNpYW4zLlpFUk8pKTtcblxuICAvKipcbiAgICogVGhlIGRpcmVjdGlvbiBvZiB0aGUgcmF5LlxuICAgKiBAdHlwZSB7Q2FydGVzaWFuM31cbiAgICovXG4gIHRoaXMuZGlyZWN0aW9uID0gZGlyZWN0aW9uO1xufVxuXG4vKipcbiAqIER1cGxpY2F0ZXMgYSBSYXkgaW5zdGFuY2UuXG4gKlxuICogQHBhcmFtIHtSYXl9IHJheSBUaGUgcmF5IHRvIGR1cGxpY2F0ZS5cbiAqIEBwYXJhbSB7UmF5fSBbcmVzdWx0XSBUaGUgb2JqZWN0IG9udG8gd2hpY2ggdG8gc3RvcmUgdGhlIHJlc3VsdC5cbiAqIEByZXR1cm5zIHtSYXl9IFRoZSBtb2RpZmllZCByZXN1bHQgcGFyYW1ldGVyIG9yIGEgbmV3IFJheSBpbnN0YW5jZSBpZiBvbmUgd2FzIG5vdCBwcm92aWRlZC4gKFJldHVybnMgdW5kZWZpbmVkIGlmIHJheSBpcyB1bmRlZmluZWQpXG4gKi9cblJheS5jbG9uZSA9IGZ1bmN0aW9uIChyYXksIHJlc3VsdCkge1xuICBpZiAoIWRlZmluZWQocmF5KSkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgaWYgKCFkZWZpbmVkKHJlc3VsdCkpIHtcbiAgICByZXR1cm4gbmV3IFJheShyYXkub3JpZ2luLCByYXkuZGlyZWN0aW9uKTtcbiAgfVxuICByZXN1bHQub3JpZ2luID0gQ2FydGVzaWFuMy5jbG9uZShyYXkub3JpZ2luKTtcbiAgcmVzdWx0LmRpcmVjdGlvbiA9IENhcnRlc2lhbjMuY2xvbmUocmF5LmRpcmVjdGlvbik7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG4vKipcbiAqIENvbXB1dGVzIHRoZSBwb2ludCBhbG9uZyB0aGUgcmF5IGdpdmVuIGJ5IHIodCkgPSBvICsgdCpkLFxuICogd2hlcmUgbyBpcyB0aGUgb3JpZ2luIG9mIHRoZSByYXkgYW5kIGQgaXMgdGhlIGRpcmVjdGlvbi5cbiAqXG4gKiBAcGFyYW0ge1JheX0gcmF5IFRoZSByYXkuXG4gKiBAcGFyYW0ge051bWJlcn0gdCBBIHNjYWxhciB2YWx1ZS5cbiAqIEBwYXJhbSB7Q2FydGVzaWFuM30gW3Jlc3VsdF0gVGhlIG9iamVjdCBpbiB3aGljaCB0aGUgcmVzdWx0IHdpbGwgYmUgc3RvcmVkLlxuICogQHJldHVybnMge0NhcnRlc2lhbjN9IFRoZSBtb2RpZmllZCByZXN1bHQgcGFyYW1ldGVyLCBvciBhIG5ldyBpbnN0YW5jZSBpZiBub25lIHdhcyBwcm92aWRlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogLy9HZXQgdGhlIGZpcnN0IGludGVyc2VjdGlvbiBwb2ludCBvZiBhIHJheSBhbmQgYW4gZWxsaXBzb2lkLlxuICogdmFyIGludGVyc2VjdGlvbiA9IENlc2l1bS5JbnRlcnNlY3Rpb25UZXN0cy5yYXlFbGxpcHNvaWQocmF5LCBlbGxpcHNvaWQpO1xuICogdmFyIHBvaW50ID0gQ2VzaXVtLlJheS5nZXRQb2ludChyYXksIGludGVyc2VjdGlvbi5zdGFydCk7XG4gKi9cblJheS5nZXRQb2ludCA9IGZ1bmN0aW9uIChyYXksIHQsIHJlc3VsdCkge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwicmF5XCIsIHJheSk7XG4gIENoZWNrLnR5cGVPZi5udW1iZXIoXCJ0XCIsIHQpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICBpZiAoIWRlZmluZWQocmVzdWx0KSkge1xuICAgIHJlc3VsdCA9IG5ldyBDYXJ0ZXNpYW4zKCk7XG4gIH1cblxuICByZXN1bHQgPSBDYXJ0ZXNpYW4zLm11bHRpcGx5QnlTY2FsYXIocmF5LmRpcmVjdGlvbiwgdCwgcmVzdWx0KTtcbiAgcmV0dXJuIENhcnRlc2lhbjMuYWRkKHJheS5vcmlnaW4sIHJlc3VsdCwgcmVzdWx0KTtcbn07XG5leHBvcnQgZGVmYXVsdCBSYXk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///68457\n')},96190:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Cartographic_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(51688);\n/* harmony import */ var _Check_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(66553);\n/* harmony import */ var _defaultValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(62200);\n/* harmony import */ var _defined_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(82982);\n/* harmony import */ var _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(50491);\n/* harmony import */ var _Math_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(99417);\n\n\n\n\n\n\n\n/**\n * A two dimensional region specified as longitude and latitude coordinates.\n *\n * @alias Rectangle\n * @constructor\n *\n * @param {Number} [west=0.0] The westernmost longitude, in radians, in the range [-Pi, Pi].\n * @param {Number} [south=0.0] The southernmost latitude, in radians, in the range [-Pi/2, Pi/2].\n * @param {Number} [east=0.0] The easternmost longitude, in radians, in the range [-Pi, Pi].\n * @param {Number} [north=0.0] The northernmost latitude, in radians, in the range [-Pi/2, Pi/2].\n *\n * @see Packable\n */\nfunction Rectangle(west, south, east, north) {\n  /**\n   * The westernmost longitude in radians in the range [-Pi, Pi].\n   *\n   * @type {Number}\n   * @default 0.0\n   */\n  this.west = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(west, 0.0);\n\n  /**\n   * The southernmost latitude in radians in the range [-Pi/2, Pi/2].\n   *\n   * @type {Number}\n   * @default 0.0\n   */\n  this.south = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(south, 0.0);\n\n  /**\n   * The easternmost longitude in radians in the range [-Pi, Pi].\n   *\n   * @type {Number}\n   * @default 0.0\n   */\n  this.east = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(east, 0.0);\n\n  /**\n   * The northernmost latitude in radians in the range [-Pi/2, Pi/2].\n   *\n   * @type {Number}\n   * @default 0.0\n   */\n  this.north = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(north, 0.0);\n}\n\nObject.defineProperties(Rectangle.prototype, {\n  /**\n   * Gets the width of the rectangle in radians.\n   * @memberof Rectangle.prototype\n   * @type {Number}\n   * @readonly\n   */\n  width: {\n    get: function () {\n      return Rectangle.computeWidth(this);\n    },\n  },\n\n  /**\n   * Gets the height of the rectangle in radians.\n   * @memberof Rectangle.prototype\n   * @type {Number}\n   * @readonly\n   */\n  height: {\n    get: function () {\n      return Rectangle.computeHeight(this);\n    },\n  },\n});\n\n/**\n * The number of elements used to pack the object into an array.\n * @type {Number}\n */\nRectangle.packedLength = 4;\n\n/**\n * Stores the provided instance into the provided array.\n *\n * @param {Rectangle} value The value to pack.\n * @param {Number[]} array The array to pack into.\n * @param {Number} [startingIndex=0] The index into the array at which to start packing the elements.\n *\n * @returns {Number[]} The array that was packed into\n */\nRectangle.pack = function (value, array, startingIndex) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("value", value);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].defined */ .Z.defined("array", array);\n  //>>includeEnd(\'debug\');\n\n  startingIndex = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(startingIndex, 0);\n\n  array[startingIndex++] = value.west;\n  array[startingIndex++] = value.south;\n  array[startingIndex++] = value.east;\n  array[startingIndex] = value.north;\n\n  return array;\n};\n\n/**\n * Retrieves an instance from a packed array.\n *\n * @param {Number[]} array The packed array.\n * @param {Number} [startingIndex=0] The starting index of the element to be unpacked.\n * @param {Rectangle} [result] The object into which to store the result.\n * @returns {Rectangle} The modified result parameter or a new Rectangle instance if one was not provided.\n */\nRectangle.unpack = function (array, startingIndex, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].defined */ .Z.defined("array", array);\n  //>>includeEnd(\'debug\');\n\n  startingIndex = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(startingIndex, 0);\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(result)) {\n    result = new Rectangle();\n  }\n\n  result.west = array[startingIndex++];\n  result.south = array[startingIndex++];\n  result.east = array[startingIndex++];\n  result.north = array[startingIndex];\n  return result;\n};\n\n/**\n * Computes the width of a rectangle in radians.\n * @param {Rectangle} rectangle The rectangle to compute the width of.\n * @returns {Number} The width.\n */\nRectangle.computeWidth = function (rectangle) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  //>>includeEnd(\'debug\');\n  var east = rectangle.east;\n  var west = rectangle.west;\n  if (east < west) {\n    east += _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n  }\n  return east - west;\n};\n\n/**\n * Computes the height of a rectangle in radians.\n * @param {Rectangle} rectangle The rectangle to compute the height of.\n * @returns {Number} The height.\n */\nRectangle.computeHeight = function (rectangle) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  //>>includeEnd(\'debug\');\n  return rectangle.north - rectangle.south;\n};\n\n/**\n * Creates a rectangle given the boundary longitude and latitude in degrees.\n *\n * @param {Number} [west=0.0] The westernmost longitude in degrees in the range [-180.0, 180.0].\n * @param {Number} [south=0.0] The southernmost latitude in degrees in the range [-90.0, 90.0].\n * @param {Number} [east=0.0] The easternmost longitude in degrees in the range [-180.0, 180.0].\n * @param {Number} [north=0.0] The northernmost latitude in degrees in the range [-90.0, 90.0].\n * @param {Rectangle} [result] The object onto which to store the result, or undefined if a new instance should be created.\n * @returns {Rectangle} The modified result parameter or a new Rectangle instance if none was provided.\n *\n * @example\n * var rectangle = Cesium.Rectangle.fromDegrees(0.0, 20.0, 10.0, 30.0);\n */\nRectangle.fromDegrees = function (west, south, east, north, result) {\n  west = _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].toRadians */ .Z.toRadians((0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(west, 0.0));\n  south = _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].toRadians */ .Z.toRadians((0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(south, 0.0));\n  east = _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].toRadians */ .Z.toRadians((0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(east, 0.0));\n  north = _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].toRadians */ .Z.toRadians((0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(north, 0.0));\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(result)) {\n    return new Rectangle(west, south, east, north);\n  }\n\n  result.west = west;\n  result.south = south;\n  result.east = east;\n  result.north = north;\n\n  return result;\n};\n\n/**\n * Creates a rectangle given the boundary longitude and latitude in radians.\n *\n * @param {Number} [west=0.0] The westernmost longitude in radians in the range [-Math.PI, Math.PI].\n * @param {Number} [south=0.0] The southernmost latitude in radians in the range [-Math.PI/2, Math.PI/2].\n * @param {Number} [east=0.0] The easternmost longitude in radians in the range [-Math.PI, Math.PI].\n * @param {Number} [north=0.0] The northernmost latitude in radians in the range [-Math.PI/2, Math.PI/2].\n * @param {Rectangle} [result] The object onto which to store the result, or undefined if a new instance should be created.\n * @returns {Rectangle} The modified result parameter or a new Rectangle instance if none was provided.\n *\n * @example\n * var rectangle = Cesium.Rectangle.fromRadians(0.0, Math.PI/4, Math.PI/8, 3*Math.PI/4);\n */\nRectangle.fromRadians = function (west, south, east, north, result) {\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(result)) {\n    return new Rectangle(west, south, east, north);\n  }\n\n  result.west = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(west, 0.0);\n  result.south = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(south, 0.0);\n  result.east = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(east, 0.0);\n  result.north = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(north, 0.0);\n\n  return result;\n};\n\n/**\n * Creates the smallest possible Rectangle that encloses all positions in the provided array.\n *\n * @param {Cartographic[]} cartographics The list of Cartographic instances.\n * @param {Rectangle} [result] The object onto which to store the result, or undefined if a new instance should be created.\n * @returns {Rectangle} The modified result parameter or a new Rectangle instance if none was provided.\n */\nRectangle.fromCartographicArray = function (cartographics, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].defined */ .Z.defined("cartographics", cartographics);\n  //>>includeEnd(\'debug\');\n\n  var west = Number.MAX_VALUE;\n  var east = -Number.MAX_VALUE;\n  var westOverIDL = Number.MAX_VALUE;\n  var eastOverIDL = -Number.MAX_VALUE;\n  var south = Number.MAX_VALUE;\n  var north = -Number.MAX_VALUE;\n\n  for (var i = 0, len = cartographics.length; i < len; i++) {\n    var position = cartographics[i];\n    west = Math.min(west, position.longitude);\n    east = Math.max(east, position.longitude);\n    south = Math.min(south, position.latitude);\n    north = Math.max(north, position.latitude);\n\n    var lonAdjusted =\n      position.longitude >= 0\n        ? position.longitude\n        : position.longitude + _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n    westOverIDL = Math.min(westOverIDL, lonAdjusted);\n    eastOverIDL = Math.max(eastOverIDL, lonAdjusted);\n  }\n\n  if (east - west > eastOverIDL - westOverIDL) {\n    west = westOverIDL;\n    east = eastOverIDL;\n\n    if (east > _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI */ .Z.PI) {\n      east = east - _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n    }\n    if (west > _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI */ .Z.PI) {\n      west = west - _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n    }\n  }\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(result)) {\n    return new Rectangle(west, south, east, north);\n  }\n\n  result.west = west;\n  result.south = south;\n  result.east = east;\n  result.north = north;\n  return result;\n};\n\n/**\n * Creates the smallest possible Rectangle that encloses all positions in the provided array.\n *\n * @param {Cartesian3[]} cartesians The list of Cartesian instances.\n * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid the cartesians are on.\n * @param {Rectangle} [result] The object onto which to store the result, or undefined if a new instance should be created.\n * @returns {Rectangle} The modified result parameter or a new Rectangle instance if none was provided.\n */\nRectangle.fromCartesianArray = function (cartesians, ellipsoid, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].defined */ .Z.defined("cartesians", cartesians);\n  //>>includeEnd(\'debug\');\n  ellipsoid = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(ellipsoid, _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].WGS84 */ .Z.WGS84);\n\n  var west = Number.MAX_VALUE;\n  var east = -Number.MAX_VALUE;\n  var westOverIDL = Number.MAX_VALUE;\n  var eastOverIDL = -Number.MAX_VALUE;\n  var south = Number.MAX_VALUE;\n  var north = -Number.MAX_VALUE;\n\n  for (var i = 0, len = cartesians.length; i < len; i++) {\n    var position = ellipsoid.cartesianToCartographic(cartesians[i]);\n    west = Math.min(west, position.longitude);\n    east = Math.max(east, position.longitude);\n    south = Math.min(south, position.latitude);\n    north = Math.max(north, position.latitude);\n\n    var lonAdjusted =\n      position.longitude >= 0\n        ? position.longitude\n        : position.longitude + _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n    westOverIDL = Math.min(westOverIDL, lonAdjusted);\n    eastOverIDL = Math.max(eastOverIDL, lonAdjusted);\n  }\n\n  if (east - west > eastOverIDL - westOverIDL) {\n    west = westOverIDL;\n    east = eastOverIDL;\n\n    if (east > _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI */ .Z.PI) {\n      east = east - _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n    }\n    if (west > _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI */ .Z.PI) {\n      west = west - _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n    }\n  }\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(result)) {\n    return new Rectangle(west, south, east, north);\n  }\n\n  result.west = west;\n  result.south = south;\n  result.east = east;\n  result.north = north;\n  return result;\n};\n\n/**\n * Duplicates a Rectangle.\n *\n * @param {Rectangle} rectangle The rectangle to clone.\n * @param {Rectangle} [result] The object onto which to store the result, or undefined if a new instance should be created.\n * @returns {Rectangle} The modified result parameter or a new Rectangle instance if none was provided. (Returns undefined if rectangle is undefined)\n */\nRectangle.clone = function (rectangle, result) {\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(rectangle)) {\n    return undefined;\n  }\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(result)) {\n    return new Rectangle(\n      rectangle.west,\n      rectangle.south,\n      rectangle.east,\n      rectangle.north\n    );\n  }\n\n  result.west = rectangle.west;\n  result.south = rectangle.south;\n  result.east = rectangle.east;\n  result.north = rectangle.north;\n  return result;\n};\n\n/**\n * Compares the provided Rectangles componentwise and returns\n * <code>true</code> if they pass an absolute or relative tolerance test,\n * <code>false</code> otherwise.\n *\n * @param {Rectangle} [left] The first Rectangle.\n * @param {Rectangle} [right] The second Rectangle.\n * @param {Number} [absoluteEpsilon=0] The absolute epsilon tolerance to use for equality testing.\n * @returns {Boolean} <code>true</code> if left and right are within the provided epsilon, <code>false</code> otherwise.\n */\nRectangle.equalsEpsilon = function (left, right, absoluteEpsilon) {\n  absoluteEpsilon = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(absoluteEpsilon, 0);\n\n  return (\n    left === right ||\n    ((0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(left) &&\n      (0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(right) &&\n      Math.abs(left.west - right.west) <= absoluteEpsilon &&\n      Math.abs(left.south - right.south) <= absoluteEpsilon &&\n      Math.abs(left.east - right.east) <= absoluteEpsilon &&\n      Math.abs(left.north - right.north) <= absoluteEpsilon)\n  );\n};\n\n/**\n * Duplicates this Rectangle.\n *\n * @param {Rectangle} [result] The object onto which to store the result.\n * @returns {Rectangle} The modified result parameter or a new Rectangle instance if none was provided.\n */\nRectangle.prototype.clone = function (result) {\n  return Rectangle.clone(this, result);\n};\n\n/**\n * Compares the provided Rectangle with this Rectangle componentwise and returns\n * <code>true</code> if they are equal, <code>false</code> otherwise.\n *\n * @param {Rectangle} [other] The Rectangle to compare.\n * @returns {Boolean} <code>true</code> if the Rectangles are equal, <code>false</code> otherwise.\n */\nRectangle.prototype.equals = function (other) {\n  return Rectangle.equals(this, other);\n};\n\n/**\n * Compares the provided rectangles and returns <code>true</code> if they are equal,\n * <code>false</code> otherwise.\n *\n * @param {Rectangle} [left] The first Rectangle.\n * @param {Rectangle} [right] The second Rectangle.\n * @returns {Boolean} <code>true</code> if left and right are equal; otherwise <code>false</code>.\n */\nRectangle.equals = function (left, right) {\n  return (\n    left === right ||\n    ((0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(left) &&\n      (0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(right) &&\n      left.west === right.west &&\n      left.south === right.south &&\n      left.east === right.east &&\n      left.north === right.north)\n  );\n};\n\n/**\n * Compares the provided Rectangle with this Rectangle componentwise and returns\n * <code>true</code> if they are within the provided epsilon,\n * <code>false</code> otherwise.\n *\n * @param {Rectangle} [other] The Rectangle to compare.\n * @param {Number} [epsilon=0] The epsilon to use for equality testing.\n * @returns {Boolean} <code>true</code> if the Rectangles are within the provided epsilon, <code>false</code> otherwise.\n */\nRectangle.prototype.equalsEpsilon = function (other, epsilon) {\n  return Rectangle.equalsEpsilon(this, other, epsilon);\n};\n\n/**\n * Checks a Rectangle\'s properties and throws if they are not in valid ranges.\n *\n * @param {Rectangle} rectangle The rectangle to validate\n *\n * @exception {DeveloperError} <code>north</code> must be in the interval [<code>-Pi/2</code>, <code>Pi/2</code>].\n * @exception {DeveloperError} <code>south</code> must be in the interval [<code>-Pi/2</code>, <code>Pi/2</code>].\n * @exception {DeveloperError} <code>east</code> must be in the interval [<code>-Pi</code>, <code>Pi</code>].\n * @exception {DeveloperError} <code>west</code> must be in the interval [<code>-Pi</code>, <code>Pi</code>].\n */\nRectangle.validate = function (rectangle) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n\n  var north = rectangle.north;\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals(\n    "north",\n    north,\n    -_Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI_OVER_TWO */ .Z.PI_OVER_TWO\n  );\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.number.lessThanOrEquals */ .Z.typeOf.number.lessThanOrEquals("north", north, _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI_OVER_TWO */ .Z.PI_OVER_TWO);\n\n  var south = rectangle.south;\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals(\n    "south",\n    south,\n    -_Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI_OVER_TWO */ .Z.PI_OVER_TWO\n  );\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.number.lessThanOrEquals */ .Z.typeOf.number.lessThanOrEquals("south", south, _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI_OVER_TWO */ .Z.PI_OVER_TWO);\n\n  var west = rectangle.west;\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals("west", west, -Math.PI);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.number.lessThanOrEquals */ .Z.typeOf.number.lessThanOrEquals("west", west, Math.PI);\n\n  var east = rectangle.east;\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals("east", east, -Math.PI);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.number.lessThanOrEquals */ .Z.typeOf.number.lessThanOrEquals("east", east, Math.PI);\n  //>>includeEnd(\'debug\');\n};\n\n/**\n * Computes the southwest corner of a rectangle.\n *\n * @param {Rectangle} rectangle The rectangle for which to find the corner\n * @param {Cartographic} [result] The object onto which to store the result.\n * @returns {Cartographic} The modified result parameter or a new Cartographic instance if none was provided.\n */\nRectangle.southwest = function (rectangle, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  //>>includeEnd(\'debug\');\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(result)) {\n    return new _Cartographic_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(rectangle.west, rectangle.south);\n  }\n  result.longitude = rectangle.west;\n  result.latitude = rectangle.south;\n  result.height = 0.0;\n  return result;\n};\n\n/**\n * Computes the northwest corner of a rectangle.\n *\n * @param {Rectangle} rectangle The rectangle for which to find the corner\n * @param {Cartographic} [result] The object onto which to store the result.\n * @returns {Cartographic} The modified result parameter or a new Cartographic instance if none was provided.\n */\nRectangle.northwest = function (rectangle, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  //>>includeEnd(\'debug\');\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(result)) {\n    return new _Cartographic_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(rectangle.west, rectangle.north);\n  }\n  result.longitude = rectangle.west;\n  result.latitude = rectangle.north;\n  result.height = 0.0;\n  return result;\n};\n\n/**\n * Computes the northeast corner of a rectangle.\n *\n * @param {Rectangle} rectangle The rectangle for which to find the corner\n * @param {Cartographic} [result] The object onto which to store the result.\n * @returns {Cartographic} The modified result parameter or a new Cartographic instance if none was provided.\n */\nRectangle.northeast = function (rectangle, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  //>>includeEnd(\'debug\');\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(result)) {\n    return new _Cartographic_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(rectangle.east, rectangle.north);\n  }\n  result.longitude = rectangle.east;\n  result.latitude = rectangle.north;\n  result.height = 0.0;\n  return result;\n};\n\n/**\n * Computes the southeast corner of a rectangle.\n *\n * @param {Rectangle} rectangle The rectangle for which to find the corner\n * @param {Cartographic} [result] The object onto which to store the result.\n * @returns {Cartographic} The modified result parameter or a new Cartographic instance if none was provided.\n */\nRectangle.southeast = function (rectangle, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  //>>includeEnd(\'debug\');\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(result)) {\n    return new _Cartographic_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(rectangle.east, rectangle.south);\n  }\n  result.longitude = rectangle.east;\n  result.latitude = rectangle.south;\n  result.height = 0.0;\n  return result;\n};\n\n/**\n * Computes the center of a rectangle.\n *\n * @param {Rectangle} rectangle The rectangle for which to find the center\n * @param {Cartographic} [result] The object onto which to store the result.\n * @returns {Cartographic} The modified result parameter or a new Cartographic instance if none was provided.\n */\nRectangle.center = function (rectangle, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  //>>includeEnd(\'debug\');\n\n  var east = rectangle.east;\n  var west = rectangle.west;\n\n  if (east < west) {\n    east += _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n  }\n\n  var longitude = _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].negativePiToPi */ .Z.negativePiToPi((west + east) * 0.5);\n  var latitude = (rectangle.south + rectangle.north) * 0.5;\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(result)) {\n    return new _Cartographic_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(longitude, latitude);\n  }\n\n  result.longitude = longitude;\n  result.latitude = latitude;\n  result.height = 0.0;\n  return result;\n};\n\n/**\n * Computes the intersection of two rectangles.  This function assumes that the rectangle\'s coordinates are\n * latitude and longitude in radians and produces a correct intersection, taking into account the fact that\n * the same angle can be represented with multiple values as well as the wrapping of longitude at the\n * anti-meridian.  For a simple intersection that ignores these factors and can be used with projected\n * coordinates, see {@link Rectangle.simpleIntersection}.\n *\n * @param {Rectangle} rectangle On rectangle to find an intersection\n * @param {Rectangle} otherRectangle Another rectangle to find an intersection\n * @param {Rectangle} [result] The object onto which to store the result.\n * @returns {Rectangle|undefined} The modified result parameter, a new Rectangle instance if none was provided or undefined if there is no intersection.\n */\nRectangle.intersection = function (rectangle, otherRectangle, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("otherRectangle", otherRectangle);\n  //>>includeEnd(\'debug\');\n\n  var rectangleEast = rectangle.east;\n  var rectangleWest = rectangle.west;\n\n  var otherRectangleEast = otherRectangle.east;\n  var otherRectangleWest = otherRectangle.west;\n\n  if (rectangleEast < rectangleWest && otherRectangleEast > 0.0) {\n    rectangleEast += _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n  } else if (otherRectangleEast < otherRectangleWest && rectangleEast > 0.0) {\n    otherRectangleEast += _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n  }\n\n  if (rectangleEast < rectangleWest && otherRectangleWest < 0.0) {\n    otherRectangleWest += _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n  } else if (otherRectangleEast < otherRectangleWest && rectangleWest < 0.0) {\n    rectangleWest += _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n  }\n\n  var west = _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].negativePiToPi */ .Z.negativePiToPi(\n    Math.max(rectangleWest, otherRectangleWest)\n  );\n  var east = _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].negativePiToPi */ .Z.negativePiToPi(\n    Math.min(rectangleEast, otherRectangleEast)\n  );\n\n  if (\n    (rectangle.west < rectangle.east ||\n      otherRectangle.west < otherRectangle.east) &&\n    east <= west\n  ) {\n    return undefined;\n  }\n\n  var south = Math.max(rectangle.south, otherRectangle.south);\n  var north = Math.min(rectangle.north, otherRectangle.north);\n\n  if (south >= north) {\n    return undefined;\n  }\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(result)) {\n    return new Rectangle(west, south, east, north);\n  }\n  result.west = west;\n  result.south = south;\n  result.east = east;\n  result.north = north;\n  return result;\n};\n\n/**\n * Computes a simple intersection of two rectangles.  Unlike {@link Rectangle.intersection}, this function\n * does not attempt to put the angular coordinates into a consistent range or to account for crossing the\n * anti-meridian.  As such, it can be used for rectangles where the coordinates are not simply latitude\n * and longitude (i.e. projected coordinates).\n *\n * @param {Rectangle} rectangle On rectangle to find an intersection\n * @param {Rectangle} otherRectangle Another rectangle to find an intersection\n * @param {Rectangle} [result] The object onto which to store the result.\n * @returns {Rectangle|undefined} The modified result parameter, a new Rectangle instance if none was provided or undefined if there is no intersection.\n */\nRectangle.simpleIntersection = function (rectangle, otherRectangle, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("otherRectangle", otherRectangle);\n  //>>includeEnd(\'debug\');\n\n  var west = Math.max(rectangle.west, otherRectangle.west);\n  var south = Math.max(rectangle.south, otherRectangle.south);\n  var east = Math.min(rectangle.east, otherRectangle.east);\n  var north = Math.min(rectangle.north, otherRectangle.north);\n\n  if (south >= north || west >= east) {\n    return undefined;\n  }\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(result)) {\n    return new Rectangle(west, south, east, north);\n  }\n\n  result.west = west;\n  result.south = south;\n  result.east = east;\n  result.north = north;\n  return result;\n};\n\n/**\n * Computes a rectangle that is the union of two rectangles.\n *\n * @param {Rectangle} rectangle A rectangle to enclose in rectangle.\n * @param {Rectangle} otherRectangle A rectangle to enclose in a rectangle.\n * @param {Rectangle} [result] The object onto which to store the result.\n * @returns {Rectangle} The modified result parameter or a new Rectangle instance if none was provided.\n */\nRectangle.union = function (rectangle, otherRectangle, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("otherRectangle", otherRectangle);\n  //>>includeEnd(\'debug\');\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(result)) {\n    result = new Rectangle();\n  }\n\n  var rectangleEast = rectangle.east;\n  var rectangleWest = rectangle.west;\n\n  var otherRectangleEast = otherRectangle.east;\n  var otherRectangleWest = otherRectangle.west;\n\n  if (rectangleEast < rectangleWest && otherRectangleEast > 0.0) {\n    rectangleEast += _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n  } else if (otherRectangleEast < otherRectangleWest && rectangleEast > 0.0) {\n    otherRectangleEast += _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n  }\n\n  if (rectangleEast < rectangleWest && otherRectangleWest < 0.0) {\n    otherRectangleWest += _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n  } else if (otherRectangleEast < otherRectangleWest && rectangleWest < 0.0) {\n    rectangleWest += _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n  }\n\n  var west = _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].convertLongitudeRange */ .Z.convertLongitudeRange(\n    Math.min(rectangleWest, otherRectangleWest)\n  );\n  var east = _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].convertLongitudeRange */ .Z.convertLongitudeRange(\n    Math.max(rectangleEast, otherRectangleEast)\n  );\n\n  result.west = west;\n  result.south = Math.min(rectangle.south, otherRectangle.south);\n  result.east = east;\n  result.north = Math.max(rectangle.north, otherRectangle.north);\n\n  return result;\n};\n\n/**\n * Computes a rectangle by enlarging the provided rectangle until it contains the provided cartographic.\n *\n * @param {Rectangle} rectangle A rectangle to expand.\n * @param {Cartographic} cartographic A cartographic to enclose in a rectangle.\n * @param {Rectangle} [result] The object onto which to store the result.\n * @returns {Rectangle} The modified result parameter or a new Rectangle instance if one was not provided.\n */\nRectangle.expand = function (rectangle, cartographic, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("cartographic", cartographic);\n  //>>includeEnd(\'debug\');\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(result)) {\n    result = new Rectangle();\n  }\n\n  result.west = Math.min(rectangle.west, cartographic.longitude);\n  result.south = Math.min(rectangle.south, cartographic.latitude);\n  result.east = Math.max(rectangle.east, cartographic.longitude);\n  result.north = Math.max(rectangle.north, cartographic.latitude);\n\n  return result;\n};\n\n/**\n * Returns true if the cartographic is on or inside the rectangle, false otherwise.\n *\n * @param {Rectangle} rectangle The rectangle\n * @param {Cartographic} cartographic The cartographic to test.\n * @returns {Boolean} true if the provided cartographic is inside the rectangle, false otherwise.\n */\nRectangle.contains = function (rectangle, cartographic) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("cartographic", cartographic);\n  //>>includeEnd(\'debug\');\n\n  var longitude = cartographic.longitude;\n  var latitude = cartographic.latitude;\n\n  var west = rectangle.west;\n  var east = rectangle.east;\n\n  if (east < west) {\n    east += _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n    if (longitude < 0.0) {\n      longitude += _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n    }\n  }\n  return (\n    (longitude > west ||\n      _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].equalsEpsilon */ .Z.equalsEpsilon(longitude, west, _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].EPSILON14 */ .Z.EPSILON14)) &&\n    (longitude < east ||\n      _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].equalsEpsilon */ .Z.equalsEpsilon(longitude, east, _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].EPSILON14 */ .Z.EPSILON14)) &&\n    latitude >= rectangle.south &&\n    latitude <= rectangle.north\n  );\n};\n\nvar subsampleLlaScratch = new _Cartographic_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\n/**\n * Samples a rectangle so that it includes a list of Cartesian points suitable for passing to\n * {@link BoundingSphere#fromPoints}.  Sampling is necessary to account\n * for rectangles that cover the poles or cross the equator.\n *\n * @param {Rectangle} rectangle The rectangle to subsample.\n * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid to use.\n * @param {Number} [surfaceHeight=0.0] The height of the rectangle above the ellipsoid.\n * @param {Cartesian3[]} [result] The array of Cartesians onto which to store the result.\n * @returns {Cartesian3[]} The modified result parameter or a new Array of Cartesians instances if none was provided.\n */\nRectangle.subsample = function (rectangle, ellipsoid, surfaceHeight, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  //>>includeEnd(\'debug\');\n\n  ellipsoid = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(ellipsoid, _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].WGS84 */ .Z.WGS84);\n  surfaceHeight = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(surfaceHeight, 0.0);\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(result)) {\n    result = [];\n  }\n  var length = 0;\n\n  var north = rectangle.north;\n  var south = rectangle.south;\n  var east = rectangle.east;\n  var west = rectangle.west;\n\n  var lla = subsampleLlaScratch;\n  lla.height = surfaceHeight;\n\n  lla.longitude = west;\n  lla.latitude = north;\n  result[length] = ellipsoid.cartographicToCartesian(lla, result[length]);\n  length++;\n\n  lla.longitude = east;\n  result[length] = ellipsoid.cartographicToCartesian(lla, result[length]);\n  length++;\n\n  lla.latitude = south;\n  result[length] = ellipsoid.cartographicToCartesian(lla, result[length]);\n  length++;\n\n  lla.longitude = west;\n  result[length] = ellipsoid.cartographicToCartesian(lla, result[length]);\n  length++;\n\n  if (north < 0.0) {\n    lla.latitude = north;\n  } else if (south > 0.0) {\n    lla.latitude = south;\n  } else {\n    lla.latitude = 0.0;\n  }\n\n  for (var i = 1; i < 8; ++i) {\n    lla.longitude = -Math.PI + i * _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI_OVER_TWO */ .Z.PI_OVER_TWO;\n    if (Rectangle.contains(rectangle, lla)) {\n      result[length] = ellipsoid.cartographicToCartesian(lla, result[length]);\n      length++;\n    }\n  }\n\n  if (lla.latitude === 0.0) {\n    lla.longitude = west;\n    result[length] = ellipsoid.cartographicToCartesian(lla, result[length]);\n    length++;\n    lla.longitude = east;\n    result[length] = ellipsoid.cartographicToCartesian(lla, result[length]);\n    length++;\n  }\n  result.length = length;\n  return result;\n};\n\n/**\n * The largest possible rectangle.\n *\n * @type {Rectangle}\n * @constant\n */\nRectangle.MAX_VALUE = Object.freeze(\n  new Rectangle(\n    -Math.PI,\n    -_Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI_OVER_TWO */ .Z.PI_OVER_TWO,\n    Math.PI,\n    _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI_OVER_TWO */ .Z.PI_OVER_TWO\n  )\n);\n/* harmony default export */ __webpack_exports__["Z"] = (Rectangle);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDcEU7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsOEJBQThCLGlFQUFZO0FBQzFDO0FBQ0E7QUFDQSxJQUFJLGdDQUFnQztBQUNwQztBQUNBO0FBQ0EsV0FBVyxXQUFXO0FBQ3RCLFdBQVcsV0FBVztBQUN0QixXQUFXLFFBQVE7QUFDbkIsV0FBVyxjQUFjO0FBQ3pCLGFBQWEsY0FBYztBQUMzQjtBQUNBO0FBQ0E7QUFDQSxFQUFFLHNGQUFtQjtBQUNyQjs7QUFFQSxjQUFjLHFFQUFZLFlBQVksMEVBQWU7QUFDckQsa0JBQWtCLHFFQUFZOztBQUU5QixPQUFPLGdFQUFPO0FBQ2Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLElBQUk7QUFDSjtBQUNBOztBQUVBLGtCQUFrQixPQUFPO0FBQ3pCLG1DQUFtQyxpRkFBc0I7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxpRkFBc0I7QUFDM0I7QUFDQSxJQUFJLGlGQUFzQjtBQUMxQjtBQUNBO0FBQ0EseURBQWUsU0FBUyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnVlMy13ZWJwYWNrNS8uL25vZGVfbW9kdWxlcy9jZXNpdW0vU291cmNlL0NvcmUvUmVjdGFuZ2xlLmpzP2IxYjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENhcnRvZ3JhcGhpYyBmcm9tIFwiLi9DYXJ0b2dyYXBoaWMuanNcIjtcbmltcG9ydCBDaGVjayBmcm9tIFwiLi9DaGVjay5qc1wiO1xuaW1wb3J0IGRlZmF1bHRWYWx1ZSBmcm9tIFwiLi9kZWZhdWx0VmFsdWUuanNcIjtcbmltcG9ydCBkZWZpbmVkIGZyb20gXCIuL2RlZmluZWQuanNcIjtcbmltcG9ydCBFbGxpcHNvaWQgZnJvbSBcIi4vRWxsaXBzb2lkLmpzXCI7XG5pbXBvcnQgQ2VzaXVtTWF0aCBmcm9tIFwiLi9NYXRoLmpzXCI7XG5cbi8qKlxuICogQSB0d28gZGltZW5zaW9uYWwgcmVnaW9uIHNwZWNpZmllZCBhcyBsb25naXR1ZGUgYW5kIGxhdGl0dWRlIGNvb3JkaW5hdGVzLlxuICpcbiAqIEBhbGlhcyBSZWN0YW5nbGVcbiAqIEBjb25zdHJ1Y3RvclxuICpcbiAqIEBwYXJhbSB7TnVtYmVyfSBbd2VzdD0wLjBdIFRoZSB3ZXN0ZXJubW9zdCBsb25naXR1ZGUsIGluIHJhZGlhbnMsIGluIHRoZSByYW5nZSBbLVBpLCBQaV0uXG4gKiBAcGFyYW0ge051bWJlcn0gW3NvdXRoPTAuMF0gVGhlIHNvdXRoZXJubW9zdCBsYXRpdHVkZSwgaW4gcmFkaWFucywgaW4gdGhlIHJhbmdlIFstUGkvMiwgUGkvMl0uXG4gKiBAcGFyYW0ge051bWJlcn0gW2Vhc3Q9MC4wXSBUaGUgZWFzdGVybm1vc3QgbG9uZ2l0dWRlLCBpbiByYWRpYW5zLCBpbiB0aGUgcmFuZ2UgWy1QaSwgUGldLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtub3J0aD0wLjBdIFRoZSBub3J0aGVybm1vc3QgbGF0aXR1ZGUsIGluIHJhZGlhbnMsIGluIHRoZSByYW5nZSBbLVBpLzIsIFBpLzJdLlxuICpcbiAqIEBzZWUgUGFja2FibGVcbiAqL1xuZnVuY3Rpb24gUmVjdGFuZ2xlKHdlc3QsIHNvdXRoLCBlYXN0LCBub3J0aCkge1xuICAvKipcbiAgICogVGhlIHdlc3Rlcm5tb3N0IGxvbmdpdHVkZSBpbiByYWRpYW5zIGluIHRoZSByYW5nZSBbLVBpLCBQaV0uXG4gICAqXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqIEBkZWZhdWx0IDAuMFxuICAgKi9cbiAgdGhpcy53ZXN0ID0gZGVmYXVsdFZhbHVlKHdlc3QsIDAuMCk7XG5cbiAgLyoqXG4gICAqIFRoZSBzb3V0aGVybm1vc3QgbGF0aXR1ZGUgaW4gcmFkaWFucyBpbiB0aGUgcmFuZ2UgWy1QaS8yLCBQaS8yXS5cbiAgICpcbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQGRlZmF1bHQgMC4wXG4gICAqL1xuICB0aGlzLnNvdXRoID0gZGVmYXVsdFZhbHVlKHNvdXRoLCAwLjApO1xuXG4gIC8qKlxuICAgKiBUaGUgZWFzdGVybm1vc3QgbG9uZ2l0dWRlIGluIHJhZGlhbnMgaW4gdGhlIHJhbmdlIFstUGksIFBpXS5cbiAgICpcbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQGRlZmF1bHQgMC4wXG4gICAqL1xuICB0aGlzLmVhc3QgPSBkZWZhdWx0VmFsdWUoZWFzdCwgMC4wKTtcblxuICAvKipcbiAgICogVGhlIG5vcnRoZXJubW9zdCBsYXRpdHVkZSBpbiByYWRpYW5zIGluIHRoZSByYW5nZSBbLVBpLzIsIFBpLzJdLlxuICAgKlxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKiBAZGVmYXVsdCAwLjBcbiAgICovXG4gIHRoaXMubm9ydGggPSBkZWZhdWx0VmFsdWUobm9ydGgsIDAuMCk7XG59XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFJlY3RhbmdsZS5wcm90b3R5cGUsIHtcbiAgLyoqXG4gICAqIEdldHMgdGhlIHdpZHRoIG9mIHRoZSByZWN0YW5nbGUgaW4gcmFkaWFucy5cbiAgICogQG1lbWJlcm9mIFJlY3RhbmdsZS5wcm90b3R5cGVcbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQHJlYWRvbmx5XG4gICAqL1xuICB3aWR0aDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIFJlY3RhbmdsZS5jb21wdXRlV2lkdGgodGhpcyk7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogR2V0cyB0aGUgaGVpZ2h0IG9mIHRoZSByZWN0YW5nbGUgaW4gcmFkaWFucy5cbiAgICogQG1lbWJlcm9mIFJlY3RhbmdsZS5wcm90b3R5cGVcbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQHJlYWRvbmx5XG4gICAqL1xuICBoZWlnaHQ6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBSZWN0YW5nbGUuY29tcHV0ZUhlaWdodCh0aGlzKTtcbiAgICB9LFxuICB9LFxufSk7XG5cbi8qKlxuICogVGhlIG51bWJlciBvZiBlbGVtZW50cyB1c2VkIHRvIHBhY2sgdGhlIG9iamVjdCBpbnRvIGFuIGFycmF5LlxuICogQHR5cGUge051bWJlcn1cbiAqL1xuUmVjdGFuZ2xlLnBhY2tlZExlbmd0aCA9IDQ7XG5cbi8qKlxuICogU3RvcmVzIHRoZSBwcm92aWRlZCBpbnN0YW5jZSBpbnRvIHRoZSBwcm92aWRlZCBhcnJheS5cbiAqXG4gKiBAcGFyYW0ge1JlY3RhbmdsZX0gdmFsdWUgVGhlIHZhbHVlIHRvIHBhY2suXG4gKiBAcGFyYW0ge051bWJlcltdfSBhcnJheSBUaGUgYXJyYXkgdG8gcGFjayBpbnRvLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtzdGFydGluZ0luZGV4PTBdIFRoZSBpbmRleCBpbnRvIHRoZSBhcnJheSBhdCB3aGljaCB0byBzdGFydCBwYWNraW5nIHRoZSBlbGVtZW50cy5cbiAqXG4gKiBAcmV0dXJucyB7TnVtYmVyW119IFRoZSBhcnJheSB0aGF0IHdhcyBwYWNrZWQgaW50b1xuICovXG5SZWN0YW5nbGUucGFjayA9IGZ1bmN0aW9uICh2YWx1ZSwgYXJyYXksIHN0YXJ0aW5nSW5kZXgpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcInZhbHVlXCIsIHZhbHVlKTtcbiAgQ2hlY2suZGVmaW5lZChcImFycmF5XCIsIGFycmF5KTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgc3RhcnRpbmdJbmRleCA9IGRlZmF1bHRWYWx1ZShzdGFydGluZ0luZGV4LCAwKTtcblxuICBhcnJheVtzdGFydGluZ0luZGV4KytdID0gdmFsdWUud2VzdDtcbiAgYXJyYXlbc3RhcnRpbmdJbmRleCsrXSA9IHZhbHVlLnNvdXRoO1xuICBhcnJheVtzdGFydGluZ0luZGV4KytdID0gdmFsdWUuZWFzdDtcbiAgYXJyYXlbc3RhcnRpbmdJbmRleF0gPSB2YWx1ZS5ub3J0aDtcblxuICByZXR1cm4gYXJyYXk7XG59O1xuXG4vKipcbiAqIFJldHJpZXZlcyBhbiBpbnN0YW5jZSBmcm9tIGEgcGFja2VkIGFycmF5LlxuICpcbiAqIEBwYXJhbSB7TnVtYmVyW119IGFycmF5IFRoZSBwYWNrZWQgYXJyYXkuXG4gKiBAcGFyYW0ge051bWJlcn0gW3N0YXJ0aW5nSW5kZXg9MF0gVGhlIHN0YXJ0aW5nIGluZGV4IG9mIHRoZSBlbGVtZW50IHRvIGJlIHVucGFja2VkLlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IFtyZXN1bHRdIFRoZSBvYmplY3QgaW50byB3aGljaCB0byBzdG9yZSB0aGUgcmVzdWx0LlxuICogQHJldHVybnMge1JlY3RhbmdsZX0gVGhlIG1vZGlmaWVkIHJlc3VsdCBwYXJhbWV0ZXIgb3IgYSBuZXcgUmVjdGFuZ2xlIGluc3RhbmNlIGlmIG9uZSB3YXMgbm90IHByb3ZpZGVkLlxuICovXG5SZWN0YW5nbGUudW5wYWNrID0gZnVuY3Rpb24gKGFycmF5LCBzdGFydGluZ0luZGV4LCByZXN1bHQpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2suZGVmaW5lZChcImFycmF5XCIsIGFycmF5KTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgc3RhcnRpbmdJbmRleCA9IGRlZmF1bHRWYWx1ZShzdGFydGluZ0luZGV4LCAwKTtcblxuICBpZiAoIWRlZmluZWQocmVzdWx0KSkge1xuICAgIHJlc3VsdCA9IG5ldyBSZWN0YW5nbGUoKTtcbiAgfVxuXG4gIHJlc3VsdC53ZXN0ID0gYXJyYXlbc3RhcnRpbmdJbmRleCsrXTtcbiAgcmVzdWx0LnNvdXRoID0gYXJyYXlbc3RhcnRpbmdJbmRleCsrXTtcbiAgcmVzdWx0LmVhc3QgPSBhcnJheVtzdGFydGluZ0luZGV4KytdO1xuICByZXN1bHQubm9ydGggPSBhcnJheVtzdGFydGluZ0luZGV4XTtcbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8qKlxuICogQ29tcHV0ZXMgdGhlIHdpZHRoIG9mIGEgcmVjdGFuZ2xlIGluIHJhZGlhbnMuXG4gKiBAcGFyYW0ge1JlY3RhbmdsZX0gcmVjdGFuZ2xlIFRoZSByZWN0YW5nbGUgdG8gY29tcHV0ZSB0aGUgd2lkdGggb2YuXG4gKiBAcmV0dXJucyB7TnVtYmVyfSBUaGUgd2lkdGguXG4gKi9cblJlY3RhbmdsZS5jb21wdXRlV2lkdGggPSBmdW5jdGlvbiAocmVjdGFuZ2xlKSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJyZWN0YW5nbGVcIiwgcmVjdGFuZ2xlKTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG4gIHZhciBlYXN0ID0gcmVjdGFuZ2xlLmVhc3Q7XG4gIHZhciB3ZXN0ID0gcmVjdGFuZ2xlLndlc3Q7XG4gIGlmIChlYXN0IDwgd2VzdCkge1xuICAgIGVhc3QgKz0gQ2VzaXVtTWF0aC5UV09fUEk7XG4gIH1cbiAgcmV0dXJuIGVhc3QgLSB3ZXN0O1xufTtcblxuLyoqXG4gKiBDb21wdXRlcyB0aGUgaGVpZ2h0IG9mIGEgcmVjdGFuZ2xlIGluIHJhZGlhbnMuXG4gKiBAcGFyYW0ge1JlY3RhbmdsZX0gcmVjdGFuZ2xlIFRoZSByZWN0YW5nbGUgdG8gY29tcHV0ZSB0aGUgaGVpZ2h0IG9mLlxuICogQHJldHVybnMge051bWJlcn0gVGhlIGhlaWdodC5cbiAqL1xuUmVjdGFuZ2xlLmNvbXB1dGVIZWlnaHQgPSBmdW5jdGlvbiAocmVjdGFuZ2xlKSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJyZWN0YW5nbGVcIiwgcmVjdGFuZ2xlKTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG4gIHJldHVybiByZWN0YW5nbGUubm9ydGggLSByZWN0YW5nbGUuc291dGg7XG59O1xuXG4vKipcbiAqIENyZWF0ZXMgYSByZWN0YW5nbGUgZ2l2ZW4gdGhlIGJvdW5kYXJ5IGxvbmdpdHVkZSBhbmQgbGF0aXR1ZGUgaW4gZGVncmVlcy5cbiAqXG4gKiBAcGFyYW0ge051bWJlcn0gW3dlc3Q9MC4wXSBUaGUgd2VzdGVybm1vc3QgbG9uZ2l0dWRlIGluIGRlZ3JlZXMgaW4gdGhlIHJhbmdlIFstMTgwLjAsIDE4MC4wXS5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbc291dGg9MC4wXSBUaGUgc291dGhlcm5tb3N0IGxhdGl0dWRlIGluIGRlZ3JlZXMgaW4gdGhlIHJhbmdlIFstOTAuMCwgOTAuMF0uXG4gKiBAcGFyYW0ge051bWJlcn0gW2Vhc3Q9MC4wXSBUaGUgZWFzdGVybm1vc3QgbG9uZ2l0dWRlIGluIGRlZ3JlZXMgaW4gdGhlIHJhbmdlIFstMTgwLjAsIDE4MC4wXS5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbbm9ydGg9MC4wXSBUaGUgbm9ydGhlcm5tb3N0IGxhdGl0dWRlIGluIGRlZ3JlZXMgaW4gdGhlIHJhbmdlIFstOTAuMCwgOTAuMF0uXG4gKiBAcGFyYW0ge1JlY3RhbmdsZX0gW3Jlc3VsdF0gVGhlIG9iamVjdCBvbnRvIHdoaWNoIHRvIHN0b3JlIHRoZSByZXN1bHQsIG9yIHVuZGVmaW5lZCBpZiBhIG5ldyBpbnN0YW5jZSBzaG91bGQgYmUgY3JlYXRlZC5cbiAqIEByZXR1cm5zIHtSZWN0YW5nbGV9IFRoZSBtb2RpZmllZCByZXN1bHQgcGFyYW1ldGVyIG9yIGEgbmV3IFJlY3RhbmdsZSBpbnN0YW5jZSBpZiBub25lIHdhcyBwcm92aWRlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogdmFyIHJlY3RhbmdsZSA9IENlc2l1bS5SZWN0YW5nbGUuZnJvbURlZ3JlZXMoMC4wLCAyMC4wLCAxMC4wLCAzMC4wKTtcbiAqL1xuUmVjdGFuZ2xlLmZyb21EZWdyZWVzID0gZnVuY3Rpb24gKHdlc3QsIHNvdXRoLCBlYXN0LCBub3J0aCwgcmVzdWx0KSB7XG4gIHdlc3QgPSBDZXNpdW1NYXRoLnRvUmFkaWFucyhkZWZhdWx0VmFsdWUod2VzdCwgMC4wKSk7XG4gIHNvdXRoID0gQ2VzaXVtTWF0aC50b1JhZGlhbnMoZGVmYXVsdFZhbHVlKHNvdXRoLCAwLjApKTtcbiAgZWFzdCA9IENlc2l1bU1hdGgudG9SYWRpYW5zKGRlZmF1bHRWYWx1ZShlYXN0LCAwLjApKTtcbiAgbm9ydGggPSBDZXNpdW1NYXRoLnRvUmFkaWFucyhkZWZhdWx0VmFsdWUobm9ydGgsIDAuMCkpO1xuXG4gIGlmICghZGVmaW5lZChyZXN1bHQpKSB7XG4gICAgcmV0dXJuIG5ldyBSZWN0YW5nbGUod2VzdCwgc291dGgsIGVhc3QsIG5vcnRoKTtcbiAgfVxuXG4gIHJlc3VsdC53ZXN0ID0gd2VzdDtcbiAgcmVzdWx0LnNvdXRoID0gc291dGg7XG4gIHJlc3VsdC5lYXN0ID0gZWFzdDtcbiAgcmVzdWx0Lm5vcnRoID0gbm9ydGg7XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIHJlY3RhbmdsZSBnaXZlbiB0aGUgYm91bmRhcnkgbG9uZ2l0dWRlIGFuZCBsYXRpdHVkZSBpbiByYWRpYW5zLlxuICpcbiAqIEBwYXJhbSB7TnVtYmVyfSBbd2VzdD0wLjBdIFRoZSB3ZXN0ZXJubW9zdCBsb25naXR1ZGUgaW4gcmFkaWFucyBpbiB0aGUgcmFuZ2UgWy1NYXRoLlBJLCBNYXRoLlBJXS5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbc291dGg9MC4wXSBUaGUgc291dGhlcm5tb3N0IGxhdGl0dWRlIGluIHJhZGlhbnMgaW4gdGhlIHJhbmdlIFstTWF0aC5QSS8yLCBNYXRoLlBJLzJdLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtlYXN0PTAuMF0gVGhlIGVhc3Rlcm5tb3N0IGxvbmdpdHVkZSBpbiByYWRpYW5zIGluIHRoZSByYW5nZSBbLU1hdGguUEksIE1hdGguUEldLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtub3J0aD0wLjBdIFRoZSBub3J0aGVybm1vc3QgbGF0aXR1ZGUgaW4gcmFkaWFucyBpbiB0aGUgcmFuZ2UgWy1NYXRoLlBJLzIsIE1hdGguUEkvMl0uXG4gKiBAcGFyYW0ge1JlY3RhbmdsZX0gW3Jlc3VsdF0gVGhlIG9iamVjdCBvbnRvIHdoaWNoIHRvIHN0b3JlIHRoZSByZXN1bHQsIG9yIHVuZGVmaW5lZCBpZiBhIG5ldyBpbnN0YW5jZSBzaG91bGQgYmUgY3JlYXRlZC5cbiAqIEByZXR1cm5zIHtSZWN0YW5nbGV9IFRoZSBtb2RpZmllZCByZXN1bHQgcGFyYW1ldGVyIG9yIGEgbmV3IFJlY3RhbmdsZSBpbnN0YW5jZSBpZiBub25lIHdhcyBwcm92aWRlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogdmFyIHJlY3RhbmdsZSA9IENlc2l1bS5SZWN0YW5nbGUuZnJvbVJhZGlhbnMoMC4wLCBNYXRoLlBJLzQsIE1hdGguUEkvOCwgMypNYXRoLlBJLzQpO1xuICovXG5SZWN0YW5nbGUuZnJvbVJhZGlhbnMgPSBmdW5jdGlvbiAod2VzdCwgc291dGgsIGVhc3QsIG5vcnRoLCByZXN1bHQpIHtcbiAgaWYgKCFkZWZpbmVkKHJlc3VsdCkpIHtcbiAgICByZXR1cm4gbmV3IFJlY3RhbmdsZSh3ZXN0LCBzb3V0aCwgZWFzdCwgbm9ydGgpO1xuICB9XG5cbiAgcmVzdWx0Lndlc3QgPSBkZWZhdWx0VmFsdWUod2VzdCwgMC4wKTtcbiAgcmVzdWx0LnNvdXRoID0gZGVmYXVsdFZhbHVlKHNvdXRoLCAwLjApO1xuICByZXN1bHQuZWFzdCA9IGRlZmF1bHRWYWx1ZShlYXN0LCAwLjApO1xuICByZXN1bHQubm9ydGggPSBkZWZhdWx0VmFsdWUobm9ydGgsIDAuMCk7XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyB0aGUgc21hbGxlc3QgcG9zc2libGUgUmVjdGFuZ2xlIHRoYXQgZW5jbG9zZXMgYWxsIHBvc2l0aW9ucyBpbiB0aGUgcHJvdmlkZWQgYXJyYXkuXG4gKlxuICogQHBhcmFtIHtDYXJ0b2dyYXBoaWNbXX0gY2FydG9ncmFwaGljcyBUaGUgbGlzdCBvZiBDYXJ0b2dyYXBoaWMgaW5zdGFuY2VzLlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IFtyZXN1bHRdIFRoZSBvYmplY3Qgb250byB3aGljaCB0byBzdG9yZSB0aGUgcmVzdWx0LCBvciB1bmRlZmluZWQgaWYgYSBuZXcgaW5zdGFuY2Ugc2hvdWxkIGJlIGNyZWF0ZWQuXG4gKiBAcmV0dXJucyB7UmVjdGFuZ2xlfSBUaGUgbW9kaWZpZWQgcmVzdWx0IHBhcmFtZXRlciBvciBhIG5ldyBSZWN0YW5nbGUgaW5zdGFuY2UgaWYgbm9uZSB3YXMgcHJvdmlkZWQuXG4gKi9cblJlY3RhbmdsZS5mcm9tQ2FydG9ncmFwaGljQXJyYXkgPSBmdW5jdGlvbiAoY2FydG9ncmFwaGljcywgcmVzdWx0KSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLmRlZmluZWQoXCJjYXJ0b2dyYXBoaWNzXCIsIGNhcnRvZ3JhcGhpY3MpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB2YXIgd2VzdCA9IE51bWJlci5NQVhfVkFMVUU7XG4gIHZhciBlYXN0ID0gLU51bWJlci5NQVhfVkFMVUU7XG4gIHZhciB3ZXN0T3ZlcklETCA9IE51bWJlci5NQVhfVkFMVUU7XG4gIHZhciBlYXN0T3ZlcklETCA9IC1OdW1iZXIuTUFYX1ZBTFVFO1xuICB2YXIgc291dGggPSBOdW1iZXIuTUFYX1ZBTFVFO1xuICB2YXIgbm9ydGggPSAtTnVtYmVyLk1BWF9WQUxVRTtcblxuICBmb3IgKHZhciBpID0gMCwgbGVuID0gY2FydG9ncmFwaGljcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgIHZhciBwb3NpdGlvbiA9IGNhcnRvZ3JhcGhpY3NbaV07XG4gICAgd2VzdCA9IE1hdGgubWluKHdlc3QsIHBvc2l0aW9uLmxvbmdpdHVkZSk7XG4gICAgZWFzdCA9IE1hdGgubWF4KGVhc3QsIHBvc2l0aW9uLmxvbmdpdHVkZSk7XG4gICAgc291dGggPSBNYXRoLm1pbihzb3V0aCwgcG9zaXRpb24ubGF0aXR1ZGUpO1xuICAgIG5vcnRoID0gTWF0aC5tYXgobm9ydGgsIHBvc2l0aW9uLmxhdGl0dWRlKTtcblxuICAgIHZhciBsb25BZGp1c3RlZCA9XG4gICAgICBwb3NpdGlvbi5sb25naXR1ZGUgPj0gMFxuICAgICAgICA/IHBvc2l0aW9uLmxvbmdpdHVkZVxuICAgICAgICA6IHBvc2l0aW9uLmxvbmdpdHVkZSArIENlc2l1bU1hdGguVFdPX1BJO1xuICAgIHdlc3RPdmVySURMID0gTWF0aC5taW4od2VzdE92ZXJJREwsIGxvbkFkanVzdGVkKTtcbiAgICBlYXN0T3ZlcklETCA9IE1hdGgubWF4KGVhc3RPdmVySURMLCBsb25BZGp1c3RlZCk7XG4gIH1cblxuICBpZiAoZWFzdCAtIHdlc3QgPiBlYXN0T3ZlcklETCAtIHdlc3RPdmVySURMKSB7XG4gICAgd2VzdCA9IHdlc3RPdmVySURMO1xuICAgIGVhc3QgPSBlYXN0T3ZlcklETDtcblxuICAgIGlmIChlYXN0ID4gQ2VzaXVtTWF0aC5QSSkge1xuICAgICAgZWFzdCA9IGVhc3QgLSBDZXNpdW1NYXRoLlRXT19QSTtcbiAgICB9XG4gICAgaWYgKHdlc3QgPiBDZXNpdW1NYXRoLlBJKSB7XG4gICAgICB3ZXN0ID0gd2VzdCAtIENlc2l1bU1hdGguVFdPX1BJO1xuICAgIH1cbiAgfVxuXG4gIGlmICghZGVmaW5lZChyZXN1bHQpKSB7XG4gICAgcmV0dXJuIG5ldyBSZWN0YW5nbGUod2VzdCwgc291dGgsIGVhc3QsIG5vcnRoKTtcbiAgfVxuXG4gIHJlc3VsdC53ZXN0ID0gd2VzdDtcbiAgcmVzdWx0LnNvdXRoID0gc291dGg7XG4gIHJlc3VsdC5lYXN0ID0gZWFzdDtcbiAgcmVzdWx0Lm5vcnRoID0gbm9ydGg7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG4vKipcbiAqIENyZWF0ZXMgdGhlIHNtYWxsZXN0IHBvc3NpYmxlIFJlY3RhbmdsZSB0aGF0IGVuY2xvc2VzIGFsbCBwb3NpdGlvbnMgaW4gdGhlIHByb3ZpZGVkIGFycmF5LlxuICpcbiAqIEBwYXJhbSB7Q2FydGVzaWFuM1tdfSBjYXJ0ZXNpYW5zIFRoZSBsaXN0IG9mIENhcnRlc2lhbiBpbnN0YW5jZXMuXG4gKiBAcGFyYW0ge0VsbGlwc29pZH0gW2VsbGlwc29pZD1FbGxpcHNvaWQuV0dTODRdIFRoZSBlbGxpcHNvaWQgdGhlIGNhcnRlc2lhbnMgYXJlIG9uLlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IFtyZXN1bHRdIFRoZSBvYmplY3Qgb250byB3aGljaCB0byBzdG9yZSB0aGUgcmVzdWx0LCBvciB1bmRlZmluZWQgaWYgYSBuZXcgaW5zdGFuY2Ugc2hvdWxkIGJlIGNyZWF0ZWQuXG4gKiBAcmV0dXJucyB7UmVjdGFuZ2xlfSBUaGUgbW9kaWZpZWQgcmVzdWx0IHBhcmFtZXRlciBvciBhIG5ldyBSZWN0YW5nbGUgaW5zdGFuY2UgaWYgbm9uZSB3YXMgcHJvdmlkZWQuXG4gKi9cblJlY3RhbmdsZS5mcm9tQ2FydGVzaWFuQXJyYXkgPSBmdW5jdGlvbiAoY2FydGVzaWFucywgZWxsaXBzb2lkLCByZXN1bHQpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2suZGVmaW5lZChcImNhcnRlc2lhbnNcIiwgY2FydGVzaWFucyk7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuICBlbGxpcHNvaWQgPSBkZWZhdWx0VmFsdWUoZWxsaXBzb2lkLCBFbGxpcHNvaWQuV0dTODQpO1xuXG4gIHZhciB3ZXN0ID0gTnVtYmVyLk1BWF9WQUxVRTtcbiAgdmFyIGVhc3QgPSAtTnVtYmVyLk1BWF9WQUxVRTtcbiAgdmFyIHdlc3RPdmVySURMID0gTnVtYmVyLk1BWF9WQUxVRTtcbiAgdmFyIGVhc3RPdmVySURMID0gLU51bWJlci5NQVhfVkFMVUU7XG4gIHZhciBzb3V0aCA9IE51bWJlci5NQVhfVkFMVUU7XG4gIHZhciBub3J0aCA9IC1OdW1iZXIuTUFYX1ZBTFVFO1xuXG4gIGZvciAodmFyIGkgPSAwLCBsZW4gPSBjYXJ0ZXNpYW5zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgdmFyIHBvc2l0aW9uID0gZWxsaXBzb2lkLmNhcnRlc2lhblRvQ2FydG9ncmFwaGljKGNhcnRlc2lhbnNbaV0pO1xuICAgIHdlc3QgPSBNYXRoLm1pbih3ZXN0LCBwb3NpdGlvbi5sb25naXR1ZGUpO1xuICAgIGVhc3QgPSBNYXRoLm1heChlYXN0LCBwb3NpdGlvbi5sb25naXR1ZGUpO1xuICAgIHNvdXRoID0gTWF0aC5taW4oc291dGgsIHBvc2l0aW9uLmxhdGl0dWRlKTtcbiAgICBub3J0aCA9IE1hdGgubWF4KG5vcnRoLCBwb3NpdGlvbi5sYXRpdHVkZSk7XG5cbiAgICB2YXIgbG9uQWRqdXN0ZWQgPVxuICAgICAgcG9zaXRpb24ubG9uZ2l0dWRlID49IDBcbiAgICAgICAgPyBwb3NpdGlvbi5sb25naXR1ZGVcbiAgICAgICAgOiBwb3NpdGlvbi5sb25naXR1ZGUgKyBDZXNpdW1NYXRoLlRXT19QSTtcbiAgICB3ZXN0T3ZlcklETCA9IE1hdGgubWluKHdlc3RPdmVySURMLCBsb25BZGp1c3RlZCk7XG4gICAgZWFzdE92ZXJJREwgPSBNYXRoLm1heChlYXN0T3ZlcklETCwgbG9uQWRqdXN0ZWQpO1xuICB9XG5cbiAgaWYgKGVhc3QgLSB3ZXN0ID4gZWFzdE92ZXJJREwgLSB3ZXN0T3ZlcklETCkge1xuICAgIHdlc3QgPSB3ZXN0T3ZlcklETDtcbiAgICBlYXN0ID0gZWFzdE92ZXJJREw7XG5cbiAgICBpZiAoZWFzdCA+IENlc2l1bU1hdGguUEkpIHtcbiAgICAgIGVhc3QgPSBlYXN0IC0gQ2VzaXVtTWF0aC5UV09fUEk7XG4gICAgfVxuICAgIGlmICh3ZXN0ID4gQ2VzaXVtTWF0aC5QSSkge1xuICAgICAgd2VzdCA9IHdlc3QgLSBDZXNpdW1NYXRoLlRXT19QSTtcbiAgICB9XG4gIH1cblxuICBpZiAoIWRlZmluZWQocmVzdWx0KSkge1xuICAgIHJldHVybiBuZXcgUmVjdGFuZ2xlKHdlc3QsIHNvdXRoLCBlYXN0LCBub3J0aCk7XG4gIH1cblxuICByZXN1bHQud2VzdCA9IHdlc3Q7XG4gIHJlc3VsdC5zb3V0aCA9IHNvdXRoO1xuICByZXN1bHQuZWFzdCA9IGVhc3Q7XG4gIHJlc3VsdC5ub3J0aCA9IG5vcnRoO1xuICByZXR1cm4gcmVzdWx0O1xufTtcblxuLyoqXG4gKiBEdXBsaWNhdGVzIGEgUmVjdGFuZ2xlLlxuICpcbiAqIEBwYXJhbSB7UmVjdGFuZ2xlfSByZWN0YW5nbGUgVGhlIHJlY3RhbmdsZSB0byBjbG9uZS5cbiAqIEBwYXJhbSB7UmVjdGFuZ2xlfSBbcmVzdWx0XSBUaGUgb2JqZWN0IG9udG8gd2hpY2ggdG8gc3RvcmUgdGhlIHJlc3VsdCwgb3IgdW5kZWZpbmVkIGlmIGEgbmV3IGluc3RhbmNlIHNob3VsZCBiZSBjcmVhdGVkLlxuICogQHJldHVybnMge1JlY3RhbmdsZX0gVGhlIG1vZGlmaWVkIHJlc3VsdCBwYXJhbWV0ZXIgb3IgYSBuZXcgUmVjdGFuZ2xlIGluc3RhbmNlIGlmIG5vbmUgd2FzIHByb3ZpZGVkLiAoUmV0dXJucyB1bmRlZmluZWQgaWYgcmVjdGFuZ2xlIGlzIHVuZGVmaW5lZClcbiAqL1xuUmVjdGFuZ2xlLmNsb25lID0gZnVuY3Rpb24gKHJlY3RhbmdsZSwgcmVzdWx0KSB7XG4gIGlmICghZGVmaW5lZChyZWN0YW5nbGUpKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIGlmICghZGVmaW5lZChyZXN1bHQpKSB7XG4gICAgcmV0dXJuIG5ldyBSZWN0YW5nbGUoXG4gICAgICByZWN0YW5nbGUud2VzdCxcbiAgICAgIHJlY3RhbmdsZS5zb3V0aCxcbiAgICAgIHJlY3RhbmdsZS5lYXN0LFxuICAgICAgcmVjdGFuZ2xlLm5vcnRoXG4gICAgKTtcbiAgfVxuXG4gIHJlc3VsdC53ZXN0ID0gcmVjdGFuZ2xlLndlc3Q7XG4gIHJlc3VsdC5zb3V0aCA9IHJlY3RhbmdsZS5zb3V0aDtcbiAgcmVzdWx0LmVhc3QgPSByZWN0YW5nbGUuZWFzdDtcbiAgcmVzdWx0Lm5vcnRoID0gcmVjdGFuZ2xlLm5vcnRoO1xuICByZXR1cm4gcmVzdWx0O1xufTtcblxuLyoqXG4gKiBDb21wYXJlcyB0aGUgcHJvdmlkZWQgUmVjdGFuZ2xlcyBjb21wb25lbnR3aXNlIGFuZCByZXR1cm5zXG4gKiA8Y29kZT50cnVlPC9jb2RlPiBpZiB0aGV5IHBhc3MgYW4gYWJzb2x1dGUgb3IgcmVsYXRpdmUgdG9sZXJhbmNlIHRlc3QsXG4gKiA8Y29kZT5mYWxzZTwvY29kZT4gb3RoZXJ3aXNlLlxuICpcbiAqIEBwYXJhbSB7UmVjdGFuZ2xlfSBbbGVmdF0gVGhlIGZpcnN0IFJlY3RhbmdsZS5cbiAqIEBwYXJhbSB7UmVjdGFuZ2xlfSBbcmlnaHRdIFRoZSBzZWNvbmQgUmVjdGFuZ2xlLlxuICogQHBhcmFtIHtOdW1iZXJ9IFthYnNvbHV0ZUVwc2lsb249MF0gVGhlIGFic29sdXRlIGVwc2lsb24gdG9sZXJhbmNlIHRvIHVzZSBmb3IgZXF1YWxpdHkgdGVzdGluZy5cbiAqIEByZXR1cm5zIHtCb29sZWFufSA8Y29kZT50cnVlPC9jb2RlPiBpZiBsZWZ0IGFuZCByaWdodCBhcmUgd2l0aGluIHRoZSBwcm92aWRlZCBlcHNpbG9uLCA8Y29kZT5mYWxzZTwvY29kZT4gb3RoZXJ3aXNlLlxuICovXG5SZWN0YW5nbGUuZXF1YWxzRXBzaWxvbiA9IGZ1bmN0aW9uIChsZWZ0LCByaWdodCwgYWJzb2x1dGVFcHNpbG9uKSB7XG4gIGFic29sdXRlRXBzaWxvbiA9IGRlZmF1bHRWYWx1ZShhYnNvbHV0ZUVwc2lsb24sIDApO1xuXG4gIHJldHVybiAoXG4gICAgbGVmdCA9PT0gcmlnaHQgfHxcbiAgICAoZGVmaW5lZChsZWZ0KSAmJlxuICAgICAgZGVmaW5lZChyaWdodCkgJiZcbiAgICAgIE1hdGguYWJzKGxlZnQud2VzdCAtIHJpZ2h0Lndlc3QpIDw9IGFic29sdXRlRXBzaWxvbiAmJlxuICAgICAgTWF0aC5hYnMobGVmdC5zb3V0aCAtIHJpZ2h0LnNvdXRoKSA8PSBhYnNvbHV0ZUVwc2lsb24gJiZcbiAgICAgIE1hdGguYWJzKGxlZnQuZWFzdCAtIHJpZ2h0LmVhc3QpIDw9IGFic29sdXRlRXBzaWxvbiAmJlxuICAgICAgTWF0aC5hYnMobGVmdC5ub3J0aCAtIHJpZ2h0Lm5vcnRoKSA8PSBhYnNvbHV0ZUVwc2lsb24pXG4gICk7XG59O1xuXG4vKipcbiAqIER1cGxpY2F0ZXMgdGhpcyBSZWN0YW5nbGUuXG4gKlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IFtyZXN1bHRdIFRoZSBvYmplY3Qgb250byB3aGljaCB0byBzdG9yZSB0aGUgcmVzdWx0LlxuICogQHJldHVybnMge1JlY3RhbmdsZX0gVGhlIG1vZGlmaWVkIHJlc3VsdCBwYXJhbWV0ZXIgb3IgYSBuZXcgUmVjdGFuZ2xlIGluc3RhbmNlIGlmIG5vbmUgd2FzIHByb3ZpZGVkLlxuICovXG5SZWN0YW5nbGUucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuICByZXR1cm4gUmVjdGFuZ2xlLmNsb25lKHRoaXMsIHJlc3VsdCk7XG59O1xuXG4vKipcbiAqIENvbXBhcmVzIHRoZSBwcm92aWRlZCBSZWN0YW5nbGUgd2l0aCB0aGlzIFJlY3RhbmdsZSBjb21wb25lbnR3aXNlIGFuZCByZXR1cm5zXG4gKiA8Y29kZT50cnVlPC9jb2RlPiBpZiB0aGV5IGFyZSBlcXVhbCwgPGNvZGU+ZmFsc2U8L2NvZGU+IG90aGVyd2lzZS5cbiAqXG4gKiBAcGFyYW0ge1JlY3RhbmdsZX0gW290aGVyXSBUaGUgUmVjdGFuZ2xlIHRvIGNvbXBhcmUuXG4gKiBAcmV0dXJucyB7Qm9vbGVhbn0gPGNvZGU+dHJ1ZTwvY29kZT4gaWYgdGhlIFJlY3RhbmdsZXMgYXJlIGVxdWFsLCA8Y29kZT5mYWxzZTwvY29kZT4gb3RoZXJ3aXNlLlxuICovXG5SZWN0YW5nbGUucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvdGhlcikge1xuICByZXR1cm4gUmVjdGFuZ2xlLmVxdWFscyh0aGlzLCBvdGhlcik7XG59O1xuXG4vKipcbiAqIENvbXBhcmVzIHRoZSBwcm92aWRlZCByZWN0YW5nbGVzIGFuZCByZXR1cm5zIDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoZXkgYXJlIGVxdWFsLFxuICogPGNvZGU+ZmFsc2U8L2NvZGU+IG90aGVyd2lzZS5cbiAqXG4gKiBAcGFyYW0ge1JlY3RhbmdsZX0gW2xlZnRdIFRoZSBmaXJzdCBSZWN0YW5nbGUuXG4gKiBAcGFyYW0ge1JlY3RhbmdsZX0gW3JpZ2h0XSBUaGUgc2Vjb25kIFJlY3RhbmdsZS5cbiAqIEByZXR1cm5zIHtCb29sZWFufSA8Y29kZT50cnVlPC9jb2RlPiBpZiBsZWZ0IGFuZCByaWdodCBhcmUgZXF1YWw7IG90aGVyd2lzZSA8Y29kZT5mYWxzZTwvY29kZT4uXG4gKi9cblJlY3RhbmdsZS5lcXVhbHMgPSBmdW5jdGlvbiAobGVmdCwgcmlnaHQpIHtcbiAgcmV0dXJuIChcbiAgICBsZWZ0ID09PSByaWdodCB8fFxuICAgIChkZWZpbmVkKGxlZnQpICYmXG4gICAgICBkZWZpbmVkKHJpZ2h0KSAmJlxuICAgICAgbGVmdC53ZXN0ID09PSByaWdodC53ZXN0ICYmXG4gICAgICBsZWZ0LnNvdXRoID09PSByaWdodC5zb3V0aCAmJlxuICAgICAgbGVmdC5lYXN0ID09PSByaWdodC5lYXN0ICYmXG4gICAgICBsZWZ0Lm5vcnRoID09PSByaWdodC5ub3J0aClcbiAgKTtcbn07XG5cbi8qKlxuICogQ29tcGFyZXMgdGhlIHByb3ZpZGVkIFJlY3RhbmdsZSB3aXRoIHRoaXMgUmVjdGFuZ2xlIGNvbXBvbmVudHdpc2UgYW5kIHJldHVybnNcbiAqIDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoZXkgYXJlIHdpdGhpbiB0aGUgcHJvdmlkZWQgZXBzaWxvbixcbiAqIDxjb2RlPmZhbHNlPC9jb2RlPiBvdGhlcndpc2UuXG4gKlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IFtvdGhlcl0gVGhlIFJlY3RhbmdsZSB0byBjb21wYXJlLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtlcHNpbG9uPTBdIFRoZSBlcHNpbG9uIHRvIHVzZSBmb3IgZXF1YWxpdHkgdGVzdGluZy5cbiAqIEByZXR1cm5zIHtCb29sZWFufSA8Y29kZT50cnVlPC9jb2RlPiBpZiB0aGUgUmVjdGFuZ2xlcyBhcmUgd2l0aGluIHRoZSBwcm92aWRlZCBlcHNpbG9uLCA8Y29kZT5mYWxzZTwvY29kZT4gb3RoZXJ3aXNlLlxuICovXG5SZWN0YW5nbGUucHJvdG90eXBlLmVxdWFsc0Vwc2lsb24gPSBmdW5jdGlvbiAob3RoZXIsIGVwc2lsb24pIHtcbiAgcmV0dXJuIFJlY3RhbmdsZS5lcXVhbHNFcHNpbG9uKHRoaXMsIG90aGVyLCBlcHNpbG9uKTtcbn07XG5cbi8qKlxuICogQ2hlY2tzIGEgUmVjdGFuZ2xlJ3MgcHJvcGVydGllcyBhbmQgdGhyb3dzIGlmIHRoZXkgYXJlIG5vdCBpbiB2YWxpZCByYW5nZXMuXG4gKlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IHJlY3RhbmdsZSBUaGUgcmVjdGFuZ2xlIHRvIHZhbGlkYXRlXG4gKlxuICogQGV4Y2VwdGlvbiB7RGV2ZWxvcGVyRXJyb3J9IDxjb2RlPm5vcnRoPC9jb2RlPiBtdXN0IGJlIGluIHRoZSBpbnRlcnZhbCBbPGNvZGU+LVBpLzI8L2NvZGU+LCA8Y29kZT5QaS8yPC9jb2RlPl0uXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gPGNvZGU+c291dGg8L2NvZGU+IG11c3QgYmUgaW4gdGhlIGludGVydmFsIFs8Y29kZT4tUGkvMjwvY29kZT4sIDxjb2RlPlBpLzI8L2NvZGU+XS5cbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSA8Y29kZT5lYXN0PC9jb2RlPiBtdXN0IGJlIGluIHRoZSBpbnRlcnZhbCBbPGNvZGU+LVBpPC9jb2RlPiwgPGNvZGU+UGk8L2NvZGU+XS5cbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSA8Y29kZT53ZXN0PC9jb2RlPiBtdXN0IGJlIGluIHRoZSBpbnRlcnZhbCBbPGNvZGU+LVBpPC9jb2RlPiwgPGNvZGU+UGk8L2NvZGU+XS5cbiAqL1xuUmVjdGFuZ2xlLnZhbGlkYXRlID0gZnVuY3Rpb24gKHJlY3RhbmdsZSkge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwicmVjdGFuZ2xlXCIsIHJlY3RhbmdsZSk7XG5cbiAgdmFyIG5vcnRoID0gcmVjdGFuZ2xlLm5vcnRoO1xuICBDaGVjay50eXBlT2YubnVtYmVyLmdyZWF0ZXJUaGFuT3JFcXVhbHMoXG4gICAgXCJub3J0aFwiLFxuICAgIG5vcnRoLFxuICAgIC1DZXNpdW1NYXRoLlBJX09WRVJfVFdPXG4gICk7XG4gIENoZWNrLnR5cGVPZi5udW1iZXIubGVzc1RoYW5PckVxdWFscyhcIm5vcnRoXCIsIG5vcnRoLCBDZXNpdW1NYXRoLlBJX09WRVJfVFdPKTtcblxuICB2YXIgc291dGggPSByZWN0YW5nbGUuc291dGg7XG4gIENoZWNrLnR5cGVPZi5udW1iZXIuZ3JlYXRlclRoYW5PckVxdWFscyhcbiAgICBcInNvdXRoXCIsXG4gICAgc291dGgsXG4gICAgLUNlc2l1bU1hdGguUElfT1ZFUl9UV09cbiAgKTtcbiAgQ2hlY2sudHlwZU9mLm51bWJlci5sZXNzVGhhbk9yRXF1YWxzKFwic291dGhcIiwgc291dGgsIENlc2l1bU1hdGguUElfT1ZFUl9UV08pO1xuXG4gIHZhciB3ZXN0ID0gcmVjdGFuZ2xlLndlc3Q7XG4gIENoZWNrLnR5cGVPZi5udW1iZXIuZ3JlYXRlclRoYW5PckVxdWFscyhcIndlc3RcIiwgd2VzdCwgLU1hdGguUEkpO1xuICBDaGVjay50eXBlT2YubnVtYmVyLmxlc3NUaGFuT3JFcXVhbHMoXCJ3ZXN0XCIsIHdlc3QsIE1hdGguUEkpO1xuXG4gIHZhciBlYXN0ID0gcmVjdGFuZ2xlLmVhc3Q7XG4gIENoZWNrLnR5cGVPZi5udW1iZXIuZ3JlYXRlclRoYW5PckVxdWFscyhcImVhc3RcIiwgZWFzdCwgLU1hdGguUEkpO1xuICBDaGVjay50eXBlT2YubnVtYmVyLmxlc3NUaGFuT3JFcXVhbHMoXCJlYXN0XCIsIGVhc3QsIE1hdGguUEkpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcbn07XG5cbi8qKlxuICogQ29tcHV0ZXMgdGhlIHNvdXRod2VzdCBjb3JuZXIgb2YgYSByZWN0YW5nbGUuXG4gKlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IHJlY3RhbmdsZSBUaGUgcmVjdGFuZ2xlIGZvciB3aGljaCB0byBmaW5kIHRoZSBjb3JuZXJcbiAqIEBwYXJhbSB7Q2FydG9ncmFwaGljfSBbcmVzdWx0XSBUaGUgb2JqZWN0IG9udG8gd2hpY2ggdG8gc3RvcmUgdGhlIHJlc3VsdC5cbiAqIEByZXR1cm5zIHtDYXJ0b2dyYXBoaWN9IFRoZSBtb2RpZmllZCByZXN1bHQgcGFyYW1ldGVyIG9yIGEgbmV3IENhcnRvZ3JhcGhpYyBpbnN0YW5jZSBpZiBub25lIHdhcyBwcm92aWRlZC5cbiAqL1xuUmVjdGFuZ2xlLnNvdXRod2VzdCA9IGZ1bmN0aW9uIChyZWN0YW5nbGUsIHJlc3VsdCkge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwicmVjdGFuZ2xlXCIsIHJlY3RhbmdsZSk7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIGlmICghZGVmaW5lZChyZXN1bHQpKSB7XG4gICAgcmV0dXJuIG5ldyBDYXJ0b2dyYXBoaWMocmVjdGFuZ2xlLndlc3QsIHJlY3RhbmdsZS5zb3V0aCk7XG4gIH1cbiAgcmVzdWx0LmxvbmdpdHVkZSA9IHJlY3RhbmdsZS53ZXN0O1xuICByZXN1bHQubGF0aXR1ZGUgPSByZWN0YW5nbGUuc291dGg7XG4gIHJlc3VsdC5oZWlnaHQgPSAwLjA7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG4vKipcbiAqIENvbXB1dGVzIHRoZSBub3J0aHdlc3QgY29ybmVyIG9mIGEgcmVjdGFuZ2xlLlxuICpcbiAqIEBwYXJhbSB7UmVjdGFuZ2xlfSByZWN0YW5nbGUgVGhlIHJlY3RhbmdsZSBmb3Igd2hpY2ggdG8gZmluZCB0aGUgY29ybmVyXG4gKiBAcGFyYW0ge0NhcnRvZ3JhcGhpY30gW3Jlc3VsdF0gVGhlIG9iamVjdCBvbnRvIHdoaWNoIHRvIHN0b3JlIHRoZSByZXN1bHQuXG4gKiBAcmV0dXJucyB7Q2FydG9ncmFwaGljfSBUaGUgbW9kaWZpZWQgcmVzdWx0IHBhcmFtZXRlciBvciBhIG5ldyBDYXJ0b2dyYXBoaWMgaW5zdGFuY2UgaWYgbm9uZSB3YXMgcHJvdmlkZWQuXG4gKi9cblJlY3RhbmdsZS5ub3J0aHdlc3QgPSBmdW5jdGlvbiAocmVjdGFuZ2xlLCByZXN1bHQpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcInJlY3RhbmdsZVwiLCByZWN0YW5nbGUpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICBpZiAoIWRlZmluZWQocmVzdWx0KSkge1xuICAgIHJldHVybiBuZXcgQ2FydG9ncmFwaGljKHJlY3RhbmdsZS53ZXN0LCByZWN0YW5nbGUubm9ydGgpO1xuICB9XG4gIHJlc3VsdC5sb25naXR1ZGUgPSByZWN0YW5nbGUud2VzdDtcbiAgcmVzdWx0LmxhdGl0dWRlID0gcmVjdGFuZ2xlLm5vcnRoO1xuICByZXN1bHQuaGVpZ2h0ID0gMC4wO1xuICByZXR1cm4gcmVzdWx0O1xufTtcblxuLyoqXG4gKiBDb21wdXRlcyB0aGUgbm9ydGhlYXN0IGNvcm5lciBvZiBhIHJlY3RhbmdsZS5cbiAqXG4gKiBAcGFyYW0ge1JlY3RhbmdsZX0gcmVjdGFuZ2xlIFRoZSByZWN0YW5nbGUgZm9yIHdoaWNoIHRvIGZpbmQgdGhlIGNvcm5lclxuICogQHBhcmFtIHtDYXJ0b2dyYXBoaWN9IFtyZXN1bHRdIFRoZSBvYmplY3Qgb250byB3aGljaCB0byBzdG9yZSB0aGUgcmVzdWx0LlxuICogQHJldHVybnMge0NhcnRvZ3JhcGhpY30gVGhlIG1vZGlmaWVkIHJlc3VsdCBwYXJhbWV0ZXIgb3IgYSBuZXcgQ2FydG9ncmFwaGljIGluc3RhbmNlIGlmIG5vbmUgd2FzIHByb3ZpZGVkLlxuICovXG5SZWN0YW5nbGUubm9ydGhlYXN0ID0gZnVuY3Rpb24gKHJlY3RhbmdsZSwgcmVzdWx0KSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJyZWN0YW5nbGVcIiwgcmVjdGFuZ2xlKTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgaWYgKCFkZWZpbmVkKHJlc3VsdCkpIHtcbiAgICByZXR1cm4gbmV3IENhcnRvZ3JhcGhpYyhyZWN0YW5nbGUuZWFzdCwgcmVjdGFuZ2xlLm5vcnRoKTtcbiAgfVxuICByZXN1bHQubG9uZ2l0dWRlID0gcmVjdGFuZ2xlLmVhc3Q7XG4gIHJlc3VsdC5sYXRpdHVkZSA9IHJlY3RhbmdsZS5ub3J0aDtcbiAgcmVzdWx0LmhlaWdodCA9IDAuMDtcbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8qKlxuICogQ29tcHV0ZXMgdGhlIHNvdXRoZWFzdCBjb3JuZXIgb2YgYSByZWN0YW5nbGUuXG4gKlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IHJlY3RhbmdsZSBUaGUgcmVjdGFuZ2xlIGZvciB3aGljaCB0byBmaW5kIHRoZSBjb3JuZXJcbiAqIEBwYXJhbSB7Q2FydG9ncmFwaGljfSBbcmVzdWx0XSBUaGUgb2JqZWN0IG9udG8gd2hpY2ggdG8gc3RvcmUgdGhlIHJlc3VsdC5cbiAqIEByZXR1cm5zIHtDYXJ0b2dyYXBoaWN9IFRoZSBtb2RpZmllZCByZXN1bHQgcGFyYW1ldGVyIG9yIGEgbmV3IENhcnRvZ3JhcGhpYyBpbnN0YW5jZSBpZiBub25lIHdhcyBwcm92aWRlZC5cbiAqL1xuUmVjdGFuZ2xlLnNvdXRoZWFzdCA9IGZ1bmN0aW9uIChyZWN0YW5nbGUsIHJlc3VsdCkge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwicmVjdGFuZ2xlXCIsIHJlY3RhbmdsZSk7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIGlmICghZGVmaW5lZChyZXN1bHQpKSB7XG4gICAgcmV0dXJuIG5ldyBDYXJ0b2dyYXBoaWMocmVjdGFuZ2xlLmVhc3QsIHJlY3RhbmdsZS5zb3V0aCk7XG4gIH1cbiAgcmVzdWx0LmxvbmdpdHVkZSA9IHJlY3RhbmdsZS5lYXN0O1xuICByZXN1bHQubGF0aXR1ZGUgPSByZWN0YW5nbGUuc291dGg7XG4gIHJlc3VsdC5oZWlnaHQgPSAwLjA7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG4vKipcbiAqIENvbXB1dGVzIHRoZSBjZW50ZXIgb2YgYSByZWN0YW5nbGUuXG4gKlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IHJlY3RhbmdsZSBUaGUgcmVjdGFuZ2xlIGZvciB3aGljaCB0byBmaW5kIHRoZSBjZW50ZXJcbiAqIEBwYXJhbSB7Q2FydG9ncmFwaGljfSBbcmVzdWx0XSBUaGUgb2JqZWN0IG9udG8gd2hpY2ggdG8gc3RvcmUgdGhlIHJlc3VsdC5cbiAqIEByZXR1cm5zIHtDYXJ0b2dyYXBoaWN9IFRoZSBtb2RpZmllZCByZXN1bHQgcGFyYW1ldGVyIG9yIGEgbmV3IENhcnRvZ3JhcGhpYyBpbnN0YW5jZSBpZiBub25lIHdhcyBwcm92aWRlZC5cbiAqL1xuUmVjdGFuZ2xlLmNlbnRlciA9IGZ1bmN0aW9uIChyZWN0YW5nbGUsIHJlc3VsdCkge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwicmVjdGFuZ2xlXCIsIHJlY3RhbmdsZSk7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIHZhciBlYXN0ID0gcmVjdGFuZ2xlLmVhc3Q7XG4gIHZhciB3ZXN0ID0gcmVjdGFuZ2xlLndlc3Q7XG5cbiAgaWYgKGVhc3QgPCB3ZXN0KSB7XG4gICAgZWFzdCArPSBDZXNpdW1NYXRoLlRXT19QSTtcbiAgfVxuXG4gIHZhciBsb25naXR1ZGUgPSBDZXNpdW1NYXRoLm5lZ2F0aXZlUGlUb1BpKCh3ZXN0ICsgZWFzdCkgKiAwLjUpO1xuICB2YXIgbGF0aXR1ZGUgPSAocmVjdGFuZ2xlLnNvdXRoICsgcmVjdGFuZ2xlLm5vcnRoKSAqIDAuNTtcblxuICBpZiAoIWRlZmluZWQocmVzdWx0KSkge1xuICAgIHJldHVybiBuZXcgQ2FydG9ncmFwaGljKGxvbmdpdHVkZSwgbGF0aXR1ZGUpO1xuICB9XG5cbiAgcmVzdWx0LmxvbmdpdHVkZSA9IGxvbmdpdHVkZTtcbiAgcmVzdWx0LmxhdGl0dWRlID0gbGF0aXR1ZGU7XG4gIHJlc3VsdC5oZWlnaHQgPSAwLjA7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG4vKipcbiAqIENvbXB1dGVzIHRoZSBpbnRlcnNlY3Rpb24gb2YgdHdvIHJlY3RhbmdsZXMuICBUaGlzIGZ1bmN0aW9uIGFzc3VtZXMgdGhhdCB0aGUgcmVjdGFuZ2xlJ3MgY29vcmRpbmF0ZXMgYXJlXG4gKiBsYXRpdHVkZSBhbmQgbG9uZ2l0dWRlIGluIHJhZGlhbnMgYW5kIHByb2R1Y2VzIGEgY29ycmVjdCBpbnRlcnNlY3Rpb24sIHRha2luZyBpbnRvIGFjY291bnQgdGhlIGZhY3QgdGhhdFxuICogdGhlIHNhbWUgYW5nbGUgY2FuIGJlIHJlcHJlc2VudGVkIHdpdGggbXVsdGlwbGUgdmFsdWVzIGFzIHdlbGwgYXMgdGhlIHdyYXBwaW5nIG9mIGxvbmdpdHVkZSBhdCB0aGVcbiAqIGFudGktbWVyaWRpYW4uICBGb3IgYSBzaW1wbGUgaW50ZXJzZWN0aW9uIHRoYXQgaWdub3JlcyB0aGVzZSBmYWN0b3JzIGFuZCBjYW4gYmUgdXNlZCB3aXRoIHByb2plY3RlZFxuICogY29vcmRpbmF0ZXMsIHNlZSB7QGxpbmsgUmVjdGFuZ2xlLnNpbXBsZUludGVyc2VjdGlvbn0uXG4gKlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IHJlY3RhbmdsZSBPbiByZWN0YW5nbGUgdG8gZmluZCBhbiBpbnRlcnNlY3Rpb25cbiAqIEBwYXJhbSB7UmVjdGFuZ2xlfSBvdGhlclJlY3RhbmdsZSBBbm90aGVyIHJlY3RhbmdsZSB0byBmaW5kIGFuIGludGVyc2VjdGlvblxuICogQHBhcmFtIHtSZWN0YW5nbGV9IFtyZXN1bHRdIFRoZSBvYmplY3Qgb250byB3aGljaCB0byBzdG9yZSB0aGUgcmVzdWx0LlxuICogQHJldHVybnMge1JlY3RhbmdsZXx1bmRlZmluZWR9IFRoZSBtb2RpZmllZCByZXN1bHQgcGFyYW1ldGVyLCBhIG5ldyBSZWN0YW5nbGUgaW5zdGFuY2UgaWYgbm9uZSB3YXMgcHJvdmlkZWQgb3IgdW5kZWZpbmVkIGlmIHRoZXJlIGlzIG5vIGludGVyc2VjdGlvbi5cbiAqL1xuUmVjdGFuZ2xlLmludGVyc2VjdGlvbiA9IGZ1bmN0aW9uIChyZWN0YW5nbGUsIG90aGVyUmVjdGFuZ2xlLCByZXN1bHQpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcInJlY3RhbmdsZVwiLCByZWN0YW5nbGUpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwib3RoZXJSZWN0YW5nbGVcIiwgb3RoZXJSZWN0YW5nbGUpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB2YXIgcmVjdGFuZ2xlRWFzdCA9IHJlY3RhbmdsZS5lYXN0O1xuICB2YXIgcmVjdGFuZ2xlV2VzdCA9IHJlY3RhbmdsZS53ZXN0O1xuXG4gIHZhciBvdGhlclJlY3RhbmdsZUVhc3QgPSBvdGhlclJlY3RhbmdsZS5lYXN0O1xuICB2YXIgb3RoZXJSZWN0YW5nbGVXZXN0ID0gb3RoZXJSZWN0YW5nbGUud2VzdDtcblxuICBpZiAocmVjdGFuZ2xlRWFzdCA8IHJlY3RhbmdsZVdlc3QgJiYgb3RoZXJSZWN0YW5nbGVFYXN0ID4gMC4wKSB7XG4gICAgcmVjdGFuZ2xlRWFzdCArPSBDZXNpdW1NYXRoLlRXT19QSTtcbiAgfSBlbHNlIGlmIChvdGhlclJlY3RhbmdsZUVhc3QgPCBvdGhlclJlY3RhbmdsZVdlc3QgJiYgcmVjdGFuZ2xlRWFzdCA+IDAuMCkge1xuICAgIG90aGVyUmVjdGFuZ2xlRWFzdCArPSBDZXNpdW1NYXRoLlRXT19QSTtcbiAgfVxuXG4gIGlmIChyZWN0YW5nbGVFYXN0IDwgcmVjdGFuZ2xlV2VzdCAmJiBvdGhlclJlY3RhbmdsZVdlc3QgPCAwLjApIHtcbiAgICBvdGhlclJlY3RhbmdsZVdlc3QgKz0gQ2VzaXVtTWF0aC5UV09fUEk7XG4gIH0gZWxzZSBpZiAob3RoZXJSZWN0YW5nbGVFYXN0IDwgb3RoZXJSZWN0YW5nbGVXZXN0ICYmIHJlY3RhbmdsZVdlc3QgPCAwLjApIHtcbiAgICByZWN0YW5nbGVXZXN0ICs9IENlc2l1bU1hdGguVFdPX1BJO1xuICB9XG5cbiAgdmFyIHdlc3QgPSBDZXNpdW1NYXRoLm5lZ2F0aXZlUGlUb1BpKFxuICAgIE1hdGgubWF4KHJlY3RhbmdsZVdlc3QsIG90aGVyUmVjdGFuZ2xlV2VzdClcbiAgKTtcbiAgdmFyIGVhc3QgPSBDZXNpdW1NYXRoLm5lZ2F0aXZlUGlUb1BpKFxuICAgIE1hdGgubWluKHJlY3RhbmdsZUVhc3QsIG90aGVyUmVjdGFuZ2xlRWFzdClcbiAgKTtcblxuICBpZiAoXG4gICAgKHJlY3RhbmdsZS53ZXN0IDwgcmVjdGFuZ2xlLmVhc3QgfHxcbiAgICAgIG90aGVyUmVjdGFuZ2xlLndlc3QgPCBvdGhlclJlY3RhbmdsZS5lYXN0KSAmJlxuICAgIGVhc3QgPD0gd2VzdFxuICApIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgdmFyIHNvdXRoID0gTWF0aC5tYXgocmVjdGFuZ2xlLnNvdXRoLCBvdGhlclJlY3RhbmdsZS5zb3V0aCk7XG4gIHZhciBub3J0aCA9IE1hdGgubWluKHJlY3RhbmdsZS5ub3J0aCwgb3RoZXJSZWN0YW5nbGUubm9ydGgpO1xuXG4gIGlmIChzb3V0aCA+PSBub3J0aCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICBpZiAoIWRlZmluZWQocmVzdWx0KSkge1xuICAgIHJldHVybiBuZXcgUmVjdGFuZ2xlKHdlc3QsIHNvdXRoLCBlYXN0LCBub3J0aCk7XG4gIH1cbiAgcmVzdWx0Lndlc3QgPSB3ZXN0O1xuICByZXN1bHQuc291dGggPSBzb3V0aDtcbiAgcmVzdWx0LmVhc3QgPSBlYXN0O1xuICByZXN1bHQubm9ydGggPSBub3J0aDtcbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8qKlxuICogQ29tcHV0ZXMgYSBzaW1wbGUgaW50ZXJzZWN0aW9uIG9mIHR3byByZWN0YW5nbGVzLiAgVW5saWtlIHtAbGluayBSZWN0YW5nbGUuaW50ZXJzZWN0aW9ufSwgdGhpcyBmdW5jdGlvblxuICogZG9lcyBub3QgYXR0ZW1wdCB0byBwdXQgdGhlIGFuZ3VsYXIgY29vcmRpbmF0ZXMgaW50byBhIGNvbnNpc3RlbnQgcmFuZ2Ugb3IgdG8gYWNjb3VudCBmb3IgY3Jvc3NpbmcgdGhlXG4gKiBhbnRpLW1lcmlkaWFuLiAgQXMgc3VjaCwgaXQgY2FuIGJlIHVzZWQgZm9yIHJlY3RhbmdsZXMgd2hlcmUgdGhlIGNvb3JkaW5hdGVzIGFyZSBub3Qgc2ltcGx5IGxhdGl0dWRlXG4gKiBhbmQgbG9uZ2l0dWRlIChpLmUuIHByb2plY3RlZCBjb29yZGluYXRlcykuXG4gKlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IHJlY3RhbmdsZSBPbiByZWN0YW5nbGUgdG8gZmluZCBhbiBpbnRlcnNlY3Rpb25cbiAqIEBwYXJhbSB7UmVjdGFuZ2xlfSBvdGhlclJlY3RhbmdsZSBBbm90aGVyIHJlY3RhbmdsZSB0byBmaW5kIGFuIGludGVyc2VjdGlvblxuICogQHBhcmFtIHtSZWN0YW5nbGV9IFtyZXN1bHRdIFRoZSBvYmplY3Qgb250byB3aGljaCB0byBzdG9yZSB0aGUgcmVzdWx0LlxuICogQHJldHVybnMge1JlY3RhbmdsZXx1bmRlZmluZWR9IFRoZSBtb2RpZmllZCByZXN1bHQgcGFyYW1ldGVyLCBhIG5ldyBSZWN0YW5nbGUgaW5zdGFuY2UgaWYgbm9uZSB3YXMgcHJvdmlkZWQgb3IgdW5kZWZpbmVkIGlmIHRoZXJlIGlzIG5vIGludGVyc2VjdGlvbi5cbiAqL1xuUmVjdGFuZ2xlLnNpbXBsZUludGVyc2VjdGlvbiA9IGZ1bmN0aW9uIChyZWN0YW5nbGUsIG90aGVyUmVjdGFuZ2xlLCByZXN1bHQpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcInJlY3RhbmdsZVwiLCByZWN0YW5nbGUpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwib3RoZXJSZWN0YW5nbGVcIiwgb3RoZXJSZWN0YW5nbGUpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB2YXIgd2VzdCA9IE1hdGgubWF4KHJlY3RhbmdsZS53ZXN0LCBvdGhlclJlY3RhbmdsZS53ZXN0KTtcbiAgdmFyIHNvdXRoID0gTWF0aC5tYXgocmVjdGFuZ2xlLnNvdXRoLCBvdGhlclJlY3RhbmdsZS5zb3V0aCk7XG4gIHZhciBlYXN0ID0gTWF0aC5taW4ocmVjdGFuZ2xlLmVhc3QsIG90aGVyUmVjdGFuZ2xlLmVhc3QpO1xuICB2YXIgbm9ydGggPSBNYXRoLm1pbihyZWN0YW5nbGUubm9ydGgsIG90aGVyUmVjdGFuZ2xlLm5vcnRoKTtcblxuICBpZiAoc291dGggPj0gbm9ydGggfHwgd2VzdCA+PSBlYXN0KSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIGlmICghZGVmaW5lZChyZXN1bHQpKSB7XG4gICAgcmV0dXJuIG5ldyBSZWN0YW5nbGUod2VzdCwgc291dGgsIGVhc3QsIG5vcnRoKTtcbiAgfVxuXG4gIHJlc3VsdC53ZXN0ID0gd2VzdDtcbiAgcmVzdWx0LnNvdXRoID0gc291dGg7XG4gIHJlc3VsdC5lYXN0ID0gZWFzdDtcbiAgcmVzdWx0Lm5vcnRoID0gbm9ydGg7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG4vKipcbiAqIENvbXB1dGVzIGEgcmVjdGFuZ2xlIHRoYXQgaXMgdGhlIHVuaW9uIG9mIHR3byByZWN0YW5nbGVzLlxuICpcbiAqIEBwYXJhbSB7UmVjdGFuZ2xlfSByZWN0YW5nbGUgQSByZWN0YW5nbGUgdG8gZW5jbG9zZSBpbiByZWN0YW5nbGUuXG4gKiBAcGFyYW0ge1JlY3RhbmdsZX0gb3RoZXJSZWN0YW5nbGUgQSByZWN0YW5nbGUgdG8gZW5jbG9zZSBpbiBhIHJlY3RhbmdsZS5cbiAqIEBwYXJhbSB7UmVjdGFuZ2xlfSBbcmVzdWx0XSBUaGUgb2JqZWN0IG9udG8gd2hpY2ggdG8gc3RvcmUgdGhlIHJlc3VsdC5cbiAqIEByZXR1cm5zIHtSZWN0YW5nbGV9IFRoZSBtb2RpZmllZCByZXN1bHQgcGFyYW1ldGVyIG9yIGEgbmV3IFJlY3RhbmdsZSBpbnN0YW5jZSBpZiBub25lIHdhcyBwcm92aWRlZC5cbiAqL1xuUmVjdGFuZ2xlLnVuaW9uID0gZnVuY3Rpb24gKHJlY3RhbmdsZSwgb3RoZXJSZWN0YW5nbGUsIHJlc3VsdCkge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwicmVjdGFuZ2xlXCIsIHJlY3RhbmdsZSk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJvdGhlclJlY3RhbmdsZVwiLCBvdGhlclJlY3RhbmdsZSk7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIGlmICghZGVmaW5lZChyZXN1bHQpKSB7XG4gICAgcmVzdWx0ID0gbmV3IFJlY3RhbmdsZSgpO1xuICB9XG5cbiAgdmFyIHJlY3RhbmdsZUVhc3QgPSByZWN0YW5nbGUuZWFzdDtcbiAgdmFyIHJlY3RhbmdsZVdlc3QgPSByZWN0YW5nbGUud2VzdDtcblxuICB2YXIgb3RoZXJSZWN0YW5nbGVFYXN0ID0gb3RoZXJSZWN0YW5nbGUuZWFzdDtcbiAgdmFyIG90aGVyUmVjdGFuZ2xlV2VzdCA9IG90aGVyUmVjdGFuZ2xlLndlc3Q7XG5cbiAgaWYgKHJlY3RhbmdsZUVhc3QgPCByZWN0YW5nbGVXZXN0ICYmIG90aGVyUmVjdGFuZ2xlRWFzdCA+IDAuMCkge1xuICAgIHJlY3RhbmdsZUVhc3QgKz0gQ2VzaXVtTWF0aC5UV09fUEk7XG4gIH0gZWxzZSBpZiAob3RoZXJSZWN0YW5nbGVFYXN0IDwgb3RoZXJSZWN0YW5nbGVXZXN0ICYmIHJlY3RhbmdsZUVhc3QgPiAwLjApIHtcbiAgICBvdGhlclJlY3RhbmdsZUVhc3QgKz0gQ2VzaXVtTWF0aC5UV09fUEk7XG4gIH1cblxuICBpZiAocmVjdGFuZ2xlRWFzdCA8IHJlY3RhbmdsZVdlc3QgJiYgb3RoZXJSZWN0YW5nbGVXZXN0IDwgMC4wKSB7XG4gICAgb3RoZXJSZWN0YW5nbGVXZXN0ICs9IENlc2l1bU1hdGguVFdPX1BJO1xuICB9IGVsc2UgaWYgKG90aGVyUmVjdGFuZ2xlRWFzdCA8IG90aGVyUmVjdGFuZ2xlV2VzdCAmJiByZWN0YW5nbGVXZXN0IDwgMC4wKSB7XG4gICAgcmVjdGFuZ2xlV2VzdCArPSBDZXNpdW1NYXRoLlRXT19QSTtcbiAgfVxuXG4gIHZhciB3ZXN0ID0gQ2VzaXVtTWF0aC5jb252ZXJ0TG9uZ2l0dWRlUmFuZ2UoXG4gICAgTWF0aC5taW4ocmVjdGFuZ2xlV2VzdCwgb3RoZXJSZWN0YW5nbGVXZXN0KVxuICApO1xuICB2YXIgZWFzdCA9IENlc2l1bU1hdGguY29udmVydExvbmdpdHVkZVJhbmdlKFxuICAgIE1hdGgubWF4KHJlY3RhbmdsZUVhc3QsIG90aGVyUmVjdGFuZ2xlRWFzdClcbiAgKTtcblxuICByZXN1bHQud2VzdCA9IHdlc3Q7XG4gIHJlc3VsdC5zb3V0aCA9IE1hdGgubWluKHJlY3RhbmdsZS5zb3V0aCwgb3RoZXJSZWN0YW5nbGUuc291dGgpO1xuICByZXN1bHQuZWFzdCA9IGVhc3Q7XG4gIHJlc3VsdC5ub3J0aCA9IE1hdGgubWF4KHJlY3RhbmdsZS5ub3J0aCwgb3RoZXJSZWN0YW5nbGUubm9ydGgpO1xuXG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG4vKipcbiAqIENvbXB1dGVzIGEgcmVjdGFuZ2xlIGJ5IGVubGFyZ2luZyB0aGUgcHJvdmlkZWQgcmVjdGFuZ2xlIHVudGlsIGl0IGNvbnRhaW5zIHRoZSBwcm92aWRlZCBjYXJ0b2dyYXBoaWMuXG4gKlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IHJlY3RhbmdsZSBBIHJlY3RhbmdsZSB0byBleHBhbmQuXG4gKiBAcGFyYW0ge0NhcnRvZ3JhcGhpY30gY2FydG9ncmFwaGljIEEgY2FydG9ncmFwaGljIHRvIGVuY2xvc2UgaW4gYSByZWN0YW5nbGUuXG4gKiBAcGFyYW0ge1JlY3RhbmdsZX0gW3Jlc3VsdF0gVGhlIG9iamVjdCBvbnRvIHdoaWNoIHRvIHN0b3JlIHRoZSByZXN1bHQuXG4gKiBAcmV0dXJucyB7UmVjdGFuZ2xlfSBUaGUgbW9kaWZpZWQgcmVzdWx0IHBhcmFtZXRlciBvciBhIG5ldyBSZWN0YW5nbGUgaW5zdGFuY2UgaWYgb25lIHdhcyBub3QgcHJvdmlkZWQuXG4gKi9cblJlY3RhbmdsZS5leHBhbmQgPSBmdW5jdGlvbiAocmVjdGFuZ2xlLCBjYXJ0b2dyYXBoaWMsIHJlc3VsdCkge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwicmVjdGFuZ2xlXCIsIHJlY3RhbmdsZSk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJjYXJ0b2dyYXBoaWNcIiwgY2FydG9ncmFwaGljKTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgaWYgKCFkZWZpbmVkKHJlc3VsdCkpIHtcbiAgICByZXN1bHQgPSBuZXcgUmVjdGFuZ2xlKCk7XG4gIH1cblxuICByZXN1bHQud2VzdCA9IE1hdGgubWluKHJlY3RhbmdsZS53ZXN0LCBjYXJ0b2dyYXBoaWMubG9uZ2l0dWRlKTtcbiAgcmVzdWx0LnNvdXRoID0gTWF0aC5taW4ocmVjdGFuZ2xlLnNvdXRoLCBjYXJ0b2dyYXBoaWMubGF0aXR1ZGUpO1xuICByZXN1bHQuZWFzdCA9IE1hdGgubWF4KHJlY3RhbmdsZS5lYXN0LCBjYXJ0b2dyYXBoaWMubG9uZ2l0dWRlKTtcbiAgcmVzdWx0Lm5vcnRoID0gTWF0aC5tYXgocmVjdGFuZ2xlLm5vcnRoLCBjYXJ0b2dyYXBoaWMubGF0aXR1ZGUpO1xuXG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgY2FydG9ncmFwaGljIGlzIG9uIG9yIGluc2lkZSB0aGUgcmVjdGFuZ2xlLCBmYWxzZSBvdGhlcndpc2UuXG4gKlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IHJlY3RhbmdsZSBUaGUgcmVjdGFuZ2xlXG4gKiBAcGFyYW0ge0NhcnRvZ3JhcGhpY30gY2FydG9ncmFwaGljIFRoZSBjYXJ0b2dyYXBoaWMgdG8gdGVzdC5cbiAqIEByZXR1cm5zIHtCb29sZWFufSB0cnVlIGlmIHRoZSBwcm92aWRlZCBjYXJ0b2dyYXBoaWMgaXMgaW5zaWRlIHRoZSByZWN0YW5nbGUsIGZhbHNlIG90aGVyd2lzZS5cbiAqL1xuUmVjdGFuZ2xlLmNvbnRhaW5zID0gZnVuY3Rpb24gKHJlY3RhbmdsZSwgY2FydG9ncmFwaGljKSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJyZWN0YW5nbGVcIiwgcmVjdGFuZ2xlKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcImNhcnRvZ3JhcGhpY1wiLCBjYXJ0b2dyYXBoaWMpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB2YXIgbG9uZ2l0dWRlID0gY2FydG9ncmFwaGljLmxvbmdpdHVkZTtcbiAgdmFyIGxhdGl0dWRlID0gY2FydG9ncmFwaGljLmxhdGl0dWRlO1xuXG4gIHZhciB3ZXN0ID0gcmVjdGFuZ2xlLndlc3Q7XG4gIHZhciBlYXN0ID0gcmVjdGFuZ2xlLmVhc3Q7XG5cbiAgaWYgKGVhc3QgPCB3ZXN0KSB7XG4gICAgZWFzdCArPSBDZXNpdW1NYXRoLlRXT19QSTtcbiAgICBpZiAobG9uZ2l0dWRlIDwgMC4wKSB7XG4gICAgICBsb25naXR1ZGUgKz0gQ2VzaXVtTWF0aC5UV09fUEk7XG4gICAgfVxuICB9XG4gIHJldHVybiAoXG4gICAgKGxvbmdpdHVkZSA+IHdlc3QgfHxcbiAgICAgIENlc2l1bU1hdGguZXF1YWxzRXBzaWxvbihsb25naXR1ZGUsIHdlc3QsIENlc2l1bU1hdGguRVBTSUxPTjE0KSkgJiZcbiAgICAobG9uZ2l0dWRlIDwgZWFzdCB8fFxuICAgICAgQ2VzaXVtTWF0aC5lcXVhbHNFcHNpbG9uKGxvbmdpdHVkZSwgZWFzdCwgQ2VzaXVtTWF0aC5FUFNJTE9OMTQpKSAmJlxuICAgIGxhdGl0dWRlID49IHJlY3RhbmdsZS5zb3V0aCAmJlxuICAgIGxhdGl0dWRlIDw9IHJlY3RhbmdsZS5ub3J0aFxuICApO1xufTtcblxudmFyIHN1YnNhbXBsZUxsYVNjcmF0Y2ggPSBuZXcgQ2FydG9ncmFwaGljKCk7XG4vKipcbiAqIFNhbXBsZXMgYSByZWN0YW5nbGUgc28gdGhhdCBpdCBpbmNsdWRlcyBhIGxpc3Qgb2YgQ2FydGVzaWFuIHBvaW50cyBzdWl0YWJsZSBmb3IgcGFzc2luZyB0b1xuICoge0BsaW5rIEJvdW5kaW5nU3BoZXJlI2Zyb21Qb2ludHN9LiAgU2FtcGxpbmcgaXMgbmVjZXNzYXJ5IHRvIGFjY291bnRcbiAqIGZvciByZWN0YW5nbGVzIHRoYXQgY292ZXIgdGhlIHBvbGVzIG9yIGNyb3NzIHRoZSBlcXVhdG9yLlxuICpcbiAqIEBwYXJhbSB7UmVjdGFuZ2xlfSByZWN0YW5nbGUgVGhlIHJlY3RhbmdsZSB0byBzdWJzYW1wbGUuXG4gKiBAcGFyYW0ge0VsbGlwc29pZH0gW2VsbGlwc29pZD1FbGxpcHNvaWQuV0dTODRdIFRoZSBlbGxpcHNvaWQgdG8gdXNlLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtzdXJmYWNlSGVpZ2h0PTAuMF0gVGhlIGhlaWdodCBvZiB0aGUgcmVjdGFuZ2xlIGFib3ZlIHRoZSBlbGxpcHNvaWQuXG4gKiBAcGFyYW0ge0NhcnRlc2lhbjNbXX0gW3Jlc3VsdF0gVGhlIGFycmF5IG9mIENhcnRlc2lhbnMgb250byB3aGljaCB0byBzdG9yZSB0aGUgcmVzdWx0LlxuICogQHJldHVybnMge0NhcnRlc2lhbjNbXX0gVGhlIG1vZGlmaWVkIHJlc3VsdCBwYXJhbWV0ZXIgb3IgYSBuZXcgQXJyYXkgb2YgQ2FydGVzaWFucyBpbnN0YW5jZXMgaWYgbm9uZSB3YXMgcHJvdmlkZWQuXG4gKi9cblJlY3RhbmdsZS5zdWJzYW1wbGUgPSBmdW5jdGlvbiAocmVjdGFuZ2xlLCBlbGxpcHNvaWQsIHN1cmZhY2VIZWlnaHQsIHJlc3VsdCkge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwicmVjdGFuZ2xlXCIsIHJlY3RhbmdsZSk7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIGVsbGlwc29pZCA9IGRlZmF1bHRWYWx1ZShlbGxpcHNvaWQsIEVsbGlwc29pZC5XR1M4NCk7XG4gIHN1cmZhY2VIZWlnaHQgPSBkZWZhdWx0VmFsdWUoc3VyZmFjZUhlaWdodCwgMC4wKTtcblxuICBpZiAoIWRlZmluZWQocmVzdWx0KSkge1xuICAgIHJlc3VsdCA9IFtdO1xuICB9XG4gIHZhciBsZW5ndGggPSAwO1xuXG4gIHZhciBub3J0aCA9IHJlY3RhbmdsZS5ub3J0aDtcbiAgdmFyIHNvdXRoID0gcmVjdGFuZ2xlLnNvdXRoO1xuICB2YXIgZWFzdCA9IHJlY3RhbmdsZS5lYXN0O1xuICB2YXIgd2VzdCA9IHJlY3RhbmdsZS53ZXN0O1xuXG4gIHZhciBsbGEgPSBzdWJzYW1wbGVMbGFTY3JhdGNoO1xuICBsbGEuaGVpZ2h0ID0gc3VyZmFjZUhlaWdodDtcblxuICBsbGEubG9uZ2l0dWRlID0gd2VzdDtcbiAgbGxhLmxhdGl0dWRlID0gbm9ydGg7XG4gIHJlc3VsdFtsZW5ndGhdID0gZWxsaXBzb2lkLmNhcnRvZ3JhcGhpY1RvQ2FydGVzaWFuKGxsYSwgcmVzdWx0W2xlbmd0aF0pO1xuICBsZW5ndGgrKztcblxuICBsbGEubG9uZ2l0dWRlID0gZWFzdDtcbiAgcmVzdWx0W2xlbmd0aF0gPSBlbGxpcHNvaWQuY2FydG9ncmFwaGljVG9DYXJ0ZXNpYW4obGxhLCByZXN1bHRbbGVuZ3RoXSk7XG4gIGxlbmd0aCsrO1xuXG4gIGxsYS5sYXRpdHVkZSA9IHNvdXRoO1xuICByZXN1bHRbbGVuZ3RoXSA9IGVsbGlwc29pZC5jYXJ0b2dyYXBoaWNUb0NhcnRlc2lhbihsbGEsIHJlc3VsdFtsZW5ndGhdKTtcbiAgbGVuZ3RoKys7XG5cbiAgbGxhLmxvbmdpdHVkZSA9IHdlc3Q7XG4gIHJlc3VsdFtsZW5ndGhdID0gZWxsaXBzb2lkLmNhcnRvZ3JhcGhpY1RvQ2FydGVzaWFuKGxsYSwgcmVzdWx0W2xlbmd0aF0pO1xuICBsZW5ndGgrKztcblxuICBpZiAobm9ydGggPCAwLjApIHtcbiAgICBsbGEubGF0aXR1ZGUgPSBub3J0aDtcbiAgfSBlbHNlIGlmIChzb3V0aCA+IDAuMCkge1xuICAgIGxsYS5sYXRpdHVkZSA9IHNvdXRoO1xuICB9IGVsc2Uge1xuICAgIGxsYS5sYXRpdHVkZSA9IDAuMDtcbiAgfVxuXG4gIGZvciAodmFyIGkgPSAxOyBpIDwgODsgKytpKSB7XG4gICAgbGxhLmxvbmdpdHVkZSA9IC1NYXRoLlBJICsgaSAqIENlc2l1bU1hdGguUElfT1ZFUl9UV087XG4gICAgaWYgKFJlY3RhbmdsZS5jb250YWlucyhyZWN0YW5nbGUsIGxsYSkpIHtcbiAgICAgIHJlc3VsdFtsZW5ndGhdID0gZWxsaXBzb2lkLmNhcnRvZ3JhcGhpY1RvQ2FydGVzaWFuKGxsYSwgcmVzdWx0W2xlbmd0aF0pO1xuICAgICAgbGVuZ3RoKys7XG4gICAgfVxuICB9XG5cbiAgaWYgKGxsYS5sYXRpdHVkZSA9PT0gMC4wKSB7XG4gICAgbGxhLmxvbmdpdHVkZSA9IHdlc3Q7XG4gICAgcmVzdWx0W2xlbmd0aF0gPSBlbGxpcHNvaWQuY2FydG9ncmFwaGljVG9DYXJ0ZXNpYW4obGxhLCByZXN1bHRbbGVuZ3RoXSk7XG4gICAgbGVuZ3RoKys7XG4gICAgbGxhLmxvbmdpdHVkZSA9IGVhc3Q7XG4gICAgcmVzdWx0W2xlbmd0aF0gPSBlbGxpcHNvaWQuY2FydG9ncmFwaGljVG9DYXJ0ZXNpYW4obGxhLCByZXN1bHRbbGVuZ3RoXSk7XG4gICAgbGVuZ3RoKys7XG4gIH1cbiAgcmVzdWx0Lmxlbmd0aCA9IGxlbmd0aDtcbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8qKlxuICogVGhlIGxhcmdlc3QgcG9zc2libGUgcmVjdGFuZ2xlLlxuICpcbiAqIEB0eXBlIHtSZWN0YW5nbGV9XG4gKiBAY29uc3RhbnRcbiAqL1xuUmVjdGFuZ2xlLk1BWF9WQUxVRSA9IE9iamVjdC5mcmVlemUoXG4gIG5ldyBSZWN0YW5nbGUoXG4gICAgLU1hdGguUEksXG4gICAgLUNlc2l1bU1hdGguUElfT1ZFUl9UV08sXG4gICAgTWF0aC5QSSxcbiAgICBDZXNpdW1NYXRoLlBJX09WRVJfVFdPXG4gIClcbik7XG5leHBvcnQgZGVmYXVsdCBSZWN0YW5nbGU7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///96190\n')},8185:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _ThirdParty_rbush_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(44857);\n/* harmony import */ var _Check_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(66553);\n\n\n\n/**\n * Wrapper around rbush for use with Rectangle types.\n * @private\n */\nfunction RectangleCollisionChecker() {\n  this._tree = new _ThirdParty_rbush_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\n}\n\nfunction RectangleWithId() {\n  this.minX = 0.0;\n  this.minY = 0.0;\n  this.maxX = 0.0;\n  this.maxY = 0.0;\n  this.id = "";\n}\n\nRectangleWithId.fromRectangleAndId = function (id, rectangle, result) {\n  result.minX = rectangle.west;\n  result.minY = rectangle.south;\n  result.maxX = rectangle.east;\n  result.maxY = rectangle.north;\n  result.id = id;\n  return result;\n};\n\n/**\n * Insert a rectangle into the collision checker.\n *\n * @param {String} id Unique string ID for the rectangle being inserted.\n * @param {Rectangle} rectangle A Rectangle\n * @private\n */\nRectangleCollisionChecker.prototype.insert = function (id, rectangle) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.string */ .Z.typeOf.string("id", id);\n  _Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  //>>includeEnd(\'debug\');\n\n  var withId = RectangleWithId.fromRectangleAndId(\n    id,\n    rectangle,\n    new RectangleWithId()\n  );\n  this._tree.insert(withId);\n};\n\nfunction idCompare(a, b) {\n  return a.id === b.id;\n}\n\nvar removalScratch = new RectangleWithId();\n/**\n * Remove a rectangle from the collision checker.\n *\n * @param {String} id Unique string ID for the rectangle being removed.\n * @param {Rectangle} rectangle A Rectangle\n * @private\n */\nRectangleCollisionChecker.prototype.remove = function (id, rectangle) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.string */ .Z.typeOf.string("id", id);\n  _Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  //>>includeEnd(\'debug\');\n\n  var withId = RectangleWithId.fromRectangleAndId(\n    id,\n    rectangle,\n    removalScratch\n  );\n  this._tree.remove(withId, idCompare);\n};\n\nvar collisionScratch = new RectangleWithId();\n/**\n * Checks if a given rectangle collides with any of the rectangles in the collection.\n *\n * @param {Rectangle} rectangle A Rectangle that should be checked against the rectangles in the collision checker.\n * @returns {Boolean} Whether the rectangle collides with any of the rectangles in the collision checker.\n */\nRectangleCollisionChecker.prototype.collides = function (rectangle) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  //>>includeEnd(\'debug\');\n\n  var withId = RectangleWithId.fromRectangleAndId(\n    "",\n    rectangle,\n    collisionScratch\n  );\n  return this._tree.collides(withId);\n};\n/* harmony default export */ __webpack_exports__["Z"] = (RectangleCollisionChecker);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODE4NS5qcyIsIm1hcHBpbmdzIjoiOztBQUEyQztBQUNaOztBQUUvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHFFQUFLO0FBQ3hCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLFdBQVcsV0FBVztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUUsc0ZBQW1CO0FBQ3JCLEVBQUUsc0ZBQW1CO0FBQ3JCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLFdBQVc7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFLHNGQUFtQjtBQUNyQixFQUFFLHNGQUFtQjtBQUNyQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsV0FBVztBQUN0QixhQUFhLFNBQVM7QUFDdEI7QUFDQTtBQUNBO0FBQ0EsRUFBRSxzRkFBbUI7QUFDckI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBZSx5QkFBeUIsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9Db3JlL1JlY3RhbmdsZUNvbGxpc2lvbkNoZWNrZXIuanM/YWRkYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUkJ1c2ggZnJvbSBcIi4uL1RoaXJkUGFydHkvcmJ1c2guanNcIjtcbmltcG9ydCBDaGVjayBmcm9tIFwiLi9DaGVjay5qc1wiO1xuXG4vKipcbiAqIFdyYXBwZXIgYXJvdW5kIHJidXNoIGZvciB1c2Ugd2l0aCBSZWN0YW5nbGUgdHlwZXMuXG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBSZWN0YW5nbGVDb2xsaXNpb25DaGVja2VyKCkge1xuICB0aGlzLl90cmVlID0gbmV3IFJCdXNoKCk7XG59XG5cbmZ1bmN0aW9uIFJlY3RhbmdsZVdpdGhJZCgpIHtcbiAgdGhpcy5taW5YID0gMC4wO1xuICB0aGlzLm1pblkgPSAwLjA7XG4gIHRoaXMubWF4WCA9IDAuMDtcbiAgdGhpcy5tYXhZID0gMC4wO1xuICB0aGlzLmlkID0gXCJcIjtcbn1cblxuUmVjdGFuZ2xlV2l0aElkLmZyb21SZWN0YW5nbGVBbmRJZCA9IGZ1bmN0aW9uIChpZCwgcmVjdGFuZ2xlLCByZXN1bHQpIHtcbiAgcmVzdWx0Lm1pblggPSByZWN0YW5nbGUud2VzdDtcbiAgcmVzdWx0Lm1pblkgPSByZWN0YW5nbGUuc291dGg7XG4gIHJlc3VsdC5tYXhYID0gcmVjdGFuZ2xlLmVhc3Q7XG4gIHJlc3VsdC5tYXhZID0gcmVjdGFuZ2xlLm5vcnRoO1xuICByZXN1bHQuaWQgPSBpZDtcbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8qKlxuICogSW5zZXJ0IGEgcmVjdGFuZ2xlIGludG8gdGhlIGNvbGxpc2lvbiBjaGVja2VyLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBpZCBVbmlxdWUgc3RyaW5nIElEIGZvciB0aGUgcmVjdGFuZ2xlIGJlaW5nIGluc2VydGVkLlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IHJlY3RhbmdsZSBBIFJlY3RhbmdsZVxuICogQHByaXZhdGVcbiAqL1xuUmVjdGFuZ2xlQ29sbGlzaW9uQ2hlY2tlci5wcm90b3R5cGUuaW5zZXJ0ID0gZnVuY3Rpb24gKGlkLCByZWN0YW5nbGUpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLnN0cmluZyhcImlkXCIsIGlkKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcInJlY3RhbmdsZVwiLCByZWN0YW5nbGUpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB2YXIgd2l0aElkID0gUmVjdGFuZ2xlV2l0aElkLmZyb21SZWN0YW5nbGVBbmRJZChcbiAgICBpZCxcbiAgICByZWN0YW5nbGUsXG4gICAgbmV3IFJlY3RhbmdsZVdpdGhJZCgpXG4gICk7XG4gIHRoaXMuX3RyZWUuaW5zZXJ0KHdpdGhJZCk7XG59O1xuXG5mdW5jdGlvbiBpZENvbXBhcmUoYSwgYikge1xuICByZXR1cm4gYS5pZCA9PT0gYi5pZDtcbn1cblxudmFyIHJlbW92YWxTY3JhdGNoID0gbmV3IFJlY3RhbmdsZVdpdGhJZCgpO1xuLyoqXG4gKiBSZW1vdmUgYSByZWN0YW5nbGUgZnJvbSB0aGUgY29sbGlzaW9uIGNoZWNrZXIuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IGlkIFVuaXF1ZSBzdHJpbmcgSUQgZm9yIHRoZSByZWN0YW5nbGUgYmVpbmcgcmVtb3ZlZC5cbiAqIEBwYXJhbSB7UmVjdGFuZ2xlfSByZWN0YW5nbGUgQSBSZWN0YW5nbGVcbiAqIEBwcml2YXRlXG4gKi9cblJlY3RhbmdsZUNvbGxpc2lvbkNoZWNrZXIucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChpZCwgcmVjdGFuZ2xlKSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLnR5cGVPZi5zdHJpbmcoXCJpZFwiLCBpZCk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJyZWN0YW5nbGVcIiwgcmVjdGFuZ2xlKTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgdmFyIHdpdGhJZCA9IFJlY3RhbmdsZVdpdGhJZC5mcm9tUmVjdGFuZ2xlQW5kSWQoXG4gICAgaWQsXG4gICAgcmVjdGFuZ2xlLFxuICAgIHJlbW92YWxTY3JhdGNoXG4gICk7XG4gIHRoaXMuX3RyZWUucmVtb3ZlKHdpdGhJZCwgaWRDb21wYXJlKTtcbn07XG5cbnZhciBjb2xsaXNpb25TY3JhdGNoID0gbmV3IFJlY3RhbmdsZVdpdGhJZCgpO1xuLyoqXG4gKiBDaGVja3MgaWYgYSBnaXZlbiByZWN0YW5nbGUgY29sbGlkZXMgd2l0aCBhbnkgb2YgdGhlIHJlY3RhbmdsZXMgaW4gdGhlIGNvbGxlY3Rpb24uXG4gKlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IHJlY3RhbmdsZSBBIFJlY3RhbmdsZSB0aGF0IHNob3VsZCBiZSBjaGVja2VkIGFnYWluc3QgdGhlIHJlY3RhbmdsZXMgaW4gdGhlIGNvbGxpc2lvbiBjaGVja2VyLlxuICogQHJldHVybnMge0Jvb2xlYW59IFdoZXRoZXIgdGhlIHJlY3RhbmdsZSBjb2xsaWRlcyB3aXRoIGFueSBvZiB0aGUgcmVjdGFuZ2xlcyBpbiB0aGUgY29sbGlzaW9uIGNoZWNrZXIuXG4gKi9cblJlY3RhbmdsZUNvbGxpc2lvbkNoZWNrZXIucHJvdG90eXBlLmNvbGxpZGVzID0gZnVuY3Rpb24gKHJlY3RhbmdsZSkge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwicmVjdGFuZ2xlXCIsIHJlY3RhbmdsZSk7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIHZhciB3aXRoSWQgPSBSZWN0YW5nbGVXaXRoSWQuZnJvbVJlY3RhbmdsZUFuZElkKFxuICAgIFwiXCIsXG4gICAgcmVjdGFuZ2xlLFxuICAgIGNvbGxpc2lvblNjcmF0Y2hcbiAgKTtcbiAgcmV0dXJuIHRoaXMuX3RyZWUuY29sbGlkZXMod2l0aElkKTtcbn07XG5leHBvcnQgZGVmYXVsdCBSZWN0YW5nbGVDb2xsaXNpb25DaGVja2VyO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///8185\n')},96812:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _arrayFill_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(23401);\n/* harmony import */ var _BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(48243);\n/* harmony import */ var _Cartesian2_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(60838);\n/* harmony import */ var _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(60216);\n/* harmony import */ var _Cartographic_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(51688);\n/* harmony import */ var _Check_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(66553);\n/* harmony import */ var _ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(84828);\n/* harmony import */ var _defaultValue_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(62200);\n/* harmony import */ var _defined_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(82982);\n/* harmony import */ var _DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(12572);\n/* harmony import */ var _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(50491);\n/* harmony import */ var _Geometry_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(82408);\n/* harmony import */ var _GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(13616);\n/* harmony import */ var _GeometryAttributes_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(56652);\n/* harmony import */ var _GeometryInstance_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(26865);\n/* harmony import */ var _GeometryOffsetAttribute_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(87379);\n/* harmony import */ var _GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(57552);\n/* harmony import */ var _IndexDatatype_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(22832);\n/* harmony import */ var _Math_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(99417);\n/* harmony import */ var _Matrix2_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(71171);\n/* harmony import */ var _Matrix3_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(68201);\n/* harmony import */ var _PolygonPipeline_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(78284);\n/* harmony import */ var _PrimitiveType_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(97264);\n/* harmony import */ var _Quaternion_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(87811);\n/* harmony import */ var _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(96190);\n/* harmony import */ var _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(62194);\n/* harmony import */ var _VertexFormat_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(67252);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar positionScratch = new _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\nvar normalScratch = new _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\nvar tangentScratch = new _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\nvar bitangentScratch = new _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\nvar rectangleScratch = new _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z();\nvar stScratch = new _Cartesian2_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\nvar bottomBoundingSphere = new _BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\nvar topBoundingSphere = new _BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\n\nfunction createAttributes(vertexFormat, attributes) {\n  var geo = new _Geometry_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z({\n    attributes: new _GeometryAttributes_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z(),\n    primitiveType: _PrimitiveType_js__WEBPACK_IMPORTED_MODULE_21__/* ["default"].TRIANGLES */ .Z.TRIANGLES,\n  });\n\n  geo.attributes.position = new _GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z({\n    componentDatatype: _ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].DOUBLE */ .Z.DOUBLE,\n    componentsPerAttribute: 3,\n    values: attributes.positions,\n  });\n  if (vertexFormat.normal) {\n    geo.attributes.normal = new _GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z({\n      componentDatatype: _ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].FLOAT */ .Z.FLOAT,\n      componentsPerAttribute: 3,\n      values: attributes.normals,\n    });\n  }\n  if (vertexFormat.tangent) {\n    geo.attributes.tangent = new _GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z({\n      componentDatatype: _ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].FLOAT */ .Z.FLOAT,\n      componentsPerAttribute: 3,\n      values: attributes.tangents,\n    });\n  }\n  if (vertexFormat.bitangent) {\n    geo.attributes.bitangent = new _GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z({\n      componentDatatype: _ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].FLOAT */ .Z.FLOAT,\n      componentsPerAttribute: 3,\n      values: attributes.bitangents,\n    });\n  }\n  return geo;\n}\n\nfunction calculateAttributes(\n  positions,\n  vertexFormat,\n  ellipsoid,\n  tangentRotationMatrix\n) {\n  var length = positions.length;\n\n  var normals = vertexFormat.normal ? new Float32Array(length) : undefined;\n  var tangents = vertexFormat.tangent ? new Float32Array(length) : undefined;\n  var bitangents = vertexFormat.bitangent\n    ? new Float32Array(length)\n    : undefined;\n\n  var attrIndex = 0;\n  var bitangent = bitangentScratch;\n  var tangent = tangentScratch;\n  var normal = normalScratch;\n  if (vertexFormat.normal || vertexFormat.tangent || vertexFormat.bitangent) {\n    for (var i = 0; i < length; i += 3) {\n      var p = _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].fromArray */ .Z.fromArray(positions, i, positionScratch);\n      var attrIndex1 = attrIndex + 1;\n      var attrIndex2 = attrIndex + 2;\n\n      normal = ellipsoid.geodeticSurfaceNormal(p, normal);\n      if (vertexFormat.tangent || vertexFormat.bitangent) {\n        _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].cross */ .Z.cross(_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].UNIT_Z */ .Z.UNIT_Z, normal, tangent);\n        _Matrix3_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].multiplyByVector */ .Z.multiplyByVector(tangentRotationMatrix, tangent, tangent);\n        _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].normalize */ .Z.normalize(tangent, tangent);\n\n        if (vertexFormat.bitangent) {\n          _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].normalize */ .Z.normalize(\n            _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].cross */ .Z.cross(normal, tangent, bitangent),\n            bitangent\n          );\n        }\n      }\n\n      if (vertexFormat.normal) {\n        normals[attrIndex] = normal.x;\n        normals[attrIndex1] = normal.y;\n        normals[attrIndex2] = normal.z;\n      }\n      if (vertexFormat.tangent) {\n        tangents[attrIndex] = tangent.x;\n        tangents[attrIndex1] = tangent.y;\n        tangents[attrIndex2] = tangent.z;\n      }\n      if (vertexFormat.bitangent) {\n        bitangents[attrIndex] = bitangent.x;\n        bitangents[attrIndex1] = bitangent.y;\n        bitangents[attrIndex2] = bitangent.z;\n      }\n      attrIndex += 3;\n    }\n  }\n  return createAttributes(vertexFormat, {\n    positions: positions,\n    normals: normals,\n    tangents: tangents,\n    bitangents: bitangents,\n  });\n}\n\nvar v1Scratch = new _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\nvar v2Scratch = new _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\n\nfunction calculateAttributesWall(positions, vertexFormat, ellipsoid) {\n  var length = positions.length;\n\n  var normals = vertexFormat.normal ? new Float32Array(length) : undefined;\n  var tangents = vertexFormat.tangent ? new Float32Array(length) : undefined;\n  var bitangents = vertexFormat.bitangent\n    ? new Float32Array(length)\n    : undefined;\n\n  var normalIndex = 0;\n  var tangentIndex = 0;\n  var bitangentIndex = 0;\n  var recomputeNormal = true;\n\n  var bitangent = bitangentScratch;\n  var tangent = tangentScratch;\n  var normal = normalScratch;\n  if (vertexFormat.normal || vertexFormat.tangent || vertexFormat.bitangent) {\n    for (var i = 0; i < length; i += 6) {\n      var p = _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].fromArray */ .Z.fromArray(positions, i, positionScratch);\n      var p1 = _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].fromArray */ .Z.fromArray(positions, (i + 6) % length, v1Scratch);\n      if (recomputeNormal) {\n        var p2 = _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].fromArray */ .Z.fromArray(positions, (i + 3) % length, v2Scratch);\n        _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].subtract */ .Z.subtract(p1, p, p1);\n        _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].subtract */ .Z.subtract(p2, p, p2);\n        normal = _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].normalize */ .Z.normalize(_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].cross */ .Z.cross(p2, p1, normal), normal);\n        recomputeNormal = false;\n      }\n\n      if (_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].equalsEpsilon */ .Z.equalsEpsilon(p1, p, _Math_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].EPSILON10 */ .Z.EPSILON10)) {\n        // if we\'ve reached a corner\n        recomputeNormal = true;\n      }\n\n      if (vertexFormat.tangent || vertexFormat.bitangent) {\n        bitangent = ellipsoid.geodeticSurfaceNormal(p, bitangent);\n        if (vertexFormat.tangent) {\n          tangent = _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].normalize */ .Z.normalize(\n            _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].cross */ .Z.cross(bitangent, normal, tangent),\n            tangent\n          );\n        }\n      }\n\n      if (vertexFormat.normal) {\n        normals[normalIndex++] = normal.x;\n        normals[normalIndex++] = normal.y;\n        normals[normalIndex++] = normal.z;\n        normals[normalIndex++] = normal.x;\n        normals[normalIndex++] = normal.y;\n        normals[normalIndex++] = normal.z;\n      }\n\n      if (vertexFormat.tangent) {\n        tangents[tangentIndex++] = tangent.x;\n        tangents[tangentIndex++] = tangent.y;\n        tangents[tangentIndex++] = tangent.z;\n        tangents[tangentIndex++] = tangent.x;\n        tangents[tangentIndex++] = tangent.y;\n        tangents[tangentIndex++] = tangent.z;\n      }\n\n      if (vertexFormat.bitangent) {\n        bitangents[bitangentIndex++] = bitangent.x;\n        bitangents[bitangentIndex++] = bitangent.y;\n        bitangents[bitangentIndex++] = bitangent.z;\n        bitangents[bitangentIndex++] = bitangent.x;\n        bitangents[bitangentIndex++] = bitangent.y;\n        bitangents[bitangentIndex++] = bitangent.z;\n      }\n    }\n  }\n\n  return createAttributes(vertexFormat, {\n    positions: positions,\n    normals: normals,\n    tangents: tangents,\n    bitangents: bitangents,\n  });\n}\n\nfunction constructRectangle(rectangleGeometry, computedOptions) {\n  var vertexFormat = rectangleGeometry._vertexFormat;\n  var ellipsoid = rectangleGeometry._ellipsoid;\n  var height = computedOptions.height;\n  var width = computedOptions.width;\n  var northCap = computedOptions.northCap;\n  var southCap = computedOptions.southCap;\n\n  var rowStart = 0;\n  var rowEnd = height;\n  var rowHeight = height;\n  var size = 0;\n  if (northCap) {\n    rowStart = 1;\n    rowHeight -= 1;\n    size += 1;\n  }\n  if (southCap) {\n    rowEnd -= 1;\n    rowHeight -= 1;\n    size += 1;\n  }\n  size += width * rowHeight;\n\n  var positions = vertexFormat.position\n    ? new Float64Array(size * 3)\n    : undefined;\n  var textureCoordinates = vertexFormat.st\n    ? new Float32Array(size * 2)\n    : undefined;\n\n  var posIndex = 0;\n  var stIndex = 0;\n\n  var position = positionScratch;\n  var st = stScratch;\n\n  var minX = Number.MAX_VALUE;\n  var minY = Number.MAX_VALUE;\n  var maxX = -Number.MAX_VALUE;\n  var maxY = -Number.MAX_VALUE;\n\n  for (var row = rowStart; row < rowEnd; ++row) {\n    for (var col = 0; col < width; ++col) {\n      _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].computePosition */ .Z.computePosition(\n        computedOptions,\n        ellipsoid,\n        vertexFormat.st,\n        row,\n        col,\n        position,\n        st\n      );\n\n      positions[posIndex++] = position.x;\n      positions[posIndex++] = position.y;\n      positions[posIndex++] = position.z;\n\n      if (vertexFormat.st) {\n        textureCoordinates[stIndex++] = st.x;\n        textureCoordinates[stIndex++] = st.y;\n\n        minX = Math.min(minX, st.x);\n        minY = Math.min(minY, st.y);\n        maxX = Math.max(maxX, st.x);\n        maxY = Math.max(maxY, st.y);\n      }\n    }\n  }\n  if (northCap) {\n    _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].computePosition */ .Z.computePosition(\n      computedOptions,\n      ellipsoid,\n      vertexFormat.st,\n      0,\n      0,\n      position,\n      st\n    );\n\n    positions[posIndex++] = position.x;\n    positions[posIndex++] = position.y;\n    positions[posIndex++] = position.z;\n\n    if (vertexFormat.st) {\n      textureCoordinates[stIndex++] = st.x;\n      textureCoordinates[stIndex++] = st.y;\n\n      minX = st.x;\n      minY = st.y;\n      maxX = st.x;\n      maxY = st.y;\n    }\n  }\n  if (southCap) {\n    _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].computePosition */ .Z.computePosition(\n      computedOptions,\n      ellipsoid,\n      vertexFormat.st,\n      height - 1,\n      0,\n      position,\n      st\n    );\n\n    positions[posIndex++] = position.x;\n    positions[posIndex++] = position.y;\n    positions[posIndex] = position.z;\n\n    if (vertexFormat.st) {\n      textureCoordinates[stIndex++] = st.x;\n      textureCoordinates[stIndex] = st.y;\n\n      minX = Math.min(minX, st.x);\n      minY = Math.min(minY, st.y);\n      maxX = Math.max(maxX, st.x);\n      maxY = Math.max(maxY, st.y);\n    }\n  }\n\n  if (\n    vertexFormat.st &&\n    (minX < 0.0 || minY < 0.0 || maxX > 1.0 || maxY > 1.0)\n  ) {\n    for (var k = 0; k < textureCoordinates.length; k += 2) {\n      textureCoordinates[k] = (textureCoordinates[k] - minX) / (maxX - minX);\n      textureCoordinates[k + 1] =\n        (textureCoordinates[k + 1] - minY) / (maxY - minY);\n    }\n  }\n\n  var geo = calculateAttributes(\n    positions,\n    vertexFormat,\n    ellipsoid,\n    computedOptions.tangentRotationMatrix\n  );\n\n  var indicesSize = 6 * (width - 1) * (rowHeight - 1);\n  if (northCap) {\n    indicesSize += 3 * (width - 1);\n  }\n  if (southCap) {\n    indicesSize += 3 * (width - 1);\n  }\n  var indices = _IndexDatatype_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].createTypedArray */ .Z.createTypedArray(size, indicesSize);\n  var index = 0;\n  var indicesIndex = 0;\n  var i;\n  for (i = 0; i < rowHeight - 1; ++i) {\n    for (var j = 0; j < width - 1; ++j) {\n      var upperLeft = index;\n      var lowerLeft = upperLeft + width;\n      var lowerRight = lowerLeft + 1;\n      var upperRight = upperLeft + 1;\n      indices[indicesIndex++] = upperLeft;\n      indices[indicesIndex++] = lowerLeft;\n      indices[indicesIndex++] = upperRight;\n      indices[indicesIndex++] = upperRight;\n      indices[indicesIndex++] = lowerLeft;\n      indices[indicesIndex++] = lowerRight;\n      ++index;\n    }\n    ++index;\n  }\n  if (northCap || southCap) {\n    var northIndex = size - 1;\n    var southIndex = size - 1;\n    if (northCap && southCap) {\n      northIndex = size - 2;\n    }\n\n    var p1;\n    var p2;\n    index = 0;\n\n    if (northCap) {\n      for (i = 0; i < width - 1; i++) {\n        p1 = index;\n        p2 = p1 + 1;\n        indices[indicesIndex++] = northIndex;\n        indices[indicesIndex++] = p1;\n        indices[indicesIndex++] = p2;\n        ++index;\n      }\n    }\n    if (southCap) {\n      index = (rowHeight - 1) * width;\n      for (i = 0; i < width - 1; i++) {\n        p1 = index;\n        p2 = p1 + 1;\n        indices[indicesIndex++] = p1;\n        indices[indicesIndex++] = southIndex;\n        indices[indicesIndex++] = p2;\n        ++index;\n      }\n    }\n  }\n\n  geo.indices = indices;\n  if (vertexFormat.st) {\n    geo.attributes.st = new _GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z({\n      componentDatatype: _ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].FLOAT */ .Z.FLOAT,\n      componentsPerAttribute: 2,\n      values: textureCoordinates,\n    });\n  }\n\n  return geo;\n}\n\nfunction addWallPositions(\n  wallPositions,\n  posIndex,\n  i,\n  topPositions,\n  bottomPositions\n) {\n  wallPositions[posIndex++] = topPositions[i];\n  wallPositions[posIndex++] = topPositions[i + 1];\n  wallPositions[posIndex++] = topPositions[i + 2];\n  wallPositions[posIndex++] = bottomPositions[i];\n  wallPositions[posIndex++] = bottomPositions[i + 1];\n  wallPositions[posIndex] = bottomPositions[i + 2];\n  return wallPositions;\n}\n\nfunction addWallTextureCoordinates(wallTextures, stIndex, i, st) {\n  wallTextures[stIndex++] = st[i];\n  wallTextures[stIndex++] = st[i + 1];\n  wallTextures[stIndex++] = st[i];\n  wallTextures[stIndex] = st[i + 1];\n  return wallTextures;\n}\n\nvar scratchVertexFormat = new _VertexFormat_js__WEBPACK_IMPORTED_MODULE_25__/* ["default"] */ .Z();\n\nfunction constructExtrudedRectangle(rectangleGeometry, computedOptions) {\n  var shadowVolume = rectangleGeometry._shadowVolume;\n  var offsetAttributeValue = rectangleGeometry._offsetAttribute;\n  var vertexFormat = rectangleGeometry._vertexFormat;\n  var minHeight = rectangleGeometry._extrudedHeight;\n  var maxHeight = rectangleGeometry._surfaceHeight;\n  var ellipsoid = rectangleGeometry._ellipsoid;\n\n  var height = computedOptions.height;\n  var width = computedOptions.width;\n\n  var i;\n\n  if (shadowVolume) {\n    var newVertexFormat = _VertexFormat_js__WEBPACK_IMPORTED_MODULE_25__/* ["default"].clone */ .Z.clone(vertexFormat, scratchVertexFormat);\n    newVertexFormat.normal = true;\n    rectangleGeometry._vertexFormat = newVertexFormat;\n  }\n\n  var topBottomGeo = constructRectangle(rectangleGeometry, computedOptions);\n\n  if (shadowVolume) {\n    rectangleGeometry._vertexFormat = vertexFormat;\n  }\n\n  var topPositions = _PolygonPipeline_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"].scaleToGeodeticHeight */ .Z.scaleToGeodeticHeight(\n    topBottomGeo.attributes.position.values,\n    maxHeight,\n    ellipsoid,\n    false\n  );\n  topPositions = new Float64Array(topPositions);\n  var length = topPositions.length;\n  var newLength = length * 2;\n  var positions = new Float64Array(newLength);\n  positions.set(topPositions);\n  var bottomPositions = _PolygonPipeline_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"].scaleToGeodeticHeight */ .Z.scaleToGeodeticHeight(\n    topBottomGeo.attributes.position.values,\n    minHeight,\n    ellipsoid\n  );\n  positions.set(bottomPositions, length);\n  topBottomGeo.attributes.position.values = positions;\n\n  var normals = vertexFormat.normal ? new Float32Array(newLength) : undefined;\n  var tangents = vertexFormat.tangent ? new Float32Array(newLength) : undefined;\n  var bitangents = vertexFormat.bitangent\n    ? new Float32Array(newLength)\n    : undefined;\n  var textures = vertexFormat.st\n    ? new Float32Array((newLength / 3) * 2)\n    : undefined;\n  var topSt;\n  var topNormals;\n  if (vertexFormat.normal) {\n    topNormals = topBottomGeo.attributes.normal.values;\n    normals.set(topNormals);\n    for (i = 0; i < length; i++) {\n      topNormals[i] = -topNormals[i];\n    }\n    normals.set(topNormals, length);\n    topBottomGeo.attributes.normal.values = normals;\n  }\n  if (shadowVolume) {\n    topNormals = topBottomGeo.attributes.normal.values;\n    if (!vertexFormat.normal) {\n      topBottomGeo.attributes.normal = undefined;\n    }\n    var extrudeNormals = new Float32Array(newLength);\n    for (i = 0; i < length; i++) {\n      topNormals[i] = -topNormals[i];\n    }\n    extrudeNormals.set(topNormals, length); //only get normals for bottom layer that\'s going to be pushed down\n    topBottomGeo.attributes.extrudeDirection = new _GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z({\n      componentDatatype: _ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].FLOAT */ .Z.FLOAT,\n      componentsPerAttribute: 3,\n      values: extrudeNormals,\n    });\n  }\n\n  var offsetValue;\n  var hasOffsets = (0,_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(offsetAttributeValue);\n  if (hasOffsets) {\n    var size = (length / 3) * 2;\n    var offsetAttribute = new Uint8Array(size);\n    if (offsetAttributeValue === _GeometryOffsetAttribute_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].TOP */ .Z.TOP) {\n      offsetAttribute = (0,_arrayFill_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(offsetAttribute, 1, 0, size / 2);\n    } else {\n      offsetValue =\n        offsetAttributeValue === _GeometryOffsetAttribute_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].NONE */ .Z.NONE ? 0 : 1;\n      offsetAttribute = (0,_arrayFill_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(offsetAttribute, offsetValue);\n    }\n\n    topBottomGeo.attributes.applyOffset = new _GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z({\n      componentDatatype: _ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].UNSIGNED_BYTE */ .Z.UNSIGNED_BYTE,\n      componentsPerAttribute: 1,\n      values: offsetAttribute,\n    });\n  }\n\n  if (vertexFormat.tangent) {\n    var topTangents = topBottomGeo.attributes.tangent.values;\n    tangents.set(topTangents);\n    for (i = 0; i < length; i++) {\n      topTangents[i] = -topTangents[i];\n    }\n    tangents.set(topTangents, length);\n    topBottomGeo.attributes.tangent.values = tangents;\n  }\n  if (vertexFormat.bitangent) {\n    var topBitangents = topBottomGeo.attributes.bitangent.values;\n    bitangents.set(topBitangents);\n    bitangents.set(topBitangents, length);\n    topBottomGeo.attributes.bitangent.values = bitangents;\n  }\n  if (vertexFormat.st) {\n    topSt = topBottomGeo.attributes.st.values;\n    textures.set(topSt);\n    textures.set(topSt, (length / 3) * 2);\n    topBottomGeo.attributes.st.values = textures;\n  }\n\n  var indices = topBottomGeo.indices;\n  var indicesLength = indices.length;\n  var posLength = length / 3;\n  var newIndices = _IndexDatatype_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].createTypedArray */ .Z.createTypedArray(\n    newLength / 3,\n    indicesLength * 2\n  );\n  newIndices.set(indices);\n  for (i = 0; i < indicesLength; i += 3) {\n    newIndices[i + indicesLength] = indices[i + 2] + posLength;\n    newIndices[i + 1 + indicesLength] = indices[i + 1] + posLength;\n    newIndices[i + 2 + indicesLength] = indices[i] + posLength;\n  }\n  topBottomGeo.indices = newIndices;\n\n  var northCap = computedOptions.northCap;\n  var southCap = computedOptions.southCap;\n\n  var rowHeight = height;\n  var widthMultiplier = 2;\n  var perimeterPositions = 0;\n  var corners = 4;\n  var dupliateCorners = 4;\n  if (northCap) {\n    widthMultiplier -= 1;\n    rowHeight -= 1;\n    perimeterPositions += 1;\n    corners -= 2;\n    dupliateCorners -= 1;\n  }\n  if (southCap) {\n    widthMultiplier -= 1;\n    rowHeight -= 1;\n    perimeterPositions += 1;\n    corners -= 2;\n    dupliateCorners -= 1;\n  }\n  perimeterPositions += widthMultiplier * width + 2 * rowHeight - corners;\n\n  var wallCount = (perimeterPositions + dupliateCorners) * 2;\n\n  var wallPositions = new Float64Array(wallCount * 3);\n  var wallExtrudeNormals = shadowVolume\n    ? new Float32Array(wallCount * 3)\n    : undefined;\n  var wallOffsetAttribute = hasOffsets ? new Uint8Array(wallCount) : undefined;\n  var wallTextures = vertexFormat.st\n    ? new Float32Array(wallCount * 2)\n    : undefined;\n\n  var computeTopOffsets = offsetAttributeValue === _GeometryOffsetAttribute_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].TOP */ .Z.TOP;\n  if (hasOffsets && !computeTopOffsets) {\n    offsetValue = offsetAttributeValue === _GeometryOffsetAttribute_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].ALL */ .Z.ALL ? 1 : 0;\n    wallOffsetAttribute = (0,_arrayFill_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(wallOffsetAttribute, offsetValue);\n  }\n\n  var posIndex = 0;\n  var stIndex = 0;\n  var extrudeNormalIndex = 0;\n  var wallOffsetIndex = 0;\n  var area = width * rowHeight;\n  var threeI;\n  for (i = 0; i < area; i += width) {\n    threeI = i * 3;\n    wallPositions = addWallPositions(\n      wallPositions,\n      posIndex,\n      threeI,\n      topPositions,\n      bottomPositions\n    );\n    posIndex += 6;\n    if (vertexFormat.st) {\n      wallTextures = addWallTextureCoordinates(\n        wallTextures,\n        stIndex,\n        i * 2,\n        topSt\n      );\n      stIndex += 4;\n    }\n    if (shadowVolume) {\n      extrudeNormalIndex += 3;\n      wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI];\n      wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI + 1];\n      wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI + 2];\n    }\n    if (computeTopOffsets) {\n      wallOffsetAttribute[wallOffsetIndex++] = 1;\n      wallOffsetIndex += 1;\n    }\n  }\n\n  if (!southCap) {\n    for (i = area - width; i < area; i++) {\n      threeI = i * 3;\n      wallPositions = addWallPositions(\n        wallPositions,\n        posIndex,\n        threeI,\n        topPositions,\n        bottomPositions\n      );\n      posIndex += 6;\n      if (vertexFormat.st) {\n        wallTextures = addWallTextureCoordinates(\n          wallTextures,\n          stIndex,\n          i * 2,\n          topSt\n        );\n        stIndex += 4;\n      }\n      if (shadowVolume) {\n        extrudeNormalIndex += 3;\n        wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI];\n        wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI + 1];\n        wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI + 2];\n      }\n      if (computeTopOffsets) {\n        wallOffsetAttribute[wallOffsetIndex++] = 1;\n        wallOffsetIndex += 1;\n      }\n    }\n  } else {\n    var southIndex = northCap ? area + 1 : area;\n    threeI = southIndex * 3;\n\n    for (i = 0; i < 2; i++) {\n      // duplicate corner points\n      wallPositions = addWallPositions(\n        wallPositions,\n        posIndex,\n        threeI,\n        topPositions,\n        bottomPositions\n      );\n      posIndex += 6;\n      if (vertexFormat.st) {\n        wallTextures = addWallTextureCoordinates(\n          wallTextures,\n          stIndex,\n          southIndex * 2,\n          topSt\n        );\n        stIndex += 4;\n      }\n      if (shadowVolume) {\n        extrudeNormalIndex += 3;\n        wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI];\n        wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI + 1];\n        wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI + 2];\n      }\n      if (computeTopOffsets) {\n        wallOffsetAttribute[wallOffsetIndex++] = 1;\n        wallOffsetIndex += 1;\n      }\n    }\n  }\n\n  for (i = area - 1; i > 0; i -= width) {\n    threeI = i * 3;\n    wallPositions = addWallPositions(\n      wallPositions,\n      posIndex,\n      threeI,\n      topPositions,\n      bottomPositions\n    );\n    posIndex += 6;\n    if (vertexFormat.st) {\n      wallTextures = addWallTextureCoordinates(\n        wallTextures,\n        stIndex,\n        i * 2,\n        topSt\n      );\n      stIndex += 4;\n    }\n    if (shadowVolume) {\n      extrudeNormalIndex += 3;\n      wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI];\n      wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI + 1];\n      wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI + 2];\n    }\n    if (computeTopOffsets) {\n      wallOffsetAttribute[wallOffsetIndex++] = 1;\n      wallOffsetIndex += 1;\n    }\n  }\n\n  if (!northCap) {\n    for (i = width - 1; i >= 0; i--) {\n      threeI = i * 3;\n      wallPositions = addWallPositions(\n        wallPositions,\n        posIndex,\n        threeI,\n        topPositions,\n        bottomPositions\n      );\n      posIndex += 6;\n      if (vertexFormat.st) {\n        wallTextures = addWallTextureCoordinates(\n          wallTextures,\n          stIndex,\n          i * 2,\n          topSt\n        );\n        stIndex += 4;\n      }\n      if (shadowVolume) {\n        extrudeNormalIndex += 3;\n        wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI];\n        wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI + 1];\n        wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI + 2];\n      }\n      if (computeTopOffsets) {\n        wallOffsetAttribute[wallOffsetIndex++] = 1;\n        wallOffsetIndex += 1;\n      }\n    }\n  } else {\n    var northIndex = area;\n    threeI = northIndex * 3;\n\n    for (i = 0; i < 2; i++) {\n      // duplicate corner points\n      wallPositions = addWallPositions(\n        wallPositions,\n        posIndex,\n        threeI,\n        topPositions,\n        bottomPositions\n      );\n      posIndex += 6;\n      if (vertexFormat.st) {\n        wallTextures = addWallTextureCoordinates(\n          wallTextures,\n          stIndex,\n          northIndex * 2,\n          topSt\n        );\n        stIndex += 4;\n      }\n      if (shadowVolume) {\n        extrudeNormalIndex += 3;\n        wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI];\n        wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI + 1];\n        wallExtrudeNormals[extrudeNormalIndex++] = topNormals[threeI + 2];\n      }\n      if (computeTopOffsets) {\n        wallOffsetAttribute[wallOffsetIndex++] = 1;\n        wallOffsetIndex += 1;\n      }\n    }\n  }\n\n  var geo = calculateAttributesWall(wallPositions, vertexFormat, ellipsoid);\n\n  if (vertexFormat.st) {\n    geo.attributes.st = new _GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z({\n      componentDatatype: _ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].FLOAT */ .Z.FLOAT,\n      componentsPerAttribute: 2,\n      values: wallTextures,\n    });\n  }\n  if (shadowVolume) {\n    geo.attributes.extrudeDirection = new _GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z({\n      componentDatatype: _ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].FLOAT */ .Z.FLOAT,\n      componentsPerAttribute: 3,\n      values: wallExtrudeNormals,\n    });\n  }\n  if (hasOffsets) {\n    geo.attributes.applyOffset = new _GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z({\n      componentDatatype: _ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].UNSIGNED_BYTE */ .Z.UNSIGNED_BYTE,\n      componentsPerAttribute: 1,\n      values: wallOffsetAttribute,\n    });\n  }\n\n  var wallIndices = _IndexDatatype_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].createTypedArray */ .Z.createTypedArray(\n    wallCount,\n    perimeterPositions * 6\n  );\n\n  var upperLeft;\n  var lowerLeft;\n  var lowerRight;\n  var upperRight;\n  length = wallPositions.length / 3;\n  var index = 0;\n  for (i = 0; i < length - 1; i += 2) {\n    upperLeft = i;\n    upperRight = (upperLeft + 2) % length;\n    var p1 = _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].fromArray */ .Z.fromArray(wallPositions, upperLeft * 3, v1Scratch);\n    var p2 = _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].fromArray */ .Z.fromArray(wallPositions, upperRight * 3, v2Scratch);\n    if (_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].equalsEpsilon */ .Z.equalsEpsilon(p1, p2, _Math_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].EPSILON10 */ .Z.EPSILON10)) {\n      continue;\n    }\n    lowerLeft = (upperLeft + 1) % length;\n    lowerRight = (lowerLeft + 2) % length;\n    wallIndices[index++] = upperLeft;\n    wallIndices[index++] = lowerLeft;\n    wallIndices[index++] = upperRight;\n    wallIndices[index++] = upperRight;\n    wallIndices[index++] = lowerLeft;\n    wallIndices[index++] = lowerRight;\n  }\n\n  geo.indices = wallIndices;\n\n  geo = _GeometryPipeline_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"].combineInstances */ .Z.combineInstances([\n    new _GeometryInstance_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z({\n      geometry: topBottomGeo,\n    }),\n    new _GeometryInstance_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z({\n      geometry: geo,\n    }),\n  ]);\n\n  return geo[0];\n}\n\nvar scratchRectanglePoints = [\n  new _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z(),\n  new _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z(),\n  new _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z(),\n  new _Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z(),\n];\nvar nwScratch = new _Cartographic_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\nvar stNwScratch = new _Cartographic_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\nfunction computeRectangle(rectangle, granularity, rotation, ellipsoid, result) {\n  if (rotation === 0.0) {\n    return _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].clone */ .Z.clone(rectangle, result);\n  }\n\n  var computedOptions = _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].computeOptions */ .Z.computeOptions(\n    rectangle,\n    granularity,\n    rotation,\n    0,\n    rectangleScratch,\n    nwScratch\n  );\n\n  var height = computedOptions.height;\n  var width = computedOptions.width;\n\n  var positions = scratchRectanglePoints;\n  _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].computePosition */ .Z.computePosition(\n    computedOptions,\n    ellipsoid,\n    false,\n    0,\n    0,\n    positions[0]\n  );\n  _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].computePosition */ .Z.computePosition(\n    computedOptions,\n    ellipsoid,\n    false,\n    0,\n    width - 1,\n    positions[1]\n  );\n  _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].computePosition */ .Z.computePosition(\n    computedOptions,\n    ellipsoid,\n    false,\n    height - 1,\n    0,\n    positions[2]\n  );\n  _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].computePosition */ .Z.computePosition(\n    computedOptions,\n    ellipsoid,\n    false,\n    height - 1,\n    width - 1,\n    positions[3]\n  );\n\n  return _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].fromCartesianArray */ .Z.fromCartesianArray(positions, ellipsoid, result);\n}\n\n/**\n * A description of a cartographic rectangle on an ellipsoid centered at the origin. Rectangle geometry can be rendered with both {@link Primitive} and {@link GroundPrimitive}.\n *\n * @alias RectangleGeometry\n * @constructor\n *\n * @param {Object} options Object with the following properties:\n * @param {Rectangle} options.rectangle A cartographic rectangle with north, south, east and west properties in radians.\n * @param {VertexFormat} [options.vertexFormat=VertexFormat.DEFAULT] The vertex attributes to be computed.\n * @param {Ellipsoid} [options.ellipsoid=Ellipsoid.WGS84] The ellipsoid on which the rectangle lies.\n * @param {Number} [options.granularity=CesiumMath.RADIANS_PER_DEGREE] The distance, in radians, between each latitude and longitude. Determines the number of positions in the buffer.\n * @param {Number} [options.height=0.0] The distance in meters between the rectangle and the ellipsoid surface.\n * @param {Number} [options.rotation=0.0] The rotation of the rectangle, in radians. A positive rotation is counter-clockwise.\n * @param {Number} [options.stRotation=0.0] The rotation of the texture coordinates, in radians. A positive rotation is counter-clockwise.\n * @param {Number} [options.extrudedHeight] The distance in meters between the rectangle\'s extruded face and the ellipsoid surface.\n *\n * @exception {DeveloperError} <code>options.rectangle.north</code> must be in the interval [<code>-Pi/2</code>, <code>Pi/2</code>].\n * @exception {DeveloperError} <code>options.rectangle.south</code> must be in the interval [<code>-Pi/2</code>, <code>Pi/2</code>].\n * @exception {DeveloperError} <code>options.rectangle.east</code> must be in the interval [<code>-Pi</code>, <code>Pi</code>].\n * @exception {DeveloperError} <code>options.rectangle.west</code> must be in the interval [<code>-Pi</code>, <code>Pi</code>].\n * @exception {DeveloperError} <code>options.rectangle.north</code> must be greater than <code>options.rectangle.south</code>.\n *\n * @see RectangleGeometry#createGeometry\n *\n * @demo {@link https://sandcastle.cesium.com/index.html?src=Rectangle.html|Cesium Sandcastle Rectangle Demo}\n *\n * @example\n * // 1. create a rectangle\n * var rectangle = new Cesium.RectangleGeometry({\n *   ellipsoid : Cesium.Ellipsoid.WGS84,\n *   rectangle : Cesium.Rectangle.fromDegrees(-80.0, 39.0, -74.0, 42.0),\n *   height : 10000.0\n * });\n * var geometry = Cesium.RectangleGeometry.createGeometry(rectangle);\n *\n * // 2. create an extruded rectangle without a top\n * var rectangle = new Cesium.RectangleGeometry({\n *   ellipsoid : Cesium.Ellipsoid.WGS84,\n *   rectangle : Cesium.Rectangle.fromDegrees(-80.0, 39.0, -74.0, 42.0),\n *   height : 10000.0,\n *   extrudedHeight: 300000\n * });\n * var geometry = Cesium.RectangleGeometry.createGeometry(rectangle);\n */\nfunction RectangleGeometry(options) {\n  options = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(options, _defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n\n  var rectangle = options.rectangle;\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].validate */ .Z.validate(rectangle);\n  if (rectangle.north < rectangle.south) {\n    throw new _DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z(\n      "options.rectangle.north must be greater than or equal to options.rectangle.south"\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  var height = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(options.height, 0.0);\n  var extrudedHeight = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(options.extrudedHeight, height);\n\n  this._rectangle = _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].clone */ .Z.clone(rectangle);\n  this._granularity = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(\n    options.granularity,\n    _Math_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].RADIANS_PER_DEGREE */ .Z.RADIANS_PER_DEGREE\n  );\n  this._ellipsoid = _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].clone */ .Z.clone(\n    (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(options.ellipsoid, _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].WGS84 */ .Z.WGS84)\n  );\n  this._surfaceHeight = Math.max(height, extrudedHeight);\n  this._rotation = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(options.rotation, 0.0);\n  this._stRotation = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(options.stRotation, 0.0);\n  this._vertexFormat = _VertexFormat_js__WEBPACK_IMPORTED_MODULE_25__/* ["default"].clone */ .Z.clone(\n    (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(options.vertexFormat, _VertexFormat_js__WEBPACK_IMPORTED_MODULE_25__/* ["default"].DEFAULT */ .Z.DEFAULT)\n  );\n  this._extrudedHeight = Math.min(height, extrudedHeight);\n  this._shadowVolume = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(options.shadowVolume, false);\n  this._workerName = "createRectangleGeometry";\n  this._offsetAttribute = options.offsetAttribute;\n  this._rotatedRectangle = undefined;\n\n  this._textureCoordinateRotationPoints = undefined;\n}\n\n/**\n * The number of elements used to pack the object into an array.\n * @type {Number}\n */\nRectangleGeometry.packedLength =\n  _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].packedLength */ .Z.packedLength +\n  _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].packedLength */ .Z.packedLength +\n  _VertexFormat_js__WEBPACK_IMPORTED_MODULE_25__/* ["default"].packedLength */ .Z.packedLength +\n  7;\n\n/**\n * Stores the provided instance into the provided array.\n *\n * @param {RectangleGeometry} value The value to pack.\n * @param {Number[]} array The array to pack into.\n * @param {Number} [startingIndex=0] The index into the array at which to start packing the elements.\n *\n * @returns {Number[]} The array that was packed into\n */\nRectangleGeometry.pack = function (value, array, startingIndex) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].typeOf.object */ .Z.typeOf.object("value", value);\n  _Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].defined */ .Z.defined("array", array);\n  //>>includeEnd(\'debug\');\n\n  startingIndex = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(startingIndex, 0);\n\n  _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].pack */ .Z.pack(value._rectangle, array, startingIndex);\n  startingIndex += _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].packedLength */ .Z.packedLength;\n\n  _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].pack */ .Z.pack(value._ellipsoid, array, startingIndex);\n  startingIndex += _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].packedLength */ .Z.packedLength;\n\n  _VertexFormat_js__WEBPACK_IMPORTED_MODULE_25__/* ["default"].pack */ .Z.pack(value._vertexFormat, array, startingIndex);\n  startingIndex += _VertexFormat_js__WEBPACK_IMPORTED_MODULE_25__/* ["default"].packedLength */ .Z.packedLength;\n\n  array[startingIndex++] = value._granularity;\n  array[startingIndex++] = value._surfaceHeight;\n  array[startingIndex++] = value._rotation;\n  array[startingIndex++] = value._stRotation;\n  array[startingIndex++] = value._extrudedHeight;\n  array[startingIndex++] = value._shadowVolume ? 1.0 : 0.0;\n  array[startingIndex] = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(value._offsetAttribute, -1);\n\n  return array;\n};\n\nvar scratchRectangle = new _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z();\nvar scratchEllipsoid = _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].clone */ .Z.clone(_Ellipsoid_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].UNIT_SPHERE */ .Z.UNIT_SPHERE);\nvar scratchOptions = {\n  rectangle: scratchRectangle,\n  ellipsoid: scratchEllipsoid,\n  vertexFormat: scratchVertexFormat,\n  granularity: undefined,\n  height: undefined,\n  rotation: undefined,\n  stRotation: undefined,\n  extrudedHeight: undefined,\n  shadowVolume: undefined,\n  offsetAttribute: undefined,\n};\n\n/**\n * Retrieves an instance from a packed array.\n *\n * @param {Number[]} array The packed array.\n * @param {Number} [startingIndex=0] The starting index of the element to be unpacked.\n * @param {RectangleGeometry} [result] The object into which to store the result.\n * @returns {RectangleGeometry} The modified result parameter or a new RectangleGeometry instance if one was not provided.\n */\nRectangleGeometry.unpack = function (array, startingIndex, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].defined */ .Z.defined("array", array);\n  //>>includeEnd(\'debug\');\n\n  startingIndex = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(startingIndex, 0);\n\n  var rectangle = _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].unpack */ .Z.unpack(array, startingIndex, scratchRectangle);\n  startingIndex += _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].packedLength */ .Z.packedLength;\n\n  var ellipsoid = _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].unpack */ .Z.unpack(array, startingIndex, scratchEllipsoid);\n  startingIndex += _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].packedLength */ .Z.packedLength;\n\n  var vertexFormat = _VertexFormat_js__WEBPACK_IMPORTED_MODULE_25__/* ["default"].unpack */ .Z.unpack(\n    array,\n    startingIndex,\n    scratchVertexFormat\n  );\n  startingIndex += _VertexFormat_js__WEBPACK_IMPORTED_MODULE_25__/* ["default"].packedLength */ .Z.packedLength;\n\n  var granularity = array[startingIndex++];\n  var surfaceHeight = array[startingIndex++];\n  var rotation = array[startingIndex++];\n  var stRotation = array[startingIndex++];\n  var extrudedHeight = array[startingIndex++];\n  var shadowVolume = array[startingIndex++] === 1.0;\n  var offsetAttribute = array[startingIndex];\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(result)) {\n    scratchOptions.granularity = granularity;\n    scratchOptions.height = surfaceHeight;\n    scratchOptions.rotation = rotation;\n    scratchOptions.stRotation = stRotation;\n    scratchOptions.extrudedHeight = extrudedHeight;\n    scratchOptions.shadowVolume = shadowVolume;\n    scratchOptions.offsetAttribute =\n      offsetAttribute === -1 ? undefined : offsetAttribute;\n\n    return new RectangleGeometry(scratchOptions);\n  }\n\n  result._rectangle = _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].clone */ .Z.clone(rectangle, result._rectangle);\n  result._ellipsoid = _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].clone */ .Z.clone(ellipsoid, result._ellipsoid);\n  result._vertexFormat = _VertexFormat_js__WEBPACK_IMPORTED_MODULE_25__/* ["default"].clone */ .Z.clone(vertexFormat, result._vertexFormat);\n  result._granularity = granularity;\n  result._surfaceHeight = surfaceHeight;\n  result._rotation = rotation;\n  result._stRotation = stRotation;\n  result._extrudedHeight = extrudedHeight;\n  result._shadowVolume = shadowVolume;\n  result._offsetAttribute =\n    offsetAttribute === -1 ? undefined : offsetAttribute;\n\n  return result;\n};\n\n/**\n * Computes the bounding rectangle based on the provided options\n *\n * @param {Object} options Object with the following properties:\n * @param {Rectangle} options.rectangle A cartographic rectangle with north, south, east and west properties in radians.\n * @param {Ellipsoid} [options.ellipsoid=Ellipsoid.WGS84] The ellipsoid on which the rectangle lies.\n * @param {Number} [options.granularity=CesiumMath.RADIANS_PER_DEGREE] The distance, in radians, between each latitude and longitude. Determines the number of positions in the buffer.\n * @param {Number} [options.rotation=0.0] The rotation of the rectangle, in radians. A positive rotation is counter-clockwise.\n * @param {Rectangle} [result] An object in which to store the result.\n *\n * @returns {Rectangle} The result rectangle\n */\nRectangleGeometry.computeRectangle = function (options, result) {\n  options = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(options, _defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n\n  var rectangle = options.rectangle;\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].typeOf.object */ .Z.typeOf.object("rectangle", rectangle);\n  _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].validate */ .Z.validate(rectangle);\n  if (rectangle.north < rectangle.south) {\n    throw new _DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z(\n      "options.rectangle.north must be greater than or equal to options.rectangle.south"\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  var granularity = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(\n    options.granularity,\n    _Math_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].RADIANS_PER_DEGREE */ .Z.RADIANS_PER_DEGREE\n  );\n  var ellipsoid = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(options.ellipsoid, _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].WGS84 */ .Z.WGS84);\n  var rotation = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(options.rotation, 0.0);\n\n  return computeRectangle(rectangle, granularity, rotation, ellipsoid, result);\n};\n\nvar tangentRotationMatrixScratch = new _Matrix3_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z();\nvar quaternionScratch = new _Quaternion_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z();\nvar centerScratch = new _Cartographic_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\n/**\n * Computes the geometric representation of a rectangle, including its vertices, indices, and a bounding sphere.\n *\n * @param {RectangleGeometry} rectangleGeometry A description of the rectangle.\n * @returns {Geometry|undefined} The computed vertices and indices.\n *\n * @exception {DeveloperError} Rotated rectangle is invalid.\n */\nRectangleGeometry.createGeometry = function (rectangleGeometry) {\n  if (\n    _Math_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].equalsEpsilon */ .Z.equalsEpsilon(\n      rectangleGeometry._rectangle.north,\n      rectangleGeometry._rectangle.south,\n      _Math_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].EPSILON10 */ .Z.EPSILON10\n    ) ||\n    _Math_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].equalsEpsilon */ .Z.equalsEpsilon(\n      rectangleGeometry._rectangle.east,\n      rectangleGeometry._rectangle.west,\n      _Math_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].EPSILON10 */ .Z.EPSILON10\n    )\n  ) {\n    return undefined;\n  }\n\n  var rectangle = rectangleGeometry._rectangle;\n  var ellipsoid = rectangleGeometry._ellipsoid;\n  var rotation = rectangleGeometry._rotation;\n  var stRotation = rectangleGeometry._stRotation;\n  var vertexFormat = rectangleGeometry._vertexFormat;\n\n  var computedOptions = _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].computeOptions */ .Z.computeOptions(\n    rectangle,\n    rectangleGeometry._granularity,\n    rotation,\n    stRotation,\n    rectangleScratch,\n    nwScratch,\n    stNwScratch\n  );\n\n  var tangentRotationMatrix = tangentRotationMatrixScratch;\n  if (stRotation !== 0 || rotation !== 0) {\n    var center = _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].center */ .Z.center(rectangle, centerScratch);\n    var axis = ellipsoid.geodeticSurfaceNormalCartographic(center, v1Scratch);\n    _Quaternion_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].fromAxisAngle */ .Z.fromAxisAngle(axis, -stRotation, quaternionScratch);\n    _Matrix3_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].fromQuaternion */ .Z.fromQuaternion(quaternionScratch, tangentRotationMatrix);\n  } else {\n    _Matrix3_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].clone */ .Z.clone(_Matrix3_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].IDENTITY */ .Z.IDENTITY, tangentRotationMatrix);\n  }\n\n  var surfaceHeight = rectangleGeometry._surfaceHeight;\n  var extrudedHeight = rectangleGeometry._extrudedHeight;\n  var extrude = !_Math_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].equalsEpsilon */ .Z.equalsEpsilon(\n    surfaceHeight,\n    extrudedHeight,\n    0,\n    _Math_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].EPSILON2 */ .Z.EPSILON2\n  );\n\n  computedOptions.lonScalar = 1.0 / rectangleGeometry._rectangle.width;\n  computedOptions.latScalar = 1.0 / rectangleGeometry._rectangle.height;\n  computedOptions.tangentRotationMatrix = tangentRotationMatrix;\n\n  var geometry;\n  var boundingSphere;\n  rectangle = rectangleGeometry._rectangle;\n  if (extrude) {\n    geometry = constructExtrudedRectangle(rectangleGeometry, computedOptions);\n    var topBS = _BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].fromRectangle3D */ .Z.fromRectangle3D(\n      rectangle,\n      ellipsoid,\n      surfaceHeight,\n      topBoundingSphere\n    );\n    var bottomBS = _BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].fromRectangle3D */ .Z.fromRectangle3D(\n      rectangle,\n      ellipsoid,\n      extrudedHeight,\n      bottomBoundingSphere\n    );\n    boundingSphere = _BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].union */ .Z.union(topBS, bottomBS);\n  } else {\n    geometry = constructRectangle(rectangleGeometry, computedOptions);\n    geometry.attributes.position.values = _PolygonPipeline_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"].scaleToGeodeticHeight */ .Z.scaleToGeodeticHeight(\n      geometry.attributes.position.values,\n      surfaceHeight,\n      ellipsoid,\n      false\n    );\n\n    if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(rectangleGeometry._offsetAttribute)) {\n      var length = geometry.attributes.position.values.length;\n      var applyOffset = new Uint8Array(length / 3);\n      var offsetValue =\n        rectangleGeometry._offsetAttribute === _GeometryOffsetAttribute_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].NONE */ .Z.NONE\n          ? 0\n          : 1;\n      (0,_arrayFill_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(applyOffset, offsetValue);\n      geometry.attributes.applyOffset = new _GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z({\n        componentDatatype: _ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].UNSIGNED_BYTE */ .Z.UNSIGNED_BYTE,\n        componentsPerAttribute: 1,\n        values: applyOffset,\n      });\n    }\n\n    boundingSphere = _BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].fromRectangle3D */ .Z.fromRectangle3D(\n      rectangle,\n      ellipsoid,\n      surfaceHeight\n    );\n  }\n\n  if (!vertexFormat.position) {\n    delete geometry.attributes.position;\n  }\n\n  return new _Geometry_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z({\n    attributes: geometry.attributes,\n    indices: geometry.indices,\n    primitiveType: geometry.primitiveType,\n    boundingSphere: boundingSphere,\n    offsetAttribute: rectangleGeometry._offsetAttribute,\n  });\n};\n\n/**\n * @private\n */\nRectangleGeometry.createShadowVolume = function (\n  rectangleGeometry,\n  minHeightFunc,\n  maxHeightFunc\n) {\n  var granularity = rectangleGeometry._granularity;\n  var ellipsoid = rectangleGeometry._ellipsoid;\n\n  var minHeight = minHeightFunc(granularity, ellipsoid);\n  var maxHeight = maxHeightFunc(granularity, ellipsoid);\n\n  return new RectangleGeometry({\n    rectangle: rectangleGeometry._rectangle,\n    rotation: rectangleGeometry._rotation,\n    ellipsoid: ellipsoid,\n    stRotation: rectangleGeometry._stRotation,\n    granularity: granularity,\n    extrudedHeight: maxHeight,\n    height: minHeight,\n    vertexFormat: _VertexFormat_js__WEBPACK_IMPORTED_MODULE_25__/* ["default"].POSITION_ONLY */ .Z.POSITION_ONLY,\n    shadowVolume: true,\n  });\n};\n\nvar unrotatedTextureRectangleScratch = new _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z();\nvar points2DScratch = [new _Cartesian2_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(), new _Cartesian2_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(), new _Cartesian2_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z()];\nvar rotation2DScratch = new _Matrix2_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z();\nvar rectangleCenterScratch = new _Cartographic_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\n\nfunction textureCoordinateRotationPoints(rectangleGeometry) {\n  if (rectangleGeometry._stRotation === 0.0) {\n    return [0, 0, 0, 1, 1, 0];\n  }\n\n  var rectangle = _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].clone */ .Z.clone(\n    rectangleGeometry._rectangle,\n    unrotatedTextureRectangleScratch\n  );\n  var granularity = rectangleGeometry._granularity;\n  var ellipsoid = rectangleGeometry._ellipsoid;\n\n  // Rotate to align the texture coordinates with ENU\n  var rotation = rectangleGeometry._rotation - rectangleGeometry._stRotation;\n\n  var unrotatedTextureRectangle = computeRectangle(\n    rectangle,\n    granularity,\n    rotation,\n    ellipsoid,\n    unrotatedTextureRectangleScratch\n  );\n\n  // Assume a computed "east-north" texture coordinate system based on spherical or planar tricks, bounded by `boundingRectangle`.\n  // The "desired" texture coordinate system forms an oriented rectangle (un-oriented computed) around the geometry that completely and tightly bounds it.\n  // We want to map from the "east-north" texture coordinate system into the "desired" system using a pair of lines (analagous planes in 2D)\n  // Compute 3 corners of the "desired" texture coordinate system in "east-north" texture space by the following in cartographic space:\n  // - rotate 3 of the corners in unrotatedTextureRectangle by stRotation around the center of the bounding rectangle\n  // - apply the "east-north" system\'s normalization formula to the rotated cartographics, even though this is likely to produce values outside [0-1].\n  // This gives us a set of points in the "east-north" texture coordinate system that can be used to map "east-north" texture coordinates to "desired."\n\n  var points2D = points2DScratch;\n  points2D[0].x = unrotatedTextureRectangle.west;\n  points2D[0].y = unrotatedTextureRectangle.south;\n\n  points2D[1].x = unrotatedTextureRectangle.west;\n  points2D[1].y = unrotatedTextureRectangle.north;\n\n  points2D[2].x = unrotatedTextureRectangle.east;\n  points2D[2].y = unrotatedTextureRectangle.south;\n\n  var boundingRectangle = rectangleGeometry.rectangle;\n  var toDesiredInComputed = _Matrix2_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].fromRotation */ .Z.fromRotation(\n    rectangleGeometry._stRotation,\n    rotation2DScratch\n  );\n  var boundingRectangleCenter = _Rectangle_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].center */ .Z.center(\n    boundingRectangle,\n    rectangleCenterScratch\n  );\n\n  for (var i = 0; i < 3; ++i) {\n    var point2D = points2D[i];\n    point2D.x -= boundingRectangleCenter.longitude;\n    point2D.y -= boundingRectangleCenter.latitude;\n    _Matrix2_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].multiplyByVector */ .Z.multiplyByVector(toDesiredInComputed, point2D, point2D);\n    point2D.x += boundingRectangleCenter.longitude;\n    point2D.y += boundingRectangleCenter.latitude;\n\n    // Convert point into east-north texture coordinate space\n    point2D.x = (point2D.x - boundingRectangle.west) / boundingRectangle.width;\n    point2D.y =\n      (point2D.y - boundingRectangle.south) / boundingRectangle.height;\n  }\n\n  var minXYCorner = points2D[0];\n  var maxYCorner = points2D[1];\n  var maxXCorner = points2D[2];\n  var result = new Array(6);\n  _Cartesian2_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].pack */ .Z.pack(minXYCorner, result);\n  _Cartesian2_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].pack */ .Z.pack(maxYCorner, result, 2);\n  _Cartesian2_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].pack */ .Z.pack(maxXCorner, result, 4);\n  return result;\n}\n\nObject.defineProperties(RectangleGeometry.prototype, {\n  /**\n   * @private\n   */\n  rectangle: {\n    get: function () {\n      if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(this._rotatedRectangle)) {\n        this._rotatedRectangle = computeRectangle(\n          this._rectangle,\n          this._granularity,\n          this._rotation,\n          this._ellipsoid\n        );\n      }\n      return this._rotatedRectangle;\n    },\n  },\n  /**\n   * For remapping texture coordinates when rendering RectangleGeometries as GroundPrimitives.\n   * This version permits skew in textures by computing offsets directly in cartographic space and\n   * more accurately approximates rendering RectangleGeometries with height as standard Primitives.\n   * @see Geometry#_textureCoordinateRotationPoints\n   * @private\n   */\n  textureCoordinateRotationPoints: {\n    get: function () {\n      if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(this._textureCoordinateRotationPoints)) {\n        this._textureCoordinateRotationPoints = textureCoordinateRotationPoints(\n          this\n        );\n      }\n      return this._textureCoordinateRotationPoints;\n    },\n  },\n});\n/* harmony default export */ __webpack_exports__["Z"] = (RectangleGeometry);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QW9CO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyw2RUFBZ0I7QUFDaEQ7QUFDQTtBQUNBOztBQUVBLGtCQUFrQixPQUFPO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLElBQUksK0ZBQXdCO0FBQzVCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUUseUVBQWU7QUFDakIsRUFBRSx5RUFBZTtBQUNqQixFQUFFLHlFQUFlO0FBQ2pCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxpRUFBTztBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLGlFQUFPO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNILENBQUM7QUFDRCx5REFBZSxpQkFBaUIsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9Db3JlL1JlY3RhbmdsZUdlb21ldHJ5LmpzP2JhZTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGFycmF5RmlsbCBmcm9tIFwiLi9hcnJheUZpbGwuanNcIjtcbmltcG9ydCBCb3VuZGluZ1NwaGVyZSBmcm9tIFwiLi9Cb3VuZGluZ1NwaGVyZS5qc1wiO1xuaW1wb3J0IENhcnRlc2lhbjIgZnJvbSBcIi4vQ2FydGVzaWFuMi5qc1wiO1xuaW1wb3J0IENhcnRlc2lhbjMgZnJvbSBcIi4vQ2FydGVzaWFuMy5qc1wiO1xuaW1wb3J0IENhcnRvZ3JhcGhpYyBmcm9tIFwiLi9DYXJ0b2dyYXBoaWMuanNcIjtcbmltcG9ydCBDaGVjayBmcm9tIFwiLi9DaGVjay5qc1wiO1xuaW1wb3J0IENvbXBvbmVudERhdGF0eXBlIGZyb20gXCIuL0NvbXBvbmVudERhdGF0eXBlLmpzXCI7XG5pbXBvcnQgZGVmYXVsdFZhbHVlIGZyb20gXCIuL2RlZmF1bHRWYWx1ZS5qc1wiO1xuaW1wb3J0IGRlZmluZWQgZnJvbSBcIi4vZGVmaW5lZC5qc1wiO1xuaW1wb3J0IERldmVsb3BlckVycm9yIGZyb20gXCIuL0RldmVsb3BlckVycm9yLmpzXCI7XG5pbXBvcnQgRWxsaXBzb2lkIGZyb20gXCIuL0VsbGlwc29pZC5qc1wiO1xuaW1wb3J0IEdlb21ldHJ5IGZyb20gXCIuL0dlb21ldHJ5LmpzXCI7XG5pbXBvcnQgR2VvbWV0cnlBdHRyaWJ1dGUgZnJvbSBcIi4vR2VvbWV0cnlBdHRyaWJ1dGUuanNcIjtcbmltcG9ydCBHZW9tZXRyeUF0dHJpYnV0ZXMgZnJvbSBcIi4vR2VvbWV0cnlBdHRyaWJ1dGVzLmpzXCI7XG5pbXBvcnQgR2VvbWV0cnlJbnN0YW5jZSBmcm9tIFwiLi9HZW9tZXRyeUluc3RhbmNlLmpzXCI7XG5pbXBvcnQgR2VvbWV0cnlPZmZzZXRBdHRyaWJ1dGUgZnJvbSBcIi4vR2VvbWV0cnlPZmZzZXRBdHRyaWJ1dGUuanNcIjtcbmltcG9ydCBHZW9tZXRyeVBpcGVsaW5lIGZyb20gXCIuL0dlb21ldHJ5UGlwZWxpbmUuanNcIjtcbmltcG9ydCBJbmRleERhdGF0eXBlIGZyb20gXCIuL0luZGV4RGF0YXR5cGUuanNcIjtcbmltcG9ydCBDZXNpdW1NYXRoIGZyb20gXCIuL01hdGguanNcIjtcbmltcG9ydCBNYXRyaXgyIGZyb20gXCIuL01hdHJpeDIuanNcIjtcbmltcG9ydCBNYXRyaXgzIGZyb20gXCIuL01hdHJpeDMuanNcIjtcbmltcG9ydCBQb2x5Z29uUGlwZWxpbmUgZnJvbSBcIi4vUG9seWdvblBpcGVsaW5lLmpzXCI7XG5pbXBvcnQgUHJpbWl0aXZlVHlwZSBmcm9tIFwiLi9QcmltaXRpdmVUeXBlLmpzXCI7XG5pbXBvcnQgUXVhdGVybmlvbiBmcm9tIFwiLi9RdWF0ZXJuaW9uLmpzXCI7XG5pbXBvcnQgUmVjdGFuZ2xlIGZyb20gXCIuL1JlY3RhbmdsZS5qc1wiO1xuaW1wb3J0IFJlY3RhbmdsZUdlb21ldHJ5TGlicmFyeSBmcm9tIFwiLi9SZWN0YW5nbGVHZW9tZXRyeUxpYnJhcnkuanNcIjtcbmltcG9ydCBWZXJ0ZXhGb3JtYXQgZnJvbSBcIi4vVmVydGV4Rm9ybWF0LmpzXCI7XG5cbnZhciBwb3NpdGlvblNjcmF0Y2ggPSBuZXcgQ2FydGVzaWFuMygpO1xudmFyIG5vcm1hbFNjcmF0Y2ggPSBuZXcgQ2FydGVzaWFuMygpO1xudmFyIHRhbmdlbnRTY3JhdGNoID0gbmV3IENhcnRlc2lhbjMoKTtcbnZhciBiaXRhbmdlbnRTY3JhdGNoID0gbmV3IENhcnRlc2lhbjMoKTtcbnZhciByZWN0YW5nbGVTY3JhdGNoID0gbmV3IFJlY3RhbmdsZSgpO1xudmFyIHN0U2NyYXRjaCA9IG5ldyBDYXJ0ZXNpYW4yKCk7XG52YXIgYm90dG9tQm91bmRpbmdTcGhlcmUgPSBuZXcgQm91bmRpbmdTcGhlcmUoKTtcbnZhciB0b3BCb3VuZGluZ1NwaGVyZSA9IG5ldyBCb3VuZGluZ1NwaGVyZSgpO1xuXG5mdW5jdGlvbiBjcmVhdGVBdHRyaWJ1dGVzKHZlcnRleEZvcm1hdCwgYXR0cmlidXRlcykge1xuICB2YXIgZ2VvID0gbmV3IEdlb21ldHJ5KHtcbiAgICBhdHRyaWJ1dGVzOiBuZXcgR2VvbWV0cnlBdHRyaWJ1dGVzKCksXG4gICAgcHJpbWl0aXZlVHlwZTogUHJpbWl0aXZlVHlwZS5UUklBTkdMRVMsXG4gIH0pO1xuXG4gIGdlby5hdHRyaWJ1dGVzLnBvc2l0aW9uID0gbmV3IEdlb21ldHJ5QXR0cmlidXRlKHtcbiAgICBjb21wb25lbnREYXRhdHlwZTogQ29tcG9uZW50RGF0YXR5cGUuRE9VQkxFLFxuICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGU6IDMsXG4gICAgdmFsdWVzOiBhdHRyaWJ1dGVzLnBvc2l0aW9ucyxcbiAgfSk7XG4gIGlmICh2ZXJ0ZXhGb3JtYXQubm9ybWFsKSB7XG4gICAgZ2VvLmF0dHJpYnV0ZXMubm9ybWFsID0gbmV3IEdlb21ldHJ5QXR0cmlidXRlKHtcbiAgICAgIGNvbXBvbmVudERhdGF0eXBlOiBDb21wb25lbnREYXRhdHlwZS5GTE9BVCxcbiAgICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGU6IDMsXG4gICAgICB2YWx1ZXM6IGF0dHJpYnV0ZXMubm9ybWFscyxcbiAgICB9KTtcbiAgfVxuICBpZiAodmVydGV4Rm9ybWF0LnRhbmdlbnQpIHtcbiAgICBnZW8uYXR0cmlidXRlcy50YW5nZW50ID0gbmV3IEdlb21ldHJ5QXR0cmlidXRlKHtcbiAgICAgIGNvbXBvbmVudERhdGF0eXBlOiBDb21wb25lbnREYXRhdHlwZS5GTE9BVCxcbiAgICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGU6IDMsXG4gICAgICB2YWx1ZXM6IGF0dHJpYnV0ZXMudGFuZ2VudHMsXG4gICAgfSk7XG4gIH1cbiAgaWYgKHZlcnRleEZvcm1hdC5iaXRhbmdlbnQpIHtcbiAgICBnZW8uYXR0cmlidXRlcy5iaXRhbmdlbnQgPSBuZXcgR2VvbWV0cnlBdHRyaWJ1dGUoe1xuICAgICAgY29tcG9uZW50RGF0YXR5cGU6IENvbXBvbmVudERhdGF0eXBlLkZMT0FULFxuICAgICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogMyxcbiAgICAgIHZhbHVlczogYXR0cmlidXRlcy5iaXRhbmdlbnRzLFxuICAgIH0pO1xuICB9XG4gIHJldHVybiBnZW87XG59XG5cbmZ1bmN0aW9uIGNhbGN1bGF0ZUF0dHJpYnV0ZXMoXG4gIHBvc2l0aW9ucyxcbiAgdmVydGV4Rm9ybWF0LFxuICBlbGxpcHNvaWQsXG4gIHRhbmdlbnRSb3RhdGlvbk1hdHJpeFxuKSB7XG4gIHZhciBsZW5ndGggPSBwb3NpdGlvbnMubGVuZ3RoO1xuXG4gIHZhciBub3JtYWxzID0gdmVydGV4Rm9ybWF0Lm5vcm1hbCA/IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKSA6IHVuZGVmaW5lZDtcbiAgdmFyIHRhbmdlbnRzID0gdmVydGV4Rm9ybWF0LnRhbmdlbnQgPyBuZXcgRmxvYXQzMkFycmF5KGxlbmd0aCkgOiB1bmRlZmluZWQ7XG4gIHZhciBiaXRhbmdlbnRzID0gdmVydGV4Rm9ybWF0LmJpdGFuZ2VudFxuICAgID8gbmV3IEZsb2F0MzJBcnJheShsZW5ndGgpXG4gICAgOiB1bmRlZmluZWQ7XG5cbiAgdmFyIGF0dHJJbmRleCA9IDA7XG4gIHZhciBiaXRhbmdlbnQgPSBiaXRhbmdlbnRTY3JhdGNoO1xuICB2YXIgdGFuZ2VudCA9IHRhbmdlbnRTY3JhdGNoO1xuICB2YXIgbm9ybWFsID0gbm9ybWFsU2NyYXRjaDtcbiAgaWYgKHZlcnRleEZvcm1hdC5ub3JtYWwgfHwgdmVydGV4Rm9ybWF0LnRhbmdlbnQgfHwgdmVydGV4Rm9ybWF0LmJpdGFuZ2VudCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDMpIHtcbiAgICAgIHZhciBwID0gQ2FydGVzaWFuMy5mcm9tQXJyYXkocG9zaXRpb25zLCBpLCBwb3NpdGlvblNjcmF0Y2gpO1xuICAgICAgdmFyIGF0dHJJbmRleDEgPSBhdHRySW5kZXggKyAxO1xuICAgICAgdmFyIGF0dHJJbmRleDIgPSBhdHRySW5kZXggKyAyO1xuXG4gICAgICBub3JtYWwgPSBlbGxpcHNvaWQuZ2VvZGV0aWNTdXJmYWNlTm9ybWFsKHAsIG5vcm1hbCk7XG4gICAgICBpZiAodmVydGV4Rm9ybWF0LnRhbmdlbnQgfHwgdmVydGV4Rm9ybWF0LmJpdGFuZ2VudCkge1xuICAgICAgICBDYXJ0ZXNpYW4zLmNyb3NzKENhcnRlc2lhbjMuVU5JVF9aLCBub3JtYWwsIHRhbmdlbnQpO1xuICAgICAgICBNYXRyaXgzLm11bHRpcGx5QnlWZWN0b3IodGFuZ2VudFJvdGF0aW9uTWF0cml4LCB0YW5nZW50LCB0YW5nZW50KTtcbiAgICAgICAgQ2FydGVzaWFuMy5ub3JtYWxpemUodGFuZ2VudCwgdGFuZ2VudCk7XG5cbiAgICAgICAgaWYgKHZlcnRleEZvcm1hdC5iaXRhbmdlbnQpIHtcbiAgICAgICAgICBDYXJ0ZXNpYW4zLm5vcm1hbGl6ZShcbiAgICAgICAgICAgIENhcnRlc2lhbjMuY3Jvc3Mobm9ybWFsLCB0YW5nZW50LCBiaXRhbmdlbnQpLFxuICAgICAgICAgICAgYml0YW5nZW50XG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAodmVydGV4Rm9ybWF0Lm5vcm1hbCkge1xuICAgICAgICBub3JtYWxzW2F0dHJJbmRleF0gPSBub3JtYWwueDtcbiAgICAgICAgbm9ybWFsc1thdHRySW5kZXgxXSA9IG5vcm1hbC55O1xuICAgICAgICBub3JtYWxzW2F0dHJJbmRleDJdID0gbm9ybWFsLno7XG4gICAgICB9XG4gICAgICBpZiAodmVydGV4Rm9ybWF0LnRhbmdlbnQpIHtcbiAgICAgICAgdGFuZ2VudHNbYXR0ckluZGV4XSA9IHRhbmdlbnQueDtcbiAgICAgICAgdGFuZ2VudHNbYXR0ckluZGV4MV0gPSB0YW5nZW50Lnk7XG4gICAgICAgIHRhbmdlbnRzW2F0dHJJbmRleDJdID0gdGFuZ2VudC56O1xuICAgICAgfVxuICAgICAgaWYgKHZlcnRleEZvcm1hdC5iaXRhbmdlbnQpIHtcbiAgICAgICAgYml0YW5nZW50c1thdHRySW5kZXhdID0gYml0YW5nZW50Lng7XG4gICAgICAgIGJpdGFuZ2VudHNbYXR0ckluZGV4MV0gPSBiaXRhbmdlbnQueTtcbiAgICAgICAgYml0YW5nZW50c1thdHRySW5kZXgyXSA9IGJpdGFuZ2VudC56O1xuICAgICAgfVxuICAgICAgYXR0ckluZGV4ICs9IDM7XG4gICAgfVxuICB9XG4gIHJldHVybiBjcmVhdGVBdHRyaWJ1dGVzKHZlcnRleEZvcm1hdCwge1xuICAgIHBvc2l0aW9uczogcG9zaXRpb25zLFxuICAgIG5vcm1hbHM6IG5vcm1hbHMsXG4gICAgdGFuZ2VudHM6IHRhbmdlbnRzLFxuICAgIGJpdGFuZ2VudHM6IGJpdGFuZ2VudHMsXG4gIH0pO1xufVxuXG52YXIgdjFTY3JhdGNoID0gbmV3IENhcnRlc2lhbjMoKTtcbnZhciB2MlNjcmF0Y2ggPSBuZXcgQ2FydGVzaWFuMygpO1xuXG5mdW5jdGlvbiBjYWxjdWxhdGVBdHRyaWJ1dGVzV2FsbChwb3NpdGlvbnMsIHZlcnRleEZvcm1hdCwgZWxsaXBzb2lkKSB7XG4gIHZhciBsZW5ndGggPSBwb3NpdGlvbnMubGVuZ3RoO1xuXG4gIHZhciBub3JtYWxzID0gdmVydGV4Rm9ybWF0Lm5vcm1hbCA/IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKSA6IHVuZGVmaW5lZDtcbiAgdmFyIHRhbmdlbnRzID0gdmVydGV4Rm9ybWF0LnRhbmdlbnQgPyBuZXcgRmxvYXQzMkFycmF5KGxlbmd0aCkgOiB1bmRlZmluZWQ7XG4gIHZhciBiaXRhbmdlbnRzID0gdmVydGV4Rm9ybWF0LmJpdGFuZ2VudFxuICAgID8gbmV3IEZsb2F0MzJBcnJheShsZW5ndGgpXG4gICAgOiB1bmRlZmluZWQ7XG5cbiAgdmFyIG5vcm1hbEluZGV4ID0gMDtcbiAgdmFyIHRhbmdlbnRJbmRleCA9IDA7XG4gIHZhciBiaXRhbmdlbnRJbmRleCA9IDA7XG4gIHZhciByZWNvbXB1dGVOb3JtYWwgPSB0cnVlO1xuXG4gIHZhciBiaXRhbmdlbnQgPSBiaXRhbmdlbnRTY3JhdGNoO1xuICB2YXIgdGFuZ2VudCA9IHRhbmdlbnRTY3JhdGNoO1xuICB2YXIgbm9ybWFsID0gbm9ybWFsU2NyYXRjaDtcbiAgaWYgKHZlcnRleEZvcm1hdC5ub3JtYWwgfHwgdmVydGV4Rm9ybWF0LnRhbmdlbnQgfHwgdmVydGV4Rm9ybWF0LmJpdGFuZ2VudCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDYpIHtcbiAgICAgIHZhciBwID0gQ2FydGVzaWFuMy5mcm9tQXJyYXkocG9zaXRpb25zLCBpLCBwb3NpdGlvblNjcmF0Y2gpO1xuICAgICAgdmFyIHAxID0gQ2FydGVzaWFuMy5mcm9tQXJyYXkocG9zaXRpb25zLCAoaSArIDYpICUgbGVuZ3RoLCB2MVNjcmF0Y2gpO1xuICAgICAgaWYgKHJlY29tcHV0ZU5vcm1hbCkge1xuICAgICAgICB2YXIgcDIgPSBDYXJ0ZXNpYW4zLmZyb21BcnJheShwb3NpdGlvbnMsIChpICsgMykgJSBsZW5ndGgsIHYyU2NyYXRjaCk7XG4gICAgICAgIENhcnRlc2lhbjMuc3VidHJhY3QocDEsIHAsIHAxKTtcbiAgICAgICAgQ2FydGVzaWFuMy5zdWJ0cmFjdChwMiwgcCwgcDIpO1xuICAgICAgICBub3JtYWwgPSBDYXJ0ZXNpYW4zLm5vcm1hbGl6ZShDYXJ0ZXNpYW4zLmNyb3NzKHAyLCBwMSwgbm9ybWFsKSwgbm9ybWFsKTtcbiAgICAgICAgcmVjb21wdXRlTm9ybWFsID0gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGlmIChDYXJ0ZXNpYW4zLmVxdWFsc0Vwc2lsb24ocDEsIHAsIENlc2l1bU1hdGguRVBTSUxPTjEwKSkge1xuICAgICAgICAvLyBpZiB3ZSd2ZSByZWFjaGVkIGEgY29ybmVyXG4gICAgICAgIHJlY29tcHV0ZU5vcm1hbCA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIGlmICh2ZXJ0ZXhGb3JtYXQudGFuZ2VudCB8fCB2ZXJ0ZXhGb3JtYXQuYml0YW5nZW50KSB7XG4gICAgICAgIGJpdGFuZ2VudCA9IGVsbGlwc29pZC5nZW9kZXRpY1N1cmZhY2VOb3JtYWwocCwgYml0YW5nZW50KTtcbiAgICAgICAgaWYgKHZlcnRleEZvcm1hdC50YW5nZW50KSB7XG4gICAgICAgICAgdGFuZ2VudCA9IENhcnRlc2lhbjMubm9ybWFsaXplKFxuICAgICAgICAgICAgQ2FydGVzaWFuMy5jcm9zcyhiaXRhbmdlbnQsIG5vcm1hbCwgdGFuZ2VudCksXG4gICAgICAgICAgICB0YW5nZW50XG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAodmVydGV4Rm9ybWF0Lm5vcm1hbCkge1xuICAgICAgICBub3JtYWxzW25vcm1hbEluZGV4KytdID0gbm9ybWFsLng7XG4gICAgICAgIG5vcm1hbHNbbm9ybWFsSW5kZXgrK10gPSBub3JtYWwueTtcbiAgICAgICAgbm9ybWFsc1tub3JtYWxJbmRleCsrXSA9IG5vcm1hbC56O1xuICAgICAgICBub3JtYWxzW25vcm1hbEluZGV4KytdID0gbm9ybWFsLng7XG4gICAgICAgIG5vcm1hbHNbbm9ybWFsSW5kZXgrK10gPSBub3JtYWwueTtcbiAgICAgICAgbm9ybWFsc1tub3JtYWxJbmRleCsrXSA9IG5vcm1hbC56O1xuICAgICAgfVxuXG4gICAgICBpZiAodmVydGV4Rm9ybWF0LnRhbmdlbnQpIHtcbiAgICAgICAgdGFuZ2VudHNbdGFuZ2VudEluZGV4KytdID0gdGFuZ2VudC54O1xuICAgICAgICB0YW5nZW50c1t0YW5nZW50SW5kZXgrK10gPSB0YW5nZW50Lnk7XG4gICAgICAgIHRhbmdlbnRzW3RhbmdlbnRJbmRleCsrXSA9IHRhbmdlbnQuejtcbiAgICAgICAgdGFuZ2VudHNbdGFuZ2VudEluZGV4KytdID0gdGFuZ2VudC54O1xuICAgICAgICB0YW5nZW50c1t0YW5nZW50SW5kZXgrK10gPSB0YW5nZW50Lnk7XG4gICAgICAgIHRhbmdlbnRzW3RhbmdlbnRJbmRleCsrXSA9IHRhbmdlbnQuejtcbiAgICAgIH1cblxuICAgICAgaWYgKHZlcnRleEZvcm1hdC5iaXRhbmdlbnQpIHtcbiAgICAgICAgYml0YW5nZW50c1tiaXRhbmdlbnRJbmRleCsrXSA9IGJpdGFuZ2VudC54O1xuICAgICAgICBiaXRhbmdlbnRzW2JpdGFuZ2VudEluZGV4KytdID0gYml0YW5nZW50Lnk7XG4gICAgICAgIGJpdGFuZ2VudHNbYml0YW5nZW50SW5kZXgrK10gPSBiaXRhbmdlbnQuejtcbiAgICAgICAgYml0YW5nZW50c1tiaXRhbmdlbnRJbmRleCsrXSA9IGJpdGFuZ2VudC54O1xuICAgICAgICBiaXRhbmdlbnRzW2JpdGFuZ2VudEluZGV4KytdID0gYml0YW5nZW50Lnk7XG4gICAgICAgIGJpdGFuZ2VudHNbYml0YW5nZW50SW5kZXgrK10gPSBiaXRhbmdlbnQuejtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gY3JlYXRlQXR0cmlidXRlcyh2ZXJ0ZXhGb3JtYXQsIHtcbiAgICBwb3NpdGlvbnM6IHBvc2l0aW9ucyxcbiAgICBub3JtYWxzOiBub3JtYWxzLFxuICAgIHRhbmdlbnRzOiB0YW5nZW50cyxcbiAgICBiaXRhbmdlbnRzOiBiaXRhbmdlbnRzLFxuICB9KTtcbn1cblxuZnVuY3Rpb24gY29uc3RydWN0UmVjdGFuZ2xlKHJlY3RhbmdsZUdlb21ldHJ5LCBjb21wdXRlZE9wdGlvbnMpIHtcbiAgdmFyIHZlcnRleEZvcm1hdCA9IHJlY3RhbmdsZUdlb21ldHJ5Ll92ZXJ0ZXhGb3JtYXQ7XG4gIHZhciBlbGxpcHNvaWQgPSByZWN0YW5nbGVHZW9tZXRyeS5fZWxsaXBzb2lkO1xuICB2YXIgaGVpZ2h0ID0gY29tcHV0ZWRPcHRpb25zLmhlaWdodDtcbiAgdmFyIHdpZHRoID0gY29tcHV0ZWRPcHRpb25zLndpZHRoO1xuICB2YXIgbm9ydGhDYXAgPSBjb21wdXRlZE9wdGlvbnMubm9ydGhDYXA7XG4gIHZhciBzb3V0aENhcCA9IGNvbXB1dGVkT3B0aW9ucy5zb3V0aENhcDtcblxuICB2YXIgcm93U3RhcnQgPSAwO1xuICB2YXIgcm93RW5kID0gaGVpZ2h0O1xuICB2YXIgcm93SGVpZ2h0ID0gaGVpZ2h0O1xuICB2YXIgc2l6ZSA9IDA7XG4gIGlmIChub3J0aENhcCkge1xuICAgIHJvd1N0YXJ0ID0gMTtcbiAgICByb3dIZWlnaHQgLT0gMTtcbiAgICBzaXplICs9IDE7XG4gIH1cbiAgaWYgKHNvdXRoQ2FwKSB7XG4gICAgcm93RW5kIC09IDE7XG4gICAgcm93SGVpZ2h0IC09IDE7XG4gICAgc2l6ZSArPSAxO1xuICB9XG4gIHNpemUgKz0gd2lkdGggKiByb3dIZWlnaHQ7XG5cbiAgdmFyIHBvc2l0aW9ucyA9IHZlcnRleEZvcm1hdC5wb3NpdGlvblxuICAgID8gbmV3IEZsb2F0NjRBcnJheShzaXplICogMylcbiAgICA6IHVuZGVmaW5lZDtcbiAgdmFyIHRleHR1cmVDb29yZGluYXRlcyA9IHZlcnRleEZvcm1hdC5zdFxuICAgID8gbmV3IEZsb2F0MzJBcnJheShzaXplICogMilcbiAgICA6IHVuZGVmaW5lZDtcblxuICB2YXIgcG9zSW5kZXggPSAwO1xuICB2YXIgc3RJbmRleCA9IDA7XG5cbiAgdmFyIHBvc2l0aW9uID0gcG9zaXRpb25TY3JhdGNoO1xuICB2YXIgc3QgPSBzdFNjcmF0Y2g7XG5cbiAgdmFyIG1pblggPSBOdW1iZXIuTUFYX1ZBTFVFO1xuICB2YXIgbWluWSA9IE51bWJlci5NQVhfVkFMVUU7XG4gIHZhciBtYXhYID0gLU51bWJlci5NQVhfVkFMVUU7XG4gIHZhciBtYXhZID0gLU51bWJlci5NQVhfVkFMVUU7XG5cbiAgZm9yICh2YXIgcm93ID0gcm93U3RhcnQ7IHJvdyA8IHJvd0VuZDsgKytyb3cpIHtcbiAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCB3aWR0aDsgKytjb2wpIHtcbiAgICAgIFJlY3RhbmdsZUdlb21ldHJ5TGlicmFyeS5jb21wdXRlUG9zaXRpb24oXG4gICAgICAgIGNvbXB1dGVkT3B0aW9ucyxcbiAgICAgICAgZWxsaXBzb2lkLFxuICAgICAgICB2ZXJ0ZXhGb3JtYXQuc3QsXG4gICAgICAgIHJvdyxcbiAgICAgICAgY29sLFxuICAgICAgICBwb3NpdGlvbixcbiAgICAgICAgc3RcbiAgICAgICk7XG5cbiAgICAgIHBvc2l0aW9uc1twb3NJbmRleCsrXSA9IHBvc2l0aW9uLng7XG4gICAgICBwb3NpdGlvbnNbcG9zSW5kZXgrK10gPSBwb3NpdGlvbi55O1xuICAgICAgcG9zaXRpb25zW3Bvc0luZGV4KytdID0gcG9zaXRpb24uejtcblxuICAgICAgaWYgKHZlcnRleEZvcm1hdC5zdCkge1xuICAgICAgICB0ZXh0dXJlQ29vcmRpbmF0ZXNbc3RJbmRleCsrXSA9IHN0Lng7XG4gICAgICAgIHRleHR1cmVDb29yZGluYXRlc1tzdEluZGV4KytdID0gc3QueTtcblxuICAgICAgICBtaW5YID0gTWF0aC5taW4obWluWCwgc3QueCk7XG4gICAgICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCBzdC55KTtcbiAgICAgICAgbWF4WCA9IE1hdGgubWF4KG1heFgsIHN0LngpO1xuICAgICAgICBtYXhZID0gTWF0aC5tYXgobWF4WSwgc3QueSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGlmIChub3J0aENhcCkge1xuICAgIFJlY3RhbmdsZUdlb21ldHJ5TGlicmFyeS5jb21wdXRlUG9zaXRpb24oXG4gICAgICBjb21wdXRlZE9wdGlvbnMsXG4gICAgICBlbGxpcHNvaWQsXG4gICAgICB2ZXJ0ZXhGb3JtYXQuc3QsXG4gICAgICAwLFxuICAgICAgMCxcbiAgICAgIHBvc2l0aW9uLFxuICAgICAgc3RcbiAgICApO1xuXG4gICAgcG9zaXRpb25zW3Bvc0luZGV4KytdID0gcG9zaXRpb24ueDtcbiAgICBwb3NpdGlvbnNbcG9zSW5kZXgrK10gPSBwb3NpdGlvbi55O1xuICAgIHBvc2l0aW9uc1twb3NJbmRleCsrXSA9IHBvc2l0aW9uLno7XG5cbiAgICBpZiAodmVydGV4Rm9ybWF0LnN0KSB7XG4gICAgICB0ZXh0dXJlQ29vcmRpbmF0ZXNbc3RJbmRleCsrXSA9IHN0Lng7XG4gICAgICB0ZXh0dXJlQ29vcmRpbmF0ZXNbc3RJbmRleCsrXSA9IHN0Lnk7XG5cbiAgICAgIG1pblggPSBzdC54O1xuICAgICAgbWluWSA9IHN0Lnk7XG4gICAgICBtYXhYID0gc3QueDtcbiAgICAgIG1heFkgPSBzdC55O1xuICAgIH1cbiAgfVxuICBpZiAoc291dGhDYXApIHtcbiAgICBSZWN0YW5nbGVHZW9tZXRyeUxpYnJhcnkuY29tcHV0ZVBvc2l0aW9uKFxuICAgICAgY29tcHV0ZWRPcHRpb25zLFxuICAgICAgZWxsaXBzb2lkLFxuICAgICAgdmVydGV4Rm9ybWF0LnN0LFxuICAgICAgaGVpZ2h0IC0gMSxcbiAgICAgIDAsXG4gICAgICBwb3NpdGlvbixcbiAgICAgIHN0XG4gICAgKTtcblxuICAgIHBvc2l0aW9uc1twb3NJbmRleCsrXSA9IHBvc2l0aW9uLng7XG4gICAgcG9zaXRpb25zW3Bvc0luZGV4KytdID0gcG9zaXRpb24ueTtcbiAgICBwb3NpdGlvbnNbcG9zSW5kZXhdID0gcG9zaXRpb24uejtcblxuICAgIGlmICh2ZXJ0ZXhGb3JtYXQuc3QpIHtcbiAgICAgIHRleHR1cmVDb29yZGluYXRlc1tzdEluZGV4KytdID0gc3QueDtcbiAgICAgIHRleHR1cmVDb29yZGluYXRlc1tzdEluZGV4XSA9IHN0Lnk7XG5cbiAgICAgIG1pblggPSBNYXRoLm1pbihtaW5YLCBzdC54KTtcbiAgICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCBzdC55KTtcbiAgICAgIG1heFggPSBNYXRoLm1heChtYXhYLCBzdC54KTtcbiAgICAgIG1heFkgPSBNYXRoLm1heChtYXhZLCBzdC55KTtcbiAgICB9XG4gIH1cblxuICBpZiAoXG4gICAgdmVydGV4Rm9ybWF0LnN0ICYmXG4gICAgKG1pblggPCAwLjAgfHwgbWluWSA8IDAuMCB8fCBtYXhYID4gMS4wIHx8IG1heFkgPiAxLjApXG4gICkge1xuICAgIGZvciAodmFyIGsgPSAwOyBrIDwgdGV4dHVyZUNvb3JkaW5hdGVzLmxlbmd0aDsgayArPSAyKSB7XG4gICAgICB0ZXh0dXJlQ29vcmRpbmF0ZXNba10gPSAodGV4dHVyZUNvb3JkaW5hdGVzW2tdIC0gbWluWCkgLyAobWF4WCAtIG1pblgpO1xuICAgICAgdGV4dHVyZUNvb3JkaW5hdGVzW2sgKyAxXSA9XG4gICAgICAgICh0ZXh0dXJlQ29vcmRpbmF0ZXNbayArIDFdIC0gbWluWSkgLyAobWF4WSAtIG1pblkpO1xuICAgIH1cbiAgfVxuXG4gIHZhciBnZW8gPSBjYWxjdWxhdGVBdHRyaWJ1dGVzKFxuICAgIHBvc2l0aW9ucyxcbiAgICB2ZXJ0ZXhGb3JtYXQsXG4gICAgZWxsaXBzb2lkLFxuICAgIGNvbXB1dGVkT3B0aW9ucy50YW5nZW50Um90YXRpb25NYXRyaXhcbiAgKTtcblxuICB2YXIgaW5kaWNlc1NpemUgPSA2ICogKHdpZHRoIC0gMSkgKiAocm93SGVpZ2h0IC0gMSk7XG4gIGlmIChub3J0aENhcCkge1xuICAgIGluZGljZXNTaXplICs9IDMgKiAod2lkdGggLSAxKTtcbiAgfVxuICBpZiAoc291dGhDYXApIHtcbiAgICBpbmRpY2VzU2l6ZSArPSAzICogKHdpZHRoIC0gMSk7XG4gIH1cbiAgdmFyIGluZGljZXMgPSBJbmRleERhdGF0eXBlLmNyZWF0ZVR5cGVkQXJyYXkoc2l6ZSwgaW5kaWNlc1NpemUpO1xuICB2YXIgaW5kZXggPSAwO1xuICB2YXIgaW5kaWNlc0luZGV4ID0gMDtcbiAgdmFyIGk7XG4gIGZvciAoaSA9IDA7IGkgPCByb3dIZWlnaHQgLSAxOyArK2kpIHtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IHdpZHRoIC0gMTsgKytqKSB7XG4gICAgICB2YXIgdXBwZXJMZWZ0ID0gaW5kZXg7XG4gICAgICB2YXIgbG93ZXJMZWZ0ID0gdXBwZXJMZWZ0ICsgd2lkdGg7XG4gICAgICB2YXIgbG93ZXJSaWdodCA9IGxvd2VyTGVmdCArIDE7XG4gICAgICB2YXIgdXBwZXJSaWdodCA9IHVwcGVyTGVmdCArIDE7XG4gICAgICBpbmRpY2VzW2luZGljZXNJbmRleCsrXSA9IHVwcGVyTGVmdDtcbiAgICAgIGluZGljZXNbaW5kaWNlc0luZGV4KytdID0gbG93ZXJMZWZ0O1xuICAgICAgaW5kaWNlc1tpbmRpY2VzSW5kZXgrK10gPSB1cHBlclJpZ2h0O1xuICAgICAgaW5kaWNlc1tpbmRpY2VzSW5kZXgrK10gPSB1cHBlclJpZ2h0O1xuICAgICAgaW5kaWNlc1tpbmRpY2VzSW5kZXgrK10gPSBsb3dlckxlZnQ7XG4gICAgICBpbmRpY2VzW2luZGljZXNJbmRleCsrXSA9IGxvd2VyUmlnaHQ7XG4gICAgICArK2luZGV4O1xuICAgIH1cbiAgICArK2luZGV4O1xuICB9XG4gIGlmIChub3J0aENhcCB8fCBzb3V0aENhcCkge1xuICAgIHZhciBub3J0aEluZGV4ID0gc2l6ZSAtIDE7XG4gICAgdmFyIHNvdXRoSW5kZXggPSBzaXplIC0gMTtcbiAgICBpZiAobm9ydGhDYXAgJiYgc291dGhDYXApIHtcbiAgICAgIG5vcnRoSW5kZXggPSBzaXplIC0gMjtcbiAgICB9XG5cbiAgICB2YXIgcDE7XG4gICAgdmFyIHAyO1xuICAgIGluZGV4ID0gMDtcblxuICAgIGlmIChub3J0aENhcCkge1xuICAgICAgZm9yIChpID0gMDsgaSA8IHdpZHRoIC0gMTsgaSsrKSB7XG4gICAgICAgIHAxID0gaW5kZXg7XG4gICAgICAgIHAyID0gcDEgKyAxO1xuICAgICAgICBpbmRpY2VzW2luZGljZXNJbmRleCsrXSA9IG5vcnRoSW5kZXg7XG4gICAgICAgIGluZGljZXNbaW5kaWNlc0luZGV4KytdID0gcDE7XG4gICAgICAgIGluZGljZXNbaW5kaWNlc0luZGV4KytdID0gcDI7XG4gICAgICAgICsraW5kZXg7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChzb3V0aENhcCkge1xuICAgICAgaW5kZXggPSAocm93SGVpZ2h0IC0gMSkgKiB3aWR0aDtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCB3aWR0aCAtIDE7IGkrKykge1xuICAgICAgICBwMSA9IGluZGV4O1xuICAgICAgICBwMiA9IHAxICsgMTtcbiAgICAgICAgaW5kaWNlc1tpbmRpY2VzSW5kZXgrK10gPSBwMTtcbiAgICAgICAgaW5kaWNlc1tpbmRpY2VzSW5kZXgrK10gPSBzb3V0aEluZGV4O1xuICAgICAgICBpbmRpY2VzW2luZGljZXNJbmRleCsrXSA9IHAyO1xuICAgICAgICArK2luZGV4O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdlby5pbmRpY2VzID0gaW5kaWNlcztcbiAgaWYgKHZlcnRleEZvcm1hdC5zdCkge1xuICAgIGdlby5hdHRyaWJ1dGVzLnN0ID0gbmV3IEdlb21ldHJ5QXR0cmlidXRlKHtcbiAgICAgIGNvbXBvbmVudERhdGF0eXBlOiBDb21wb25lbnREYXRhdHlwZS5GTE9BVCxcbiAgICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGU6IDIsXG4gICAgICB2YWx1ZXM6IHRleHR1cmVDb29yZGluYXRlcyxcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBnZW87XG59XG5cbmZ1bmN0aW9uIGFkZFdhbGxQb3NpdGlvbnMoXG4gIHdhbGxQb3NpdGlvbnMsXG4gIHBvc0luZGV4LFxuICBpLFxuICB0b3BQb3NpdGlvbnMsXG4gIGJvdHRvbVBvc2l0aW9uc1xuKSB7XG4gIHdhbGxQb3NpdGlvbnNbcG9zSW5kZXgrK10gPSB0b3BQb3NpdGlvbnNbaV07XG4gIHdhbGxQb3NpdGlvbnNbcG9zSW5kZXgrK10gPSB0b3BQb3NpdGlvbnNbaSArIDFdO1xuICB3YWxsUG9zaXRpb25zW3Bvc0luZGV4KytdID0gdG9wUG9zaXRpb25zW2kgKyAyXTtcbiAgd2FsbFBvc2l0aW9uc1twb3NJbmRleCsrXSA9IGJvdHRvbVBvc2l0aW9uc1tpXTtcbiAgd2FsbFBvc2l0aW9uc1twb3NJbmRleCsrXSA9IGJvdHRvbVBvc2l0aW9uc1tpICsgMV07XG4gIHdhbGxQb3NpdGlvbnNbcG9zSW5kZXhdID0gYm90dG9tUG9zaXRpb25zW2kgKyAyXTtcbiAgcmV0dXJuIHdhbGxQb3NpdGlvbnM7XG59XG5cbmZ1bmN0aW9uIGFkZFdhbGxUZXh0dXJlQ29vcmRpbmF0ZXMod2FsbFRleHR1cmVzLCBzdEluZGV4LCBpLCBzdCkge1xuICB3YWxsVGV4dHVyZXNbc3RJbmRleCsrXSA9IHN0W2ldO1xuICB3YWxsVGV4dHVyZXNbc3RJbmRleCsrXSA9IHN0W2kgKyAxXTtcbiAgd2FsbFRleHR1cmVzW3N0SW5kZXgrK10gPSBzdFtpXTtcbiAgd2FsbFRleHR1cmVzW3N0SW5kZXhdID0gc3RbaSArIDFdO1xuICByZXR1cm4gd2FsbFRleHR1cmVzO1xufVxuXG52YXIgc2NyYXRjaFZlcnRleEZvcm1hdCA9IG5ldyBWZXJ0ZXhGb3JtYXQoKTtcblxuZnVuY3Rpb24gY29uc3RydWN0RXh0cnVkZWRSZWN0YW5nbGUocmVjdGFuZ2xlR2VvbWV0cnksIGNvbXB1dGVkT3B0aW9ucykge1xuICB2YXIgc2hhZG93Vm9sdW1lID0gcmVjdGFuZ2xlR2VvbWV0cnkuX3NoYWRvd1ZvbHVtZTtcbiAgdmFyIG9mZnNldEF0dHJpYnV0ZVZhbHVlID0gcmVjdGFuZ2xlR2VvbWV0cnkuX29mZnNldEF0dHJpYnV0ZTtcbiAgdmFyIHZlcnRleEZvcm1hdCA9IHJlY3RhbmdsZUdlb21ldHJ5Ll92ZXJ0ZXhGb3JtYXQ7XG4gIHZhciBtaW5IZWlnaHQgPSByZWN0YW5nbGVHZW9tZXRyeS5fZXh0cnVkZWRIZWlnaHQ7XG4gIHZhciBtYXhIZWlnaHQgPSByZWN0YW5nbGVHZW9tZXRyeS5fc3VyZmFjZUhlaWdodDtcbiAgdmFyIGVsbGlwc29pZCA9IHJlY3RhbmdsZUdlb21ldHJ5Ll9lbGxpcHNvaWQ7XG5cbiAgdmFyIGhlaWdodCA9IGNvbXB1dGVkT3B0aW9ucy5oZWlnaHQ7XG4gIHZhciB3aWR0aCA9IGNvbXB1dGVkT3B0aW9ucy53aWR0aDtcblxuICB2YXIgaTtcblxuICBpZiAoc2hhZG93Vm9sdW1lKSB7XG4gICAgdmFyIG5ld1ZlcnRleEZvcm1hdCA9IFZlcnRleEZvcm1hdC5jbG9uZSh2ZXJ0ZXhGb3JtYXQsIHNjcmF0Y2hWZXJ0ZXhGb3JtYXQpO1xuICAgIG5ld1ZlcnRleEZvcm1hdC5ub3JtYWwgPSB0cnVlO1xuICAgIHJlY3RhbmdsZUdlb21ldHJ5Ll92ZXJ0ZXhGb3JtYXQgPSBuZXdWZXJ0ZXhGb3JtYXQ7XG4gIH1cblxuICB2YXIgdG9wQm90dG9tR2VvID0gY29uc3RydWN0UmVjdGFuZ2xlKHJlY3RhbmdsZUdlb21ldHJ5LCBjb21wdXRlZE9wdGlvbnMpO1xuXG4gIGlmIChzaGFkb3dWb2x1bWUpIHtcbiAgICByZWN0YW5nbGVHZW9tZXRyeS5fdmVydGV4Rm9ybWF0ID0gdmVydGV4Rm9ybWF0O1xuICB9XG5cbiAgdmFyIHRvcFBvc2l0aW9ucyA9IFBvbHlnb25QaXBlbGluZS5zY2FsZVRvR2VvZGV0aWNIZWlnaHQoXG4gICAgdG9wQm90dG9tR2VvLmF0dHJpYnV0ZXMucG9zaXRpb24udmFsdWVzLFxuICAgIG1heEhlaWdodCxcbiAgICBlbGxpcHNvaWQsXG4gICAgZmFsc2VcbiAgKTtcbiAgdG9wUG9zaXRpb25zID0gbmV3IEZsb2F0NjRBcnJheSh0b3BQb3NpdGlvbnMpO1xuICB2YXIgbGVuZ3RoID0gdG9wUG9zaXRpb25zLmxlbmd0aDtcbiAgdmFyIG5ld0xlbmd0aCA9IGxlbmd0aCAqIDI7XG4gIHZhciBwb3NpdGlvbnMgPSBuZXcgRmxvYXQ2NEFycmF5KG5ld0xlbmd0aCk7XG4gIHBvc2l0aW9ucy5zZXQodG9wUG9zaXRpb25zKTtcbiAgdmFyIGJvdHRvbVBvc2l0aW9ucyA9IFBvbHlnb25QaXBlbGluZS5zY2FsZVRvR2VvZGV0aWNIZWlnaHQoXG4gICAgdG9wQm90dG9tR2VvLmF0dHJpYnV0ZXMucG9zaXRpb24udmFsdWVzLFxuICAgIG1pbkhlaWdodCxcbiAgICBlbGxpcHNvaWRcbiAgKTtcbiAgcG9zaXRpb25zLnNldChib3R0b21Qb3NpdGlvbnMsIGxlbmd0aCk7XG4gIHRvcEJvdHRvbUdlby5hdHRyaWJ1dGVzLnBvc2l0aW9uLnZhbHVlcyA9IHBvc2l0aW9ucztcblxuICB2YXIgbm9ybWFscyA9IHZlcnRleEZvcm1hdC5ub3JtYWwgPyBuZXcgRmxvYXQzMkFycmF5KG5ld0xlbmd0aCkgOiB1bmRlZmluZWQ7XG4gIHZhciB0YW5nZW50cyA9IHZlcnRleEZvcm1hdC50YW5nZW50ID8gbmV3IEZsb2F0MzJBcnJheShuZXdMZW5ndGgpIDogdW5kZWZpbmVkO1xuICB2YXIgYml0YW5nZW50cyA9IHZlcnRleEZvcm1hdC5iaXRhbmdlbnRcbiAgICA/IG5ldyBGbG9hdDMyQXJyYXkobmV3TGVuZ3RoKVxuICAgIDogdW5kZWZpbmVkO1xuICB2YXIgdGV4dHVyZXMgPSB2ZXJ0ZXhGb3JtYXQuc3RcbiAgICA/IG5ldyBGbG9hdDMyQXJyYXkoKG5ld0xlbmd0aCAvIDMpICogMilcbiAgICA6IHVuZGVmaW5lZDtcbiAgdmFyIHRvcFN0O1xuICB2YXIgdG9wTm9ybWFscztcbiAgaWYgKHZlcnRleEZvcm1hdC5ub3JtYWwpIHtcbiAgICB0b3BOb3JtYWxzID0gdG9wQm90dG9tR2VvLmF0dHJpYnV0ZXMubm9ybWFsLnZhbHVlcztcbiAgICBub3JtYWxzLnNldCh0b3BOb3JtYWxzKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHRvcE5vcm1hbHNbaV0gPSAtdG9wTm9ybWFsc1tpXTtcbiAgICB9XG4gICAgbm9ybWFscy5zZXQodG9wTm9ybWFscywgbGVuZ3RoKTtcbiAgICB0b3BCb3R0b21HZW8uYXR0cmlidXRlcy5ub3JtYWwudmFsdWVzID0gbm9ybWFscztcbiAgfVxuICBpZiAoc2hhZG93Vm9sdW1lKSB7XG4gICAgdG9wTm9ybWFscyA9IHRvcEJvdHRvbUdlby5hdHRyaWJ1dGVzLm5vcm1hbC52YWx1ZXM7XG4gICAgaWYgKCF2ZXJ0ZXhGb3JtYXQubm9ybWFsKSB7XG4gICAgICB0b3BCb3R0b21HZW8uYXR0cmlidXRlcy5ub3JtYWwgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHZhciBleHRydWRlTm9ybWFscyA9IG5ldyBGbG9hdDMyQXJyYXkobmV3TGVuZ3RoKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHRvcE5vcm1hbHNbaV0gPSAtdG9wTm9ybWFsc1tpXTtcbiAgICB9XG4gICAgZXh0cnVkZU5vcm1hbHMuc2V0KHRvcE5vcm1hbHMsIGxlbmd0aCk7IC8vb25seSBnZXQgbm9ybWFscyBmb3IgYm90dG9tIGxheWVyIHRoYXQncyBnb2luZyB0byBiZSBwdXNoZWQgZG93blxuICAgIHRvcEJvdHRvbUdlby5hdHRyaWJ1dGVzLmV4dHJ1ZGVEaXJlY3Rpb24gPSBuZXcgR2VvbWV0cnlBdHRyaWJ1dGUoe1xuICAgICAgY29tcG9uZW50RGF0YXR5cGU6IENvbXBvbmVudERhdGF0eXBlLkZMT0FULFxuICAgICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogMyxcbiAgICAgIHZhbHVlczogZXh0cnVkZU5vcm1hbHMsXG4gICAgfSk7XG4gIH1cblxuICB2YXIgb2Zmc2V0VmFsdWU7XG4gIHZhciBoYXNPZmZzZXRzID0gZGVmaW5lZChvZmZzZXRBdHRyaWJ1dGVWYWx1ZSk7XG4gIGlmIChoYXNPZmZzZXRzKSB7XG4gICAgdmFyIHNpemUgPSAobGVuZ3RoIC8gMykgKiAyO1xuICAgIHZhciBvZmZzZXRBdHRyaWJ1dGUgPSBuZXcgVWludDhBcnJheShzaXplKTtcbiAgICBpZiAob2Zmc2V0QXR0cmlidXRlVmFsdWUgPT09IEdlb21ldHJ5T2Zmc2V0QXR0cmlidXRlLlRPUCkge1xuICAgICAgb2Zmc2V0QXR0cmlidXRlID0gYXJyYXlGaWxsKG9mZnNldEF0dHJpYnV0ZSwgMSwgMCwgc2l6ZSAvIDIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBvZmZzZXRWYWx1ZSA9XG4gICAgICAgIG9mZnNldEF0dHJpYnV0ZVZhbHVlID09PSBHZW9tZXRyeU9mZnNldEF0dHJpYnV0ZS5OT05FID8gMCA6IDE7XG4gICAgICBvZmZzZXRBdHRyaWJ1dGUgPSBhcnJheUZpbGwob2Zmc2V0QXR0cmlidXRlLCBvZmZzZXRWYWx1ZSk7XG4gICAgfVxuXG4gICAgdG9wQm90dG9tR2VvLmF0dHJpYnV0ZXMuYXBwbHlPZmZzZXQgPSBuZXcgR2VvbWV0cnlBdHRyaWJ1dGUoe1xuICAgICAgY29tcG9uZW50RGF0YXR5cGU6IENvbXBvbmVudERhdGF0eXBlLlVOU0lHTkVEX0JZVEUsXG4gICAgICBjb21wb25lbnRzUGVyQXR0cmlidXRlOiAxLFxuICAgICAgdmFsdWVzOiBvZmZzZXRBdHRyaWJ1dGUsXG4gICAgfSk7XG4gIH1cblxuICBpZiAodmVydGV4Rm9ybWF0LnRhbmdlbnQpIHtcbiAgICB2YXIgdG9wVGFuZ2VudHMgPSB0b3BCb3R0b21HZW8uYXR0cmlidXRlcy50YW5nZW50LnZhbHVlcztcbiAgICB0YW5nZW50cy5zZXQodG9wVGFuZ2VudHMpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdG9wVGFuZ2VudHNbaV0gPSAtdG9wVGFuZ2VudHNbaV07XG4gICAgfVxuICAgIHRhbmdlbnRzLnNldCh0b3BUYW5nZW50cywgbGVuZ3RoKTtcbiAgICB0b3BCb3R0b21HZW8uYXR0cmlidXRlcy50YW5nZW50LnZhbHVlcyA9IHRhbmdlbnRzO1xuICB9XG4gIGlmICh2ZXJ0ZXhGb3JtYXQuYml0YW5nZW50KSB7XG4gICAgdmFyIHRvcEJpdGFuZ2VudHMgPSB0b3BCb3R0b21HZW8uYXR0cmlidXRlcy5iaXRhbmdlbnQudmFsdWVzO1xuICAgIGJpdGFuZ2VudHMuc2V0KHRvcEJpdGFuZ2VudHMpO1xuICAgIGJpdGFuZ2VudHMuc2V0KHRvcEJpdGFuZ2VudHMsIGxlbmd0aCk7XG4gICAgdG9wQm90dG9tR2VvLmF0dHJpYnV0ZXMuYml0YW5nZW50LnZhbHVlcyA9IGJpdGFuZ2VudHM7XG4gIH1cbiAgaWYgKHZlcnRleEZvcm1hdC5zdCkge1xuICAgIHRvcFN0ID0gdG9wQm90dG9tR2VvLmF0dHJpYnV0ZXMuc3QudmFsdWVzO1xuICAgIHRleHR1cmVzLnNldCh0b3BTdCk7XG4gICAgdGV4dHVyZXMuc2V0KHRvcFN0LCAobGVuZ3RoIC8gMykgKiAyKTtcbiAgICB0b3BCb3R0b21HZW8uYXR0cmlidXRlcy5zdC52YWx1ZXMgPSB0ZXh0dXJlcztcbiAgfVxuXG4gIHZhciBpbmRpY2VzID0gdG9wQm90dG9tR2VvLmluZGljZXM7XG4gIHZhciBpbmRpY2VzTGVuZ3RoID0gaW5kaWNlcy5sZW5ndGg7XG4gIHZhciBwb3NMZW5ndGggPSBsZW5ndGggLyAzO1xuICB2YXIgbmV3SW5kaWNlcyA9IEluZGV4RGF0YXR5cGUuY3JlYXRlVHlwZWRBcnJheShcbiAgICBuZXdMZW5ndGggLyAzLFxuICAgIGluZGljZXNMZW5ndGggKiAyXG4gICk7XG4gIG5ld0luZGljZXMuc2V0KGluZGljZXMpO1xuICBmb3IgKGkgPSAwOyBpIDwgaW5kaWNlc0xlbmd0aDsgaSArPSAzKSB7XG4gICAgbmV3SW5kaWNlc1tpICsgaW5kaWNlc0xlbmd0aF0gPSBpbmRpY2VzW2kgKyAyXSArIHBvc0xlbmd0aDtcbiAgICBuZXdJbmRpY2VzW2kgKyAxICsgaW5kaWNlc0xlbmd0aF0gPSBpbmRpY2VzW2kgKyAxXSArIHBvc0xlbmd0aDtcbiAgICBuZXdJbmRpY2VzW2kgKyAyICsgaW5kaWNlc0xlbmd0aF0gPSBpbmRpY2VzW2ldICsgcG9zTGVuZ3RoO1xuICB9XG4gIHRvcEJvdHRvbUdlby5pbmRpY2VzID0gbmV3SW5kaWNlcztcblxuICB2YXIgbm9ydGhDYXAgPSBjb21wdXRlZE9wdGlvbnMubm9ydGhDYXA7XG4gIHZhciBzb3V0aENhcCA9IGNvbXB1dGVkT3B0aW9ucy5zb3V0aENhcDtcblxuICB2YXIgcm93SGVpZ2h0ID0gaGVpZ2h0O1xuICB2YXIgd2lkdGhNdWx0aXBsaWVyID0gMjtcbiAgdmFyIHBlcmltZXRlclBvc2l0aW9ucyA9IDA7XG4gIHZhciBjb3JuZXJzID0gNDtcbiAgdmFyIGR1cGxpYXRlQ29ybmVycyA9IDQ7XG4gIGlmIChub3J0aENhcCkge1xuICAgIHdpZHRoTXVsdGlwbGllciAtPSAxO1xuICAgIHJvd0hlaWdodCAtPSAxO1xuICAgIHBlcmltZXRlclBvc2l0aW9ucyArPSAxO1xuICAgIGNvcm5lcnMgLT0gMjtcbiAgICBkdXBsaWF0ZUNvcm5lcnMgLT0gMTtcbiAgfVxuICBpZiAoc291dGhDYXApIHtcbiAgICB3aWR0aE11bHRpcGxpZXIgLT0gMTtcbiAgICByb3dIZWlnaHQgLT0gMTtcbiAgICBwZXJpbWV0ZXJQb3NpdGlvbnMgKz0gMTtcbiAgICBjb3JuZXJzIC09IDI7XG4gICAgZHVwbGlhdGVDb3JuZXJzIC09IDE7XG4gIH1cbiAgcGVyaW1ldGVyUG9zaXRpb25zICs9IHdpZHRoTXVsdGlwbGllciAqIHdpZHRoICsgMiAqIHJvd0hlaWdodCAtIGNvcm5lcnM7XG5cbiAgdmFyIHdhbGxDb3VudCA9IChwZXJpbWV0ZXJQb3NpdGlvbnMgKyBkdXBsaWF0ZUNvcm5lcnMpICogMjtcblxuICB2YXIgd2FsbFBvc2l0aW9ucyA9IG5ldyBGbG9hdDY0QXJyYXkod2FsbENvdW50ICogMyk7XG4gIHZhciB3YWxsRXh0cnVkZU5vcm1hbHMgPSBzaGFkb3dWb2x1bWVcbiAgICA/IG5ldyBGbG9hdDMyQXJyYXkod2FsbENvdW50ICogMylcbiAgICA6IHVuZGVmaW5lZDtcbiAgdmFyIHdhbGxPZmZzZXRBdHRyaWJ1dGUgPSBoYXNPZmZzZXRzID8gbmV3IFVpbnQ4QXJyYXkod2FsbENvdW50KSA6IHVuZGVmaW5lZDtcbiAgdmFyIHdhbGxUZXh0dXJlcyA9IHZlcnRleEZvcm1hdC5zdFxuICAgID8gbmV3IEZsb2F0MzJBcnJheSh3YWxsQ291bnQgKiAyKVxuICAgIDogdW5kZWZpbmVkO1xuXG4gIHZhciBjb21wdXRlVG9wT2Zmc2V0cyA9IG9mZnNldEF0dHJpYnV0ZVZhbHVlID09PSBHZW9tZXRyeU9mZnNldEF0dHJpYnV0ZS5UT1A7XG4gIGlmIChoYXNPZmZzZXRzICYmICFjb21wdXRlVG9wT2Zmc2V0cykge1xuICAgIG9mZnNldFZhbHVlID0gb2Zmc2V0QXR0cmlidXRlVmFsdWUgPT09IEdlb21ldHJ5T2Zmc2V0QXR0cmlidXRlLkFMTCA/IDEgOiAwO1xuICAgIHdhbGxPZmZzZXRBdHRyaWJ1dGUgPSBhcnJheUZpbGwod2FsbE9mZnNldEF0dHJpYnV0ZSwgb2Zmc2V0VmFsdWUpO1xuICB9XG5cbiAgdmFyIHBvc0luZGV4ID0gMDtcbiAgdmFyIHN0SW5kZXggPSAwO1xuICB2YXIgZXh0cnVkZU5vcm1hbEluZGV4ID0gMDtcbiAgdmFyIHdhbGxPZmZzZXRJbmRleCA9IDA7XG4gIHZhciBhcmVhID0gd2lkdGggKiByb3dIZWlnaHQ7XG4gIHZhciB0aHJlZUk7XG4gIGZvciAoaSA9IDA7IGkgPCBhcmVhOyBpICs9IHdpZHRoKSB7XG4gICAgdGhyZWVJID0gaSAqIDM7XG4gICAgd2FsbFBvc2l0aW9ucyA9IGFkZFdhbGxQb3NpdGlvbnMoXG4gICAgICB3YWxsUG9zaXRpb25zLFxuICAgICAgcG9zSW5kZXgsXG4gICAgICB0aHJlZUksXG4gICAgICB0b3BQb3NpdGlvbnMsXG4gICAgICBib3R0b21Qb3NpdGlvbnNcbiAgICApO1xuICAgIHBvc0luZGV4ICs9IDY7XG4gICAgaWYgKHZlcnRleEZvcm1hdC5zdCkge1xuICAgICAgd2FsbFRleHR1cmVzID0gYWRkV2FsbFRleHR1cmVDb29yZGluYXRlcyhcbiAgICAgICAgd2FsbFRleHR1cmVzLFxuICAgICAgICBzdEluZGV4LFxuICAgICAgICBpICogMixcbiAgICAgICAgdG9wU3RcbiAgICAgICk7XG4gICAgICBzdEluZGV4ICs9IDQ7XG4gICAgfVxuICAgIGlmIChzaGFkb3dWb2x1bWUpIHtcbiAgICAgIGV4dHJ1ZGVOb3JtYWxJbmRleCArPSAzO1xuICAgICAgd2FsbEV4dHJ1ZGVOb3JtYWxzW2V4dHJ1ZGVOb3JtYWxJbmRleCsrXSA9IHRvcE5vcm1hbHNbdGhyZWVJXTtcbiAgICAgIHdhbGxFeHRydWRlTm9ybWFsc1tleHRydWRlTm9ybWFsSW5kZXgrK10gPSB0b3BOb3JtYWxzW3RocmVlSSArIDFdO1xuICAgICAgd2FsbEV4dHJ1ZGVOb3JtYWxzW2V4dHJ1ZGVOb3JtYWxJbmRleCsrXSA9IHRvcE5vcm1hbHNbdGhyZWVJICsgMl07XG4gICAgfVxuICAgIGlmIChjb21wdXRlVG9wT2Zmc2V0cykge1xuICAgICAgd2FsbE9mZnNldEF0dHJpYnV0ZVt3YWxsT2Zmc2V0SW5kZXgrK10gPSAxO1xuICAgICAgd2FsbE9mZnNldEluZGV4ICs9IDE7XG4gICAgfVxuICB9XG5cbiAgaWYgKCFzb3V0aENhcCkge1xuICAgIGZvciAoaSA9IGFyZWEgLSB3aWR0aDsgaSA8IGFyZWE7IGkrKykge1xuICAgICAgdGhyZWVJID0gaSAqIDM7XG4gICAgICB3YWxsUG9zaXRpb25zID0gYWRkV2FsbFBvc2l0aW9ucyhcbiAgICAgICAgd2FsbFBvc2l0aW9ucyxcbiAgICAgICAgcG9zSW5kZXgsXG4gICAgICAgIHRocmVlSSxcbiAgICAgICAgdG9wUG9zaXRpb25zLFxuICAgICAgICBib3R0b21Qb3NpdGlvbnNcbiAgICAgICk7XG4gICAgICBwb3NJbmRleCArPSA2O1xuICAgICAgaWYgKHZlcnRleEZvcm1hdC5zdCkge1xuICAgICAgICB3YWxsVGV4dHVyZXMgPSBhZGRXYWxsVGV4dHVyZUNvb3JkaW5hdGVzKFxuICAgICAgICAgIHdhbGxUZXh0dXJlcyxcbiAgICAgICAgICBzdEluZGV4LFxuICAgICAgICAgIGkgKiAyLFxuICAgICAgICAgIHRvcFN0XG4gICAgICAgICk7XG4gICAgICAgIHN0SW5kZXggKz0gNDtcbiAgICAgIH1cbiAgICAgIGlmIChzaGFkb3dWb2x1bWUpIHtcbiAgICAgICAgZXh0cnVkZU5vcm1hbEluZGV4ICs9IDM7XG4gICAgICAgIHdhbGxFeHRydWRlTm9ybWFsc1tleHRydWRlTm9ybWFsSW5kZXgrK10gPSB0b3BOb3JtYWxzW3RocmVlSV07XG4gICAgICAgIHdhbGxFeHRydWRlTm9ybWFsc1tleHRydWRlTm9ybWFsSW5kZXgrK10gPSB0b3BOb3JtYWxzW3RocmVlSSArIDFdO1xuICAgICAgICB3YWxsRXh0cnVkZU5vcm1hbHNbZXh0cnVkZU5vcm1hbEluZGV4KytdID0gdG9wTm9ybWFsc1t0aHJlZUkgKyAyXTtcbiAgICAgIH1cbiAgICAgIGlmIChjb21wdXRlVG9wT2Zmc2V0cykge1xuICAgICAgICB3YWxsT2Zmc2V0QXR0cmlidXRlW3dhbGxPZmZzZXRJbmRleCsrXSA9IDE7XG4gICAgICAgIHdhbGxPZmZzZXRJbmRleCArPSAxO1xuICAgICAgfVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB2YXIgc291dGhJbmRleCA9IG5vcnRoQ2FwID8gYXJlYSArIDEgOiBhcmVhO1xuICAgIHRocmVlSSA9IHNvdXRoSW5kZXggKiAzO1xuXG4gICAgZm9yIChpID0gMDsgaSA8IDI7IGkrKykge1xuICAgICAgLy8gZHVwbGljYXRlIGNvcm5lciBwb2ludHNcbiAgICAgIHdhbGxQb3NpdGlvbnMgPSBhZGRXYWxsUG9zaXRpb25zKFxuICAgICAgICB3YWxsUG9zaXRpb25zLFxuICAgICAgICBwb3NJbmRleCxcbiAgICAgICAgdGhyZWVJLFxuICAgICAgICB0b3BQb3NpdGlvbnMsXG4gICAgICAgIGJvdHRvbVBvc2l0aW9uc1xuICAgICAgKTtcbiAgICAgIHBvc0luZGV4ICs9IDY7XG4gICAgICBpZiAodmVydGV4Rm9ybWF0LnN0KSB7XG4gICAgICAgIHdhbGxUZXh0dXJlcyA9IGFkZFdhbGxUZXh0dXJlQ29vcmRpbmF0ZXMoXG4gICAgICAgICAgd2FsbFRleHR1cmVzLFxuICAgICAgICAgIHN0SW5kZXgsXG4gICAgICAgICAgc291dGhJbmRleCAqIDIsXG4gICAgICAgICAgdG9wU3RcbiAgICAgICAgKTtcbiAgICAgICAgc3RJbmRleCArPSA0O1xuICAgICAgfVxuICAgICAgaWYgKHNoYWRvd1ZvbHVtZSkge1xuICAgICAgICBleHRydWRlTm9ybWFsSW5kZXggKz0gMztcbiAgICAgICAgd2FsbEV4dHJ1ZGVOb3JtYWxzW2V4dHJ1ZGVOb3JtYWxJbmRleCsrXSA9IHRvcE5vcm1hbHNbdGhyZWVJXTtcbiAgICAgICAgd2FsbEV4dHJ1ZGVOb3JtYWxzW2V4dHJ1ZGVOb3JtYWxJbmRleCsrXSA9IHRvcE5vcm1hbHNbdGhyZWVJICsgMV07XG4gICAgICAgIHdhbGxFeHRydWRlTm9ybWFsc1tleHRydWRlTm9ybWFsSW5kZXgrK10gPSB0b3BOb3JtYWxzW3RocmVlSSArIDJdO1xuICAgICAgfVxuICAgICAgaWYgKGNvbXB1dGVUb3BPZmZzZXRzKSB7XG4gICAgICAgIHdhbGxPZmZzZXRBdHRyaWJ1dGVbd2FsbE9mZnNldEluZGV4KytdID0gMTtcbiAgICAgICAgd2FsbE9mZnNldEluZGV4ICs9IDE7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZm9yIChpID0gYXJlYSAtIDE7IGkgPiAwOyBpIC09IHdpZHRoKSB7XG4gICAgdGhyZWVJID0gaSAqIDM7XG4gICAgd2FsbFBvc2l0aW9ucyA9IGFkZFdhbGxQb3NpdGlvbnMoXG4gICAgICB3YWxsUG9zaXRpb25zLFxuICAgICAgcG9zSW5kZXgsXG4gICAgICB0aHJlZUksXG4gICAgICB0b3BQb3NpdGlvbnMsXG4gICAgICBib3R0b21Qb3NpdGlvbnNcbiAgICApO1xuICAgIHBvc0luZGV4ICs9IDY7XG4gICAgaWYgKHZlcnRleEZvcm1hdC5zdCkge1xuICAgICAgd2FsbFRleHR1cmVzID0gYWRkV2FsbFRleHR1cmVDb29yZGluYXRlcyhcbiAgICAgICAgd2FsbFRleHR1cmVzLFxuICAgICAgICBzdEluZGV4LFxuICAgICAgICBpICogMixcbiAgICAgICAgdG9wU3RcbiAgICAgICk7XG4gICAgICBzdEluZGV4ICs9IDQ7XG4gICAgfVxuICAgIGlmIChzaGFkb3dWb2x1bWUpIHtcbiAgICAgIGV4dHJ1ZGVOb3JtYWxJbmRleCArPSAzO1xuICAgICAgd2FsbEV4dHJ1ZGVOb3JtYWxzW2V4dHJ1ZGVOb3JtYWxJbmRleCsrXSA9IHRvcE5vcm1hbHNbdGhyZWVJXTtcbiAgICAgIHdhbGxFeHRydWRlTm9ybWFsc1tleHRydWRlTm9ybWFsSW5kZXgrK10gPSB0b3BOb3JtYWxzW3RocmVlSSArIDFdO1xuICAgICAgd2FsbEV4dHJ1ZGVOb3JtYWxzW2V4dHJ1ZGVOb3JtYWxJbmRleCsrXSA9IHRvcE5vcm1hbHNbdGhyZWVJICsgMl07XG4gICAgfVxuICAgIGlmIChjb21wdXRlVG9wT2Zmc2V0cykge1xuICAgICAgd2FsbE9mZnNldEF0dHJpYnV0ZVt3YWxsT2Zmc2V0SW5kZXgrK10gPSAxO1xuICAgICAgd2FsbE9mZnNldEluZGV4ICs9IDE7XG4gICAgfVxuICB9XG5cbiAgaWYgKCFub3J0aENhcCkge1xuICAgIGZvciAoaSA9IHdpZHRoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIHRocmVlSSA9IGkgKiAzO1xuICAgICAgd2FsbFBvc2l0aW9ucyA9IGFkZFdhbGxQb3NpdGlvbnMoXG4gICAgICAgIHdhbGxQb3NpdGlvbnMsXG4gICAgICAgIHBvc0luZGV4LFxuICAgICAgICB0aHJlZUksXG4gICAgICAgIHRvcFBvc2l0aW9ucyxcbiAgICAgICAgYm90dG9tUG9zaXRpb25zXG4gICAgICApO1xuICAgICAgcG9zSW5kZXggKz0gNjtcbiAgICAgIGlmICh2ZXJ0ZXhGb3JtYXQuc3QpIHtcbiAgICAgICAgd2FsbFRleHR1cmVzID0gYWRkV2FsbFRleHR1cmVDb29yZGluYXRlcyhcbiAgICAgICAgICB3YWxsVGV4dHVyZXMsXG4gICAgICAgICAgc3RJbmRleCxcbiAgICAgICAgICBpICogMixcbiAgICAgICAgICB0b3BTdFxuICAgICAgICApO1xuICAgICAgICBzdEluZGV4ICs9IDQ7XG4gICAgICB9XG4gICAgICBpZiAoc2hhZG93Vm9sdW1lKSB7XG4gICAgICAgIGV4dHJ1ZGVOb3JtYWxJbmRleCArPSAzO1xuICAgICAgICB3YWxsRXh0cnVkZU5vcm1hbHNbZXh0cnVkZU5vcm1hbEluZGV4KytdID0gdG9wTm9ybWFsc1t0aHJlZUldO1xuICAgICAgICB3YWxsRXh0cnVkZU5vcm1hbHNbZXh0cnVkZU5vcm1hbEluZGV4KytdID0gdG9wTm9ybWFsc1t0aHJlZUkgKyAxXTtcbiAgICAgICAgd2FsbEV4dHJ1ZGVOb3JtYWxzW2V4dHJ1ZGVOb3JtYWxJbmRleCsrXSA9IHRvcE5vcm1hbHNbdGhyZWVJICsgMl07XG4gICAgICB9XG4gICAgICBpZiAoY29tcHV0ZVRvcE9mZnNldHMpIHtcbiAgICAgICAgd2FsbE9mZnNldEF0dHJpYnV0ZVt3YWxsT2Zmc2V0SW5kZXgrK10gPSAxO1xuICAgICAgICB3YWxsT2Zmc2V0SW5kZXggKz0gMTtcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdmFyIG5vcnRoSW5kZXggPSBhcmVhO1xuICAgIHRocmVlSSA9IG5vcnRoSW5kZXggKiAzO1xuXG4gICAgZm9yIChpID0gMDsgaSA8IDI7IGkrKykge1xuICAgICAgLy8gZHVwbGljYXRlIGNvcm5lciBwb2ludHNcbiAgICAgIHdhbGxQb3NpdGlvbnMgPSBhZGRXYWxsUG9zaXRpb25zKFxuICAgICAgICB3YWxsUG9zaXRpb25zLFxuICAgICAgICBwb3NJbmRleCxcbiAgICAgICAgdGhyZWVJLFxuICAgICAgICB0b3BQb3NpdGlvbnMsXG4gICAgICAgIGJvdHRvbVBvc2l0aW9uc1xuICAgICAgKTtcbiAgICAgIHBvc0luZGV4ICs9IDY7XG4gICAgICBpZiAodmVydGV4Rm9ybWF0LnN0KSB7XG4gICAgICAgIHdhbGxUZXh0dXJlcyA9IGFkZFdhbGxUZXh0dXJlQ29vcmRpbmF0ZXMoXG4gICAgICAgICAgd2FsbFRleHR1cmVzLFxuICAgICAgICAgIHN0SW5kZXgsXG4gICAgICAgICAgbm9ydGhJbmRleCAqIDIsXG4gICAgICAgICAgdG9wU3RcbiAgICAgICAgKTtcbiAgICAgICAgc3RJbmRleCArPSA0O1xuICAgICAgfVxuICAgICAgaWYgKHNoYWRvd1ZvbHVtZSkge1xuICAgICAgICBleHRydWRlTm9ybWFsSW5kZXggKz0gMztcbiAgICAgICAgd2FsbEV4dHJ1ZGVOb3JtYWxzW2V4dHJ1ZGVOb3JtYWxJbmRleCsrXSA9IHRvcE5vcm1hbHNbdGhyZWVJXTtcbiAgICAgICAgd2FsbEV4dHJ1ZGVOb3JtYWxzW2V4dHJ1ZGVOb3JtYWxJbmRleCsrXSA9IHRvcE5vcm1hbHNbdGhyZWVJICsgMV07XG4gICAgICAgIHdhbGxFeHRydWRlTm9ybWFsc1tleHRydWRlTm9ybWFsSW5kZXgrK10gPSB0b3BOb3JtYWxzW3RocmVlSSArIDJdO1xuICAgICAgfVxuICAgICAgaWYgKGNvbXB1dGVUb3BPZmZzZXRzKSB7XG4gICAgICAgIHdhbGxPZmZzZXRBdHRyaWJ1dGVbd2FsbE9mZnNldEluZGV4KytdID0gMTtcbiAgICAgICAgd2FsbE9mZnNldEluZGV4ICs9IDE7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdmFyIGdlbyA9IGNhbGN1bGF0ZUF0dHJpYnV0ZXNXYWxsKHdhbGxQb3NpdGlvbnMsIHZlcnRleEZvcm1hdCwgZWxsaXBzb2lkKTtcblxuICBpZiAodmVydGV4Rm9ybWF0LnN0KSB7XG4gICAgZ2VvLmF0dHJpYnV0ZXMuc3QgPSBuZXcgR2VvbWV0cnlBdHRyaWJ1dGUoe1xuICAgICAgY29tcG9uZW50RGF0YXR5cGU6IENvbXBvbmVudERhdGF0eXBlLkZMT0FULFxuICAgICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogMixcbiAgICAgIHZhbHVlczogd2FsbFRleHR1cmVzLFxuICAgIH0pO1xuICB9XG4gIGlmIChzaGFkb3dWb2x1bWUpIHtcbiAgICBnZW8uYXR0cmlidXRlcy5leHRydWRlRGlyZWN0aW9uID0gbmV3IEdlb21ldHJ5QXR0cmlidXRlKHtcbiAgICAgIGNvbXBvbmVudERhdGF0eXBlOiBDb21wb25lbnREYXRhdHlwZS5GTE9BVCxcbiAgICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGU6IDMsXG4gICAgICB2YWx1ZXM6IHdhbGxFeHRydWRlTm9ybWFscyxcbiAgICB9KTtcbiAgfVxuICBpZiAoaGFzT2Zmc2V0cykge1xuICAgIGdlby5hdHRyaWJ1dGVzLmFwcGx5T2Zmc2V0ID0gbmV3IEdlb21ldHJ5QXR0cmlidXRlKHtcbiAgICAgIGNvbXBvbmVudERhdGF0eXBlOiBDb21wb25lbnREYXRhdHlwZS5VTlNJR05FRF9CWVRFLFxuICAgICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogMSxcbiAgICAgIHZhbHVlczogd2FsbE9mZnNldEF0dHJpYnV0ZSxcbiAgICB9KTtcbiAgfVxuXG4gIHZhciB3YWxsSW5kaWNlcyA9IEluZGV4RGF0YXR5cGUuY3JlYXRlVHlwZWRBcnJheShcbiAgICB3YWxsQ291bnQsXG4gICAgcGVyaW1ldGVyUG9zaXRpb25zICogNlxuICApO1xuXG4gIHZhciB1cHBlckxlZnQ7XG4gIHZhciBsb3dlckxlZnQ7XG4gIHZhciBsb3dlclJpZ2h0O1xuICB2YXIgdXBwZXJSaWdodDtcbiAgbGVuZ3RoID0gd2FsbFBvc2l0aW9ucy5sZW5ndGggLyAzO1xuICB2YXIgaW5kZXggPSAwO1xuICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoIC0gMTsgaSArPSAyKSB7XG4gICAgdXBwZXJMZWZ0ID0gaTtcbiAgICB1cHBlclJpZ2h0ID0gKHVwcGVyTGVmdCArIDIpICUgbGVuZ3RoO1xuICAgIHZhciBwMSA9IENhcnRlc2lhbjMuZnJvbUFycmF5KHdhbGxQb3NpdGlvbnMsIHVwcGVyTGVmdCAqIDMsIHYxU2NyYXRjaCk7XG4gICAgdmFyIHAyID0gQ2FydGVzaWFuMy5mcm9tQXJyYXkod2FsbFBvc2l0aW9ucywgdXBwZXJSaWdodCAqIDMsIHYyU2NyYXRjaCk7XG4gICAgaWYgKENhcnRlc2lhbjMuZXF1YWxzRXBzaWxvbihwMSwgcDIsIENlc2l1bU1hdGguRVBTSUxPTjEwKSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGxvd2VyTGVmdCA9ICh1cHBlckxlZnQgKyAxKSAlIGxlbmd0aDtcbiAgICBsb3dlclJpZ2h0ID0gKGxvd2VyTGVmdCArIDIpICUgbGVuZ3RoO1xuICAgIHdhbGxJbmRpY2VzW2luZGV4KytdID0gdXBwZXJMZWZ0O1xuICAgIHdhbGxJbmRpY2VzW2luZGV4KytdID0gbG93ZXJMZWZ0O1xuICAgIHdhbGxJbmRpY2VzW2luZGV4KytdID0gdXBwZXJSaWdodDtcbiAgICB3YWxsSW5kaWNlc1tpbmRleCsrXSA9IHVwcGVyUmlnaHQ7XG4gICAgd2FsbEluZGljZXNbaW5kZXgrK10gPSBsb3dlckxlZnQ7XG4gICAgd2FsbEluZGljZXNbaW5kZXgrK10gPSBsb3dlclJpZ2h0O1xuICB9XG5cbiAgZ2VvLmluZGljZXMgPSB3YWxsSW5kaWNlcztcblxuICBnZW8gPSBHZW9tZXRyeVBpcGVsaW5lLmNvbWJpbmVJbnN0YW5jZXMoW1xuICAgIG5ldyBHZW9tZXRyeUluc3RhbmNlKHtcbiAgICAgIGdlb21ldHJ5OiB0b3BCb3R0b21HZW8sXG4gICAgfSksXG4gICAgbmV3IEdlb21ldHJ5SW5zdGFuY2Uoe1xuICAgICAgZ2VvbWV0cnk6IGdlbyxcbiAgICB9KSxcbiAgXSk7XG5cbiAgcmV0dXJuIGdlb1swXTtcbn1cblxudmFyIHNjcmF0Y2hSZWN0YW5nbGVQb2ludHMgPSBbXG4gIG5ldyBDYXJ0ZXNpYW4zKCksXG4gIG5ldyBDYXJ0ZXNpYW4zKCksXG4gIG5ldyBDYXJ0ZXNpYW4zKCksXG4gIG5ldyBDYXJ0ZXNpYW4zKCksXG5dO1xudmFyIG53U2NyYXRjaCA9IG5ldyBDYXJ0b2dyYXBoaWMoKTtcbnZhciBzdE53U2NyYXRjaCA9IG5ldyBDYXJ0b2dyYXBoaWMoKTtcbmZ1bmN0aW9uIGNvbXB1dGVSZWN0YW5nbGUocmVjdGFuZ2xlLCBncmFudWxhcml0eSwgcm90YXRpb24sIGVsbGlwc29pZCwgcmVzdWx0KSB7XG4gIGlmIChyb3RhdGlvbiA9PT0gMC4wKSB7XG4gICAgcmV0dXJuIFJlY3RhbmdsZS5jbG9uZShyZWN0YW5nbGUsIHJlc3VsdCk7XG4gIH1cblxuICB2YXIgY29tcHV0ZWRPcHRpb25zID0gUmVjdGFuZ2xlR2VvbWV0cnlMaWJyYXJ5LmNvbXB1dGVPcHRpb25zKFxuICAgIHJlY3RhbmdsZSxcbiAgICBncmFudWxhcml0eSxcbiAgICByb3RhdGlvbixcbiAgICAwLFxuICAgIHJlY3RhbmdsZVNjcmF0Y2gsXG4gICAgbndTY3JhdGNoXG4gICk7XG5cbiAgdmFyIGhlaWdodCA9IGNvbXB1dGVkT3B0aW9ucy5oZWlnaHQ7XG4gIHZhciB3aWR0aCA9IGNvbXB1dGVkT3B0aW9ucy53aWR0aDtcblxuICB2YXIgcG9zaXRpb25zID0gc2NyYXRjaFJlY3RhbmdsZVBvaW50cztcbiAgUmVjdGFuZ2xlR2VvbWV0cnlMaWJyYXJ5LmNvbXB1dGVQb3NpdGlvbihcbiAgICBjb21wdXRlZE9wdGlvbnMsXG4gICAgZWxsaXBzb2lkLFxuICAgIGZhbHNlLFxuICAgIDAsXG4gICAgMCxcbiAgICBwb3NpdGlvbnNbMF1cbiAgKTtcbiAgUmVjdGFuZ2xlR2VvbWV0cnlMaWJyYXJ5LmNvbXB1dGVQb3NpdGlvbihcbiAgICBjb21wdXRlZE9wdGlvbnMsXG4gICAgZWxsaXBzb2lkLFxuICAgIGZhbHNlLFxuICAgIDAsXG4gICAgd2lkdGggLSAxLFxuICAgIHBvc2l0aW9uc1sxXVxuICApO1xuICBSZWN0YW5nbGVHZW9tZXRyeUxpYnJhcnkuY29tcHV0ZVBvc2l0aW9uKFxuICAgIGNvbXB1dGVkT3B0aW9ucyxcbiAgICBlbGxpcHNvaWQsXG4gICAgZmFsc2UsXG4gICAgaGVpZ2h0IC0gMSxcbiAgICAwLFxuICAgIHBvc2l0aW9uc1syXVxuICApO1xuICBSZWN0YW5nbGVHZW9tZXRyeUxpYnJhcnkuY29tcHV0ZVBvc2l0aW9uKFxuICAgIGNvbXB1dGVkT3B0aW9ucyxcbiAgICBlbGxpcHNvaWQsXG4gICAgZmFsc2UsXG4gICAgaGVpZ2h0IC0gMSxcbiAgICB3aWR0aCAtIDEsXG4gICAgcG9zaXRpb25zWzNdXG4gICk7XG5cbiAgcmV0dXJuIFJlY3RhbmdsZS5mcm9tQ2FydGVzaWFuQXJyYXkocG9zaXRpb25zLCBlbGxpcHNvaWQsIHJlc3VsdCk7XG59XG5cbi8qKlxuICogQSBkZXNjcmlwdGlvbiBvZiBhIGNhcnRvZ3JhcGhpYyByZWN0YW5nbGUgb24gYW4gZWxsaXBzb2lkIGNlbnRlcmVkIGF0IHRoZSBvcmlnaW4uIFJlY3RhbmdsZSBnZW9tZXRyeSBjYW4gYmUgcmVuZGVyZWQgd2l0aCBib3RoIHtAbGluayBQcmltaXRpdmV9IGFuZCB7QGxpbmsgR3JvdW5kUHJpbWl0aXZlfS5cbiAqXG4gKiBAYWxpYXMgUmVjdGFuZ2xlR2VvbWV0cnlcbiAqIEBjb25zdHJ1Y3RvclxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIE9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqIEBwYXJhbSB7UmVjdGFuZ2xlfSBvcHRpb25zLnJlY3RhbmdsZSBBIGNhcnRvZ3JhcGhpYyByZWN0YW5nbGUgd2l0aCBub3J0aCwgc291dGgsIGVhc3QgYW5kIHdlc3QgcHJvcGVydGllcyBpbiByYWRpYW5zLlxuICogQHBhcmFtIHtWZXJ0ZXhGb3JtYXR9IFtvcHRpb25zLnZlcnRleEZvcm1hdD1WZXJ0ZXhGb3JtYXQuREVGQVVMVF0gVGhlIHZlcnRleCBhdHRyaWJ1dGVzIHRvIGJlIGNvbXB1dGVkLlxuICogQHBhcmFtIHtFbGxpcHNvaWR9IFtvcHRpb25zLmVsbGlwc29pZD1FbGxpcHNvaWQuV0dTODRdIFRoZSBlbGxpcHNvaWQgb24gd2hpY2ggdGhlIHJlY3RhbmdsZSBsaWVzLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLmdyYW51bGFyaXR5PUNlc2l1bU1hdGguUkFESUFOU19QRVJfREVHUkVFXSBUaGUgZGlzdGFuY2UsIGluIHJhZGlhbnMsIGJldHdlZW4gZWFjaCBsYXRpdHVkZSBhbmQgbG9uZ2l0dWRlLiBEZXRlcm1pbmVzIHRoZSBudW1iZXIgb2YgcG9zaXRpb25zIGluIHRoZSBidWZmZXIuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMuaGVpZ2h0PTAuMF0gVGhlIGRpc3RhbmNlIGluIG1ldGVycyBiZXR3ZWVuIHRoZSByZWN0YW5nbGUgYW5kIHRoZSBlbGxpcHNvaWQgc3VyZmFjZS5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5yb3RhdGlvbj0wLjBdIFRoZSByb3RhdGlvbiBvZiB0aGUgcmVjdGFuZ2xlLCBpbiByYWRpYW5zLiBBIHBvc2l0aXZlIHJvdGF0aW9uIGlzIGNvdW50ZXItY2xvY2t3aXNlLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLnN0Um90YXRpb249MC4wXSBUaGUgcm90YXRpb24gb2YgdGhlIHRleHR1cmUgY29vcmRpbmF0ZXMsIGluIHJhZGlhbnMuIEEgcG9zaXRpdmUgcm90YXRpb24gaXMgY291bnRlci1jbG9ja3dpc2UuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMuZXh0cnVkZWRIZWlnaHRdIFRoZSBkaXN0YW5jZSBpbiBtZXRlcnMgYmV0d2VlbiB0aGUgcmVjdGFuZ2xlJ3MgZXh0cnVkZWQgZmFjZSBhbmQgdGhlIGVsbGlwc29pZCBzdXJmYWNlLlxuICpcbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSA8Y29kZT5vcHRpb25zLnJlY3RhbmdsZS5ub3J0aDwvY29kZT4gbXVzdCBiZSBpbiB0aGUgaW50ZXJ2YWwgWzxjb2RlPi1QaS8yPC9jb2RlPiwgPGNvZGU+UGkvMjwvY29kZT5dLlxuICogQGV4Y2VwdGlvbiB7RGV2ZWxvcGVyRXJyb3J9IDxjb2RlPm9wdGlvbnMucmVjdGFuZ2xlLnNvdXRoPC9jb2RlPiBtdXN0IGJlIGluIHRoZSBpbnRlcnZhbCBbPGNvZGU+LVBpLzI8L2NvZGU+LCA8Y29kZT5QaS8yPC9jb2RlPl0uXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gPGNvZGU+b3B0aW9ucy5yZWN0YW5nbGUuZWFzdDwvY29kZT4gbXVzdCBiZSBpbiB0aGUgaW50ZXJ2YWwgWzxjb2RlPi1QaTwvY29kZT4sIDxjb2RlPlBpPC9jb2RlPl0uXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gPGNvZGU+b3B0aW9ucy5yZWN0YW5nbGUud2VzdDwvY29kZT4gbXVzdCBiZSBpbiB0aGUgaW50ZXJ2YWwgWzxjb2RlPi1QaTwvY29kZT4sIDxjb2RlPlBpPC9jb2RlPl0uXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gPGNvZGU+b3B0aW9ucy5yZWN0YW5nbGUubm9ydGg8L2NvZGU+IG11c3QgYmUgZ3JlYXRlciB0aGFuIDxjb2RlPm9wdGlvbnMucmVjdGFuZ2xlLnNvdXRoPC9jb2RlPi5cbiAqXG4gKiBAc2VlIFJlY3RhbmdsZUdlb21ldHJ5I2NyZWF0ZUdlb21ldHJ5XG4gKlxuICogQGRlbW8ge0BsaW5rIGh0dHBzOi8vc2FuZGNhc3RsZS5jZXNpdW0uY29tL2luZGV4Lmh0bWw/c3JjPVJlY3RhbmdsZS5odG1sfENlc2l1bSBTYW5kY2FzdGxlIFJlY3RhbmdsZSBEZW1vfVxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyAxLiBjcmVhdGUgYSByZWN0YW5nbGVcbiAqIHZhciByZWN0YW5nbGUgPSBuZXcgQ2VzaXVtLlJlY3RhbmdsZUdlb21ldHJ5KHtcbiAqICAgZWxsaXBzb2lkIDogQ2VzaXVtLkVsbGlwc29pZC5XR1M4NCxcbiAqICAgcmVjdGFuZ2xlIDogQ2VzaXVtLlJlY3RhbmdsZS5mcm9tRGVncmVlcygtODAuMCwgMzkuMCwgLTc0LjAsIDQyLjApLFxuICogICBoZWlnaHQgOiAxMDAwMC4wXG4gKiB9KTtcbiAqIHZhciBnZW9tZXRyeSA9IENlc2l1bS5SZWN0YW5nbGVHZW9tZXRyeS5jcmVhdGVHZW9tZXRyeShyZWN0YW5nbGUpO1xuICpcbiAqIC8vIDIuIGNyZWF0ZSBhbiBleHRydWRlZCByZWN0YW5nbGUgd2l0aG91dCBhIHRvcFxuICogdmFyIHJlY3RhbmdsZSA9IG5ldyBDZXNpdW0uUmVjdGFuZ2xlR2VvbWV0cnkoe1xuICogICBlbGxpcHNvaWQgOiBDZXNpdW0uRWxsaXBzb2lkLldHUzg0LFxuICogICByZWN0YW5nbGUgOiBDZXNpdW0uUmVjdGFuZ2xlLmZyb21EZWdyZWVzKC04MC4wLCAzOS4wLCAtNzQuMCwgNDIuMCksXG4gKiAgIGhlaWdodCA6IDEwMDAwLjAsXG4gKiAgIGV4dHJ1ZGVkSGVpZ2h0OiAzMDAwMDBcbiAqIH0pO1xuICogdmFyIGdlb21ldHJ5ID0gQ2VzaXVtLlJlY3RhbmdsZUdlb21ldHJ5LmNyZWF0ZUdlb21ldHJ5KHJlY3RhbmdsZSk7XG4gKi9cbmZ1bmN0aW9uIFJlY3RhbmdsZUdlb21ldHJ5KG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLCBkZWZhdWx0VmFsdWUuRU1QVFlfT0JKRUNUKTtcblxuICB2YXIgcmVjdGFuZ2xlID0gb3B0aW9ucy5yZWN0YW5nbGU7XG5cbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcInJlY3RhbmdsZVwiLCByZWN0YW5nbGUpO1xuICBSZWN0YW5nbGUudmFsaWRhdGUocmVjdGFuZ2xlKTtcbiAgaWYgKHJlY3RhbmdsZS5ub3J0aCA8IHJlY3RhbmdsZS5zb3V0aCkge1xuICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcbiAgICAgIFwib3B0aW9ucy5yZWN0YW5nbGUubm9ydGggbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gb3B0aW9ucy5yZWN0YW5nbGUuc291dGhcIlxuICAgICk7XG4gIH1cbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgdmFyIGhlaWdodCA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmhlaWdodCwgMC4wKTtcbiAgdmFyIGV4dHJ1ZGVkSGVpZ2h0ID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuZXh0cnVkZWRIZWlnaHQsIGhlaWdodCk7XG5cbiAgdGhpcy5fcmVjdGFuZ2xlID0gUmVjdGFuZ2xlLmNsb25lKHJlY3RhbmdsZSk7XG4gIHRoaXMuX2dyYW51bGFyaXR5ID0gZGVmYXVsdFZhbHVlKFxuICAgIG9wdGlvbnMuZ3JhbnVsYXJpdHksXG4gICAgQ2VzaXVtTWF0aC5SQURJQU5TX1BFUl9ERUdSRUVcbiAgKTtcbiAgdGhpcy5fZWxsaXBzb2lkID0gRWxsaXBzb2lkLmNsb25lKFxuICAgIGRlZmF1bHRWYWx1ZShvcHRpb25zLmVsbGlwc29pZCwgRWxsaXBzb2lkLldHUzg0KVxuICApO1xuICB0aGlzLl9zdXJmYWNlSGVpZ2h0ID0gTWF0aC5tYXgoaGVpZ2h0LCBleHRydWRlZEhlaWdodCk7XG4gIHRoaXMuX3JvdGF0aW9uID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMucm90YXRpb24sIDAuMCk7XG4gIHRoaXMuX3N0Um90YXRpb24gPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5zdFJvdGF0aW9uLCAwLjApO1xuICB0aGlzLl92ZXJ0ZXhGb3JtYXQgPSBWZXJ0ZXhGb3JtYXQuY2xvbmUoXG4gICAgZGVmYXVsdFZhbHVlKG9wdGlvbnMudmVydGV4Rm9ybWF0LCBWZXJ0ZXhGb3JtYXQuREVGQVVMVClcbiAgKTtcbiAgdGhpcy5fZXh0cnVkZWRIZWlnaHQgPSBNYXRoLm1pbihoZWlnaHQsIGV4dHJ1ZGVkSGVpZ2h0KTtcbiAgdGhpcy5fc2hhZG93Vm9sdW1lID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuc2hhZG93Vm9sdW1lLCBmYWxzZSk7XG4gIHRoaXMuX3dvcmtlck5hbWUgPSBcImNyZWF0ZVJlY3RhbmdsZUdlb21ldHJ5XCI7XG4gIHRoaXMuX29mZnNldEF0dHJpYnV0ZSA9IG9wdGlvbnMub2Zmc2V0QXR0cmlidXRlO1xuICB0aGlzLl9yb3RhdGVkUmVjdGFuZ2xlID0gdW5kZWZpbmVkO1xuXG4gIHRoaXMuX3RleHR1cmVDb29yZGluYXRlUm90YXRpb25Qb2ludHMgPSB1bmRlZmluZWQ7XG59XG5cbi8qKlxuICogVGhlIG51bWJlciBvZiBlbGVtZW50cyB1c2VkIHRvIHBhY2sgdGhlIG9iamVjdCBpbnRvIGFuIGFycmF5LlxuICogQHR5cGUge051bWJlcn1cbiAqL1xuUmVjdGFuZ2xlR2VvbWV0cnkucGFja2VkTGVuZ3RoID1cbiAgUmVjdGFuZ2xlLnBhY2tlZExlbmd0aCArXG4gIEVsbGlwc29pZC5wYWNrZWRMZW5ndGggK1xuICBWZXJ0ZXhGb3JtYXQucGFja2VkTGVuZ3RoICtcbiAgNztcblxuLyoqXG4gKiBTdG9yZXMgdGhlIHByb3ZpZGVkIGluc3RhbmNlIGludG8gdGhlIHByb3ZpZGVkIGFycmF5LlxuICpcbiAqIEBwYXJhbSB7UmVjdGFuZ2xlR2VvbWV0cnl9IHZhbHVlIFRoZSB2YWx1ZSB0byBwYWNrLlxuICogQHBhcmFtIHtOdW1iZXJbXX0gYXJyYXkgVGhlIGFycmF5IHRvIHBhY2sgaW50by5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbc3RhcnRpbmdJbmRleD0wXSBUaGUgaW5kZXggaW50byB0aGUgYXJyYXkgYXQgd2hpY2ggdG8gc3RhcnQgcGFja2luZyB0aGUgZWxlbWVudHMuXG4gKlxuICogQHJldHVybnMge051bWJlcltdfSBUaGUgYXJyYXkgdGhhdCB3YXMgcGFja2VkIGludG9cbiAqL1xuUmVjdGFuZ2xlR2VvbWV0cnkucGFjayA9IGZ1bmN0aW9uICh2YWx1ZSwgYXJyYXksIHN0YXJ0aW5nSW5kZXgpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcInZhbHVlXCIsIHZhbHVlKTtcbiAgQ2hlY2suZGVmaW5lZChcImFycmF5XCIsIGFycmF5KTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgc3RhcnRpbmdJbmRleCA9IGRlZmF1bHRWYWx1ZShzdGFydGluZ0luZGV4LCAwKTtcblxuICBSZWN0YW5nbGUucGFjayh2YWx1ZS5fcmVjdGFuZ2xlLCBhcnJheSwgc3RhcnRpbmdJbmRleCk7XG4gIHN0YXJ0aW5nSW5kZXggKz0gUmVjdGFuZ2xlLnBhY2tlZExlbmd0aDtcblxuICBFbGxpcHNvaWQucGFjayh2YWx1ZS5fZWxsaXBzb2lkLCBhcnJheSwgc3RhcnRpbmdJbmRleCk7XG4gIHN0YXJ0aW5nSW5kZXggKz0gRWxsaXBzb2lkLnBhY2tlZExlbmd0aDtcblxuICBWZXJ0ZXhGb3JtYXQucGFjayh2YWx1ZS5fdmVydGV4Rm9ybWF0LCBhcnJheSwgc3RhcnRpbmdJbmRleCk7XG4gIHN0YXJ0aW5nSW5kZXggKz0gVmVydGV4Rm9ybWF0LnBhY2tlZExlbmd0aDtcblxuICBhcnJheVtzdGFydGluZ0luZGV4KytdID0gdmFsdWUuX2dyYW51bGFyaXR5O1xuICBhcnJheVtzdGFydGluZ0luZGV4KytdID0gdmFsdWUuX3N1cmZhY2VIZWlnaHQ7XG4gIGFycmF5W3N0YXJ0aW5nSW5kZXgrK10gPSB2YWx1ZS5fcm90YXRpb247XG4gIGFycmF5W3N0YXJ0aW5nSW5kZXgrK10gPSB2YWx1ZS5fc3RSb3RhdGlvbjtcbiAgYXJyYXlbc3RhcnRpbmdJbmRleCsrXSA9IHZhbHVlLl9leHRydWRlZEhlaWdodDtcbiAgYXJyYXlbc3RhcnRpbmdJbmRleCsrXSA9IHZhbHVlLl9zaGFkb3dWb2x1bWUgPyAxLjAgOiAwLjA7XG4gIGFycmF5W3N0YXJ0aW5nSW5kZXhdID0gZGVmYXVsdFZhbHVlKHZhbHVlLl9vZmZzZXRBdHRyaWJ1dGUsIC0xKTtcblxuICByZXR1cm4gYXJyYXk7XG59O1xuXG52YXIgc2NyYXRjaFJlY3RhbmdsZSA9IG5ldyBSZWN0YW5nbGUoKTtcbnZhciBzY3JhdGNoRWxsaXBzb2lkID0gRWxsaXBzb2lkLmNsb25lKEVsbGlwc29pZC5VTklUX1NQSEVSRSk7XG52YXIgc2NyYXRjaE9wdGlvbnMgPSB7XG4gIHJlY3RhbmdsZTogc2NyYXRjaFJlY3RhbmdsZSxcbiAgZWxsaXBzb2lkOiBzY3JhdGNoRWxsaXBzb2lkLFxuICB2ZXJ0ZXhGb3JtYXQ6IHNjcmF0Y2hWZXJ0ZXhGb3JtYXQsXG4gIGdyYW51bGFyaXR5OiB1bmRlZmluZWQsXG4gIGhlaWdodDogdW5kZWZpbmVkLFxuICByb3RhdGlvbjogdW5kZWZpbmVkLFxuICBzdFJvdGF0aW9uOiB1bmRlZmluZWQsXG4gIGV4dHJ1ZGVkSGVpZ2h0OiB1bmRlZmluZWQsXG4gIHNoYWRvd1ZvbHVtZTogdW5kZWZpbmVkLFxuICBvZmZzZXRBdHRyaWJ1dGU6IHVuZGVmaW5lZCxcbn07XG5cbi8qKlxuICogUmV0cmlldmVzIGFuIGluc3RhbmNlIGZyb20gYSBwYWNrZWQgYXJyYXkuXG4gKlxuICogQHBhcmFtIHtOdW1iZXJbXX0gYXJyYXkgVGhlIHBhY2tlZCBhcnJheS5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbc3RhcnRpbmdJbmRleD0wXSBUaGUgc3RhcnRpbmcgaW5kZXggb2YgdGhlIGVsZW1lbnQgdG8gYmUgdW5wYWNrZWQuXG4gKiBAcGFyYW0ge1JlY3RhbmdsZUdlb21ldHJ5fSBbcmVzdWx0XSBUaGUgb2JqZWN0IGludG8gd2hpY2ggdG8gc3RvcmUgdGhlIHJlc3VsdC5cbiAqIEByZXR1cm5zIHtSZWN0YW5nbGVHZW9tZXRyeX0gVGhlIG1vZGlmaWVkIHJlc3VsdCBwYXJhbWV0ZXIgb3IgYSBuZXcgUmVjdGFuZ2xlR2VvbWV0cnkgaW5zdGFuY2UgaWYgb25lIHdhcyBub3QgcHJvdmlkZWQuXG4gKi9cblJlY3RhbmdsZUdlb21ldHJ5LnVucGFjayA9IGZ1bmN0aW9uIChhcnJheSwgc3RhcnRpbmdJbmRleCwgcmVzdWx0KSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLmRlZmluZWQoXCJhcnJheVwiLCBhcnJheSk7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIHN0YXJ0aW5nSW5kZXggPSBkZWZhdWx0VmFsdWUoc3RhcnRpbmdJbmRleCwgMCk7XG5cbiAgdmFyIHJlY3RhbmdsZSA9IFJlY3RhbmdsZS51bnBhY2soYXJyYXksIHN0YXJ0aW5nSW5kZXgsIHNjcmF0Y2hSZWN0YW5nbGUpO1xuICBzdGFydGluZ0luZGV4ICs9IFJlY3RhbmdsZS5wYWNrZWRMZW5ndGg7XG5cbiAgdmFyIGVsbGlwc29pZCA9IEVsbGlwc29pZC51bnBhY2soYXJyYXksIHN0YXJ0aW5nSW5kZXgsIHNjcmF0Y2hFbGxpcHNvaWQpO1xuICBzdGFydGluZ0luZGV4ICs9IEVsbGlwc29pZC5wYWNrZWRMZW5ndGg7XG5cbiAgdmFyIHZlcnRleEZvcm1hdCA9IFZlcnRleEZvcm1hdC51bnBhY2soXG4gICAgYXJyYXksXG4gICAgc3RhcnRpbmdJbmRleCxcbiAgICBzY3JhdGNoVmVydGV4Rm9ybWF0XG4gICk7XG4gIHN0YXJ0aW5nSW5kZXggKz0gVmVydGV4Rm9ybWF0LnBhY2tlZExlbmd0aDtcblxuICB2YXIgZ3JhbnVsYXJpdHkgPSBhcnJheVtzdGFydGluZ0luZGV4KytdO1xuICB2YXIgc3VyZmFjZUhlaWdodCA9IGFycmF5W3N0YXJ0aW5nSW5kZXgrK107XG4gIHZhciByb3RhdGlvbiA9IGFycmF5W3N0YXJ0aW5nSW5kZXgrK107XG4gIHZhciBzdFJvdGF0aW9uID0gYXJyYXlbc3RhcnRpbmdJbmRleCsrXTtcbiAgdmFyIGV4dHJ1ZGVkSGVpZ2h0ID0gYXJyYXlbc3RhcnRpbmdJbmRleCsrXTtcbiAgdmFyIHNoYWRvd1ZvbHVtZSA9IGFycmF5W3N0YXJ0aW5nSW5kZXgrK10gPT09IDEuMDtcbiAgdmFyIG9mZnNldEF0dHJpYnV0ZSA9IGFycmF5W3N0YXJ0aW5nSW5kZXhdO1xuXG4gIGlmICghZGVmaW5lZChyZXN1bHQpKSB7XG4gICAgc2NyYXRjaE9wdGlvbnMuZ3JhbnVsYXJpdHkgPSBncmFudWxhcml0eTtcbiAgICBzY3JhdGNoT3B0aW9ucy5oZWlnaHQgPSBzdXJmYWNlSGVpZ2h0O1xuICAgIHNjcmF0Y2hPcHRpb25zLnJvdGF0aW9uID0gcm90YXRpb247XG4gICAgc2NyYXRjaE9wdGlvbnMuc3RSb3RhdGlvbiA9IHN0Um90YXRpb247XG4gICAgc2NyYXRjaE9wdGlvbnMuZXh0cnVkZWRIZWlnaHQgPSBleHRydWRlZEhlaWdodDtcbiAgICBzY3JhdGNoT3B0aW9ucy5zaGFkb3dWb2x1bWUgPSBzaGFkb3dWb2x1bWU7XG4gICAgc2NyYXRjaE9wdGlvbnMub2Zmc2V0QXR0cmlidXRlID1cbiAgICAgIG9mZnNldEF0dHJpYnV0ZSA9PT0gLTEgPyB1bmRlZmluZWQgOiBvZmZzZXRBdHRyaWJ1dGU7XG5cbiAgICByZXR1cm4gbmV3IFJlY3RhbmdsZUdlb21ldHJ5KHNjcmF0Y2hPcHRpb25zKTtcbiAgfVxuXG4gIHJlc3VsdC5fcmVjdGFuZ2xlID0gUmVjdGFuZ2xlLmNsb25lKHJlY3RhbmdsZSwgcmVzdWx0Ll9yZWN0YW5nbGUpO1xuICByZXN1bHQuX2VsbGlwc29pZCA9IEVsbGlwc29pZC5jbG9uZShlbGxpcHNvaWQsIHJlc3VsdC5fZWxsaXBzb2lkKTtcbiAgcmVzdWx0Ll92ZXJ0ZXhGb3JtYXQgPSBWZXJ0ZXhGb3JtYXQuY2xvbmUodmVydGV4Rm9ybWF0LCByZXN1bHQuX3ZlcnRleEZvcm1hdCk7XG4gIHJlc3VsdC5fZ3JhbnVsYXJpdHkgPSBncmFudWxhcml0eTtcbiAgcmVzdWx0Ll9zdXJmYWNlSGVpZ2h0ID0gc3VyZmFjZUhlaWdodDtcbiAgcmVzdWx0Ll9yb3RhdGlvbiA9IHJvdGF0aW9uO1xuICByZXN1bHQuX3N0Um90YXRpb24gPSBzdFJvdGF0aW9uO1xuICByZXN1bHQuX2V4dHJ1ZGVkSGVpZ2h0ID0gZXh0cnVkZWRIZWlnaHQ7XG4gIHJlc3VsdC5fc2hhZG93Vm9sdW1lID0gc2hhZG93Vm9sdW1lO1xuICByZXN1bHQuX29mZnNldEF0dHJpYnV0ZSA9XG4gICAgb2Zmc2V0QXR0cmlidXRlID09PSAtMSA/IHVuZGVmaW5lZCA6IG9mZnNldEF0dHJpYnV0ZTtcblxuICByZXR1cm4gcmVzdWx0O1xufTtcblxuLyoqXG4gKiBDb21wdXRlcyB0aGUgYm91bmRpbmcgcmVjdGFuZ2xlIGJhc2VkIG9uIHRoZSBwcm92aWRlZCBvcHRpb25zXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgT2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IG9wdGlvbnMucmVjdGFuZ2xlIEEgY2FydG9ncmFwaGljIHJlY3RhbmdsZSB3aXRoIG5vcnRoLCBzb3V0aCwgZWFzdCBhbmQgd2VzdCBwcm9wZXJ0aWVzIGluIHJhZGlhbnMuXG4gKiBAcGFyYW0ge0VsbGlwc29pZH0gW29wdGlvbnMuZWxsaXBzb2lkPUVsbGlwc29pZC5XR1M4NF0gVGhlIGVsbGlwc29pZCBvbiB3aGljaCB0aGUgcmVjdGFuZ2xlIGxpZXMuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMuZ3JhbnVsYXJpdHk9Q2VzaXVtTWF0aC5SQURJQU5TX1BFUl9ERUdSRUVdIFRoZSBkaXN0YW5jZSwgaW4gcmFkaWFucywgYmV0d2VlbiBlYWNoIGxhdGl0dWRlIGFuZCBsb25naXR1ZGUuIERldGVybWluZXMgdGhlIG51bWJlciBvZiBwb3NpdGlvbnMgaW4gdGhlIGJ1ZmZlci5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5yb3RhdGlvbj0wLjBdIFRoZSByb3RhdGlvbiBvZiB0aGUgcmVjdGFuZ2xlLCBpbiByYWRpYW5zLiBBIHBvc2l0aXZlIHJvdGF0aW9uIGlzIGNvdW50ZXItY2xvY2t3aXNlLlxuICogQHBhcmFtIHtSZWN0YW5nbGV9IFtyZXN1bHRdIEFuIG9iamVjdCBpbiB3aGljaCB0byBzdG9yZSB0aGUgcmVzdWx0LlxuICpcbiAqIEByZXR1cm5zIHtSZWN0YW5nbGV9IFRoZSByZXN1bHQgcmVjdGFuZ2xlXG4gKi9cblJlY3RhbmdsZUdlb21ldHJ5LmNvbXB1dGVSZWN0YW5nbGUgPSBmdW5jdGlvbiAob3B0aW9ucywgcmVzdWx0KSB7XG4gIG9wdGlvbnMgPSBkZWZhdWx0VmFsdWUob3B0aW9ucywgZGVmYXVsdFZhbHVlLkVNUFRZX09CSkVDVCk7XG5cbiAgdmFyIHJlY3RhbmdsZSA9IG9wdGlvbnMucmVjdGFuZ2xlO1xuXG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJyZWN0YW5nbGVcIiwgcmVjdGFuZ2xlKTtcbiAgUmVjdGFuZ2xlLnZhbGlkYXRlKHJlY3RhbmdsZSk7XG4gIGlmIChyZWN0YW5nbGUubm9ydGggPCByZWN0YW5nbGUuc291dGgpIHtcbiAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgICBcIm9wdGlvbnMucmVjdGFuZ2xlLm5vcnRoIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIG9wdGlvbnMucmVjdGFuZ2xlLnNvdXRoXCJcbiAgICApO1xuICB9XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIHZhciBncmFudWxhcml0eSA9IGRlZmF1bHRWYWx1ZShcbiAgICBvcHRpb25zLmdyYW51bGFyaXR5LFxuICAgIENlc2l1bU1hdGguUkFESUFOU19QRVJfREVHUkVFXG4gICk7XG4gIHZhciBlbGxpcHNvaWQgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5lbGxpcHNvaWQsIEVsbGlwc29pZC5XR1M4NCk7XG4gIHZhciByb3RhdGlvbiA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLnJvdGF0aW9uLCAwLjApO1xuXG4gIHJldHVybiBjb21wdXRlUmVjdGFuZ2xlKHJlY3RhbmdsZSwgZ3JhbnVsYXJpdHksIHJvdGF0aW9uLCBlbGxpcHNvaWQsIHJlc3VsdCk7XG59O1xuXG52YXIgdGFuZ2VudFJvdGF0aW9uTWF0cml4U2NyYXRjaCA9IG5ldyBNYXRyaXgzKCk7XG52YXIgcXVhdGVybmlvblNjcmF0Y2ggPSBuZXcgUXVhdGVybmlvbigpO1xudmFyIGNlbnRlclNjcmF0Y2ggPSBuZXcgQ2FydG9ncmFwaGljKCk7XG4vKipcbiAqIENvbXB1dGVzIHRoZSBnZW9tZXRyaWMgcmVwcmVzZW50YXRpb24gb2YgYSByZWN0YW5nbGUsIGluY2x1ZGluZyBpdHMgdmVydGljZXMsIGluZGljZXMsIGFuZCBhIGJvdW5kaW5nIHNwaGVyZS5cbiAqXG4gKiBAcGFyYW0ge1JlY3RhbmdsZUdlb21ldHJ5fSByZWN0YW5nbGVHZW9tZXRyeSBBIGRlc2NyaXB0aW9uIG9mIHRoZSByZWN0YW5nbGUuXG4gKiBAcmV0dXJucyB7R2VvbWV0cnl8dW5kZWZpbmVkfSBUaGUgY29tcHV0ZWQgdmVydGljZXMgYW5kIGluZGljZXMuXG4gKlxuICogQGV4Y2VwdGlvbiB7RGV2ZWxvcGVyRXJyb3J9IFJvdGF0ZWQgcmVjdGFuZ2xlIGlzIGludmFsaWQuXG4gKi9cblJlY3RhbmdsZUdlb21ldHJ5LmNyZWF0ZUdlb21ldHJ5ID0gZnVuY3Rpb24gKHJlY3RhbmdsZUdlb21ldHJ5KSB7XG4gIGlmIChcbiAgICBDZXNpdW1NYXRoLmVxdWFsc0Vwc2lsb24oXG4gICAgICByZWN0YW5nbGVHZW9tZXRyeS5fcmVjdGFuZ2xlLm5vcnRoLFxuICAgICAgcmVjdGFuZ2xlR2VvbWV0cnkuX3JlY3RhbmdsZS5zb3V0aCxcbiAgICAgIENlc2l1bU1hdGguRVBTSUxPTjEwXG4gICAgKSB8fFxuICAgIENlc2l1bU1hdGguZXF1YWxzRXBzaWxvbihcbiAgICAgIHJlY3RhbmdsZUdlb21ldHJ5Ll9yZWN0YW5nbGUuZWFzdCxcbiAgICAgIHJlY3RhbmdsZUdlb21ldHJ5Ll9yZWN0YW5nbGUud2VzdCxcbiAgICAgIENlc2l1bU1hdGguRVBTSUxPTjEwXG4gICAgKVxuICApIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgdmFyIHJlY3RhbmdsZSA9IHJlY3RhbmdsZUdlb21ldHJ5Ll9yZWN0YW5nbGU7XG4gIHZhciBlbGxpcHNvaWQgPSByZWN0YW5nbGVHZW9tZXRyeS5fZWxsaXBzb2lkO1xuICB2YXIgcm90YXRpb24gPSByZWN0YW5nbGVHZW9tZXRyeS5fcm90YXRpb247XG4gIHZhciBzdFJvdGF0aW9uID0gcmVjdGFuZ2xlR2VvbWV0cnkuX3N0Um90YXRpb247XG4gIHZhciB2ZXJ0ZXhGb3JtYXQgPSByZWN0YW5nbGVHZW9tZXRyeS5fdmVydGV4Rm9ybWF0O1xuXG4gIHZhciBjb21wdXRlZE9wdGlvbnMgPSBSZWN0YW5nbGVHZW9tZXRyeUxpYnJhcnkuY29tcHV0ZU9wdGlvbnMoXG4gICAgcmVjdGFuZ2xlLFxuICAgIHJlY3RhbmdsZUdlb21ldHJ5Ll9ncmFudWxhcml0eSxcbiAgICByb3RhdGlvbixcbiAgICBzdFJvdGF0aW9uLFxuICAgIHJlY3RhbmdsZVNjcmF0Y2gsXG4gICAgbndTY3JhdGNoLFxuICAgIHN0TndTY3JhdGNoXG4gICk7XG5cbiAgdmFyIHRhbmdlbnRSb3RhdGlvbk1hdHJpeCA9IHRhbmdlbnRSb3RhdGlvbk1hdHJpeFNjcmF0Y2g7XG4gIGlmIChzdFJvdGF0aW9uICE9PSAwIHx8IHJvdGF0aW9uICE9PSAwKSB7XG4gICAgdmFyIGNlbnRlciA9IFJlY3RhbmdsZS5jZW50ZXIocmVjdGFuZ2xlLCBjZW50ZXJTY3JhdGNoKTtcbiAgICB2YXIgYXhpcyA9IGVsbGlwc29pZC5nZW9kZXRpY1N1cmZhY2VOb3JtYWxDYXJ0b2dyYXBoaWMoY2VudGVyLCB2MVNjcmF0Y2gpO1xuICAgIFF1YXRlcm5pb24uZnJvbUF4aXNBbmdsZShheGlzLCAtc3RSb3RhdGlvbiwgcXVhdGVybmlvblNjcmF0Y2gpO1xuICAgIE1hdHJpeDMuZnJvbVF1YXRlcm5pb24ocXVhdGVybmlvblNjcmF0Y2gsIHRhbmdlbnRSb3RhdGlvbk1hdHJpeCk7XG4gIH0gZWxzZSB7XG4gICAgTWF0cml4My5jbG9uZShNYXRyaXgzLklERU5USVRZLCB0YW5nZW50Um90YXRpb25NYXRyaXgpO1xuICB9XG5cbiAgdmFyIHN1cmZhY2VIZWlnaHQgPSByZWN0YW5nbGVHZW9tZXRyeS5fc3VyZmFjZUhlaWdodDtcbiAgdmFyIGV4dHJ1ZGVkSGVpZ2h0ID0gcmVjdGFuZ2xlR2VvbWV0cnkuX2V4dHJ1ZGVkSGVpZ2h0O1xuICB2YXIgZXh0cnVkZSA9ICFDZXNpdW1NYXRoLmVxdWFsc0Vwc2lsb24oXG4gICAgc3VyZmFjZUhlaWdodCxcbiAgICBleHRydWRlZEhlaWdodCxcbiAgICAwLFxuICAgIENlc2l1bU1hdGguRVBTSUxPTjJcbiAgKTtcblxuICBjb21wdXRlZE9wdGlvbnMubG9uU2NhbGFyID0gMS4wIC8gcmVjdGFuZ2xlR2VvbWV0cnkuX3JlY3RhbmdsZS53aWR0aDtcbiAgY29tcHV0ZWRPcHRpb25zLmxhdFNjYWxhciA9IDEuMCAvIHJlY3RhbmdsZUdlb21ldHJ5Ll9yZWN0YW5nbGUuaGVpZ2h0O1xuICBjb21wdXRlZE9wdGlvbnMudGFuZ2VudFJvdGF0aW9uTWF0cml4ID0gdGFuZ2VudFJvdGF0aW9uTWF0cml4O1xuXG4gIHZhciBnZW9tZXRyeTtcbiAgdmFyIGJvdW5kaW5nU3BoZXJlO1xuICByZWN0YW5nbGUgPSByZWN0YW5nbGVHZW9tZXRyeS5fcmVjdGFuZ2xlO1xuICBpZiAoZXh0cnVkZSkge1xuICAgIGdlb21ldHJ5ID0gY29uc3RydWN0RXh0cnVkZWRSZWN0YW5nbGUocmVjdGFuZ2xlR2VvbWV0cnksIGNvbXB1dGVkT3B0aW9ucyk7XG4gICAgdmFyIHRvcEJTID0gQm91bmRpbmdTcGhlcmUuZnJvbVJlY3RhbmdsZTNEKFxuICAgICAgcmVjdGFuZ2xlLFxuICAgICAgZWxsaXBzb2lkLFxuICAgICAgc3VyZmFjZUhlaWdodCxcbiAgICAgIHRvcEJvdW5kaW5nU3BoZXJlXG4gICAgKTtcbiAgICB2YXIgYm90dG9tQlMgPSBCb3VuZGluZ1NwaGVyZS5mcm9tUmVjdGFuZ2xlM0QoXG4gICAgICByZWN0YW5nbGUsXG4gICAgICBlbGxpcHNvaWQsXG4gICAgICBleHRydWRlZEhlaWdodCxcbiAgICAgIGJvdHRvbUJvdW5kaW5nU3BoZXJlXG4gICAgKTtcbiAgICBib3VuZGluZ1NwaGVyZSA9IEJvdW5kaW5nU3BoZXJlLnVuaW9uKHRvcEJTLCBib3R0b21CUyk7XG4gIH0gZWxzZSB7XG4gICAgZ2VvbWV0cnkgPSBjb25zdHJ1Y3RSZWN0YW5nbGUocmVjdGFuZ2xlR2VvbWV0cnksIGNvbXB1dGVkT3B0aW9ucyk7XG4gICAgZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi52YWx1ZXMgPSBQb2x5Z29uUGlwZWxpbmUuc2NhbGVUb0dlb2RldGljSGVpZ2h0KFxuICAgICAgZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi52YWx1ZXMsXG4gICAgICBzdXJmYWNlSGVpZ2h0LFxuICAgICAgZWxsaXBzb2lkLFxuICAgICAgZmFsc2VcbiAgICApO1xuXG4gICAgaWYgKGRlZmluZWQocmVjdGFuZ2xlR2VvbWV0cnkuX29mZnNldEF0dHJpYnV0ZSkpIHtcbiAgICAgIHZhciBsZW5ndGggPSBnZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLnZhbHVlcy5sZW5ndGg7XG4gICAgICB2YXIgYXBwbHlPZmZzZXQgPSBuZXcgVWludDhBcnJheShsZW5ndGggLyAzKTtcbiAgICAgIHZhciBvZmZzZXRWYWx1ZSA9XG4gICAgICAgIHJlY3RhbmdsZUdlb21ldHJ5Ll9vZmZzZXRBdHRyaWJ1dGUgPT09IEdlb21ldHJ5T2Zmc2V0QXR0cmlidXRlLk5PTkVcbiAgICAgICAgICA/IDBcbiAgICAgICAgICA6IDE7XG4gICAgICBhcnJheUZpbGwoYXBwbHlPZmZzZXQsIG9mZnNldFZhbHVlKTtcbiAgICAgIGdlb21ldHJ5LmF0dHJpYnV0ZXMuYXBwbHlPZmZzZXQgPSBuZXcgR2VvbWV0cnlBdHRyaWJ1dGUoe1xuICAgICAgICBjb21wb25lbnREYXRhdHlwZTogQ29tcG9uZW50RGF0YXR5cGUuVU5TSUdORURfQllURSxcbiAgICAgICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogMSxcbiAgICAgICAgdmFsdWVzOiBhcHBseU9mZnNldCxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGJvdW5kaW5nU3BoZXJlID0gQm91bmRpbmdTcGhlcmUuZnJvbVJlY3RhbmdsZTNEKFxuICAgICAgcmVjdGFuZ2xlLFxuICAgICAgZWxsaXBzb2lkLFxuICAgICAgc3VyZmFjZUhlaWdodFxuICAgICk7XG4gIH1cblxuICBpZiAoIXZlcnRleEZvcm1hdC5wb3NpdGlvbikge1xuICAgIGRlbGV0ZSBnZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uO1xuICB9XG5cbiAgcmV0dXJuIG5ldyBHZW9tZXRyeSh7XG4gICAgYXR0cmlidXRlczogZ2VvbWV0cnkuYXR0cmlidXRlcyxcbiAgICBpbmRpY2VzOiBnZW9tZXRyeS5pbmRpY2VzLFxuICAgIHByaW1pdGl2ZVR5cGU6IGdlb21ldHJ5LnByaW1pdGl2ZVR5cGUsXG4gICAgYm91bmRpbmdTcGhlcmU6IGJvdW5kaW5nU3BoZXJlLFxuICAgIG9mZnNldEF0dHJpYnV0ZTogcmVjdGFuZ2xlR2VvbWV0cnkuX29mZnNldEF0dHJpYnV0ZSxcbiAgfSk7XG59O1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKi9cblJlY3RhbmdsZUdlb21ldHJ5LmNyZWF0ZVNoYWRvd1ZvbHVtZSA9IGZ1bmN0aW9uIChcbiAgcmVjdGFuZ2xlR2VvbWV0cnksXG4gIG1pbkhlaWdodEZ1bmMsXG4gIG1heEhlaWdodEZ1bmNcbikge1xuICB2YXIgZ3JhbnVsYXJpdHkgPSByZWN0YW5nbGVHZW9tZXRyeS5fZ3JhbnVsYXJpdHk7XG4gIHZhciBlbGxpcHNvaWQgPSByZWN0YW5nbGVHZW9tZXRyeS5fZWxsaXBzb2lkO1xuXG4gIHZhciBtaW5IZWlnaHQgPSBtaW5IZWlnaHRGdW5jKGdyYW51bGFyaXR5LCBlbGxpcHNvaWQpO1xuICB2YXIgbWF4SGVpZ2h0ID0gbWF4SGVpZ2h0RnVuYyhncmFudWxhcml0eSwgZWxsaXBzb2lkKTtcblxuICByZXR1cm4gbmV3IFJlY3RhbmdsZUdlb21ldHJ5KHtcbiAgICByZWN0YW5nbGU6IHJlY3RhbmdsZUdlb21ldHJ5Ll9yZWN0YW5nbGUsXG4gICAgcm90YXRpb246IHJlY3RhbmdsZUdlb21ldHJ5Ll9yb3RhdGlvbixcbiAgICBlbGxpcHNvaWQ6IGVsbGlwc29pZCxcbiAgICBzdFJvdGF0aW9uOiByZWN0YW5nbGVHZW9tZXRyeS5fc3RSb3RhdGlvbixcbiAgICBncmFudWxhcml0eTogZ3JhbnVsYXJpdHksXG4gICAgZXh0cnVkZWRIZWlnaHQ6IG1heEhlaWdodCxcbiAgICBoZWlnaHQ6IG1pbkhlaWdodCxcbiAgICB2ZXJ0ZXhGb3JtYXQ6IFZlcnRleEZvcm1hdC5QT1NJVElPTl9PTkxZLFxuICAgIHNoYWRvd1ZvbHVtZTogdHJ1ZSxcbiAgfSk7XG59O1xuXG52YXIgdW5yb3RhdGVkVGV4dHVyZVJlY3RhbmdsZVNjcmF0Y2ggPSBuZXcgUmVjdGFuZ2xlKCk7XG52YXIgcG9pbnRzMkRTY3JhdGNoID0gW25ldyBDYXJ0ZXNpYW4yKCksIG5ldyBDYXJ0ZXNpYW4yKCksIG5ldyBDYXJ0ZXNpYW4yKCldO1xudmFyIHJvdGF0aW9uMkRTY3JhdGNoID0gbmV3IE1hdHJpeDIoKTtcbnZhciByZWN0YW5nbGVDZW50ZXJTY3JhdGNoID0gbmV3IENhcnRvZ3JhcGhpYygpO1xuXG5mdW5jdGlvbiB0ZXh0dXJlQ29vcmRpbmF0ZVJvdGF0aW9uUG9pbnRzKHJlY3RhbmdsZUdlb21ldHJ5KSB7XG4gIGlmIChyZWN0YW5nbGVHZW9tZXRyeS5fc3RSb3RhdGlvbiA9PT0gMC4wKSB7XG4gICAgcmV0dXJuIFswLCAwLCAwLCAxLCAxLCAwXTtcbiAgfVxuXG4gIHZhciByZWN0YW5nbGUgPSBSZWN0YW5nbGUuY2xvbmUoXG4gICAgcmVjdGFuZ2xlR2VvbWV0cnkuX3JlY3RhbmdsZSxcbiAgICB1bnJvdGF0ZWRUZXh0dXJlUmVjdGFuZ2xlU2NyYXRjaFxuICApO1xuICB2YXIgZ3JhbnVsYXJpdHkgPSByZWN0YW5nbGVHZW9tZXRyeS5fZ3JhbnVsYXJpdHk7XG4gIHZhciBlbGxpcHNvaWQgPSByZWN0YW5nbGVHZW9tZXRyeS5fZWxsaXBzb2lkO1xuXG4gIC8vIFJvdGF0ZSB0byBhbGlnbiB0aGUgdGV4dHVyZSBjb29yZGluYXRlcyB3aXRoIEVOVVxuICB2YXIgcm90YXRpb24gPSByZWN0YW5nbGVHZW9tZXRyeS5fcm90YXRpb24gLSByZWN0YW5nbGVHZW9tZXRyeS5fc3RSb3RhdGlvbjtcblxuICB2YXIgdW5yb3RhdGVkVGV4dHVyZVJlY3RhbmdsZSA9IGNvbXB1dGVSZWN0YW5nbGUoXG4gICAgcmVjdGFuZ2xlLFxuICAgIGdyYW51bGFyaXR5LFxuICAgIHJvdGF0aW9uLFxuICAgIGVsbGlwc29pZCxcbiAgICB1bnJvdGF0ZWRUZXh0dXJlUmVjdGFuZ2xlU2NyYXRjaFxuICApO1xuXG4gIC8vIEFzc3VtZSBhIGNvbXB1dGVkIFwiZWFzdC1ub3J0aFwiIHRleHR1cmUgY29vcmRpbmF0ZSBzeXN0ZW0gYmFzZWQgb24gc3BoZXJpY2FsIG9yIHBsYW5hciB0cmlja3MsIGJvdW5kZWQgYnkgYGJvdW5kaW5nUmVjdGFuZ2xlYC5cbiAgLy8gVGhlIFwiZGVzaXJlZFwiIHRleHR1cmUgY29vcmRpbmF0ZSBzeXN0ZW0gZm9ybXMgYW4gb3JpZW50ZWQgcmVjdGFuZ2xlICh1bi1vcmllbnRlZCBjb21wdXRlZCkgYXJvdW5kIHRoZSBnZW9tZXRyeSB0aGF0IGNvbXBsZXRlbHkgYW5kIHRpZ2h0bHkgYm91bmRzIGl0LlxuICAvLyBXZSB3YW50IHRvIG1hcCBmcm9tIHRoZSBcImVhc3Qtbm9ydGhcIiB0ZXh0dXJlIGNvb3JkaW5hdGUgc3lzdGVtIGludG8gdGhlIFwiZGVzaXJlZFwiIHN5c3RlbSB1c2luZyBhIHBhaXIgb2YgbGluZXMgKGFuYWxhZ291cyBwbGFuZXMgaW4gMkQpXG4gIC8vIENvbXB1dGUgMyBjb3JuZXJzIG9mIHRoZSBcImRlc2lyZWRcIiB0ZXh0dXJlIGNvb3JkaW5hdGUgc3lzdGVtIGluIFwiZWFzdC1ub3J0aFwiIHRleHR1cmUgc3BhY2UgYnkgdGhlIGZvbGxvd2luZyBpbiBjYXJ0b2dyYXBoaWMgc3BhY2U6XG4gIC8vIC0gcm90YXRlIDMgb2YgdGhlIGNvcm5lcnMgaW4gdW5yb3RhdGVkVGV4dHVyZVJlY3RhbmdsZSBieSBzdFJvdGF0aW9uIGFyb3VuZCB0aGUgY2VudGVyIG9mIHRoZSBib3VuZGluZyByZWN0YW5nbGVcbiAgLy8gLSBhcHBseSB0aGUgXCJlYXN0LW5vcnRoXCIgc3lzdGVtJ3Mgbm9ybWFsaXphdGlvbiBmb3JtdWxhIHRvIHRoZSByb3RhdGVkIGNhcnRvZ3JhcGhpY3MsIGV2ZW4gdGhvdWdoIHRoaXMgaXMgbGlrZWx5IHRvIHByb2R1Y2UgdmFsdWVzIG91dHNpZGUgWzAtMV0uXG4gIC8vIFRoaXMgZ2l2ZXMgdXMgYSBzZXQgb2YgcG9pbnRzIGluIHRoZSBcImVhc3Qtbm9ydGhcIiB0ZXh0dXJlIGNvb3JkaW5hdGUgc3lzdGVtIHRoYXQgY2FuIGJlIHVzZWQgdG8gbWFwIFwiZWFzdC1ub3J0aFwiIHRleHR1cmUgY29vcmRpbmF0ZXMgdG8gXCJkZXNpcmVkLlwiXG5cbiAgdmFyIHBvaW50czJEID0gcG9pbnRzMkRTY3JhdGNoO1xuICBwb2ludHMyRFswXS54ID0gdW5yb3RhdGVkVGV4dHVyZVJlY3RhbmdsZS53ZXN0O1xuICBwb2ludHMyRFswXS55ID0gdW5yb3RhdGVkVGV4dHVyZVJlY3RhbmdsZS5zb3V0aDtcblxuICBwb2ludHMyRFsxXS54ID0gdW5yb3RhdGVkVGV4dHVyZVJlY3RhbmdsZS53ZXN0O1xuICBwb2ludHMyRFsxXS55ID0gdW5yb3RhdGVkVGV4dHVyZVJlY3RhbmdsZS5ub3J0aDtcblxuICBwb2ludHMyRFsyXS54ID0gdW5yb3RhdGVkVGV4dHVyZVJlY3RhbmdsZS5lYXN0O1xuICBwb2ludHMyRFsyXS55ID0gdW5yb3RhdGVkVGV4dHVyZVJlY3RhbmdsZS5zb3V0aDtcblxuICB2YXIgYm91bmRpbmdSZWN0YW5nbGUgPSByZWN0YW5nbGVHZW9tZXRyeS5yZWN0YW5nbGU7XG4gIHZhciB0b0Rlc2lyZWRJbkNvbXB1dGVkID0gTWF0cml4Mi5mcm9tUm90YXRpb24oXG4gICAgcmVjdGFuZ2xlR2VvbWV0cnkuX3N0Um90YXRpb24sXG4gICAgcm90YXRpb24yRFNjcmF0Y2hcbiAgKTtcbiAgdmFyIGJvdW5kaW5nUmVjdGFuZ2xlQ2VudGVyID0gUmVjdGFuZ2xlLmNlbnRlcihcbiAgICBib3VuZGluZ1JlY3RhbmdsZSxcbiAgICByZWN0YW5nbGVDZW50ZXJTY3JhdGNoXG4gICk7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyArK2kpIHtcbiAgICB2YXIgcG9pbnQyRCA9IHBvaW50czJEW2ldO1xuICAgIHBvaW50MkQueCAtPSBib3VuZGluZ1JlY3RhbmdsZUNlbnRlci5sb25naXR1ZGU7XG4gICAgcG9pbnQyRC55IC09IGJvdW5kaW5nUmVjdGFuZ2xlQ2VudGVyLmxhdGl0dWRlO1xuICAgIE1hdHJpeDIubXVsdGlwbHlCeVZlY3Rvcih0b0Rlc2lyZWRJbkNvbXB1dGVkLCBwb2ludDJELCBwb2ludDJEKTtcbiAgICBwb2ludDJELnggKz0gYm91bmRpbmdSZWN0YW5nbGVDZW50ZXIubG9uZ2l0dWRlO1xuICAgIHBvaW50MkQueSArPSBib3VuZGluZ1JlY3RhbmdsZUNlbnRlci5sYXRpdHVkZTtcblxuICAgIC8vIENvbnZlcnQgcG9pbnQgaW50byBlYXN0LW5vcnRoIHRleHR1cmUgY29vcmRpbmF0ZSBzcGFjZVxuICAgIHBvaW50MkQueCA9IChwb2ludDJELnggLSBib3VuZGluZ1JlY3RhbmdsZS53ZXN0KSAvIGJvdW5kaW5nUmVjdGFuZ2xlLndpZHRoO1xuICAgIHBvaW50MkQueSA9XG4gICAgICAocG9pbnQyRC55IC0gYm91bmRpbmdSZWN0YW5nbGUuc291dGgpIC8gYm91bmRpbmdSZWN0YW5nbGUuaGVpZ2h0O1xuICB9XG5cbiAgdmFyIG1pblhZQ29ybmVyID0gcG9pbnRzMkRbMF07XG4gIHZhciBtYXhZQ29ybmVyID0gcG9pbnRzMkRbMV07XG4gIHZhciBtYXhYQ29ybmVyID0gcG9pbnRzMkRbMl07XG4gIHZhciByZXN1bHQgPSBuZXcgQXJyYXkoNik7XG4gIENhcnRlc2lhbjIucGFjayhtaW5YWUNvcm5lciwgcmVzdWx0KTtcbiAgQ2FydGVzaWFuMi5wYWNrKG1heFlDb3JuZXIsIHJlc3VsdCwgMik7XG4gIENhcnRlc2lhbjIucGFjayhtYXhYQ29ybmVyLCByZXN1bHQsIDQpO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhSZWN0YW5nbGVHZW9tZXRyeS5wcm90b3R5cGUsIHtcbiAgLyoqXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICByZWN0YW5nbGU6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghZGVmaW5lZCh0aGlzLl9yb3RhdGVkUmVjdGFuZ2xlKSkge1xuICAgICAgICB0aGlzLl9yb3RhdGVkUmVjdGFuZ2xlID0gY29tcHV0ZVJlY3RhbmdsZShcbiAgICAgICAgICB0aGlzLl9yZWN0YW5nbGUsXG4gICAgICAgICAgdGhpcy5fZ3JhbnVsYXJpdHksXG4gICAgICAgICAgdGhpcy5fcm90YXRpb24sXG4gICAgICAgICAgdGhpcy5fZWxsaXBzb2lkXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5fcm90YXRlZFJlY3RhbmdsZTtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogRm9yIHJlbWFwcGluZyB0ZXh0dXJlIGNvb3JkaW5hdGVzIHdoZW4gcmVuZGVyaW5nIFJlY3RhbmdsZUdlb21ldHJpZXMgYXMgR3JvdW5kUHJpbWl0aXZlcy5cbiAgICogVGhpcyB2ZXJzaW9uIHBlcm1pdHMgc2tldyBpbiB0ZXh0dXJlcyBieSBjb21wdXRpbmcgb2Zmc2V0cyBkaXJlY3RseSBpbiBjYXJ0b2dyYXBoaWMgc3BhY2UgYW5kXG4gICAqIG1vcmUgYWNjdXJhdGVseSBhcHByb3hpbWF0ZXMgcmVuZGVyaW5nIFJlY3RhbmdsZUdlb21ldHJpZXMgd2l0aCBoZWlnaHQgYXMgc3RhbmRhcmQgUHJpbWl0aXZlcy5cbiAgICogQHNlZSBHZW9tZXRyeSNfdGV4dHVyZUNvb3JkaW5hdGVSb3RhdGlvblBvaW50c1xuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdGV4dHVyZUNvb3JkaW5hdGVSb3RhdGlvblBvaW50czoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKCFkZWZpbmVkKHRoaXMuX3RleHR1cmVDb29yZGluYXRlUm90YXRpb25Qb2ludHMpKSB7XG4gICAgICAgIHRoaXMuX3RleHR1cmVDb29yZGluYXRlUm90YXRpb25Qb2ludHMgPSB0ZXh0dXJlQ29vcmRpbmF0ZVJvdGF0aW9uUG9pbnRzKFxuICAgICAgICAgIHRoaXNcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLl90ZXh0dXJlQ29vcmRpbmF0ZVJvdGF0aW9uUG9pbnRzO1xuICAgIH0sXG4gIH0sXG59KTtcbmV4cG9ydCBkZWZhdWx0IFJlY3RhbmdsZUdlb21ldHJ5O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///96812\n')},62194:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(60216);\n/* harmony import */ var _Cartographic_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(51688);\n/* harmony import */ var _defined_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(82982);\n/* harmony import */ var _DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12572);\n/* harmony import */ var _GeographicProjection_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(39756);\n/* harmony import */ var _Math_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(99417);\n/* harmony import */ var _Matrix2_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(71171);\n/* harmony import */ var _Rectangle_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(96190);\n\n\n\n\n\n\n\n\n\nvar cos = Math.cos;\nvar sin = Math.sin;\nvar sqrt = Math.sqrt;\n\n/**\n * @private\n */\nvar RectangleGeometryLibrary = {};\n\n/**\n * @private\n */\nRectangleGeometryLibrary.computePosition = function (\n  computedOptions,\n  ellipsoid,\n  computeST,\n  row,\n  col,\n  position,\n  st\n) {\n  var radiiSquared = ellipsoid.radiiSquared;\n  var nwCorner = computedOptions.nwCorner;\n  var rectangle = computedOptions.boundingRectangle;\n\n  var stLatitude =\n    nwCorner.latitude -\n    computedOptions.granYCos * row +\n    col * computedOptions.granXSin;\n  var cosLatitude = cos(stLatitude);\n  var nZ = sin(stLatitude);\n  var kZ = radiiSquared.z * nZ;\n\n  var stLongitude =\n    nwCorner.longitude +\n    row * computedOptions.granYSin +\n    col * computedOptions.granXCos;\n  var nX = cosLatitude * cos(stLongitude);\n  var nY = cosLatitude * sin(stLongitude);\n\n  var kX = radiiSquared.x * nX;\n  var kY = radiiSquared.y * nY;\n\n  var gamma = sqrt(kX * nX + kY * nY + kZ * nZ);\n\n  position.x = kX / gamma;\n  position.y = kY / gamma;\n  position.z = kZ / gamma;\n\n  if (computeST) {\n    var stNwCorner = computedOptions.stNwCorner;\n    if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(stNwCorner)) {\n      stLatitude =\n        stNwCorner.latitude -\n        computedOptions.stGranYCos * row +\n        col * computedOptions.stGranXSin;\n      stLongitude =\n        stNwCorner.longitude +\n        row * computedOptions.stGranYSin +\n        col * computedOptions.stGranXCos;\n\n      st.x = (stLongitude - computedOptions.stWest) * computedOptions.lonScalar;\n      st.y = (stLatitude - computedOptions.stSouth) * computedOptions.latScalar;\n    } else {\n      st.x = (stLongitude - rectangle.west) * computedOptions.lonScalar;\n      st.y = (stLatitude - rectangle.south) * computedOptions.latScalar;\n    }\n  }\n};\n\nvar rotationMatrixScratch = new _Matrix2_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z();\nvar nwCartesian = new _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\nvar centerScratch = new _Cartographic_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\nvar centerCartesian = new _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\nvar proj = new _GeographicProjection_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\n\nfunction getRotationOptions(\n  nwCorner,\n  rotation,\n  granularityX,\n  granularityY,\n  center,\n  width,\n  height\n) {\n  var cosRotation = Math.cos(rotation);\n  var granYCos = granularityY * cosRotation;\n  var granXCos = granularityX * cosRotation;\n\n  var sinRotation = Math.sin(rotation);\n  var granYSin = granularityY * sinRotation;\n  var granXSin = granularityX * sinRotation;\n\n  nwCartesian = proj.project(nwCorner, nwCartesian);\n\n  nwCartesian = _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].subtract */ .Z.subtract(nwCartesian, centerCartesian, nwCartesian);\n  var rotationMatrix = _Matrix2_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].fromRotation */ .Z.fromRotation(rotation, rotationMatrixScratch);\n  nwCartesian = _Matrix2_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].multiplyByVector */ .Z.multiplyByVector(\n    rotationMatrix,\n    nwCartesian,\n    nwCartesian\n  );\n  nwCartesian = _Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].add */ .Z.add(nwCartesian, centerCartesian, nwCartesian);\n  nwCorner = proj.unproject(nwCartesian, nwCorner);\n\n  width -= 1;\n  height -= 1;\n\n  var latitude = nwCorner.latitude;\n  var latitude0 = latitude + width * granXSin;\n  var latitude1 = latitude - granYCos * height;\n  var latitude2 = latitude - granYCos * height + width * granXSin;\n\n  var north = Math.max(latitude, latitude0, latitude1, latitude2);\n  var south = Math.min(latitude, latitude0, latitude1, latitude2);\n\n  var longitude = nwCorner.longitude;\n  var longitude0 = longitude + width * granXCos;\n  var longitude1 = longitude + height * granYSin;\n  var longitude2 = longitude + height * granYSin + width * granXCos;\n\n  var east = Math.max(longitude, longitude0, longitude1, longitude2);\n  var west = Math.min(longitude, longitude0, longitude1, longitude2);\n\n  return {\n    north: north,\n    south: south,\n    east: east,\n    west: west,\n    granYCos: granYCos,\n    granYSin: granYSin,\n    granXCos: granXCos,\n    granXSin: granXSin,\n    nwCorner: nwCorner,\n  };\n}\n\n/**\n * @private\n */\nRectangleGeometryLibrary.computeOptions = function (\n  rectangle,\n  granularity,\n  rotation,\n  stRotation,\n  boundingRectangleScratch,\n  nwCornerResult,\n  stNwCornerResult\n) {\n  var east = rectangle.east;\n  var west = rectangle.west;\n  var north = rectangle.north;\n  var south = rectangle.south;\n\n  var northCap = false;\n  var southCap = false;\n\n  if (north === _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI_OVER_TWO */ .Z.PI_OVER_TWO) {\n    northCap = true;\n  }\n  if (south === -_Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI_OVER_TWO */ .Z.PI_OVER_TWO) {\n    southCap = true;\n  }\n\n  var width;\n  var height;\n  var granularityX;\n  var granularityY;\n  var dx;\n  var dy = north - south;\n  if (west > east) {\n    dx = _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI - west + east;\n  } else {\n    dx = east - west;\n  }\n\n  width = Math.ceil(dx / granularity) + 1;\n  height = Math.ceil(dy / granularity) + 1;\n  granularityX = dx / (width - 1);\n  granularityY = dy / (height - 1);\n\n  var nwCorner = _Rectangle_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].northwest */ .Z.northwest(rectangle, nwCornerResult);\n  var center = _Rectangle_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].center */ .Z.center(rectangle, centerScratch);\n  if (rotation !== 0 || stRotation !== 0) {\n    if (center.longitude < nwCorner.longitude) {\n      center.longitude += _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].TWO_PI */ .Z.TWO_PI;\n    }\n    centerCartesian = proj.project(center, centerCartesian);\n  }\n\n  var granYCos = granularityY;\n  var granXCos = granularityX;\n  var granYSin = 0.0;\n  var granXSin = 0.0;\n\n  var boundingRectangle = _Rectangle_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].clone */ .Z.clone(rectangle, boundingRectangleScratch);\n\n  var computedOptions = {\n    granYCos: granYCos,\n    granYSin: granYSin,\n    granXCos: granXCos,\n    granXSin: granXSin,\n    nwCorner: nwCorner,\n    boundingRectangle: boundingRectangle,\n    width: width,\n    height: height,\n    northCap: northCap,\n    southCap: southCap,\n  };\n\n  if (rotation !== 0) {\n    var rotationOptions = getRotationOptions(\n      nwCorner,\n      rotation,\n      granularityX,\n      granularityY,\n      center,\n      width,\n      height\n    );\n    north = rotationOptions.north;\n    south = rotationOptions.south;\n    east = rotationOptions.east;\n    west = rotationOptions.west;\n\n    //>>includeStart(\'debug\', pragmas.debug);\n    if (\n      north < -_Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI_OVER_TWO */ .Z.PI_OVER_TWO ||\n      north > _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI_OVER_TWO */ .Z.PI_OVER_TWO ||\n      south < -_Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI_OVER_TWO */ .Z.PI_OVER_TWO ||\n      south > _Math_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].PI_OVER_TWO */ .Z.PI_OVER_TWO\n    ) {\n      throw new _DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(\n        "Rotated rectangle is invalid.  It crosses over either the north or south pole."\n      );\n    }\n    //>>includeEnd(\'debug\')\n\n    computedOptions.granYCos = rotationOptions.granYCos;\n    computedOptions.granYSin = rotationOptions.granYSin;\n    computedOptions.granXCos = rotationOptions.granXCos;\n    computedOptions.granXSin = rotationOptions.granXSin;\n\n    boundingRectangle.north = north;\n    boundingRectangle.south = south;\n    boundingRectangle.east = east;\n    boundingRectangle.west = west;\n  }\n\n  if (stRotation !== 0) {\n    rotation = rotation - stRotation;\n    var stNwCorner = _Rectangle_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].northwest */ .Z.northwest(boundingRectangle, stNwCornerResult);\n\n    var stRotationOptions = getRotationOptions(\n      stNwCorner,\n      rotation,\n      granularityX,\n      granularityY,\n      center,\n      width,\n      height\n    );\n\n    computedOptions.stGranYCos = stRotationOptions.granYCos;\n    computedOptions.stGranXCos = stRotationOptions.granXCos;\n    computedOptions.stGranYSin = stRotationOptions.granYSin;\n    computedOptions.stGranXSin = stRotationOptions.granXSin;\n    computedOptions.stNwCorner = stNwCorner;\n    computedOptions.stWest = stRotationOptions.west;\n    computedOptions.stSouth = stRotationOptions.south;\n  }\n\n  return computedOptions;\n};\n/* harmony default export */ __webpack_exports__["Z"] = (RectangleGeometryLibrary);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjIxOTQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBeUM7QUFDSTtBQUNWO0FBQ2M7QUFDWTtBQUMxQjtBQUNBO0FBQ0k7O0FBRXZDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxRQUFRLGdFQUFPO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsZ0NBQWdDLDREQUFPO0FBQ3ZDLHNCQUFzQiwrREFBVTtBQUNoQyx3QkFBd0IsaUVBQVk7QUFDcEMsMEJBQTBCLCtEQUFVO0FBQ3BDLGVBQWUseUVBQW9COztBQUVuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBLGdCQUFnQixpRkFBbUI7QUFDbkMsdUJBQXVCLHNGQUFvQjtBQUMzQyxnQkFBZ0IsOEZBQXdCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHVFQUFjO0FBQzlCOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLGdCQUFnQixpRkFBc0I7QUFDdEM7QUFDQTtBQUNBLGlCQUFpQixpRkFBc0I7QUFDdkM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsdUVBQWlCO0FBQzFCLElBQUk7QUFDSjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGlCQUFpQixrRkFBbUI7QUFDcEMsZUFBZSw0RUFBZ0I7QUFDL0I7QUFDQTtBQUNBLDBCQUEwQix1RUFBaUI7QUFDM0M7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDBCQUEwQiwwRUFBZTs7QUFFekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGVBQWUsaUZBQXNCO0FBQ3JDLGNBQWMsaUZBQXNCO0FBQ3BDLGVBQWUsaUZBQXNCO0FBQ3JDLGNBQWMsaUZBQXNCO0FBQ3BDO0FBQ0EsZ0JBQWdCLG1FQUFjO0FBQzlCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHFCQUFxQixrRkFBbUI7O0FBRXhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSx5REFBZSx3QkFBd0IsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9Db3JlL1JlY3RhbmdsZUdlb21ldHJ5TGlicmFyeS5qcz80ZTZmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDYXJ0ZXNpYW4zIGZyb20gXCIuL0NhcnRlc2lhbjMuanNcIjtcbmltcG9ydCBDYXJ0b2dyYXBoaWMgZnJvbSBcIi4vQ2FydG9ncmFwaGljLmpzXCI7XG5pbXBvcnQgZGVmaW5lZCBmcm9tIFwiLi9kZWZpbmVkLmpzXCI7XG5pbXBvcnQgRGV2ZWxvcGVyRXJyb3IgZnJvbSBcIi4vRGV2ZWxvcGVyRXJyb3IuanNcIjtcbmltcG9ydCBHZW9ncmFwaGljUHJvamVjdGlvbiBmcm9tIFwiLi9HZW9ncmFwaGljUHJvamVjdGlvbi5qc1wiO1xuaW1wb3J0IENlc2l1bU1hdGggZnJvbSBcIi4vTWF0aC5qc1wiO1xuaW1wb3J0IE1hdHJpeDIgZnJvbSBcIi4vTWF0cml4Mi5qc1wiO1xuaW1wb3J0IFJlY3RhbmdsZSBmcm9tIFwiLi9SZWN0YW5nbGUuanNcIjtcblxudmFyIGNvcyA9IE1hdGguY29zO1xudmFyIHNpbiA9IE1hdGguc2luO1xudmFyIHNxcnQgPSBNYXRoLnNxcnQ7XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xudmFyIFJlY3RhbmdsZUdlb21ldHJ5TGlicmFyeSA9IHt9O1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKi9cblJlY3RhbmdsZUdlb21ldHJ5TGlicmFyeS5jb21wdXRlUG9zaXRpb24gPSBmdW5jdGlvbiAoXG4gIGNvbXB1dGVkT3B0aW9ucyxcbiAgZWxsaXBzb2lkLFxuICBjb21wdXRlU1QsXG4gIHJvdyxcbiAgY29sLFxuICBwb3NpdGlvbixcbiAgc3Rcbikge1xuICB2YXIgcmFkaWlTcXVhcmVkID0gZWxsaXBzb2lkLnJhZGlpU3F1YXJlZDtcbiAgdmFyIG53Q29ybmVyID0gY29tcHV0ZWRPcHRpb25zLm53Q29ybmVyO1xuICB2YXIgcmVjdGFuZ2xlID0gY29tcHV0ZWRPcHRpb25zLmJvdW5kaW5nUmVjdGFuZ2xlO1xuXG4gIHZhciBzdExhdGl0dWRlID1cbiAgICBud0Nvcm5lci5sYXRpdHVkZSAtXG4gICAgY29tcHV0ZWRPcHRpb25zLmdyYW5ZQ29zICogcm93ICtcbiAgICBjb2wgKiBjb21wdXRlZE9wdGlvbnMuZ3JhblhTaW47XG4gIHZhciBjb3NMYXRpdHVkZSA9IGNvcyhzdExhdGl0dWRlKTtcbiAgdmFyIG5aID0gc2luKHN0TGF0aXR1ZGUpO1xuICB2YXIga1ogPSByYWRpaVNxdWFyZWQueiAqIG5aO1xuXG4gIHZhciBzdExvbmdpdHVkZSA9XG4gICAgbndDb3JuZXIubG9uZ2l0dWRlICtcbiAgICByb3cgKiBjb21wdXRlZE9wdGlvbnMuZ3JhbllTaW4gK1xuICAgIGNvbCAqIGNvbXB1dGVkT3B0aW9ucy5ncmFuWENvcztcbiAgdmFyIG5YID0gY29zTGF0aXR1ZGUgKiBjb3Moc3RMb25naXR1ZGUpO1xuICB2YXIgblkgPSBjb3NMYXRpdHVkZSAqIHNpbihzdExvbmdpdHVkZSk7XG5cbiAgdmFyIGtYID0gcmFkaWlTcXVhcmVkLnggKiBuWDtcbiAgdmFyIGtZID0gcmFkaWlTcXVhcmVkLnkgKiBuWTtcblxuICB2YXIgZ2FtbWEgPSBzcXJ0KGtYICogblggKyBrWSAqIG5ZICsga1ogKiBuWik7XG5cbiAgcG9zaXRpb24ueCA9IGtYIC8gZ2FtbWE7XG4gIHBvc2l0aW9uLnkgPSBrWSAvIGdhbW1hO1xuICBwb3NpdGlvbi56ID0ga1ogLyBnYW1tYTtcblxuICBpZiAoY29tcHV0ZVNUKSB7XG4gICAgdmFyIHN0TndDb3JuZXIgPSBjb21wdXRlZE9wdGlvbnMuc3ROd0Nvcm5lcjtcbiAgICBpZiAoZGVmaW5lZChzdE53Q29ybmVyKSkge1xuICAgICAgc3RMYXRpdHVkZSA9XG4gICAgICAgIHN0TndDb3JuZXIubGF0aXR1ZGUgLVxuICAgICAgICBjb21wdXRlZE9wdGlvbnMuc3RHcmFuWUNvcyAqIHJvdyArXG4gICAgICAgIGNvbCAqIGNvbXB1dGVkT3B0aW9ucy5zdEdyYW5YU2luO1xuICAgICAgc3RMb25naXR1ZGUgPVxuICAgICAgICBzdE53Q29ybmVyLmxvbmdpdHVkZSArXG4gICAgICAgIHJvdyAqIGNvbXB1dGVkT3B0aW9ucy5zdEdyYW5ZU2luICtcbiAgICAgICAgY29sICogY29tcHV0ZWRPcHRpb25zLnN0R3JhblhDb3M7XG5cbiAgICAgIHN0LnggPSAoc3RMb25naXR1ZGUgLSBjb21wdXRlZE9wdGlvbnMuc3RXZXN0KSAqIGNvbXB1dGVkT3B0aW9ucy5sb25TY2FsYXI7XG4gICAgICBzdC55ID0gKHN0TGF0aXR1ZGUgLSBjb21wdXRlZE9wdGlvbnMuc3RTb3V0aCkgKiBjb21wdXRlZE9wdGlvbnMubGF0U2NhbGFyO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdC54ID0gKHN0TG9uZ2l0dWRlIC0gcmVjdGFuZ2xlLndlc3QpICogY29tcHV0ZWRPcHRpb25zLmxvblNjYWxhcjtcbiAgICAgIHN0LnkgPSAoc3RMYXRpdHVkZSAtIHJlY3RhbmdsZS5zb3V0aCkgKiBjb21wdXRlZE9wdGlvbnMubGF0U2NhbGFyO1xuICAgIH1cbiAgfVxufTtcblxudmFyIHJvdGF0aW9uTWF0cml4U2NyYXRjaCA9IG5ldyBNYXRyaXgyKCk7XG52YXIgbndDYXJ0ZXNpYW4gPSBuZXcgQ2FydGVzaWFuMygpO1xudmFyIGNlbnRlclNjcmF0Y2ggPSBuZXcgQ2FydG9ncmFwaGljKCk7XG52YXIgY2VudGVyQ2FydGVzaWFuID0gbmV3IENhcnRlc2lhbjMoKTtcbnZhciBwcm9qID0gbmV3IEdlb2dyYXBoaWNQcm9qZWN0aW9uKCk7XG5cbmZ1bmN0aW9uIGdldFJvdGF0aW9uT3B0aW9ucyhcbiAgbndDb3JuZXIsXG4gIHJvdGF0aW9uLFxuICBncmFudWxhcml0eVgsXG4gIGdyYW51bGFyaXR5WSxcbiAgY2VudGVyLFxuICB3aWR0aCxcbiAgaGVpZ2h0XG4pIHtcbiAgdmFyIGNvc1JvdGF0aW9uID0gTWF0aC5jb3Mocm90YXRpb24pO1xuICB2YXIgZ3JhbllDb3MgPSBncmFudWxhcml0eVkgKiBjb3NSb3RhdGlvbjtcbiAgdmFyIGdyYW5YQ29zID0gZ3JhbnVsYXJpdHlYICogY29zUm90YXRpb247XG5cbiAgdmFyIHNpblJvdGF0aW9uID0gTWF0aC5zaW4ocm90YXRpb24pO1xuICB2YXIgZ3JhbllTaW4gPSBncmFudWxhcml0eVkgKiBzaW5Sb3RhdGlvbjtcbiAgdmFyIGdyYW5YU2luID0gZ3JhbnVsYXJpdHlYICogc2luUm90YXRpb247XG5cbiAgbndDYXJ0ZXNpYW4gPSBwcm9qLnByb2plY3QobndDb3JuZXIsIG53Q2FydGVzaWFuKTtcblxuICBud0NhcnRlc2lhbiA9IENhcnRlc2lhbjMuc3VidHJhY3QobndDYXJ0ZXNpYW4sIGNlbnRlckNhcnRlc2lhbiwgbndDYXJ0ZXNpYW4pO1xuICB2YXIgcm90YXRpb25NYXRyaXggPSBNYXRyaXgyLmZyb21Sb3RhdGlvbihyb3RhdGlvbiwgcm90YXRpb25NYXRyaXhTY3JhdGNoKTtcbiAgbndDYXJ0ZXNpYW4gPSBNYXRyaXgyLm11bHRpcGx5QnlWZWN0b3IoXG4gICAgcm90YXRpb25NYXRyaXgsXG4gICAgbndDYXJ0ZXNpYW4sXG4gICAgbndDYXJ0ZXNpYW5cbiAgKTtcbiAgbndDYXJ0ZXNpYW4gPSBDYXJ0ZXNpYW4zLmFkZChud0NhcnRlc2lhbiwgY2VudGVyQ2FydGVzaWFuLCBud0NhcnRlc2lhbik7XG4gIG53Q29ybmVyID0gcHJvai51bnByb2plY3QobndDYXJ0ZXNpYW4sIG53Q29ybmVyKTtcblxuICB3aWR0aCAtPSAxO1xuICBoZWlnaHQgLT0gMTtcblxuICB2YXIgbGF0aXR1ZGUgPSBud0Nvcm5lci5sYXRpdHVkZTtcbiAgdmFyIGxhdGl0dWRlMCA9IGxhdGl0dWRlICsgd2lkdGggKiBncmFuWFNpbjtcbiAgdmFyIGxhdGl0dWRlMSA9IGxhdGl0dWRlIC0gZ3JhbllDb3MgKiBoZWlnaHQ7XG4gIHZhciBsYXRpdHVkZTIgPSBsYXRpdHVkZSAtIGdyYW5ZQ29zICogaGVpZ2h0ICsgd2lkdGggKiBncmFuWFNpbjtcblxuICB2YXIgbm9ydGggPSBNYXRoLm1heChsYXRpdHVkZSwgbGF0aXR1ZGUwLCBsYXRpdHVkZTEsIGxhdGl0dWRlMik7XG4gIHZhciBzb3V0aCA9IE1hdGgubWluKGxhdGl0dWRlLCBsYXRpdHVkZTAsIGxhdGl0dWRlMSwgbGF0aXR1ZGUyKTtcblxuICB2YXIgbG9uZ2l0dWRlID0gbndDb3JuZXIubG9uZ2l0dWRlO1xuICB2YXIgbG9uZ2l0dWRlMCA9IGxvbmdpdHVkZSArIHdpZHRoICogZ3JhblhDb3M7XG4gIHZhciBsb25naXR1ZGUxID0gbG9uZ2l0dWRlICsgaGVpZ2h0ICogZ3JhbllTaW47XG4gIHZhciBsb25naXR1ZGUyID0gbG9uZ2l0dWRlICsgaGVpZ2h0ICogZ3JhbllTaW4gKyB3aWR0aCAqIGdyYW5YQ29zO1xuXG4gIHZhciBlYXN0ID0gTWF0aC5tYXgobG9uZ2l0dWRlLCBsb25naXR1ZGUwLCBsb25naXR1ZGUxLCBsb25naXR1ZGUyKTtcbiAgdmFyIHdlc3QgPSBNYXRoLm1pbihsb25naXR1ZGUsIGxvbmdpdHVkZTAsIGxvbmdpdHVkZTEsIGxvbmdpdHVkZTIpO1xuXG4gIHJldHVybiB7XG4gICAgbm9ydGg6IG5vcnRoLFxuICAgIHNvdXRoOiBzb3V0aCxcbiAgICBlYXN0OiBlYXN0LFxuICAgIHdlc3Q6IHdlc3QsXG4gICAgZ3JhbllDb3M6IGdyYW5ZQ29zLFxuICAgIGdyYW5ZU2luOiBncmFuWVNpbixcbiAgICBncmFuWENvczogZ3JhblhDb3MsXG4gICAgZ3JhblhTaW46IGdyYW5YU2luLFxuICAgIG53Q29ybmVyOiBud0Nvcm5lcixcbiAgfTtcbn1cblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5SZWN0YW5nbGVHZW9tZXRyeUxpYnJhcnkuY29tcHV0ZU9wdGlvbnMgPSBmdW5jdGlvbiAoXG4gIHJlY3RhbmdsZSxcbiAgZ3JhbnVsYXJpdHksXG4gIHJvdGF0aW9uLFxuICBzdFJvdGF0aW9uLFxuICBib3VuZGluZ1JlY3RhbmdsZVNjcmF0Y2gsXG4gIG53Q29ybmVyUmVzdWx0LFxuICBzdE53Q29ybmVyUmVzdWx0XG4pIHtcbiAgdmFyIGVhc3QgPSByZWN0YW5nbGUuZWFzdDtcbiAgdmFyIHdlc3QgPSByZWN0YW5nbGUud2VzdDtcbiAgdmFyIG5vcnRoID0gcmVjdGFuZ2xlLm5vcnRoO1xuICB2YXIgc291dGggPSByZWN0YW5nbGUuc291dGg7XG5cbiAgdmFyIG5vcnRoQ2FwID0gZmFsc2U7XG4gIHZhciBzb3V0aENhcCA9IGZhbHNlO1xuXG4gIGlmIChub3J0aCA9PT0gQ2VzaXVtTWF0aC5QSV9PVkVSX1RXTykge1xuICAgIG5vcnRoQ2FwID0gdHJ1ZTtcbiAgfVxuICBpZiAoc291dGggPT09IC1DZXNpdW1NYXRoLlBJX09WRVJfVFdPKSB7XG4gICAgc291dGhDYXAgPSB0cnVlO1xuICB9XG5cbiAgdmFyIHdpZHRoO1xuICB2YXIgaGVpZ2h0O1xuICB2YXIgZ3JhbnVsYXJpdHlYO1xuICB2YXIgZ3JhbnVsYXJpdHlZO1xuICB2YXIgZHg7XG4gIHZhciBkeSA9IG5vcnRoIC0gc291dGg7XG4gIGlmICh3ZXN0ID4gZWFzdCkge1xuICAgIGR4ID0gQ2VzaXVtTWF0aC5UV09fUEkgLSB3ZXN0ICsgZWFzdDtcbiAgfSBlbHNlIHtcbiAgICBkeCA9IGVhc3QgLSB3ZXN0O1xuICB9XG5cbiAgd2lkdGggPSBNYXRoLmNlaWwoZHggLyBncmFudWxhcml0eSkgKyAxO1xuICBoZWlnaHQgPSBNYXRoLmNlaWwoZHkgLyBncmFudWxhcml0eSkgKyAxO1xuICBncmFudWxhcml0eVggPSBkeCAvICh3aWR0aCAtIDEpO1xuICBncmFudWxhcml0eVkgPSBkeSAvIChoZWlnaHQgLSAxKTtcblxuICB2YXIgbndDb3JuZXIgPSBSZWN0YW5nbGUubm9ydGh3ZXN0KHJlY3RhbmdsZSwgbndDb3JuZXJSZXN1bHQpO1xuICB2YXIgY2VudGVyID0gUmVjdGFuZ2xlLmNlbnRlcihyZWN0YW5nbGUsIGNlbnRlclNjcmF0Y2gpO1xuICBpZiAocm90YXRpb24gIT09IDAgfHwgc3RSb3RhdGlvbiAhPT0gMCkge1xuICAgIGlmIChjZW50ZXIubG9uZ2l0dWRlIDwgbndDb3JuZXIubG9uZ2l0dWRlKSB7XG4gICAgICBjZW50ZXIubG9uZ2l0dWRlICs9IENlc2l1bU1hdGguVFdPX1BJO1xuICAgIH1cbiAgICBjZW50ZXJDYXJ0ZXNpYW4gPSBwcm9qLnByb2plY3QoY2VudGVyLCBjZW50ZXJDYXJ0ZXNpYW4pO1xuICB9XG5cbiAgdmFyIGdyYW5ZQ29zID0gZ3JhbnVsYXJpdHlZO1xuICB2YXIgZ3JhblhDb3MgPSBncmFudWxhcml0eVg7XG4gIHZhciBncmFuWVNpbiA9IDAuMDtcbiAgdmFyIGdyYW5YU2luID0gMC4wO1xuXG4gIHZhciBib3VuZGluZ1JlY3RhbmdsZSA9IFJlY3RhbmdsZS5jbG9uZShyZWN0YW5nbGUsIGJvdW5kaW5nUmVjdGFuZ2xlU2NyYXRjaCk7XG5cbiAgdmFyIGNvbXB1dGVkT3B0aW9ucyA9IHtcbiAgICBncmFuWUNvczogZ3JhbllDb3MsXG4gICAgZ3JhbllTaW46IGdyYW5ZU2luLFxuICAgIGdyYW5YQ29zOiBncmFuWENvcyxcbiAgICBncmFuWFNpbjogZ3JhblhTaW4sXG4gICAgbndDb3JuZXI6IG53Q29ybmVyLFxuICAgIGJvdW5kaW5nUmVjdGFuZ2xlOiBib3VuZGluZ1JlY3RhbmdsZSxcbiAgICB3aWR0aDogd2lkdGgsXG4gICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgbm9ydGhDYXA6IG5vcnRoQ2FwLFxuICAgIHNvdXRoQ2FwOiBzb3V0aENhcCxcbiAgfTtcblxuICBpZiAocm90YXRpb24gIT09IDApIHtcbiAgICB2YXIgcm90YXRpb25PcHRpb25zID0gZ2V0Um90YXRpb25PcHRpb25zKFxuICAgICAgbndDb3JuZXIsXG4gICAgICByb3RhdGlvbixcbiAgICAgIGdyYW51bGFyaXR5WCxcbiAgICAgIGdyYW51bGFyaXR5WSxcbiAgICAgIGNlbnRlcixcbiAgICAgIHdpZHRoLFxuICAgICAgaGVpZ2h0XG4gICAgKTtcbiAgICBub3J0aCA9IHJvdGF0aW9uT3B0aW9ucy5ub3J0aDtcbiAgICBzb3V0aCA9IHJvdGF0aW9uT3B0aW9ucy5zb3V0aDtcbiAgICBlYXN0ID0gcm90YXRpb25PcHRpb25zLmVhc3Q7XG4gICAgd2VzdCA9IHJvdGF0aW9uT3B0aW9ucy53ZXN0O1xuXG4gICAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgICBpZiAoXG4gICAgICBub3J0aCA8IC1DZXNpdW1NYXRoLlBJX09WRVJfVFdPIHx8XG4gICAgICBub3J0aCA+IENlc2l1bU1hdGguUElfT1ZFUl9UV08gfHxcbiAgICAgIHNvdXRoIDwgLUNlc2l1bU1hdGguUElfT1ZFUl9UV08gfHxcbiAgICAgIHNvdXRoID4gQ2VzaXVtTWF0aC5QSV9PVkVSX1RXT1xuICAgICkge1xuICAgICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFxuICAgICAgICBcIlJvdGF0ZWQgcmVjdGFuZ2xlIGlzIGludmFsaWQuICBJdCBjcm9zc2VzIG92ZXIgZWl0aGVyIHRoZSBub3J0aCBvciBzb3V0aCBwb2xlLlwiXG4gICAgICApO1xuICAgIH1cbiAgICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKVxuXG4gICAgY29tcHV0ZWRPcHRpb25zLmdyYW5ZQ29zID0gcm90YXRpb25PcHRpb25zLmdyYW5ZQ29zO1xuICAgIGNvbXB1dGVkT3B0aW9ucy5ncmFuWVNpbiA9IHJvdGF0aW9uT3B0aW9ucy5ncmFuWVNpbjtcbiAgICBjb21wdXRlZE9wdGlvbnMuZ3JhblhDb3MgPSByb3RhdGlvbk9wdGlvbnMuZ3JhblhDb3M7XG4gICAgY29tcHV0ZWRPcHRpb25zLmdyYW5YU2luID0gcm90YXRpb25PcHRpb25zLmdyYW5YU2luO1xuXG4gICAgYm91bmRpbmdSZWN0YW5nbGUubm9ydGggPSBub3J0aDtcbiAgICBib3VuZGluZ1JlY3RhbmdsZS5zb3V0aCA9IHNvdXRoO1xuICAgIGJvdW5kaW5nUmVjdGFuZ2xlLmVhc3QgPSBlYXN0O1xuICAgIGJvdW5kaW5nUmVjdGFuZ2xlLndlc3QgPSB3ZXN0O1xuICB9XG5cbiAgaWYgKHN0Um90YXRpb24gIT09IDApIHtcbiAgICByb3RhdGlvbiA9IHJvdGF0aW9uIC0gc3RSb3RhdGlvbjtcbiAgICB2YXIgc3ROd0Nvcm5lciA9IFJlY3RhbmdsZS5ub3J0aHdlc3QoYm91bmRpbmdSZWN0YW5nbGUsIHN0TndDb3JuZXJSZXN1bHQpO1xuXG4gICAgdmFyIHN0Um90YXRpb25PcHRpb25zID0gZ2V0Um90YXRpb25PcHRpb25zKFxuICAgICAgc3ROd0Nvcm5lcixcbiAgICAgIHJvdGF0aW9uLFxuICAgICAgZ3JhbnVsYXJpdHlYLFxuICAgICAgZ3JhbnVsYXJpdHlZLFxuICAgICAgY2VudGVyLFxuICAgICAgd2lkdGgsXG4gICAgICBoZWlnaHRcbiAgICApO1xuXG4gICAgY29tcHV0ZWRPcHRpb25zLnN0R3JhbllDb3MgPSBzdFJvdGF0aW9uT3B0aW9ucy5ncmFuWUNvcztcbiAgICBjb21wdXRlZE9wdGlvbnMuc3RHcmFuWENvcyA9IHN0Um90YXRpb25PcHRpb25zLmdyYW5YQ29zO1xuICAgIGNvbXB1dGVkT3B0aW9ucy5zdEdyYW5ZU2luID0gc3RSb3RhdGlvbk9wdGlvbnMuZ3JhbllTaW47XG4gICAgY29tcHV0ZWRPcHRpb25zLnN0R3JhblhTaW4gPSBzdFJvdGF0aW9uT3B0aW9ucy5ncmFuWFNpbjtcbiAgICBjb21wdXRlZE9wdGlvbnMuc3ROd0Nvcm5lciA9IHN0TndDb3JuZXI7XG4gICAgY29tcHV0ZWRPcHRpb25zLnN0V2VzdCA9IHN0Um90YXRpb25PcHRpb25zLndlc3Q7XG4gICAgY29tcHV0ZWRPcHRpb25zLnN0U291dGggPSBzdFJvdGF0aW9uT3B0aW9ucy5zb3V0aDtcbiAgfVxuXG4gIHJldHVybiBjb21wdXRlZE9wdGlvbnM7XG59O1xuZXhwb3J0IGRlZmF1bHQgUmVjdGFuZ2xlR2VvbWV0cnlMaWJyYXJ5O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///62194\n')},19737:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _arrayFill_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(23401);\n/* harmony import */ var _BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(48243);\n/* harmony import */ var _Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(60216);\n/* harmony import */ var _Cartographic_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(51688);\n/* harmony import */ var _ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(84828);\n/* harmony import */ var _defaultValue_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(62200);\n/* harmony import */ var _defined_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(82982);\n/* harmony import */ var _DeveloperError_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(12572);\n/* harmony import */ var _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(50491);\n/* harmony import */ var _Geometry_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(82408);\n/* harmony import */ var _GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(13616);\n/* harmony import */ var _GeometryAttributes_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(56652);\n/* harmony import */ var _GeometryOffsetAttribute_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(87379);\n/* harmony import */ var _IndexDatatype_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(22832);\n/* harmony import */ var _Math_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(99417);\n/* harmony import */ var _PolygonPipeline_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(78284);\n/* harmony import */ var _PrimitiveType_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(97264);\n/* harmony import */ var _Rectangle_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(96190);\n/* harmony import */ var _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(62194);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar bottomBoundingSphere = new _BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\nvar topBoundingSphere = new _BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\nvar positionScratch = new _Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\nvar rectangleScratch = new _Rectangle_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z();\n\nfunction constructRectangle(geometry, computedOptions) {\n  var ellipsoid = geometry._ellipsoid;\n  var height = computedOptions.height;\n  var width = computedOptions.width;\n  var northCap = computedOptions.northCap;\n  var southCap = computedOptions.southCap;\n\n  var rowHeight = height;\n  var widthMultiplier = 2;\n  var size = 0;\n  var corners = 4;\n  if (northCap) {\n    widthMultiplier -= 1;\n    rowHeight -= 1;\n    size += 1;\n    corners -= 2;\n  }\n  if (southCap) {\n    widthMultiplier -= 1;\n    rowHeight -= 1;\n    size += 1;\n    corners -= 2;\n  }\n  size += widthMultiplier * width + 2 * rowHeight - corners;\n\n  var positions = new Float64Array(size * 3);\n\n  var posIndex = 0;\n  var row = 0;\n  var col;\n  var position = positionScratch;\n  if (northCap) {\n    _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].computePosition */ .Z.computePosition(\n      computedOptions,\n      ellipsoid,\n      false,\n      row,\n      0,\n      position\n    );\n    positions[posIndex++] = position.x;\n    positions[posIndex++] = position.y;\n    positions[posIndex++] = position.z;\n  } else {\n    for (col = 0; col < width; col++) {\n      _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].computePosition */ .Z.computePosition(\n        computedOptions,\n        ellipsoid,\n        false,\n        row,\n        col,\n        position\n      );\n      positions[posIndex++] = position.x;\n      positions[posIndex++] = position.y;\n      positions[posIndex++] = position.z;\n    }\n  }\n\n  col = width - 1;\n  for (row = 1; row < height; row++) {\n    _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].computePosition */ .Z.computePosition(\n      computedOptions,\n      ellipsoid,\n      false,\n      row,\n      col,\n      position\n    );\n    positions[posIndex++] = position.x;\n    positions[posIndex++] = position.y;\n    positions[posIndex++] = position.z;\n  }\n\n  row = height - 1;\n  if (!southCap) {\n    // if southCap is true, we dont need to add any more points because the south pole point was added by the iteration above\n    for (col = width - 2; col >= 0; col--) {\n      _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].computePosition */ .Z.computePosition(\n        computedOptions,\n        ellipsoid,\n        false,\n        row,\n        col,\n        position\n      );\n      positions[posIndex++] = position.x;\n      positions[posIndex++] = position.y;\n      positions[posIndex++] = position.z;\n    }\n  }\n\n  col = 0;\n  for (row = height - 2; row > 0; row--) {\n    _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].computePosition */ .Z.computePosition(\n      computedOptions,\n      ellipsoid,\n      false,\n      row,\n      col,\n      position\n    );\n    positions[posIndex++] = position.x;\n    positions[posIndex++] = position.y;\n    positions[posIndex++] = position.z;\n  }\n\n  var indicesSize = (positions.length / 3) * 2;\n  var indices = _IndexDatatype_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].createTypedArray */ .Z.createTypedArray(\n    positions.length / 3,\n    indicesSize\n  );\n\n  var index = 0;\n  for (var i = 0; i < positions.length / 3 - 1; i++) {\n    indices[index++] = i;\n    indices[index++] = i + 1;\n  }\n  indices[index++] = positions.length / 3 - 1;\n  indices[index++] = 0;\n\n  var geo = new _Geometry_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z({\n    attributes: new _GeometryAttributes_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z(),\n    primitiveType: _PrimitiveType_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"].LINES */ .Z.LINES,\n  });\n\n  geo.attributes.position = new _GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z({\n    componentDatatype: _ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].DOUBLE */ .Z.DOUBLE,\n    componentsPerAttribute: 3,\n    values: positions,\n  });\n  geo.indices = indices;\n\n  return geo;\n}\n\nfunction constructExtrudedRectangle(rectangleGeometry, computedOptions) {\n  var surfaceHeight = rectangleGeometry._surfaceHeight;\n  var extrudedHeight = rectangleGeometry._extrudedHeight;\n  var ellipsoid = rectangleGeometry._ellipsoid;\n  var minHeight = extrudedHeight;\n  var maxHeight = surfaceHeight;\n  var geo = constructRectangle(rectangleGeometry, computedOptions);\n\n  var height = computedOptions.height;\n  var width = computedOptions.width;\n\n  var topPositions = _PolygonPipeline_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].scaleToGeodeticHeight */ .Z.scaleToGeodeticHeight(\n    geo.attributes.position.values,\n    maxHeight,\n    ellipsoid,\n    false\n  );\n  var length = topPositions.length;\n  var positions = new Float64Array(length * 2);\n  positions.set(topPositions);\n  var bottomPositions = _PolygonPipeline_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].scaleToGeodeticHeight */ .Z.scaleToGeodeticHeight(\n    geo.attributes.position.values,\n    minHeight,\n    ellipsoid\n  );\n  positions.set(bottomPositions, length);\n  geo.attributes.position.values = positions;\n\n  var northCap = computedOptions.northCap;\n  var southCap = computedOptions.southCap;\n  var corners = 4;\n  if (northCap) {\n    corners -= 1;\n  }\n  if (southCap) {\n    corners -= 1;\n  }\n\n  var indicesSize = (positions.length / 3 + corners) * 2;\n  var indices = _IndexDatatype_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].createTypedArray */ .Z.createTypedArray(\n    positions.length / 3,\n    indicesSize\n  );\n  length = positions.length / 6;\n  var index = 0;\n  for (var i = 0; i < length - 1; i++) {\n    indices[index++] = i;\n    indices[index++] = i + 1;\n    indices[index++] = i + length;\n    indices[index++] = i + length + 1;\n  }\n  indices[index++] = length - 1;\n  indices[index++] = 0;\n  indices[index++] = length + length - 1;\n  indices[index++] = length;\n\n  indices[index++] = 0;\n  indices[index++] = length;\n\n  var bottomCorner;\n  if (northCap) {\n    bottomCorner = height - 1;\n  } else {\n    var topRightCorner = width - 1;\n    indices[index++] = topRightCorner;\n    indices[index++] = topRightCorner + length;\n    bottomCorner = width + height - 2;\n  }\n\n  indices[index++] = bottomCorner;\n  indices[index++] = bottomCorner + length;\n\n  if (!southCap) {\n    var bottomLeftCorner = width + bottomCorner - 1;\n    indices[index++] = bottomLeftCorner;\n    indices[index] = bottomLeftCorner + length;\n  }\n\n  geo.indices = indices;\n\n  return geo;\n}\n\n/**\n * A description of the outline of a a cartographic rectangle on an ellipsoid centered at the origin.\n *\n * @alias RectangleOutlineGeometry\n * @constructor\n *\n * @param {Object} options Object with the following properties:\n * @param {Rectangle} options.rectangle A cartographic rectangle with north, south, east and west properties in radians.\n * @param {Ellipsoid} [options.ellipsoid=Ellipsoid.WGS84] The ellipsoid on which the rectangle lies.\n * @param {Number} [options.granularity=CesiumMath.RADIANS_PER_DEGREE] The distance, in radians, between each latitude and longitude. Determines the number of positions in the buffer.\n * @param {Number} [options.height=0.0] The distance in meters between the rectangle and the ellipsoid surface.\n * @param {Number} [options.rotation=0.0] The rotation of the rectangle, in radians. A positive rotation is counter-clockwise.\n * @param {Number} [options.extrudedHeight] The distance in meters between the rectangle\'s extruded face and the ellipsoid surface.\n *\n * @exception {DeveloperError} <code>options.rectangle.north</code> must be in the interval [<code>-Pi/2</code>, <code>Pi/2</code>].\n * @exception {DeveloperError} <code>options.rectangle.south</code> must be in the interval [<code>-Pi/2</code>, <code>Pi/2</code>].\n * @exception {DeveloperError} <code>options.rectangle.east</code> must be in the interval [<code>-Pi</code>, <code>Pi</code>].\n * @exception {DeveloperError} <code>options.rectangle.west</code> must be in the interval [<code>-Pi</code>, <code>Pi</code>].\n * @exception {DeveloperError} <code>options.rectangle.north</code> must be greater than <code>rectangle.south</code>.\n *\n * @see RectangleOutlineGeometry#createGeometry\n *\n * @example\n * var rectangle = new Cesium.RectangleOutlineGeometry({\n *   ellipsoid : Cesium.Ellipsoid.WGS84,\n *   rectangle : Cesium.Rectangle.fromDegrees(-80.0, 39.0, -74.0, 42.0),\n *   height : 10000.0\n * });\n * var geometry = Cesium.RectangleOutlineGeometry.createGeometry(rectangle);\n */\nfunction RectangleOutlineGeometry(options) {\n  options = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options, _defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n\n  var rectangle = options.rectangle;\n  var granularity = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(\n    options.granularity,\n    _Math_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].RADIANS_PER_DEGREE */ .Z.RADIANS_PER_DEGREE\n  );\n  var ellipsoid = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options.ellipsoid, _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].WGS84 */ .Z.WGS84);\n  var rotation = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options.rotation, 0.0);\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(rectangle)) {\n    throw new _DeveloperError_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z("rectangle is required.");\n  }\n  _Rectangle_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].validate */ .Z.validate(rectangle);\n  if (rectangle.north < rectangle.south) {\n    throw new _DeveloperError_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z(\n      "options.rectangle.north must be greater than options.rectangle.south"\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  var height = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options.height, 0.0);\n  var extrudedHeight = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options.extrudedHeight, height);\n\n  this._rectangle = _Rectangle_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].clone */ .Z.clone(rectangle);\n  this._granularity = granularity;\n  this._ellipsoid = ellipsoid;\n  this._surfaceHeight = Math.max(height, extrudedHeight);\n  this._rotation = rotation;\n  this._extrudedHeight = Math.min(height, extrudedHeight);\n  this._offsetAttribute = options.offsetAttribute;\n  this._workerName = "createRectangleOutlineGeometry";\n}\n\n/**\n * The number of elements used to pack the object into an array.\n * @type {Number}\n */\nRectangleOutlineGeometry.packedLength =\n  _Rectangle_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].packedLength */ .Z.packedLength + _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].packedLength */ .Z.packedLength + 5;\n\n/**\n * Stores the provided instance into the provided array.\n *\n * @param {RectangleOutlineGeometry} value The value to pack.\n * @param {Number[]} array The array to pack into.\n * @param {Number} [startingIndex=0] The index into the array at which to start packing the elements.\n *\n * @returns {Number[]} The array that was packed into\n */\nRectangleOutlineGeometry.pack = function (value, array, startingIndex) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(value)) {\n    throw new _DeveloperError_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z("value is required");\n  }\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(array)) {\n    throw new _DeveloperError_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z("array is required");\n  }\n  //>>includeEnd(\'debug\');\n\n  startingIndex = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(startingIndex, 0);\n\n  _Rectangle_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].pack */ .Z.pack(value._rectangle, array, startingIndex);\n  startingIndex += _Rectangle_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].packedLength */ .Z.packedLength;\n\n  _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].pack */ .Z.pack(value._ellipsoid, array, startingIndex);\n  startingIndex += _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].packedLength */ .Z.packedLength;\n\n  array[startingIndex++] = value._granularity;\n  array[startingIndex++] = value._surfaceHeight;\n  array[startingIndex++] = value._rotation;\n  array[startingIndex++] = value._extrudedHeight;\n  array[startingIndex] = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(value._offsetAttribute, -1);\n\n  return array;\n};\n\nvar scratchRectangle = new _Rectangle_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z();\nvar scratchEllipsoid = _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].clone */ .Z.clone(_Ellipsoid_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].UNIT_SPHERE */ .Z.UNIT_SPHERE);\nvar scratchOptions = {\n  rectangle: scratchRectangle,\n  ellipsoid: scratchEllipsoid,\n  granularity: undefined,\n  height: undefined,\n  rotation: undefined,\n  extrudedHeight: undefined,\n  offsetAttribute: undefined,\n};\n\n/**\n * Retrieves an instance from a packed array.\n *\n * @param {Number[]} array The packed array.\n * @param {Number} [startingIndex=0] The starting index of the element to be unpacked.\n * @param {RectangleOutlineGeometry} [result] The object into which to store the result.\n * @returns {RectangleOutlineGeometry} The modified result parameter or a new Quaternion instance if one was not provided.\n */\nRectangleOutlineGeometry.unpack = function (array, startingIndex, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(array)) {\n    throw new _DeveloperError_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z("array is required");\n  }\n  //>>includeEnd(\'debug\');\n\n  startingIndex = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(startingIndex, 0);\n\n  var rectangle = _Rectangle_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].unpack */ .Z.unpack(array, startingIndex, scratchRectangle);\n  startingIndex += _Rectangle_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].packedLength */ .Z.packedLength;\n\n  var ellipsoid = _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].unpack */ .Z.unpack(array, startingIndex, scratchEllipsoid);\n  startingIndex += _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].packedLength */ .Z.packedLength;\n\n  var granularity = array[startingIndex++];\n  var height = array[startingIndex++];\n  var rotation = array[startingIndex++];\n  var extrudedHeight = array[startingIndex++];\n  var offsetAttribute = array[startingIndex];\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(result)) {\n    scratchOptions.granularity = granularity;\n    scratchOptions.height = height;\n    scratchOptions.rotation = rotation;\n    scratchOptions.extrudedHeight = extrudedHeight;\n    scratchOptions.offsetAttribute =\n      offsetAttribute === -1 ? undefined : offsetAttribute;\n\n    return new RectangleOutlineGeometry(scratchOptions);\n  }\n\n  result._rectangle = _Rectangle_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].clone */ .Z.clone(rectangle, result._rectangle);\n  result._ellipsoid = _Ellipsoid_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].clone */ .Z.clone(ellipsoid, result._ellipsoid);\n  result._surfaceHeight = height;\n  result._rotation = rotation;\n  result._extrudedHeight = extrudedHeight;\n  result._offsetAttribute =\n    offsetAttribute === -1 ? undefined : offsetAttribute;\n\n  return result;\n};\n\nvar nwScratch = new _Cartographic_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\n/**\n * Computes the geometric representation of an outline of a rectangle, including its vertices, indices, and a bounding sphere.\n *\n * @param {RectangleOutlineGeometry} rectangleGeometry A description of the rectangle outline.\n * @returns {Geometry|undefined} The computed vertices and indices.\n *\n * @exception {DeveloperError} Rotated rectangle is invalid.\n */\nRectangleOutlineGeometry.createGeometry = function (rectangleGeometry) {\n  var rectangle = rectangleGeometry._rectangle;\n  var ellipsoid = rectangleGeometry._ellipsoid;\n  var computedOptions = _RectangleGeometryLibrary_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].computeOptions */ .Z.computeOptions(\n    rectangle,\n    rectangleGeometry._granularity,\n    rectangleGeometry._rotation,\n    0,\n    rectangleScratch,\n    nwScratch\n  );\n\n  var geometry;\n  var boundingSphere;\n\n  if (\n    _Math_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].equalsEpsilon */ .Z.equalsEpsilon(\n      rectangle.north,\n      rectangle.south,\n      _Math_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].EPSILON10 */ .Z.EPSILON10\n    ) ||\n    _Math_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].equalsEpsilon */ .Z.equalsEpsilon(\n      rectangle.east,\n      rectangle.west,\n      _Math_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].EPSILON10 */ .Z.EPSILON10\n    )\n  ) {\n    return undefined;\n  }\n\n  var surfaceHeight = rectangleGeometry._surfaceHeight;\n  var extrudedHeight = rectangleGeometry._extrudedHeight;\n  var extrude = !_Math_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].equalsEpsilon */ .Z.equalsEpsilon(\n    surfaceHeight,\n    extrudedHeight,\n    0,\n    _Math_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].EPSILON2 */ .Z.EPSILON2\n  );\n  var offsetValue;\n  if (extrude) {\n    geometry = constructExtrudedRectangle(rectangleGeometry, computedOptions);\n    if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(rectangleGeometry._offsetAttribute)) {\n      var size = geometry.attributes.position.values.length / 3;\n      var offsetAttribute = new Uint8Array(size);\n      if (rectangleGeometry._offsetAttribute === _GeometryOffsetAttribute_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"].TOP */ .Z.TOP) {\n        offsetAttribute = (0,_arrayFill_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(offsetAttribute, 1, 0, size / 2);\n      } else {\n        offsetValue =\n          rectangleGeometry._offsetAttribute === _GeometryOffsetAttribute_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"].NONE */ .Z.NONE\n            ? 0\n            : 1;\n        offsetAttribute = (0,_arrayFill_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(offsetAttribute, offsetValue);\n      }\n\n      geometry.attributes.applyOffset = new _GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z({\n        componentDatatype: _ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].UNSIGNED_BYTE */ .Z.UNSIGNED_BYTE,\n        componentsPerAttribute: 1,\n        values: offsetAttribute,\n      });\n    }\n    var topBS = _BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].fromRectangle3D */ .Z.fromRectangle3D(\n      rectangle,\n      ellipsoid,\n      surfaceHeight,\n      topBoundingSphere\n    );\n    var bottomBS = _BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].fromRectangle3D */ .Z.fromRectangle3D(\n      rectangle,\n      ellipsoid,\n      extrudedHeight,\n      bottomBoundingSphere\n    );\n    boundingSphere = _BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].union */ .Z.union(topBS, bottomBS);\n  } else {\n    geometry = constructRectangle(rectangleGeometry, computedOptions);\n    geometry.attributes.position.values = _PolygonPipeline_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].scaleToGeodeticHeight */ .Z.scaleToGeodeticHeight(\n      geometry.attributes.position.values,\n      surfaceHeight,\n      ellipsoid,\n      false\n    );\n\n    if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(rectangleGeometry._offsetAttribute)) {\n      var length = geometry.attributes.position.values.length;\n      var applyOffset = new Uint8Array(length / 3);\n      offsetValue =\n        rectangleGeometry._offsetAttribute === _GeometryOffsetAttribute_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"].NONE */ .Z.NONE\n          ? 0\n          : 1;\n      (0,_arrayFill_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(applyOffset, offsetValue);\n      geometry.attributes.applyOffset = new _GeometryAttribute_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z({\n        componentDatatype: _ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].UNSIGNED_BYTE */ .Z.UNSIGNED_BYTE,\n        componentsPerAttribute: 1,\n        values: applyOffset,\n      });\n    }\n\n    boundingSphere = _BoundingSphere_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].fromRectangle3D */ .Z.fromRectangle3D(\n      rectangle,\n      ellipsoid,\n      surfaceHeight\n    );\n  }\n\n  return new _Geometry_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z({\n    attributes: geometry.attributes,\n    indices: geometry.indices,\n    primitiveType: _PrimitiveType_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"].LINES */ .Z.LINES,\n    boundingSphere: boundingSphere,\n    offsetAttribute: rectangleGeometry._offsetAttribute,\n  });\n};\n/* harmony default export */ __webpack_exports__["Z"] = (RectangleOutlineGeometry);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTk3MzcuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUF1QztBQUNVO0FBQ1I7QUFDSTtBQUNVO0FBQ1Y7QUFDVjtBQUNjO0FBQ1Y7QUFDRjtBQUNrQjtBQUNFO0FBQ1U7QUFDcEI7QUFDWjtBQUNnQjtBQUNKO0FBQ1I7QUFDOEI7O0FBRXJFLCtCQUErQixtRUFBYztBQUM3Qyw0QkFBNEIsbUVBQWM7QUFDMUMsMEJBQTBCLCtEQUFVO0FBQ3BDLDJCQUEyQiwrREFBUzs7QUFFcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksOEdBQXdDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLGtCQUFrQixhQUFhO0FBQy9CLE1BQU0sOEdBQXdDO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGdCQUFnQixjQUFjO0FBQzlCLElBQUksOEdBQXdDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLFVBQVU7QUFDcEMsTUFBTSw4R0FBd0M7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EseUJBQXlCLFNBQVM7QUFDbEMsSUFBSSw4R0FBd0M7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGdCQUFnQixxR0FBOEI7QUFDOUM7QUFDQTtBQUNBOztBQUVBO0FBQ0Esa0JBQWtCLDhCQUE4QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGdCQUFnQiw2REFBUTtBQUN4QixvQkFBb0Isd0VBQWtCO0FBQ3RDLG1CQUFtQiwrRUFBbUI7QUFDdEMsR0FBRzs7QUFFSCxnQ0FBZ0Msc0VBQWlCO0FBQ2pELHVCQUF1QixvRkFBd0I7QUFDL0M7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEscUJBQXFCLGlIQUFxQztBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGlIQUFxQztBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZ0JBQWdCLHFHQUE4QjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGdCQUFnQjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsV0FBVyxXQUFXO0FBQ3RCLFdBQVcsV0FBVztBQUN0QixXQUFXLFFBQVE7QUFDbkIsV0FBVyxRQUFRO0FBQ25CLFdBQVcsUUFBUTtBQUNuQixXQUFXLFFBQVE7QUFDbkI7QUFDQSxlQUFlLGdCQUFnQjtBQUMvQixlQUFlLGdCQUFnQjtBQUMvQixlQUFlLGdCQUFnQjtBQUMvQixlQUFlLGdCQUFnQjtBQUMvQixlQUFlLGdCQUFnQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLFlBQVkscUVBQVksVUFBVSwyRkFBeUI7O0FBRTNEO0FBQ0Esb0JBQW9CLHFFQUFZO0FBQ2hDO0FBQ0EsSUFBSSxnR0FBNkI7QUFDakM7QUFDQSxrQkFBa0IscUVBQVksb0JBQW9CLDBFQUFlO0FBQ2pFLGlCQUFpQixxRUFBWTs7QUFFN0I7QUFDQSxPQUFPLGlFQUFPO0FBQ2QsY0FBYyxtRUFBYztBQUM1QjtBQUNBLEVBQUUsaUZBQWtCO0FBQ3BCO0FBQ0EsY0FBYyxtRUFBYztBQUM1QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxlQUFlLHFFQUFZO0FBQzNCLHVCQUF1QixxRUFBWTs7QUFFbkMsb0JBQW9CLDJFQUFlO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsRUFBRSx5RkFBc0IsR0FBRyx3RkFBc0I7O0FBRWpEO0FBQ0E7QUFDQTtBQUNBLFdBQVcsMEJBQTBCO0FBQ3JDLFdBQVcsVUFBVTtBQUNyQixXQUFXLFFBQVE7QUFDbkI7QUFDQSxhQUFhLFVBQVU7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsT0FBTyxpRUFBTztBQUNkLGNBQWMsbUVBQWM7QUFDNUI7O0FBRUEsT0FBTyxpRUFBTztBQUNkLGNBQWMsbUVBQWM7QUFDNUI7QUFDQTs7QUFFQSxrQkFBa0IscUVBQVk7O0FBRTlCLEVBQUUseUVBQWM7QUFDaEIsbUJBQW1CLHlGQUFzQjs7QUFFekMsRUFBRSx3RUFBYztBQUNoQixtQkFBbUIsd0ZBQXNCOztBQUV6QztBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixxRUFBWTs7QUFFckM7QUFDQTs7QUFFQSwyQkFBMkIsK0RBQVM7QUFDcEMsdUJBQXVCLDBFQUFlLENBQUMsc0ZBQXFCO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFVBQVU7QUFDckIsV0FBVyxRQUFRO0FBQ25CLFdBQVcsMEJBQTBCO0FBQ3JDLGFBQWEsMEJBQTBCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBLE9BQU8saUVBQU87QUFDZCxjQUFjLG1FQUFjO0FBQzVCO0FBQ0E7O0FBRUEsa0JBQWtCLHFFQUFZOztBQUU5QixrQkFBa0IsNkVBQWdCO0FBQ2xDLG1CQUFtQix5RkFBc0I7O0FBRXpDLGtCQUFrQiw0RUFBZ0I7QUFDbEMsbUJBQW1CLHdGQUFzQjs7QUFFekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPLGlFQUFPO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsc0JBQXNCLDJFQUFlO0FBQ3JDLHNCQUFzQiwwRUFBZTtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsb0JBQW9CLGlFQUFZO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBLFdBQVcsMEJBQTBCO0FBQ3JDLGFBQWEsb0JBQW9CO0FBQ2pDO0FBQ0EsZUFBZSxnQkFBZ0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNEdBQXVDO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxJQUFJLHNGQUF3QjtBQUM1QjtBQUNBO0FBQ0EsTUFBTSw4RUFBb0I7QUFDMUI7QUFDQSxJQUFJLHNGQUF3QjtBQUM1QjtBQUNBO0FBQ0EsTUFBTSw4RUFBb0I7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQixzRkFBd0I7QUFDekM7QUFDQTtBQUNBO0FBQ0EsSUFBSSw0RUFBbUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFPO0FBQ2Y7QUFDQTtBQUNBLGlEQUFpRCxxRkFBMkI7QUFDNUUsMEJBQTBCLGtFQUFTO0FBQ25DLFFBQVE7QUFDUjtBQUNBLGlEQUFpRCx1RkFBNEI7QUFDN0U7QUFDQTtBQUNBLDBCQUEwQixrRUFBUztBQUNuQzs7QUFFQSw0Q0FBNEMsc0VBQWlCO0FBQzdELDJCQUEyQixrR0FBK0I7QUFDMUQ7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLGdCQUFnQixtR0FBOEI7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixtR0FBOEI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQiwrRUFBb0I7QUFDekMsSUFBSTtBQUNKO0FBQ0EsMENBQTBDLGlIQUFxQztBQUMvRTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFFBQVEsaUVBQU87QUFDZjtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsdUZBQTRCO0FBQzNFO0FBQ0E7QUFDQSxNQUFNLGtFQUFTO0FBQ2YsNENBQTRDLHNFQUFpQjtBQUM3RCwyQkFBMkIsa0dBQStCO0FBQzFEO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUEscUJBQXFCLG1HQUE4QjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGFBQWEsNkRBQVE7QUFDckI7QUFDQTtBQUNBLG1CQUFtQiwrRUFBbUI7QUFDdEM7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLHlEQUFlLHdCQUF3QixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnVlMy13ZWJwYWNrNS8uL25vZGVfbW9kdWxlcy9jZXNpdW0vU291cmNlL0NvcmUvUmVjdGFuZ2xlT3V0bGluZUdlb21ldHJ5LmpzP2IyNmUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGFycmF5RmlsbCBmcm9tIFwiLi9hcnJheUZpbGwuanNcIjtcbmltcG9ydCBCb3VuZGluZ1NwaGVyZSBmcm9tIFwiLi9Cb3VuZGluZ1NwaGVyZS5qc1wiO1xuaW1wb3J0IENhcnRlc2lhbjMgZnJvbSBcIi4vQ2FydGVzaWFuMy5qc1wiO1xuaW1wb3J0IENhcnRvZ3JhcGhpYyBmcm9tIFwiLi9DYXJ0b2dyYXBoaWMuanNcIjtcbmltcG9ydCBDb21wb25lbnREYXRhdHlwZSBmcm9tIFwiLi9Db21wb25lbnREYXRhdHlwZS5qc1wiO1xuaW1wb3J0IGRlZmF1bHRWYWx1ZSBmcm9tIFwiLi9kZWZhdWx0VmFsdWUuanNcIjtcbmltcG9ydCBkZWZpbmVkIGZyb20gXCIuL2RlZmluZWQuanNcIjtcbmltcG9ydCBEZXZlbG9wZXJFcnJvciBmcm9tIFwiLi9EZXZlbG9wZXJFcnJvci5qc1wiO1xuaW1wb3J0IEVsbGlwc29pZCBmcm9tIFwiLi9FbGxpcHNvaWQuanNcIjtcbmltcG9ydCBHZW9tZXRyeSBmcm9tIFwiLi9HZW9tZXRyeS5qc1wiO1xuaW1wb3J0IEdlb21ldHJ5QXR0cmlidXRlIGZyb20gXCIuL0dlb21ldHJ5QXR0cmlidXRlLmpzXCI7XG5pbXBvcnQgR2VvbWV0cnlBdHRyaWJ1dGVzIGZyb20gXCIuL0dlb21ldHJ5QXR0cmlidXRlcy5qc1wiO1xuaW1wb3J0IEdlb21ldHJ5T2Zmc2V0QXR0cmlidXRlIGZyb20gXCIuL0dlb21ldHJ5T2Zmc2V0QXR0cmlidXRlLmpzXCI7XG5pbXBvcnQgSW5kZXhEYXRhdHlwZSBmcm9tIFwiLi9JbmRleERhdGF0eXBlLmpzXCI7XG5pbXBvcnQgQ2VzaXVtTWF0aCBmcm9tIFwiLi9NYXRoLmpzXCI7XG5pbXBvcnQgUG9seWdvblBpcGVsaW5lIGZyb20gXCIuL1BvbHlnb25QaXBlbGluZS5qc1wiO1xuaW1wb3J0IFByaW1pdGl2ZVR5cGUgZnJvbSBcIi4vUHJpbWl0aXZlVHlwZS5qc1wiO1xuaW1wb3J0IFJlY3RhbmdsZSBmcm9tIFwiLi9SZWN0YW5nbGUuanNcIjtcbmltcG9ydCBSZWN0YW5nbGVHZW9tZXRyeUxpYnJhcnkgZnJvbSBcIi4vUmVjdGFuZ2xlR2VvbWV0cnlMaWJyYXJ5LmpzXCI7XG5cbnZhciBib3R0b21Cb3VuZGluZ1NwaGVyZSA9IG5ldyBCb3VuZGluZ1NwaGVyZSgpO1xudmFyIHRvcEJvdW5kaW5nU3BoZXJlID0gbmV3IEJvdW5kaW5nU3BoZXJlKCk7XG52YXIgcG9zaXRpb25TY3JhdGNoID0gbmV3IENhcnRlc2lhbjMoKTtcbnZhciByZWN0YW5nbGVTY3JhdGNoID0gbmV3IFJlY3RhbmdsZSgpO1xuXG5mdW5jdGlvbiBjb25zdHJ1Y3RSZWN0YW5nbGUoZ2VvbWV0cnksIGNvbXB1dGVkT3B0aW9ucykge1xuICB2YXIgZWxsaXBzb2lkID0gZ2VvbWV0cnkuX2VsbGlwc29pZDtcbiAgdmFyIGhlaWdodCA9IGNvbXB1dGVkT3B0aW9ucy5oZWlnaHQ7XG4gIHZhciB3aWR0aCA9IGNvbXB1dGVkT3B0aW9ucy53aWR0aDtcbiAgdmFyIG5vcnRoQ2FwID0gY29tcHV0ZWRPcHRpb25zLm5vcnRoQ2FwO1xuICB2YXIgc291dGhDYXAgPSBjb21wdXRlZE9wdGlvbnMuc291dGhDYXA7XG5cbiAgdmFyIHJvd0hlaWdodCA9IGhlaWdodDtcbiAgdmFyIHdpZHRoTXVsdGlwbGllciA9IDI7XG4gIHZhciBzaXplID0gMDtcbiAgdmFyIGNvcm5lcnMgPSA0O1xuICBpZiAobm9ydGhDYXApIHtcbiAgICB3aWR0aE11bHRpcGxpZXIgLT0gMTtcbiAgICByb3dIZWlnaHQgLT0gMTtcbiAgICBzaXplICs9IDE7XG4gICAgY29ybmVycyAtPSAyO1xuICB9XG4gIGlmIChzb3V0aENhcCkge1xuICAgIHdpZHRoTXVsdGlwbGllciAtPSAxO1xuICAgIHJvd0hlaWdodCAtPSAxO1xuICAgIHNpemUgKz0gMTtcbiAgICBjb3JuZXJzIC09IDI7XG4gIH1cbiAgc2l6ZSArPSB3aWR0aE11bHRpcGxpZXIgKiB3aWR0aCArIDIgKiByb3dIZWlnaHQgLSBjb3JuZXJzO1xuXG4gIHZhciBwb3NpdGlvbnMgPSBuZXcgRmxvYXQ2NEFycmF5KHNpemUgKiAzKTtcblxuICB2YXIgcG9zSW5kZXggPSAwO1xuICB2YXIgcm93ID0gMDtcbiAgdmFyIGNvbDtcbiAgdmFyIHBvc2l0aW9uID0gcG9zaXRpb25TY3JhdGNoO1xuICBpZiAobm9ydGhDYXApIHtcbiAgICBSZWN0YW5nbGVHZW9tZXRyeUxpYnJhcnkuY29tcHV0ZVBvc2l0aW9uKFxuICAgICAgY29tcHV0ZWRPcHRpb25zLFxuICAgICAgZWxsaXBzb2lkLFxuICAgICAgZmFsc2UsXG4gICAgICByb3csXG4gICAgICAwLFxuICAgICAgcG9zaXRpb25cbiAgICApO1xuICAgIHBvc2l0aW9uc1twb3NJbmRleCsrXSA9IHBvc2l0aW9uLng7XG4gICAgcG9zaXRpb25zW3Bvc0luZGV4KytdID0gcG9zaXRpb24ueTtcbiAgICBwb3NpdGlvbnNbcG9zSW5kZXgrK10gPSBwb3NpdGlvbi56O1xuICB9IGVsc2Uge1xuICAgIGZvciAoY29sID0gMDsgY29sIDwgd2lkdGg7IGNvbCsrKSB7XG4gICAgICBSZWN0YW5nbGVHZW9tZXRyeUxpYnJhcnkuY29tcHV0ZVBvc2l0aW9uKFxuICAgICAgICBjb21wdXRlZE9wdGlvbnMsXG4gICAgICAgIGVsbGlwc29pZCxcbiAgICAgICAgZmFsc2UsXG4gICAgICAgIHJvdyxcbiAgICAgICAgY29sLFxuICAgICAgICBwb3NpdGlvblxuICAgICAgKTtcbiAgICAgIHBvc2l0aW9uc1twb3NJbmRleCsrXSA9IHBvc2l0aW9uLng7XG4gICAgICBwb3NpdGlvbnNbcG9zSW5kZXgrK10gPSBwb3NpdGlvbi55O1xuICAgICAgcG9zaXRpb25zW3Bvc0luZGV4KytdID0gcG9zaXRpb24uejtcbiAgICB9XG4gIH1cblxuICBjb2wgPSB3aWR0aCAtIDE7XG4gIGZvciAocm93ID0gMTsgcm93IDwgaGVpZ2h0OyByb3crKykge1xuICAgIFJlY3RhbmdsZUdlb21ldHJ5TGlicmFyeS5jb21wdXRlUG9zaXRpb24oXG4gICAgICBjb21wdXRlZE9wdGlvbnMsXG4gICAgICBlbGxpcHNvaWQsXG4gICAgICBmYWxzZSxcbiAgICAgIHJvdyxcbiAgICAgIGNvbCxcbiAgICAgIHBvc2l0aW9uXG4gICAgKTtcbiAgICBwb3NpdGlvbnNbcG9zSW5kZXgrK10gPSBwb3NpdGlvbi54O1xuICAgIHBvc2l0aW9uc1twb3NJbmRleCsrXSA9IHBvc2l0aW9uLnk7XG4gICAgcG9zaXRpb25zW3Bvc0luZGV4KytdID0gcG9zaXRpb24uejtcbiAgfVxuXG4gIHJvdyA9IGhlaWdodCAtIDE7XG4gIGlmICghc291dGhDYXApIHtcbiAgICAvLyBpZiBzb3V0aENhcCBpcyB0cnVlLCB3ZSBkb250IG5lZWQgdG8gYWRkIGFueSBtb3JlIHBvaW50cyBiZWNhdXNlIHRoZSBzb3V0aCBwb2xlIHBvaW50IHdhcyBhZGRlZCBieSB0aGUgaXRlcmF0aW9uIGFib3ZlXG4gICAgZm9yIChjb2wgPSB3aWR0aCAtIDI7IGNvbCA+PSAwOyBjb2wtLSkge1xuICAgICAgUmVjdGFuZ2xlR2VvbWV0cnlMaWJyYXJ5LmNvbXB1dGVQb3NpdGlvbihcbiAgICAgICAgY29tcHV0ZWRPcHRpb25zLFxuICAgICAgICBlbGxpcHNvaWQsXG4gICAgICAgIGZhbHNlLFxuICAgICAgICByb3csXG4gICAgICAgIGNvbCxcbiAgICAgICAgcG9zaXRpb25cbiAgICAgICk7XG4gICAgICBwb3NpdGlvbnNbcG9zSW5kZXgrK10gPSBwb3NpdGlvbi54O1xuICAgICAgcG9zaXRpb25zW3Bvc0luZGV4KytdID0gcG9zaXRpb24ueTtcbiAgICAgIHBvc2l0aW9uc1twb3NJbmRleCsrXSA9IHBvc2l0aW9uLno7XG4gICAgfVxuICB9XG5cbiAgY29sID0gMDtcbiAgZm9yIChyb3cgPSBoZWlnaHQgLSAyOyByb3cgPiAwOyByb3ctLSkge1xuICAgIFJlY3RhbmdsZUdlb21ldHJ5TGlicmFyeS5jb21wdXRlUG9zaXRpb24oXG4gICAgICBjb21wdXRlZE9wdGlvbnMsXG4gICAgICBlbGxpcHNvaWQsXG4gICAgICBmYWxzZSxcbiAgICAgIHJvdyxcbiAgICAgIGNvbCxcbiAgICAgIHBvc2l0aW9uXG4gICAgKTtcbiAgICBwb3NpdGlvbnNbcG9zSW5kZXgrK10gPSBwb3NpdGlvbi54O1xuICAgIHBvc2l0aW9uc1twb3NJbmRleCsrXSA9IHBvc2l0aW9uLnk7XG4gICAgcG9zaXRpb25zW3Bvc0luZGV4KytdID0gcG9zaXRpb24uejtcbiAgfVxuXG4gIHZhciBpbmRpY2VzU2l6ZSA9IChwb3NpdGlvbnMubGVuZ3RoIC8gMykgKiAyO1xuICB2YXIgaW5kaWNlcyA9IEluZGV4RGF0YXR5cGUuY3JlYXRlVHlwZWRBcnJheShcbiAgICBwb3NpdGlvbnMubGVuZ3RoIC8gMyxcbiAgICBpbmRpY2VzU2l6ZVxuICApO1xuXG4gIHZhciBpbmRleCA9IDA7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcG9zaXRpb25zLmxlbmd0aCAvIDMgLSAxOyBpKyspIHtcbiAgICBpbmRpY2VzW2luZGV4KytdID0gaTtcbiAgICBpbmRpY2VzW2luZGV4KytdID0gaSArIDE7XG4gIH1cbiAgaW5kaWNlc1tpbmRleCsrXSA9IHBvc2l0aW9ucy5sZW5ndGggLyAzIC0gMTtcbiAgaW5kaWNlc1tpbmRleCsrXSA9IDA7XG5cbiAgdmFyIGdlbyA9IG5ldyBHZW9tZXRyeSh7XG4gICAgYXR0cmlidXRlczogbmV3IEdlb21ldHJ5QXR0cmlidXRlcygpLFxuICAgIHByaW1pdGl2ZVR5cGU6IFByaW1pdGl2ZVR5cGUuTElORVMsXG4gIH0pO1xuXG4gIGdlby5hdHRyaWJ1dGVzLnBvc2l0aW9uID0gbmV3IEdlb21ldHJ5QXR0cmlidXRlKHtcbiAgICBjb21wb25lbnREYXRhdHlwZTogQ29tcG9uZW50RGF0YXR5cGUuRE9VQkxFLFxuICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGU6IDMsXG4gICAgdmFsdWVzOiBwb3NpdGlvbnMsXG4gIH0pO1xuICBnZW8uaW5kaWNlcyA9IGluZGljZXM7XG5cbiAgcmV0dXJuIGdlbztcbn1cblxuZnVuY3Rpb24gY29uc3RydWN0RXh0cnVkZWRSZWN0YW5nbGUocmVjdGFuZ2xlR2VvbWV0cnksIGNvbXB1dGVkT3B0aW9ucykge1xuICB2YXIgc3VyZmFjZUhlaWdodCA9IHJlY3RhbmdsZUdlb21ldHJ5Ll9zdXJmYWNlSGVpZ2h0O1xuICB2YXIgZXh0cnVkZWRIZWlnaHQgPSByZWN0YW5nbGVHZW9tZXRyeS5fZXh0cnVkZWRIZWlnaHQ7XG4gIHZhciBlbGxpcHNvaWQgPSByZWN0YW5nbGVHZW9tZXRyeS5fZWxsaXBzb2lkO1xuICB2YXIgbWluSGVpZ2h0ID0gZXh0cnVkZWRIZWlnaHQ7XG4gIHZhciBtYXhIZWlnaHQgPSBzdXJmYWNlSGVpZ2h0O1xuICB2YXIgZ2VvID0gY29uc3RydWN0UmVjdGFuZ2xlKHJlY3RhbmdsZUdlb21ldHJ5LCBjb21wdXRlZE9wdGlvbnMpO1xuXG4gIHZhciBoZWlnaHQgPSBjb21wdXRlZE9wdGlvbnMuaGVpZ2h0O1xuICB2YXIgd2lkdGggPSBjb21wdXRlZE9wdGlvbnMud2lkdGg7XG5cbiAgdmFyIHRvcFBvc2l0aW9ucyA9IFBvbHlnb25QaXBlbGluZS5zY2FsZVRvR2VvZGV0aWNIZWlnaHQoXG4gICAgZ2VvLmF0dHJpYnV0ZXMucG9zaXRpb24udmFsdWVzLFxuICAgIG1heEhlaWdodCxcbiAgICBlbGxpcHNvaWQsXG4gICAgZmFsc2VcbiAgKTtcbiAgdmFyIGxlbmd0aCA9IHRvcFBvc2l0aW9ucy5sZW5ndGg7XG4gIHZhciBwb3NpdGlvbnMgPSBuZXcgRmxvYXQ2NEFycmF5KGxlbmd0aCAqIDIpO1xuICBwb3NpdGlvbnMuc2V0KHRvcFBvc2l0aW9ucyk7XG4gIHZhciBib3R0b21Qb3NpdGlvbnMgPSBQb2x5Z29uUGlwZWxpbmUuc2NhbGVUb0dlb2RldGljSGVpZ2h0KFxuICAgIGdlby5hdHRyaWJ1dGVzLnBvc2l0aW9uLnZhbHVlcyxcbiAgICBtaW5IZWlnaHQsXG4gICAgZWxsaXBzb2lkXG4gICk7XG4gIHBvc2l0aW9ucy5zZXQoYm90dG9tUG9zaXRpb25zLCBsZW5ndGgpO1xuICBnZW8uYXR0cmlidXRlcy5wb3NpdGlvbi52YWx1ZXMgPSBwb3NpdGlvbnM7XG5cbiAgdmFyIG5vcnRoQ2FwID0gY29tcHV0ZWRPcHRpb25zLm5vcnRoQ2FwO1xuICB2YXIgc291dGhDYXAgPSBjb21wdXRlZE9wdGlvbnMuc291dGhDYXA7XG4gIHZhciBjb3JuZXJzID0gNDtcbiAgaWYgKG5vcnRoQ2FwKSB7XG4gICAgY29ybmVycyAtPSAxO1xuICB9XG4gIGlmIChzb3V0aENhcCkge1xuICAgIGNvcm5lcnMgLT0gMTtcbiAgfVxuXG4gIHZhciBpbmRpY2VzU2l6ZSA9IChwb3NpdGlvbnMubGVuZ3RoIC8gMyArIGNvcm5lcnMpICogMjtcbiAgdmFyIGluZGljZXMgPSBJbmRleERhdGF0eXBlLmNyZWF0ZVR5cGVkQXJyYXkoXG4gICAgcG9zaXRpb25zLmxlbmd0aCAvIDMsXG4gICAgaW5kaWNlc1NpemVcbiAgKTtcbiAgbGVuZ3RoID0gcG9zaXRpb25zLmxlbmd0aCAvIDY7XG4gIHZhciBpbmRleCA9IDA7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgaW5kaWNlc1tpbmRleCsrXSA9IGk7XG4gICAgaW5kaWNlc1tpbmRleCsrXSA9IGkgKyAxO1xuICAgIGluZGljZXNbaW5kZXgrK10gPSBpICsgbGVuZ3RoO1xuICAgIGluZGljZXNbaW5kZXgrK10gPSBpICsgbGVuZ3RoICsgMTtcbiAgfVxuICBpbmRpY2VzW2luZGV4KytdID0gbGVuZ3RoIC0gMTtcbiAgaW5kaWNlc1tpbmRleCsrXSA9IDA7XG4gIGluZGljZXNbaW5kZXgrK10gPSBsZW5ndGggKyBsZW5ndGggLSAxO1xuICBpbmRpY2VzW2luZGV4KytdID0gbGVuZ3RoO1xuXG4gIGluZGljZXNbaW5kZXgrK10gPSAwO1xuICBpbmRpY2VzW2luZGV4KytdID0gbGVuZ3RoO1xuXG4gIHZhciBib3R0b21Db3JuZXI7XG4gIGlmIChub3J0aENhcCkge1xuICAgIGJvdHRvbUNvcm5lciA9IGhlaWdodCAtIDE7XG4gIH0gZWxzZSB7XG4gICAgdmFyIHRvcFJpZ2h0Q29ybmVyID0gd2lkdGggLSAxO1xuICAgIGluZGljZXNbaW5kZXgrK10gPSB0b3BSaWdodENvcm5lcjtcbiAgICBpbmRpY2VzW2luZGV4KytdID0gdG9wUmlnaHRDb3JuZXIgKyBsZW5ndGg7XG4gICAgYm90dG9tQ29ybmVyID0gd2lkdGggKyBoZWlnaHQgLSAyO1xuICB9XG5cbiAgaW5kaWNlc1tpbmRleCsrXSA9IGJvdHRvbUNvcm5lcjtcbiAgaW5kaWNlc1tpbmRleCsrXSA9IGJvdHRvbUNvcm5lciArIGxlbmd0aDtcblxuICBpZiAoIXNvdXRoQ2FwKSB7XG4gICAgdmFyIGJvdHRvbUxlZnRDb3JuZXIgPSB3aWR0aCArIGJvdHRvbUNvcm5lciAtIDE7XG4gICAgaW5kaWNlc1tpbmRleCsrXSA9IGJvdHRvbUxlZnRDb3JuZXI7XG4gICAgaW5kaWNlc1tpbmRleF0gPSBib3R0b21MZWZ0Q29ybmVyICsgbGVuZ3RoO1xuICB9XG5cbiAgZ2VvLmluZGljZXMgPSBpbmRpY2VzO1xuXG4gIHJldHVybiBnZW87XG59XG5cbi8qKlxuICogQSBkZXNjcmlwdGlvbiBvZiB0aGUgb3V0bGluZSBvZiBhIGEgY2FydG9ncmFwaGljIHJlY3RhbmdsZSBvbiBhbiBlbGxpcHNvaWQgY2VudGVyZWQgYXQgdGhlIG9yaWdpbi5cbiAqXG4gKiBAYWxpYXMgUmVjdGFuZ2xlT3V0bGluZUdlb21ldHJ5XG4gKiBAY29uc3RydWN0b3JcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBPYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gKiBAcGFyYW0ge1JlY3RhbmdsZX0gb3B0aW9ucy5yZWN0YW5nbGUgQSBjYXJ0b2dyYXBoaWMgcmVjdGFuZ2xlIHdpdGggbm9ydGgsIHNvdXRoLCBlYXN0IGFuZCB3ZXN0IHByb3BlcnRpZXMgaW4gcmFkaWFucy5cbiAqIEBwYXJhbSB7RWxsaXBzb2lkfSBbb3B0aW9ucy5lbGxpcHNvaWQ9RWxsaXBzb2lkLldHUzg0XSBUaGUgZWxsaXBzb2lkIG9uIHdoaWNoIHRoZSByZWN0YW5nbGUgbGllcy5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5ncmFudWxhcml0eT1DZXNpdW1NYXRoLlJBRElBTlNfUEVSX0RFR1JFRV0gVGhlIGRpc3RhbmNlLCBpbiByYWRpYW5zLCBiZXR3ZWVuIGVhY2ggbGF0aXR1ZGUgYW5kIGxvbmdpdHVkZS4gRGV0ZXJtaW5lcyB0aGUgbnVtYmVyIG9mIHBvc2l0aW9ucyBpbiB0aGUgYnVmZmVyLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLmhlaWdodD0wLjBdIFRoZSBkaXN0YW5jZSBpbiBtZXRlcnMgYmV0d2VlbiB0aGUgcmVjdGFuZ2xlIGFuZCB0aGUgZWxsaXBzb2lkIHN1cmZhY2UuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMucm90YXRpb249MC4wXSBUaGUgcm90YXRpb24gb2YgdGhlIHJlY3RhbmdsZSwgaW4gcmFkaWFucy4gQSBwb3NpdGl2ZSByb3RhdGlvbiBpcyBjb3VudGVyLWNsb2Nrd2lzZS5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5leHRydWRlZEhlaWdodF0gVGhlIGRpc3RhbmNlIGluIG1ldGVycyBiZXR3ZWVuIHRoZSByZWN0YW5nbGUncyBleHRydWRlZCBmYWNlIGFuZCB0aGUgZWxsaXBzb2lkIHN1cmZhY2UuXG4gKlxuICogQGV4Y2VwdGlvbiB7RGV2ZWxvcGVyRXJyb3J9IDxjb2RlPm9wdGlvbnMucmVjdGFuZ2xlLm5vcnRoPC9jb2RlPiBtdXN0IGJlIGluIHRoZSBpbnRlcnZhbCBbPGNvZGU+LVBpLzI8L2NvZGU+LCA8Y29kZT5QaS8yPC9jb2RlPl0uXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gPGNvZGU+b3B0aW9ucy5yZWN0YW5nbGUuc291dGg8L2NvZGU+IG11c3QgYmUgaW4gdGhlIGludGVydmFsIFs8Y29kZT4tUGkvMjwvY29kZT4sIDxjb2RlPlBpLzI8L2NvZGU+XS5cbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSA8Y29kZT5vcHRpb25zLnJlY3RhbmdsZS5lYXN0PC9jb2RlPiBtdXN0IGJlIGluIHRoZSBpbnRlcnZhbCBbPGNvZGU+LVBpPC9jb2RlPiwgPGNvZGU+UGk8L2NvZGU+XS5cbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSA8Y29kZT5vcHRpb25zLnJlY3RhbmdsZS53ZXN0PC9jb2RlPiBtdXN0IGJlIGluIHRoZSBpbnRlcnZhbCBbPGNvZGU+LVBpPC9jb2RlPiwgPGNvZGU+UGk8L2NvZGU+XS5cbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSA8Y29kZT5vcHRpb25zLnJlY3RhbmdsZS5ub3J0aDwvY29kZT4gbXVzdCBiZSBncmVhdGVyIHRoYW4gPGNvZGU+cmVjdGFuZ2xlLnNvdXRoPC9jb2RlPi5cbiAqXG4gKiBAc2VlIFJlY3RhbmdsZU91dGxpbmVHZW9tZXRyeSNjcmVhdGVHZW9tZXRyeVxuICpcbiAqIEBleGFtcGxlXG4gKiB2YXIgcmVjdGFuZ2xlID0gbmV3IENlc2l1bS5SZWN0YW5nbGVPdXRsaW5lR2VvbWV0cnkoe1xuICogICBlbGxpcHNvaWQgOiBDZXNpdW0uRWxsaXBzb2lkLldHUzg0LFxuICogICByZWN0YW5nbGUgOiBDZXNpdW0uUmVjdGFuZ2xlLmZyb21EZWdyZWVzKC04MC4wLCAzOS4wLCAtNzQuMCwgNDIuMCksXG4gKiAgIGhlaWdodCA6IDEwMDAwLjBcbiAqIH0pO1xuICogdmFyIGdlb21ldHJ5ID0gQ2VzaXVtLlJlY3RhbmdsZU91dGxpbmVHZW9tZXRyeS5jcmVhdGVHZW9tZXRyeShyZWN0YW5nbGUpO1xuICovXG5mdW5jdGlvbiBSZWN0YW5nbGVPdXRsaW5lR2VvbWV0cnkob3B0aW9ucykge1xuICBvcHRpb25zID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMsIGRlZmF1bHRWYWx1ZS5FTVBUWV9PQkpFQ1QpO1xuXG4gIHZhciByZWN0YW5nbGUgPSBvcHRpb25zLnJlY3RhbmdsZTtcbiAgdmFyIGdyYW51bGFyaXR5ID0gZGVmYXVsdFZhbHVlKFxuICAgIG9wdGlvbnMuZ3JhbnVsYXJpdHksXG4gICAgQ2VzaXVtTWF0aC5SQURJQU5TX1BFUl9ERUdSRUVcbiAgKTtcbiAgdmFyIGVsbGlwc29pZCA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmVsbGlwc29pZCwgRWxsaXBzb2lkLldHUzg0KTtcbiAgdmFyIHJvdGF0aW9uID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMucm90YXRpb24sIDAuMCk7XG5cbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgaWYgKCFkZWZpbmVkKHJlY3RhbmdsZSkpIHtcbiAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXCJyZWN0YW5nbGUgaXMgcmVxdWlyZWQuXCIpO1xuICB9XG4gIFJlY3RhbmdsZS52YWxpZGF0ZShyZWN0YW5nbGUpO1xuICBpZiAocmVjdGFuZ2xlLm5vcnRoIDwgcmVjdGFuZ2xlLnNvdXRoKSB7XG4gICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFxuICAgICAgXCJvcHRpb25zLnJlY3RhbmdsZS5ub3J0aCBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvcHRpb25zLnJlY3RhbmdsZS5zb3V0aFwiXG4gICAgKTtcbiAgfVxuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB2YXIgaGVpZ2h0ID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuaGVpZ2h0LCAwLjApO1xuICB2YXIgZXh0cnVkZWRIZWlnaHQgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5leHRydWRlZEhlaWdodCwgaGVpZ2h0KTtcblxuICB0aGlzLl9yZWN0YW5nbGUgPSBSZWN0YW5nbGUuY2xvbmUocmVjdGFuZ2xlKTtcbiAgdGhpcy5fZ3JhbnVsYXJpdHkgPSBncmFudWxhcml0eTtcbiAgdGhpcy5fZWxsaXBzb2lkID0gZWxsaXBzb2lkO1xuICB0aGlzLl9zdXJmYWNlSGVpZ2h0ID0gTWF0aC5tYXgoaGVpZ2h0LCBleHRydWRlZEhlaWdodCk7XG4gIHRoaXMuX3JvdGF0aW9uID0gcm90YXRpb247XG4gIHRoaXMuX2V4dHJ1ZGVkSGVpZ2h0ID0gTWF0aC5taW4oaGVpZ2h0LCBleHRydWRlZEhlaWdodCk7XG4gIHRoaXMuX29mZnNldEF0dHJpYnV0ZSA9IG9wdGlvbnMub2Zmc2V0QXR0cmlidXRlO1xuICB0aGlzLl93b3JrZXJOYW1lID0gXCJjcmVhdGVSZWN0YW5nbGVPdXRsaW5lR2VvbWV0cnlcIjtcbn1cblxuLyoqXG4gKiBUaGUgbnVtYmVyIG9mIGVsZW1lbnRzIHVzZWQgdG8gcGFjayB0aGUgb2JqZWN0IGludG8gYW4gYXJyYXkuXG4gKiBAdHlwZSB7TnVtYmVyfVxuICovXG5SZWN0YW5nbGVPdXRsaW5lR2VvbWV0cnkucGFja2VkTGVuZ3RoID1cbiAgUmVjdGFuZ2xlLnBhY2tlZExlbmd0aCArIEVsbGlwc29pZC5wYWNrZWRMZW5ndGggKyA1O1xuXG4vKipcbiAqIFN0b3JlcyB0aGUgcHJvdmlkZWQgaW5zdGFuY2UgaW50byB0aGUgcHJvdmlkZWQgYXJyYXkuXG4gKlxuICogQHBhcmFtIHtSZWN0YW5nbGVPdXRsaW5lR2VvbWV0cnl9IHZhbHVlIFRoZSB2YWx1ZSB0byBwYWNrLlxuICogQHBhcmFtIHtOdW1iZXJbXX0gYXJyYXkgVGhlIGFycmF5IHRvIHBhY2sgaW50by5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbc3RhcnRpbmdJbmRleD0wXSBUaGUgaW5kZXggaW50byB0aGUgYXJyYXkgYXQgd2hpY2ggdG8gc3RhcnQgcGFja2luZyB0aGUgZWxlbWVudHMuXG4gKlxuICogQHJldHVybnMge051bWJlcltdfSBUaGUgYXJyYXkgdGhhdCB3YXMgcGFja2VkIGludG9cbiAqL1xuUmVjdGFuZ2xlT3V0bGluZUdlb21ldHJ5LnBhY2sgPSBmdW5jdGlvbiAodmFsdWUsIGFycmF5LCBzdGFydGluZ0luZGV4KSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIGlmICghZGVmaW5lZCh2YWx1ZSkpIHtcbiAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXCJ2YWx1ZSBpcyByZXF1aXJlZFwiKTtcbiAgfVxuXG4gIGlmICghZGVmaW5lZChhcnJheSkpIHtcbiAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXCJhcnJheSBpcyByZXF1aXJlZFwiKTtcbiAgfVxuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICBzdGFydGluZ0luZGV4ID0gZGVmYXVsdFZhbHVlKHN0YXJ0aW5nSW5kZXgsIDApO1xuXG4gIFJlY3RhbmdsZS5wYWNrKHZhbHVlLl9yZWN0YW5nbGUsIGFycmF5LCBzdGFydGluZ0luZGV4KTtcbiAgc3RhcnRpbmdJbmRleCArPSBSZWN0YW5nbGUucGFja2VkTGVuZ3RoO1xuXG4gIEVsbGlwc29pZC5wYWNrKHZhbHVlLl9lbGxpcHNvaWQsIGFycmF5LCBzdGFydGluZ0luZGV4KTtcbiAgc3RhcnRpbmdJbmRleCArPSBFbGxpcHNvaWQucGFja2VkTGVuZ3RoO1xuXG4gIGFycmF5W3N0YXJ0aW5nSW5kZXgrK10gPSB2YWx1ZS5fZ3JhbnVsYXJpdHk7XG4gIGFycmF5W3N0YXJ0aW5nSW5kZXgrK10gPSB2YWx1ZS5fc3VyZmFjZUhlaWdodDtcbiAgYXJyYXlbc3RhcnRpbmdJbmRleCsrXSA9IHZhbHVlLl9yb3RhdGlvbjtcbiAgYXJyYXlbc3RhcnRpbmdJbmRleCsrXSA9IHZhbHVlLl9leHRydWRlZEhlaWdodDtcbiAgYXJyYXlbc3RhcnRpbmdJbmRleF0gPSBkZWZhdWx0VmFsdWUodmFsdWUuX29mZnNldEF0dHJpYnV0ZSwgLTEpO1xuXG4gIHJldHVybiBhcnJheTtcbn07XG5cbnZhciBzY3JhdGNoUmVjdGFuZ2xlID0gbmV3IFJlY3RhbmdsZSgpO1xudmFyIHNjcmF0Y2hFbGxpcHNvaWQgPSBFbGxpcHNvaWQuY2xvbmUoRWxsaXBzb2lkLlVOSVRfU1BIRVJFKTtcbnZhciBzY3JhdGNoT3B0aW9ucyA9IHtcbiAgcmVjdGFuZ2xlOiBzY3JhdGNoUmVjdGFuZ2xlLFxuICBlbGxpcHNvaWQ6IHNjcmF0Y2hFbGxpcHNvaWQsXG4gIGdyYW51bGFyaXR5OiB1bmRlZmluZWQsXG4gIGhlaWdodDogdW5kZWZpbmVkLFxuICByb3RhdGlvbjogdW5kZWZpbmVkLFxuICBleHRydWRlZEhlaWdodDogdW5kZWZpbmVkLFxuICBvZmZzZXRBdHRyaWJ1dGU6IHVuZGVmaW5lZCxcbn07XG5cbi8qKlxuICogUmV0cmlldmVzIGFuIGluc3RhbmNlIGZyb20gYSBwYWNrZWQgYXJyYXkuXG4gKlxuICogQHBhcmFtIHtOdW1iZXJbXX0gYXJyYXkgVGhlIHBhY2tlZCBhcnJheS5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbc3RhcnRpbmdJbmRleD0wXSBUaGUgc3RhcnRpbmcgaW5kZXggb2YgdGhlIGVsZW1lbnQgdG8gYmUgdW5wYWNrZWQuXG4gKiBAcGFyYW0ge1JlY3RhbmdsZU91dGxpbmVHZW9tZXRyeX0gW3Jlc3VsdF0gVGhlIG9iamVjdCBpbnRvIHdoaWNoIHRvIHN0b3JlIHRoZSByZXN1bHQuXG4gKiBAcmV0dXJucyB7UmVjdGFuZ2xlT3V0bGluZUdlb21ldHJ5fSBUaGUgbW9kaWZpZWQgcmVzdWx0IHBhcmFtZXRlciBvciBhIG5ldyBRdWF0ZXJuaW9uIGluc3RhbmNlIGlmIG9uZSB3YXMgbm90IHByb3ZpZGVkLlxuICovXG5SZWN0YW5nbGVPdXRsaW5lR2VvbWV0cnkudW5wYWNrID0gZnVuY3Rpb24gKGFycmF5LCBzdGFydGluZ0luZGV4LCByZXN1bHQpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgaWYgKCFkZWZpbmVkKGFycmF5KSkge1xuICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcImFycmF5IGlzIHJlcXVpcmVkXCIpO1xuICB9XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIHN0YXJ0aW5nSW5kZXggPSBkZWZhdWx0VmFsdWUoc3RhcnRpbmdJbmRleCwgMCk7XG5cbiAgdmFyIHJlY3RhbmdsZSA9IFJlY3RhbmdsZS51bnBhY2soYXJyYXksIHN0YXJ0aW5nSW5kZXgsIHNjcmF0Y2hSZWN0YW5nbGUpO1xuICBzdGFydGluZ0luZGV4ICs9IFJlY3RhbmdsZS5wYWNrZWRMZW5ndGg7XG5cbiAgdmFyIGVsbGlwc29pZCA9IEVsbGlwc29pZC51bnBhY2soYXJyYXksIHN0YXJ0aW5nSW5kZXgsIHNjcmF0Y2hFbGxpcHNvaWQpO1xuICBzdGFydGluZ0luZGV4ICs9IEVsbGlwc29pZC5wYWNrZWRMZW5ndGg7XG5cbiAgdmFyIGdyYW51bGFyaXR5ID0gYXJyYXlbc3RhcnRpbmdJbmRleCsrXTtcbiAgdmFyIGhlaWdodCA9IGFycmF5W3N0YXJ0aW5nSW5kZXgrK107XG4gIHZhciByb3RhdGlvbiA9IGFycmF5W3N0YXJ0aW5nSW5kZXgrK107XG4gIHZhciBleHRydWRlZEhlaWdodCA9IGFycmF5W3N0YXJ0aW5nSW5kZXgrK107XG4gIHZhciBvZmZzZXRBdHRyaWJ1dGUgPSBhcnJheVtzdGFydGluZ0luZGV4XTtcblxuICBpZiAoIWRlZmluZWQocmVzdWx0KSkge1xuICAgIHNjcmF0Y2hPcHRpb25zLmdyYW51bGFyaXR5ID0gZ3JhbnVsYXJpdHk7XG4gICAgc2NyYXRjaE9wdGlvbnMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIHNjcmF0Y2hPcHRpb25zLnJvdGF0aW9uID0gcm90YXRpb247XG4gICAgc2NyYXRjaE9wdGlvbnMuZXh0cnVkZWRIZWlnaHQgPSBleHRydWRlZEhlaWdodDtcbiAgICBzY3JhdGNoT3B0aW9ucy5vZmZzZXRBdHRyaWJ1dGUgPVxuICAgICAgb2Zmc2V0QXR0cmlidXRlID09PSAtMSA/IHVuZGVmaW5lZCA6IG9mZnNldEF0dHJpYnV0ZTtcblxuICAgIHJldHVybiBuZXcgUmVjdGFuZ2xlT3V0bGluZUdlb21ldHJ5KHNjcmF0Y2hPcHRpb25zKTtcbiAgfVxuXG4gIHJlc3VsdC5fcmVjdGFuZ2xlID0gUmVjdGFuZ2xlLmNsb25lKHJlY3RhbmdsZSwgcmVzdWx0Ll9yZWN0YW5nbGUpO1xuICByZXN1bHQuX2VsbGlwc29pZCA9IEVsbGlwc29pZC5jbG9uZShlbGxpcHNvaWQsIHJlc3VsdC5fZWxsaXBzb2lkKTtcbiAgcmVzdWx0Ll9zdXJmYWNlSGVpZ2h0ID0gaGVpZ2h0O1xuICByZXN1bHQuX3JvdGF0aW9uID0gcm90YXRpb247XG4gIHJlc3VsdC5fZXh0cnVkZWRIZWlnaHQgPSBleHRydWRlZEhlaWdodDtcbiAgcmVzdWx0Ll9vZmZzZXRBdHRyaWJ1dGUgPVxuICAgIG9mZnNldEF0dHJpYnV0ZSA9PT0gLTEgPyB1bmRlZmluZWQgOiBvZmZzZXRBdHRyaWJ1dGU7XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbnZhciBud1NjcmF0Y2ggPSBuZXcgQ2FydG9ncmFwaGljKCk7XG4vKipcbiAqIENvbXB1dGVzIHRoZSBnZW9tZXRyaWMgcmVwcmVzZW50YXRpb24gb2YgYW4gb3V0bGluZSBvZiBhIHJlY3RhbmdsZSwgaW5jbHVkaW5nIGl0cyB2ZXJ0aWNlcywgaW5kaWNlcywgYW5kIGEgYm91bmRpbmcgc3BoZXJlLlxuICpcbiAqIEBwYXJhbSB7UmVjdGFuZ2xlT3V0bGluZUdlb21ldHJ5fSByZWN0YW5nbGVHZW9tZXRyeSBBIGRlc2NyaXB0aW9uIG9mIHRoZSByZWN0YW5nbGUgb3V0bGluZS5cbiAqIEByZXR1cm5zIHtHZW9tZXRyeXx1bmRlZmluZWR9IFRoZSBjb21wdXRlZCB2ZXJ0aWNlcyBhbmQgaW5kaWNlcy5cbiAqXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gUm90YXRlZCByZWN0YW5nbGUgaXMgaW52YWxpZC5cbiAqL1xuUmVjdGFuZ2xlT3V0bGluZUdlb21ldHJ5LmNyZWF0ZUdlb21ldHJ5ID0gZnVuY3Rpb24gKHJlY3RhbmdsZUdlb21ldHJ5KSB7XG4gIHZhciByZWN0YW5nbGUgPSByZWN0YW5nbGVHZW9tZXRyeS5fcmVjdGFuZ2xlO1xuICB2YXIgZWxsaXBzb2lkID0gcmVjdGFuZ2xlR2VvbWV0cnkuX2VsbGlwc29pZDtcbiAgdmFyIGNvbXB1dGVkT3B0aW9ucyA9IFJlY3RhbmdsZUdlb21ldHJ5TGlicmFyeS5jb21wdXRlT3B0aW9ucyhcbiAgICByZWN0YW5nbGUsXG4gICAgcmVjdGFuZ2xlR2VvbWV0cnkuX2dyYW51bGFyaXR5LFxuICAgIHJlY3RhbmdsZUdlb21ldHJ5Ll9yb3RhdGlvbixcbiAgICAwLFxuICAgIHJlY3RhbmdsZVNjcmF0Y2gsXG4gICAgbndTY3JhdGNoXG4gICk7XG5cbiAgdmFyIGdlb21ldHJ5O1xuICB2YXIgYm91bmRpbmdTcGhlcmU7XG5cbiAgaWYgKFxuICAgIENlc2l1bU1hdGguZXF1YWxzRXBzaWxvbihcbiAgICAgIHJlY3RhbmdsZS5ub3J0aCxcbiAgICAgIHJlY3RhbmdsZS5zb3V0aCxcbiAgICAgIENlc2l1bU1hdGguRVBTSUxPTjEwXG4gICAgKSB8fFxuICAgIENlc2l1bU1hdGguZXF1YWxzRXBzaWxvbihcbiAgICAgIHJlY3RhbmdsZS5lYXN0LFxuICAgICAgcmVjdGFuZ2xlLndlc3QsXG4gICAgICBDZXNpdW1NYXRoLkVQU0lMT04xMFxuICAgIClcbiAgKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIHZhciBzdXJmYWNlSGVpZ2h0ID0gcmVjdGFuZ2xlR2VvbWV0cnkuX3N1cmZhY2VIZWlnaHQ7XG4gIHZhciBleHRydWRlZEhlaWdodCA9IHJlY3RhbmdsZUdlb21ldHJ5Ll9leHRydWRlZEhlaWdodDtcbiAgdmFyIGV4dHJ1ZGUgPSAhQ2VzaXVtTWF0aC5lcXVhbHNFcHNpbG9uKFxuICAgIHN1cmZhY2VIZWlnaHQsXG4gICAgZXh0cnVkZWRIZWlnaHQsXG4gICAgMCxcbiAgICBDZXNpdW1NYXRoLkVQU0lMT04yXG4gICk7XG4gIHZhciBvZmZzZXRWYWx1ZTtcbiAgaWYgKGV4dHJ1ZGUpIHtcbiAgICBnZW9tZXRyeSA9IGNvbnN0cnVjdEV4dHJ1ZGVkUmVjdGFuZ2xlKHJlY3RhbmdsZUdlb21ldHJ5LCBjb21wdXRlZE9wdGlvbnMpO1xuICAgIGlmIChkZWZpbmVkKHJlY3RhbmdsZUdlb21ldHJ5Ll9vZmZzZXRBdHRyaWJ1dGUpKSB7XG4gICAgICB2YXIgc2l6ZSA9IGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24udmFsdWVzLmxlbmd0aCAvIDM7XG4gICAgICB2YXIgb2Zmc2V0QXR0cmlidXRlID0gbmV3IFVpbnQ4QXJyYXkoc2l6ZSk7XG4gICAgICBpZiAocmVjdGFuZ2xlR2VvbWV0cnkuX29mZnNldEF0dHJpYnV0ZSA9PT0gR2VvbWV0cnlPZmZzZXRBdHRyaWJ1dGUuVE9QKSB7XG4gICAgICAgIG9mZnNldEF0dHJpYnV0ZSA9IGFycmF5RmlsbChvZmZzZXRBdHRyaWJ1dGUsIDEsIDAsIHNpemUgLyAyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9mZnNldFZhbHVlID1cbiAgICAgICAgICByZWN0YW5nbGVHZW9tZXRyeS5fb2Zmc2V0QXR0cmlidXRlID09PSBHZW9tZXRyeU9mZnNldEF0dHJpYnV0ZS5OT05FXG4gICAgICAgICAgICA/IDBcbiAgICAgICAgICAgIDogMTtcbiAgICAgICAgb2Zmc2V0QXR0cmlidXRlID0gYXJyYXlGaWxsKG9mZnNldEF0dHJpYnV0ZSwgb2Zmc2V0VmFsdWUpO1xuICAgICAgfVxuXG4gICAgICBnZW9tZXRyeS5hdHRyaWJ1dGVzLmFwcGx5T2Zmc2V0ID0gbmV3IEdlb21ldHJ5QXR0cmlidXRlKHtcbiAgICAgICAgY29tcG9uZW50RGF0YXR5cGU6IENvbXBvbmVudERhdGF0eXBlLlVOU0lHTkVEX0JZVEUsXG4gICAgICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGU6IDEsXG4gICAgICAgIHZhbHVlczogb2Zmc2V0QXR0cmlidXRlLFxuICAgICAgfSk7XG4gICAgfVxuICAgIHZhciB0b3BCUyA9IEJvdW5kaW5nU3BoZXJlLmZyb21SZWN0YW5nbGUzRChcbiAgICAgIHJlY3RhbmdsZSxcbiAgICAgIGVsbGlwc29pZCxcbiAgICAgIHN1cmZhY2VIZWlnaHQsXG4gICAgICB0b3BCb3VuZGluZ1NwaGVyZVxuICAgICk7XG4gICAgdmFyIGJvdHRvbUJTID0gQm91bmRpbmdTcGhlcmUuZnJvbVJlY3RhbmdsZTNEKFxuICAgICAgcmVjdGFuZ2xlLFxuICAgICAgZWxsaXBzb2lkLFxuICAgICAgZXh0cnVkZWRIZWlnaHQsXG4gICAgICBib3R0b21Cb3VuZGluZ1NwaGVyZVxuICAgICk7XG4gICAgYm91bmRpbmdTcGhlcmUgPSBCb3VuZGluZ1NwaGVyZS51bmlvbih0b3BCUywgYm90dG9tQlMpO1xuICB9IGVsc2Uge1xuICAgIGdlb21ldHJ5ID0gY29uc3RydWN0UmVjdGFuZ2xlKHJlY3RhbmdsZUdlb21ldHJ5LCBjb21wdXRlZE9wdGlvbnMpO1xuICAgIGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24udmFsdWVzID0gUG9seWdvblBpcGVsaW5lLnNjYWxlVG9HZW9kZXRpY0hlaWdodChcbiAgICAgIGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24udmFsdWVzLFxuICAgICAgc3VyZmFjZUhlaWdodCxcbiAgICAgIGVsbGlwc29pZCxcbiAgICAgIGZhbHNlXG4gICAgKTtcblxuICAgIGlmIChkZWZpbmVkKHJlY3RhbmdsZUdlb21ldHJ5Ll9vZmZzZXRBdHRyaWJ1dGUpKSB7XG4gICAgICB2YXIgbGVuZ3RoID0gZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi52YWx1ZXMubGVuZ3RoO1xuICAgICAgdmFyIGFwcGx5T2Zmc2V0ID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoIC8gMyk7XG4gICAgICBvZmZzZXRWYWx1ZSA9XG4gICAgICAgIHJlY3RhbmdsZUdlb21ldHJ5Ll9vZmZzZXRBdHRyaWJ1dGUgPT09IEdlb21ldHJ5T2Zmc2V0QXR0cmlidXRlLk5PTkVcbiAgICAgICAgICA/IDBcbiAgICAgICAgICA6IDE7XG4gICAgICBhcnJheUZpbGwoYXBwbHlPZmZzZXQsIG9mZnNldFZhbHVlKTtcbiAgICAgIGdlb21ldHJ5LmF0dHJpYnV0ZXMuYXBwbHlPZmZzZXQgPSBuZXcgR2VvbWV0cnlBdHRyaWJ1dGUoe1xuICAgICAgICBjb21wb25lbnREYXRhdHlwZTogQ29tcG9uZW50RGF0YXR5cGUuVU5TSUdORURfQllURSxcbiAgICAgICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogMSxcbiAgICAgICAgdmFsdWVzOiBhcHBseU9mZnNldCxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGJvdW5kaW5nU3BoZXJlID0gQm91bmRpbmdTcGhlcmUuZnJvbVJlY3RhbmdsZTNEKFxuICAgICAgcmVjdGFuZ2xlLFxuICAgICAgZWxsaXBzb2lkLFxuICAgICAgc3VyZmFjZUhlaWdodFxuICAgICk7XG4gIH1cblxuICByZXR1cm4gbmV3IEdlb21ldHJ5KHtcbiAgICBhdHRyaWJ1dGVzOiBnZW9tZXRyeS5hdHRyaWJ1dGVzLFxuICAgIGluZGljZXM6IGdlb21ldHJ5LmluZGljZXMsXG4gICAgcHJpbWl0aXZlVHlwZTogUHJpbWl0aXZlVHlwZS5MSU5FUyxcbiAgICBib3VuZGluZ1NwaGVyZTogYm91bmRpbmdTcGhlcmUsXG4gICAgb2Zmc2V0QXR0cmlidXRlOiByZWN0YW5nbGVHZW9tZXRyeS5fb2Zmc2V0QXR0cmlidXRlLFxuICB9KTtcbn07XG5leHBvcnQgZGVmYXVsdCBSZWN0YW5nbGVPdXRsaW5lR2VvbWV0cnk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///19737\n')},17964:function(__unused_webpack___webpack_module__,__webpack_exports__){eval('/**\n * Constants for identifying well-known reference frames.\n *\n * @enum {Number}\n */\nvar ReferenceFrame = {\n  /**\n   * The fixed frame.\n   *\n   * @type {Number}\n   * @constant\n   */\n  FIXED: 0,\n\n  /**\n   * The inertial frame.\n   *\n   * @type {Number}\n   * @constant\n   */\n  INERTIAL: 1,\n};\n/* harmony default export */ __webpack_exports__["Z"] = (Object.freeze(ReferenceFrame));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTc5NjQuanMiLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUFlLDZCQUE2QixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnVlMy13ZWJwYWNrNS8uL25vZGVfbW9kdWxlcy9jZXNpdW0vU291cmNlL0NvcmUvUmVmZXJlbmNlRnJhbWUuanM/ZDhmNyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvbnN0YW50cyBmb3IgaWRlbnRpZnlpbmcgd2VsbC1rbm93biByZWZlcmVuY2UgZnJhbWVzLlxuICpcbiAqIEBlbnVtIHtOdW1iZXJ9XG4gKi9cbnZhciBSZWZlcmVuY2VGcmFtZSA9IHtcbiAgLyoqXG4gICAqIFRoZSBmaXhlZCBmcmFtZS5cbiAgICpcbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQGNvbnN0YW50XG4gICAqL1xuICBGSVhFRDogMCxcblxuICAvKipcbiAgICogVGhlIGluZXJ0aWFsIGZyYW1lLlxuICAgKlxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKiBAY29uc3RhbnRcbiAgICovXG4gIElORVJUSUFMOiAxLFxufTtcbmV4cG9ydCBkZWZhdWx0IE9iamVjdC5mcmVlemUoUmVmZXJlbmNlRnJhbWUpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///17964\n')},22426:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _defaultValue_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(62200);\n/* harmony import */ var _defined_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(82982);\n/* harmony import */ var _RequestState_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(6224);\n/* harmony import */ var _RequestType_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(82968);\n\n\n\n\n\n/**\n * Stores information for making a request. In general this does not need to be constructed directly.\n *\n * @alias Request\n * @constructor\n\n * @param {Object} [options] An object with the following properties:\n * @param {String} [options.url] The url to request.\n * @param {Request.RequestCallback} [options.requestFunction] The function that makes the actual data request.\n * @param {Request.CancelCallback} [options.cancelFunction] The function that is called when the request is cancelled.\n * @param {Request.PriorityCallback} [options.priorityFunction] The function that is called to update the request\'s priority, which occurs once per frame.\n * @param {Number} [options.priority=0.0] The initial priority of the request.\n * @param {Boolean} [options.throttle=false] Whether to throttle and prioritize the request. If false, the request will be sent immediately. If true, the request will be throttled and sent based on priority.\n * @param {Boolean} [options.throttleByServer=false] Whether to throttle the request by server.\n * @param {RequestType} [options.type=RequestType.OTHER] The type of request.\n */\nfunction Request(options) {\n  options = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options, _defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n\n  var throttleByServer = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options.throttleByServer, false);\n  var throttle = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options.throttle, false);\n\n  /**\n   * The URL to request.\n   *\n   * @type {String}\n   */\n  this.url = options.url;\n\n  /**\n   * The function that makes the actual data request.\n   *\n   * @type {Request.RequestCallback}\n   */\n  this.requestFunction = options.requestFunction;\n\n  /**\n   * The function that is called when the request is cancelled.\n   *\n   * @type {Request.CancelCallback}\n   */\n  this.cancelFunction = options.cancelFunction;\n\n  /**\n   * The function that is called to update the request\'s priority, which occurs once per frame.\n   *\n   * @type {Request.PriorityCallback}\n   */\n  this.priorityFunction = options.priorityFunction;\n\n  /**\n   * Priority is a unit-less value where lower values represent higher priority.\n   * For world-based objects, this is usually the distance from the camera.\n   * A request that does not have a priority function defaults to a priority of 0.\n   *\n   * If priorityFunction is defined, this value is updated every frame with the result of that call.\n   *\n   * @type {Number}\n   * @default 0.0\n   */\n  this.priority = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options.priority, 0.0);\n\n  /**\n   * Whether to throttle and prioritize the request. If false, the request will be sent immediately. If true, the\n   * request will be throttled and sent based on priority.\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default false\n   */\n  this.throttle = throttle;\n\n  /**\n   * Whether to throttle the request by server. Browsers typically support about 6-8 parallel connections\n   * for HTTP/1 servers, and an unlimited amount of connections for HTTP/2 servers. Setting this value\n   * to <code>true</code> is preferable for requests going through HTTP/1 servers.\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default false\n   */\n  this.throttleByServer = throttleByServer;\n\n  /**\n   * Type of request.\n   *\n   * @type {RequestType}\n   * @readonly\n   *\n   * @default RequestType.OTHER\n   */\n  this.type = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options.type, _RequestType_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].OTHER */ .Z.OTHER);\n\n  /**\n   * A key used to identify the server that a request is going to. It is derived from the url\'s authority and scheme.\n   *\n   * @type {String}\n   *\n   * @private\n   */\n  this.serverKey = undefined;\n\n  /**\n   * The current state of the request.\n   *\n   * @type {RequestState}\n   * @readonly\n   */\n  this.state = _RequestState_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].UNISSUED */ .Z.UNISSUED;\n\n  /**\n   * The requests\'s deferred promise.\n   *\n   * @type {Object}\n   *\n   * @private\n   */\n  this.deferred = undefined;\n\n  /**\n   * Whether the request was explicitly cancelled.\n   *\n   * @type {Boolean}\n   *\n   * @private\n   */\n  this.cancelled = false;\n}\n\n/**\n * Mark the request as cancelled.\n *\n * @private\n */\nRequest.prototype.cancel = function () {\n  this.cancelled = true;\n};\n\n/**\n * Duplicates a Request instance.\n *\n * @param {Request} [result] The object onto which to store the result.\n *\n * @returns {Request} The modified result parameter or a new Resource instance if one was not provided.\n */\nRequest.prototype.clone = function (result) {\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(result)) {\n    return new Request(this);\n  }\n\n  result.url = this.url;\n  result.requestFunction = this.requestFunction;\n  result.cancelFunction = this.cancelFunction;\n  result.priorityFunction = this.priorityFunction;\n  result.priority = this.priority;\n  result.throttle = this.throttle;\n  result.throttleByServer = this.throttleByServer;\n  result.type = this.type;\n  result.serverKey = this.serverKey;\n\n  // These get defaulted because the cloned request hasn\'t been issued\n  result.state = this.RequestState.UNISSUED;\n  result.deferred = undefined;\n  result.cancelled = false;\n\n  return result;\n};\n\n/**\n * The function that makes the actual data request.\n * @callback Request.RequestCallback\n * @returns {Promise<void>} A promise for the requested data.\n */\n\n/**\n * The function that is called when the request is cancelled.\n * @callback Request.CancelCallback\n */\n\n/**\n * The function that is called to update the request\'s priority, which occurs once per frame.\n * @callback Request.PriorityCallback\n * @returns {Number} The updated priority value.\n */\n/* harmony default export */ __webpack_exports__["Z"] = (Request);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjI0MjYuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUE2QztBQUNWO0FBQ1U7QUFDRjs7QUFFM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxXQUFXLFFBQVE7QUFDbkIsV0FBVyxRQUFRO0FBQ25CLFdBQVcseUJBQXlCO0FBQ3BDLFdBQVcsd0JBQXdCO0FBQ25DLFdBQVcsMEJBQTBCO0FBQ3JDLFdBQVcsUUFBUTtBQUNuQixXQUFXLFNBQVM7QUFDcEIsV0FBVyxTQUFTO0FBQ3BCLFdBQVcsYUFBYTtBQUN4QjtBQUNBO0FBQ0EsWUFBWSxxRUFBWSxVQUFVLDJGQUF5Qjs7QUFFM0QseUJBQXlCLHFFQUFZO0FBQ3JDLGlCQUFpQixxRUFBWTs7QUFFN0I7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBLGtCQUFrQixxRUFBWTs7QUFFOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxxRUFBWSxlQUFlLDRFQUFpQjs7QUFFMUQ7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0EsZUFBZSxtRkFBcUI7O0FBRXBDO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsU0FBUztBQUNwQjtBQUNBLGFBQWEsU0FBUztBQUN0QjtBQUNBO0FBQ0EsT0FBTyxnRUFBTztBQUNkO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYSxlQUFlO0FBQzVCOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsUUFBUTtBQUNyQjtBQUNBLHlEQUFlLE9BQU8sRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9Db3JlL1JlcXVlc3QuanM/YmRmMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZGVmYXVsdFZhbHVlIGZyb20gXCIuL2RlZmF1bHRWYWx1ZS5qc1wiO1xuaW1wb3J0IGRlZmluZWQgZnJvbSBcIi4vZGVmaW5lZC5qc1wiO1xuaW1wb3J0IFJlcXVlc3RTdGF0ZSBmcm9tIFwiLi9SZXF1ZXN0U3RhdGUuanNcIjtcbmltcG9ydCBSZXF1ZXN0VHlwZSBmcm9tIFwiLi9SZXF1ZXN0VHlwZS5qc1wiO1xuXG4vKipcbiAqIFN0b3JlcyBpbmZvcm1hdGlvbiBmb3IgbWFraW5nIGEgcmVxdWVzdC4gSW4gZ2VuZXJhbCB0aGlzIGRvZXMgbm90IG5lZWQgdG8gYmUgY29uc3RydWN0ZWQgZGlyZWN0bHkuXG4gKlxuICogQGFsaWFzIFJlcXVlc3RcbiAqIEBjb25zdHJ1Y3RvclxuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIEFuIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqIEBwYXJhbSB7U3RyaW5nfSBbb3B0aW9ucy51cmxdIFRoZSB1cmwgdG8gcmVxdWVzdC5cbiAqIEBwYXJhbSB7UmVxdWVzdC5SZXF1ZXN0Q2FsbGJhY2t9IFtvcHRpb25zLnJlcXVlc3RGdW5jdGlvbl0gVGhlIGZ1bmN0aW9uIHRoYXQgbWFrZXMgdGhlIGFjdHVhbCBkYXRhIHJlcXVlc3QuXG4gKiBAcGFyYW0ge1JlcXVlc3QuQ2FuY2VsQ2FsbGJhY2t9IFtvcHRpb25zLmNhbmNlbEZ1bmN0aW9uXSBUaGUgZnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgd2hlbiB0aGUgcmVxdWVzdCBpcyBjYW5jZWxsZWQuXG4gKiBAcGFyYW0ge1JlcXVlc3QuUHJpb3JpdHlDYWxsYmFja30gW29wdGlvbnMucHJpb3JpdHlGdW5jdGlvbl0gVGhlIGZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIHRvIHVwZGF0ZSB0aGUgcmVxdWVzdCdzIHByaW9yaXR5LCB3aGljaCBvY2N1cnMgb25jZSBwZXIgZnJhbWUuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMucHJpb3JpdHk9MC4wXSBUaGUgaW5pdGlhbCBwcmlvcml0eSBvZiB0aGUgcmVxdWVzdC5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMudGhyb3R0bGU9ZmFsc2VdIFdoZXRoZXIgdG8gdGhyb3R0bGUgYW5kIHByaW9yaXRpemUgdGhlIHJlcXVlc3QuIElmIGZhbHNlLCB0aGUgcmVxdWVzdCB3aWxsIGJlIHNlbnQgaW1tZWRpYXRlbHkuIElmIHRydWUsIHRoZSByZXF1ZXN0IHdpbGwgYmUgdGhyb3R0bGVkIGFuZCBzZW50IGJhc2VkIG9uIHByaW9yaXR5LlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy50aHJvdHRsZUJ5U2VydmVyPWZhbHNlXSBXaGV0aGVyIHRvIHRocm90dGxlIHRoZSByZXF1ZXN0IGJ5IHNlcnZlci5cbiAqIEBwYXJhbSB7UmVxdWVzdFR5cGV9IFtvcHRpb25zLnR5cGU9UmVxdWVzdFR5cGUuT1RIRVJdIFRoZSB0eXBlIG9mIHJlcXVlc3QuXG4gKi9cbmZ1bmN0aW9uIFJlcXVlc3Qob3B0aW9ucykge1xuICBvcHRpb25zID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMsIGRlZmF1bHRWYWx1ZS5FTVBUWV9PQkpFQ1QpO1xuXG4gIHZhciB0aHJvdHRsZUJ5U2VydmVyID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMudGhyb3R0bGVCeVNlcnZlciwgZmFsc2UpO1xuICB2YXIgdGhyb3R0bGUgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy50aHJvdHRsZSwgZmFsc2UpO1xuXG4gIC8qKlxuICAgKiBUaGUgVVJMIHRvIHJlcXVlc3QuXG4gICAqXG4gICAqIEB0eXBlIHtTdHJpbmd9XG4gICAqL1xuICB0aGlzLnVybCA9IG9wdGlvbnMudXJsO1xuXG4gIC8qKlxuICAgKiBUaGUgZnVuY3Rpb24gdGhhdCBtYWtlcyB0aGUgYWN0dWFsIGRhdGEgcmVxdWVzdC5cbiAgICpcbiAgICogQHR5cGUge1JlcXVlc3QuUmVxdWVzdENhbGxiYWNrfVxuICAgKi9cbiAgdGhpcy5yZXF1ZXN0RnVuY3Rpb24gPSBvcHRpb25zLnJlcXVlc3RGdW5jdGlvbjtcblxuICAvKipcbiAgICogVGhlIGZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIHdoZW4gdGhlIHJlcXVlc3QgaXMgY2FuY2VsbGVkLlxuICAgKlxuICAgKiBAdHlwZSB7UmVxdWVzdC5DYW5jZWxDYWxsYmFja31cbiAgICovXG4gIHRoaXMuY2FuY2VsRnVuY3Rpb24gPSBvcHRpb25zLmNhbmNlbEZ1bmN0aW9uO1xuXG4gIC8qKlxuICAgKiBUaGUgZnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgdG8gdXBkYXRlIHRoZSByZXF1ZXN0J3MgcHJpb3JpdHksIHdoaWNoIG9jY3VycyBvbmNlIHBlciBmcmFtZS5cbiAgICpcbiAgICogQHR5cGUge1JlcXVlc3QuUHJpb3JpdHlDYWxsYmFja31cbiAgICovXG4gIHRoaXMucHJpb3JpdHlGdW5jdGlvbiA9IG9wdGlvbnMucHJpb3JpdHlGdW5jdGlvbjtcblxuICAvKipcbiAgICogUHJpb3JpdHkgaXMgYSB1bml0LWxlc3MgdmFsdWUgd2hlcmUgbG93ZXIgdmFsdWVzIHJlcHJlc2VudCBoaWdoZXIgcHJpb3JpdHkuXG4gICAqIEZvciB3b3JsZC1iYXNlZCBvYmplY3RzLCB0aGlzIGlzIHVzdWFsbHkgdGhlIGRpc3RhbmNlIGZyb20gdGhlIGNhbWVyYS5cbiAgICogQSByZXF1ZXN0IHRoYXQgZG9lcyBub3QgaGF2ZSBhIHByaW9yaXR5IGZ1bmN0aW9uIGRlZmF1bHRzIHRvIGEgcHJpb3JpdHkgb2YgMC5cbiAgICpcbiAgICogSWYgcHJpb3JpdHlGdW5jdGlvbiBpcyBkZWZpbmVkLCB0aGlzIHZhbHVlIGlzIHVwZGF0ZWQgZXZlcnkgZnJhbWUgd2l0aCB0aGUgcmVzdWx0IG9mIHRoYXQgY2FsbC5cbiAgICpcbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQGRlZmF1bHQgMC4wXG4gICAqL1xuICB0aGlzLnByaW9yaXR5ID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMucHJpb3JpdHksIDAuMCk7XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gdGhyb3R0bGUgYW5kIHByaW9yaXRpemUgdGhlIHJlcXVlc3QuIElmIGZhbHNlLCB0aGUgcmVxdWVzdCB3aWxsIGJlIHNlbnQgaW1tZWRpYXRlbHkuIElmIHRydWUsIHRoZVxuICAgKiByZXF1ZXN0IHdpbGwgYmUgdGhyb3R0bGVkIGFuZCBzZW50IGJhc2VkIG9uIHByaW9yaXR5LlxuICAgKlxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEBkZWZhdWx0IGZhbHNlXG4gICAqL1xuICB0aGlzLnRocm90dGxlID0gdGhyb3R0bGU7XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gdGhyb3R0bGUgdGhlIHJlcXVlc3QgYnkgc2VydmVyLiBCcm93c2VycyB0eXBpY2FsbHkgc3VwcG9ydCBhYm91dCA2LTggcGFyYWxsZWwgY29ubmVjdGlvbnNcbiAgICogZm9yIEhUVFAvMSBzZXJ2ZXJzLCBhbmQgYW4gdW5saW1pdGVkIGFtb3VudCBvZiBjb25uZWN0aW9ucyBmb3IgSFRUUC8yIHNlcnZlcnMuIFNldHRpbmcgdGhpcyB2YWx1ZVxuICAgKiB0byA8Y29kZT50cnVlPC9jb2RlPiBpcyBwcmVmZXJhYmxlIGZvciByZXF1ZXN0cyBnb2luZyB0aHJvdWdoIEhUVFAvMSBzZXJ2ZXJzLlxuICAgKlxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEBkZWZhdWx0IGZhbHNlXG4gICAqL1xuICB0aGlzLnRocm90dGxlQnlTZXJ2ZXIgPSB0aHJvdHRsZUJ5U2VydmVyO1xuXG4gIC8qKlxuICAgKiBUeXBlIG9mIHJlcXVlc3QuXG4gICAqXG4gICAqIEB0eXBlIHtSZXF1ZXN0VHlwZX1cbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEBkZWZhdWx0IFJlcXVlc3RUeXBlLk9USEVSXG4gICAqL1xuICB0aGlzLnR5cGUgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy50eXBlLCBSZXF1ZXN0VHlwZS5PVEhFUik7XG5cbiAgLyoqXG4gICAqIEEga2V5IHVzZWQgdG8gaWRlbnRpZnkgdGhlIHNlcnZlciB0aGF0IGEgcmVxdWVzdCBpcyBnb2luZyB0by4gSXQgaXMgZGVyaXZlZCBmcm9tIHRoZSB1cmwncyBhdXRob3JpdHkgYW5kIHNjaGVtZS5cbiAgICpcbiAgICogQHR5cGUge1N0cmluZ31cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHRoaXMuc2VydmVyS2V5ID0gdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKiBUaGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgcmVxdWVzdC5cbiAgICpcbiAgICogQHR5cGUge1JlcXVlc3RTdGF0ZX1cbiAgICogQHJlYWRvbmx5XG4gICAqL1xuICB0aGlzLnN0YXRlID0gUmVxdWVzdFN0YXRlLlVOSVNTVUVEO1xuXG4gIC8qKlxuICAgKiBUaGUgcmVxdWVzdHMncyBkZWZlcnJlZCBwcm9taXNlLlxuICAgKlxuICAgKiBAdHlwZSB7T2JqZWN0fVxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdGhpcy5kZWZlcnJlZCA9IHVuZGVmaW5lZDtcblxuICAvKipcbiAgICogV2hldGhlciB0aGUgcmVxdWVzdCB3YXMgZXhwbGljaXRseSBjYW5jZWxsZWQuXG4gICAqXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdGhpcy5jYW5jZWxsZWQgPSBmYWxzZTtcbn1cblxuLyoqXG4gKiBNYXJrIHRoZSByZXF1ZXN0IGFzIGNhbmNlbGxlZC5cbiAqXG4gKiBAcHJpdmF0ZVxuICovXG5SZXF1ZXN0LnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuY2FuY2VsbGVkID0gdHJ1ZTtcbn07XG5cbi8qKlxuICogRHVwbGljYXRlcyBhIFJlcXVlc3QgaW5zdGFuY2UuXG4gKlxuICogQHBhcmFtIHtSZXF1ZXN0fSBbcmVzdWx0XSBUaGUgb2JqZWN0IG9udG8gd2hpY2ggdG8gc3RvcmUgdGhlIHJlc3VsdC5cbiAqXG4gKiBAcmV0dXJucyB7UmVxdWVzdH0gVGhlIG1vZGlmaWVkIHJlc3VsdCBwYXJhbWV0ZXIgb3IgYSBuZXcgUmVzb3VyY2UgaW5zdGFuY2UgaWYgb25lIHdhcyBub3QgcHJvdmlkZWQuXG4gKi9cblJlcXVlc3QucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuICBpZiAoIWRlZmluZWQocmVzdWx0KSkge1xuICAgIHJldHVybiBuZXcgUmVxdWVzdCh0aGlzKTtcbiAgfVxuXG4gIHJlc3VsdC51cmwgPSB0aGlzLnVybDtcbiAgcmVzdWx0LnJlcXVlc3RGdW5jdGlvbiA9IHRoaXMucmVxdWVzdEZ1bmN0aW9uO1xuICByZXN1bHQuY2FuY2VsRnVuY3Rpb24gPSB0aGlzLmNhbmNlbEZ1bmN0aW9uO1xuICByZXN1bHQucHJpb3JpdHlGdW5jdGlvbiA9IHRoaXMucHJpb3JpdHlGdW5jdGlvbjtcbiAgcmVzdWx0LnByaW9yaXR5ID0gdGhpcy5wcmlvcml0eTtcbiAgcmVzdWx0LnRocm90dGxlID0gdGhpcy50aHJvdHRsZTtcbiAgcmVzdWx0LnRocm90dGxlQnlTZXJ2ZXIgPSB0aGlzLnRocm90dGxlQnlTZXJ2ZXI7XG4gIHJlc3VsdC50eXBlID0gdGhpcy50eXBlO1xuICByZXN1bHQuc2VydmVyS2V5ID0gdGhpcy5zZXJ2ZXJLZXk7XG5cbiAgLy8gVGhlc2UgZ2V0IGRlZmF1bHRlZCBiZWNhdXNlIHRoZSBjbG9uZWQgcmVxdWVzdCBoYXNuJ3QgYmVlbiBpc3N1ZWRcbiAgcmVzdWx0LnN0YXRlID0gdGhpcy5SZXF1ZXN0U3RhdGUuVU5JU1NVRUQ7XG4gIHJlc3VsdC5kZWZlcnJlZCA9IHVuZGVmaW5lZDtcbiAgcmVzdWx0LmNhbmNlbGxlZCA9IGZhbHNlO1xuXG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG4vKipcbiAqIFRoZSBmdW5jdGlvbiB0aGF0IG1ha2VzIHRoZSBhY3R1YWwgZGF0YSByZXF1ZXN0LlxuICogQGNhbGxiYWNrIFJlcXVlc3QuUmVxdWVzdENhbGxiYWNrXG4gKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn0gQSBwcm9taXNlIGZvciB0aGUgcmVxdWVzdGVkIGRhdGEuXG4gKi9cblxuLyoqXG4gKiBUaGUgZnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgd2hlbiB0aGUgcmVxdWVzdCBpcyBjYW5jZWxsZWQuXG4gKiBAY2FsbGJhY2sgUmVxdWVzdC5DYW5jZWxDYWxsYmFja1xuICovXG5cbi8qKlxuICogVGhlIGZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIHRvIHVwZGF0ZSB0aGUgcmVxdWVzdCdzIHByaW9yaXR5LCB3aGljaCBvY2N1cnMgb25jZSBwZXIgZnJhbWUuXG4gKiBAY2FsbGJhY2sgUmVxdWVzdC5Qcmlvcml0eUNhbGxiYWNrXG4gKiBAcmV0dXJucyB7TnVtYmVyfSBUaGUgdXBkYXRlZCBwcmlvcml0eSB2YWx1ZS5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgUmVxdWVzdDtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///22426\n')},37156:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _defined_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(82982);\n/* harmony import */ var _parseResponseHeaders_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(29378);\n\n\n\n/**\n * An event that is raised when a request encounters an error.\n *\n * @constructor\n * @alias RequestErrorEvent\n *\n * @param {Number} [statusCode] The HTTP error status code, such as 404.\n * @param {Object} [response] The response included along with the error.\n * @param {String|Object} [responseHeaders] The response headers, represented either as an object literal or as a\n *                        string in the format returned by XMLHttpRequest\'s getAllResponseHeaders() function.\n */\nfunction RequestErrorEvent(statusCode, response, responseHeaders) {\n  /**\n   * The HTTP error status code, such as 404.  If the error does not have a particular\n   * HTTP code, this property will be undefined.\n   *\n   * @type {Number}\n   */\n  this.statusCode = statusCode;\n\n  /**\n   * The response included along with the error.  If the error does not include a response,\n   * this property will be undefined.\n   *\n   * @type {Object}\n   */\n  this.response = response;\n\n  /**\n   * The headers included in the response, represented as an object literal of key/value pairs.\n   * If the error does not include any headers, this property will be undefined.\n   *\n   * @type {Object}\n   */\n  this.responseHeaders = responseHeaders;\n\n  if (typeof this.responseHeaders === "string") {\n    this.responseHeaders = (0,_parseResponseHeaders_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(this.responseHeaders);\n  }\n}\n\n/**\n * Creates a string representing this RequestErrorEvent.\n * @memberof RequestErrorEvent\n *\n * @returns {String} A string representing the provided RequestErrorEvent.\n */\nRequestErrorEvent.prototype.toString = function () {\n  var str = "Request has failed.";\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(this.statusCode)) {\n    str += " Status Code: " + this.statusCode;\n  }\n  return str;\n};\n/* harmony default export */ __webpack_exports__["Z"] = (RequestErrorEvent);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzcxNTYuanMiLCJtYXBwaW5ncyI6Ijs7QUFBbUM7QUFDMEI7O0FBRTdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLFFBQVE7QUFDbkIsV0FBVyxlQUFlO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBOztBQUVBO0FBQ0EsMkJBQTJCLDZFQUFvQjtBQUMvQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLE1BQU0sZ0VBQU87QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUFlLGlCQUFpQixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnVlMy13ZWJwYWNrNS8uL25vZGVfbW9kdWxlcy9jZXNpdW0vU291cmNlL0NvcmUvUmVxdWVzdEVycm9yRXZlbnQuanM/MGZmOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZGVmaW5lZCBmcm9tIFwiLi9kZWZpbmVkLmpzXCI7XG5pbXBvcnQgcGFyc2VSZXNwb25zZUhlYWRlcnMgZnJvbSBcIi4vcGFyc2VSZXNwb25zZUhlYWRlcnMuanNcIjtcblxuLyoqXG4gKiBBbiBldmVudCB0aGF0IGlzIHJhaXNlZCB3aGVuIGEgcmVxdWVzdCBlbmNvdW50ZXJzIGFuIGVycm9yLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICogQGFsaWFzIFJlcXVlc3RFcnJvckV2ZW50XG4gKlxuICogQHBhcmFtIHtOdW1iZXJ9IFtzdGF0dXNDb2RlXSBUaGUgSFRUUCBlcnJvciBzdGF0dXMgY29kZSwgc3VjaCBhcyA0MDQuXG4gKiBAcGFyYW0ge09iamVjdH0gW3Jlc3BvbnNlXSBUaGUgcmVzcG9uc2UgaW5jbHVkZWQgYWxvbmcgd2l0aCB0aGUgZXJyb3IuXG4gKiBAcGFyYW0ge1N0cmluZ3xPYmplY3R9IFtyZXNwb25zZUhlYWRlcnNdIFRoZSByZXNwb25zZSBoZWFkZXJzLCByZXByZXNlbnRlZCBlaXRoZXIgYXMgYW4gb2JqZWN0IGxpdGVyYWwgb3IgYXMgYVxuICogICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmcgaW4gdGhlIGZvcm1hdCByZXR1cm5lZCBieSBYTUxIdHRwUmVxdWVzdCdzIGdldEFsbFJlc3BvbnNlSGVhZGVycygpIGZ1bmN0aW9uLlxuICovXG5mdW5jdGlvbiBSZXF1ZXN0RXJyb3JFdmVudChzdGF0dXNDb2RlLCByZXNwb25zZSwgcmVzcG9uc2VIZWFkZXJzKSB7XG4gIC8qKlxuICAgKiBUaGUgSFRUUCBlcnJvciBzdGF0dXMgY29kZSwgc3VjaCBhcyA0MDQuICBJZiB0aGUgZXJyb3IgZG9lcyBub3QgaGF2ZSBhIHBhcnRpY3VsYXJcbiAgICogSFRUUCBjb2RlLCB0aGlzIHByb3BlcnR5IHdpbGwgYmUgdW5kZWZpbmVkLlxuICAgKlxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKi9cbiAgdGhpcy5zdGF0dXNDb2RlID0gc3RhdHVzQ29kZTtcblxuICAvKipcbiAgICogVGhlIHJlc3BvbnNlIGluY2x1ZGVkIGFsb25nIHdpdGggdGhlIGVycm9yLiAgSWYgdGhlIGVycm9yIGRvZXMgbm90IGluY2x1ZGUgYSByZXNwb25zZSxcbiAgICogdGhpcyBwcm9wZXJ0eSB3aWxsIGJlIHVuZGVmaW5lZC5cbiAgICpcbiAgICogQHR5cGUge09iamVjdH1cbiAgICovXG4gIHRoaXMucmVzcG9uc2UgPSByZXNwb25zZTtcblxuICAvKipcbiAgICogVGhlIGhlYWRlcnMgaW5jbHVkZWQgaW4gdGhlIHJlc3BvbnNlLCByZXByZXNlbnRlZCBhcyBhbiBvYmplY3QgbGl0ZXJhbCBvZiBrZXkvdmFsdWUgcGFpcnMuXG4gICAqIElmIHRoZSBlcnJvciBkb2VzIG5vdCBpbmNsdWRlIGFueSBoZWFkZXJzLCB0aGlzIHByb3BlcnR5IHdpbGwgYmUgdW5kZWZpbmVkLlxuICAgKlxuICAgKiBAdHlwZSB7T2JqZWN0fVxuICAgKi9cbiAgdGhpcy5yZXNwb25zZUhlYWRlcnMgPSByZXNwb25zZUhlYWRlcnM7XG5cbiAgaWYgKHR5cGVvZiB0aGlzLnJlc3BvbnNlSGVhZGVycyA9PT0gXCJzdHJpbmdcIikge1xuICAgIHRoaXMucmVzcG9uc2VIZWFkZXJzID0gcGFyc2VSZXNwb25zZUhlYWRlcnModGhpcy5yZXNwb25zZUhlYWRlcnMpO1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIHN0cmluZyByZXByZXNlbnRpbmcgdGhpcyBSZXF1ZXN0RXJyb3JFdmVudC5cbiAqIEBtZW1iZXJvZiBSZXF1ZXN0RXJyb3JFdmVudFxuICpcbiAqIEByZXR1cm5zIHtTdHJpbmd9IEEgc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgcHJvdmlkZWQgUmVxdWVzdEVycm9yRXZlbnQuXG4gKi9cblJlcXVlc3RFcnJvckV2ZW50LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHN0ciA9IFwiUmVxdWVzdCBoYXMgZmFpbGVkLlwiO1xuICBpZiAoZGVmaW5lZCh0aGlzLnN0YXR1c0NvZGUpKSB7XG4gICAgc3RyICs9IFwiIFN0YXR1cyBDb2RlOiBcIiArIHRoaXMuc3RhdHVzQ29kZTtcbiAgfVxuICByZXR1cm4gc3RyO1xufTtcbmV4cG9ydCBkZWZhdWx0IFJlcXVlc3RFcnJvckV2ZW50O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///37156\n')},63181:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _ThirdParty_Uri_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(93922);\n/* harmony import */ var _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(13222);\n/* harmony import */ var _Check_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(66553);\n/* harmony import */ var _defaultValue_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(62200);\n/* harmony import */ var _defined_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(82982);\n/* harmony import */ var _Event_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(14459);\n/* harmony import */ var _Heap_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(81598);\n/* harmony import */ var _isBlobUri_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(66771);\n/* harmony import */ var _isDataUri_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(46138);\n/* harmony import */ var _RequestState_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(6224);\n\n\n\n\n\n\n\n\n\n\n\nfunction sortRequests(a, b) {\n  return a.priority - b.priority;\n}\n\nvar statistics = {\n  numberOfAttemptedRequests: 0,\n  numberOfActiveRequests: 0,\n  numberOfCancelledRequests: 0,\n  numberOfCancelledActiveRequests: 0,\n  numberOfFailedRequests: 0,\n  numberOfActiveRequestsEver: 0,\n  lastNumberOfActiveRequests: 0,\n};\n\nvar priorityHeapLength = 20;\nvar requestHeap = new _Heap_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z({\n  comparator: sortRequests,\n});\nrequestHeap.maximumLength = priorityHeapLength;\nrequestHeap.reserve(priorityHeapLength);\n\nvar activeRequests = [];\nvar numberOfActiveRequestsByServer = {};\n\nvar pageUri =\n  typeof document !== "undefined" ? new _ThirdParty_Uri_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(document.location.href) : new _ThirdParty_Uri_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\n\nvar requestCompletedEvent = new _Event_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\n\n/**\n * The request scheduler is used to track and constrain the number of active requests in order to prioritize incoming requests. The ability\n * to retain control over the number of requests in CesiumJS is important because due to events such as changes in the camera position,\n * a lot of new requests may be generated and a lot of in-flight requests may become redundant. The request scheduler manually constrains the\n * number of requests so that newer requests wait in a shorter queue and don\'t have to compete for bandwidth with requests that have expired.\n *\n * @namespace RequestScheduler\n *\n */\nfunction RequestScheduler() {}\n\n/**\n * The maximum number of simultaneous active requests. Un-throttled requests do not observe this limit.\n * @type {Number}\n * @default 50\n */\nRequestScheduler.maximumRequests = 50;\n\n/**\n * The maximum number of simultaneous active requests per server. Un-throttled requests or servers specifically\n * listed in {@link requestsByServer} do not observe this limit.\n * @type {Number}\n * @default 6\n */\nRequestScheduler.maximumRequestsPerServer = 6;\n\n/**\n * A per server key list of overrides to use for throttling instead of <code>maximumRequestsPerServer</code>\n * @type {Object}\n *\n * @example\n * RequestScheduler.requestsByServer = {\n *   \'api.cesium.com:443\': 18,\n *   \'assets.cesium.com:443\': 18\n * };\n */\nRequestScheduler.requestsByServer = {\n  "api.cesium.com:443": 18,\n  "assets.cesium.com:443": 18,\n};\n\n/**\n * Specifies if the request scheduler should throttle incoming requests, or let the browser queue requests under its control.\n * @type {Boolean}\n * @default true\n */\nRequestScheduler.throttleRequests = true;\n\n/**\n * When true, log statistics to the console every frame\n * @type {Boolean}\n * @default false\n * @private\n */\nRequestScheduler.debugShowStatistics = false;\n\n/**\n * An event that\'s raised when a request is completed.  Event handlers are passed\n * the error object if the request fails.\n *\n * @type {Event}\n * @default Event()\n * @private\n */\nRequestScheduler.requestCompletedEvent = requestCompletedEvent;\n\nObject.defineProperties(RequestScheduler, {\n  /**\n   * Returns the statistics used by the request scheduler.\n   *\n   * @memberof RequestScheduler\n   *\n   * @type Object\n   * @readonly\n   * @private\n   */\n  statistics: {\n    get: function () {\n      return statistics;\n    },\n  },\n\n  /**\n   * The maximum size of the priority heap. This limits the number of requests that are sorted by priority. Only applies to requests that are not yet active.\n   *\n   * @memberof RequestScheduler\n   *\n   * @type {Number}\n   * @default 20\n   * @private\n   */\n  priorityHeapLength: {\n    get: function () {\n      return priorityHeapLength;\n    },\n    set: function (value) {\n      // If the new length shrinks the heap, need to cancel some of the requests.\n      // Since this value is not intended to be tweaked regularly it is fine to just cancel the high priority requests.\n      if (value < priorityHeapLength) {\n        while (requestHeap.length > value) {\n          var request = requestHeap.pop();\n          cancelRequest(request);\n        }\n      }\n      priorityHeapLength = value;\n      requestHeap.maximumLength = value;\n      requestHeap.reserve(value);\n    },\n  },\n});\n\nfunction updatePriority(request) {\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(request.priorityFunction)) {\n    request.priority = request.priorityFunction();\n  }\n}\n\n/**\n * Check if there are open slots for a particular server key. If desiredRequests is greater than 1, this checks if the queue has room for scheduling multiple requests.\n * @param {String} serverKey The server key returned by {@link RequestScheduler.getServerKey}.\n * @param {Number} [desiredRequests=1] How many requests the caller plans to request\n * @return {Boolean} True if there are enough open slots for <code>desiredRequests</code> more requests.\n * @private\n */\nRequestScheduler.serverHasOpenSlots = function (serverKey, desiredRequests) {\n  desiredRequests = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(desiredRequests, 1);\n\n  var maxRequests = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(\n    RequestScheduler.requestsByServer[serverKey],\n    RequestScheduler.maximumRequestsPerServer\n  );\n  var hasOpenSlotsServer =\n    numberOfActiveRequestsByServer[serverKey] + desiredRequests <= maxRequests;\n\n  return hasOpenSlotsServer;\n};\n\n/**\n * Check if the priority heap has open slots, regardless of which server they\n * are from. This is used in {@link Multiple3DTileContent} for determining when\n * all requests can be scheduled\n * @param {Number} desiredRequests The number of requests the caller intends to make\n * @return {Boolean} <code>true</code> if the heap has enough available slots to meet the desiredRequests. <code>false</code> otherwise.\n *\n * @private\n */\nRequestScheduler.heapHasOpenSlots = function (desiredRequests) {\n  var hasOpenSlotsHeap =\n    requestHeap.length + desiredRequests <= priorityHeapLength;\n  return hasOpenSlotsHeap;\n};\n\nfunction issueRequest(request) {\n  if (request.state === _RequestState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].UNISSUED */ .Z.UNISSUED) {\n    request.state = _RequestState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].ISSUED */ .Z.ISSUED;\n    request.deferred = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].defer */ .Z.defer();\n  }\n  return request.deferred.promise;\n}\n\nfunction getRequestReceivedFunction(request) {\n  return function (results) {\n    if (request.state === _RequestState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].CANCELLED */ .Z.CANCELLED) {\n      // If the data request comes back but the request is cancelled, ignore it.\n      return;\n    }\n    // explicitly set to undefined to ensure GC of request response data. See #8843\n    var deferred = request.deferred;\n\n    --statistics.numberOfActiveRequests;\n    --numberOfActiveRequestsByServer[request.serverKey];\n    requestCompletedEvent.raiseEvent();\n    request.state = _RequestState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].RECEIVED */ .Z.RECEIVED;\n    request.deferred = undefined;\n\n    deferred.resolve(results);\n  };\n}\n\nfunction getRequestFailedFunction(request) {\n  return function (error) {\n    if (request.state === _RequestState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].CANCELLED */ .Z.CANCELLED) {\n      // If the data request comes back but the request is cancelled, ignore it.\n      return;\n    }\n    ++statistics.numberOfFailedRequests;\n    --statistics.numberOfActiveRequests;\n    --numberOfActiveRequestsByServer[request.serverKey];\n    requestCompletedEvent.raiseEvent(error);\n    request.state = _RequestState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].FAILED */ .Z.FAILED;\n    request.deferred.reject(error);\n  };\n}\n\nfunction startRequest(request) {\n  var promise = issueRequest(request);\n  request.state = _RequestState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].ACTIVE */ .Z.ACTIVE;\n  activeRequests.push(request);\n  ++statistics.numberOfActiveRequests;\n  ++statistics.numberOfActiveRequestsEver;\n  ++numberOfActiveRequestsByServer[request.serverKey];\n  request\n    .requestFunction()\n    .then(getRequestReceivedFunction(request))\n    .otherwise(getRequestFailedFunction(request));\n  return promise;\n}\n\nfunction cancelRequest(request) {\n  var active = request.state === _RequestState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].ACTIVE */ .Z.ACTIVE;\n  request.state = _RequestState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].CANCELLED */ .Z.CANCELLED;\n  ++statistics.numberOfCancelledRequests;\n  // check that deferred has not been cleared since cancelRequest can be called\n  // on a finished request, e.g. by clearForSpecs during tests\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(request.deferred)) {\n    var deferred = request.deferred;\n    request.deferred = undefined;\n    deferred.reject();\n  }\n\n  if (active) {\n    --statistics.numberOfActiveRequests;\n    --numberOfActiveRequestsByServer[request.serverKey];\n    ++statistics.numberOfCancelledActiveRequests;\n  }\n\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(request.cancelFunction)) {\n    request.cancelFunction();\n  }\n}\n\n/**\n * Sort requests by priority and start requests.\n * @private\n */\nRequestScheduler.update = function () {\n  var i;\n  var request;\n\n  // Loop over all active requests. Cancelled, failed, or received requests are removed from the array to make room for new requests.\n  var removeCount = 0;\n  var activeLength = activeRequests.length;\n  for (i = 0; i < activeLength; ++i) {\n    request = activeRequests[i];\n    if (request.cancelled) {\n      // Request was explicitly cancelled\n      cancelRequest(request);\n    }\n    if (request.state !== _RequestState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].ACTIVE */ .Z.ACTIVE) {\n      // Request is no longer active, remove from array\n      ++removeCount;\n      continue;\n    }\n    if (removeCount > 0) {\n      // Shift back to fill in vacated slots from completed requests\n      activeRequests[i - removeCount] = request;\n    }\n  }\n  activeRequests.length -= removeCount;\n\n  // Update priority of issued requests and resort the heap\n  var issuedRequests = requestHeap.internalArray;\n  var issuedLength = requestHeap.length;\n  for (i = 0; i < issuedLength; ++i) {\n    updatePriority(issuedRequests[i]);\n  }\n  requestHeap.resort();\n\n  // Get the number of open slots and fill with the highest priority requests.\n  // Un-throttled requests are automatically added to activeRequests, so activeRequests.length may exceed maximumRequests\n  var openSlots = Math.max(\n    RequestScheduler.maximumRequests - activeRequests.length,\n    0\n  );\n  var filledSlots = 0;\n  while (filledSlots < openSlots && requestHeap.length > 0) {\n    // Loop until all open slots are filled or the heap becomes empty\n    request = requestHeap.pop();\n    if (request.cancelled) {\n      // Request was explicitly cancelled\n      cancelRequest(request);\n      continue;\n    }\n\n    if (\n      request.throttleByServer &&\n      !RequestScheduler.serverHasOpenSlots(request.serverKey)\n    ) {\n      // Open slots are available, but the request is throttled by its server. Cancel and try again later.\n      cancelRequest(request);\n      continue;\n    }\n\n    startRequest(request);\n    ++filledSlots;\n  }\n\n  updateStatistics();\n};\n\n/**\n * Get the server key from a given url.\n *\n * @param {String} url The url.\n * @returns {String} The server key.\n * @private\n */\nRequestScheduler.getServerKey = function (url) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.string */ .Z.typeOf.string("url", url);\n  //>>includeEnd(\'debug\');\n\n  var uri = new _ThirdParty_Uri_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(url);\n  if (uri.scheme() === "") {\n    uri = new _ThirdParty_Uri_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(url).absoluteTo(pageUri);\n    uri.normalize();\n  }\n\n  var serverKey = uri.authority();\n  if (!/:/.test(serverKey)) {\n    // If the authority does not contain a port number, add port 443 for https or port 80 for http\n    serverKey = serverKey + ":" + (uri.scheme() === "https" ? "443" : "80");\n  }\n\n  var length = numberOfActiveRequestsByServer[serverKey];\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(length)) {\n    numberOfActiveRequestsByServer[serverKey] = 0;\n  }\n\n  return serverKey;\n};\n\n/**\n * Issue a request. If request.throttle is false, the request is sent immediately. Otherwise the request will be\n * queued and sorted by priority before being sent.\n *\n * @param {Request} request The request object.\n *\n * @returns {Promise|undefined} A Promise for the requested data, or undefined if this request does not have high enough priority to be issued.\n *\n * @private\n */\nRequestScheduler.request = function (request) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.object */ .Z.typeOf.object("request", request);\n  _Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.string */ .Z.typeOf.string("request.url", request.url);\n  _Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.func */ .Z.typeOf.func("request.requestFunction", request.requestFunction);\n  //>>includeEnd(\'debug\');\n\n  if ((0,_isDataUri_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(request.url) || (0,_isBlobUri_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(request.url)) {\n    requestCompletedEvent.raiseEvent();\n    request.state = _RequestState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].RECEIVED */ .Z.RECEIVED;\n    return request.requestFunction();\n  }\n\n  ++statistics.numberOfAttemptedRequests;\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(request.serverKey)) {\n    request.serverKey = RequestScheduler.getServerKey(request.url);\n  }\n\n  if (\n    RequestScheduler.throttleRequests &&\n    request.throttleByServer &&\n    !RequestScheduler.serverHasOpenSlots(request.serverKey)\n  ) {\n    // Server is saturated. Try again later.\n    return undefined;\n  }\n\n  if (!RequestScheduler.throttleRequests || !request.throttle) {\n    return startRequest(request);\n  }\n\n  if (activeRequests.length >= RequestScheduler.maximumRequests) {\n    // Active requests are saturated. Try again later.\n    return undefined;\n  }\n\n  // Insert into the priority heap and see if a request was bumped off. If this request is the lowest\n  // priority it will be returned.\n  updatePriority(request);\n  var removedRequest = requestHeap.insert(request);\n\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(removedRequest)) {\n    if (removedRequest === request) {\n      // Request does not have high enough priority to be issued\n      return undefined;\n    }\n    // A previously issued request has been bumped off the priority heap, so cancel it\n    cancelRequest(removedRequest);\n  }\n\n  return issueRequest(request);\n};\n\nfunction updateStatistics() {\n  if (!RequestScheduler.debugShowStatistics) {\n    return;\n  }\n\n  if (\n    statistics.numberOfActiveRequests === 0 &&\n    statistics.lastNumberOfActiveRequests > 0\n  ) {\n    if (statistics.numberOfAttemptedRequests > 0) {\n      console.log(\n        "Number of attempted requests: " + statistics.numberOfAttemptedRequests\n      );\n      statistics.numberOfAttemptedRequests = 0;\n    }\n\n    if (statistics.numberOfCancelledRequests > 0) {\n      console.log(\n        "Number of cancelled requests: " + statistics.numberOfCancelledRequests\n      );\n      statistics.numberOfCancelledRequests = 0;\n    }\n\n    if (statistics.numberOfCancelledActiveRequests > 0) {\n      console.log(\n        "Number of cancelled active requests: " +\n          statistics.numberOfCancelledActiveRequests\n      );\n      statistics.numberOfCancelledActiveRequests = 0;\n    }\n\n    if (statistics.numberOfFailedRequests > 0) {\n      console.log(\n        "Number of failed requests: " + statistics.numberOfFailedRequests\n      );\n      statistics.numberOfFailedRequests = 0;\n    }\n  }\n\n  statistics.lastNumberOfActiveRequests = statistics.numberOfActiveRequests;\n}\n\n/**\n * For testing only. Clears any requests that may not have completed from previous tests.\n *\n * @private\n */\nRequestScheduler.clearForSpecs = function () {\n  while (requestHeap.length > 0) {\n    var request = requestHeap.pop();\n    cancelRequest(request);\n  }\n  var length = activeRequests.length;\n  for (var i = 0; i < length; ++i) {\n    cancelRequest(activeRequests[i]);\n  }\n  activeRequests.length = 0;\n  numberOfActiveRequestsByServer = {};\n\n  // Clear stats\n  statistics.numberOfAttemptedRequests = 0;\n  statistics.numberOfActiveRequests = 0;\n  statistics.numberOfCancelledRequests = 0;\n  statistics.numberOfCancelledActiveRequests = 0;\n  statistics.numberOfFailedRequests = 0;\n  statistics.numberOfActiveRequestsEver = 0;\n  statistics.lastNumberOfActiveRequests = 0;\n};\n\n/**\n * For testing only.\n *\n * @private\n */\nRequestScheduler.numberOfActiveRequestsByServer = function (serverKey) {\n  return numberOfActiveRequestsByServer[serverKey];\n};\n\n/**\n * For testing only.\n *\n * @private\n */\nRequestScheduler.requestHeap = requestHeap;\n/* harmony default export */ __webpack_exports__["Z"] = (RequestScheduler);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLFlBQVk7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQWUsZ0JBQWdCLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92dWUzLXdlYnBhY2s1Ly4vbm9kZV9tb2R1bGVzL2Nlc2l1bS9Tb3VyY2UvQ29yZS9SZXF1ZXN0U2NoZWR1bGVyLmpzPzkxNjgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFVyaSBmcm9tIFwiLi4vVGhpcmRQYXJ0eS9VcmkuanNcIjtcbmltcG9ydCB3aGVuIGZyb20gXCIuLi9UaGlyZFBhcnR5L3doZW4uanNcIjtcbmltcG9ydCBDaGVjayBmcm9tIFwiLi9DaGVjay5qc1wiO1xuaW1wb3J0IGRlZmF1bHRWYWx1ZSBmcm9tIFwiLi9kZWZhdWx0VmFsdWUuanNcIjtcbmltcG9ydCBkZWZpbmVkIGZyb20gXCIuL2RlZmluZWQuanNcIjtcbmltcG9ydCBFdmVudCBmcm9tIFwiLi9FdmVudC5qc1wiO1xuaW1wb3J0IEhlYXAgZnJvbSBcIi4vSGVhcC5qc1wiO1xuaW1wb3J0IGlzQmxvYlVyaSBmcm9tIFwiLi9pc0Jsb2JVcmkuanNcIjtcbmltcG9ydCBpc0RhdGFVcmkgZnJvbSBcIi4vaXNEYXRhVXJpLmpzXCI7XG5pbXBvcnQgUmVxdWVzdFN0YXRlIGZyb20gXCIuL1JlcXVlc3RTdGF0ZS5qc1wiO1xuXG5mdW5jdGlvbiBzb3J0UmVxdWVzdHMoYSwgYikge1xuICByZXR1cm4gYS5wcmlvcml0eSAtIGIucHJpb3JpdHk7XG59XG5cbnZhciBzdGF0aXN0aWNzID0ge1xuICBudW1iZXJPZkF0dGVtcHRlZFJlcXVlc3RzOiAwLFxuICBudW1iZXJPZkFjdGl2ZVJlcXVlc3RzOiAwLFxuICBudW1iZXJPZkNhbmNlbGxlZFJlcXVlc3RzOiAwLFxuICBudW1iZXJPZkNhbmNlbGxlZEFjdGl2ZVJlcXVlc3RzOiAwLFxuICBudW1iZXJPZkZhaWxlZFJlcXVlc3RzOiAwLFxuICBudW1iZXJPZkFjdGl2ZVJlcXVlc3RzRXZlcjogMCxcbiAgbGFzdE51bWJlck9mQWN0aXZlUmVxdWVzdHM6IDAsXG59O1xuXG52YXIgcHJpb3JpdHlIZWFwTGVuZ3RoID0gMjA7XG52YXIgcmVxdWVzdEhlYXAgPSBuZXcgSGVhcCh7XG4gIGNvbXBhcmF0b3I6IHNvcnRSZXF1ZXN0cyxcbn0pO1xucmVxdWVzdEhlYXAubWF4aW11bUxlbmd0aCA9IHByaW9yaXR5SGVhcExlbmd0aDtcbnJlcXVlc3RIZWFwLnJlc2VydmUocHJpb3JpdHlIZWFwTGVuZ3RoKTtcblxudmFyIGFjdGl2ZVJlcXVlc3RzID0gW107XG52YXIgbnVtYmVyT2ZBY3RpdmVSZXF1ZXN0c0J5U2VydmVyID0ge307XG5cbnZhciBwYWdlVXJpID1cbiAgdHlwZW9mIGRvY3VtZW50ICE9PSBcInVuZGVmaW5lZFwiID8gbmV3IFVyaShkb2N1bWVudC5sb2NhdGlvbi5ocmVmKSA6IG5ldyBVcmkoKTtcblxudmFyIHJlcXVlc3RDb21wbGV0ZWRFdmVudCA9IG5ldyBFdmVudCgpO1xuXG4vKipcbiAqIFRoZSByZXF1ZXN0IHNjaGVkdWxlciBpcyB1c2VkIHRvIHRyYWNrIGFuZCBjb25zdHJhaW4gdGhlIG51bWJlciBvZiBhY3RpdmUgcmVxdWVzdHMgaW4gb3JkZXIgdG8gcHJpb3JpdGl6ZSBpbmNvbWluZyByZXF1ZXN0cy4gVGhlIGFiaWxpdHlcbiAqIHRvIHJldGFpbiBjb250cm9sIG92ZXIgdGhlIG51bWJlciBvZiByZXF1ZXN0cyBpbiBDZXNpdW1KUyBpcyBpbXBvcnRhbnQgYmVjYXVzZSBkdWUgdG8gZXZlbnRzIHN1Y2ggYXMgY2hhbmdlcyBpbiB0aGUgY2FtZXJhIHBvc2l0aW9uLFxuICogYSBsb3Qgb2YgbmV3IHJlcXVlc3RzIG1heSBiZSBnZW5lcmF0ZWQgYW5kIGEgbG90IG9mIGluLWZsaWdodCByZXF1ZXN0cyBtYXkgYmVjb21lIHJlZHVuZGFudC4gVGhlIHJlcXVlc3Qgc2NoZWR1bGVyIG1hbnVhbGx5IGNvbnN0cmFpbnMgdGhlXG4gKiBudW1iZXIgb2YgcmVxdWVzdHMgc28gdGhhdCBuZXdlciByZXF1ZXN0cyB3YWl0IGluIGEgc2hvcnRlciBxdWV1ZSBhbmQgZG9uJ3QgaGF2ZSB0byBjb21wZXRlIGZvciBiYW5kd2lkdGggd2l0aCByZXF1ZXN0cyB0aGF0IGhhdmUgZXhwaXJlZC5cbiAqXG4gKiBAbmFtZXNwYWNlIFJlcXVlc3RTY2hlZHVsZXJcbiAqXG4gKi9cbmZ1bmN0aW9uIFJlcXVlc3RTY2hlZHVsZXIoKSB7fVxuXG4vKipcbiAqIFRoZSBtYXhpbXVtIG51bWJlciBvZiBzaW11bHRhbmVvdXMgYWN0aXZlIHJlcXVlc3RzLiBVbi10aHJvdHRsZWQgcmVxdWVzdHMgZG8gbm90IG9ic2VydmUgdGhpcyBsaW1pdC5cbiAqIEB0eXBlIHtOdW1iZXJ9XG4gKiBAZGVmYXVsdCA1MFxuICovXG5SZXF1ZXN0U2NoZWR1bGVyLm1heGltdW1SZXF1ZXN0cyA9IDUwO1xuXG4vKipcbiAqIFRoZSBtYXhpbXVtIG51bWJlciBvZiBzaW11bHRhbmVvdXMgYWN0aXZlIHJlcXVlc3RzIHBlciBzZXJ2ZXIuIFVuLXRocm90dGxlZCByZXF1ZXN0cyBvciBzZXJ2ZXJzIHNwZWNpZmljYWxseVxuICogbGlzdGVkIGluIHtAbGluayByZXF1ZXN0c0J5U2VydmVyfSBkbyBub3Qgb2JzZXJ2ZSB0aGlzIGxpbWl0LlxuICogQHR5cGUge051bWJlcn1cbiAqIEBkZWZhdWx0IDZcbiAqL1xuUmVxdWVzdFNjaGVkdWxlci5tYXhpbXVtUmVxdWVzdHNQZXJTZXJ2ZXIgPSA2O1xuXG4vKipcbiAqIEEgcGVyIHNlcnZlciBrZXkgbGlzdCBvZiBvdmVycmlkZXMgdG8gdXNlIGZvciB0aHJvdHRsaW5nIGluc3RlYWQgb2YgPGNvZGU+bWF4aW11bVJlcXVlc3RzUGVyU2VydmVyPC9jb2RlPlxuICogQHR5cGUge09iamVjdH1cbiAqXG4gKiBAZXhhbXBsZVxuICogUmVxdWVzdFNjaGVkdWxlci5yZXF1ZXN0c0J5U2VydmVyID0ge1xuICogICAnYXBpLmNlc2l1bS5jb206NDQzJzogMTgsXG4gKiAgICdhc3NldHMuY2VzaXVtLmNvbTo0NDMnOiAxOFxuICogfTtcbiAqL1xuUmVxdWVzdFNjaGVkdWxlci5yZXF1ZXN0c0J5U2VydmVyID0ge1xuICBcImFwaS5jZXNpdW0uY29tOjQ0M1wiOiAxOCxcbiAgXCJhc3NldHMuY2VzaXVtLmNvbTo0NDNcIjogMTgsXG59O1xuXG4vKipcbiAqIFNwZWNpZmllcyBpZiB0aGUgcmVxdWVzdCBzY2hlZHVsZXIgc2hvdWxkIHRocm90dGxlIGluY29taW5nIHJlcXVlc3RzLCBvciBsZXQgdGhlIGJyb3dzZXIgcXVldWUgcmVxdWVzdHMgdW5kZXIgaXRzIGNvbnRyb2wuXG4gKiBAdHlwZSB7Qm9vbGVhbn1cbiAqIEBkZWZhdWx0IHRydWVcbiAqL1xuUmVxdWVzdFNjaGVkdWxlci50aHJvdHRsZVJlcXVlc3RzID0gdHJ1ZTtcblxuLyoqXG4gKiBXaGVuIHRydWUsIGxvZyBzdGF0aXN0aWNzIHRvIHRoZSBjb25zb2xlIGV2ZXJ5IGZyYW1lXG4gKiBAdHlwZSB7Qm9vbGVhbn1cbiAqIEBkZWZhdWx0IGZhbHNlXG4gKiBAcHJpdmF0ZVxuICovXG5SZXF1ZXN0U2NoZWR1bGVyLmRlYnVnU2hvd1N0YXRpc3RpY3MgPSBmYWxzZTtcblxuLyoqXG4gKiBBbiBldmVudCB0aGF0J3MgcmFpc2VkIHdoZW4gYSByZXF1ZXN0IGlzIGNvbXBsZXRlZC4gIEV2ZW50IGhhbmRsZXJzIGFyZSBwYXNzZWRcbiAqIHRoZSBlcnJvciBvYmplY3QgaWYgdGhlIHJlcXVlc3QgZmFpbHMuXG4gKlxuICogQHR5cGUge0V2ZW50fVxuICogQGRlZmF1bHQgRXZlbnQoKVxuICogQHByaXZhdGVcbiAqL1xuUmVxdWVzdFNjaGVkdWxlci5yZXF1ZXN0Q29tcGxldGVkRXZlbnQgPSByZXF1ZXN0Q29tcGxldGVkRXZlbnQ7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFJlcXVlc3RTY2hlZHVsZXIsIHtcbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHN0YXRpc3RpY3MgdXNlZCBieSB0aGUgcmVxdWVzdCBzY2hlZHVsZXIuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBSZXF1ZXN0U2NoZWR1bGVyXG4gICAqXG4gICAqIEB0eXBlIE9iamVjdFxuICAgKiBAcmVhZG9ubHlcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHN0YXRpc3RpY3M6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzdGF0aXN0aWNzO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFRoZSBtYXhpbXVtIHNpemUgb2YgdGhlIHByaW9yaXR5IGhlYXAuIFRoaXMgbGltaXRzIHRoZSBudW1iZXIgb2YgcmVxdWVzdHMgdGhhdCBhcmUgc29ydGVkIGJ5IHByaW9yaXR5LiBPbmx5IGFwcGxpZXMgdG8gcmVxdWVzdHMgdGhhdCBhcmUgbm90IHlldCBhY3RpdmUuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBSZXF1ZXN0U2NoZWR1bGVyXG4gICAqXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqIEBkZWZhdWx0IDIwXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcmlvcml0eUhlYXBMZW5ndGg6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBwcmlvcml0eUhlYXBMZW5ndGg7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgLy8gSWYgdGhlIG5ldyBsZW5ndGggc2hyaW5rcyB0aGUgaGVhcCwgbmVlZCB0byBjYW5jZWwgc29tZSBvZiB0aGUgcmVxdWVzdHMuXG4gICAgICAvLyBTaW5jZSB0aGlzIHZhbHVlIGlzIG5vdCBpbnRlbmRlZCB0byBiZSB0d2Vha2VkIHJlZ3VsYXJseSBpdCBpcyBmaW5lIHRvIGp1c3QgY2FuY2VsIHRoZSBoaWdoIHByaW9yaXR5IHJlcXVlc3RzLlxuICAgICAgaWYgKHZhbHVlIDwgcHJpb3JpdHlIZWFwTGVuZ3RoKSB7XG4gICAgICAgIHdoaWxlIChyZXF1ZXN0SGVhcC5sZW5ndGggPiB2YWx1ZSkge1xuICAgICAgICAgIHZhciByZXF1ZXN0ID0gcmVxdWVzdEhlYXAucG9wKCk7XG4gICAgICAgICAgY2FuY2VsUmVxdWVzdChyZXF1ZXN0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcHJpb3JpdHlIZWFwTGVuZ3RoID0gdmFsdWU7XG4gICAgICByZXF1ZXN0SGVhcC5tYXhpbXVtTGVuZ3RoID0gdmFsdWU7XG4gICAgICByZXF1ZXN0SGVhcC5yZXNlcnZlKHZhbHVlKTtcbiAgICB9LFxuICB9LFxufSk7XG5cbmZ1bmN0aW9uIHVwZGF0ZVByaW9yaXR5KHJlcXVlc3QpIHtcbiAgaWYgKGRlZmluZWQocmVxdWVzdC5wcmlvcml0eUZ1bmN0aW9uKSkge1xuICAgIHJlcXVlc3QucHJpb3JpdHkgPSByZXF1ZXN0LnByaW9yaXR5RnVuY3Rpb24oKTtcbiAgfVxufVxuXG4vKipcbiAqIENoZWNrIGlmIHRoZXJlIGFyZSBvcGVuIHNsb3RzIGZvciBhIHBhcnRpY3VsYXIgc2VydmVyIGtleS4gSWYgZGVzaXJlZFJlcXVlc3RzIGlzIGdyZWF0ZXIgdGhhbiAxLCB0aGlzIGNoZWNrcyBpZiB0aGUgcXVldWUgaGFzIHJvb20gZm9yIHNjaGVkdWxpbmcgbXVsdGlwbGUgcmVxdWVzdHMuXG4gKiBAcGFyYW0ge1N0cmluZ30gc2VydmVyS2V5IFRoZSBzZXJ2ZXIga2V5IHJldHVybmVkIGJ5IHtAbGluayBSZXF1ZXN0U2NoZWR1bGVyLmdldFNlcnZlcktleX0uXG4gKiBAcGFyYW0ge051bWJlcn0gW2Rlc2lyZWRSZXF1ZXN0cz0xXSBIb3cgbWFueSByZXF1ZXN0cyB0aGUgY2FsbGVyIHBsYW5zIHRvIHJlcXVlc3RcbiAqIEByZXR1cm4ge0Jvb2xlYW59IFRydWUgaWYgdGhlcmUgYXJlIGVub3VnaCBvcGVuIHNsb3RzIGZvciA8Y29kZT5kZXNpcmVkUmVxdWVzdHM8L2NvZGU+IG1vcmUgcmVxdWVzdHMuXG4gKiBAcHJpdmF0ZVxuICovXG5SZXF1ZXN0U2NoZWR1bGVyLnNlcnZlckhhc09wZW5TbG90cyA9IGZ1bmN0aW9uIChzZXJ2ZXJLZXksIGRlc2lyZWRSZXF1ZXN0cykge1xuICBkZXNpcmVkUmVxdWVzdHMgPSBkZWZhdWx0VmFsdWUoZGVzaXJlZFJlcXVlc3RzLCAxKTtcblxuICB2YXIgbWF4UmVxdWVzdHMgPSBkZWZhdWx0VmFsdWUoXG4gICAgUmVxdWVzdFNjaGVkdWxlci5yZXF1ZXN0c0J5U2VydmVyW3NlcnZlcktleV0sXG4gICAgUmVxdWVzdFNjaGVkdWxlci5tYXhpbXVtUmVxdWVzdHNQZXJTZXJ2ZXJcbiAgKTtcbiAgdmFyIGhhc09wZW5TbG90c1NlcnZlciA9XG4gICAgbnVtYmVyT2ZBY3RpdmVSZXF1ZXN0c0J5U2VydmVyW3NlcnZlcktleV0gKyBkZXNpcmVkUmVxdWVzdHMgPD0gbWF4UmVxdWVzdHM7XG5cbiAgcmV0dXJuIGhhc09wZW5TbG90c1NlcnZlcjtcbn07XG5cbi8qKlxuICogQ2hlY2sgaWYgdGhlIHByaW9yaXR5IGhlYXAgaGFzIG9wZW4gc2xvdHMsIHJlZ2FyZGxlc3Mgb2Ygd2hpY2ggc2VydmVyIHRoZXlcbiAqIGFyZSBmcm9tLiBUaGlzIGlzIHVzZWQgaW4ge0BsaW5rIE11bHRpcGxlM0RUaWxlQ29udGVudH0gZm9yIGRldGVybWluaW5nIHdoZW5cbiAqIGFsbCByZXF1ZXN0cyBjYW4gYmUgc2NoZWR1bGVkXG4gKiBAcGFyYW0ge051bWJlcn0gZGVzaXJlZFJlcXVlc3RzIFRoZSBudW1iZXIgb2YgcmVxdWVzdHMgdGhlIGNhbGxlciBpbnRlbmRzIHRvIG1ha2VcbiAqIEByZXR1cm4ge0Jvb2xlYW59IDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoZSBoZWFwIGhhcyBlbm91Z2ggYXZhaWxhYmxlIHNsb3RzIHRvIG1lZXQgdGhlIGRlc2lyZWRSZXF1ZXN0cy4gPGNvZGU+ZmFsc2U8L2NvZGU+IG90aGVyd2lzZS5cbiAqXG4gKiBAcHJpdmF0ZVxuICovXG5SZXF1ZXN0U2NoZWR1bGVyLmhlYXBIYXNPcGVuU2xvdHMgPSBmdW5jdGlvbiAoZGVzaXJlZFJlcXVlc3RzKSB7XG4gIHZhciBoYXNPcGVuU2xvdHNIZWFwID1cbiAgICByZXF1ZXN0SGVhcC5sZW5ndGggKyBkZXNpcmVkUmVxdWVzdHMgPD0gcHJpb3JpdHlIZWFwTGVuZ3RoO1xuICByZXR1cm4gaGFzT3BlblNsb3RzSGVhcDtcbn07XG5cbmZ1bmN0aW9uIGlzc3VlUmVxdWVzdChyZXF1ZXN0KSB7XG4gIGlmIChyZXF1ZXN0LnN0YXRlID09PSBSZXF1ZXN0U3RhdGUuVU5JU1NVRUQpIHtcbiAgICByZXF1ZXN0LnN0YXRlID0gUmVxdWVzdFN0YXRlLklTU1VFRDtcbiAgICByZXF1ZXN0LmRlZmVycmVkID0gd2hlbi5kZWZlcigpO1xuICB9XG4gIHJldHVybiByZXF1ZXN0LmRlZmVycmVkLnByb21pc2U7XG59XG5cbmZ1bmN0aW9uIGdldFJlcXVlc3RSZWNlaXZlZEZ1bmN0aW9uKHJlcXVlc3QpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChyZXN1bHRzKSB7XG4gICAgaWYgKHJlcXVlc3Quc3RhdGUgPT09IFJlcXVlc3RTdGF0ZS5DQU5DRUxMRUQpIHtcbiAgICAgIC8vIElmIHRoZSBkYXRhIHJlcXVlc3QgY29tZXMgYmFjayBidXQgdGhlIHJlcXVlc3QgaXMgY2FuY2VsbGVkLCBpZ25vcmUgaXQuXG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vIGV4cGxpY2l0bHkgc2V0IHRvIHVuZGVmaW5lZCB0byBlbnN1cmUgR0Mgb2YgcmVxdWVzdCByZXNwb25zZSBkYXRhLiBTZWUgIzg4NDNcbiAgICB2YXIgZGVmZXJyZWQgPSByZXF1ZXN0LmRlZmVycmVkO1xuXG4gICAgLS1zdGF0aXN0aWNzLm51bWJlck9mQWN0aXZlUmVxdWVzdHM7XG4gICAgLS1udW1iZXJPZkFjdGl2ZVJlcXVlc3RzQnlTZXJ2ZXJbcmVxdWVzdC5zZXJ2ZXJLZXldO1xuICAgIHJlcXVlc3RDb21wbGV0ZWRFdmVudC5yYWlzZUV2ZW50KCk7XG4gICAgcmVxdWVzdC5zdGF0ZSA9IFJlcXVlc3RTdGF0ZS5SRUNFSVZFRDtcbiAgICByZXF1ZXN0LmRlZmVycmVkID0gdW5kZWZpbmVkO1xuXG4gICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHRzKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gZ2V0UmVxdWVzdEZhaWxlZEZ1bmN0aW9uKHJlcXVlc3QpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChlcnJvcikge1xuICAgIGlmIChyZXF1ZXN0LnN0YXRlID09PSBSZXF1ZXN0U3RhdGUuQ0FOQ0VMTEVEKSB7XG4gICAgICAvLyBJZiB0aGUgZGF0YSByZXF1ZXN0IGNvbWVzIGJhY2sgYnV0IHRoZSByZXF1ZXN0IGlzIGNhbmNlbGxlZCwgaWdub3JlIGl0LlxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICArK3N0YXRpc3RpY3MubnVtYmVyT2ZGYWlsZWRSZXF1ZXN0cztcbiAgICAtLXN0YXRpc3RpY3MubnVtYmVyT2ZBY3RpdmVSZXF1ZXN0cztcbiAgICAtLW51bWJlck9mQWN0aXZlUmVxdWVzdHNCeVNlcnZlcltyZXF1ZXN0LnNlcnZlcktleV07XG4gICAgcmVxdWVzdENvbXBsZXRlZEV2ZW50LnJhaXNlRXZlbnQoZXJyb3IpO1xuICAgIHJlcXVlc3Quc3RhdGUgPSBSZXF1ZXN0U3RhdGUuRkFJTEVEO1xuICAgIHJlcXVlc3QuZGVmZXJyZWQucmVqZWN0KGVycm9yKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gc3RhcnRSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgdmFyIHByb21pc2UgPSBpc3N1ZVJlcXVlc3QocmVxdWVzdCk7XG4gIHJlcXVlc3Quc3RhdGUgPSBSZXF1ZXN0U3RhdGUuQUNUSVZFO1xuICBhY3RpdmVSZXF1ZXN0cy5wdXNoKHJlcXVlc3QpO1xuICArK3N0YXRpc3RpY3MubnVtYmVyT2ZBY3RpdmVSZXF1ZXN0cztcbiAgKytzdGF0aXN0aWNzLm51bWJlck9mQWN0aXZlUmVxdWVzdHNFdmVyO1xuICArK251bWJlck9mQWN0aXZlUmVxdWVzdHNCeVNlcnZlcltyZXF1ZXN0LnNlcnZlcktleV07XG4gIHJlcXVlc3RcbiAgICAucmVxdWVzdEZ1bmN0aW9uKClcbiAgICAudGhlbihnZXRSZXF1ZXN0UmVjZWl2ZWRGdW5jdGlvbihyZXF1ZXN0KSlcbiAgICAub3RoZXJ3aXNlKGdldFJlcXVlc3RGYWlsZWRGdW5jdGlvbihyZXF1ZXN0KSk7XG4gIHJldHVybiBwcm9taXNlO1xufVxuXG5mdW5jdGlvbiBjYW5jZWxSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgdmFyIGFjdGl2ZSA9IHJlcXVlc3Quc3RhdGUgPT09IFJlcXVlc3RTdGF0ZS5BQ1RJVkU7XG4gIHJlcXVlc3Quc3RhdGUgPSBSZXF1ZXN0U3RhdGUuQ0FOQ0VMTEVEO1xuICArK3N0YXRpc3RpY3MubnVtYmVyT2ZDYW5jZWxsZWRSZXF1ZXN0cztcbiAgLy8gY2hlY2sgdGhhdCBkZWZlcnJlZCBoYXMgbm90IGJlZW4gY2xlYXJlZCBzaW5jZSBjYW5jZWxSZXF1ZXN0IGNhbiBiZSBjYWxsZWRcbiAgLy8gb24gYSBmaW5pc2hlZCByZXF1ZXN0LCBlLmcuIGJ5IGNsZWFyRm9yU3BlY3MgZHVyaW5nIHRlc3RzXG4gIGlmIChkZWZpbmVkKHJlcXVlc3QuZGVmZXJyZWQpKSB7XG4gICAgdmFyIGRlZmVycmVkID0gcmVxdWVzdC5kZWZlcnJlZDtcbiAgICByZXF1ZXN0LmRlZmVycmVkID0gdW5kZWZpbmVkO1xuICAgIGRlZmVycmVkLnJlamVjdCgpO1xuICB9XG5cbiAgaWYgKGFjdGl2ZSkge1xuICAgIC0tc3RhdGlzdGljcy5udW1iZXJPZkFjdGl2ZVJlcXVlc3RzO1xuICAgIC0tbnVtYmVyT2ZBY3RpdmVSZXF1ZXN0c0J5U2VydmVyW3JlcXVlc3Quc2VydmVyS2V5XTtcbiAgICArK3N0YXRpc3RpY3MubnVtYmVyT2ZDYW5jZWxsZWRBY3RpdmVSZXF1ZXN0cztcbiAgfVxuXG4gIGlmIChkZWZpbmVkKHJlcXVlc3QuY2FuY2VsRnVuY3Rpb24pKSB7XG4gICAgcmVxdWVzdC5jYW5jZWxGdW5jdGlvbigpO1xuICB9XG59XG5cbi8qKlxuICogU29ydCByZXF1ZXN0cyBieSBwcmlvcml0eSBhbmQgc3RhcnQgcmVxdWVzdHMuXG4gKiBAcHJpdmF0ZVxuICovXG5SZXF1ZXN0U2NoZWR1bGVyLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGk7XG4gIHZhciByZXF1ZXN0O1xuXG4gIC8vIExvb3Agb3ZlciBhbGwgYWN0aXZlIHJlcXVlc3RzLiBDYW5jZWxsZWQsIGZhaWxlZCwgb3IgcmVjZWl2ZWQgcmVxdWVzdHMgYXJlIHJlbW92ZWQgZnJvbSB0aGUgYXJyYXkgdG8gbWFrZSByb29tIGZvciBuZXcgcmVxdWVzdHMuXG4gIHZhciByZW1vdmVDb3VudCA9IDA7XG4gIHZhciBhY3RpdmVMZW5ndGggPSBhY3RpdmVSZXF1ZXN0cy5sZW5ndGg7XG4gIGZvciAoaSA9IDA7IGkgPCBhY3RpdmVMZW5ndGg7ICsraSkge1xuICAgIHJlcXVlc3QgPSBhY3RpdmVSZXF1ZXN0c1tpXTtcbiAgICBpZiAocmVxdWVzdC5jYW5jZWxsZWQpIHtcbiAgICAgIC8vIFJlcXVlc3Qgd2FzIGV4cGxpY2l0bHkgY2FuY2VsbGVkXG4gICAgICBjYW5jZWxSZXF1ZXN0KHJlcXVlc3QpO1xuICAgIH1cbiAgICBpZiAocmVxdWVzdC5zdGF0ZSAhPT0gUmVxdWVzdFN0YXRlLkFDVElWRSkge1xuICAgICAgLy8gUmVxdWVzdCBpcyBubyBsb25nZXIgYWN0aXZlLCByZW1vdmUgZnJvbSBhcnJheVxuICAgICAgKytyZW1vdmVDb3VudDtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAocmVtb3ZlQ291bnQgPiAwKSB7XG4gICAgICAvLyBTaGlmdCBiYWNrIHRvIGZpbGwgaW4gdmFjYXRlZCBzbG90cyBmcm9tIGNvbXBsZXRlZCByZXF1ZXN0c1xuICAgICAgYWN0aXZlUmVxdWVzdHNbaSAtIHJlbW92ZUNvdW50XSA9IHJlcXVlc3Q7XG4gICAgfVxuICB9XG4gIGFjdGl2ZVJlcXVlc3RzLmxlbmd0aCAtPSByZW1vdmVDb3VudDtcblxuICAvLyBVcGRhdGUgcHJpb3JpdHkgb2YgaXNzdWVkIHJlcXVlc3RzIGFuZCByZXNvcnQgdGhlIGhlYXBcbiAgdmFyIGlzc3VlZFJlcXVlc3RzID0gcmVxdWVzdEhlYXAuaW50ZXJuYWxBcnJheTtcbiAgdmFyIGlzc3VlZExlbmd0aCA9IHJlcXVlc3RIZWFwLmxlbmd0aDtcbiAgZm9yIChpID0gMDsgaSA8IGlzc3VlZExlbmd0aDsgKytpKSB7XG4gICAgdXBkYXRlUHJpb3JpdHkoaXNzdWVkUmVxdWVzdHNbaV0pO1xuICB9XG4gIHJlcXVlc3RIZWFwLnJlc29ydCgpO1xuXG4gIC8vIEdldCB0aGUgbnVtYmVyIG9mIG9wZW4gc2xvdHMgYW5kIGZpbGwgd2l0aCB0aGUgaGlnaGVzdCBwcmlvcml0eSByZXF1ZXN0cy5cbiAgLy8gVW4tdGhyb3R0bGVkIHJlcXVlc3RzIGFyZSBhdXRvbWF0aWNhbGx5IGFkZGVkIHRvIGFjdGl2ZVJlcXVlc3RzLCBzbyBhY3RpdmVSZXF1ZXN0cy5sZW5ndGggbWF5IGV4Y2VlZCBtYXhpbXVtUmVxdWVzdHNcbiAgdmFyIG9wZW5TbG90cyA9IE1hdGgubWF4KFxuICAgIFJlcXVlc3RTY2hlZHVsZXIubWF4aW11bVJlcXVlc3RzIC0gYWN0aXZlUmVxdWVzdHMubGVuZ3RoLFxuICAgIDBcbiAgKTtcbiAgdmFyIGZpbGxlZFNsb3RzID0gMDtcbiAgd2hpbGUgKGZpbGxlZFNsb3RzIDwgb3BlblNsb3RzICYmIHJlcXVlc3RIZWFwLmxlbmd0aCA+IDApIHtcbiAgICAvLyBMb29wIHVudGlsIGFsbCBvcGVuIHNsb3RzIGFyZSBmaWxsZWQgb3IgdGhlIGhlYXAgYmVjb21lcyBlbXB0eVxuICAgIHJlcXVlc3QgPSByZXF1ZXN0SGVhcC5wb3AoKTtcbiAgICBpZiAocmVxdWVzdC5jYW5jZWxsZWQpIHtcbiAgICAgIC8vIFJlcXVlc3Qgd2FzIGV4cGxpY2l0bHkgY2FuY2VsbGVkXG4gICAgICBjYW5jZWxSZXF1ZXN0KHJlcXVlc3QpO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgaWYgKFxuICAgICAgcmVxdWVzdC50aHJvdHRsZUJ5U2VydmVyICYmXG4gICAgICAhUmVxdWVzdFNjaGVkdWxlci5zZXJ2ZXJIYXNPcGVuU2xvdHMocmVxdWVzdC5zZXJ2ZXJLZXkpXG4gICAgKSB7XG4gICAgICAvLyBPcGVuIHNsb3RzIGFyZSBhdmFpbGFibGUsIGJ1dCB0aGUgcmVxdWVzdCBpcyB0aHJvdHRsZWQgYnkgaXRzIHNlcnZlci4gQ2FuY2VsIGFuZCB0cnkgYWdhaW4gbGF0ZXIuXG4gICAgICBjYW5jZWxSZXF1ZXN0KHJlcXVlc3QpO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgc3RhcnRSZXF1ZXN0KHJlcXVlc3QpO1xuICAgICsrZmlsbGVkU2xvdHM7XG4gIH1cblxuICB1cGRhdGVTdGF0aXN0aWNzKCk7XG59O1xuXG4vKipcbiAqIEdldCB0aGUgc2VydmVyIGtleSBmcm9tIGEgZ2l2ZW4gdXJsLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSB1cmwgVGhlIHVybC5cbiAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBzZXJ2ZXIga2V5LlxuICogQHByaXZhdGVcbiAqL1xuUmVxdWVzdFNjaGVkdWxlci5nZXRTZXJ2ZXJLZXkgPSBmdW5jdGlvbiAodXJsKSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLnR5cGVPZi5zdHJpbmcoXCJ1cmxcIiwgdXJsKTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgdmFyIHVyaSA9IG5ldyBVcmkodXJsKTtcbiAgaWYgKHVyaS5zY2hlbWUoKSA9PT0gXCJcIikge1xuICAgIHVyaSA9IG5ldyBVcmkodXJsKS5hYnNvbHV0ZVRvKHBhZ2VVcmkpO1xuICAgIHVyaS5ub3JtYWxpemUoKTtcbiAgfVxuXG4gIHZhciBzZXJ2ZXJLZXkgPSB1cmkuYXV0aG9yaXR5KCk7XG4gIGlmICghLzovLnRlc3Qoc2VydmVyS2V5KSkge1xuICAgIC8vIElmIHRoZSBhdXRob3JpdHkgZG9lcyBub3QgY29udGFpbiBhIHBvcnQgbnVtYmVyLCBhZGQgcG9ydCA0NDMgZm9yIGh0dHBzIG9yIHBvcnQgODAgZm9yIGh0dHBcbiAgICBzZXJ2ZXJLZXkgPSBzZXJ2ZXJLZXkgKyBcIjpcIiArICh1cmkuc2NoZW1lKCkgPT09IFwiaHR0cHNcIiA/IFwiNDQzXCIgOiBcIjgwXCIpO1xuICB9XG5cbiAgdmFyIGxlbmd0aCA9IG51bWJlck9mQWN0aXZlUmVxdWVzdHNCeVNlcnZlcltzZXJ2ZXJLZXldO1xuICBpZiAoIWRlZmluZWQobGVuZ3RoKSkge1xuICAgIG51bWJlck9mQWN0aXZlUmVxdWVzdHNCeVNlcnZlcltzZXJ2ZXJLZXldID0gMDtcbiAgfVxuXG4gIHJldHVybiBzZXJ2ZXJLZXk7XG59O1xuXG4vKipcbiAqIElzc3VlIGEgcmVxdWVzdC4gSWYgcmVxdWVzdC50aHJvdHRsZSBpcyBmYWxzZSwgdGhlIHJlcXVlc3QgaXMgc2VudCBpbW1lZGlhdGVseS4gT3RoZXJ3aXNlIHRoZSByZXF1ZXN0IHdpbGwgYmVcbiAqIHF1ZXVlZCBhbmQgc29ydGVkIGJ5IHByaW9yaXR5IGJlZm9yZSBiZWluZyBzZW50LlxuICpcbiAqIEBwYXJhbSB7UmVxdWVzdH0gcmVxdWVzdCBUaGUgcmVxdWVzdCBvYmplY3QuXG4gKlxuICogQHJldHVybnMge1Byb21pc2V8dW5kZWZpbmVkfSBBIFByb21pc2UgZm9yIHRoZSByZXF1ZXN0ZWQgZGF0YSwgb3IgdW5kZWZpbmVkIGlmIHRoaXMgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIGhpZ2ggZW5vdWdoIHByaW9yaXR5IHRvIGJlIGlzc3VlZC5cbiAqXG4gKiBAcHJpdmF0ZVxuICovXG5SZXF1ZXN0U2NoZWR1bGVyLnJlcXVlc3QgPSBmdW5jdGlvbiAocmVxdWVzdCkge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwicmVxdWVzdFwiLCByZXF1ZXN0KTtcbiAgQ2hlY2sudHlwZU9mLnN0cmluZyhcInJlcXVlc3QudXJsXCIsIHJlcXVlc3QudXJsKTtcbiAgQ2hlY2sudHlwZU9mLmZ1bmMoXCJyZXF1ZXN0LnJlcXVlc3RGdW5jdGlvblwiLCByZXF1ZXN0LnJlcXVlc3RGdW5jdGlvbik7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIGlmIChpc0RhdGFVcmkocmVxdWVzdC51cmwpIHx8IGlzQmxvYlVyaShyZXF1ZXN0LnVybCkpIHtcbiAgICByZXF1ZXN0Q29tcGxldGVkRXZlbnQucmFpc2VFdmVudCgpO1xuICAgIHJlcXVlc3Quc3RhdGUgPSBSZXF1ZXN0U3RhdGUuUkVDRUlWRUQ7XG4gICAgcmV0dXJuIHJlcXVlc3QucmVxdWVzdEZ1bmN0aW9uKCk7XG4gIH1cblxuICArK3N0YXRpc3RpY3MubnVtYmVyT2ZBdHRlbXB0ZWRSZXF1ZXN0cztcblxuICBpZiAoIWRlZmluZWQocmVxdWVzdC5zZXJ2ZXJLZXkpKSB7XG4gICAgcmVxdWVzdC5zZXJ2ZXJLZXkgPSBSZXF1ZXN0U2NoZWR1bGVyLmdldFNlcnZlcktleShyZXF1ZXN0LnVybCk7XG4gIH1cblxuICBpZiAoXG4gICAgUmVxdWVzdFNjaGVkdWxlci50aHJvdHRsZVJlcXVlc3RzICYmXG4gICAgcmVxdWVzdC50aHJvdHRsZUJ5U2VydmVyICYmXG4gICAgIVJlcXVlc3RTY2hlZHVsZXIuc2VydmVySGFzT3BlblNsb3RzKHJlcXVlc3Quc2VydmVyS2V5KVxuICApIHtcbiAgICAvLyBTZXJ2ZXIgaXMgc2F0dXJhdGVkLiBUcnkgYWdhaW4gbGF0ZXIuXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIGlmICghUmVxdWVzdFNjaGVkdWxlci50aHJvdHRsZVJlcXVlc3RzIHx8ICFyZXF1ZXN0LnRocm90dGxlKSB7XG4gICAgcmV0dXJuIHN0YXJ0UmVxdWVzdChyZXF1ZXN0KTtcbiAgfVxuXG4gIGlmIChhY3RpdmVSZXF1ZXN0cy5sZW5ndGggPj0gUmVxdWVzdFNjaGVkdWxlci5tYXhpbXVtUmVxdWVzdHMpIHtcbiAgICAvLyBBY3RpdmUgcmVxdWVzdHMgYXJlIHNhdHVyYXRlZC4gVHJ5IGFnYWluIGxhdGVyLlxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICAvLyBJbnNlcnQgaW50byB0aGUgcHJpb3JpdHkgaGVhcCBhbmQgc2VlIGlmIGEgcmVxdWVzdCB3YXMgYnVtcGVkIG9mZi4gSWYgdGhpcyByZXF1ZXN0IGlzIHRoZSBsb3dlc3RcbiAgLy8gcHJpb3JpdHkgaXQgd2lsbCBiZSByZXR1cm5lZC5cbiAgdXBkYXRlUHJpb3JpdHkocmVxdWVzdCk7XG4gIHZhciByZW1vdmVkUmVxdWVzdCA9IHJlcXVlc3RIZWFwLmluc2VydChyZXF1ZXN0KTtcblxuICBpZiAoZGVmaW5lZChyZW1vdmVkUmVxdWVzdCkpIHtcbiAgICBpZiAocmVtb3ZlZFJlcXVlc3QgPT09IHJlcXVlc3QpIHtcbiAgICAgIC8vIFJlcXVlc3QgZG9lcyBub3QgaGF2ZSBoaWdoIGVub3VnaCBwcmlvcml0eSB0byBiZSBpc3N1ZWRcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8vIEEgcHJldmlvdXNseSBpc3N1ZWQgcmVxdWVzdCBoYXMgYmVlbiBidW1wZWQgb2ZmIHRoZSBwcmlvcml0eSBoZWFwLCBzbyBjYW5jZWwgaXRcbiAgICBjYW5jZWxSZXF1ZXN0KHJlbW92ZWRSZXF1ZXN0KTtcbiAgfVxuXG4gIHJldHVybiBpc3N1ZVJlcXVlc3QocmVxdWVzdCk7XG59O1xuXG5mdW5jdGlvbiB1cGRhdGVTdGF0aXN0aWNzKCkge1xuICBpZiAoIVJlcXVlc3RTY2hlZHVsZXIuZGVidWdTaG93U3RhdGlzdGljcykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChcbiAgICBzdGF0aXN0aWNzLm51bWJlck9mQWN0aXZlUmVxdWVzdHMgPT09IDAgJiZcbiAgICBzdGF0aXN0aWNzLmxhc3ROdW1iZXJPZkFjdGl2ZVJlcXVlc3RzID4gMFxuICApIHtcbiAgICBpZiAoc3RhdGlzdGljcy5udW1iZXJPZkF0dGVtcHRlZFJlcXVlc3RzID4gMCkge1xuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIFwiTnVtYmVyIG9mIGF0dGVtcHRlZCByZXF1ZXN0czogXCIgKyBzdGF0aXN0aWNzLm51bWJlck9mQXR0ZW1wdGVkUmVxdWVzdHNcbiAgICAgICk7XG4gICAgICBzdGF0aXN0aWNzLm51bWJlck9mQXR0ZW1wdGVkUmVxdWVzdHMgPSAwO1xuICAgIH1cblxuICAgIGlmIChzdGF0aXN0aWNzLm51bWJlck9mQ2FuY2VsbGVkUmVxdWVzdHMgPiAwKSB7XG4gICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgXCJOdW1iZXIgb2YgY2FuY2VsbGVkIHJlcXVlc3RzOiBcIiArIHN0YXRpc3RpY3MubnVtYmVyT2ZDYW5jZWxsZWRSZXF1ZXN0c1xuICAgICAgKTtcbiAgICAgIHN0YXRpc3RpY3MubnVtYmVyT2ZDYW5jZWxsZWRSZXF1ZXN0cyA9IDA7XG4gICAgfVxuXG4gICAgaWYgKHN0YXRpc3RpY3MubnVtYmVyT2ZDYW5jZWxsZWRBY3RpdmVSZXF1ZXN0cyA+IDApIHtcbiAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICBcIk51bWJlciBvZiBjYW5jZWxsZWQgYWN0aXZlIHJlcXVlc3RzOiBcIiArXG4gICAgICAgICAgc3RhdGlzdGljcy5udW1iZXJPZkNhbmNlbGxlZEFjdGl2ZVJlcXVlc3RzXG4gICAgICApO1xuICAgICAgc3RhdGlzdGljcy5udW1iZXJPZkNhbmNlbGxlZEFjdGl2ZVJlcXVlc3RzID0gMDtcbiAgICB9XG5cbiAgICBpZiAoc3RhdGlzdGljcy5udW1iZXJPZkZhaWxlZFJlcXVlc3RzID4gMCkge1xuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIFwiTnVtYmVyIG9mIGZhaWxlZCByZXF1ZXN0czogXCIgKyBzdGF0aXN0aWNzLm51bWJlck9mRmFpbGVkUmVxdWVzdHNcbiAgICAgICk7XG4gICAgICBzdGF0aXN0aWNzLm51bWJlck9mRmFpbGVkUmVxdWVzdHMgPSAwO1xuICAgIH1cbiAgfVxuXG4gIHN0YXRpc3RpY3MubGFzdE51bWJlck9mQWN0aXZlUmVxdWVzdHMgPSBzdGF0aXN0aWNzLm51bWJlck9mQWN0aXZlUmVxdWVzdHM7XG59XG5cbi8qKlxuICogRm9yIHRlc3Rpbmcgb25seS4gQ2xlYXJzIGFueSByZXF1ZXN0cyB0aGF0IG1heSBub3QgaGF2ZSBjb21wbGV0ZWQgZnJvbSBwcmV2aW91cyB0ZXN0cy5cbiAqXG4gKiBAcHJpdmF0ZVxuICovXG5SZXF1ZXN0U2NoZWR1bGVyLmNsZWFyRm9yU3BlY3MgPSBmdW5jdGlvbiAoKSB7XG4gIHdoaWxlIChyZXF1ZXN0SGVhcC5sZW5ndGggPiAwKSB7XG4gICAgdmFyIHJlcXVlc3QgPSByZXF1ZXN0SGVhcC5wb3AoKTtcbiAgICBjYW5jZWxSZXF1ZXN0KHJlcXVlc3QpO1xuICB9XG4gIHZhciBsZW5ndGggPSBhY3RpdmVSZXF1ZXN0cy5sZW5ndGg7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICBjYW5jZWxSZXF1ZXN0KGFjdGl2ZVJlcXVlc3RzW2ldKTtcbiAgfVxuICBhY3RpdmVSZXF1ZXN0cy5sZW5ndGggPSAwO1xuICBudW1iZXJPZkFjdGl2ZVJlcXVlc3RzQnlTZXJ2ZXIgPSB7fTtcblxuICAvLyBDbGVhciBzdGF0c1xuICBzdGF0aXN0aWNzLm51bWJlck9mQXR0ZW1wdGVkUmVxdWVzdHMgPSAwO1xuICBzdGF0aXN0aWNzLm51bWJlck9mQWN0aXZlUmVxdWVzdHMgPSAwO1xuICBzdGF0aXN0aWNzLm51bWJlck9mQ2FuY2VsbGVkUmVxdWVzdHMgPSAwO1xuICBzdGF0aXN0aWNzLm51bWJlck9mQ2FuY2VsbGVkQWN0aXZlUmVxdWVzdHMgPSAwO1xuICBzdGF0aXN0aWNzLm51bWJlck9mRmFpbGVkUmVxdWVzdHMgPSAwO1xuICBzdGF0aXN0aWNzLm51bWJlck9mQWN0aXZlUmVxdWVzdHNFdmVyID0gMDtcbiAgc3RhdGlzdGljcy5sYXN0TnVtYmVyT2ZBY3RpdmVSZXF1ZXN0cyA9IDA7XG59O1xuXG4vKipcbiAqIEZvciB0ZXN0aW5nIG9ubHkuXG4gKlxuICogQHByaXZhdGVcbiAqL1xuUmVxdWVzdFNjaGVkdWxlci5udW1iZXJPZkFjdGl2ZVJlcXVlc3RzQnlTZXJ2ZXIgPSBmdW5jdGlvbiAoc2VydmVyS2V5KSB7XG4gIHJldHVybiBudW1iZXJPZkFjdGl2ZVJlcXVlc3RzQnlTZXJ2ZXJbc2VydmVyS2V5XTtcbn07XG5cbi8qKlxuICogRm9yIHRlc3Rpbmcgb25seS5cbiAqXG4gKiBAcHJpdmF0ZVxuICovXG5SZXF1ZXN0U2NoZWR1bGVyLnJlcXVlc3RIZWFwID0gcmVxdWVzdEhlYXA7XG5leHBvcnQgZGVmYXVsdCBSZXF1ZXN0U2NoZWR1bGVyO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///63181\n')},6224:function(__unused_webpack___webpack_module__,__webpack_exports__){eval('/**\n * State of the request.\n *\n * @enum {Number}\n */\nvar RequestState = {\n  /**\n   * Initial unissued state.\n   *\n   * @type Number\n   * @constant\n   */\n  UNISSUED: 0,\n\n  /**\n   * Issued but not yet active. Will become active when open slots are available.\n   *\n   * @type Number\n   * @constant\n   */\n  ISSUED: 1,\n\n  /**\n   * Actual http request has been sent.\n   *\n   * @type Number\n   * @constant\n   */\n  ACTIVE: 2,\n\n  /**\n   * Request completed successfully.\n   *\n   * @type Number\n   * @constant\n   */\n  RECEIVED: 3,\n\n  /**\n   * Request was cancelled, either explicitly or automatically because of low priority.\n   *\n   * @type Number\n   * @constant\n   */\n  CANCELLED: 4,\n\n  /**\n   * Request failed.\n   *\n   * @type Number\n   * @constant\n   */\n  FAILED: 5,\n};\n/* harmony default export */ __webpack_exports__["Z"] = (Object.freeze(RequestState));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjIyNC5qcyIsIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBZSwyQkFBMkIsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9Db3JlL1JlcXVlc3RTdGF0ZS5qcz8yOTBlIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU3RhdGUgb2YgdGhlIHJlcXVlc3QuXG4gKlxuICogQGVudW0ge051bWJlcn1cbiAqL1xudmFyIFJlcXVlc3RTdGF0ZSA9IHtcbiAgLyoqXG4gICAqIEluaXRpYWwgdW5pc3N1ZWQgc3RhdGUuXG4gICAqXG4gICAqIEB0eXBlIE51bWJlclxuICAgKiBAY29uc3RhbnRcbiAgICovXG4gIFVOSVNTVUVEOiAwLFxuXG4gIC8qKlxuICAgKiBJc3N1ZWQgYnV0IG5vdCB5ZXQgYWN0aXZlLiBXaWxsIGJlY29tZSBhY3RpdmUgd2hlbiBvcGVuIHNsb3RzIGFyZSBhdmFpbGFibGUuXG4gICAqXG4gICAqIEB0eXBlIE51bWJlclxuICAgKiBAY29uc3RhbnRcbiAgICovXG4gIElTU1VFRDogMSxcblxuICAvKipcbiAgICogQWN0dWFsIGh0dHAgcmVxdWVzdCBoYXMgYmVlbiBzZW50LlxuICAgKlxuICAgKiBAdHlwZSBOdW1iZXJcbiAgICogQGNvbnN0YW50XG4gICAqL1xuICBBQ1RJVkU6IDIsXG5cbiAgLyoqXG4gICAqIFJlcXVlc3QgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS5cbiAgICpcbiAgICogQHR5cGUgTnVtYmVyXG4gICAqIEBjb25zdGFudFxuICAgKi9cbiAgUkVDRUlWRUQ6IDMsXG5cbiAgLyoqXG4gICAqIFJlcXVlc3Qgd2FzIGNhbmNlbGxlZCwgZWl0aGVyIGV4cGxpY2l0bHkgb3IgYXV0b21hdGljYWxseSBiZWNhdXNlIG9mIGxvdyBwcmlvcml0eS5cbiAgICpcbiAgICogQHR5cGUgTnVtYmVyXG4gICAqIEBjb25zdGFudFxuICAgKi9cbiAgQ0FOQ0VMTEVEOiA0LFxuXG4gIC8qKlxuICAgKiBSZXF1ZXN0IGZhaWxlZC5cbiAgICpcbiAgICogQHR5cGUgTnVtYmVyXG4gICAqIEBjb25zdGFudFxuICAgKi9cbiAgRkFJTEVEOiA1LFxufTtcbmV4cG9ydCBkZWZhdWx0IE9iamVjdC5mcmVlemUoUmVxdWVzdFN0YXRlKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///6224\n')},82968:function(__unused_webpack___webpack_module__,__webpack_exports__){eval('/**\n * An enum identifying the type of request. Used for finer grained logging and priority sorting.\n *\n * @enum {Number}\n */\nvar RequestType = {\n  /**\n   * Terrain request.\n   *\n   * @type Number\n   * @constant\n   */\n  TERRAIN: 0,\n\n  /**\n   * Imagery request.\n   *\n   * @type Number\n   * @constant\n   */\n  IMAGERY: 1,\n\n  /**\n   * 3D Tiles request.\n   *\n   * @type Number\n   * @constant\n   */\n  TILES3D: 2,\n\n  /**\n   * Other request.\n   *\n   * @type Number\n   * @constant\n   */\n  OTHER: 3,\n};\n/* harmony default export */ __webpack_exports__["Z"] = (Object.freeze(RequestType));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODI5NjguanMiLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQWUsMEJBQTBCLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92dWUzLXdlYnBhY2s1Ly4vbm9kZV9tb2R1bGVzL2Nlc2l1bS9Tb3VyY2UvQ29yZS9SZXF1ZXN0VHlwZS5qcz85NDYzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQW4gZW51bSBpZGVudGlmeWluZyB0aGUgdHlwZSBvZiByZXF1ZXN0LiBVc2VkIGZvciBmaW5lciBncmFpbmVkIGxvZ2dpbmcgYW5kIHByaW9yaXR5IHNvcnRpbmcuXG4gKlxuICogQGVudW0ge051bWJlcn1cbiAqL1xudmFyIFJlcXVlc3RUeXBlID0ge1xuICAvKipcbiAgICogVGVycmFpbiByZXF1ZXN0LlxuICAgKlxuICAgKiBAdHlwZSBOdW1iZXJcbiAgICogQGNvbnN0YW50XG4gICAqL1xuICBURVJSQUlOOiAwLFxuXG4gIC8qKlxuICAgKiBJbWFnZXJ5IHJlcXVlc3QuXG4gICAqXG4gICAqIEB0eXBlIE51bWJlclxuICAgKiBAY29uc3RhbnRcbiAgICovXG4gIElNQUdFUlk6IDEsXG5cbiAgLyoqXG4gICAqIDNEIFRpbGVzIHJlcXVlc3QuXG4gICAqXG4gICAqIEB0eXBlIE51bWJlclxuICAgKiBAY29uc3RhbnRcbiAgICovXG4gIFRJTEVTM0Q6IDIsXG5cbiAgLyoqXG4gICAqIE90aGVyIHJlcXVlc3QuXG4gICAqXG4gICAqIEB0eXBlIE51bWJlclxuICAgKiBAY29uc3RhbnRcbiAgICovXG4gIE9USEVSOiAzLFxufTtcbmV4cG9ydCBkZWZhdWx0IE9iamVjdC5mcmVlemUoUmVxdWVzdFR5cGUpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///82968\n')},68985:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _ThirdParty_Uri_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(93922);\n/* harmony import */ var _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(13222);\n/* harmony import */ var _appendForwardSlash_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(94883);\n/* harmony import */ var _Check_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(66553);\n/* harmony import */ var _clone_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(83856);\n/* harmony import */ var _combine_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(8182);\n/* harmony import */ var _defaultValue_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(62200);\n/* harmony import */ var _defined_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(82982);\n/* harmony import */ var _DeveloperError_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(12572);\n/* harmony import */ var _getAbsoluteUri_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(83295);\n/* harmony import */ var _getBaseUri_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(89071);\n/* harmony import */ var _getExtensionFromUri_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(83931);\n/* harmony import */ var _isBlobUri_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(66771);\n/* harmony import */ var _isCrossOriginUrl_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(77850);\n/* harmony import */ var _isDataUri_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(46138);\n/* harmony import */ var _loadAndExecuteScript_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(95636);\n/* harmony import */ var _Math_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(99417);\n/* harmony import */ var _objectToQuery_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(53411);\n/* harmony import */ var _queryToObject_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(95037);\n/* harmony import */ var _Request_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(22426);\n/* harmony import */ var _RequestErrorEvent_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(37156);\n/* harmony import */ var _RequestScheduler_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(63181);\n/* harmony import */ var _RequestState_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(6224);\n/* harmony import */ var _RuntimeError_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(9407);\n/* harmony import */ var _TrustedServers_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(84862);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar xhrBlobSupported = (function () {\n  try {\n    var xhr = new XMLHttpRequest();\n    xhr.open("GET", "#", true);\n    xhr.responseType = "blob";\n    return xhr.responseType === "blob";\n  } catch (e) {\n    return false;\n  }\n})();\n\n/**\n * Parses a query string and returns the object equivalent.\n *\n * @param {Uri} uri The Uri with a query object.\n * @param {Resource} resource The Resource that will be assigned queryParameters.\n * @param {Boolean} merge If true, we\'ll merge with the resource\'s existing queryParameters. Otherwise they will be replaced.\n * @param {Boolean} preserveQueryParameters If true duplicate parameters will be concatenated into an array. If false, keys in uri will take precedence.\n *\n * @private\n */\nfunction parseQuery(uri, resource, merge, preserveQueryParameters) {\n  var queryString = uri.query();\n  if (queryString.length === 0) {\n    return {};\n  }\n\n  var query;\n  // Special case we run into where the querystring is just a string, not key/value pairs\n  if (queryString.indexOf("=") === -1) {\n    var result = {};\n    result[queryString] = undefined;\n    query = result;\n  } else {\n    query = (0,_queryToObject_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(queryString);\n  }\n\n  if (merge) {\n    resource._queryParameters = combineQueryParameters(\n      query,\n      resource._queryParameters,\n      preserveQueryParameters\n    );\n  } else {\n    resource._queryParameters = query;\n  }\n  uri.search("");\n}\n\n/**\n * Converts a query object into a string.\n *\n * @param {Uri} uri The Uri object that will have the query object set.\n * @param {Resource} resource The resource that has queryParameters\n *\n * @private\n */\nfunction stringifyQuery(uri, resource) {\n  var queryObject = resource._queryParameters;\n\n  var keys = Object.keys(queryObject);\n\n  // We have 1 key with an undefined value, so this is just a string, not key/value pairs\n  if (keys.length === 1 && !(0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(queryObject[keys[0]])) {\n    uri.search(keys[0]);\n  } else {\n    uri.search((0,_objectToQuery_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(queryObject));\n  }\n}\n\n/**\n * Clones a value if it is defined, otherwise returns the default value\n *\n * @param {*} [val] The value to clone.\n * @param {*} [defaultVal] The default value.\n *\n * @returns {*} A clone of val or the defaultVal.\n *\n * @private\n */\nfunction defaultClone(val, defaultVal) {\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(val)) {\n    return defaultVal;\n  }\n\n  return (0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(val.clone) ? val.clone() : (0,_clone_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(val);\n}\n\n/**\n * Checks to make sure the Resource isn\'t already being requested.\n *\n * @param {Request} request The request to check.\n *\n * @private\n */\nfunction checkAndResetRequest(request) {\n  if (\n    request.state === _RequestState_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].ISSUED */ .Z.ISSUED ||\n    request.state === _RequestState_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].ACTIVE */ .Z.ACTIVE\n  ) {\n    throw new _RuntimeError_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"] */ .Z("The Resource is already being fetched.");\n  }\n\n  request.state = _RequestState_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].UNISSUED */ .Z.UNISSUED;\n  request.deferred = undefined;\n}\n\n/**\n * This combines a map of query parameters.\n *\n * @param {Object} q1 The first map of query parameters. Values in this map will take precedence if preserveQueryParameters is false.\n * @param {Object} q2 The second map of query parameters.\n * @param {Boolean} preserveQueryParameters If true duplicate parameters will be concatenated into an array. If false, keys in q1 will take precedence.\n *\n * @returns {Object} The combined map of query parameters.\n *\n * @example\n * var q1 = {\n *   a: 1,\n *   b: 2\n * };\n * var q2 = {\n *   a: 3,\n *   c: 4\n * };\n * var q3 = {\n *   b: [5, 6],\n *   d: 7\n * }\n *\n * // Returns\n * // {\n * //   a: [1, 3],\n * //   b: 2,\n * //   c: 4\n * // };\n * combineQueryParameters(q1, q2, true);\n *\n * // Returns\n * // {\n * //   a: 1,\n * //   b: 2,\n * //   c: 4\n * // };\n * combineQueryParameters(q1, q2, false);\n *\n * // Returns\n * // {\n * //   a: 1,\n * //   b: [2, 5, 6],\n * //   d: 7\n * // };\n * combineQueryParameters(q1, q3, true);\n *\n * // Returns\n * // {\n * //   a: 1,\n * //   b: 2,\n * //   d: 7\n * // };\n * combineQueryParameters(q1, q3, false);\n *\n * @private\n */\nfunction combineQueryParameters(q1, q2, preserveQueryParameters) {\n  if (!preserveQueryParameters) {\n    return (0,_combine_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(q1, q2);\n  }\n\n  var result = (0,_clone_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(q1, true);\n  for (var param in q2) {\n    if (q2.hasOwnProperty(param)) {\n      var value = result[param];\n      var q2Value = q2[param];\n      if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(value)) {\n        if (!Array.isArray(value)) {\n          value = result[param] = [value];\n        }\n\n        result[param] = value.concat(q2Value);\n      } else {\n        result[param] = Array.isArray(q2Value) ? q2Value.slice() : q2Value;\n      }\n    }\n  }\n\n  return result;\n}\n\n/**\n * A resource that includes the location and any other parameters we need to retrieve it or create derived resources. It also provides the ability to retry requests.\n *\n * @alias Resource\n * @constructor\n *\n * @param {String|Object} options A url or an object with the following properties\n * @param {String} options.url The url of the resource.\n * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\n * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\n * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\n * @param {Proxy} [options.proxy] A proxy to be used when loading the resource.\n * @param {Resource.RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\n * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\n * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\n *\n * @example\n * function refreshTokenRetryCallback(resource, error) {\n *   if (error.statusCode === 403) {\n *     // 403 status code means a new token should be generated\n *     return getNewAccessToken()\n *       .then(function(token) {\n *         resource.queryParameters.access_token = token;\n *         return true;\n *       })\n *       .otherwise(function() {\n *         return false;\n *       });\n *   }\n *\n *   return false;\n * }\n *\n * var resource = new Resource({\n *    url: \'http://server.com/path/to/resource.json\',\n *    proxy: new DefaultProxy(\'/proxy/\'),\n *    headers: {\n *      \'X-My-Header\': \'valueOfHeader\'\n *    },\n *    queryParameters: {\n *      \'access_token\': \'123-435-456-000\'\n *    },\n *    retryCallback: refreshTokenRetryCallback,\n *    retryAttempts: 1\n * });\n */\nfunction Resource(options) {\n  options = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options, _defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n  if (typeof options === "string") {\n    options = {\n      url: options,\n    };\n  }\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.string */ .Z.typeOf.string("options.url", options.url);\n  //>>includeEnd(\'debug\');\n\n  this._url = undefined;\n  this._templateValues = defaultClone(options.templateValues, {});\n  this._queryParameters = defaultClone(options.queryParameters, {});\n\n  /**\n   * Additional HTTP headers that will be sent with the request.\n   *\n   * @type {Object}\n   */\n  this.headers = defaultClone(options.headers, {});\n\n  /**\n   * A Request object that will be used. Intended for internal use only.\n   *\n   * @type {Request}\n   */\n  this.request = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options.request, new _Request_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z());\n\n  /**\n   * A proxy to be used when loading the resource.\n   *\n   * @type {Proxy}\n   */\n  this.proxy = options.proxy;\n\n  /**\n   * Function to call when a request for this resource fails. If it returns true or a Promise that resolves to true, the request will be retried.\n   *\n   * @type {Function}\n   */\n  this.retryCallback = options.retryCallback;\n\n  /**\n   * The number of times the retryCallback should be called before giving up.\n   *\n   * @type {Number}\n   */\n  this.retryAttempts = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options.retryAttempts, 0);\n  this._retryCount = 0;\n\n  var uri = new _ThirdParty_Uri_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(options.url);\n  parseQuery(uri, this, true, true);\n\n  // Remove the fragment as it\'s not sent with a request\n  uri.fragment("");\n\n  this._url = uri.toString();\n}\n\n/**\n * A helper function to create a resource depending on whether we have a String or a Resource\n *\n * @param {Resource|String} resource A Resource or a String to use when creating a new Resource.\n *\n * @returns {Resource} If resource is a String, a Resource constructed with the url and options. Otherwise the resource parameter is returned.\n *\n * @private\n */\nResource.createIfNeeded = function (resource) {\n  if (resource instanceof Resource) {\n    // Keep existing request object. This function is used internally to duplicate a Resource, so that it can\'t\n    //  be modified outside of a class that holds it (eg. an imagery or terrain provider). Since the Request objects\n    //  are managed outside of the providers, by the tile loading code, we want to keep the request property the same so if it is changed\n    //  in the underlying tiling code the requests for this resource will use it.\n    return resource.getDerivedResource({\n      request: resource.request,\n    });\n  }\n\n  if (typeof resource !== "string") {\n    return resource;\n  }\n\n  return new Resource({\n    url: resource,\n  });\n};\n\nvar supportsImageBitmapOptionsPromise;\n/**\n * A helper function to check whether createImageBitmap supports passing ImageBitmapOptions.\n *\n * @returns {Promise<Boolean>} A promise that resolves to true if this browser supports creating an ImageBitmap with options.\n *\n * @private\n */\nResource.supportsImageBitmapOptions = function () {\n  // Until the HTML folks figure out what to do about this, we need to actually try loading an image to\n  // know if this browser supports passing options to the createImageBitmap function.\n  // https://github.com/whatwg/html/pull/4248\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(supportsImageBitmapOptionsPromise)) {\n    return supportsImageBitmapOptionsPromise;\n  }\n\n  if (typeof createImageBitmap !== "function") {\n    supportsImageBitmapOptionsPromise = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].resolve */ .Z.resolve(false);\n    return supportsImageBitmapOptionsPromise;\n  }\n\n  var imageDataUri =\n    "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWP4////fwAJ+wP9CNHoHgAAAABJRU5ErkJggg==";\n\n  supportsImageBitmapOptionsPromise = Resource.fetchBlob({\n    url: imageDataUri,\n  })\n    .then(function (blob) {\n      return createImageBitmap(blob, {\n        imageOrientation: "flipY",\n        premultiplyAlpha: "none",\n        colorSpaceConversion: "none",\n      });\n    })\n    .then(function (imageBitmap) {\n      return true;\n    })\n    .otherwise(function () {\n      return false;\n    });\n\n  return supportsImageBitmapOptionsPromise;\n};\n\nObject.defineProperties(Resource, {\n  /**\n   * Returns true if blobs are supported.\n   *\n   * @memberof Resource\n   * @type {Boolean}\n   *\n   * @readonly\n   */\n  isBlobSupported: {\n    get: function () {\n      return xhrBlobSupported;\n    },\n  },\n});\n\nObject.defineProperties(Resource.prototype, {\n  /**\n   * Query parameters appended to the url.\n   *\n   * @memberof Resource.prototype\n   * @type {Object}\n   *\n   * @readonly\n   */\n  queryParameters: {\n    get: function () {\n      return this._queryParameters;\n    },\n  },\n\n  /**\n   * The key/value pairs used to replace template parameters in the url.\n   *\n   * @memberof Resource.prototype\n   * @type {Object}\n   *\n   * @readonly\n   */\n  templateValues: {\n    get: function () {\n      return this._templateValues;\n    },\n  },\n\n  /**\n   * The url to the resource with template values replaced, query string appended and encoded by proxy if one was set.\n   *\n   * @memberof Resource.prototype\n   * @type {String}\n   */\n  url: {\n    get: function () {\n      return this.getUrlComponent(true, true);\n    },\n    set: function (value) {\n      var uri = new _ThirdParty_Uri_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(value);\n\n      parseQuery(uri, this, false);\n\n      // Remove the fragment as it\'s not sent with a request\n      uri.fragment("");\n\n      this._url = uri.toString();\n    },\n  },\n\n  /**\n   * The file extension of the resource.\n   *\n   * @memberof Resource.prototype\n   * @type {String}\n   *\n   * @readonly\n   */\n  extension: {\n    get: function () {\n      return (0,_getExtensionFromUri_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(this._url);\n    },\n  },\n\n  /**\n   * True if the Resource refers to a data URI.\n   *\n   * @memberof Resource.prototype\n   * @type {Boolean}\n   */\n  isDataUri: {\n    get: function () {\n      return (0,_isDataUri_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z)(this._url);\n    },\n  },\n\n  /**\n   * True if the Resource refers to a blob URI.\n   *\n   * @memberof Resource.prototype\n   * @type {Boolean}\n   */\n  isBlobUri: {\n    get: function () {\n      return (0,_isBlobUri_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(this._url);\n    },\n  },\n\n  /**\n   * True if the Resource refers to a cross origin URL.\n   *\n   * @memberof Resource.prototype\n   * @type {Boolean}\n   */\n  isCrossOriginUrl: {\n    get: function () {\n      return (0,_isCrossOriginUrl_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(this._url);\n    },\n  },\n\n  /**\n   * True if the Resource has request headers. This is equivalent to checking if the headers property has any keys.\n   *\n   * @memberof Resource.prototype\n   * @type {Boolean}\n   */\n  hasHeaders: {\n    get: function () {\n      return Object.keys(this.headers).length > 0;\n    },\n  },\n});\n\n/**\n * Override Object#toString so that implicit string conversion gives the\n * complete URL represented by this Resource.\n *\n * @returns {String} The URL represented by this Resource\n */\nResource.prototype.toString = function () {\n  return this.getUrlComponent(true, true);\n};\n\n/**\n * Returns the url, optional with the query string and processed by a proxy.\n *\n * @param {Boolean} [query=false] If true, the query string is included.\n * @param {Boolean} [proxy=false] If true, the url is processed by the proxy object, if defined.\n *\n * @returns {String} The url with all the requested components.\n */\nResource.prototype.getUrlComponent = function (query, proxy) {\n  if (this.isDataUri) {\n    return this._url;\n  }\n\n  var uri = new _ThirdParty_Uri_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(this._url);\n\n  if (query) {\n    stringifyQuery(uri, this);\n  }\n\n  // objectToQuery escapes the placeholders.  Undo that.\n  var url = uri.toString().replace(/%7B/g, "{").replace(/%7D/g, "}");\n\n  var templateValues = this._templateValues;\n  url = url.replace(/{(.*?)}/g, function (match, key) {\n    var replacement = templateValues[key];\n    if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(replacement)) {\n      // use the replacement value from templateValues if there is one...\n      return encodeURIComponent(replacement);\n    }\n    // otherwise leave it unchanged\n    return match;\n  });\n\n  if (proxy && (0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(this.proxy)) {\n    url = this.proxy.getURL(url);\n  }\n  return url;\n};\n\n/**\n * Combines the specified object and the existing query parameters. This allows you to add many parameters at once,\n *  as opposed to adding them one at a time to the queryParameters property. If a value is already set, it will be replaced with the new value.\n *\n * @param {Object} params The query parameters\n * @param {Boolean} [useAsDefault=false] If true the params will be used as the default values, so they will only be set if they are undefined.\n */\nResource.prototype.setQueryParameters = function (params, useAsDefault) {\n  if (useAsDefault) {\n    this._queryParameters = combineQueryParameters(\n      this._queryParameters,\n      params,\n      false\n    );\n  } else {\n    this._queryParameters = combineQueryParameters(\n      params,\n      this._queryParameters,\n      false\n    );\n  }\n};\n\n/**\n * Combines the specified object and the existing query parameters. This allows you to add many parameters at once,\n *  as opposed to adding them one at a time to the queryParameters property.\n *\n * @param {Object} params The query parameters\n */\nResource.prototype.appendQueryParameters = function (params) {\n  this._queryParameters = combineQueryParameters(\n    params,\n    this._queryParameters,\n    true\n  );\n};\n\n/**\n * Combines the specified object and the existing template values. This allows you to add many values at once,\n *  as opposed to adding them one at a time to the templateValues property. If a value is already set, it will become an array and the new value will be appended.\n *\n * @param {Object} template The template values\n * @param {Boolean} [useAsDefault=false] If true the values will be used as the default values, so they will only be set if they are undefined.\n */\nResource.prototype.setTemplateValues = function (template, useAsDefault) {\n  if (useAsDefault) {\n    this._templateValues = (0,_combine_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(this._templateValues, template);\n  } else {\n    this._templateValues = (0,_combine_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(template, this._templateValues);\n  }\n};\n\n/**\n * Returns a resource relative to the current instance. All properties remain the same as the current instance unless overridden in options.\n *\n * @param {Object} options An object with the following properties\n * @param {String} [options.url]  The url that will be resolved relative to the url of the current instance.\n * @param {Object} [options.queryParameters] An object containing query parameters that will be combined with those of the current instance.\n * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}). These will be combined with those of the current instance.\n * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\n * @param {Proxy} [options.proxy] A proxy to be used when loading the resource.\n * @param {Resource.RetryCallback} [options.retryCallback] The function to call when loading the resource fails.\n * @param {Number} [options.retryAttempts] The number of times the retryCallback should be called before giving up.\n * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\n * @param {Boolean} [options.preserveQueryParameters=false] If true, this will keep all query parameters from the current resource and derived resource. If false, derived parameters will replace those of the current resource.\n *\n * @returns {Resource} The resource derived from the current one.\n */\nResource.prototype.getDerivedResource = function (options) {\n  var resource = this.clone();\n  resource._retryCount = 0;\n\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(options.url)) {\n    var uri = new _ThirdParty_Uri_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(options.url);\n\n    var preserveQueryParameters = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(\n      options.preserveQueryParameters,\n      false\n    );\n    parseQuery(uri, resource, true, preserveQueryParameters);\n\n    // Remove the fragment as it\'s not sent with a request\n    uri.fragment("");\n\n    if (uri.scheme() !== "") {\n      resource._url = uri.toString();\n    } else {\n      resource._url = uri\n        .absoluteTo(new _ThirdParty_Uri_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z((0,_getAbsoluteUri_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(this._url)))\n        .toString();\n    }\n  }\n\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(options.queryParameters)) {\n    resource._queryParameters = (0,_combine_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(\n      options.queryParameters,\n      resource._queryParameters\n    );\n  }\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(options.templateValues)) {\n    resource._templateValues = (0,_combine_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(\n      options.templateValues,\n      resource.templateValues\n    );\n  }\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(options.headers)) {\n    resource.headers = (0,_combine_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.headers, resource.headers);\n  }\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(options.proxy)) {\n    resource.proxy = options.proxy;\n  }\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(options.request)) {\n    resource.request = options.request;\n  }\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(options.retryCallback)) {\n    resource.retryCallback = options.retryCallback;\n  }\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(options.retryAttempts)) {\n    resource.retryAttempts = options.retryAttempts;\n  }\n\n  return resource;\n};\n\n/**\n * Called when a resource fails to load. This will call the retryCallback function if defined until retryAttempts is reached.\n *\n * @param {Error} [error] The error that was encountered.\n *\n * @returns {Promise<Boolean>} A promise to a boolean, that if true will cause the resource request to be retried.\n *\n * @private\n */\nResource.prototype.retryOnError = function (error) {\n  var retryCallback = this.retryCallback;\n  if (\n    typeof retryCallback !== "function" ||\n    this._retryCount >= this.retryAttempts\n  ) {\n    return (0,_ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(false);\n  }\n\n  var that = this;\n  return (0,_ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(retryCallback(this, error)).then(function (result) {\n    ++that._retryCount;\n\n    return result;\n  });\n};\n\n/**\n * Duplicates a Resource instance.\n *\n * @param {Resource} [result] The object onto which to store the result.\n *\n * @returns {Resource} The modified result parameter or a new Resource instance if one was not provided.\n */\nResource.prototype.clone = function (result) {\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(result)) {\n    result = new Resource({\n      url: this._url,\n    });\n  }\n\n  result._url = this._url;\n  result._queryParameters = (0,_clone_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(this._queryParameters);\n  result._templateValues = (0,_clone_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(this._templateValues);\n  result.headers = (0,_clone_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(this.headers);\n  result.proxy = this.proxy;\n  result.retryCallback = this.retryCallback;\n  result.retryAttempts = this.retryAttempts;\n  result._retryCount = 0;\n  result.request = this.request.clone();\n\n  return result;\n};\n\n/**\n * Returns the base path of the Resource.\n *\n * @param {Boolean} [includeQuery = false] Whether or not to include the query string and fragment form the uri\n *\n * @returns {String} The base URI of the resource\n */\nResource.prototype.getBaseUri = function (includeQuery) {\n  return (0,_getBaseUri_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(this.getUrlComponent(includeQuery), includeQuery);\n};\n\n/**\n * Appends a forward slash to the URL.\n */\nResource.prototype.appendForwardSlash = function () {\n  this._url = (0,_appendForwardSlash_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z)(this._url);\n};\n\n/**\n * Asynchronously loads the resource as raw binary data.  Returns a promise that will resolve to\n * an ArrayBuffer once loaded, or reject if the resource failed to load.  The data is loaded\n * using XMLHttpRequest, which means that in order to make requests to another origin,\n * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\n *\n * @returns {Promise.<ArrayBuffer>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n *\n * @example\n * // load a single URL asynchronously\n * resource.fetchArrayBuffer().then(function(arrayBuffer) {\n *     // use the data\n * }).otherwise(function(error) {\n *     // an error occurred\n * });\n *\n * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\n * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\n */\nResource.prototype.fetchArrayBuffer = function () {\n  return this.fetch({\n    responseType: "arraybuffer",\n  });\n};\n\n/**\n * Creates a Resource and calls fetchArrayBuffer() on it.\n *\n * @param {String|Object} options A url or an object with the following properties\n * @param {String} options.url The url of the resource.\n * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\n * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\n * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\n * @param {Proxy} [options.proxy] A proxy to be used when loading the resource.\n * @param {Resource.RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\n * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\n * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\n * @returns {Promise.<ArrayBuffer>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n */\nResource.fetchArrayBuffer = function (options) {\n  var resource = new Resource(options);\n  return resource.fetchArrayBuffer();\n};\n\n/**\n * Asynchronously loads the given resource as a blob.  Returns a promise that will resolve to\n * a Blob once loaded, or reject if the resource failed to load.  The data is loaded\n * using XMLHttpRequest, which means that in order to make requests to another origin,\n * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\n *\n * @returns {Promise.<Blob>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n *\n * @example\n * // load a single URL asynchronously\n * resource.fetchBlob().then(function(blob) {\n *     // use the data\n * }).otherwise(function(error) {\n *     // an error occurred\n * });\n *\n * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\n * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\n */\nResource.prototype.fetchBlob = function () {\n  return this.fetch({\n    responseType: "blob",\n  });\n};\n\n/**\n * Creates a Resource and calls fetchBlob() on it.\n *\n * @param {String|Object} options A url or an object with the following properties\n * @param {String} options.url The url of the resource.\n * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\n * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\n * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\n * @param {Proxy} [options.proxy] A proxy to be used when loading the resource.\n * @param {Resource.RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\n * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\n * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\n * @returns {Promise.<Blob>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n */\nResource.fetchBlob = function (options) {\n  var resource = new Resource(options);\n  return resource.fetchBlob();\n};\n\n/**\n * Asynchronously loads the given image resource.  Returns a promise that will resolve to\n * an {@link https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap|ImageBitmap} if <code>preferImageBitmap</code> is true and the browser supports <code>createImageBitmap</code> or otherwise an\n * {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement|Image} once loaded, or reject if the image failed to load.\n *\n * @param {Object} [options] An object with the following properties.\n * @param {Boolean} [options.preferBlob=false] If true, we will load the image via a blob.\n * @param {Boolean} [options.preferImageBitmap=false] If true, image will be decoded during fetch and an <code>ImageBitmap</code> is returned.\n * @param {Boolean} [options.flipY=false] If true, image will be vertically flipped during decode. Only applies if the browser supports <code>createImageBitmap</code>.\n * @param {Boolean} [options.skipColorSpaceConversion=false] If true, any custom gamma or color profiles in the image will be ignored. Only applies if the browser supports <code>createImageBitmap</code>.\n * @returns {Promise.<ImageBitmap>|Promise.<HTMLImageElement>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n *\n *\n * @example\n * // load a single image asynchronously\n * resource.fetchImage().then(function(image) {\n *     // use the loaded image\n * }).otherwise(function(error) {\n *     // an error occurred\n * });\n *\n * // load several images in parallel\n * when.all([resource1.fetchImage(), resource2.fetchImage()]).then(function(images) {\n *     // images is an array containing all the loaded images\n * });\n *\n * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\n * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\n */\nResource.prototype.fetchImage = function (options) {\n  options = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options, _defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n  var preferImageBitmap = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options.preferImageBitmap, false);\n  var preferBlob = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options.preferBlob, false);\n  var flipY = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options.flipY, false);\n  var skipColorSpaceConversion = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(\n    options.skipColorSpaceConversion,\n    false\n  );\n\n  checkAndResetRequest(this.request);\n  // We try to load the image normally if\n  // 1. Blobs aren\'t supported\n  // 2. It\'s a data URI\n  // 3. It\'s a blob URI\n  // 4. It doesn\'t have request headers and we preferBlob is false\n  if (\n    !xhrBlobSupported ||\n    this.isDataUri ||\n    this.isBlobUri ||\n    (!this.hasHeaders && !preferBlob)\n  ) {\n    return fetchImage({\n      resource: this,\n      flipY: flipY,\n      skipColorSpaceConversion: skipColorSpaceConversion,\n      preferImageBitmap: preferImageBitmap,\n    });\n  }\n\n  var blobPromise = this.fetchBlob();\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(blobPromise)) {\n    return;\n  }\n\n  var supportsImageBitmap;\n  var useImageBitmap;\n  var generatedBlobResource;\n  var generatedBlob;\n  return Resource.supportsImageBitmapOptions()\n    .then(function (result) {\n      supportsImageBitmap = result;\n      useImageBitmap = supportsImageBitmap && preferImageBitmap;\n      return blobPromise;\n    })\n    .then(function (blob) {\n      if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(blob)) {\n        return;\n      }\n      generatedBlob = blob;\n      if (useImageBitmap) {\n        return Resource.createImageBitmapFromBlob(blob, {\n          flipY: flipY,\n          premultiplyAlpha: false,\n          skipColorSpaceConversion: skipColorSpaceConversion,\n        });\n      }\n      var blobUrl = window.URL.createObjectURL(blob);\n      generatedBlobResource = new Resource({\n        url: blobUrl,\n      });\n\n      return fetchImage({\n        resource: generatedBlobResource,\n        flipY: flipY,\n        skipColorSpaceConversion: skipColorSpaceConversion,\n        preferImageBitmap: false,\n      });\n    })\n    .then(function (image) {\n      if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(image)) {\n        return;\n      }\n\n      // The blob object may be needed for use by a TileDiscardPolicy,\n      // so attach it to the image.\n      image.blob = generatedBlob;\n\n      if (useImageBitmap) {\n        return image;\n      }\n\n      window.URL.revokeObjectURL(generatedBlobResource.url);\n      return image;\n    })\n    .otherwise(function (error) {\n      if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(generatedBlobResource)) {\n        window.URL.revokeObjectURL(generatedBlobResource.url);\n      }\n\n      // If the blob load succeeded but the image decode failed, attach the blob\n      // to the error object for use by a TileDiscardPolicy.\n      // In particular, BingMapsImageryProvider uses this to detect the\n      // zero-length response that is returned when a tile is not available.\n      error.blob = generatedBlob;\n\n      return _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].reject */ .Z.reject(error);\n    });\n};\n\n/**\n * Fetches an image and returns a promise to it.\n *\n * @param {Object} [options] An object with the following properties.\n * @param {Resource} [options.resource] Resource object that points to an image to fetch.\n * @param {Boolean} [options.preferImageBitmap] If true, image will be decoded during fetch and an <code>ImageBitmap</code> is returned.\n * @param {Boolean} [options.flipY] If true, image will be vertically flipped during decode. Only applies if the browser supports <code>createImageBitmap</code>.\n * @param {Boolean} [options.skipColorSpaceConversion=false] If true, any custom gamma or color profiles in the image will be ignored. Only applies if the browser supports <code>createImageBitmap</code>.\n * @private\n */\nfunction fetchImage(options) {\n  var resource = options.resource;\n  var flipY = options.flipY;\n  var skipColorSpaceConversion = options.skipColorSpaceConversion;\n  var preferImageBitmap = options.preferImageBitmap;\n\n  var request = resource.request;\n  request.url = resource.url;\n  request.requestFunction = function () {\n    var crossOrigin = false;\n\n    // data URIs can\'t have crossorigin set.\n    if (!resource.isDataUri && !resource.isBlobUri) {\n      crossOrigin = resource.isCrossOriginUrl;\n    }\n\n    var deferred = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].defer */ .Z.defer();\n    Resource._Implementations.createImage(\n      request,\n      crossOrigin,\n      deferred,\n      flipY,\n      skipColorSpaceConversion,\n      preferImageBitmap\n    );\n\n    return deferred.promise;\n  };\n\n  var promise = _RequestScheduler_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].request */ .Z.request(request);\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(promise)) {\n    return;\n  }\n\n  return promise.otherwise(function (e) {\n    // Don\'t retry cancelled or otherwise aborted requests\n    if (request.state !== _RequestState_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].FAILED */ .Z.FAILED) {\n      return _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].reject */ .Z.reject(e);\n    }\n    return resource.retryOnError(e).then(function (retry) {\n      if (retry) {\n        // Reset request so it can try again\n        request.state = _RequestState_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].UNISSUED */ .Z.UNISSUED;\n        request.deferred = undefined;\n\n        return fetchImage({\n          resource: resource,\n          flipY: flipY,\n          skipColorSpaceConversion: skipColorSpaceConversion,\n          preferImageBitmap: preferImageBitmap,\n        });\n      }\n      return _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].reject */ .Z.reject(e);\n    });\n  });\n}\n\n/**\n * Creates a Resource and calls fetchImage() on it.\n *\n * @param {String|Object} options A url or an object with the following properties\n * @param {String} options.url The url of the resource.\n * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\n * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\n * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\n * @param {Proxy} [options.proxy] A proxy to be used when loading the resource.\n * @param {Boolean} [options.flipY=false] Whether to vertically flip the image during fetch and decode. Only applies when requesting an image and the browser supports <code>createImageBitmap</code>.\n * @param {Resource.RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\n * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\n * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\n * @param {Boolean} [options.preferBlob=false]  If true, we will load the image via a blob.\n * @param {Boolean} [options.preferImageBitmap=false] If true, image will be decoded during fetch and an <code>ImageBitmap</code> is returned.\n * @param {Boolean} [options.skipColorSpaceConversion=false] If true, any custom gamma or color profiles in the image will be ignored. Only applies when requesting an image and the browser supports <code>createImageBitmap</code>.\n * @returns {Promise.<ImageBitmap>|Promise.<HTMLImageElement>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n */\nResource.fetchImage = function (options) {\n  var resource = new Resource(options);\n  return resource.fetchImage({\n    flipY: options.flipY,\n    skipColorSpaceConversion: options.skipColorSpaceConversion,\n    preferBlob: options.preferBlob,\n    preferImageBitmap: options.preferImageBitmap,\n  });\n};\n\n/**\n * Asynchronously loads the given resource as text.  Returns a promise that will resolve to\n * a String once loaded, or reject if the resource failed to load.  The data is loaded\n * using XMLHttpRequest, which means that in order to make requests to another origin,\n * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\n *\n * @returns {Promise.<String>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n *\n * @example\n * // load text from a URL, setting a custom header\n * var resource = new Resource({\n *   url: \'http://someUrl.com/someJson.txt\',\n *   headers: {\n *     \'X-Custom-Header\' : \'some value\'\n *   }\n * });\n * resource.fetchText().then(function(text) {\n *     // Do something with the text\n * }).otherwise(function(error) {\n *     // an error occurred\n * });\n *\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest|XMLHttpRequest}\n * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\n * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\n */\nResource.prototype.fetchText = function () {\n  return this.fetch({\n    responseType: "text",\n  });\n};\n\n/**\n * Creates a Resource and calls fetchText() on it.\n *\n * @param {String|Object} options A url or an object with the following properties\n * @param {String} options.url The url of the resource.\n * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\n * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\n * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\n * @param {Proxy} [options.proxy] A proxy to be used when loading the resource.\n * @param {Resource.RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\n * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\n * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\n * @returns {Promise.<String>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n */\nResource.fetchText = function (options) {\n  var resource = new Resource(options);\n  return resource.fetchText();\n};\n\n// note: &#42;&#47;&#42; below is */* but that ends the comment block early\n/**\n * Asynchronously loads the given resource as JSON.  Returns a promise that will resolve to\n * a JSON object once loaded, or reject if the resource failed to load.  The data is loaded\n * using XMLHttpRequest, which means that in order to make requests to another origin,\n * the server must have Cross-Origin Resource Sharing (CORS) headers enabled. This function\n * adds \'Accept: application/json,&#42;&#47;&#42;;q=0.01\' to the request headers, if not\n * already specified.\n *\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n *\n *\n * @example\n * resource.fetchJson().then(function(jsonData) {\n *     // Do something with the JSON object\n * }).otherwise(function(error) {\n *     // an error occurred\n * });\n *\n * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\n * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\n */\nResource.prototype.fetchJson = function () {\n  var promise = this.fetch({\n    responseType: "text",\n    headers: {\n      Accept: "application/json,*/*;q=0.01",\n    },\n  });\n\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(promise)) {\n    return undefined;\n  }\n\n  return promise.then(function (value) {\n    if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(value)) {\n      return;\n    }\n    return JSON.parse(value);\n  });\n};\n\n/**\n * Creates a Resource and calls fetchJson() on it.\n *\n * @param {String|Object} options A url or an object with the following properties\n * @param {String} options.url The url of the resource.\n * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\n * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\n * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\n * @param {Proxy} [options.proxy] A proxy to be used when loading the resource.\n * @param {Resource.RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\n * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\n * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n */\nResource.fetchJson = function (options) {\n  var resource = new Resource(options);\n  return resource.fetchJson();\n};\n\n/**\n * Asynchronously loads the given resource as XML.  Returns a promise that will resolve to\n * an XML Document once loaded, or reject if the resource failed to load.  The data is loaded\n * using XMLHttpRequest, which means that in order to make requests to another origin,\n * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\n *\n * @returns {Promise.<XMLDocument>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n *\n *\n * @example\n * // load XML from a URL, setting a custom header\n * Cesium.loadXML(\'http://someUrl.com/someXML.xml\', {\n *   \'X-Custom-Header\' : \'some value\'\n * }).then(function(document) {\n *     // Do something with the document\n * }).otherwise(function(error) {\n *     // an error occurred\n * });\n *\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest|XMLHttpRequest}\n * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\n * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\n */\nResource.prototype.fetchXML = function () {\n  return this.fetch({\n    responseType: "document",\n    overrideMimeType: "text/xml",\n  });\n};\n\n/**\n * Creates a Resource and calls fetchXML() on it.\n *\n * @param {String|Object} options A url or an object with the following properties\n * @param {String} options.url The url of the resource.\n * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\n * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\n * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\n * @param {Proxy} [options.proxy] A proxy to be used when loading the resource.\n * @param {Resource.RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\n * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\n * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\n * @returns {Promise.<XMLDocument>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n */\nResource.fetchXML = function (options) {\n  var resource = new Resource(options);\n  return resource.fetchXML();\n};\n\n/**\n * Requests a resource using JSONP.\n *\n * @param {String} [callbackParameterName=\'callback\'] The callback parameter name that the server expects.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n *\n *\n * @example\n * // load a data asynchronously\n * resource.fetchJsonp().then(function(data) {\n *     // use the loaded data\n * }).otherwise(function(error) {\n *     // an error occurred\n * });\n *\n * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\n */\nResource.prototype.fetchJsonp = function (callbackParameterName) {\n  callbackParameterName = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(callbackParameterName, "callback");\n\n  checkAndResetRequest(this.request);\n\n  //generate a unique function name\n  var functionName;\n  do {\n    functionName =\n      "loadJsonp" + _Math_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].nextRandomNumber */ .Z.nextRandomNumber().toString().substring(2, 8);\n  } while ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(window[functionName]));\n\n  return fetchJsonp(this, callbackParameterName, functionName);\n};\n\nfunction fetchJsonp(resource, callbackParameterName, functionName) {\n  var callbackQuery = {};\n  callbackQuery[callbackParameterName] = functionName;\n  resource.setQueryParameters(callbackQuery);\n\n  var request = resource.request;\n  request.url = resource.url;\n  request.requestFunction = function () {\n    var deferred = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].defer */ .Z.defer();\n\n    //assign a function with that name in the global scope\n    window[functionName] = function (data) {\n      deferred.resolve(data);\n\n      try {\n        delete window[functionName];\n      } catch (e) {\n        window[functionName] = undefined;\n      }\n    };\n\n    Resource._Implementations.loadAndExecuteScript(\n      resource.url,\n      functionName,\n      deferred\n    );\n    return deferred.promise;\n  };\n\n  var promise = _RequestScheduler_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].request */ .Z.request(request);\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(promise)) {\n    return;\n  }\n\n  return promise.otherwise(function (e) {\n    if (request.state !== _RequestState_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].FAILED */ .Z.FAILED) {\n      return _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].reject */ .Z.reject(e);\n    }\n\n    return resource.retryOnError(e).then(function (retry) {\n      if (retry) {\n        // Reset request so it can try again\n        request.state = _RequestState_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].UNISSUED */ .Z.UNISSUED;\n        request.deferred = undefined;\n\n        return fetchJsonp(resource, callbackParameterName, functionName);\n      }\n\n      return _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].reject */ .Z.reject(e);\n    });\n  });\n}\n\n/**\n * Creates a Resource from a URL and calls fetchJsonp() on it.\n *\n * @param {String|Object} options A url or an object with the following properties\n * @param {String} options.url The url of the resource.\n * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\n * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\n * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\n * @param {Proxy} [options.proxy] A proxy to be used when loading the resource.\n * @param {Resource.RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\n * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\n * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\n * @param {String} [options.callbackParameterName=\'callback\'] The callback parameter name that the server expects.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n */\nResource.fetchJsonp = function (options) {\n  var resource = new Resource(options);\n  return resource.fetchJsonp(options.callbackParameterName);\n};\n\n/**\n * @private\n */\nResource.prototype._makeRequest = function (options) {\n  var resource = this;\n  checkAndResetRequest(resource.request);\n\n  var request = resource.request;\n  request.url = resource.url;\n\n  request.requestFunction = function () {\n    var responseType = options.responseType;\n    var headers = (0,_combine_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.headers, resource.headers);\n    var overrideMimeType = options.overrideMimeType;\n    var method = options.method;\n    var data = options.data;\n    var deferred = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].defer */ .Z.defer();\n    var xhr = Resource._Implementations.loadWithXhr(\n      resource.url,\n      responseType,\n      method,\n      data,\n      headers,\n      deferred,\n      overrideMimeType\n    );\n    if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(xhr) && (0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(xhr.abort)) {\n      request.cancelFunction = function () {\n        xhr.abort();\n      };\n    }\n    return deferred.promise;\n  };\n\n  var promise = _RequestScheduler_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].request */ .Z.request(request);\n  if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(promise)) {\n    return;\n  }\n\n  return promise\n    .then(function (data) {\n      // explicitly set to undefined to ensure GC of request response data. See #8843\n      request.cancelFunction = undefined;\n      return data;\n    })\n    .otherwise(function (e) {\n      request.cancelFunction = undefined;\n      if (request.state !== _RequestState_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].FAILED */ .Z.FAILED) {\n        return _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].reject */ .Z.reject(e);\n      }\n\n      return resource.retryOnError(e).then(function (retry) {\n        if (retry) {\n          // Reset request so it can try again\n          request.state = _RequestState_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].UNISSUED */ .Z.UNISSUED;\n          request.deferred = undefined;\n\n          return resource.fetch(options);\n        }\n\n        return _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].reject */ .Z.reject(e);\n      });\n    });\n};\n\nvar dataUriRegex = /^data:(.*?)(;base64)?,(.*)$/;\n\nfunction decodeDataUriText(isBase64, data) {\n  var result = decodeURIComponent(data);\n  if (isBase64) {\n    return atob(result);\n  }\n  return result;\n}\n\nfunction decodeDataUriArrayBuffer(isBase64, data) {\n  var byteString = decodeDataUriText(isBase64, data);\n  var buffer = new ArrayBuffer(byteString.length);\n  var view = new Uint8Array(buffer);\n  for (var i = 0; i < byteString.length; i++) {\n    view[i] = byteString.charCodeAt(i);\n  }\n  return buffer;\n}\n\nfunction decodeDataUri(dataUriRegexResult, responseType) {\n  responseType = (0,_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(responseType, "");\n  var mimeType = dataUriRegexResult[1];\n  var isBase64 = !!dataUriRegexResult[2];\n  var data = dataUriRegexResult[3];\n\n  switch (responseType) {\n    case "":\n    case "text":\n      return decodeDataUriText(isBase64, data);\n    case "arraybuffer":\n      return decodeDataUriArrayBuffer(isBase64, data);\n    case "blob":\n      var buffer = decodeDataUriArrayBuffer(isBase64, data);\n      return new Blob([buffer], {\n        type: mimeType,\n      });\n    case "document":\n      var parser = new DOMParser();\n      return parser.parseFromString(\n        decodeDataUriText(isBase64, data),\n        mimeType\n      );\n    case "json":\n      return JSON.parse(decodeDataUriText(isBase64, data));\n    default:\n      //>>includeStart(\'debug\', pragmas.debug);\n      throw new _DeveloperError_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z("Unhandled responseType: " + responseType);\n    //>>includeEnd(\'debug\');\n  }\n}\n\n/**\n * Asynchronously loads the given resource.  Returns a promise that will resolve to\n * the result once loaded, or reject if the resource failed to load.  The data is loaded\n * using XMLHttpRequest, which means that in order to make requests to another origin,\n * the server must have Cross-Origin Resource Sharing (CORS) headers enabled. It\'s recommended that you use\n * the more specific functions eg. fetchJson, fetchBlob, etc.\n *\n * @param {Object} [options] Object with the following properties:\n * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\n * @param {Object} [options.headers] Additional HTTP headers to send with the request, if any.\n * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n *\n *\n * @example\n * resource.fetch()\n *   .then(function(body) {\n *       // use the data\n *   }).otherwise(function(error) {\n *       // an error occurred\n *   });\n *\n * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\n * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\n */\nResource.prototype.fetch = function (options) {\n  options = defaultClone(options, {});\n  options.method = "GET";\n\n  return this._makeRequest(options);\n};\n\n/**\n * Creates a Resource from a URL and calls fetch() on it.\n *\n * @param {String|Object} options A url or an object with the following properties\n * @param {String} options.url The url of the resource.\n * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\n * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\n * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\n * @param {Proxy} [options.proxy] A proxy to be used when loading the resource.\n * @param {Resource.RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\n * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\n * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\n * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\n * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n */\nResource.fetch = function (options) {\n  var resource = new Resource(options);\n  return resource.fetch({\n    // Make copy of just the needed fields because headers can be passed to both the constructor and to fetch\n    responseType: options.responseType,\n    overrideMimeType: options.overrideMimeType,\n  });\n};\n\n/**\n * Asynchronously deletes the given resource.  Returns a promise that will resolve to\n * the result once loaded, or reject if the resource failed to load.  The data is loaded\n * using XMLHttpRequest, which means that in order to make requests to another origin,\n * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\n *\n * @param {Object} [options] Object with the following properties:\n * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\n * @param {Object} [options.headers] Additional HTTP headers to send with the request, if any.\n * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n *\n *\n * @example\n * resource.delete()\n *   .then(function(body) {\n *       // use the data\n *   }).otherwise(function(error) {\n *       // an error occurred\n *   });\n *\n * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\n * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\n */\nResource.prototype.delete = function (options) {\n  options = defaultClone(options, {});\n  options.method = "DELETE";\n\n  return this._makeRequest(options);\n};\n\n/**\n * Creates a Resource from a URL and calls delete() on it.\n *\n * @param {String|Object} options A url or an object with the following properties\n * @param {String} options.url The url of the resource.\n * @param {Object} [options.data] Data that is posted with the resource.\n * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\n * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\n * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\n * @param {Proxy} [options.proxy] A proxy to be used when loading the resource.\n * @param {Resource.RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\n * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\n * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\n * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\n * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n */\nResource.delete = function (options) {\n  var resource = new Resource(options);\n  return resource.delete({\n    // Make copy of just the needed fields because headers can be passed to both the constructor and to fetch\n    responseType: options.responseType,\n    overrideMimeType: options.overrideMimeType,\n    data: options.data,\n  });\n};\n\n/**\n * Asynchronously gets headers the given resource.  Returns a promise that will resolve to\n * the result once loaded, or reject if the resource failed to load.  The data is loaded\n * using XMLHttpRequest, which means that in order to make requests to another origin,\n * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\n *\n * @param {Object} [options] Object with the following properties:\n * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\n * @param {Object} [options.headers] Additional HTTP headers to send with the request, if any.\n * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n *\n *\n * @example\n * resource.head()\n *   .then(function(headers) {\n *       // use the data\n *   }).otherwise(function(error) {\n *       // an error occurred\n *   });\n *\n * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\n * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\n */\nResource.prototype.head = function (options) {\n  options = defaultClone(options, {});\n  options.method = "HEAD";\n\n  return this._makeRequest(options);\n};\n\n/**\n * Creates a Resource from a URL and calls head() on it.\n *\n * @param {String|Object} options A url or an object with the following properties\n * @param {String} options.url The url of the resource.\n * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\n * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\n * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\n * @param {Proxy} [options.proxy] A proxy to be used when loading the resource.\n * @param {Resource.RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\n * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\n * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\n * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\n * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n */\nResource.head = function (options) {\n  var resource = new Resource(options);\n  return resource.head({\n    // Make copy of just the needed fields because headers can be passed to both the constructor and to fetch\n    responseType: options.responseType,\n    overrideMimeType: options.overrideMimeType,\n  });\n};\n\n/**\n * Asynchronously gets options the given resource.  Returns a promise that will resolve to\n * the result once loaded, or reject if the resource failed to load.  The data is loaded\n * using XMLHttpRequest, which means that in order to make requests to another origin,\n * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\n *\n * @param {Object} [options] Object with the following properties:\n * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\n * @param {Object} [options.headers] Additional HTTP headers to send with the request, if any.\n * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n *\n *\n * @example\n * resource.options()\n *   .then(function(headers) {\n *       // use the data\n *   }).otherwise(function(error) {\n *       // an error occurred\n *   });\n *\n * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\n * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\n */\nResource.prototype.options = function (options) {\n  options = defaultClone(options, {});\n  options.method = "OPTIONS";\n\n  return this._makeRequest(options);\n};\n\n/**\n * Creates a Resource from a URL and calls options() on it.\n *\n * @param {String|Object} options A url or an object with the following properties\n * @param {String} options.url The url of the resource.\n * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\n * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\n * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\n * @param {Proxy} [options.proxy] A proxy to be used when loading the resource.\n * @param {Resource.RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\n * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\n * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\n * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\n * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n */\nResource.options = function (options) {\n  var resource = new Resource(options);\n  return resource.options({\n    // Make copy of just the needed fields because headers can be passed to both the constructor and to fetch\n    responseType: options.responseType,\n    overrideMimeType: options.overrideMimeType,\n  });\n};\n\n/**\n * Asynchronously posts data to the given resource.  Returns a promise that will resolve to\n * the result once loaded, or reject if the resource failed to load.  The data is loaded\n * using XMLHttpRequest, which means that in order to make requests to another origin,\n * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\n *\n * @param {Object} data Data that is posted with the resource.\n * @param {Object} [options] Object with the following properties:\n * @param {Object} [options.data] Data that is posted with the resource.\n * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\n * @param {Object} [options.headers] Additional HTTP headers to send with the request, if any.\n * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n *\n *\n * @example\n * resource.post(data)\n *   .then(function(result) {\n *       // use the result\n *   }).otherwise(function(error) {\n *       // an error occurred\n *   });\n *\n * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\n * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\n */\nResource.prototype.post = function (data, options) {\n  _Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].defined */ .Z.defined("data", data);\n\n  options = defaultClone(options, {});\n  options.method = "POST";\n  options.data = data;\n\n  return this._makeRequest(options);\n};\n\n/**\n * Creates a Resource from a URL and calls post() on it.\n *\n * @param {Object} options A url or an object with the following properties\n * @param {String} options.url The url of the resource.\n * @param {Object} options.data Data that is posted with the resource.\n * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\n * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\n * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\n * @param {Proxy} [options.proxy] A proxy to be used when loading the resource.\n * @param {Resource.RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\n * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\n * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\n * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\n * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n */\nResource.post = function (options) {\n  var resource = new Resource(options);\n  return resource.post(options.data, {\n    // Make copy of just the needed fields because headers can be passed to both the constructor and to post\n    responseType: options.responseType,\n    overrideMimeType: options.overrideMimeType,\n  });\n};\n\n/**\n * Asynchronously puts data to the given resource.  Returns a promise that will resolve to\n * the result once loaded, or reject if the resource failed to load.  The data is loaded\n * using XMLHttpRequest, which means that in order to make requests to another origin,\n * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\n *\n * @param {Object} data Data that is posted with the resource.\n * @param {Object} [options] Object with the following properties:\n * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\n * @param {Object} [options.headers] Additional HTTP headers to send with the request, if any.\n * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n *\n *\n * @example\n * resource.put(data)\n *   .then(function(result) {\n *       // use the result\n *   }).otherwise(function(error) {\n *       // an error occurred\n *   });\n *\n * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\n * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\n */\nResource.prototype.put = function (data, options) {\n  _Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].defined */ .Z.defined("data", data);\n\n  options = defaultClone(options, {});\n  options.method = "PUT";\n  options.data = data;\n\n  return this._makeRequest(options);\n};\n\n/**\n * Creates a Resource from a URL and calls put() on it.\n *\n * @param {Object} options A url or an object with the following properties\n * @param {String} options.url The url of the resource.\n * @param {Object} options.data Data that is posted with the resource.\n * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\n * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\n * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\n * @param {Proxy} [options.proxy] A proxy to be used when loading the resource.\n * @param {Resource.RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\n * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\n * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\n * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\n * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n */\nResource.put = function (options) {\n  var resource = new Resource(options);\n  return resource.put(options.data, {\n    // Make copy of just the needed fields because headers can be passed to both the constructor and to post\n    responseType: options.responseType,\n    overrideMimeType: options.overrideMimeType,\n  });\n};\n\n/**\n * Asynchronously patches data to the given resource.  Returns a promise that will resolve to\n * the result once loaded, or reject if the resource failed to load.  The data is loaded\n * using XMLHttpRequest, which means that in order to make requests to another origin,\n * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\n *\n * @param {Object} data Data that is posted with the resource.\n * @param {Object} [options] Object with the following properties:\n * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\n * @param {Object} [options.headers] Additional HTTP headers to send with the request, if any.\n * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n *\n *\n * @example\n * resource.patch(data)\n *   .then(function(result) {\n *       // use the result\n *   }).otherwise(function(error) {\n *       // an error occurred\n *   });\n *\n * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\n * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\n */\nResource.prototype.patch = function (data, options) {\n  _Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].defined */ .Z.defined("data", data);\n\n  options = defaultClone(options, {});\n  options.method = "PATCH";\n  options.data = data;\n\n  return this._makeRequest(options);\n};\n\n/**\n * Creates a Resource from a URL and calls patch() on it.\n *\n * @param {Object} options A url or an object with the following properties\n * @param {String} options.url The url of the resource.\n * @param {Object} options.data Data that is posted with the resource.\n * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\n * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\n * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\n * @param {Proxy} [options.proxy] A proxy to be used when loading the resource.\n * @param {Resource.RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\n * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\n * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\n * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\n * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\n * @returns {Promise.<*>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\n */\nResource.patch = function (options) {\n  var resource = new Resource(options);\n  return resource.patch(options.data, {\n    // Make copy of just the needed fields because headers can be passed to both the constructor and to post\n    responseType: options.responseType,\n    overrideMimeType: options.overrideMimeType,\n  });\n};\n\n/**\n * Contains implementations of functions that can be replaced for testing\n *\n * @private\n */\nResource._Implementations = {};\n\nfunction loadImageElement(url, crossOrigin, deferred) {\n  var image = new Image();\n\n  image.onload = function () {\n    deferred.resolve(image);\n  };\n\n  image.onerror = function (e) {\n    deferred.reject(e);\n  };\n\n  if (crossOrigin) {\n    if (_TrustedServers_js__WEBPACK_IMPORTED_MODULE_21__/* ["default"].contains */ .Z.contains(url)) {\n      image.crossOrigin = "use-credentials";\n    } else {\n      image.crossOrigin = "";\n    }\n  }\n\n  image.src = url;\n}\n\nResource._Implementations.createImage = function (\n  request,\n  crossOrigin,\n  deferred,\n  flipY,\n  skipColorSpaceConversion,\n  preferImageBitmap\n) {\n  var url = request.url;\n  // Passing an Image to createImageBitmap will force it to run on the main thread\n  // since DOM elements don\'t exist on workers. We convert it to a blob so it\'s non-blocking.\n  // See:\n  //    https://bugzilla.mozilla.org/show_bug.cgi?id=1044102#c38\n  //    https://bugs.chromium.org/p/chromium/issues/detail?id=580202#c10\n  Resource.supportsImageBitmapOptions()\n    .then(function (supportsImageBitmap) {\n      // We can only use ImageBitmap if we can flip on decode.\n      // See: https://github.com/CesiumGS/cesium/pull/7579#issuecomment-466146898\n      if (!(supportsImageBitmap && preferImageBitmap)) {\n        loadImageElement(url, crossOrigin, deferred);\n        return;\n      }\n      var responseType = "blob";\n      var method = "GET";\n      var xhrDeferred = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].defer */ .Z.defer();\n      var xhr = Resource._Implementations.loadWithXhr(\n        url,\n        responseType,\n        method,\n        undefined,\n        undefined,\n        xhrDeferred,\n        undefined,\n        undefined,\n        undefined\n      );\n\n      if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(xhr) && (0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(xhr.abort)) {\n        request.cancelFunction = function () {\n          xhr.abort();\n        };\n      }\n      return xhrDeferred.promise\n        .then(function (blob) {\n          if (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(blob)) {\n            deferred.reject(\n              new _RuntimeError_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"] */ .Z(\n                "Successfully retrieved " +\n                  url +\n                  " but it contained no content."\n              )\n            );\n            return;\n          }\n\n          return Resource.createImageBitmapFromBlob(blob, {\n            flipY: flipY,\n            premultiplyAlpha: false,\n            skipColorSpaceConversion: skipColorSpaceConversion,\n          });\n        })\n        .then(deferred.resolve);\n    })\n    .otherwise(deferred.reject);\n};\n\n/**\n * Wrapper for createImageBitmap\n *\n * @private\n */\nResource.createImageBitmapFromBlob = function (blob, options) {\n  _Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].defined */ .Z.defined("options", options);\n  _Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.bool */ .Z.typeOf.bool("options.flipY", options.flipY);\n  _Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.bool */ .Z.typeOf.bool("options.premultiplyAlpha", options.premultiplyAlpha);\n  _Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.bool */ .Z.typeOf.bool(\n    "options.skipColorSpaceConversion",\n    options.skipColorSpaceConversion\n  );\n\n  return createImageBitmap(blob, {\n    imageOrientation: options.flipY ? "flipY" : "none",\n    premultiplyAlpha: options.premultiplyAlpha ? "premultiply" : "none",\n    colorSpaceConversion: options.skipColorSpaceConversion ? "none" : "default",\n  });\n};\n\nfunction decodeResponse(loadWithHttpResponse, responseType) {\n  switch (responseType) {\n    case "text":\n      return loadWithHttpResponse.toString("utf8");\n    case "json":\n      return JSON.parse(loadWithHttpResponse.toString("utf8"));\n    default:\n      return new Uint8Array(loadWithHttpResponse).buffer;\n  }\n}\n\nfunction loadWithHttpRequest(\n  url,\n  responseType,\n  method,\n  data,\n  headers,\n  deferred,\n  overrideMimeType\n) {\n  // Note: only the \'json\' and \'text\' responseTypes transforms the loaded buffer\n  /* eslint-disable no-undef */\n  var URL = require("url").parse(url);\n  var http = URL.protocol === "https:" ? require("https") : require("http");\n  var zlib = require("zlib");\n  /* eslint-enable no-undef */\n\n  var options = {\n    protocol: URL.protocol,\n    hostname: URL.hostname,\n    port: URL.port,\n    path: URL.path,\n    query: URL.query,\n    method: method,\n    headers: headers,\n  };\n\n  http\n    .request(options)\n    .on("response", function (res) {\n      if (res.statusCode < 200 || res.statusCode >= 300) {\n        deferred.reject(\n          new _RequestErrorEvent_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"] */ .Z(res.statusCode, res, res.headers)\n        );\n        return;\n      }\n\n      var chunkArray = [];\n      res.on("data", function (chunk) {\n        chunkArray.push(chunk);\n      });\n\n      res.on("end", function () {\n        // eslint-disable-next-line no-undef\n        var result = Buffer.concat(chunkArray);\n        if (res.headers["content-encoding"] === "gzip") {\n          zlib.gunzip(result, function (error, resultUnzipped) {\n            if (error) {\n              deferred.reject(\n                new _RuntimeError_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"] */ .Z("Error decompressing response.")\n              );\n            } else {\n              deferred.resolve(decodeResponse(resultUnzipped, responseType));\n            }\n          });\n        } else {\n          deferred.resolve(decodeResponse(result, responseType));\n        }\n      });\n    })\n    .on("error", function (e) {\n      deferred.reject(new _RequestErrorEvent_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"] */ .Z());\n    })\n    .end();\n}\n\nvar noXMLHttpRequest = typeof XMLHttpRequest === "undefined";\nResource._Implementations.loadWithXhr = function (\n  url,\n  responseType,\n  method,\n  data,\n  headers,\n  deferred,\n  overrideMimeType\n) {\n  var dataUriRegexResult = dataUriRegex.exec(url);\n  if (dataUriRegexResult !== null) {\n    deferred.resolve(decodeDataUri(dataUriRegexResult, responseType));\n    return;\n  }\n\n  if (noXMLHttpRequest) {\n    loadWithHttpRequest(\n      url,\n      responseType,\n      method,\n      data,\n      headers,\n      deferred,\n      overrideMimeType\n    );\n    return;\n  }\n\n  var xhr = new XMLHttpRequest();\n\n  if (_TrustedServers_js__WEBPACK_IMPORTED_MODULE_21__/* ["default"].contains */ .Z.contains(url)) {\n    xhr.withCredentials = true;\n  }\n\n  xhr.open(method, url, true);\n\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(overrideMimeType) && (0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(xhr.overrideMimeType)) {\n    xhr.overrideMimeType(overrideMimeType);\n  }\n\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(headers)) {\n    for (var key in headers) {\n      if (headers.hasOwnProperty(key)) {\n        xhr.setRequestHeader(key, headers[key]);\n      }\n    }\n  }\n\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(responseType)) {\n    xhr.responseType = responseType;\n  }\n\n  // While non-standard, file protocol always returns a status of 0 on success\n  var localFile = false;\n  if (typeof url === "string") {\n    localFile =\n      url.indexOf("file://") === 0 ||\n      (typeof window !== "undefined" && window.location.origin === "file://");\n  }\n\n  xhr.onload = function () {\n    if (\n      (xhr.status < 200 || xhr.status >= 300) &&\n      !(localFile && xhr.status === 0)\n    ) {\n      deferred.reject(\n        new _RequestErrorEvent_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"] */ .Z(\n          xhr.status,\n          xhr.response,\n          xhr.getAllResponseHeaders()\n        )\n      );\n      return;\n    }\n\n    var response = xhr.response;\n    var browserResponseType = xhr.responseType;\n\n    if (method === "HEAD" || method === "OPTIONS") {\n      var responseHeaderString = xhr.getAllResponseHeaders();\n      var splitHeaders = responseHeaderString.trim().split(/[\\r\\n]+/);\n\n      var responseHeaders = {};\n      splitHeaders.forEach(function (line) {\n        var parts = line.split(": ");\n        var header = parts.shift();\n        responseHeaders[header] = parts.join(": ");\n      });\n\n      deferred.resolve(responseHeaders);\n      return;\n    }\n\n    //All modern browsers will go into either the first or second if block or last else block.\n    //Other code paths support older browsers that either do not support the supplied responseType\n    //or do not support the xhr.response property.\n    if (xhr.status === 204) {\n      // accept no content\n      deferred.resolve();\n    } else if (\n      (0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(response) &&\n      (!(0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(responseType) || browserResponseType === responseType)\n    ) {\n      deferred.resolve(response);\n    } else if (responseType === "json" && typeof response === "string") {\n      try {\n        deferred.resolve(JSON.parse(response));\n      } catch (e) {\n        deferred.reject(e);\n      }\n    } else if (\n      (browserResponseType === "" || browserResponseType === "document") &&\n      (0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(xhr.responseXML) &&\n      xhr.responseXML.hasChildNodes()\n    ) {\n      deferred.resolve(xhr.responseXML);\n    } else if (\n      (browserResponseType === "" || browserResponseType === "text") &&\n      (0,_defined_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z)(xhr.responseText)\n    ) {\n      deferred.resolve(xhr.responseText);\n    } else {\n      deferred.reject(\n        new _RuntimeError_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"] */ .Z("Invalid XMLHttpRequest response type.")\n      );\n    }\n  };\n\n  xhr.onerror = function (e) {\n    deferred.reject(new _RequestErrorEvent_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"] */ .Z());\n  };\n\n  xhr.send(data);\n\n  return xhr;\n};\n\nResource._Implementations.loadAndExecuteScript = function (\n  url,\n  functionName,\n  deferred\n) {\n  return (0,_loadAndExecuteScript_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(url, functionName).otherwise(deferred.reject);\n};\n\n/**\n * The default implementations\n *\n * @private\n */\nResource._DefaultImplementations = {};\nResource._DefaultImplementations.createImage =\n  Resource._Implementations.createImage;\nResource._DefaultImplementations.loadWithXhr =\n  Resource._Implementations.loadWithXhr;\nResource._DefaultImplementations.loadAndExecuteScript =\n  Resource._Implementations.loadAndExecuteScript;\n\n/**\n * A resource instance initialized to the current browser location\n *\n * @type {Resource}\n * @constant\n */\nResource.DEFAULT = Object.freeze(\n  new Resource({\n    url:\n      typeof document === "undefined"\n        ? ""\n        : document.location.href.split("?")[0],\n  })\n);\n\n/**\n * A function that returns the value of the property.\n * @callback Resource.RetryCallback\n *\n * @param {Resource} [resource] The resource that failed to load.\n * @param {Error} [error] The error that occurred during the loading of the resource.\n * @returns {Boolean|Promise<Boolean>} If true or a promise that resolved to true, the resource will be retried. Otherwise the failure will be returned.\n */\n/* harmony default export */ __webpack_exports__["Z"] = (Resource);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNLGlFQUFPO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsTUFBTSxpRUFBTztBQUNiO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxZQUFZLGtFQUFZO0FBQ3hCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHdCQUF3Qix1RUFBaUI7QUFDekM7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyw4RUFBb0I7QUFDN0I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxVQUFVO0FBQ3JCLFdBQVcsT0FBTztBQUNsQixhQUFhLDBCQUEwQjtBQUN2QztBQUNBLHlEQUFlLFFBQVEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9Db3JlL1Jlc291cmNlLmpzPzdlMzkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFVyaSBmcm9tIFwiLi4vVGhpcmRQYXJ0eS9VcmkuanNcIjtcbmltcG9ydCB3aGVuIGZyb20gXCIuLi9UaGlyZFBhcnR5L3doZW4uanNcIjtcbmltcG9ydCBhcHBlbmRGb3J3YXJkU2xhc2ggZnJvbSBcIi4vYXBwZW5kRm9yd2FyZFNsYXNoLmpzXCI7XG5pbXBvcnQgQ2hlY2sgZnJvbSBcIi4vQ2hlY2suanNcIjtcbmltcG9ydCBjbG9uZSBmcm9tIFwiLi9jbG9uZS5qc1wiO1xuaW1wb3J0IGNvbWJpbmUgZnJvbSBcIi4vY29tYmluZS5qc1wiO1xuaW1wb3J0IGRlZmF1bHRWYWx1ZSBmcm9tIFwiLi9kZWZhdWx0VmFsdWUuanNcIjtcbmltcG9ydCBkZWZpbmVkIGZyb20gXCIuL2RlZmluZWQuanNcIjtcbmltcG9ydCBEZXZlbG9wZXJFcnJvciBmcm9tIFwiLi9EZXZlbG9wZXJFcnJvci5qc1wiO1xuaW1wb3J0IGdldEFic29sdXRlVXJpIGZyb20gXCIuL2dldEFic29sdXRlVXJpLmpzXCI7XG5pbXBvcnQgZ2V0QmFzZVVyaSBmcm9tIFwiLi9nZXRCYXNlVXJpLmpzXCI7XG5pbXBvcnQgZ2V0RXh0ZW5zaW9uRnJvbVVyaSBmcm9tIFwiLi9nZXRFeHRlbnNpb25Gcm9tVXJpLmpzXCI7XG5pbXBvcnQgaXNCbG9iVXJpIGZyb20gXCIuL2lzQmxvYlVyaS5qc1wiO1xuaW1wb3J0IGlzQ3Jvc3NPcmlnaW5VcmwgZnJvbSBcIi4vaXNDcm9zc09yaWdpblVybC5qc1wiO1xuaW1wb3J0IGlzRGF0YVVyaSBmcm9tIFwiLi9pc0RhdGFVcmkuanNcIjtcbmltcG9ydCBsb2FkQW5kRXhlY3V0ZVNjcmlwdCBmcm9tIFwiLi9sb2FkQW5kRXhlY3V0ZVNjcmlwdC5qc1wiO1xuaW1wb3J0IENlc2l1bU1hdGggZnJvbSBcIi4vTWF0aC5qc1wiO1xuaW1wb3J0IG9iamVjdFRvUXVlcnkgZnJvbSBcIi4vb2JqZWN0VG9RdWVyeS5qc1wiO1xuaW1wb3J0IHF1ZXJ5VG9PYmplY3QgZnJvbSBcIi4vcXVlcnlUb09iamVjdC5qc1wiO1xuaW1wb3J0IFJlcXVlc3QgZnJvbSBcIi4vUmVxdWVzdC5qc1wiO1xuaW1wb3J0IFJlcXVlc3RFcnJvckV2ZW50IGZyb20gXCIuL1JlcXVlc3RFcnJvckV2ZW50LmpzXCI7XG5pbXBvcnQgUmVxdWVzdFNjaGVkdWxlciBmcm9tIFwiLi9SZXF1ZXN0U2NoZWR1bGVyLmpzXCI7XG5pbXBvcnQgUmVxdWVzdFN0YXRlIGZyb20gXCIuL1JlcXVlc3RTdGF0ZS5qc1wiO1xuaW1wb3J0IFJ1bnRpbWVFcnJvciBmcm9tIFwiLi9SdW50aW1lRXJyb3IuanNcIjtcbmltcG9ydCBUcnVzdGVkU2VydmVycyBmcm9tIFwiLi9UcnVzdGVkU2VydmVycy5qc1wiO1xuXG52YXIgeGhyQmxvYlN1cHBvcnRlZCA9IChmdW5jdGlvbiAoKSB7XG4gIHRyeSB7XG4gICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIHhoci5vcGVuKFwiR0VUXCIsIFwiI1wiLCB0cnVlKTtcbiAgICB4aHIucmVzcG9uc2VUeXBlID0gXCJibG9iXCI7XG4gICAgcmV0dXJuIHhoci5yZXNwb25zZVR5cGUgPT09IFwiYmxvYlwiO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59KSgpO1xuXG4vKipcbiAqIFBhcnNlcyBhIHF1ZXJ5IHN0cmluZyBhbmQgcmV0dXJucyB0aGUgb2JqZWN0IGVxdWl2YWxlbnQuXG4gKlxuICogQHBhcmFtIHtVcml9IHVyaSBUaGUgVXJpIHdpdGggYSBxdWVyeSBvYmplY3QuXG4gKiBAcGFyYW0ge1Jlc291cmNlfSByZXNvdXJjZSBUaGUgUmVzb3VyY2UgdGhhdCB3aWxsIGJlIGFzc2lnbmVkIHF1ZXJ5UGFyYW1ldGVycy5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gbWVyZ2UgSWYgdHJ1ZSwgd2UnbGwgbWVyZ2Ugd2l0aCB0aGUgcmVzb3VyY2UncyBleGlzdGluZyBxdWVyeVBhcmFtZXRlcnMuIE90aGVyd2lzZSB0aGV5IHdpbGwgYmUgcmVwbGFjZWQuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IHByZXNlcnZlUXVlcnlQYXJhbWV0ZXJzIElmIHRydWUgZHVwbGljYXRlIHBhcmFtZXRlcnMgd2lsbCBiZSBjb25jYXRlbmF0ZWQgaW50byBhbiBhcnJheS4gSWYgZmFsc2UsIGtleXMgaW4gdXJpIHdpbGwgdGFrZSBwcmVjZWRlbmNlLlxuICpcbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIHBhcnNlUXVlcnkodXJpLCByZXNvdXJjZSwgbWVyZ2UsIHByZXNlcnZlUXVlcnlQYXJhbWV0ZXJzKSB7XG4gIHZhciBxdWVyeVN0cmluZyA9IHVyaS5xdWVyeSgpO1xuICBpZiAocXVlcnlTdHJpbmcubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIHt9O1xuICB9XG5cbiAgdmFyIHF1ZXJ5O1xuICAvLyBTcGVjaWFsIGNhc2Ugd2UgcnVuIGludG8gd2hlcmUgdGhlIHF1ZXJ5c3RyaW5nIGlzIGp1c3QgYSBzdHJpbmcsIG5vdCBrZXkvdmFsdWUgcGFpcnNcbiAgaWYgKHF1ZXJ5U3RyaW5nLmluZGV4T2YoXCI9XCIpID09PSAtMSkge1xuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICByZXN1bHRbcXVlcnlTdHJpbmddID0gdW5kZWZpbmVkO1xuICAgIHF1ZXJ5ID0gcmVzdWx0O1xuICB9IGVsc2Uge1xuICAgIHF1ZXJ5ID0gcXVlcnlUb09iamVjdChxdWVyeVN0cmluZyk7XG4gIH1cblxuICBpZiAobWVyZ2UpIHtcbiAgICByZXNvdXJjZS5fcXVlcnlQYXJhbWV0ZXJzID0gY29tYmluZVF1ZXJ5UGFyYW1ldGVycyhcbiAgICAgIHF1ZXJ5LFxuICAgICAgcmVzb3VyY2UuX3F1ZXJ5UGFyYW1ldGVycyxcbiAgICAgIHByZXNlcnZlUXVlcnlQYXJhbWV0ZXJzXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICByZXNvdXJjZS5fcXVlcnlQYXJhbWV0ZXJzID0gcXVlcnk7XG4gIH1cbiAgdXJpLnNlYXJjaChcIlwiKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIHF1ZXJ5IG9iamVjdCBpbnRvIGEgc3RyaW5nLlxuICpcbiAqIEBwYXJhbSB7VXJpfSB1cmkgVGhlIFVyaSBvYmplY3QgdGhhdCB3aWxsIGhhdmUgdGhlIHF1ZXJ5IG9iamVjdCBzZXQuXG4gKiBAcGFyYW0ge1Jlc291cmNlfSByZXNvdXJjZSBUaGUgcmVzb3VyY2UgdGhhdCBoYXMgcXVlcnlQYXJhbWV0ZXJzXG4gKlxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gc3RyaW5naWZ5UXVlcnkodXJpLCByZXNvdXJjZSkge1xuICB2YXIgcXVlcnlPYmplY3QgPSByZXNvdXJjZS5fcXVlcnlQYXJhbWV0ZXJzO1xuXG4gIHZhciBrZXlzID0gT2JqZWN0LmtleXMocXVlcnlPYmplY3QpO1xuXG4gIC8vIFdlIGhhdmUgMSBrZXkgd2l0aCBhbiB1bmRlZmluZWQgdmFsdWUsIHNvIHRoaXMgaXMganVzdCBhIHN0cmluZywgbm90IGtleS92YWx1ZSBwYWlyc1xuICBpZiAoa2V5cy5sZW5ndGggPT09IDEgJiYgIWRlZmluZWQocXVlcnlPYmplY3Rba2V5c1swXV0pKSB7XG4gICAgdXJpLnNlYXJjaChrZXlzWzBdKTtcbiAgfSBlbHNlIHtcbiAgICB1cmkuc2VhcmNoKG9iamVjdFRvUXVlcnkocXVlcnlPYmplY3QpKTtcbiAgfVxufVxuXG4vKipcbiAqIENsb25lcyBhIHZhbHVlIGlmIGl0IGlzIGRlZmluZWQsIG90aGVyd2lzZSByZXR1cm5zIHRoZSBkZWZhdWx0IHZhbHVlXG4gKlxuICogQHBhcmFtIHsqfSBbdmFsXSBUaGUgdmFsdWUgdG8gY2xvbmUuXG4gKiBAcGFyYW0geyp9IFtkZWZhdWx0VmFsXSBUaGUgZGVmYXVsdCB2YWx1ZS5cbiAqXG4gKiBAcmV0dXJucyB7Kn0gQSBjbG9uZSBvZiB2YWwgb3IgdGhlIGRlZmF1bHRWYWwuXG4gKlxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gZGVmYXVsdENsb25lKHZhbCwgZGVmYXVsdFZhbCkge1xuICBpZiAoIWRlZmluZWQodmFsKSkge1xuICAgIHJldHVybiBkZWZhdWx0VmFsO1xuICB9XG5cbiAgcmV0dXJuIGRlZmluZWQodmFsLmNsb25lKSA/IHZhbC5jbG9uZSgpIDogY2xvbmUodmFsKTtcbn1cblxuLyoqXG4gKiBDaGVja3MgdG8gbWFrZSBzdXJlIHRoZSBSZXNvdXJjZSBpc24ndCBhbHJlYWR5IGJlaW5nIHJlcXVlc3RlZC5cbiAqXG4gKiBAcGFyYW0ge1JlcXVlc3R9IHJlcXVlc3QgVGhlIHJlcXVlc3QgdG8gY2hlY2suXG4gKlxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gY2hlY2tBbmRSZXNldFJlcXVlc3QocmVxdWVzdCkge1xuICBpZiAoXG4gICAgcmVxdWVzdC5zdGF0ZSA9PT0gUmVxdWVzdFN0YXRlLklTU1VFRCB8fFxuICAgIHJlcXVlc3Quc3RhdGUgPT09IFJlcXVlc3RTdGF0ZS5BQ1RJVkVcbiAgKSB7XG4gICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcihcIlRoZSBSZXNvdXJjZSBpcyBhbHJlYWR5IGJlaW5nIGZldGNoZWQuXCIpO1xuICB9XG5cbiAgcmVxdWVzdC5zdGF0ZSA9IFJlcXVlc3RTdGF0ZS5VTklTU1VFRDtcbiAgcmVxdWVzdC5kZWZlcnJlZCA9IHVuZGVmaW5lZDtcbn1cblxuLyoqXG4gKiBUaGlzIGNvbWJpbmVzIGEgbWFwIG9mIHF1ZXJ5IHBhcmFtZXRlcnMuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHExIFRoZSBmaXJzdCBtYXAgb2YgcXVlcnkgcGFyYW1ldGVycy4gVmFsdWVzIGluIHRoaXMgbWFwIHdpbGwgdGFrZSBwcmVjZWRlbmNlIGlmIHByZXNlcnZlUXVlcnlQYXJhbWV0ZXJzIGlzIGZhbHNlLlxuICogQHBhcmFtIHtPYmplY3R9IHEyIFRoZSBzZWNvbmQgbWFwIG9mIHF1ZXJ5IHBhcmFtZXRlcnMuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IHByZXNlcnZlUXVlcnlQYXJhbWV0ZXJzIElmIHRydWUgZHVwbGljYXRlIHBhcmFtZXRlcnMgd2lsbCBiZSBjb25jYXRlbmF0ZWQgaW50byBhbiBhcnJheS4gSWYgZmFsc2UsIGtleXMgaW4gcTEgd2lsbCB0YWtlIHByZWNlZGVuY2UuXG4gKlxuICogQHJldHVybnMge09iamVjdH0gVGhlIGNvbWJpbmVkIG1hcCBvZiBxdWVyeSBwYXJhbWV0ZXJzLlxuICpcbiAqIEBleGFtcGxlXG4gKiB2YXIgcTEgPSB7XG4gKiAgIGE6IDEsXG4gKiAgIGI6IDJcbiAqIH07XG4gKiB2YXIgcTIgPSB7XG4gKiAgIGE6IDMsXG4gKiAgIGM6IDRcbiAqIH07XG4gKiB2YXIgcTMgPSB7XG4gKiAgIGI6IFs1LCA2XSxcbiAqICAgZDogN1xuICogfVxuICpcbiAqIC8vIFJldHVybnNcbiAqIC8vIHtcbiAqIC8vICAgYTogWzEsIDNdLFxuICogLy8gICBiOiAyLFxuICogLy8gICBjOiA0XG4gKiAvLyB9O1xuICogY29tYmluZVF1ZXJ5UGFyYW1ldGVycyhxMSwgcTIsIHRydWUpO1xuICpcbiAqIC8vIFJldHVybnNcbiAqIC8vIHtcbiAqIC8vICAgYTogMSxcbiAqIC8vICAgYjogMixcbiAqIC8vICAgYzogNFxuICogLy8gfTtcbiAqIGNvbWJpbmVRdWVyeVBhcmFtZXRlcnMocTEsIHEyLCBmYWxzZSk7XG4gKlxuICogLy8gUmV0dXJuc1xuICogLy8ge1xuICogLy8gICBhOiAxLFxuICogLy8gICBiOiBbMiwgNSwgNl0sXG4gKiAvLyAgIGQ6IDdcbiAqIC8vIH07XG4gKiBjb21iaW5lUXVlcnlQYXJhbWV0ZXJzKHExLCBxMywgdHJ1ZSk7XG4gKlxuICogLy8gUmV0dXJuc1xuICogLy8ge1xuICogLy8gICBhOiAxLFxuICogLy8gICBiOiAyLFxuICogLy8gICBkOiA3XG4gKiAvLyB9O1xuICogY29tYmluZVF1ZXJ5UGFyYW1ldGVycyhxMSwgcTMsIGZhbHNlKTtcbiAqXG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBjb21iaW5lUXVlcnlQYXJhbWV0ZXJzKHExLCBxMiwgcHJlc2VydmVRdWVyeVBhcmFtZXRlcnMpIHtcbiAgaWYgKCFwcmVzZXJ2ZVF1ZXJ5UGFyYW1ldGVycykge1xuICAgIHJldHVybiBjb21iaW5lKHExLCBxMik7XG4gIH1cblxuICB2YXIgcmVzdWx0ID0gY2xvbmUocTEsIHRydWUpO1xuICBmb3IgKHZhciBwYXJhbSBpbiBxMikge1xuICAgIGlmIChxMi5oYXNPd25Qcm9wZXJ0eShwYXJhbSkpIHtcbiAgICAgIHZhciB2YWx1ZSA9IHJlc3VsdFtwYXJhbV07XG4gICAgICB2YXIgcTJWYWx1ZSA9IHEyW3BhcmFtXTtcbiAgICAgIGlmIChkZWZpbmVkKHZhbHVlKSkge1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgdmFsdWUgPSByZXN1bHRbcGFyYW1dID0gW3ZhbHVlXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlc3VsdFtwYXJhbV0gPSB2YWx1ZS5jb25jYXQocTJWYWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHRbcGFyYW1dID0gQXJyYXkuaXNBcnJheShxMlZhbHVlKSA/IHEyVmFsdWUuc2xpY2UoKSA6IHEyVmFsdWU7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBBIHJlc291cmNlIHRoYXQgaW5jbHVkZXMgdGhlIGxvY2F0aW9uIGFuZCBhbnkgb3RoZXIgcGFyYW1ldGVycyB3ZSBuZWVkIHRvIHJldHJpZXZlIGl0IG9yIGNyZWF0ZSBkZXJpdmVkIHJlc291cmNlcy4gSXQgYWxzbyBwcm92aWRlcyB0aGUgYWJpbGl0eSB0byByZXRyeSByZXF1ZXN0cy5cbiAqXG4gKiBAYWxpYXMgUmVzb3VyY2VcbiAqIEBjb25zdHJ1Y3RvclxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfE9iamVjdH0gb3B0aW9ucyBBIHVybCBvciBhbiBvYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXNcbiAqIEBwYXJhbSB7U3RyaW5nfSBvcHRpb25zLnVybCBUaGUgdXJsIG9mIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5xdWVyeVBhcmFtZXRlcnNdIEFuIG9iamVjdCBjb250YWluaW5nIHF1ZXJ5IHBhcmFtZXRlcnMgdGhhdCB3aWxsIGJlIHNlbnQgd2hlbiByZXRyaWV2aW5nIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy50ZW1wbGF0ZVZhbHVlc10gS2V5L1ZhbHVlIHBhaXJzIHRoYXQgYXJlIHVzZWQgdG8gcmVwbGFjZSB0ZW1wbGF0ZSB2YWx1ZXMgKGVnLiB7eH0pLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLmhlYWRlcnM9e31dIEFkZGl0aW9uYWwgSFRUUCBoZWFkZXJzIHRoYXQgd2lsbCBiZSBzZW50LlxuICogQHBhcmFtIHtQcm94eX0gW29wdGlvbnMucHJveHldIEEgcHJveHkgdG8gYmUgdXNlZCB3aGVuIGxvYWRpbmcgdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtSZXNvdXJjZS5SZXRyeUNhbGxiYWNrfSBbb3B0aW9ucy5yZXRyeUNhbGxiYWNrXSBUaGUgRnVuY3Rpb24gdG8gY2FsbCB3aGVuIGEgcmVxdWVzdCBmb3IgdGhpcyByZXNvdXJjZSBmYWlscy4gSWYgaXQgcmV0dXJucyB0cnVlLCB0aGUgcmVxdWVzdCB3aWxsIGJlIHJldHJpZWQuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMucmV0cnlBdHRlbXB0cz0wXSBUaGUgbnVtYmVyIG9mIHRpbWVzIHRoZSByZXRyeUNhbGxiYWNrIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGdpdmluZyB1cC5cbiAqIEBwYXJhbSB7UmVxdWVzdH0gW29wdGlvbnMucmVxdWVzdF0gQSBSZXF1ZXN0IG9iamVjdCB0aGF0IHdpbGwgYmUgdXNlZC4gSW50ZW5kZWQgZm9yIGludGVybmFsIHVzZSBvbmx5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBmdW5jdGlvbiByZWZyZXNoVG9rZW5SZXRyeUNhbGxiYWNrKHJlc291cmNlLCBlcnJvcikge1xuICogICBpZiAoZXJyb3Iuc3RhdHVzQ29kZSA9PT0gNDAzKSB7XG4gKiAgICAgLy8gNDAzIHN0YXR1cyBjb2RlIG1lYW5zIGEgbmV3IHRva2VuIHNob3VsZCBiZSBnZW5lcmF0ZWRcbiAqICAgICByZXR1cm4gZ2V0TmV3QWNjZXNzVG9rZW4oKVxuICogICAgICAgLnRoZW4oZnVuY3Rpb24odG9rZW4pIHtcbiAqICAgICAgICAgcmVzb3VyY2UucXVlcnlQYXJhbWV0ZXJzLmFjY2Vzc190b2tlbiA9IHRva2VuO1xuICogICAgICAgICByZXR1cm4gdHJ1ZTtcbiAqICAgICAgIH0pXG4gKiAgICAgICAub3RoZXJ3aXNlKGZ1bmN0aW9uKCkge1xuICogICAgICAgICByZXR1cm4gZmFsc2U7XG4gKiAgICAgICB9KTtcbiAqICAgfVxuICpcbiAqICAgcmV0dXJuIGZhbHNlO1xuICogfVxuICpcbiAqIHZhciByZXNvdXJjZSA9IG5ldyBSZXNvdXJjZSh7XG4gKiAgICB1cmw6ICdodHRwOi8vc2VydmVyLmNvbS9wYXRoL3RvL3Jlc291cmNlLmpzb24nLFxuICogICAgcHJveHk6IG5ldyBEZWZhdWx0UHJveHkoJy9wcm94eS8nKSxcbiAqICAgIGhlYWRlcnM6IHtcbiAqICAgICAgJ1gtTXktSGVhZGVyJzogJ3ZhbHVlT2ZIZWFkZXInXG4gKiAgICB9LFxuICogICAgcXVlcnlQYXJhbWV0ZXJzOiB7XG4gKiAgICAgICdhY2Nlc3NfdG9rZW4nOiAnMTIzLTQzNS00NTYtMDAwJ1xuICogICAgfSxcbiAqICAgIHJldHJ5Q2FsbGJhY2s6IHJlZnJlc2hUb2tlblJldHJ5Q2FsbGJhY2ssXG4gKiAgICByZXRyeUF0dGVtcHRzOiAxXG4gKiB9KTtcbiAqL1xuZnVuY3Rpb24gUmVzb3VyY2Uob3B0aW9ucykge1xuICBvcHRpb25zID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMsIGRlZmF1bHRWYWx1ZS5FTVBUWV9PQkpFQ1QpO1xuICBpZiAodHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCIpIHtcbiAgICBvcHRpb25zID0ge1xuICAgICAgdXJsOiBvcHRpb25zLFxuICAgIH07XG4gIH1cblxuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2Yuc3RyaW5nKFwib3B0aW9ucy51cmxcIiwgb3B0aW9ucy51cmwpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB0aGlzLl91cmwgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX3RlbXBsYXRlVmFsdWVzID0gZGVmYXVsdENsb25lKG9wdGlvbnMudGVtcGxhdGVWYWx1ZXMsIHt9KTtcbiAgdGhpcy5fcXVlcnlQYXJhbWV0ZXJzID0gZGVmYXVsdENsb25lKG9wdGlvbnMucXVlcnlQYXJhbWV0ZXJzLCB7fSk7XG5cbiAgLyoqXG4gICAqIEFkZGl0aW9uYWwgSFRUUCBoZWFkZXJzIHRoYXQgd2lsbCBiZSBzZW50IHdpdGggdGhlIHJlcXVlc3QuXG4gICAqXG4gICAqIEB0eXBlIHtPYmplY3R9XG4gICAqL1xuICB0aGlzLmhlYWRlcnMgPSBkZWZhdWx0Q2xvbmUob3B0aW9ucy5oZWFkZXJzLCB7fSk7XG5cbiAgLyoqXG4gICAqIEEgUmVxdWVzdCBvYmplY3QgdGhhdCB3aWxsIGJlIHVzZWQuIEludGVuZGVkIGZvciBpbnRlcm5hbCB1c2Ugb25seS5cbiAgICpcbiAgICogQHR5cGUge1JlcXVlc3R9XG4gICAqL1xuICB0aGlzLnJlcXVlc3QgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5yZXF1ZXN0LCBuZXcgUmVxdWVzdCgpKTtcblxuICAvKipcbiAgICogQSBwcm94eSB0byBiZSB1c2VkIHdoZW4gbG9hZGluZyB0aGUgcmVzb3VyY2UuXG4gICAqXG4gICAqIEB0eXBlIHtQcm94eX1cbiAgICovXG4gIHRoaXMucHJveHkgPSBvcHRpb25zLnByb3h5O1xuXG4gIC8qKlxuICAgKiBGdW5jdGlvbiB0byBjYWxsIHdoZW4gYSByZXF1ZXN0IGZvciB0aGlzIHJlc291cmNlIGZhaWxzLiBJZiBpdCByZXR1cm5zIHRydWUgb3IgYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdHJ1ZSwgdGhlIHJlcXVlc3Qgd2lsbCBiZSByZXRyaWVkLlxuICAgKlxuICAgKiBAdHlwZSB7RnVuY3Rpb259XG4gICAqL1xuICB0aGlzLnJldHJ5Q2FsbGJhY2sgPSBvcHRpb25zLnJldHJ5Q2FsbGJhY2s7XG5cbiAgLyoqXG4gICAqIFRoZSBudW1iZXIgb2YgdGltZXMgdGhlIHJldHJ5Q2FsbGJhY2sgc2hvdWxkIGJlIGNhbGxlZCBiZWZvcmUgZ2l2aW5nIHVwLlxuICAgKlxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKi9cbiAgdGhpcy5yZXRyeUF0dGVtcHRzID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMucmV0cnlBdHRlbXB0cywgMCk7XG4gIHRoaXMuX3JldHJ5Q291bnQgPSAwO1xuXG4gIHZhciB1cmkgPSBuZXcgVXJpKG9wdGlvbnMudXJsKTtcbiAgcGFyc2VRdWVyeSh1cmksIHRoaXMsIHRydWUsIHRydWUpO1xuXG4gIC8vIFJlbW92ZSB0aGUgZnJhZ21lbnQgYXMgaXQncyBub3Qgc2VudCB3aXRoIGEgcmVxdWVzdFxuICB1cmkuZnJhZ21lbnQoXCJcIik7XG5cbiAgdGhpcy5fdXJsID0gdXJpLnRvU3RyaW5nKCk7XG59XG5cbi8qKlxuICogQSBoZWxwZXIgZnVuY3Rpb24gdG8gY3JlYXRlIGEgcmVzb3VyY2UgZGVwZW5kaW5nIG9uIHdoZXRoZXIgd2UgaGF2ZSBhIFN0cmluZyBvciBhIFJlc291cmNlXG4gKlxuICogQHBhcmFtIHtSZXNvdXJjZXxTdHJpbmd9IHJlc291cmNlIEEgUmVzb3VyY2Ugb3IgYSBTdHJpbmcgdG8gdXNlIHdoZW4gY3JlYXRpbmcgYSBuZXcgUmVzb3VyY2UuXG4gKlxuICogQHJldHVybnMge1Jlc291cmNlfSBJZiByZXNvdXJjZSBpcyBhIFN0cmluZywgYSBSZXNvdXJjZSBjb25zdHJ1Y3RlZCB3aXRoIHRoZSB1cmwgYW5kIG9wdGlvbnMuIE90aGVyd2lzZSB0aGUgcmVzb3VyY2UgcGFyYW1ldGVyIGlzIHJldHVybmVkLlxuICpcbiAqIEBwcml2YXRlXG4gKi9cblJlc291cmNlLmNyZWF0ZUlmTmVlZGVkID0gZnVuY3Rpb24gKHJlc291cmNlKSB7XG4gIGlmIChyZXNvdXJjZSBpbnN0YW5jZW9mIFJlc291cmNlKSB7XG4gICAgLy8gS2VlcCBleGlzdGluZyByZXF1ZXN0IG9iamVjdC4gVGhpcyBmdW5jdGlvbiBpcyB1c2VkIGludGVybmFsbHkgdG8gZHVwbGljYXRlIGEgUmVzb3VyY2UsIHNvIHRoYXQgaXQgY2FuJ3RcbiAgICAvLyAgYmUgbW9kaWZpZWQgb3V0c2lkZSBvZiBhIGNsYXNzIHRoYXQgaG9sZHMgaXQgKGVnLiBhbiBpbWFnZXJ5IG9yIHRlcnJhaW4gcHJvdmlkZXIpLiBTaW5jZSB0aGUgUmVxdWVzdCBvYmplY3RzXG4gICAgLy8gIGFyZSBtYW5hZ2VkIG91dHNpZGUgb2YgdGhlIHByb3ZpZGVycywgYnkgdGhlIHRpbGUgbG9hZGluZyBjb2RlLCB3ZSB3YW50IHRvIGtlZXAgdGhlIHJlcXVlc3QgcHJvcGVydHkgdGhlIHNhbWUgc28gaWYgaXQgaXMgY2hhbmdlZFxuICAgIC8vICBpbiB0aGUgdW5kZXJseWluZyB0aWxpbmcgY29kZSB0aGUgcmVxdWVzdHMgZm9yIHRoaXMgcmVzb3VyY2Ugd2lsbCB1c2UgaXQuXG4gICAgcmV0dXJuIHJlc291cmNlLmdldERlcml2ZWRSZXNvdXJjZSh7XG4gICAgICByZXF1ZXN0OiByZXNvdXJjZS5yZXF1ZXN0LFxuICAgIH0pO1xuICB9XG5cbiAgaWYgKHR5cGVvZiByZXNvdXJjZSAhPT0gXCJzdHJpbmdcIikge1xuICAgIHJldHVybiByZXNvdXJjZTtcbiAgfVxuXG4gIHJldHVybiBuZXcgUmVzb3VyY2Uoe1xuICAgIHVybDogcmVzb3VyY2UsXG4gIH0pO1xufTtcblxudmFyIHN1cHBvcnRzSW1hZ2VCaXRtYXBPcHRpb25zUHJvbWlzZTtcbi8qKlxuICogQSBoZWxwZXIgZnVuY3Rpb24gdG8gY2hlY2sgd2hldGhlciBjcmVhdGVJbWFnZUJpdG1hcCBzdXBwb3J0cyBwYXNzaW5nIEltYWdlQml0bWFwT3B0aW9ucy5cbiAqXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxCb29sZWFuPn0gQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdHJ1ZSBpZiB0aGlzIGJyb3dzZXIgc3VwcG9ydHMgY3JlYXRpbmcgYW4gSW1hZ2VCaXRtYXAgd2l0aCBvcHRpb25zLlxuICpcbiAqIEBwcml2YXRlXG4gKi9cblJlc291cmNlLnN1cHBvcnRzSW1hZ2VCaXRtYXBPcHRpb25zID0gZnVuY3Rpb24gKCkge1xuICAvLyBVbnRpbCB0aGUgSFRNTCBmb2xrcyBmaWd1cmUgb3V0IHdoYXQgdG8gZG8gYWJvdXQgdGhpcywgd2UgbmVlZCB0byBhY3R1YWxseSB0cnkgbG9hZGluZyBhbiBpbWFnZSB0b1xuICAvLyBrbm93IGlmIHRoaXMgYnJvd3NlciBzdXBwb3J0cyBwYXNzaW5nIG9wdGlvbnMgdG8gdGhlIGNyZWF0ZUltYWdlQml0bWFwIGZ1bmN0aW9uLlxuICAvLyBodHRwczovL2dpdGh1Yi5jb20vd2hhdHdnL2h0bWwvcHVsbC80MjQ4XG4gIGlmIChkZWZpbmVkKHN1cHBvcnRzSW1hZ2VCaXRtYXBPcHRpb25zUHJvbWlzZSkpIHtcbiAgICByZXR1cm4gc3VwcG9ydHNJbWFnZUJpdG1hcE9wdGlvbnNQcm9taXNlO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBjcmVhdGVJbWFnZUJpdG1hcCAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgc3VwcG9ydHNJbWFnZUJpdG1hcE9wdGlvbnNQcm9taXNlID0gd2hlbi5yZXNvbHZlKGZhbHNlKTtcbiAgICByZXR1cm4gc3VwcG9ydHNJbWFnZUJpdG1hcE9wdGlvbnNQcm9taXNlO1xuICB9XG5cbiAgdmFyIGltYWdlRGF0YVVyaSA9XG4gICAgXCJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUFFQUFBQUJDQVlBQUFBZkZjU0pBQUFBRFVsRVFWUUltV1A0Ly8vL2Z3QUord1A5Q05Ib0hnQUFBQUJKUlU1RXJrSmdnZz09XCI7XG5cbiAgc3VwcG9ydHNJbWFnZUJpdG1hcE9wdGlvbnNQcm9taXNlID0gUmVzb3VyY2UuZmV0Y2hCbG9iKHtcbiAgICB1cmw6IGltYWdlRGF0YVVyaSxcbiAgfSlcbiAgICAudGhlbihmdW5jdGlvbiAoYmxvYikge1xuICAgICAgcmV0dXJuIGNyZWF0ZUltYWdlQml0bWFwKGJsb2IsIHtcbiAgICAgICAgaW1hZ2VPcmllbnRhdGlvbjogXCJmbGlwWVwiLFxuICAgICAgICBwcmVtdWx0aXBseUFscGhhOiBcIm5vbmVcIixcbiAgICAgICAgY29sb3JTcGFjZUNvbnZlcnNpb246IFwibm9uZVwiLFxuICAgICAgfSk7XG4gICAgfSlcbiAgICAudGhlbihmdW5jdGlvbiAoaW1hZ2VCaXRtYXApIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pXG4gICAgLm90aGVyd2lzZShmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG5cbiAgcmV0dXJuIHN1cHBvcnRzSW1hZ2VCaXRtYXBPcHRpb25zUHJvbWlzZTtcbn07XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFJlc291cmNlLCB7XG4gIC8qKlxuICAgKiBSZXR1cm5zIHRydWUgaWYgYmxvYnMgYXJlIHN1cHBvcnRlZC5cbiAgICpcbiAgICogQG1lbWJlcm9mIFJlc291cmNlXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKlxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIGlzQmxvYlN1cHBvcnRlZDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHhockJsb2JTdXBwb3J0ZWQ7XG4gICAgfSxcbiAgfSxcbn0pO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhSZXNvdXJjZS5wcm90b3R5cGUsIHtcbiAgLyoqXG4gICAqIFF1ZXJ5IHBhcmFtZXRlcnMgYXBwZW5kZWQgdG8gdGhlIHVybC5cbiAgICpcbiAgICogQG1lbWJlcm9mIFJlc291cmNlLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7T2JqZWN0fVxuICAgKlxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIHF1ZXJ5UGFyYW1ldGVyczoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3F1ZXJ5UGFyYW1ldGVycztcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBUaGUga2V5L3ZhbHVlIHBhaXJzIHVzZWQgdG8gcmVwbGFjZSB0ZW1wbGF0ZSBwYXJhbWV0ZXJzIGluIHRoZSB1cmwuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBSZXNvdXJjZS5wcm90b3R5cGVcbiAgICogQHR5cGUge09iamVjdH1cbiAgICpcbiAgICogQHJlYWRvbmx5XG4gICAqL1xuICB0ZW1wbGF0ZVZhbHVlczoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3RlbXBsYXRlVmFsdWVzO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFRoZSB1cmwgdG8gdGhlIHJlc291cmNlIHdpdGggdGVtcGxhdGUgdmFsdWVzIHJlcGxhY2VkLCBxdWVyeSBzdHJpbmcgYXBwZW5kZWQgYW5kIGVuY29kZWQgYnkgcHJveHkgaWYgb25lIHdhcyBzZXQuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBSZXNvdXJjZS5wcm90b3R5cGVcbiAgICogQHR5cGUge1N0cmluZ31cbiAgICovXG4gIHVybDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0VXJsQ29tcG9uZW50KHRydWUsIHRydWUpO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHZhciB1cmkgPSBuZXcgVXJpKHZhbHVlKTtcblxuICAgICAgcGFyc2VRdWVyeSh1cmksIHRoaXMsIGZhbHNlKTtcblxuICAgICAgLy8gUmVtb3ZlIHRoZSBmcmFnbWVudCBhcyBpdCdzIG5vdCBzZW50IHdpdGggYSByZXF1ZXN0XG4gICAgICB1cmkuZnJhZ21lbnQoXCJcIik7XG5cbiAgICAgIHRoaXMuX3VybCA9IHVyaS50b1N0cmluZygpO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFRoZSBmaWxlIGV4dGVuc2lvbiBvZiB0aGUgcmVzb3VyY2UuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBSZXNvdXJjZS5wcm90b3R5cGVcbiAgICogQHR5cGUge1N0cmluZ31cbiAgICpcbiAgICogQHJlYWRvbmx5XG4gICAqL1xuICBleHRlbnNpb246IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBnZXRFeHRlbnNpb25Gcm9tVXJpKHRoaXMuX3VybCk7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogVHJ1ZSBpZiB0aGUgUmVzb3VyY2UgcmVmZXJzIHRvIGEgZGF0YSBVUkkuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBSZXNvdXJjZS5wcm90b3R5cGVcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqL1xuICBpc0RhdGFVcmk6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBpc0RhdGFVcmkodGhpcy5fdXJsKTtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBUcnVlIGlmIHRoZSBSZXNvdXJjZSByZWZlcnMgdG8gYSBibG9iIFVSSS5cbiAgICpcbiAgICogQG1lbWJlcm9mIFJlc291cmNlLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICovXG4gIGlzQmxvYlVyaToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGlzQmxvYlVyaSh0aGlzLl91cmwpO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFRydWUgaWYgdGhlIFJlc291cmNlIHJlZmVycyB0byBhIGNyb3NzIG9yaWdpbiBVUkwuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBSZXNvdXJjZS5wcm90b3R5cGVcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqL1xuICBpc0Nyb3NzT3JpZ2luVXJsOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gaXNDcm9zc09yaWdpblVybCh0aGlzLl91cmwpO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFRydWUgaWYgdGhlIFJlc291cmNlIGhhcyByZXF1ZXN0IGhlYWRlcnMuIFRoaXMgaXMgZXF1aXZhbGVudCB0byBjaGVja2luZyBpZiB0aGUgaGVhZGVycyBwcm9wZXJ0eSBoYXMgYW55IGtleXMuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBSZXNvdXJjZS5wcm90b3R5cGVcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqL1xuICBoYXNIZWFkZXJzOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5oZWFkZXJzKS5sZW5ndGggPiAwO1xuICAgIH0sXG4gIH0sXG59KTtcblxuLyoqXG4gKiBPdmVycmlkZSBPYmplY3QjdG9TdHJpbmcgc28gdGhhdCBpbXBsaWNpdCBzdHJpbmcgY29udmVyc2lvbiBnaXZlcyB0aGVcbiAqIGNvbXBsZXRlIFVSTCByZXByZXNlbnRlZCBieSB0aGlzIFJlc291cmNlLlxuICpcbiAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBVUkwgcmVwcmVzZW50ZWQgYnkgdGhpcyBSZXNvdXJjZVxuICovXG5SZXNvdXJjZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLmdldFVybENvbXBvbmVudCh0cnVlLCB0cnVlKTtcbn07XG5cbi8qKlxuICogUmV0dXJucyB0aGUgdXJsLCBvcHRpb25hbCB3aXRoIHRoZSBxdWVyeSBzdHJpbmcgYW5kIHByb2Nlc3NlZCBieSBhIHByb3h5LlxuICpcbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW3F1ZXJ5PWZhbHNlXSBJZiB0cnVlLCB0aGUgcXVlcnkgc3RyaW5nIGlzIGluY2x1ZGVkLlxuICogQHBhcmFtIHtCb29sZWFufSBbcHJveHk9ZmFsc2VdIElmIHRydWUsIHRoZSB1cmwgaXMgcHJvY2Vzc2VkIGJ5IHRoZSBwcm94eSBvYmplY3QsIGlmIGRlZmluZWQuXG4gKlxuICogQHJldHVybnMge1N0cmluZ30gVGhlIHVybCB3aXRoIGFsbCB0aGUgcmVxdWVzdGVkIGNvbXBvbmVudHMuXG4gKi9cblJlc291cmNlLnByb3RvdHlwZS5nZXRVcmxDb21wb25lbnQgPSBmdW5jdGlvbiAocXVlcnksIHByb3h5KSB7XG4gIGlmICh0aGlzLmlzRGF0YVVyaSkge1xuICAgIHJldHVybiB0aGlzLl91cmw7XG4gIH1cblxuICB2YXIgdXJpID0gbmV3IFVyaSh0aGlzLl91cmwpO1xuXG4gIGlmIChxdWVyeSkge1xuICAgIHN0cmluZ2lmeVF1ZXJ5KHVyaSwgdGhpcyk7XG4gIH1cblxuICAvLyBvYmplY3RUb1F1ZXJ5IGVzY2FwZXMgdGhlIHBsYWNlaG9sZGVycy4gIFVuZG8gdGhhdC5cbiAgdmFyIHVybCA9IHVyaS50b1N0cmluZygpLnJlcGxhY2UoLyU3Qi9nLCBcIntcIikucmVwbGFjZSgvJTdEL2csIFwifVwiKTtcblxuICB2YXIgdGVtcGxhdGVWYWx1ZXMgPSB0aGlzLl90ZW1wbGF0ZVZhbHVlcztcbiAgdXJsID0gdXJsLnJlcGxhY2UoL3soLio/KX0vZywgZnVuY3Rpb24gKG1hdGNoLCBrZXkpIHtcbiAgICB2YXIgcmVwbGFjZW1lbnQgPSB0ZW1wbGF0ZVZhbHVlc1trZXldO1xuICAgIGlmIChkZWZpbmVkKHJlcGxhY2VtZW50KSkge1xuICAgICAgLy8gdXNlIHRoZSByZXBsYWNlbWVudCB2YWx1ZSBmcm9tIHRlbXBsYXRlVmFsdWVzIGlmIHRoZXJlIGlzIG9uZS4uLlxuICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChyZXBsYWNlbWVudCk7XG4gICAgfVxuICAgIC8vIG90aGVyd2lzZSBsZWF2ZSBpdCB1bmNoYW5nZWRcbiAgICByZXR1cm4gbWF0Y2g7XG4gIH0pO1xuXG4gIGlmIChwcm94eSAmJiBkZWZpbmVkKHRoaXMucHJveHkpKSB7XG4gICAgdXJsID0gdGhpcy5wcm94eS5nZXRVUkwodXJsKTtcbiAgfVxuICByZXR1cm4gdXJsO1xufTtcblxuLyoqXG4gKiBDb21iaW5lcyB0aGUgc3BlY2lmaWVkIG9iamVjdCBhbmQgdGhlIGV4aXN0aW5nIHF1ZXJ5IHBhcmFtZXRlcnMuIFRoaXMgYWxsb3dzIHlvdSB0byBhZGQgbWFueSBwYXJhbWV0ZXJzIGF0IG9uY2UsXG4gKiAgYXMgb3Bwb3NlZCB0byBhZGRpbmcgdGhlbSBvbmUgYXQgYSB0aW1lIHRvIHRoZSBxdWVyeVBhcmFtZXRlcnMgcHJvcGVydHkuIElmIGEgdmFsdWUgaXMgYWxyZWFkeSBzZXQsIGl0IHdpbGwgYmUgcmVwbGFjZWQgd2l0aCB0aGUgbmV3IHZhbHVlLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbXMgVGhlIHF1ZXJ5IHBhcmFtZXRlcnNcbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW3VzZUFzRGVmYXVsdD1mYWxzZV0gSWYgdHJ1ZSB0aGUgcGFyYW1zIHdpbGwgYmUgdXNlZCBhcyB0aGUgZGVmYXVsdCB2YWx1ZXMsIHNvIHRoZXkgd2lsbCBvbmx5IGJlIHNldCBpZiB0aGV5IGFyZSB1bmRlZmluZWQuXG4gKi9cblJlc291cmNlLnByb3RvdHlwZS5zZXRRdWVyeVBhcmFtZXRlcnMgPSBmdW5jdGlvbiAocGFyYW1zLCB1c2VBc0RlZmF1bHQpIHtcbiAgaWYgKHVzZUFzRGVmYXVsdCkge1xuICAgIHRoaXMuX3F1ZXJ5UGFyYW1ldGVycyA9IGNvbWJpbmVRdWVyeVBhcmFtZXRlcnMoXG4gICAgICB0aGlzLl9xdWVyeVBhcmFtZXRlcnMsXG4gICAgICBwYXJhbXMsXG4gICAgICBmYWxzZVxuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5fcXVlcnlQYXJhbWV0ZXJzID0gY29tYmluZVF1ZXJ5UGFyYW1ldGVycyhcbiAgICAgIHBhcmFtcyxcbiAgICAgIHRoaXMuX3F1ZXJ5UGFyYW1ldGVycyxcbiAgICAgIGZhbHNlXG4gICAgKTtcbiAgfVxufTtcblxuLyoqXG4gKiBDb21iaW5lcyB0aGUgc3BlY2lmaWVkIG9iamVjdCBhbmQgdGhlIGV4aXN0aW5nIHF1ZXJ5IHBhcmFtZXRlcnMuIFRoaXMgYWxsb3dzIHlvdSB0byBhZGQgbWFueSBwYXJhbWV0ZXJzIGF0IG9uY2UsXG4gKiAgYXMgb3Bwb3NlZCB0byBhZGRpbmcgdGhlbSBvbmUgYXQgYSB0aW1lIHRvIHRoZSBxdWVyeVBhcmFtZXRlcnMgcHJvcGVydHkuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHBhcmFtcyBUaGUgcXVlcnkgcGFyYW1ldGVyc1xuICovXG5SZXNvdXJjZS5wcm90b3R5cGUuYXBwZW5kUXVlcnlQYXJhbWV0ZXJzID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICB0aGlzLl9xdWVyeVBhcmFtZXRlcnMgPSBjb21iaW5lUXVlcnlQYXJhbWV0ZXJzKFxuICAgIHBhcmFtcyxcbiAgICB0aGlzLl9xdWVyeVBhcmFtZXRlcnMsXG4gICAgdHJ1ZVxuICApO1xufTtcblxuLyoqXG4gKiBDb21iaW5lcyB0aGUgc3BlY2lmaWVkIG9iamVjdCBhbmQgdGhlIGV4aXN0aW5nIHRlbXBsYXRlIHZhbHVlcy4gVGhpcyBhbGxvd3MgeW91IHRvIGFkZCBtYW55IHZhbHVlcyBhdCBvbmNlLFxuICogIGFzIG9wcG9zZWQgdG8gYWRkaW5nIHRoZW0gb25lIGF0IGEgdGltZSB0byB0aGUgdGVtcGxhdGVWYWx1ZXMgcHJvcGVydHkuIElmIGEgdmFsdWUgaXMgYWxyZWFkeSBzZXQsIGl0IHdpbGwgYmVjb21lIGFuIGFycmF5IGFuZCB0aGUgbmV3IHZhbHVlIHdpbGwgYmUgYXBwZW5kZWQuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHRlbXBsYXRlIFRoZSB0ZW1wbGF0ZSB2YWx1ZXNcbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW3VzZUFzRGVmYXVsdD1mYWxzZV0gSWYgdHJ1ZSB0aGUgdmFsdWVzIHdpbGwgYmUgdXNlZCBhcyB0aGUgZGVmYXVsdCB2YWx1ZXMsIHNvIHRoZXkgd2lsbCBvbmx5IGJlIHNldCBpZiB0aGV5IGFyZSB1bmRlZmluZWQuXG4gKi9cblJlc291cmNlLnByb3RvdHlwZS5zZXRUZW1wbGF0ZVZhbHVlcyA9IGZ1bmN0aW9uICh0ZW1wbGF0ZSwgdXNlQXNEZWZhdWx0KSB7XG4gIGlmICh1c2VBc0RlZmF1bHQpIHtcbiAgICB0aGlzLl90ZW1wbGF0ZVZhbHVlcyA9IGNvbWJpbmUodGhpcy5fdGVtcGxhdGVWYWx1ZXMsIHRlbXBsYXRlKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLl90ZW1wbGF0ZVZhbHVlcyA9IGNvbWJpbmUodGVtcGxhdGUsIHRoaXMuX3RlbXBsYXRlVmFsdWVzKTtcbiAgfVxufTtcblxuLyoqXG4gKiBSZXR1cm5zIGEgcmVzb3VyY2UgcmVsYXRpdmUgdG8gdGhlIGN1cnJlbnQgaW5zdGFuY2UuIEFsbCBwcm9wZXJ0aWVzIHJlbWFpbiB0aGUgc2FtZSBhcyB0aGUgY3VycmVudCBpbnN0YW5jZSB1bmxlc3Mgb3ZlcnJpZGRlbiBpbiBvcHRpb25zLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIEFuIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllc1xuICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLnVybF0gIFRoZSB1cmwgdGhhdCB3aWxsIGJlIHJlc29sdmVkIHJlbGF0aXZlIHRvIHRoZSB1cmwgb2YgdGhlIGN1cnJlbnQgaW5zdGFuY2UuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMucXVlcnlQYXJhbWV0ZXJzXSBBbiBvYmplY3QgY29udGFpbmluZyBxdWVyeSBwYXJhbWV0ZXJzIHRoYXQgd2lsbCBiZSBjb21iaW5lZCB3aXRoIHRob3NlIG9mIHRoZSBjdXJyZW50IGluc3RhbmNlLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLnRlbXBsYXRlVmFsdWVzXSBLZXkvVmFsdWUgcGFpcnMgdGhhdCBhcmUgdXNlZCB0byByZXBsYWNlIHRlbXBsYXRlIHZhbHVlcyAoZWcuIHt4fSkuIFRoZXNlIHdpbGwgYmUgY29tYmluZWQgd2l0aCB0aG9zZSBvZiB0aGUgY3VycmVudCBpbnN0YW5jZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5oZWFkZXJzPXt9XSBBZGRpdGlvbmFsIEhUVFAgaGVhZGVycyB0aGF0IHdpbGwgYmUgc2VudC5cbiAqIEBwYXJhbSB7UHJveHl9IFtvcHRpb25zLnByb3h5XSBBIHByb3h5IHRvIGJlIHVzZWQgd2hlbiBsb2FkaW5nIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7UmVzb3VyY2UuUmV0cnlDYWxsYmFja30gW29wdGlvbnMucmV0cnlDYWxsYmFja10gVGhlIGZ1bmN0aW9uIHRvIGNhbGwgd2hlbiBsb2FkaW5nIHRoZSByZXNvdXJjZSBmYWlscy5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5yZXRyeUF0dGVtcHRzXSBUaGUgbnVtYmVyIG9mIHRpbWVzIHRoZSByZXRyeUNhbGxiYWNrIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGdpdmluZyB1cC5cbiAqIEBwYXJhbSB7UmVxdWVzdH0gW29wdGlvbnMucmVxdWVzdF0gQSBSZXF1ZXN0IG9iamVjdCB0aGF0IHdpbGwgYmUgdXNlZC4gSW50ZW5kZWQgZm9yIGludGVybmFsIHVzZSBvbmx5LlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5wcmVzZXJ2ZVF1ZXJ5UGFyYW1ldGVycz1mYWxzZV0gSWYgdHJ1ZSwgdGhpcyB3aWxsIGtlZXAgYWxsIHF1ZXJ5IHBhcmFtZXRlcnMgZnJvbSB0aGUgY3VycmVudCByZXNvdXJjZSBhbmQgZGVyaXZlZCByZXNvdXJjZS4gSWYgZmFsc2UsIGRlcml2ZWQgcGFyYW1ldGVycyB3aWxsIHJlcGxhY2UgdGhvc2Ugb2YgdGhlIGN1cnJlbnQgcmVzb3VyY2UuXG4gKlxuICogQHJldHVybnMge1Jlc291cmNlfSBUaGUgcmVzb3VyY2UgZGVyaXZlZCBmcm9tIHRoZSBjdXJyZW50IG9uZS5cbiAqL1xuUmVzb3VyY2UucHJvdG90eXBlLmdldERlcml2ZWRSZXNvdXJjZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gIHZhciByZXNvdXJjZSA9IHRoaXMuY2xvbmUoKTtcbiAgcmVzb3VyY2UuX3JldHJ5Q291bnQgPSAwO1xuXG4gIGlmIChkZWZpbmVkKG9wdGlvbnMudXJsKSkge1xuICAgIHZhciB1cmkgPSBuZXcgVXJpKG9wdGlvbnMudXJsKTtcblxuICAgIHZhciBwcmVzZXJ2ZVF1ZXJ5UGFyYW1ldGVycyA9IGRlZmF1bHRWYWx1ZShcbiAgICAgIG9wdGlvbnMucHJlc2VydmVRdWVyeVBhcmFtZXRlcnMsXG4gICAgICBmYWxzZVxuICAgICk7XG4gICAgcGFyc2VRdWVyeSh1cmksIHJlc291cmNlLCB0cnVlLCBwcmVzZXJ2ZVF1ZXJ5UGFyYW1ldGVycyk7XG5cbiAgICAvLyBSZW1vdmUgdGhlIGZyYWdtZW50IGFzIGl0J3Mgbm90IHNlbnQgd2l0aCBhIHJlcXVlc3RcbiAgICB1cmkuZnJhZ21lbnQoXCJcIik7XG5cbiAgICBpZiAodXJpLnNjaGVtZSgpICE9PSBcIlwiKSB7XG4gICAgICByZXNvdXJjZS5fdXJsID0gdXJpLnRvU3RyaW5nKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc291cmNlLl91cmwgPSB1cmlcbiAgICAgICAgLmFic29sdXRlVG8obmV3IFVyaShnZXRBYnNvbHV0ZVVyaSh0aGlzLl91cmwpKSlcbiAgICAgICAgLnRvU3RyaW5nKCk7XG4gICAgfVxuICB9XG5cbiAgaWYgKGRlZmluZWQob3B0aW9ucy5xdWVyeVBhcmFtZXRlcnMpKSB7XG4gICAgcmVzb3VyY2UuX3F1ZXJ5UGFyYW1ldGVycyA9IGNvbWJpbmUoXG4gICAgICBvcHRpb25zLnF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgIHJlc291cmNlLl9xdWVyeVBhcmFtZXRlcnNcbiAgICApO1xuICB9XG4gIGlmIChkZWZpbmVkKG9wdGlvbnMudGVtcGxhdGVWYWx1ZXMpKSB7XG4gICAgcmVzb3VyY2UuX3RlbXBsYXRlVmFsdWVzID0gY29tYmluZShcbiAgICAgIG9wdGlvbnMudGVtcGxhdGVWYWx1ZXMsXG4gICAgICByZXNvdXJjZS50ZW1wbGF0ZVZhbHVlc1xuICAgICk7XG4gIH1cbiAgaWYgKGRlZmluZWQob3B0aW9ucy5oZWFkZXJzKSkge1xuICAgIHJlc291cmNlLmhlYWRlcnMgPSBjb21iaW5lKG9wdGlvbnMuaGVhZGVycywgcmVzb3VyY2UuaGVhZGVycyk7XG4gIH1cbiAgaWYgKGRlZmluZWQob3B0aW9ucy5wcm94eSkpIHtcbiAgICByZXNvdXJjZS5wcm94eSA9IG9wdGlvbnMucHJveHk7XG4gIH1cbiAgaWYgKGRlZmluZWQob3B0aW9ucy5yZXF1ZXN0KSkge1xuICAgIHJlc291cmNlLnJlcXVlc3QgPSBvcHRpb25zLnJlcXVlc3Q7XG4gIH1cbiAgaWYgKGRlZmluZWQob3B0aW9ucy5yZXRyeUNhbGxiYWNrKSkge1xuICAgIHJlc291cmNlLnJldHJ5Q2FsbGJhY2sgPSBvcHRpb25zLnJldHJ5Q2FsbGJhY2s7XG4gIH1cbiAgaWYgKGRlZmluZWQob3B0aW9ucy5yZXRyeUF0dGVtcHRzKSkge1xuICAgIHJlc291cmNlLnJldHJ5QXR0ZW1wdHMgPSBvcHRpb25zLnJldHJ5QXR0ZW1wdHM7XG4gIH1cblxuICByZXR1cm4gcmVzb3VyY2U7XG59O1xuXG4vKipcbiAqIENhbGxlZCB3aGVuIGEgcmVzb3VyY2UgZmFpbHMgdG8gbG9hZC4gVGhpcyB3aWxsIGNhbGwgdGhlIHJldHJ5Q2FsbGJhY2sgZnVuY3Rpb24gaWYgZGVmaW5lZCB1bnRpbCByZXRyeUF0dGVtcHRzIGlzIHJlYWNoZWQuXG4gKlxuICogQHBhcmFtIHtFcnJvcn0gW2Vycm9yXSBUaGUgZXJyb3IgdGhhdCB3YXMgZW5jb3VudGVyZWQuXG4gKlxuICogQHJldHVybnMge1Byb21pc2U8Qm9vbGVhbj59IEEgcHJvbWlzZSB0byBhIGJvb2xlYW4sIHRoYXQgaWYgdHJ1ZSB3aWxsIGNhdXNlIHRoZSByZXNvdXJjZSByZXF1ZXN0IHRvIGJlIHJldHJpZWQuXG4gKlxuICogQHByaXZhdGVcbiAqL1xuUmVzb3VyY2UucHJvdG90eXBlLnJldHJ5T25FcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICB2YXIgcmV0cnlDYWxsYmFjayA9IHRoaXMucmV0cnlDYWxsYmFjaztcbiAgaWYgKFxuICAgIHR5cGVvZiByZXRyeUNhbGxiYWNrICE9PSBcImZ1bmN0aW9uXCIgfHxcbiAgICB0aGlzLl9yZXRyeUNvdW50ID49IHRoaXMucmV0cnlBdHRlbXB0c1xuICApIHtcbiAgICByZXR1cm4gd2hlbihmYWxzZSk7XG4gIH1cblxuICB2YXIgdGhhdCA9IHRoaXM7XG4gIHJldHVybiB3aGVuKHJldHJ5Q2FsbGJhY2sodGhpcywgZXJyb3IpKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICArK3RoYXQuX3JldHJ5Q291bnQ7XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9KTtcbn07XG5cbi8qKlxuICogRHVwbGljYXRlcyBhIFJlc291cmNlIGluc3RhbmNlLlxuICpcbiAqIEBwYXJhbSB7UmVzb3VyY2V9IFtyZXN1bHRdIFRoZSBvYmplY3Qgb250byB3aGljaCB0byBzdG9yZSB0aGUgcmVzdWx0LlxuICpcbiAqIEByZXR1cm5zIHtSZXNvdXJjZX0gVGhlIG1vZGlmaWVkIHJlc3VsdCBwYXJhbWV0ZXIgb3IgYSBuZXcgUmVzb3VyY2UgaW5zdGFuY2UgaWYgb25lIHdhcyBub3QgcHJvdmlkZWQuXG4gKi9cblJlc291cmNlLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgaWYgKCFkZWZpbmVkKHJlc3VsdCkpIHtcbiAgICByZXN1bHQgPSBuZXcgUmVzb3VyY2Uoe1xuICAgICAgdXJsOiB0aGlzLl91cmwsXG4gICAgfSk7XG4gIH1cblxuICByZXN1bHQuX3VybCA9IHRoaXMuX3VybDtcbiAgcmVzdWx0Ll9xdWVyeVBhcmFtZXRlcnMgPSBjbG9uZSh0aGlzLl9xdWVyeVBhcmFtZXRlcnMpO1xuICByZXN1bHQuX3RlbXBsYXRlVmFsdWVzID0gY2xvbmUodGhpcy5fdGVtcGxhdGVWYWx1ZXMpO1xuICByZXN1bHQuaGVhZGVycyA9IGNsb25lKHRoaXMuaGVhZGVycyk7XG4gIHJlc3VsdC5wcm94eSA9IHRoaXMucHJveHk7XG4gIHJlc3VsdC5yZXRyeUNhbGxiYWNrID0gdGhpcy5yZXRyeUNhbGxiYWNrO1xuICByZXN1bHQucmV0cnlBdHRlbXB0cyA9IHRoaXMucmV0cnlBdHRlbXB0cztcbiAgcmVzdWx0Ll9yZXRyeUNvdW50ID0gMDtcbiAgcmVzdWx0LnJlcXVlc3QgPSB0aGlzLnJlcXVlc3QuY2xvbmUoKTtcblxuICByZXR1cm4gcmVzdWx0O1xufTtcblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBiYXNlIHBhdGggb2YgdGhlIFJlc291cmNlLlxuICpcbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW2luY2x1ZGVRdWVyeSA9IGZhbHNlXSBXaGV0aGVyIG9yIG5vdCB0byBpbmNsdWRlIHRoZSBxdWVyeSBzdHJpbmcgYW5kIGZyYWdtZW50IGZvcm0gdGhlIHVyaVxuICpcbiAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBiYXNlIFVSSSBvZiB0aGUgcmVzb3VyY2VcbiAqL1xuUmVzb3VyY2UucHJvdG90eXBlLmdldEJhc2VVcmkgPSBmdW5jdGlvbiAoaW5jbHVkZVF1ZXJ5KSB7XG4gIHJldHVybiBnZXRCYXNlVXJpKHRoaXMuZ2V0VXJsQ29tcG9uZW50KGluY2x1ZGVRdWVyeSksIGluY2x1ZGVRdWVyeSk7XG59O1xuXG4vKipcbiAqIEFwcGVuZHMgYSBmb3J3YXJkIHNsYXNoIHRvIHRoZSBVUkwuXG4gKi9cblJlc291cmNlLnByb3RvdHlwZS5hcHBlbmRGb3J3YXJkU2xhc2ggPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuX3VybCA9IGFwcGVuZEZvcndhcmRTbGFzaCh0aGlzLl91cmwpO1xufTtcblxuLyoqXG4gKiBBc3luY2hyb25vdXNseSBsb2FkcyB0aGUgcmVzb3VyY2UgYXMgcmF3IGJpbmFyeSBkYXRhLiAgUmV0dXJucyBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG9cbiAqIGFuIEFycmF5QnVmZmVyIG9uY2UgbG9hZGVkLCBvciByZWplY3QgaWYgdGhlIHJlc291cmNlIGZhaWxlZCB0byBsb2FkLiAgVGhlIGRhdGEgaXMgbG9hZGVkXG4gKiB1c2luZyBYTUxIdHRwUmVxdWVzdCwgd2hpY2ggbWVhbnMgdGhhdCBpbiBvcmRlciB0byBtYWtlIHJlcXVlc3RzIHRvIGFub3RoZXIgb3JpZ2luLFxuICogdGhlIHNlcnZlciBtdXN0IGhhdmUgQ3Jvc3MtT3JpZ2luIFJlc291cmNlIFNoYXJpbmcgKENPUlMpIGhlYWRlcnMgZW5hYmxlZC5cbiAqXG4gKiBAcmV0dXJucyB7UHJvbWlzZS48QXJyYXlCdWZmZXI+fHVuZGVmaW5lZH0gYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHRvIHRoZSByZXF1ZXN0ZWQgZGF0YSB3aGVuIGxvYWRlZC4gUmV0dXJucyB1bmRlZmluZWQgaWYgPGNvZGU+cmVxdWVzdC50aHJvdHRsZTwvY29kZT4gaXMgdHJ1ZSBhbmQgdGhlIHJlcXVlc3QgZG9lcyBub3QgaGF2ZSBoaWdoIGVub3VnaCBwcmlvcml0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gbG9hZCBhIHNpbmdsZSBVUkwgYXN5bmNocm9ub3VzbHlcbiAqIHJlc291cmNlLmZldGNoQXJyYXlCdWZmZXIoKS50aGVuKGZ1bmN0aW9uKGFycmF5QnVmZmVyKSB7XG4gKiAgICAgLy8gdXNlIHRoZSBkYXRhXG4gKiB9KS5vdGhlcndpc2UoZnVuY3Rpb24oZXJyb3IpIHtcbiAqICAgICAvLyBhbiBlcnJvciBvY2N1cnJlZFxuICogfSk7XG4gKlxuICogQHNlZSB7QGxpbmsgaHR0cDovL3d3dy53My5vcmcvVFIvY29ycy98Q3Jvc3MtT3JpZ2luIFJlc291cmNlIFNoYXJpbmd9XG4gKiBAc2VlIHtAbGluayBodHRwOi8vd2lraS5jb21tb25qcy5vcmcvd2lraS9Qcm9taXNlcy9BfENvbW1vbkpTIFByb21pc2VzL0F9XG4gKi9cblJlc291cmNlLnByb3RvdHlwZS5mZXRjaEFycmF5QnVmZmVyID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5mZXRjaCh7XG4gICAgcmVzcG9uc2VUeXBlOiBcImFycmF5YnVmZmVyXCIsXG4gIH0pO1xufTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgUmVzb3VyY2UgYW5kIGNhbGxzIGZldGNoQXJyYXlCdWZmZXIoKSBvbiBpdC5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ3xPYmplY3R9IG9wdGlvbnMgQSB1cmwgb3IgYW4gb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzXG4gKiBAcGFyYW0ge1N0cmluZ30gb3B0aW9ucy51cmwgVGhlIHVybCBvZiB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMucXVlcnlQYXJhbWV0ZXJzXSBBbiBvYmplY3QgY29udGFpbmluZyBxdWVyeSBwYXJhbWV0ZXJzIHRoYXQgd2lsbCBiZSBzZW50IHdoZW4gcmV0cmlldmluZyB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMudGVtcGxhdGVWYWx1ZXNdIEtleS9WYWx1ZSBwYWlycyB0aGF0IGFyZSB1c2VkIHRvIHJlcGxhY2UgdGVtcGxhdGUgdmFsdWVzIChlZy4ge3h9KS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5oZWFkZXJzPXt9XSBBZGRpdGlvbmFsIEhUVFAgaGVhZGVycyB0aGF0IHdpbGwgYmUgc2VudC5cbiAqIEBwYXJhbSB7UHJveHl9IFtvcHRpb25zLnByb3h5XSBBIHByb3h5IHRvIGJlIHVzZWQgd2hlbiBsb2FkaW5nIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7UmVzb3VyY2UuUmV0cnlDYWxsYmFja30gW29wdGlvbnMucmV0cnlDYWxsYmFja10gVGhlIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiBhIHJlcXVlc3QgZm9yIHRoaXMgcmVzb3VyY2UgZmFpbHMuIElmIGl0IHJldHVybnMgdHJ1ZSwgdGhlIHJlcXVlc3Qgd2lsbCBiZSByZXRyaWVkLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLnJldHJ5QXR0ZW1wdHM9MF0gVGhlIG51bWJlciBvZiB0aW1lcyB0aGUgcmV0cnlDYWxsYmFjayBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBnaXZpbmcgdXAuXG4gKiBAcGFyYW0ge1JlcXVlc3R9IFtvcHRpb25zLnJlcXVlc3RdIEEgUmVxdWVzdCBvYmplY3QgdGhhdCB3aWxsIGJlIHVzZWQuIEludGVuZGVkIGZvciBpbnRlcm5hbCB1c2Ugb25seS5cbiAqIEByZXR1cm5zIHtQcm9taXNlLjxBcnJheUJ1ZmZlcj58dW5kZWZpbmVkfSBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG8gdGhlIHJlcXVlc3RlZCBkYXRhIHdoZW4gbG9hZGVkLiBSZXR1cm5zIHVuZGVmaW5lZCBpZiA8Y29kZT5yZXF1ZXN0LnRocm90dGxlPC9jb2RlPiBpcyB0cnVlIGFuZCB0aGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIGhpZ2ggZW5vdWdoIHByaW9yaXR5LlxuICovXG5SZXNvdXJjZS5mZXRjaEFycmF5QnVmZmVyID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgdmFyIHJlc291cmNlID0gbmV3IFJlc291cmNlKG9wdGlvbnMpO1xuICByZXR1cm4gcmVzb3VyY2UuZmV0Y2hBcnJheUJ1ZmZlcigpO1xufTtcblxuLyoqXG4gKiBBc3luY2hyb25vdXNseSBsb2FkcyB0aGUgZ2l2ZW4gcmVzb3VyY2UgYXMgYSBibG9iLiAgUmV0dXJucyBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG9cbiAqIGEgQmxvYiBvbmNlIGxvYWRlZCwgb3IgcmVqZWN0IGlmIHRoZSByZXNvdXJjZSBmYWlsZWQgdG8gbG9hZC4gIFRoZSBkYXRhIGlzIGxvYWRlZFxuICogdXNpbmcgWE1MSHR0cFJlcXVlc3QsIHdoaWNoIG1lYW5zIHRoYXQgaW4gb3JkZXIgdG8gbWFrZSByZXF1ZXN0cyB0byBhbm90aGVyIG9yaWdpbixcbiAqIHRoZSBzZXJ2ZXIgbXVzdCBoYXZlIENyb3NzLU9yaWdpbiBSZXNvdXJjZSBTaGFyaW5nIChDT1JTKSBoZWFkZXJzIGVuYWJsZWQuXG4gKlxuICogQHJldHVybnMge1Byb21pc2UuPEJsb2I+fHVuZGVmaW5lZH0gYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHRvIHRoZSByZXF1ZXN0ZWQgZGF0YSB3aGVuIGxvYWRlZC4gUmV0dXJucyB1bmRlZmluZWQgaWYgPGNvZGU+cmVxdWVzdC50aHJvdHRsZTwvY29kZT4gaXMgdHJ1ZSBhbmQgdGhlIHJlcXVlc3QgZG9lcyBub3QgaGF2ZSBoaWdoIGVub3VnaCBwcmlvcml0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gbG9hZCBhIHNpbmdsZSBVUkwgYXN5bmNocm9ub3VzbHlcbiAqIHJlc291cmNlLmZldGNoQmxvYigpLnRoZW4oZnVuY3Rpb24oYmxvYikge1xuICogICAgIC8vIHVzZSB0aGUgZGF0YVxuICogfSkub3RoZXJ3aXNlKGZ1bmN0aW9uKGVycm9yKSB7XG4gKiAgICAgLy8gYW4gZXJyb3Igb2NjdXJyZWRcbiAqIH0pO1xuICpcbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly93d3cudzMub3JnL1RSL2NvcnMvfENyb3NzLU9yaWdpbiBSZXNvdXJjZSBTaGFyaW5nfVxuICogQHNlZSB7QGxpbmsgaHR0cDovL3dpa2kuY29tbW9uanMub3JnL3dpa2kvUHJvbWlzZXMvQXxDb21tb25KUyBQcm9taXNlcy9BfVxuICovXG5SZXNvdXJjZS5wcm90b3R5cGUuZmV0Y2hCbG9iID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5mZXRjaCh7XG4gICAgcmVzcG9uc2VUeXBlOiBcImJsb2JcIixcbiAgfSk7XG59O1xuXG4vKipcbiAqIENyZWF0ZXMgYSBSZXNvdXJjZSBhbmQgY2FsbHMgZmV0Y2hCbG9iKCkgb24gaXQuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd8T2JqZWN0fSBvcHRpb25zIEEgdXJsIG9yIGFuIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllc1xuICogQHBhcmFtIHtTdHJpbmd9IG9wdGlvbnMudXJsIFRoZSB1cmwgb2YgdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLnF1ZXJ5UGFyYW1ldGVyc10gQW4gb2JqZWN0IGNvbnRhaW5pbmcgcXVlcnkgcGFyYW1ldGVycyB0aGF0IHdpbGwgYmUgc2VudCB3aGVuIHJldHJpZXZpbmcgdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLnRlbXBsYXRlVmFsdWVzXSBLZXkvVmFsdWUgcGFpcnMgdGhhdCBhcmUgdXNlZCB0byByZXBsYWNlIHRlbXBsYXRlIHZhbHVlcyAoZWcuIHt4fSkuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMuaGVhZGVycz17fV0gQWRkaXRpb25hbCBIVFRQIGhlYWRlcnMgdGhhdCB3aWxsIGJlIHNlbnQuXG4gKiBAcGFyYW0ge1Byb3h5fSBbb3B0aW9ucy5wcm94eV0gQSBwcm94eSB0byBiZSB1c2VkIHdoZW4gbG9hZGluZyB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge1Jlc291cmNlLlJldHJ5Q2FsbGJhY2t9IFtvcHRpb25zLnJldHJ5Q2FsbGJhY2tdIFRoZSBGdW5jdGlvbiB0byBjYWxsIHdoZW4gYSByZXF1ZXN0IGZvciB0aGlzIHJlc291cmNlIGZhaWxzLiBJZiBpdCByZXR1cm5zIHRydWUsIHRoZSByZXF1ZXN0IHdpbGwgYmUgcmV0cmllZC5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5yZXRyeUF0dGVtcHRzPTBdIFRoZSBudW1iZXIgb2YgdGltZXMgdGhlIHJldHJ5Q2FsbGJhY2sgc2hvdWxkIGJlIGNhbGxlZCBiZWZvcmUgZ2l2aW5nIHVwLlxuICogQHBhcmFtIHtSZXF1ZXN0fSBbb3B0aW9ucy5yZXF1ZXN0XSBBIFJlcXVlc3Qgb2JqZWN0IHRoYXQgd2lsbCBiZSB1c2VkLiBJbnRlbmRlZCBmb3IgaW50ZXJuYWwgdXNlIG9ubHkuXG4gKiBAcmV0dXJucyB7UHJvbWlzZS48QmxvYj58dW5kZWZpbmVkfSBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG8gdGhlIHJlcXVlc3RlZCBkYXRhIHdoZW4gbG9hZGVkLiBSZXR1cm5zIHVuZGVmaW5lZCBpZiA8Y29kZT5yZXF1ZXN0LnRocm90dGxlPC9jb2RlPiBpcyB0cnVlIGFuZCB0aGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIGhpZ2ggZW5vdWdoIHByaW9yaXR5LlxuICovXG5SZXNvdXJjZS5mZXRjaEJsb2IgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICB2YXIgcmVzb3VyY2UgPSBuZXcgUmVzb3VyY2Uob3B0aW9ucyk7XG4gIHJldHVybiByZXNvdXJjZS5mZXRjaEJsb2IoKTtcbn07XG5cbi8qKlxuICogQXN5bmNocm9ub3VzbHkgbG9hZHMgdGhlIGdpdmVuIGltYWdlIHJlc291cmNlLiAgUmV0dXJucyBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG9cbiAqIGFuIHtAbGluayBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSW1hZ2VCaXRtYXB8SW1hZ2VCaXRtYXB9IGlmIDxjb2RlPnByZWZlckltYWdlQml0bWFwPC9jb2RlPiBpcyB0cnVlIGFuZCB0aGUgYnJvd3NlciBzdXBwb3J0cyA8Y29kZT5jcmVhdGVJbWFnZUJpdG1hcDwvY29kZT4gb3Igb3RoZXJ3aXNlIGFuXG4gKiB7QGxpbmsgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0hUTUxJbWFnZUVsZW1lbnR8SW1hZ2V9IG9uY2UgbG9hZGVkLCBvciByZWplY3QgaWYgdGhlIGltYWdlIGZhaWxlZCB0byBsb2FkLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gQW4gb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzLlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5wcmVmZXJCbG9iPWZhbHNlXSBJZiB0cnVlLCB3ZSB3aWxsIGxvYWQgdGhlIGltYWdlIHZpYSBhIGJsb2IuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLnByZWZlckltYWdlQml0bWFwPWZhbHNlXSBJZiB0cnVlLCBpbWFnZSB3aWxsIGJlIGRlY29kZWQgZHVyaW5nIGZldGNoIGFuZCBhbiA8Y29kZT5JbWFnZUJpdG1hcDwvY29kZT4gaXMgcmV0dXJuZWQuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmZsaXBZPWZhbHNlXSBJZiB0cnVlLCBpbWFnZSB3aWxsIGJlIHZlcnRpY2FsbHkgZmxpcHBlZCBkdXJpbmcgZGVjb2RlLiBPbmx5IGFwcGxpZXMgaWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgPGNvZGU+Y3JlYXRlSW1hZ2VCaXRtYXA8L2NvZGU+LlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5za2lwQ29sb3JTcGFjZUNvbnZlcnNpb249ZmFsc2VdIElmIHRydWUsIGFueSBjdXN0b20gZ2FtbWEgb3IgY29sb3IgcHJvZmlsZXMgaW4gdGhlIGltYWdlIHdpbGwgYmUgaWdub3JlZC4gT25seSBhcHBsaWVzIGlmIHRoZSBicm93c2VyIHN1cHBvcnRzIDxjb2RlPmNyZWF0ZUltYWdlQml0bWFwPC9jb2RlPi5cbiAqIEByZXR1cm5zIHtQcm9taXNlLjxJbWFnZUJpdG1hcD58UHJvbWlzZS48SFRNTEltYWdlRWxlbWVudD58dW5kZWZpbmVkfSBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG8gdGhlIHJlcXVlc3RlZCBkYXRhIHdoZW4gbG9hZGVkLiBSZXR1cm5zIHVuZGVmaW5lZCBpZiA8Y29kZT5yZXF1ZXN0LnRocm90dGxlPC9jb2RlPiBpcyB0cnVlIGFuZCB0aGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIGhpZ2ggZW5vdWdoIHByaW9yaXR5LlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gbG9hZCBhIHNpbmdsZSBpbWFnZSBhc3luY2hyb25vdXNseVxuICogcmVzb3VyY2UuZmV0Y2hJbWFnZSgpLnRoZW4oZnVuY3Rpb24oaW1hZ2UpIHtcbiAqICAgICAvLyB1c2UgdGhlIGxvYWRlZCBpbWFnZVxuICogfSkub3RoZXJ3aXNlKGZ1bmN0aW9uKGVycm9yKSB7XG4gKiAgICAgLy8gYW4gZXJyb3Igb2NjdXJyZWRcbiAqIH0pO1xuICpcbiAqIC8vIGxvYWQgc2V2ZXJhbCBpbWFnZXMgaW4gcGFyYWxsZWxcbiAqIHdoZW4uYWxsKFtyZXNvdXJjZTEuZmV0Y2hJbWFnZSgpLCByZXNvdXJjZTIuZmV0Y2hJbWFnZSgpXSkudGhlbihmdW5jdGlvbihpbWFnZXMpIHtcbiAqICAgICAvLyBpbWFnZXMgaXMgYW4gYXJyYXkgY29udGFpbmluZyBhbGwgdGhlIGxvYWRlZCBpbWFnZXNcbiAqIH0pO1xuICpcbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly93d3cudzMub3JnL1RSL2NvcnMvfENyb3NzLU9yaWdpbiBSZXNvdXJjZSBTaGFyaW5nfVxuICogQHNlZSB7QGxpbmsgaHR0cDovL3dpa2kuY29tbW9uanMub3JnL3dpa2kvUHJvbWlzZXMvQXxDb21tb25KUyBQcm9taXNlcy9BfVxuICovXG5SZXNvdXJjZS5wcm90b3R5cGUuZmV0Y2hJbWFnZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBkZWZhdWx0VmFsdWUob3B0aW9ucywgZGVmYXVsdFZhbHVlLkVNUFRZX09CSkVDVCk7XG4gIHZhciBwcmVmZXJJbWFnZUJpdG1hcCA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLnByZWZlckltYWdlQml0bWFwLCBmYWxzZSk7XG4gIHZhciBwcmVmZXJCbG9iID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMucHJlZmVyQmxvYiwgZmFsc2UpO1xuICB2YXIgZmxpcFkgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5mbGlwWSwgZmFsc2UpO1xuICB2YXIgc2tpcENvbG9yU3BhY2VDb252ZXJzaW9uID0gZGVmYXVsdFZhbHVlKFxuICAgIG9wdGlvbnMuc2tpcENvbG9yU3BhY2VDb252ZXJzaW9uLFxuICAgIGZhbHNlXG4gICk7XG5cbiAgY2hlY2tBbmRSZXNldFJlcXVlc3QodGhpcy5yZXF1ZXN0KTtcbiAgLy8gV2UgdHJ5IHRvIGxvYWQgdGhlIGltYWdlIG5vcm1hbGx5IGlmXG4gIC8vIDEuIEJsb2JzIGFyZW4ndCBzdXBwb3J0ZWRcbiAgLy8gMi4gSXQncyBhIGRhdGEgVVJJXG4gIC8vIDMuIEl0J3MgYSBibG9iIFVSSVxuICAvLyA0LiBJdCBkb2Vzbid0IGhhdmUgcmVxdWVzdCBoZWFkZXJzIGFuZCB3ZSBwcmVmZXJCbG9iIGlzIGZhbHNlXG4gIGlmIChcbiAgICAheGhyQmxvYlN1cHBvcnRlZCB8fFxuICAgIHRoaXMuaXNEYXRhVXJpIHx8XG4gICAgdGhpcy5pc0Jsb2JVcmkgfHxcbiAgICAoIXRoaXMuaGFzSGVhZGVycyAmJiAhcHJlZmVyQmxvYilcbiAgKSB7XG4gICAgcmV0dXJuIGZldGNoSW1hZ2Uoe1xuICAgICAgcmVzb3VyY2U6IHRoaXMsXG4gICAgICBmbGlwWTogZmxpcFksXG4gICAgICBza2lwQ29sb3JTcGFjZUNvbnZlcnNpb246IHNraXBDb2xvclNwYWNlQ29udmVyc2lvbixcbiAgICAgIHByZWZlckltYWdlQml0bWFwOiBwcmVmZXJJbWFnZUJpdG1hcCxcbiAgICB9KTtcbiAgfVxuXG4gIHZhciBibG9iUHJvbWlzZSA9IHRoaXMuZmV0Y2hCbG9iKCk7XG4gIGlmICghZGVmaW5lZChibG9iUHJvbWlzZSkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgc3VwcG9ydHNJbWFnZUJpdG1hcDtcbiAgdmFyIHVzZUltYWdlQml0bWFwO1xuICB2YXIgZ2VuZXJhdGVkQmxvYlJlc291cmNlO1xuICB2YXIgZ2VuZXJhdGVkQmxvYjtcbiAgcmV0dXJuIFJlc291cmNlLnN1cHBvcnRzSW1hZ2VCaXRtYXBPcHRpb25zKClcbiAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICBzdXBwb3J0c0ltYWdlQml0bWFwID0gcmVzdWx0O1xuICAgICAgdXNlSW1hZ2VCaXRtYXAgPSBzdXBwb3J0c0ltYWdlQml0bWFwICYmIHByZWZlckltYWdlQml0bWFwO1xuICAgICAgcmV0dXJuIGJsb2JQcm9taXNlO1xuICAgIH0pXG4gICAgLnRoZW4oZnVuY3Rpb24gKGJsb2IpIHtcbiAgICAgIGlmICghZGVmaW5lZChibG9iKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBnZW5lcmF0ZWRCbG9iID0gYmxvYjtcbiAgICAgIGlmICh1c2VJbWFnZUJpdG1hcCkge1xuICAgICAgICByZXR1cm4gUmVzb3VyY2UuY3JlYXRlSW1hZ2VCaXRtYXBGcm9tQmxvYihibG9iLCB7XG4gICAgICAgICAgZmxpcFk6IGZsaXBZLFxuICAgICAgICAgIHByZW11bHRpcGx5QWxwaGE6IGZhbHNlLFxuICAgICAgICAgIHNraXBDb2xvclNwYWNlQ29udmVyc2lvbjogc2tpcENvbG9yU3BhY2VDb252ZXJzaW9uLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHZhciBibG9iVXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG4gICAgICBnZW5lcmF0ZWRCbG9iUmVzb3VyY2UgPSBuZXcgUmVzb3VyY2Uoe1xuICAgICAgICB1cmw6IGJsb2JVcmwsXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIGZldGNoSW1hZ2Uoe1xuICAgICAgICByZXNvdXJjZTogZ2VuZXJhdGVkQmxvYlJlc291cmNlLFxuICAgICAgICBmbGlwWTogZmxpcFksXG4gICAgICAgIHNraXBDb2xvclNwYWNlQ29udmVyc2lvbjogc2tpcENvbG9yU3BhY2VDb252ZXJzaW9uLFxuICAgICAgICBwcmVmZXJJbWFnZUJpdG1hcDogZmFsc2UsXG4gICAgICB9KTtcbiAgICB9KVxuICAgIC50aGVuKGZ1bmN0aW9uIChpbWFnZSkge1xuICAgICAgaWYgKCFkZWZpbmVkKGltYWdlKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIFRoZSBibG9iIG9iamVjdCBtYXkgYmUgbmVlZGVkIGZvciB1c2UgYnkgYSBUaWxlRGlzY2FyZFBvbGljeSxcbiAgICAgIC8vIHNvIGF0dGFjaCBpdCB0byB0aGUgaW1hZ2UuXG4gICAgICBpbWFnZS5ibG9iID0gZ2VuZXJhdGVkQmxvYjtcblxuICAgICAgaWYgKHVzZUltYWdlQml0bWFwKSB7XG4gICAgICAgIHJldHVybiBpbWFnZTtcbiAgICAgIH1cblxuICAgICAgd2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwoZ2VuZXJhdGVkQmxvYlJlc291cmNlLnVybCk7XG4gICAgICByZXR1cm4gaW1hZ2U7XG4gICAgfSlcbiAgICAub3RoZXJ3aXNlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgaWYgKGRlZmluZWQoZ2VuZXJhdGVkQmxvYlJlc291cmNlKSkge1xuICAgICAgICB3aW5kb3cuVVJMLnJldm9rZU9iamVjdFVSTChnZW5lcmF0ZWRCbG9iUmVzb3VyY2UudXJsKTtcbiAgICAgIH1cblxuICAgICAgLy8gSWYgdGhlIGJsb2IgbG9hZCBzdWNjZWVkZWQgYnV0IHRoZSBpbWFnZSBkZWNvZGUgZmFpbGVkLCBhdHRhY2ggdGhlIGJsb2JcbiAgICAgIC8vIHRvIHRoZSBlcnJvciBvYmplY3QgZm9yIHVzZSBieSBhIFRpbGVEaXNjYXJkUG9saWN5LlxuICAgICAgLy8gSW4gcGFydGljdWxhciwgQmluZ01hcHNJbWFnZXJ5UHJvdmlkZXIgdXNlcyB0aGlzIHRvIGRldGVjdCB0aGVcbiAgICAgIC8vIHplcm8tbGVuZ3RoIHJlc3BvbnNlIHRoYXQgaXMgcmV0dXJuZWQgd2hlbiBhIHRpbGUgaXMgbm90IGF2YWlsYWJsZS5cbiAgICAgIGVycm9yLmJsb2IgPSBnZW5lcmF0ZWRCbG9iO1xuXG4gICAgICByZXR1cm4gd2hlbi5yZWplY3QoZXJyb3IpO1xuICAgIH0pO1xufTtcblxuLyoqXG4gKiBGZXRjaGVzIGFuIGltYWdlIGFuZCByZXR1cm5zIGEgcHJvbWlzZSB0byBpdC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIEFuIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllcy5cbiAqIEBwYXJhbSB7UmVzb3VyY2V9IFtvcHRpb25zLnJlc291cmNlXSBSZXNvdXJjZSBvYmplY3QgdGhhdCBwb2ludHMgdG8gYW4gaW1hZ2UgdG8gZmV0Y2guXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLnByZWZlckltYWdlQml0bWFwXSBJZiB0cnVlLCBpbWFnZSB3aWxsIGJlIGRlY29kZWQgZHVyaW5nIGZldGNoIGFuZCBhbiA8Y29kZT5JbWFnZUJpdG1hcDwvY29kZT4gaXMgcmV0dXJuZWQuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmZsaXBZXSBJZiB0cnVlLCBpbWFnZSB3aWxsIGJlIHZlcnRpY2FsbHkgZmxpcHBlZCBkdXJpbmcgZGVjb2RlLiBPbmx5IGFwcGxpZXMgaWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgPGNvZGU+Y3JlYXRlSW1hZ2VCaXRtYXA8L2NvZGU+LlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5za2lwQ29sb3JTcGFjZUNvbnZlcnNpb249ZmFsc2VdIElmIHRydWUsIGFueSBjdXN0b20gZ2FtbWEgb3IgY29sb3IgcHJvZmlsZXMgaW4gdGhlIGltYWdlIHdpbGwgYmUgaWdub3JlZC4gT25seSBhcHBsaWVzIGlmIHRoZSBicm93c2VyIHN1cHBvcnRzIDxjb2RlPmNyZWF0ZUltYWdlQml0bWFwPC9jb2RlPi5cbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIGZldGNoSW1hZ2Uob3B0aW9ucykge1xuICB2YXIgcmVzb3VyY2UgPSBvcHRpb25zLnJlc291cmNlO1xuICB2YXIgZmxpcFkgPSBvcHRpb25zLmZsaXBZO1xuICB2YXIgc2tpcENvbG9yU3BhY2VDb252ZXJzaW9uID0gb3B0aW9ucy5za2lwQ29sb3JTcGFjZUNvbnZlcnNpb247XG4gIHZhciBwcmVmZXJJbWFnZUJpdG1hcCA9IG9wdGlvbnMucHJlZmVySW1hZ2VCaXRtYXA7XG5cbiAgdmFyIHJlcXVlc3QgPSByZXNvdXJjZS5yZXF1ZXN0O1xuICByZXF1ZXN0LnVybCA9IHJlc291cmNlLnVybDtcbiAgcmVxdWVzdC5yZXF1ZXN0RnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGNyb3NzT3JpZ2luID0gZmFsc2U7XG5cbiAgICAvLyBkYXRhIFVSSXMgY2FuJ3QgaGF2ZSBjcm9zc29yaWdpbiBzZXQuXG4gICAgaWYgKCFyZXNvdXJjZS5pc0RhdGFVcmkgJiYgIXJlc291cmNlLmlzQmxvYlVyaSkge1xuICAgICAgY3Jvc3NPcmlnaW4gPSByZXNvdXJjZS5pc0Nyb3NzT3JpZ2luVXJsO1xuICAgIH1cblxuICAgIHZhciBkZWZlcnJlZCA9IHdoZW4uZGVmZXIoKTtcbiAgICBSZXNvdXJjZS5fSW1wbGVtZW50YXRpb25zLmNyZWF0ZUltYWdlKFxuICAgICAgcmVxdWVzdCxcbiAgICAgIGNyb3NzT3JpZ2luLFxuICAgICAgZGVmZXJyZWQsXG4gICAgICBmbGlwWSxcbiAgICAgIHNraXBDb2xvclNwYWNlQ29udmVyc2lvbixcbiAgICAgIHByZWZlckltYWdlQml0bWFwXG4gICAgKTtcblxuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICB9O1xuXG4gIHZhciBwcm9taXNlID0gUmVxdWVzdFNjaGVkdWxlci5yZXF1ZXN0KHJlcXVlc3QpO1xuICBpZiAoIWRlZmluZWQocHJvbWlzZSkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICByZXR1cm4gcHJvbWlzZS5vdGhlcndpc2UoZnVuY3Rpb24gKGUpIHtcbiAgICAvLyBEb24ndCByZXRyeSBjYW5jZWxsZWQgb3Igb3RoZXJ3aXNlIGFib3J0ZWQgcmVxdWVzdHNcbiAgICBpZiAocmVxdWVzdC5zdGF0ZSAhPT0gUmVxdWVzdFN0YXRlLkZBSUxFRCkge1xuICAgICAgcmV0dXJuIHdoZW4ucmVqZWN0KGUpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzb3VyY2UucmV0cnlPbkVycm9yKGUpLnRoZW4oZnVuY3Rpb24gKHJldHJ5KSB7XG4gICAgICBpZiAocmV0cnkpIHtcbiAgICAgICAgLy8gUmVzZXQgcmVxdWVzdCBzbyBpdCBjYW4gdHJ5IGFnYWluXG4gICAgICAgIHJlcXVlc3Quc3RhdGUgPSBSZXF1ZXN0U3RhdGUuVU5JU1NVRUQ7XG4gICAgICAgIHJlcXVlc3QuZGVmZXJyZWQgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgcmV0dXJuIGZldGNoSW1hZ2Uoe1xuICAgICAgICAgIHJlc291cmNlOiByZXNvdXJjZSxcbiAgICAgICAgICBmbGlwWTogZmxpcFksXG4gICAgICAgICAgc2tpcENvbG9yU3BhY2VDb252ZXJzaW9uOiBza2lwQ29sb3JTcGFjZUNvbnZlcnNpb24sXG4gICAgICAgICAgcHJlZmVySW1hZ2VCaXRtYXA6IHByZWZlckltYWdlQml0bWFwLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB3aGVuLnJlamVjdChlKTtcbiAgICB9KTtcbiAgfSk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIFJlc291cmNlIGFuZCBjYWxscyBmZXRjaEltYWdlKCkgb24gaXQuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd8T2JqZWN0fSBvcHRpb25zIEEgdXJsIG9yIGFuIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllc1xuICogQHBhcmFtIHtTdHJpbmd9IG9wdGlvbnMudXJsIFRoZSB1cmwgb2YgdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLnF1ZXJ5UGFyYW1ldGVyc10gQW4gb2JqZWN0IGNvbnRhaW5pbmcgcXVlcnkgcGFyYW1ldGVycyB0aGF0IHdpbGwgYmUgc2VudCB3aGVuIHJldHJpZXZpbmcgdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLnRlbXBsYXRlVmFsdWVzXSBLZXkvVmFsdWUgcGFpcnMgdGhhdCBhcmUgdXNlZCB0byByZXBsYWNlIHRlbXBsYXRlIHZhbHVlcyAoZWcuIHt4fSkuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMuaGVhZGVycz17fV0gQWRkaXRpb25hbCBIVFRQIGhlYWRlcnMgdGhhdCB3aWxsIGJlIHNlbnQuXG4gKiBAcGFyYW0ge1Byb3h5fSBbb3B0aW9ucy5wcm94eV0gQSBwcm94eSB0byBiZSB1c2VkIHdoZW4gbG9hZGluZyB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmZsaXBZPWZhbHNlXSBXaGV0aGVyIHRvIHZlcnRpY2FsbHkgZmxpcCB0aGUgaW1hZ2UgZHVyaW5nIGZldGNoIGFuZCBkZWNvZGUuIE9ubHkgYXBwbGllcyB3aGVuIHJlcXVlc3RpbmcgYW4gaW1hZ2UgYW5kIHRoZSBicm93c2VyIHN1cHBvcnRzIDxjb2RlPmNyZWF0ZUltYWdlQml0bWFwPC9jb2RlPi5cbiAqIEBwYXJhbSB7UmVzb3VyY2UuUmV0cnlDYWxsYmFja30gW29wdGlvbnMucmV0cnlDYWxsYmFja10gVGhlIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiBhIHJlcXVlc3QgZm9yIHRoaXMgcmVzb3VyY2UgZmFpbHMuIElmIGl0IHJldHVybnMgdHJ1ZSwgdGhlIHJlcXVlc3Qgd2lsbCBiZSByZXRyaWVkLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLnJldHJ5QXR0ZW1wdHM9MF0gVGhlIG51bWJlciBvZiB0aW1lcyB0aGUgcmV0cnlDYWxsYmFjayBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBnaXZpbmcgdXAuXG4gKiBAcGFyYW0ge1JlcXVlc3R9IFtvcHRpb25zLnJlcXVlc3RdIEEgUmVxdWVzdCBvYmplY3QgdGhhdCB3aWxsIGJlIHVzZWQuIEludGVuZGVkIGZvciBpbnRlcm5hbCB1c2Ugb25seS5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMucHJlZmVyQmxvYj1mYWxzZV0gIElmIHRydWUsIHdlIHdpbGwgbG9hZCB0aGUgaW1hZ2UgdmlhIGEgYmxvYi5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMucHJlZmVySW1hZ2VCaXRtYXA9ZmFsc2VdIElmIHRydWUsIGltYWdlIHdpbGwgYmUgZGVjb2RlZCBkdXJpbmcgZmV0Y2ggYW5kIGFuIDxjb2RlPkltYWdlQml0bWFwPC9jb2RlPiBpcyByZXR1cm5lZC5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuc2tpcENvbG9yU3BhY2VDb252ZXJzaW9uPWZhbHNlXSBJZiB0cnVlLCBhbnkgY3VzdG9tIGdhbW1hIG9yIGNvbG9yIHByb2ZpbGVzIGluIHRoZSBpbWFnZSB3aWxsIGJlIGlnbm9yZWQuIE9ubHkgYXBwbGllcyB3aGVuIHJlcXVlc3RpbmcgYW4gaW1hZ2UgYW5kIHRoZSBicm93c2VyIHN1cHBvcnRzIDxjb2RlPmNyZWF0ZUltYWdlQml0bWFwPC9jb2RlPi5cbiAqIEByZXR1cm5zIHtQcm9taXNlLjxJbWFnZUJpdG1hcD58UHJvbWlzZS48SFRNTEltYWdlRWxlbWVudD58dW5kZWZpbmVkfSBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG8gdGhlIHJlcXVlc3RlZCBkYXRhIHdoZW4gbG9hZGVkLiBSZXR1cm5zIHVuZGVmaW5lZCBpZiA8Y29kZT5yZXF1ZXN0LnRocm90dGxlPC9jb2RlPiBpcyB0cnVlIGFuZCB0aGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIGhpZ2ggZW5vdWdoIHByaW9yaXR5LlxuICovXG5SZXNvdXJjZS5mZXRjaEltYWdlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgdmFyIHJlc291cmNlID0gbmV3IFJlc291cmNlKG9wdGlvbnMpO1xuICByZXR1cm4gcmVzb3VyY2UuZmV0Y2hJbWFnZSh7XG4gICAgZmxpcFk6IG9wdGlvbnMuZmxpcFksXG4gICAgc2tpcENvbG9yU3BhY2VDb252ZXJzaW9uOiBvcHRpb25zLnNraXBDb2xvclNwYWNlQ29udmVyc2lvbixcbiAgICBwcmVmZXJCbG9iOiBvcHRpb25zLnByZWZlckJsb2IsXG4gICAgcHJlZmVySW1hZ2VCaXRtYXA6IG9wdGlvbnMucHJlZmVySW1hZ2VCaXRtYXAsXG4gIH0pO1xufTtcblxuLyoqXG4gKiBBc3luY2hyb25vdXNseSBsb2FkcyB0aGUgZ2l2ZW4gcmVzb3VyY2UgYXMgdGV4dC4gIFJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHRvXG4gKiBhIFN0cmluZyBvbmNlIGxvYWRlZCwgb3IgcmVqZWN0IGlmIHRoZSByZXNvdXJjZSBmYWlsZWQgdG8gbG9hZC4gIFRoZSBkYXRhIGlzIGxvYWRlZFxuICogdXNpbmcgWE1MSHR0cFJlcXVlc3QsIHdoaWNoIG1lYW5zIHRoYXQgaW4gb3JkZXIgdG8gbWFrZSByZXF1ZXN0cyB0byBhbm90aGVyIG9yaWdpbixcbiAqIHRoZSBzZXJ2ZXIgbXVzdCBoYXZlIENyb3NzLU9yaWdpbiBSZXNvdXJjZSBTaGFyaW5nIChDT1JTKSBoZWFkZXJzIGVuYWJsZWQuXG4gKlxuICogQHJldHVybnMge1Byb21pc2UuPFN0cmluZz58dW5kZWZpbmVkfSBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG8gdGhlIHJlcXVlc3RlZCBkYXRhIHdoZW4gbG9hZGVkLiBSZXR1cm5zIHVuZGVmaW5lZCBpZiA8Y29kZT5yZXF1ZXN0LnRocm90dGxlPC9jb2RlPiBpcyB0cnVlIGFuZCB0aGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIGhpZ2ggZW5vdWdoIHByaW9yaXR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBsb2FkIHRleHQgZnJvbSBhIFVSTCwgc2V0dGluZyBhIGN1c3RvbSBoZWFkZXJcbiAqIHZhciByZXNvdXJjZSA9IG5ldyBSZXNvdXJjZSh7XG4gKiAgIHVybDogJ2h0dHA6Ly9zb21lVXJsLmNvbS9zb21lSnNvbi50eHQnLFxuICogICBoZWFkZXJzOiB7XG4gKiAgICAgJ1gtQ3VzdG9tLUhlYWRlcicgOiAnc29tZSB2YWx1ZSdcbiAqICAgfVxuICogfSk7XG4gKiByZXNvdXJjZS5mZXRjaFRleHQoKS50aGVuKGZ1bmN0aW9uKHRleHQpIHtcbiAqICAgICAvLyBEbyBzb21ldGhpbmcgd2l0aCB0aGUgdGV4dFxuICogfSkub3RoZXJ3aXNlKGZ1bmN0aW9uKGVycm9yKSB7XG4gKiAgICAgLy8gYW4gZXJyb3Igb2NjdXJyZWRcbiAqIH0pO1xuICpcbiAqIEBzZWUge0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9YTUxIdHRwUmVxdWVzdHxYTUxIdHRwUmVxdWVzdH1cbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly93d3cudzMub3JnL1RSL2NvcnMvfENyb3NzLU9yaWdpbiBSZXNvdXJjZSBTaGFyaW5nfVxuICogQHNlZSB7QGxpbmsgaHR0cDovL3dpa2kuY29tbW9uanMub3JnL3dpa2kvUHJvbWlzZXMvQXxDb21tb25KUyBQcm9taXNlcy9BfVxuICovXG5SZXNvdXJjZS5wcm90b3R5cGUuZmV0Y2hUZXh0ID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5mZXRjaCh7XG4gICAgcmVzcG9uc2VUeXBlOiBcInRleHRcIixcbiAgfSk7XG59O1xuXG4vKipcbiAqIENyZWF0ZXMgYSBSZXNvdXJjZSBhbmQgY2FsbHMgZmV0Y2hUZXh0KCkgb24gaXQuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd8T2JqZWN0fSBvcHRpb25zIEEgdXJsIG9yIGFuIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllc1xuICogQHBhcmFtIHtTdHJpbmd9IG9wdGlvbnMudXJsIFRoZSB1cmwgb2YgdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLnF1ZXJ5UGFyYW1ldGVyc10gQW4gb2JqZWN0IGNvbnRhaW5pbmcgcXVlcnkgcGFyYW1ldGVycyB0aGF0IHdpbGwgYmUgc2VudCB3aGVuIHJldHJpZXZpbmcgdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLnRlbXBsYXRlVmFsdWVzXSBLZXkvVmFsdWUgcGFpcnMgdGhhdCBhcmUgdXNlZCB0byByZXBsYWNlIHRlbXBsYXRlIHZhbHVlcyAoZWcuIHt4fSkuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMuaGVhZGVycz17fV0gQWRkaXRpb25hbCBIVFRQIGhlYWRlcnMgdGhhdCB3aWxsIGJlIHNlbnQuXG4gKiBAcGFyYW0ge1Byb3h5fSBbb3B0aW9ucy5wcm94eV0gQSBwcm94eSB0byBiZSB1c2VkIHdoZW4gbG9hZGluZyB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge1Jlc291cmNlLlJldHJ5Q2FsbGJhY2t9IFtvcHRpb25zLnJldHJ5Q2FsbGJhY2tdIFRoZSBGdW5jdGlvbiB0byBjYWxsIHdoZW4gYSByZXF1ZXN0IGZvciB0aGlzIHJlc291cmNlIGZhaWxzLiBJZiBpdCByZXR1cm5zIHRydWUsIHRoZSByZXF1ZXN0IHdpbGwgYmUgcmV0cmllZC5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5yZXRyeUF0dGVtcHRzPTBdIFRoZSBudW1iZXIgb2YgdGltZXMgdGhlIHJldHJ5Q2FsbGJhY2sgc2hvdWxkIGJlIGNhbGxlZCBiZWZvcmUgZ2l2aW5nIHVwLlxuICogQHBhcmFtIHtSZXF1ZXN0fSBbb3B0aW9ucy5yZXF1ZXN0XSBBIFJlcXVlc3Qgb2JqZWN0IHRoYXQgd2lsbCBiZSB1c2VkLiBJbnRlbmRlZCBmb3IgaW50ZXJuYWwgdXNlIG9ubHkuXG4gKiBAcmV0dXJucyB7UHJvbWlzZS48U3RyaW5nPnx1bmRlZmluZWR9IGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB0byB0aGUgcmVxdWVzdGVkIGRhdGEgd2hlbiBsb2FkZWQuIFJldHVybnMgdW5kZWZpbmVkIGlmIDxjb2RlPnJlcXVlc3QudGhyb3R0bGU8L2NvZGU+IGlzIHRydWUgYW5kIHRoZSByZXF1ZXN0IGRvZXMgbm90IGhhdmUgaGlnaCBlbm91Z2ggcHJpb3JpdHkuXG4gKi9cblJlc291cmNlLmZldGNoVGV4dCA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gIHZhciByZXNvdXJjZSA9IG5ldyBSZXNvdXJjZShvcHRpb25zKTtcbiAgcmV0dXJuIHJlc291cmNlLmZldGNoVGV4dCgpO1xufTtcblxuLy8gbm90ZTogJiM0MjsmIzQ3OyYjNDI7IGJlbG93IGlzICovKiBidXQgdGhhdCBlbmRzIHRoZSBjb21tZW50IGJsb2NrIGVhcmx5XG4vKipcbiAqIEFzeW5jaHJvbm91c2x5IGxvYWRzIHRoZSBnaXZlbiByZXNvdXJjZSBhcyBKU09OLiAgUmV0dXJucyBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG9cbiAqIGEgSlNPTiBvYmplY3Qgb25jZSBsb2FkZWQsIG9yIHJlamVjdCBpZiB0aGUgcmVzb3VyY2UgZmFpbGVkIHRvIGxvYWQuICBUaGUgZGF0YSBpcyBsb2FkZWRcbiAqIHVzaW5nIFhNTEh0dHBSZXF1ZXN0LCB3aGljaCBtZWFucyB0aGF0IGluIG9yZGVyIHRvIG1ha2UgcmVxdWVzdHMgdG8gYW5vdGhlciBvcmlnaW4sXG4gKiB0aGUgc2VydmVyIG11c3QgaGF2ZSBDcm9zcy1PcmlnaW4gUmVzb3VyY2UgU2hhcmluZyAoQ09SUykgaGVhZGVycyBlbmFibGVkLiBUaGlzIGZ1bmN0aW9uXG4gKiBhZGRzICdBY2NlcHQ6IGFwcGxpY2F0aW9uL2pzb24sJiM0MjsmIzQ3OyYjNDI7O3E9MC4wMScgdG8gdGhlIHJlcXVlc3QgaGVhZGVycywgaWYgbm90XG4gKiBhbHJlYWR5IHNwZWNpZmllZC5cbiAqXG4gKiBAcmV0dXJucyB7UHJvbWlzZS48Kj58dW5kZWZpbmVkfSBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG8gdGhlIHJlcXVlc3RlZCBkYXRhIHdoZW4gbG9hZGVkLiBSZXR1cm5zIHVuZGVmaW5lZCBpZiA8Y29kZT5yZXF1ZXN0LnRocm90dGxlPC9jb2RlPiBpcyB0cnVlIGFuZCB0aGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIGhpZ2ggZW5vdWdoIHByaW9yaXR5LlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogcmVzb3VyY2UuZmV0Y2hKc29uKCkudGhlbihmdW5jdGlvbihqc29uRGF0YSkge1xuICogICAgIC8vIERvIHNvbWV0aGluZyB3aXRoIHRoZSBKU09OIG9iamVjdFxuICogfSkub3RoZXJ3aXNlKGZ1bmN0aW9uKGVycm9yKSB7XG4gKiAgICAgLy8gYW4gZXJyb3Igb2NjdXJyZWRcbiAqIH0pO1xuICpcbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly93d3cudzMub3JnL1RSL2NvcnMvfENyb3NzLU9yaWdpbiBSZXNvdXJjZSBTaGFyaW5nfVxuICogQHNlZSB7QGxpbmsgaHR0cDovL3dpa2kuY29tbW9uanMub3JnL3dpa2kvUHJvbWlzZXMvQXxDb21tb25KUyBQcm9taXNlcy9BfVxuICovXG5SZXNvdXJjZS5wcm90b3R5cGUuZmV0Y2hKc29uID0gZnVuY3Rpb24gKCkge1xuICB2YXIgcHJvbWlzZSA9IHRoaXMuZmV0Y2goe1xuICAgIHJlc3BvbnNlVHlwZTogXCJ0ZXh0XCIsXG4gICAgaGVhZGVyczoge1xuICAgICAgQWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb24sKi8qO3E9MC4wMVwiLFxuICAgIH0sXG4gIH0pO1xuXG4gIGlmICghZGVmaW5lZChwcm9taXNlKSkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIGlmICghZGVmaW5lZCh2YWx1ZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmV0dXJuIEpTT04ucGFyc2UodmFsdWUpO1xuICB9KTtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIFJlc291cmNlIGFuZCBjYWxscyBmZXRjaEpzb24oKSBvbiBpdC5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ3xPYmplY3R9IG9wdGlvbnMgQSB1cmwgb3IgYW4gb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzXG4gKiBAcGFyYW0ge1N0cmluZ30gb3B0aW9ucy51cmwgVGhlIHVybCBvZiB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMucXVlcnlQYXJhbWV0ZXJzXSBBbiBvYmplY3QgY29udGFpbmluZyBxdWVyeSBwYXJhbWV0ZXJzIHRoYXQgd2lsbCBiZSBzZW50IHdoZW4gcmV0cmlldmluZyB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMudGVtcGxhdGVWYWx1ZXNdIEtleS9WYWx1ZSBwYWlycyB0aGF0IGFyZSB1c2VkIHRvIHJlcGxhY2UgdGVtcGxhdGUgdmFsdWVzIChlZy4ge3h9KS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5oZWFkZXJzPXt9XSBBZGRpdGlvbmFsIEhUVFAgaGVhZGVycyB0aGF0IHdpbGwgYmUgc2VudC5cbiAqIEBwYXJhbSB7UHJveHl9IFtvcHRpb25zLnByb3h5XSBBIHByb3h5IHRvIGJlIHVzZWQgd2hlbiBsb2FkaW5nIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7UmVzb3VyY2UuUmV0cnlDYWxsYmFja30gW29wdGlvbnMucmV0cnlDYWxsYmFja10gVGhlIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiBhIHJlcXVlc3QgZm9yIHRoaXMgcmVzb3VyY2UgZmFpbHMuIElmIGl0IHJldHVybnMgdHJ1ZSwgdGhlIHJlcXVlc3Qgd2lsbCBiZSByZXRyaWVkLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLnJldHJ5QXR0ZW1wdHM9MF0gVGhlIG51bWJlciBvZiB0aW1lcyB0aGUgcmV0cnlDYWxsYmFjayBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBnaXZpbmcgdXAuXG4gKiBAcGFyYW0ge1JlcXVlc3R9IFtvcHRpb25zLnJlcXVlc3RdIEEgUmVxdWVzdCBvYmplY3QgdGhhdCB3aWxsIGJlIHVzZWQuIEludGVuZGVkIGZvciBpbnRlcm5hbCB1c2Ugb25seS5cbiAqIEByZXR1cm5zIHtQcm9taXNlLjwqPnx1bmRlZmluZWR9IGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB0byB0aGUgcmVxdWVzdGVkIGRhdGEgd2hlbiBsb2FkZWQuIFJldHVybnMgdW5kZWZpbmVkIGlmIDxjb2RlPnJlcXVlc3QudGhyb3R0bGU8L2NvZGU+IGlzIHRydWUgYW5kIHRoZSByZXF1ZXN0IGRvZXMgbm90IGhhdmUgaGlnaCBlbm91Z2ggcHJpb3JpdHkuXG4gKi9cblJlc291cmNlLmZldGNoSnNvbiA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gIHZhciByZXNvdXJjZSA9IG5ldyBSZXNvdXJjZShvcHRpb25zKTtcbiAgcmV0dXJuIHJlc291cmNlLmZldGNoSnNvbigpO1xufTtcblxuLyoqXG4gKiBBc3luY2hyb25vdXNseSBsb2FkcyB0aGUgZ2l2ZW4gcmVzb3VyY2UgYXMgWE1MLiAgUmV0dXJucyBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG9cbiAqIGFuIFhNTCBEb2N1bWVudCBvbmNlIGxvYWRlZCwgb3IgcmVqZWN0IGlmIHRoZSByZXNvdXJjZSBmYWlsZWQgdG8gbG9hZC4gIFRoZSBkYXRhIGlzIGxvYWRlZFxuICogdXNpbmcgWE1MSHR0cFJlcXVlc3QsIHdoaWNoIG1lYW5zIHRoYXQgaW4gb3JkZXIgdG8gbWFrZSByZXF1ZXN0cyB0byBhbm90aGVyIG9yaWdpbixcbiAqIHRoZSBzZXJ2ZXIgbXVzdCBoYXZlIENyb3NzLU9yaWdpbiBSZXNvdXJjZSBTaGFyaW5nIChDT1JTKSBoZWFkZXJzIGVuYWJsZWQuXG4gKlxuICogQHJldHVybnMge1Byb21pc2UuPFhNTERvY3VtZW50Pnx1bmRlZmluZWR9IGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB0byB0aGUgcmVxdWVzdGVkIGRhdGEgd2hlbiBsb2FkZWQuIFJldHVybnMgdW5kZWZpbmVkIGlmIDxjb2RlPnJlcXVlc3QudGhyb3R0bGU8L2NvZGU+IGlzIHRydWUgYW5kIHRoZSByZXF1ZXN0IGRvZXMgbm90IGhhdmUgaGlnaCBlbm91Z2ggcHJpb3JpdHkuXG4gKlxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBsb2FkIFhNTCBmcm9tIGEgVVJMLCBzZXR0aW5nIGEgY3VzdG9tIGhlYWRlclxuICogQ2VzaXVtLmxvYWRYTUwoJ2h0dHA6Ly9zb21lVXJsLmNvbS9zb21lWE1MLnhtbCcsIHtcbiAqICAgJ1gtQ3VzdG9tLUhlYWRlcicgOiAnc29tZSB2YWx1ZSdcbiAqIH0pLnRoZW4oZnVuY3Rpb24oZG9jdW1lbnQpIHtcbiAqICAgICAvLyBEbyBzb21ldGhpbmcgd2l0aCB0aGUgZG9jdW1lbnRcbiAqIH0pLm90aGVyd2lzZShmdW5jdGlvbihlcnJvcikge1xuICogICAgIC8vIGFuIGVycm9yIG9jY3VycmVkXG4gKiB9KTtcbiAqXG4gKiBAc2VlIHtAbGluayBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvWE1MSHR0cFJlcXVlc3R8WE1MSHR0cFJlcXVlc3R9XG4gKiBAc2VlIHtAbGluayBodHRwOi8vd3d3LnczLm9yZy9UUi9jb3JzL3xDcm9zcy1PcmlnaW4gUmVzb3VyY2UgU2hhcmluZ31cbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly93aWtpLmNvbW1vbmpzLm9yZy93aWtpL1Byb21pc2VzL0F8Q29tbW9uSlMgUHJvbWlzZXMvQX1cbiAqL1xuUmVzb3VyY2UucHJvdG90eXBlLmZldGNoWE1MID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5mZXRjaCh7XG4gICAgcmVzcG9uc2VUeXBlOiBcImRvY3VtZW50XCIsXG4gICAgb3ZlcnJpZGVNaW1lVHlwZTogXCJ0ZXh0L3htbFwiLFxuICB9KTtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIFJlc291cmNlIGFuZCBjYWxscyBmZXRjaFhNTCgpIG9uIGl0LlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfE9iamVjdH0gb3B0aW9ucyBBIHVybCBvciBhbiBvYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXNcbiAqIEBwYXJhbSB7U3RyaW5nfSBvcHRpb25zLnVybCBUaGUgdXJsIG9mIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5xdWVyeVBhcmFtZXRlcnNdIEFuIG9iamVjdCBjb250YWluaW5nIHF1ZXJ5IHBhcmFtZXRlcnMgdGhhdCB3aWxsIGJlIHNlbnQgd2hlbiByZXRyaWV2aW5nIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy50ZW1wbGF0ZVZhbHVlc10gS2V5L1ZhbHVlIHBhaXJzIHRoYXQgYXJlIHVzZWQgdG8gcmVwbGFjZSB0ZW1wbGF0ZSB2YWx1ZXMgKGVnLiB7eH0pLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLmhlYWRlcnM9e31dIEFkZGl0aW9uYWwgSFRUUCBoZWFkZXJzIHRoYXQgd2lsbCBiZSBzZW50LlxuICogQHBhcmFtIHtQcm94eX0gW29wdGlvbnMucHJveHldIEEgcHJveHkgdG8gYmUgdXNlZCB3aGVuIGxvYWRpbmcgdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtSZXNvdXJjZS5SZXRyeUNhbGxiYWNrfSBbb3B0aW9ucy5yZXRyeUNhbGxiYWNrXSBUaGUgRnVuY3Rpb24gdG8gY2FsbCB3aGVuIGEgcmVxdWVzdCBmb3IgdGhpcyByZXNvdXJjZSBmYWlscy4gSWYgaXQgcmV0dXJucyB0cnVlLCB0aGUgcmVxdWVzdCB3aWxsIGJlIHJldHJpZWQuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMucmV0cnlBdHRlbXB0cz0wXSBUaGUgbnVtYmVyIG9mIHRpbWVzIHRoZSByZXRyeUNhbGxiYWNrIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGdpdmluZyB1cC5cbiAqIEBwYXJhbSB7UmVxdWVzdH0gW29wdGlvbnMucmVxdWVzdF0gQSBSZXF1ZXN0IG9iamVjdCB0aGF0IHdpbGwgYmUgdXNlZC4gSW50ZW5kZWQgZm9yIGludGVybmFsIHVzZSBvbmx5LlxuICogQHJldHVybnMge1Byb21pc2UuPFhNTERvY3VtZW50Pnx1bmRlZmluZWR9IGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB0byB0aGUgcmVxdWVzdGVkIGRhdGEgd2hlbiBsb2FkZWQuIFJldHVybnMgdW5kZWZpbmVkIGlmIDxjb2RlPnJlcXVlc3QudGhyb3R0bGU8L2NvZGU+IGlzIHRydWUgYW5kIHRoZSByZXF1ZXN0IGRvZXMgbm90IGhhdmUgaGlnaCBlbm91Z2ggcHJpb3JpdHkuXG4gKi9cblJlc291cmNlLmZldGNoWE1MID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgdmFyIHJlc291cmNlID0gbmV3IFJlc291cmNlKG9wdGlvbnMpO1xuICByZXR1cm4gcmVzb3VyY2UuZmV0Y2hYTUwoKTtcbn07XG5cbi8qKlxuICogUmVxdWVzdHMgYSByZXNvdXJjZSB1c2luZyBKU09OUC5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gW2NhbGxiYWNrUGFyYW1ldGVyTmFtZT0nY2FsbGJhY2snXSBUaGUgY2FsbGJhY2sgcGFyYW1ldGVyIG5hbWUgdGhhdCB0aGUgc2VydmVyIGV4cGVjdHMuXG4gKiBAcmV0dXJucyB7UHJvbWlzZS48Kj58dW5kZWZpbmVkfSBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG8gdGhlIHJlcXVlc3RlZCBkYXRhIHdoZW4gbG9hZGVkLiBSZXR1cm5zIHVuZGVmaW5lZCBpZiA8Y29kZT5yZXF1ZXN0LnRocm90dGxlPC9jb2RlPiBpcyB0cnVlIGFuZCB0aGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIGhpZ2ggZW5vdWdoIHByaW9yaXR5LlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gbG9hZCBhIGRhdGEgYXN5bmNocm9ub3VzbHlcbiAqIHJlc291cmNlLmZldGNoSnNvbnAoKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAqICAgICAvLyB1c2UgdGhlIGxvYWRlZCBkYXRhXG4gKiB9KS5vdGhlcndpc2UoZnVuY3Rpb24oZXJyb3IpIHtcbiAqICAgICAvLyBhbiBlcnJvciBvY2N1cnJlZFxuICogfSk7XG4gKlxuICogQHNlZSB7QGxpbmsgaHR0cDovL3dpa2kuY29tbW9uanMub3JnL3dpa2kvUHJvbWlzZXMvQXxDb21tb25KUyBQcm9taXNlcy9BfVxuICovXG5SZXNvdXJjZS5wcm90b3R5cGUuZmV0Y2hKc29ucCA9IGZ1bmN0aW9uIChjYWxsYmFja1BhcmFtZXRlck5hbWUpIHtcbiAgY2FsbGJhY2tQYXJhbWV0ZXJOYW1lID0gZGVmYXVsdFZhbHVlKGNhbGxiYWNrUGFyYW1ldGVyTmFtZSwgXCJjYWxsYmFja1wiKTtcblxuICBjaGVja0FuZFJlc2V0UmVxdWVzdCh0aGlzLnJlcXVlc3QpO1xuXG4gIC8vZ2VuZXJhdGUgYSB1bmlxdWUgZnVuY3Rpb24gbmFtZVxuICB2YXIgZnVuY3Rpb25OYW1lO1xuICBkbyB7XG4gICAgZnVuY3Rpb25OYW1lID1cbiAgICAgIFwibG9hZEpzb25wXCIgKyBDZXNpdW1NYXRoLm5leHRSYW5kb21OdW1iZXIoKS50b1N0cmluZygpLnN1YnN0cmluZygyLCA4KTtcbiAgfSB3aGlsZSAoZGVmaW5lZCh3aW5kb3dbZnVuY3Rpb25OYW1lXSkpO1xuXG4gIHJldHVybiBmZXRjaEpzb25wKHRoaXMsIGNhbGxiYWNrUGFyYW1ldGVyTmFtZSwgZnVuY3Rpb25OYW1lKTtcbn07XG5cbmZ1bmN0aW9uIGZldGNoSnNvbnAocmVzb3VyY2UsIGNhbGxiYWNrUGFyYW1ldGVyTmFtZSwgZnVuY3Rpb25OYW1lKSB7XG4gIHZhciBjYWxsYmFja1F1ZXJ5ID0ge307XG4gIGNhbGxiYWNrUXVlcnlbY2FsbGJhY2tQYXJhbWV0ZXJOYW1lXSA9IGZ1bmN0aW9uTmFtZTtcbiAgcmVzb3VyY2Uuc2V0UXVlcnlQYXJhbWV0ZXJzKGNhbGxiYWNrUXVlcnkpO1xuXG4gIHZhciByZXF1ZXN0ID0gcmVzb3VyY2UucmVxdWVzdDtcbiAgcmVxdWVzdC51cmwgPSByZXNvdXJjZS51cmw7XG4gIHJlcXVlc3QucmVxdWVzdEZ1bmN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBkZWZlcnJlZCA9IHdoZW4uZGVmZXIoKTtcblxuICAgIC8vYXNzaWduIGEgZnVuY3Rpb24gd2l0aCB0aGF0IG5hbWUgaW4gdGhlIGdsb2JhbCBzY29wZVxuICAgIHdpbmRvd1tmdW5jdGlvbk5hbWVdID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgIGRlZmVycmVkLnJlc29sdmUoZGF0YSk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGRlbGV0ZSB3aW5kb3dbZnVuY3Rpb25OYW1lXTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgd2luZG93W2Z1bmN0aW9uTmFtZV0gPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfTtcblxuICAgIFJlc291cmNlLl9JbXBsZW1lbnRhdGlvbnMubG9hZEFuZEV4ZWN1dGVTY3JpcHQoXG4gICAgICByZXNvdXJjZS51cmwsXG4gICAgICBmdW5jdGlvbk5hbWUsXG4gICAgICBkZWZlcnJlZFxuICAgICk7XG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gIH07XG5cbiAgdmFyIHByb21pc2UgPSBSZXF1ZXN0U2NoZWR1bGVyLnJlcXVlc3QocmVxdWVzdCk7XG4gIGlmICghZGVmaW5lZChwcm9taXNlKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHJldHVybiBwcm9taXNlLm90aGVyd2lzZShmdW5jdGlvbiAoZSkge1xuICAgIGlmIChyZXF1ZXN0LnN0YXRlICE9PSBSZXF1ZXN0U3RhdGUuRkFJTEVEKSB7XG4gICAgICByZXR1cm4gd2hlbi5yZWplY3QoZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc291cmNlLnJldHJ5T25FcnJvcihlKS50aGVuKGZ1bmN0aW9uIChyZXRyeSkge1xuICAgICAgaWYgKHJldHJ5KSB7XG4gICAgICAgIC8vIFJlc2V0IHJlcXVlc3Qgc28gaXQgY2FuIHRyeSBhZ2FpblxuICAgICAgICByZXF1ZXN0LnN0YXRlID0gUmVxdWVzdFN0YXRlLlVOSVNTVUVEO1xuICAgICAgICByZXF1ZXN0LmRlZmVycmVkID0gdW5kZWZpbmVkO1xuXG4gICAgICAgIHJldHVybiBmZXRjaEpzb25wKHJlc291cmNlLCBjYWxsYmFja1BhcmFtZXRlck5hbWUsIGZ1bmN0aW9uTmFtZSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB3aGVuLnJlamVjdChlKTtcbiAgICB9KTtcbiAgfSk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIFJlc291cmNlIGZyb20gYSBVUkwgYW5kIGNhbGxzIGZldGNoSnNvbnAoKSBvbiBpdC5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ3xPYmplY3R9IG9wdGlvbnMgQSB1cmwgb3IgYW4gb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzXG4gKiBAcGFyYW0ge1N0cmluZ30gb3B0aW9ucy51cmwgVGhlIHVybCBvZiB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMucXVlcnlQYXJhbWV0ZXJzXSBBbiBvYmplY3QgY29udGFpbmluZyBxdWVyeSBwYXJhbWV0ZXJzIHRoYXQgd2lsbCBiZSBzZW50IHdoZW4gcmV0cmlldmluZyB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMudGVtcGxhdGVWYWx1ZXNdIEtleS9WYWx1ZSBwYWlycyB0aGF0IGFyZSB1c2VkIHRvIHJlcGxhY2UgdGVtcGxhdGUgdmFsdWVzIChlZy4ge3h9KS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5oZWFkZXJzPXt9XSBBZGRpdGlvbmFsIEhUVFAgaGVhZGVycyB0aGF0IHdpbGwgYmUgc2VudC5cbiAqIEBwYXJhbSB7UHJveHl9IFtvcHRpb25zLnByb3h5XSBBIHByb3h5IHRvIGJlIHVzZWQgd2hlbiBsb2FkaW5nIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7UmVzb3VyY2UuUmV0cnlDYWxsYmFja30gW29wdGlvbnMucmV0cnlDYWxsYmFja10gVGhlIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiBhIHJlcXVlc3QgZm9yIHRoaXMgcmVzb3VyY2UgZmFpbHMuIElmIGl0IHJldHVybnMgdHJ1ZSwgdGhlIHJlcXVlc3Qgd2lsbCBiZSByZXRyaWVkLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLnJldHJ5QXR0ZW1wdHM9MF0gVGhlIG51bWJlciBvZiB0aW1lcyB0aGUgcmV0cnlDYWxsYmFjayBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBnaXZpbmcgdXAuXG4gKiBAcGFyYW0ge1JlcXVlc3R9IFtvcHRpb25zLnJlcXVlc3RdIEEgUmVxdWVzdCBvYmplY3QgdGhhdCB3aWxsIGJlIHVzZWQuIEludGVuZGVkIGZvciBpbnRlcm5hbCB1c2Ugb25seS5cbiAqIEBwYXJhbSB7U3RyaW5nfSBbb3B0aW9ucy5jYWxsYmFja1BhcmFtZXRlck5hbWU9J2NhbGxiYWNrJ10gVGhlIGNhbGxiYWNrIHBhcmFtZXRlciBuYW1lIHRoYXQgdGhlIHNlcnZlciBleHBlY3RzLlxuICogQHJldHVybnMge1Byb21pc2UuPCo+fHVuZGVmaW5lZH0gYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHRvIHRoZSByZXF1ZXN0ZWQgZGF0YSB3aGVuIGxvYWRlZC4gUmV0dXJucyB1bmRlZmluZWQgaWYgPGNvZGU+cmVxdWVzdC50aHJvdHRsZTwvY29kZT4gaXMgdHJ1ZSBhbmQgdGhlIHJlcXVlc3QgZG9lcyBub3QgaGF2ZSBoaWdoIGVub3VnaCBwcmlvcml0eS5cbiAqL1xuUmVzb3VyY2UuZmV0Y2hKc29ucCA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gIHZhciByZXNvdXJjZSA9IG5ldyBSZXNvdXJjZShvcHRpb25zKTtcbiAgcmV0dXJuIHJlc291cmNlLmZldGNoSnNvbnAob3B0aW9ucy5jYWxsYmFja1BhcmFtZXRlck5hbWUpO1xufTtcblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5SZXNvdXJjZS5wcm90b3R5cGUuX21ha2VSZXF1ZXN0ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgdmFyIHJlc291cmNlID0gdGhpcztcbiAgY2hlY2tBbmRSZXNldFJlcXVlc3QocmVzb3VyY2UucmVxdWVzdCk7XG5cbiAgdmFyIHJlcXVlc3QgPSByZXNvdXJjZS5yZXF1ZXN0O1xuICByZXF1ZXN0LnVybCA9IHJlc291cmNlLnVybDtcblxuICByZXF1ZXN0LnJlcXVlc3RGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgcmVzcG9uc2VUeXBlID0gb3B0aW9ucy5yZXNwb25zZVR5cGU7XG4gICAgdmFyIGhlYWRlcnMgPSBjb21iaW5lKG9wdGlvbnMuaGVhZGVycywgcmVzb3VyY2UuaGVhZGVycyk7XG4gICAgdmFyIG92ZXJyaWRlTWltZVR5cGUgPSBvcHRpb25zLm92ZXJyaWRlTWltZVR5cGU7XG4gICAgdmFyIG1ldGhvZCA9IG9wdGlvbnMubWV0aG9kO1xuICAgIHZhciBkYXRhID0gb3B0aW9ucy5kYXRhO1xuICAgIHZhciBkZWZlcnJlZCA9IHdoZW4uZGVmZXIoKTtcbiAgICB2YXIgeGhyID0gUmVzb3VyY2UuX0ltcGxlbWVudGF0aW9ucy5sb2FkV2l0aFhocihcbiAgICAgIHJlc291cmNlLnVybCxcbiAgICAgIHJlc3BvbnNlVHlwZSxcbiAgICAgIG1ldGhvZCxcbiAgICAgIGRhdGEsXG4gICAgICBoZWFkZXJzLFxuICAgICAgZGVmZXJyZWQsXG4gICAgICBvdmVycmlkZU1pbWVUeXBlXG4gICAgKTtcbiAgICBpZiAoZGVmaW5lZCh4aHIpICYmIGRlZmluZWQoeGhyLmFib3J0KSkge1xuICAgICAgcmVxdWVzdC5jYW5jZWxGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgeGhyLmFib3J0KCk7XG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgfTtcblxuICB2YXIgcHJvbWlzZSA9IFJlcXVlc3RTY2hlZHVsZXIucmVxdWVzdChyZXF1ZXN0KTtcbiAgaWYgKCFkZWZpbmVkKHByb21pc2UpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcmV0dXJuIHByb21pc2VcbiAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgLy8gZXhwbGljaXRseSBzZXQgdG8gdW5kZWZpbmVkIHRvIGVuc3VyZSBHQyBvZiByZXF1ZXN0IHJlc3BvbnNlIGRhdGEuIFNlZSAjODg0M1xuICAgICAgcmVxdWVzdC5jYW5jZWxGdW5jdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH0pXG4gICAgLm90aGVyd2lzZShmdW5jdGlvbiAoZSkge1xuICAgICAgcmVxdWVzdC5jYW5jZWxGdW5jdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgIGlmIChyZXF1ZXN0LnN0YXRlICE9PSBSZXF1ZXN0U3RhdGUuRkFJTEVEKSB7XG4gICAgICAgIHJldHVybiB3aGVuLnJlamVjdChlKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlc291cmNlLnJldHJ5T25FcnJvcihlKS50aGVuKGZ1bmN0aW9uIChyZXRyeSkge1xuICAgICAgICBpZiAocmV0cnkpIHtcbiAgICAgICAgICAvLyBSZXNldCByZXF1ZXN0IHNvIGl0IGNhbiB0cnkgYWdhaW5cbiAgICAgICAgICByZXF1ZXN0LnN0YXRlID0gUmVxdWVzdFN0YXRlLlVOSVNTVUVEO1xuICAgICAgICAgIHJlcXVlc3QuZGVmZXJyZWQgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgICByZXR1cm4gcmVzb3VyY2UuZmV0Y2gob3B0aW9ucyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gd2hlbi5yZWplY3QoZSk7XG4gICAgICB9KTtcbiAgICB9KTtcbn07XG5cbnZhciBkYXRhVXJpUmVnZXggPSAvXmRhdGE6KC4qPykoO2Jhc2U2NCk/LCguKikkLztcblxuZnVuY3Rpb24gZGVjb2RlRGF0YVVyaVRleHQoaXNCYXNlNjQsIGRhdGEpIHtcbiAgdmFyIHJlc3VsdCA9IGRlY29kZVVSSUNvbXBvbmVudChkYXRhKTtcbiAgaWYgKGlzQmFzZTY0KSB7XG4gICAgcmV0dXJuIGF0b2IocmVzdWx0KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBkZWNvZGVEYXRhVXJpQXJyYXlCdWZmZXIoaXNCYXNlNjQsIGRhdGEpIHtcbiAgdmFyIGJ5dGVTdHJpbmcgPSBkZWNvZGVEYXRhVXJpVGV4dChpc0Jhc2U2NCwgZGF0YSk7XG4gIHZhciBidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoYnl0ZVN0cmluZy5sZW5ndGgpO1xuICB2YXIgdmlldyA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlcik7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYnl0ZVN0cmluZy5sZW5ndGg7IGkrKykge1xuICAgIHZpZXdbaV0gPSBieXRlU3RyaW5nLmNoYXJDb2RlQXQoaSk7XG4gIH1cbiAgcmV0dXJuIGJ1ZmZlcjtcbn1cblxuZnVuY3Rpb24gZGVjb2RlRGF0YVVyaShkYXRhVXJpUmVnZXhSZXN1bHQsIHJlc3BvbnNlVHlwZSkge1xuICByZXNwb25zZVR5cGUgPSBkZWZhdWx0VmFsdWUocmVzcG9uc2VUeXBlLCBcIlwiKTtcbiAgdmFyIG1pbWVUeXBlID0gZGF0YVVyaVJlZ2V4UmVzdWx0WzFdO1xuICB2YXIgaXNCYXNlNjQgPSAhIWRhdGFVcmlSZWdleFJlc3VsdFsyXTtcbiAgdmFyIGRhdGEgPSBkYXRhVXJpUmVnZXhSZXN1bHRbM107XG5cbiAgc3dpdGNoIChyZXNwb25zZVR5cGUpIHtcbiAgICBjYXNlIFwiXCI6XG4gICAgY2FzZSBcInRleHRcIjpcbiAgICAgIHJldHVybiBkZWNvZGVEYXRhVXJpVGV4dChpc0Jhc2U2NCwgZGF0YSk7XG4gICAgY2FzZSBcImFycmF5YnVmZmVyXCI6XG4gICAgICByZXR1cm4gZGVjb2RlRGF0YVVyaUFycmF5QnVmZmVyKGlzQmFzZTY0LCBkYXRhKTtcbiAgICBjYXNlIFwiYmxvYlwiOlxuICAgICAgdmFyIGJ1ZmZlciA9IGRlY29kZURhdGFVcmlBcnJheUJ1ZmZlcihpc0Jhc2U2NCwgZGF0YSk7XG4gICAgICByZXR1cm4gbmV3IEJsb2IoW2J1ZmZlcl0sIHtcbiAgICAgICAgdHlwZTogbWltZVR5cGUsXG4gICAgICB9KTtcbiAgICBjYXNlIFwiZG9jdW1lbnRcIjpcbiAgICAgIHZhciBwYXJzZXIgPSBuZXcgRE9NUGFyc2VyKCk7XG4gICAgICByZXR1cm4gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhcbiAgICAgICAgZGVjb2RlRGF0YVVyaVRleHQoaXNCYXNlNjQsIGRhdGEpLFxuICAgICAgICBtaW1lVHlwZVxuICAgICAgKTtcbiAgICBjYXNlIFwianNvblwiOlxuICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZGVjb2RlRGF0YVVyaVRleHQoaXNCYXNlNjQsIGRhdGEpKTtcbiAgICBkZWZhdWx0OlxuICAgICAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcIlVuaGFuZGxlZCByZXNwb25zZVR5cGU6IFwiICsgcmVzcG9uc2VUeXBlKTtcbiAgICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcbiAgfVxufVxuXG4vKipcbiAqIEFzeW5jaHJvbm91c2x5IGxvYWRzIHRoZSBnaXZlbiByZXNvdXJjZS4gIFJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHRvXG4gKiB0aGUgcmVzdWx0IG9uY2UgbG9hZGVkLCBvciByZWplY3QgaWYgdGhlIHJlc291cmNlIGZhaWxlZCB0byBsb2FkLiAgVGhlIGRhdGEgaXMgbG9hZGVkXG4gKiB1c2luZyBYTUxIdHRwUmVxdWVzdCwgd2hpY2ggbWVhbnMgdGhhdCBpbiBvcmRlciB0byBtYWtlIHJlcXVlc3RzIHRvIGFub3RoZXIgb3JpZ2luLFxuICogdGhlIHNlcnZlciBtdXN0IGhhdmUgQ3Jvc3MtT3JpZ2luIFJlc291cmNlIFNoYXJpbmcgKENPUlMpIGhlYWRlcnMgZW5hYmxlZC4gSXQncyByZWNvbW1lbmRlZCB0aGF0IHlvdSB1c2VcbiAqIHRoZSBtb3JlIHNwZWNpZmljIGZ1bmN0aW9ucyBlZy4gZmV0Y2hKc29uLCBmZXRjaEJsb2IsIGV0Yy5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIE9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqIEBwYXJhbSB7U3RyaW5nfSBbb3B0aW9ucy5yZXNwb25zZVR5cGVdIFRoZSB0eXBlIG9mIHJlc3BvbnNlLiAgVGhpcyBjb250cm9scyB0aGUgdHlwZSBvZiBpdGVtIHJldHVybmVkLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLmhlYWRlcnNdIEFkZGl0aW9uYWwgSFRUUCBoZWFkZXJzIHRvIHNlbmQgd2l0aCB0aGUgcmVxdWVzdCwgaWYgYW55LlxuICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLm92ZXJyaWRlTWltZVR5cGVdIE92ZXJyaWRlcyB0aGUgTUlNRSB0eXBlIHJldHVybmVkIGJ5IHRoZSBzZXJ2ZXIuXG4gKiBAcmV0dXJucyB7UHJvbWlzZS48Kj58dW5kZWZpbmVkfSBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG8gdGhlIHJlcXVlc3RlZCBkYXRhIHdoZW4gbG9hZGVkLiBSZXR1cm5zIHVuZGVmaW5lZCBpZiA8Y29kZT5yZXF1ZXN0LnRocm90dGxlPC9jb2RlPiBpcyB0cnVlIGFuZCB0aGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIGhpZ2ggZW5vdWdoIHByaW9yaXR5LlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogcmVzb3VyY2UuZmV0Y2goKVxuICogICAudGhlbihmdW5jdGlvbihib2R5KSB7XG4gKiAgICAgICAvLyB1c2UgdGhlIGRhdGFcbiAqICAgfSkub3RoZXJ3aXNlKGZ1bmN0aW9uKGVycm9yKSB7XG4gKiAgICAgICAvLyBhbiBlcnJvciBvY2N1cnJlZFxuICogICB9KTtcbiAqXG4gKiBAc2VlIHtAbGluayBodHRwOi8vd3d3LnczLm9yZy9UUi9jb3JzL3xDcm9zcy1PcmlnaW4gUmVzb3VyY2UgU2hhcmluZ31cbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly93aWtpLmNvbW1vbmpzLm9yZy93aWtpL1Byb21pc2VzL0F8Q29tbW9uSlMgUHJvbWlzZXMvQX1cbiAqL1xuUmVzb3VyY2UucHJvdG90eXBlLmZldGNoID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IGRlZmF1bHRDbG9uZShvcHRpb25zLCB7fSk7XG4gIG9wdGlvbnMubWV0aG9kID0gXCJHRVRcIjtcblxuICByZXR1cm4gdGhpcy5fbWFrZVJlcXVlc3Qob3B0aW9ucyk7XG59O1xuXG4vKipcbiAqIENyZWF0ZXMgYSBSZXNvdXJjZSBmcm9tIGEgVVJMIGFuZCBjYWxscyBmZXRjaCgpIG9uIGl0LlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfE9iamVjdH0gb3B0aW9ucyBBIHVybCBvciBhbiBvYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXNcbiAqIEBwYXJhbSB7U3RyaW5nfSBvcHRpb25zLnVybCBUaGUgdXJsIG9mIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5xdWVyeVBhcmFtZXRlcnNdIEFuIG9iamVjdCBjb250YWluaW5nIHF1ZXJ5IHBhcmFtZXRlcnMgdGhhdCB3aWxsIGJlIHNlbnQgd2hlbiByZXRyaWV2aW5nIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy50ZW1wbGF0ZVZhbHVlc10gS2V5L1ZhbHVlIHBhaXJzIHRoYXQgYXJlIHVzZWQgdG8gcmVwbGFjZSB0ZW1wbGF0ZSB2YWx1ZXMgKGVnLiB7eH0pLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLmhlYWRlcnM9e31dIEFkZGl0aW9uYWwgSFRUUCBoZWFkZXJzIHRoYXQgd2lsbCBiZSBzZW50LlxuICogQHBhcmFtIHtQcm94eX0gW29wdGlvbnMucHJveHldIEEgcHJveHkgdG8gYmUgdXNlZCB3aGVuIGxvYWRpbmcgdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtSZXNvdXJjZS5SZXRyeUNhbGxiYWNrfSBbb3B0aW9ucy5yZXRyeUNhbGxiYWNrXSBUaGUgRnVuY3Rpb24gdG8gY2FsbCB3aGVuIGEgcmVxdWVzdCBmb3IgdGhpcyByZXNvdXJjZSBmYWlscy4gSWYgaXQgcmV0dXJucyB0cnVlLCB0aGUgcmVxdWVzdCB3aWxsIGJlIHJldHJpZWQuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMucmV0cnlBdHRlbXB0cz0wXSBUaGUgbnVtYmVyIG9mIHRpbWVzIHRoZSByZXRyeUNhbGxiYWNrIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGdpdmluZyB1cC5cbiAqIEBwYXJhbSB7UmVxdWVzdH0gW29wdGlvbnMucmVxdWVzdF0gQSBSZXF1ZXN0IG9iamVjdCB0aGF0IHdpbGwgYmUgdXNlZC4gSW50ZW5kZWQgZm9yIGludGVybmFsIHVzZSBvbmx5LlxuICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLnJlc3BvbnNlVHlwZV0gVGhlIHR5cGUgb2YgcmVzcG9uc2UuICBUaGlzIGNvbnRyb2xzIHRoZSB0eXBlIG9mIGl0ZW0gcmV0dXJuZWQuXG4gKiBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMub3ZlcnJpZGVNaW1lVHlwZV0gT3ZlcnJpZGVzIHRoZSBNSU1FIHR5cGUgcmV0dXJuZWQgYnkgdGhlIHNlcnZlci5cbiAqIEByZXR1cm5zIHtQcm9taXNlLjwqPnx1bmRlZmluZWR9IGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB0byB0aGUgcmVxdWVzdGVkIGRhdGEgd2hlbiBsb2FkZWQuIFJldHVybnMgdW5kZWZpbmVkIGlmIDxjb2RlPnJlcXVlc3QudGhyb3R0bGU8L2NvZGU+IGlzIHRydWUgYW5kIHRoZSByZXF1ZXN0IGRvZXMgbm90IGhhdmUgaGlnaCBlbm91Z2ggcHJpb3JpdHkuXG4gKi9cblJlc291cmNlLmZldGNoID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgdmFyIHJlc291cmNlID0gbmV3IFJlc291cmNlKG9wdGlvbnMpO1xuICByZXR1cm4gcmVzb3VyY2UuZmV0Y2goe1xuICAgIC8vIE1ha2UgY29weSBvZiBqdXN0IHRoZSBuZWVkZWQgZmllbGRzIGJlY2F1c2UgaGVhZGVycyBjYW4gYmUgcGFzc2VkIHRvIGJvdGggdGhlIGNvbnN0cnVjdG9yIGFuZCB0byBmZXRjaFxuICAgIHJlc3BvbnNlVHlwZTogb3B0aW9ucy5yZXNwb25zZVR5cGUsXG4gICAgb3ZlcnJpZGVNaW1lVHlwZTogb3B0aW9ucy5vdmVycmlkZU1pbWVUeXBlLFxuICB9KTtcbn07XG5cbi8qKlxuICogQXN5bmNocm9ub3VzbHkgZGVsZXRlcyB0aGUgZ2l2ZW4gcmVzb3VyY2UuICBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB0b1xuICogdGhlIHJlc3VsdCBvbmNlIGxvYWRlZCwgb3IgcmVqZWN0IGlmIHRoZSByZXNvdXJjZSBmYWlsZWQgdG8gbG9hZC4gIFRoZSBkYXRhIGlzIGxvYWRlZFxuICogdXNpbmcgWE1MSHR0cFJlcXVlc3QsIHdoaWNoIG1lYW5zIHRoYXQgaW4gb3JkZXIgdG8gbWFrZSByZXF1ZXN0cyB0byBhbm90aGVyIG9yaWdpbixcbiAqIHRoZSBzZXJ2ZXIgbXVzdCBoYXZlIENyb3NzLU9yaWdpbiBSZXNvdXJjZSBTaGFyaW5nIChDT1JTKSBoZWFkZXJzIGVuYWJsZWQuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXSBPYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gKiBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMucmVzcG9uc2VUeXBlXSBUaGUgdHlwZSBvZiByZXNwb25zZS4gIFRoaXMgY29udHJvbHMgdGhlIHR5cGUgb2YgaXRlbSByZXR1cm5lZC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5oZWFkZXJzXSBBZGRpdGlvbmFsIEhUVFAgaGVhZGVycyB0byBzZW5kIHdpdGggdGhlIHJlcXVlc3QsIGlmIGFueS5cbiAqIEBwYXJhbSB7U3RyaW5nfSBbb3B0aW9ucy5vdmVycmlkZU1pbWVUeXBlXSBPdmVycmlkZXMgdGhlIE1JTUUgdHlwZSByZXR1cm5lZCBieSB0aGUgc2VydmVyLlxuICogQHJldHVybnMge1Byb21pc2UuPCo+fHVuZGVmaW5lZH0gYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHRvIHRoZSByZXF1ZXN0ZWQgZGF0YSB3aGVuIGxvYWRlZC4gUmV0dXJucyB1bmRlZmluZWQgaWYgPGNvZGU+cmVxdWVzdC50aHJvdHRsZTwvY29kZT4gaXMgdHJ1ZSBhbmQgdGhlIHJlcXVlc3QgZG9lcyBub3QgaGF2ZSBoaWdoIGVub3VnaCBwcmlvcml0eS5cbiAqXG4gKlxuICogQGV4YW1wbGVcbiAqIHJlc291cmNlLmRlbGV0ZSgpXG4gKiAgIC50aGVuKGZ1bmN0aW9uKGJvZHkpIHtcbiAqICAgICAgIC8vIHVzZSB0aGUgZGF0YVxuICogICB9KS5vdGhlcndpc2UoZnVuY3Rpb24oZXJyb3IpIHtcbiAqICAgICAgIC8vIGFuIGVycm9yIG9jY3VycmVkXG4gKiAgIH0pO1xuICpcbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly93d3cudzMub3JnL1RSL2NvcnMvfENyb3NzLU9yaWdpbiBSZXNvdXJjZSBTaGFyaW5nfVxuICogQHNlZSB7QGxpbmsgaHR0cDovL3dpa2kuY29tbW9uanMub3JnL3dpa2kvUHJvbWlzZXMvQXxDb21tb25KUyBQcm9taXNlcy9BfVxuICovXG5SZXNvdXJjZS5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IGRlZmF1bHRDbG9uZShvcHRpb25zLCB7fSk7XG4gIG9wdGlvbnMubWV0aG9kID0gXCJERUxFVEVcIjtcblxuICByZXR1cm4gdGhpcy5fbWFrZVJlcXVlc3Qob3B0aW9ucyk7XG59O1xuXG4vKipcbiAqIENyZWF0ZXMgYSBSZXNvdXJjZSBmcm9tIGEgVVJMIGFuZCBjYWxscyBkZWxldGUoKSBvbiBpdC5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ3xPYmplY3R9IG9wdGlvbnMgQSB1cmwgb3IgYW4gb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzXG4gKiBAcGFyYW0ge1N0cmluZ30gb3B0aW9ucy51cmwgVGhlIHVybCBvZiB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMuZGF0YV0gRGF0YSB0aGF0IGlzIHBvc3RlZCB3aXRoIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5xdWVyeVBhcmFtZXRlcnNdIEFuIG9iamVjdCBjb250YWluaW5nIHF1ZXJ5IHBhcmFtZXRlcnMgdGhhdCB3aWxsIGJlIHNlbnQgd2hlbiByZXRyaWV2aW5nIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy50ZW1wbGF0ZVZhbHVlc10gS2V5L1ZhbHVlIHBhaXJzIHRoYXQgYXJlIHVzZWQgdG8gcmVwbGFjZSB0ZW1wbGF0ZSB2YWx1ZXMgKGVnLiB7eH0pLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLmhlYWRlcnM9e31dIEFkZGl0aW9uYWwgSFRUUCBoZWFkZXJzIHRoYXQgd2lsbCBiZSBzZW50LlxuICogQHBhcmFtIHtQcm94eX0gW29wdGlvbnMucHJveHldIEEgcHJveHkgdG8gYmUgdXNlZCB3aGVuIGxvYWRpbmcgdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtSZXNvdXJjZS5SZXRyeUNhbGxiYWNrfSBbb3B0aW9ucy5yZXRyeUNhbGxiYWNrXSBUaGUgRnVuY3Rpb24gdG8gY2FsbCB3aGVuIGEgcmVxdWVzdCBmb3IgdGhpcyByZXNvdXJjZSBmYWlscy4gSWYgaXQgcmV0dXJucyB0cnVlLCB0aGUgcmVxdWVzdCB3aWxsIGJlIHJldHJpZWQuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMucmV0cnlBdHRlbXB0cz0wXSBUaGUgbnVtYmVyIG9mIHRpbWVzIHRoZSByZXRyeUNhbGxiYWNrIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGdpdmluZyB1cC5cbiAqIEBwYXJhbSB7UmVxdWVzdH0gW29wdGlvbnMucmVxdWVzdF0gQSBSZXF1ZXN0IG9iamVjdCB0aGF0IHdpbGwgYmUgdXNlZC4gSW50ZW5kZWQgZm9yIGludGVybmFsIHVzZSBvbmx5LlxuICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLnJlc3BvbnNlVHlwZV0gVGhlIHR5cGUgb2YgcmVzcG9uc2UuICBUaGlzIGNvbnRyb2xzIHRoZSB0eXBlIG9mIGl0ZW0gcmV0dXJuZWQuXG4gKiBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMub3ZlcnJpZGVNaW1lVHlwZV0gT3ZlcnJpZGVzIHRoZSBNSU1FIHR5cGUgcmV0dXJuZWQgYnkgdGhlIHNlcnZlci5cbiAqIEByZXR1cm5zIHtQcm9taXNlLjwqPnx1bmRlZmluZWR9IGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB0byB0aGUgcmVxdWVzdGVkIGRhdGEgd2hlbiBsb2FkZWQuIFJldHVybnMgdW5kZWZpbmVkIGlmIDxjb2RlPnJlcXVlc3QudGhyb3R0bGU8L2NvZGU+IGlzIHRydWUgYW5kIHRoZSByZXF1ZXN0IGRvZXMgbm90IGhhdmUgaGlnaCBlbm91Z2ggcHJpb3JpdHkuXG4gKi9cblJlc291cmNlLmRlbGV0ZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gIHZhciByZXNvdXJjZSA9IG5ldyBSZXNvdXJjZShvcHRpb25zKTtcbiAgcmV0dXJuIHJlc291cmNlLmRlbGV0ZSh7XG4gICAgLy8gTWFrZSBjb3B5IG9mIGp1c3QgdGhlIG5lZWRlZCBmaWVsZHMgYmVjYXVzZSBoZWFkZXJzIGNhbiBiZSBwYXNzZWQgdG8gYm90aCB0aGUgY29uc3RydWN0b3IgYW5kIHRvIGZldGNoXG4gICAgcmVzcG9uc2VUeXBlOiBvcHRpb25zLnJlc3BvbnNlVHlwZSxcbiAgICBvdmVycmlkZU1pbWVUeXBlOiBvcHRpb25zLm92ZXJyaWRlTWltZVR5cGUsXG4gICAgZGF0YTogb3B0aW9ucy5kYXRhLFxuICB9KTtcbn07XG5cbi8qKlxuICogQXN5bmNocm9ub3VzbHkgZ2V0cyBoZWFkZXJzIHRoZSBnaXZlbiByZXNvdXJjZS4gIFJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHRvXG4gKiB0aGUgcmVzdWx0IG9uY2UgbG9hZGVkLCBvciByZWplY3QgaWYgdGhlIHJlc291cmNlIGZhaWxlZCB0byBsb2FkLiAgVGhlIGRhdGEgaXMgbG9hZGVkXG4gKiB1c2luZyBYTUxIdHRwUmVxdWVzdCwgd2hpY2ggbWVhbnMgdGhhdCBpbiBvcmRlciB0byBtYWtlIHJlcXVlc3RzIHRvIGFub3RoZXIgb3JpZ2luLFxuICogdGhlIHNlcnZlciBtdXN0IGhhdmUgQ3Jvc3MtT3JpZ2luIFJlc291cmNlIFNoYXJpbmcgKENPUlMpIGhlYWRlcnMgZW5hYmxlZC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIE9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqIEBwYXJhbSB7U3RyaW5nfSBbb3B0aW9ucy5yZXNwb25zZVR5cGVdIFRoZSB0eXBlIG9mIHJlc3BvbnNlLiAgVGhpcyBjb250cm9scyB0aGUgdHlwZSBvZiBpdGVtIHJldHVybmVkLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLmhlYWRlcnNdIEFkZGl0aW9uYWwgSFRUUCBoZWFkZXJzIHRvIHNlbmQgd2l0aCB0aGUgcmVxdWVzdCwgaWYgYW55LlxuICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLm92ZXJyaWRlTWltZVR5cGVdIE92ZXJyaWRlcyB0aGUgTUlNRSB0eXBlIHJldHVybmVkIGJ5IHRoZSBzZXJ2ZXIuXG4gKiBAcmV0dXJucyB7UHJvbWlzZS48Kj58dW5kZWZpbmVkfSBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG8gdGhlIHJlcXVlc3RlZCBkYXRhIHdoZW4gbG9hZGVkLiBSZXR1cm5zIHVuZGVmaW5lZCBpZiA8Y29kZT5yZXF1ZXN0LnRocm90dGxlPC9jb2RlPiBpcyB0cnVlIGFuZCB0aGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIGhpZ2ggZW5vdWdoIHByaW9yaXR5LlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogcmVzb3VyY2UuaGVhZCgpXG4gKiAgIC50aGVuKGZ1bmN0aW9uKGhlYWRlcnMpIHtcbiAqICAgICAgIC8vIHVzZSB0aGUgZGF0YVxuICogICB9KS5vdGhlcndpc2UoZnVuY3Rpb24oZXJyb3IpIHtcbiAqICAgICAgIC8vIGFuIGVycm9yIG9jY3VycmVkXG4gKiAgIH0pO1xuICpcbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly93d3cudzMub3JnL1RSL2NvcnMvfENyb3NzLU9yaWdpbiBSZXNvdXJjZSBTaGFyaW5nfVxuICogQHNlZSB7QGxpbmsgaHR0cDovL3dpa2kuY29tbW9uanMub3JnL3dpa2kvUHJvbWlzZXMvQXxDb21tb25KUyBQcm9taXNlcy9BfVxuICovXG5SZXNvdXJjZS5wcm90b3R5cGUuaGVhZCA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBkZWZhdWx0Q2xvbmUob3B0aW9ucywge30pO1xuICBvcHRpb25zLm1ldGhvZCA9IFwiSEVBRFwiO1xuXG4gIHJldHVybiB0aGlzLl9tYWtlUmVxdWVzdChvcHRpb25zKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIFJlc291cmNlIGZyb20gYSBVUkwgYW5kIGNhbGxzIGhlYWQoKSBvbiBpdC5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ3xPYmplY3R9IG9wdGlvbnMgQSB1cmwgb3IgYW4gb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzXG4gKiBAcGFyYW0ge1N0cmluZ30gb3B0aW9ucy51cmwgVGhlIHVybCBvZiB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMucXVlcnlQYXJhbWV0ZXJzXSBBbiBvYmplY3QgY29udGFpbmluZyBxdWVyeSBwYXJhbWV0ZXJzIHRoYXQgd2lsbCBiZSBzZW50IHdoZW4gcmV0cmlldmluZyB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMudGVtcGxhdGVWYWx1ZXNdIEtleS9WYWx1ZSBwYWlycyB0aGF0IGFyZSB1c2VkIHRvIHJlcGxhY2UgdGVtcGxhdGUgdmFsdWVzIChlZy4ge3h9KS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5oZWFkZXJzPXt9XSBBZGRpdGlvbmFsIEhUVFAgaGVhZGVycyB0aGF0IHdpbGwgYmUgc2VudC5cbiAqIEBwYXJhbSB7UHJveHl9IFtvcHRpb25zLnByb3h5XSBBIHByb3h5IHRvIGJlIHVzZWQgd2hlbiBsb2FkaW5nIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7UmVzb3VyY2UuUmV0cnlDYWxsYmFja30gW29wdGlvbnMucmV0cnlDYWxsYmFja10gVGhlIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiBhIHJlcXVlc3QgZm9yIHRoaXMgcmVzb3VyY2UgZmFpbHMuIElmIGl0IHJldHVybnMgdHJ1ZSwgdGhlIHJlcXVlc3Qgd2lsbCBiZSByZXRyaWVkLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLnJldHJ5QXR0ZW1wdHM9MF0gVGhlIG51bWJlciBvZiB0aW1lcyB0aGUgcmV0cnlDYWxsYmFjayBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBnaXZpbmcgdXAuXG4gKiBAcGFyYW0ge1JlcXVlc3R9IFtvcHRpb25zLnJlcXVlc3RdIEEgUmVxdWVzdCBvYmplY3QgdGhhdCB3aWxsIGJlIHVzZWQuIEludGVuZGVkIGZvciBpbnRlcm5hbCB1c2Ugb25seS5cbiAqIEBwYXJhbSB7U3RyaW5nfSBbb3B0aW9ucy5yZXNwb25zZVR5cGVdIFRoZSB0eXBlIG9mIHJlc3BvbnNlLiAgVGhpcyBjb250cm9scyB0aGUgdHlwZSBvZiBpdGVtIHJldHVybmVkLlxuICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLm92ZXJyaWRlTWltZVR5cGVdIE92ZXJyaWRlcyB0aGUgTUlNRSB0eXBlIHJldHVybmVkIGJ5IHRoZSBzZXJ2ZXIuXG4gKiBAcmV0dXJucyB7UHJvbWlzZS48Kj58dW5kZWZpbmVkfSBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG8gdGhlIHJlcXVlc3RlZCBkYXRhIHdoZW4gbG9hZGVkLiBSZXR1cm5zIHVuZGVmaW5lZCBpZiA8Y29kZT5yZXF1ZXN0LnRocm90dGxlPC9jb2RlPiBpcyB0cnVlIGFuZCB0aGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIGhpZ2ggZW5vdWdoIHByaW9yaXR5LlxuICovXG5SZXNvdXJjZS5oZWFkID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgdmFyIHJlc291cmNlID0gbmV3IFJlc291cmNlKG9wdGlvbnMpO1xuICByZXR1cm4gcmVzb3VyY2UuaGVhZCh7XG4gICAgLy8gTWFrZSBjb3B5IG9mIGp1c3QgdGhlIG5lZWRlZCBmaWVsZHMgYmVjYXVzZSBoZWFkZXJzIGNhbiBiZSBwYXNzZWQgdG8gYm90aCB0aGUgY29uc3RydWN0b3IgYW5kIHRvIGZldGNoXG4gICAgcmVzcG9uc2VUeXBlOiBvcHRpb25zLnJlc3BvbnNlVHlwZSxcbiAgICBvdmVycmlkZU1pbWVUeXBlOiBvcHRpb25zLm92ZXJyaWRlTWltZVR5cGUsXG4gIH0pO1xufTtcblxuLyoqXG4gKiBBc3luY2hyb25vdXNseSBnZXRzIG9wdGlvbnMgdGhlIGdpdmVuIHJlc291cmNlLiAgUmV0dXJucyBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG9cbiAqIHRoZSByZXN1bHQgb25jZSBsb2FkZWQsIG9yIHJlamVjdCBpZiB0aGUgcmVzb3VyY2UgZmFpbGVkIHRvIGxvYWQuICBUaGUgZGF0YSBpcyBsb2FkZWRcbiAqIHVzaW5nIFhNTEh0dHBSZXF1ZXN0LCB3aGljaCBtZWFucyB0aGF0IGluIG9yZGVyIHRvIG1ha2UgcmVxdWVzdHMgdG8gYW5vdGhlciBvcmlnaW4sXG4gKiB0aGUgc2VydmVyIG11c3QgaGF2ZSBDcm9zcy1PcmlnaW4gUmVzb3VyY2UgU2hhcmluZyAoQ09SUykgaGVhZGVycyBlbmFibGVkLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gT2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxuICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLnJlc3BvbnNlVHlwZV0gVGhlIHR5cGUgb2YgcmVzcG9uc2UuICBUaGlzIGNvbnRyb2xzIHRoZSB0eXBlIG9mIGl0ZW0gcmV0dXJuZWQuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMuaGVhZGVyc10gQWRkaXRpb25hbCBIVFRQIGhlYWRlcnMgdG8gc2VuZCB3aXRoIHRoZSByZXF1ZXN0LCBpZiBhbnkuXG4gKiBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMub3ZlcnJpZGVNaW1lVHlwZV0gT3ZlcnJpZGVzIHRoZSBNSU1FIHR5cGUgcmV0dXJuZWQgYnkgdGhlIHNlcnZlci5cbiAqIEByZXR1cm5zIHtQcm9taXNlLjwqPnx1bmRlZmluZWR9IGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB0byB0aGUgcmVxdWVzdGVkIGRhdGEgd2hlbiBsb2FkZWQuIFJldHVybnMgdW5kZWZpbmVkIGlmIDxjb2RlPnJlcXVlc3QudGhyb3R0bGU8L2NvZGU+IGlzIHRydWUgYW5kIHRoZSByZXF1ZXN0IGRvZXMgbm90IGhhdmUgaGlnaCBlbm91Z2ggcHJpb3JpdHkuXG4gKlxuICpcbiAqIEBleGFtcGxlXG4gKiByZXNvdXJjZS5vcHRpb25zKClcbiAqICAgLnRoZW4oZnVuY3Rpb24oaGVhZGVycykge1xuICogICAgICAgLy8gdXNlIHRoZSBkYXRhXG4gKiAgIH0pLm90aGVyd2lzZShmdW5jdGlvbihlcnJvcikge1xuICogICAgICAgLy8gYW4gZXJyb3Igb2NjdXJyZWRcbiAqICAgfSk7XG4gKlxuICogQHNlZSB7QGxpbmsgaHR0cDovL3d3dy53My5vcmcvVFIvY29ycy98Q3Jvc3MtT3JpZ2luIFJlc291cmNlIFNoYXJpbmd9XG4gKiBAc2VlIHtAbGluayBodHRwOi8vd2lraS5jb21tb25qcy5vcmcvd2lraS9Qcm9taXNlcy9BfENvbW1vbkpTIFByb21pc2VzL0F9XG4gKi9cblJlc291cmNlLnByb3RvdHlwZS5vcHRpb25zID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IGRlZmF1bHRDbG9uZShvcHRpb25zLCB7fSk7XG4gIG9wdGlvbnMubWV0aG9kID0gXCJPUFRJT05TXCI7XG5cbiAgcmV0dXJuIHRoaXMuX21ha2VSZXF1ZXN0KG9wdGlvbnMpO1xufTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgUmVzb3VyY2UgZnJvbSBhIFVSTCBhbmQgY2FsbHMgb3B0aW9ucygpIG9uIGl0LlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfE9iamVjdH0gb3B0aW9ucyBBIHVybCBvciBhbiBvYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXNcbiAqIEBwYXJhbSB7U3RyaW5nfSBvcHRpb25zLnVybCBUaGUgdXJsIG9mIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5xdWVyeVBhcmFtZXRlcnNdIEFuIG9iamVjdCBjb250YWluaW5nIHF1ZXJ5IHBhcmFtZXRlcnMgdGhhdCB3aWxsIGJlIHNlbnQgd2hlbiByZXRyaWV2aW5nIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy50ZW1wbGF0ZVZhbHVlc10gS2V5L1ZhbHVlIHBhaXJzIHRoYXQgYXJlIHVzZWQgdG8gcmVwbGFjZSB0ZW1wbGF0ZSB2YWx1ZXMgKGVnLiB7eH0pLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLmhlYWRlcnM9e31dIEFkZGl0aW9uYWwgSFRUUCBoZWFkZXJzIHRoYXQgd2lsbCBiZSBzZW50LlxuICogQHBhcmFtIHtQcm94eX0gW29wdGlvbnMucHJveHldIEEgcHJveHkgdG8gYmUgdXNlZCB3aGVuIGxvYWRpbmcgdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtSZXNvdXJjZS5SZXRyeUNhbGxiYWNrfSBbb3B0aW9ucy5yZXRyeUNhbGxiYWNrXSBUaGUgRnVuY3Rpb24gdG8gY2FsbCB3aGVuIGEgcmVxdWVzdCBmb3IgdGhpcyByZXNvdXJjZSBmYWlscy4gSWYgaXQgcmV0dXJucyB0cnVlLCB0aGUgcmVxdWVzdCB3aWxsIGJlIHJldHJpZWQuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMucmV0cnlBdHRlbXB0cz0wXSBUaGUgbnVtYmVyIG9mIHRpbWVzIHRoZSByZXRyeUNhbGxiYWNrIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGdpdmluZyB1cC5cbiAqIEBwYXJhbSB7UmVxdWVzdH0gW29wdGlvbnMucmVxdWVzdF0gQSBSZXF1ZXN0IG9iamVjdCB0aGF0IHdpbGwgYmUgdXNlZC4gSW50ZW5kZWQgZm9yIGludGVybmFsIHVzZSBvbmx5LlxuICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLnJlc3BvbnNlVHlwZV0gVGhlIHR5cGUgb2YgcmVzcG9uc2UuICBUaGlzIGNvbnRyb2xzIHRoZSB0eXBlIG9mIGl0ZW0gcmV0dXJuZWQuXG4gKiBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMub3ZlcnJpZGVNaW1lVHlwZV0gT3ZlcnJpZGVzIHRoZSBNSU1FIHR5cGUgcmV0dXJuZWQgYnkgdGhlIHNlcnZlci5cbiAqIEByZXR1cm5zIHtQcm9taXNlLjwqPnx1bmRlZmluZWR9IGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB0byB0aGUgcmVxdWVzdGVkIGRhdGEgd2hlbiBsb2FkZWQuIFJldHVybnMgdW5kZWZpbmVkIGlmIDxjb2RlPnJlcXVlc3QudGhyb3R0bGU8L2NvZGU+IGlzIHRydWUgYW5kIHRoZSByZXF1ZXN0IGRvZXMgbm90IGhhdmUgaGlnaCBlbm91Z2ggcHJpb3JpdHkuXG4gKi9cblJlc291cmNlLm9wdGlvbnMgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICB2YXIgcmVzb3VyY2UgPSBuZXcgUmVzb3VyY2Uob3B0aW9ucyk7XG4gIHJldHVybiByZXNvdXJjZS5vcHRpb25zKHtcbiAgICAvLyBNYWtlIGNvcHkgb2YganVzdCB0aGUgbmVlZGVkIGZpZWxkcyBiZWNhdXNlIGhlYWRlcnMgY2FuIGJlIHBhc3NlZCB0byBib3RoIHRoZSBjb25zdHJ1Y3RvciBhbmQgdG8gZmV0Y2hcbiAgICByZXNwb25zZVR5cGU6IG9wdGlvbnMucmVzcG9uc2VUeXBlLFxuICAgIG92ZXJyaWRlTWltZVR5cGU6IG9wdGlvbnMub3ZlcnJpZGVNaW1lVHlwZSxcbiAgfSk7XG59O1xuXG4vKipcbiAqIEFzeW5jaHJvbm91c2x5IHBvc3RzIGRhdGEgdG8gdGhlIGdpdmVuIHJlc291cmNlLiAgUmV0dXJucyBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG9cbiAqIHRoZSByZXN1bHQgb25jZSBsb2FkZWQsIG9yIHJlamVjdCBpZiB0aGUgcmVzb3VyY2UgZmFpbGVkIHRvIGxvYWQuICBUaGUgZGF0YSBpcyBsb2FkZWRcbiAqIHVzaW5nIFhNTEh0dHBSZXF1ZXN0LCB3aGljaCBtZWFucyB0aGF0IGluIG9yZGVyIHRvIG1ha2UgcmVxdWVzdHMgdG8gYW5vdGhlciBvcmlnaW4sXG4gKiB0aGUgc2VydmVyIG11c3QgaGF2ZSBDcm9zcy1PcmlnaW4gUmVzb3VyY2UgU2hhcmluZyAoQ09SUykgaGVhZGVycyBlbmFibGVkLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIERhdGEgdGhhdCBpcyBwb3N0ZWQgd2l0aCB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIE9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5kYXRhXSBEYXRhIHRoYXQgaXMgcG9zdGVkIHdpdGggdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLnJlc3BvbnNlVHlwZV0gVGhlIHR5cGUgb2YgcmVzcG9uc2UuICBUaGlzIGNvbnRyb2xzIHRoZSB0eXBlIG9mIGl0ZW0gcmV0dXJuZWQuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMuaGVhZGVyc10gQWRkaXRpb25hbCBIVFRQIGhlYWRlcnMgdG8gc2VuZCB3aXRoIHRoZSByZXF1ZXN0LCBpZiBhbnkuXG4gKiBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMub3ZlcnJpZGVNaW1lVHlwZV0gT3ZlcnJpZGVzIHRoZSBNSU1FIHR5cGUgcmV0dXJuZWQgYnkgdGhlIHNlcnZlci5cbiAqIEByZXR1cm5zIHtQcm9taXNlLjwqPnx1bmRlZmluZWR9IGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB0byB0aGUgcmVxdWVzdGVkIGRhdGEgd2hlbiBsb2FkZWQuIFJldHVybnMgdW5kZWZpbmVkIGlmIDxjb2RlPnJlcXVlc3QudGhyb3R0bGU8L2NvZGU+IGlzIHRydWUgYW5kIHRoZSByZXF1ZXN0IGRvZXMgbm90IGhhdmUgaGlnaCBlbm91Z2ggcHJpb3JpdHkuXG4gKlxuICpcbiAqIEBleGFtcGxlXG4gKiByZXNvdXJjZS5wb3N0KGRhdGEpXG4gKiAgIC50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICogICAgICAgLy8gdXNlIHRoZSByZXN1bHRcbiAqICAgfSkub3RoZXJ3aXNlKGZ1bmN0aW9uKGVycm9yKSB7XG4gKiAgICAgICAvLyBhbiBlcnJvciBvY2N1cnJlZFxuICogICB9KTtcbiAqXG4gKiBAc2VlIHtAbGluayBodHRwOi8vd3d3LnczLm9yZy9UUi9jb3JzL3xDcm9zcy1PcmlnaW4gUmVzb3VyY2UgU2hhcmluZ31cbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly93aWtpLmNvbW1vbmpzLm9yZy93aWtpL1Byb21pc2VzL0F8Q29tbW9uSlMgUHJvbWlzZXMvQX1cbiAqL1xuUmVzb3VyY2UucHJvdG90eXBlLnBvc3QgPSBmdW5jdGlvbiAoZGF0YSwgb3B0aW9ucykge1xuICBDaGVjay5kZWZpbmVkKFwiZGF0YVwiLCBkYXRhKTtcblxuICBvcHRpb25zID0gZGVmYXVsdENsb25lKG9wdGlvbnMsIHt9KTtcbiAgb3B0aW9ucy5tZXRob2QgPSBcIlBPU1RcIjtcbiAgb3B0aW9ucy5kYXRhID0gZGF0YTtcblxuICByZXR1cm4gdGhpcy5fbWFrZVJlcXVlc3Qob3B0aW9ucyk7XG59O1xuXG4vKipcbiAqIENyZWF0ZXMgYSBSZXNvdXJjZSBmcm9tIGEgVVJMIGFuZCBjYWxscyBwb3N0KCkgb24gaXQuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgQSB1cmwgb3IgYW4gb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzXG4gKiBAcGFyYW0ge1N0cmluZ30gb3B0aW9ucy51cmwgVGhlIHVybCBvZiB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucy5kYXRhIERhdGEgdGhhdCBpcyBwb3N0ZWQgd2l0aCB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMucXVlcnlQYXJhbWV0ZXJzXSBBbiBvYmplY3QgY29udGFpbmluZyBxdWVyeSBwYXJhbWV0ZXJzIHRoYXQgd2lsbCBiZSBzZW50IHdoZW4gcmV0cmlldmluZyB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMudGVtcGxhdGVWYWx1ZXNdIEtleS9WYWx1ZSBwYWlycyB0aGF0IGFyZSB1c2VkIHRvIHJlcGxhY2UgdGVtcGxhdGUgdmFsdWVzIChlZy4ge3h9KS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5oZWFkZXJzPXt9XSBBZGRpdGlvbmFsIEhUVFAgaGVhZGVycyB0aGF0IHdpbGwgYmUgc2VudC5cbiAqIEBwYXJhbSB7UHJveHl9IFtvcHRpb25zLnByb3h5XSBBIHByb3h5IHRvIGJlIHVzZWQgd2hlbiBsb2FkaW5nIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7UmVzb3VyY2UuUmV0cnlDYWxsYmFja30gW29wdGlvbnMucmV0cnlDYWxsYmFja10gVGhlIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiBhIHJlcXVlc3QgZm9yIHRoaXMgcmVzb3VyY2UgZmFpbHMuIElmIGl0IHJldHVybnMgdHJ1ZSwgdGhlIHJlcXVlc3Qgd2lsbCBiZSByZXRyaWVkLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLnJldHJ5QXR0ZW1wdHM9MF0gVGhlIG51bWJlciBvZiB0aW1lcyB0aGUgcmV0cnlDYWxsYmFjayBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBnaXZpbmcgdXAuXG4gKiBAcGFyYW0ge1JlcXVlc3R9IFtvcHRpb25zLnJlcXVlc3RdIEEgUmVxdWVzdCBvYmplY3QgdGhhdCB3aWxsIGJlIHVzZWQuIEludGVuZGVkIGZvciBpbnRlcm5hbCB1c2Ugb25seS5cbiAqIEBwYXJhbSB7U3RyaW5nfSBbb3B0aW9ucy5yZXNwb25zZVR5cGVdIFRoZSB0eXBlIG9mIHJlc3BvbnNlLiAgVGhpcyBjb250cm9scyB0aGUgdHlwZSBvZiBpdGVtIHJldHVybmVkLlxuICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLm92ZXJyaWRlTWltZVR5cGVdIE92ZXJyaWRlcyB0aGUgTUlNRSB0eXBlIHJldHVybmVkIGJ5IHRoZSBzZXJ2ZXIuXG4gKiBAcmV0dXJucyB7UHJvbWlzZS48Kj58dW5kZWZpbmVkfSBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG8gdGhlIHJlcXVlc3RlZCBkYXRhIHdoZW4gbG9hZGVkLiBSZXR1cm5zIHVuZGVmaW5lZCBpZiA8Y29kZT5yZXF1ZXN0LnRocm90dGxlPC9jb2RlPiBpcyB0cnVlIGFuZCB0aGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIGhpZ2ggZW5vdWdoIHByaW9yaXR5LlxuICovXG5SZXNvdXJjZS5wb3N0ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgdmFyIHJlc291cmNlID0gbmV3IFJlc291cmNlKG9wdGlvbnMpO1xuICByZXR1cm4gcmVzb3VyY2UucG9zdChvcHRpb25zLmRhdGEsIHtcbiAgICAvLyBNYWtlIGNvcHkgb2YganVzdCB0aGUgbmVlZGVkIGZpZWxkcyBiZWNhdXNlIGhlYWRlcnMgY2FuIGJlIHBhc3NlZCB0byBib3RoIHRoZSBjb25zdHJ1Y3RvciBhbmQgdG8gcG9zdFxuICAgIHJlc3BvbnNlVHlwZTogb3B0aW9ucy5yZXNwb25zZVR5cGUsXG4gICAgb3ZlcnJpZGVNaW1lVHlwZTogb3B0aW9ucy5vdmVycmlkZU1pbWVUeXBlLFxuICB9KTtcbn07XG5cbi8qKlxuICogQXN5bmNocm9ub3VzbHkgcHV0cyBkYXRhIHRvIHRoZSBnaXZlbiByZXNvdXJjZS4gIFJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHRvXG4gKiB0aGUgcmVzdWx0IG9uY2UgbG9hZGVkLCBvciByZWplY3QgaWYgdGhlIHJlc291cmNlIGZhaWxlZCB0byBsb2FkLiAgVGhlIGRhdGEgaXMgbG9hZGVkXG4gKiB1c2luZyBYTUxIdHRwUmVxdWVzdCwgd2hpY2ggbWVhbnMgdGhhdCBpbiBvcmRlciB0byBtYWtlIHJlcXVlc3RzIHRvIGFub3RoZXIgb3JpZ2luLFxuICogdGhlIHNlcnZlciBtdXN0IGhhdmUgQ3Jvc3MtT3JpZ2luIFJlc291cmNlIFNoYXJpbmcgKENPUlMpIGhlYWRlcnMgZW5hYmxlZC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gZGF0YSBEYXRhIHRoYXQgaXMgcG9zdGVkIHdpdGggdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXSBPYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gKiBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMucmVzcG9uc2VUeXBlXSBUaGUgdHlwZSBvZiByZXNwb25zZS4gIFRoaXMgY29udHJvbHMgdGhlIHR5cGUgb2YgaXRlbSByZXR1cm5lZC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5oZWFkZXJzXSBBZGRpdGlvbmFsIEhUVFAgaGVhZGVycyB0byBzZW5kIHdpdGggdGhlIHJlcXVlc3QsIGlmIGFueS5cbiAqIEBwYXJhbSB7U3RyaW5nfSBbb3B0aW9ucy5vdmVycmlkZU1pbWVUeXBlXSBPdmVycmlkZXMgdGhlIE1JTUUgdHlwZSByZXR1cm5lZCBieSB0aGUgc2VydmVyLlxuICogQHJldHVybnMge1Byb21pc2UuPCo+fHVuZGVmaW5lZH0gYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHRvIHRoZSByZXF1ZXN0ZWQgZGF0YSB3aGVuIGxvYWRlZC4gUmV0dXJucyB1bmRlZmluZWQgaWYgPGNvZGU+cmVxdWVzdC50aHJvdHRsZTwvY29kZT4gaXMgdHJ1ZSBhbmQgdGhlIHJlcXVlc3QgZG9lcyBub3QgaGF2ZSBoaWdoIGVub3VnaCBwcmlvcml0eS5cbiAqXG4gKlxuICogQGV4YW1wbGVcbiAqIHJlc291cmNlLnB1dChkYXRhKVxuICogICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAqICAgICAgIC8vIHVzZSB0aGUgcmVzdWx0XG4gKiAgIH0pLm90aGVyd2lzZShmdW5jdGlvbihlcnJvcikge1xuICogICAgICAgLy8gYW4gZXJyb3Igb2NjdXJyZWRcbiAqICAgfSk7XG4gKlxuICogQHNlZSB7QGxpbmsgaHR0cDovL3d3dy53My5vcmcvVFIvY29ycy98Q3Jvc3MtT3JpZ2luIFJlc291cmNlIFNoYXJpbmd9XG4gKiBAc2VlIHtAbGluayBodHRwOi8vd2lraS5jb21tb25qcy5vcmcvd2lraS9Qcm9taXNlcy9BfENvbW1vbkpTIFByb21pc2VzL0F9XG4gKi9cblJlc291cmNlLnByb3RvdHlwZS5wdXQgPSBmdW5jdGlvbiAoZGF0YSwgb3B0aW9ucykge1xuICBDaGVjay5kZWZpbmVkKFwiZGF0YVwiLCBkYXRhKTtcblxuICBvcHRpb25zID0gZGVmYXVsdENsb25lKG9wdGlvbnMsIHt9KTtcbiAgb3B0aW9ucy5tZXRob2QgPSBcIlBVVFwiO1xuICBvcHRpb25zLmRhdGEgPSBkYXRhO1xuXG4gIHJldHVybiB0aGlzLl9tYWtlUmVxdWVzdChvcHRpb25zKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIFJlc291cmNlIGZyb20gYSBVUkwgYW5kIGNhbGxzIHB1dCgpIG9uIGl0LlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIEEgdXJsIG9yIGFuIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllc1xuICogQHBhcmFtIHtTdHJpbmd9IG9wdGlvbnMudXJsIFRoZSB1cmwgb2YgdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMuZGF0YSBEYXRhIHRoYXQgaXMgcG9zdGVkIHdpdGggdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLnF1ZXJ5UGFyYW1ldGVyc10gQW4gb2JqZWN0IGNvbnRhaW5pbmcgcXVlcnkgcGFyYW1ldGVycyB0aGF0IHdpbGwgYmUgc2VudCB3aGVuIHJldHJpZXZpbmcgdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLnRlbXBsYXRlVmFsdWVzXSBLZXkvVmFsdWUgcGFpcnMgdGhhdCBhcmUgdXNlZCB0byByZXBsYWNlIHRlbXBsYXRlIHZhbHVlcyAoZWcuIHt4fSkuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMuaGVhZGVycz17fV0gQWRkaXRpb25hbCBIVFRQIGhlYWRlcnMgdGhhdCB3aWxsIGJlIHNlbnQuXG4gKiBAcGFyYW0ge1Byb3h5fSBbb3B0aW9ucy5wcm94eV0gQSBwcm94eSB0byBiZSB1c2VkIHdoZW4gbG9hZGluZyB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge1Jlc291cmNlLlJldHJ5Q2FsbGJhY2t9IFtvcHRpb25zLnJldHJ5Q2FsbGJhY2tdIFRoZSBGdW5jdGlvbiB0byBjYWxsIHdoZW4gYSByZXF1ZXN0IGZvciB0aGlzIHJlc291cmNlIGZhaWxzLiBJZiBpdCByZXR1cm5zIHRydWUsIHRoZSByZXF1ZXN0IHdpbGwgYmUgcmV0cmllZC5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5yZXRyeUF0dGVtcHRzPTBdIFRoZSBudW1iZXIgb2YgdGltZXMgdGhlIHJldHJ5Q2FsbGJhY2sgc2hvdWxkIGJlIGNhbGxlZCBiZWZvcmUgZ2l2aW5nIHVwLlxuICogQHBhcmFtIHtSZXF1ZXN0fSBbb3B0aW9ucy5yZXF1ZXN0XSBBIFJlcXVlc3Qgb2JqZWN0IHRoYXQgd2lsbCBiZSB1c2VkLiBJbnRlbmRlZCBmb3IgaW50ZXJuYWwgdXNlIG9ubHkuXG4gKiBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMucmVzcG9uc2VUeXBlXSBUaGUgdHlwZSBvZiByZXNwb25zZS4gIFRoaXMgY29udHJvbHMgdGhlIHR5cGUgb2YgaXRlbSByZXR1cm5lZC5cbiAqIEBwYXJhbSB7U3RyaW5nfSBbb3B0aW9ucy5vdmVycmlkZU1pbWVUeXBlXSBPdmVycmlkZXMgdGhlIE1JTUUgdHlwZSByZXR1cm5lZCBieSB0aGUgc2VydmVyLlxuICogQHJldHVybnMge1Byb21pc2UuPCo+fHVuZGVmaW5lZH0gYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHRvIHRoZSByZXF1ZXN0ZWQgZGF0YSB3aGVuIGxvYWRlZC4gUmV0dXJucyB1bmRlZmluZWQgaWYgPGNvZGU+cmVxdWVzdC50aHJvdHRsZTwvY29kZT4gaXMgdHJ1ZSBhbmQgdGhlIHJlcXVlc3QgZG9lcyBub3QgaGF2ZSBoaWdoIGVub3VnaCBwcmlvcml0eS5cbiAqL1xuUmVzb3VyY2UucHV0ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgdmFyIHJlc291cmNlID0gbmV3IFJlc291cmNlKG9wdGlvbnMpO1xuICByZXR1cm4gcmVzb3VyY2UucHV0KG9wdGlvbnMuZGF0YSwge1xuICAgIC8vIE1ha2UgY29weSBvZiBqdXN0IHRoZSBuZWVkZWQgZmllbGRzIGJlY2F1c2UgaGVhZGVycyBjYW4gYmUgcGFzc2VkIHRvIGJvdGggdGhlIGNvbnN0cnVjdG9yIGFuZCB0byBwb3N0XG4gICAgcmVzcG9uc2VUeXBlOiBvcHRpb25zLnJlc3BvbnNlVHlwZSxcbiAgICBvdmVycmlkZU1pbWVUeXBlOiBvcHRpb25zLm92ZXJyaWRlTWltZVR5cGUsXG4gIH0pO1xufTtcblxuLyoqXG4gKiBBc3luY2hyb25vdXNseSBwYXRjaGVzIGRhdGEgdG8gdGhlIGdpdmVuIHJlc291cmNlLiAgUmV0dXJucyBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG9cbiAqIHRoZSByZXN1bHQgb25jZSBsb2FkZWQsIG9yIHJlamVjdCBpZiB0aGUgcmVzb3VyY2UgZmFpbGVkIHRvIGxvYWQuICBUaGUgZGF0YSBpcyBsb2FkZWRcbiAqIHVzaW5nIFhNTEh0dHBSZXF1ZXN0LCB3aGljaCBtZWFucyB0aGF0IGluIG9yZGVyIHRvIG1ha2UgcmVxdWVzdHMgdG8gYW5vdGhlciBvcmlnaW4sXG4gKiB0aGUgc2VydmVyIG11c3QgaGF2ZSBDcm9zcy1PcmlnaW4gUmVzb3VyY2UgU2hhcmluZyAoQ09SUykgaGVhZGVycyBlbmFibGVkLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIERhdGEgdGhhdCBpcyBwb3N0ZWQgd2l0aCB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIE9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqIEBwYXJhbSB7U3RyaW5nfSBbb3B0aW9ucy5yZXNwb25zZVR5cGVdIFRoZSB0eXBlIG9mIHJlc3BvbnNlLiAgVGhpcyBjb250cm9scyB0aGUgdHlwZSBvZiBpdGVtIHJldHVybmVkLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLmhlYWRlcnNdIEFkZGl0aW9uYWwgSFRUUCBoZWFkZXJzIHRvIHNlbmQgd2l0aCB0aGUgcmVxdWVzdCwgaWYgYW55LlxuICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLm92ZXJyaWRlTWltZVR5cGVdIE92ZXJyaWRlcyB0aGUgTUlNRSB0eXBlIHJldHVybmVkIGJ5IHRoZSBzZXJ2ZXIuXG4gKiBAcmV0dXJucyB7UHJvbWlzZS48Kj58dW5kZWZpbmVkfSBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgdG8gdGhlIHJlcXVlc3RlZCBkYXRhIHdoZW4gbG9hZGVkLiBSZXR1cm5zIHVuZGVmaW5lZCBpZiA8Y29kZT5yZXF1ZXN0LnRocm90dGxlPC9jb2RlPiBpcyB0cnVlIGFuZCB0aGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIGhpZ2ggZW5vdWdoIHByaW9yaXR5LlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogcmVzb3VyY2UucGF0Y2goZGF0YSlcbiAqICAgLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gKiAgICAgICAvLyB1c2UgdGhlIHJlc3VsdFxuICogICB9KS5vdGhlcndpc2UoZnVuY3Rpb24oZXJyb3IpIHtcbiAqICAgICAgIC8vIGFuIGVycm9yIG9jY3VycmVkXG4gKiAgIH0pO1xuICpcbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly93d3cudzMub3JnL1RSL2NvcnMvfENyb3NzLU9yaWdpbiBSZXNvdXJjZSBTaGFyaW5nfVxuICogQHNlZSB7QGxpbmsgaHR0cDovL3dpa2kuY29tbW9uanMub3JnL3dpa2kvUHJvbWlzZXMvQXxDb21tb25KUyBQcm9taXNlcy9BfVxuICovXG5SZXNvdXJjZS5wcm90b3R5cGUucGF0Y2ggPSBmdW5jdGlvbiAoZGF0YSwgb3B0aW9ucykge1xuICBDaGVjay5kZWZpbmVkKFwiZGF0YVwiLCBkYXRhKTtcblxuICBvcHRpb25zID0gZGVmYXVsdENsb25lKG9wdGlvbnMsIHt9KTtcbiAgb3B0aW9ucy5tZXRob2QgPSBcIlBBVENIXCI7XG4gIG9wdGlvbnMuZGF0YSA9IGRhdGE7XG5cbiAgcmV0dXJuIHRoaXMuX21ha2VSZXF1ZXN0KG9wdGlvbnMpO1xufTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgUmVzb3VyY2UgZnJvbSBhIFVSTCBhbmQgY2FsbHMgcGF0Y2goKSBvbiBpdC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBBIHVybCBvciBhbiBvYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXNcbiAqIEBwYXJhbSB7U3RyaW5nfSBvcHRpb25zLnVybCBUaGUgdXJsIG9mIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLmRhdGEgRGF0YSB0aGF0IGlzIHBvc3RlZCB3aXRoIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5xdWVyeVBhcmFtZXRlcnNdIEFuIG9iamVjdCBjb250YWluaW5nIHF1ZXJ5IHBhcmFtZXRlcnMgdGhhdCB3aWxsIGJlIHNlbnQgd2hlbiByZXRyaWV2aW5nIHRoZSByZXNvdXJjZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy50ZW1wbGF0ZVZhbHVlc10gS2V5L1ZhbHVlIHBhaXJzIHRoYXQgYXJlIHVzZWQgdG8gcmVwbGFjZSB0ZW1wbGF0ZSB2YWx1ZXMgKGVnLiB7eH0pLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLmhlYWRlcnM9e31dIEFkZGl0aW9uYWwgSFRUUCBoZWFkZXJzIHRoYXQgd2lsbCBiZSBzZW50LlxuICogQHBhcmFtIHtQcm94eX0gW29wdGlvbnMucHJveHldIEEgcHJveHkgdG8gYmUgdXNlZCB3aGVuIGxvYWRpbmcgdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtSZXNvdXJjZS5SZXRyeUNhbGxiYWNrfSBbb3B0aW9ucy5yZXRyeUNhbGxiYWNrXSBUaGUgRnVuY3Rpb24gdG8gY2FsbCB3aGVuIGEgcmVxdWVzdCBmb3IgdGhpcyByZXNvdXJjZSBmYWlscy4gSWYgaXQgcmV0dXJucyB0cnVlLCB0aGUgcmVxdWVzdCB3aWxsIGJlIHJldHJpZWQuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMucmV0cnlBdHRlbXB0cz0wXSBUaGUgbnVtYmVyIG9mIHRpbWVzIHRoZSByZXRyeUNhbGxiYWNrIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGdpdmluZyB1cC5cbiAqIEBwYXJhbSB7UmVxdWVzdH0gW29wdGlvbnMucmVxdWVzdF0gQSBSZXF1ZXN0IG9iamVjdCB0aGF0IHdpbGwgYmUgdXNlZC4gSW50ZW5kZWQgZm9yIGludGVybmFsIHVzZSBvbmx5LlxuICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLnJlc3BvbnNlVHlwZV0gVGhlIHR5cGUgb2YgcmVzcG9uc2UuICBUaGlzIGNvbnRyb2xzIHRoZSB0eXBlIG9mIGl0ZW0gcmV0dXJuZWQuXG4gKiBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMub3ZlcnJpZGVNaW1lVHlwZV0gT3ZlcnJpZGVzIHRoZSBNSU1FIHR5cGUgcmV0dXJuZWQgYnkgdGhlIHNlcnZlci5cbiAqIEByZXR1cm5zIHtQcm9taXNlLjwqPnx1bmRlZmluZWR9IGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB0byB0aGUgcmVxdWVzdGVkIGRhdGEgd2hlbiBsb2FkZWQuIFJldHVybnMgdW5kZWZpbmVkIGlmIDxjb2RlPnJlcXVlc3QudGhyb3R0bGU8L2NvZGU+IGlzIHRydWUgYW5kIHRoZSByZXF1ZXN0IGRvZXMgbm90IGhhdmUgaGlnaCBlbm91Z2ggcHJpb3JpdHkuXG4gKi9cblJlc291cmNlLnBhdGNoID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgdmFyIHJlc291cmNlID0gbmV3IFJlc291cmNlKG9wdGlvbnMpO1xuICByZXR1cm4gcmVzb3VyY2UucGF0Y2gob3B0aW9ucy5kYXRhLCB7XG4gICAgLy8gTWFrZSBjb3B5IG9mIGp1c3QgdGhlIG5lZWRlZCBmaWVsZHMgYmVjYXVzZSBoZWFkZXJzIGNhbiBiZSBwYXNzZWQgdG8gYm90aCB0aGUgY29uc3RydWN0b3IgYW5kIHRvIHBvc3RcbiAgICByZXNwb25zZVR5cGU6IG9wdGlvbnMucmVzcG9uc2VUeXBlLFxuICAgIG92ZXJyaWRlTWltZVR5cGU6IG9wdGlvbnMub3ZlcnJpZGVNaW1lVHlwZSxcbiAgfSk7XG59O1xuXG4vKipcbiAqIENvbnRhaW5zIGltcGxlbWVudGF0aW9ucyBvZiBmdW5jdGlvbnMgdGhhdCBjYW4gYmUgcmVwbGFjZWQgZm9yIHRlc3RpbmdcbiAqXG4gKiBAcHJpdmF0ZVxuICovXG5SZXNvdXJjZS5fSW1wbGVtZW50YXRpb25zID0ge307XG5cbmZ1bmN0aW9uIGxvYWRJbWFnZUVsZW1lbnQodXJsLCBjcm9zc09yaWdpbiwgZGVmZXJyZWQpIHtcbiAgdmFyIGltYWdlID0gbmV3IEltYWdlKCk7XG5cbiAgaW1hZ2Uub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgIGRlZmVycmVkLnJlc29sdmUoaW1hZ2UpO1xuICB9O1xuXG4gIGltYWdlLm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgIGRlZmVycmVkLnJlamVjdChlKTtcbiAgfTtcblxuICBpZiAoY3Jvc3NPcmlnaW4pIHtcbiAgICBpZiAoVHJ1c3RlZFNlcnZlcnMuY29udGFpbnModXJsKSkge1xuICAgICAgaW1hZ2UuY3Jvc3NPcmlnaW4gPSBcInVzZS1jcmVkZW50aWFsc1wiO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbWFnZS5jcm9zc09yaWdpbiA9IFwiXCI7XG4gICAgfVxuICB9XG5cbiAgaW1hZ2Uuc3JjID0gdXJsO1xufVxuXG5SZXNvdXJjZS5fSW1wbGVtZW50YXRpb25zLmNyZWF0ZUltYWdlID0gZnVuY3Rpb24gKFxuICByZXF1ZXN0LFxuICBjcm9zc09yaWdpbixcbiAgZGVmZXJyZWQsXG4gIGZsaXBZLFxuICBza2lwQ29sb3JTcGFjZUNvbnZlcnNpb24sXG4gIHByZWZlckltYWdlQml0bWFwXG4pIHtcbiAgdmFyIHVybCA9IHJlcXVlc3QudXJsO1xuICAvLyBQYXNzaW5nIGFuIEltYWdlIHRvIGNyZWF0ZUltYWdlQml0bWFwIHdpbGwgZm9yY2UgaXQgdG8gcnVuIG9uIHRoZSBtYWluIHRocmVhZFxuICAvLyBzaW5jZSBET00gZWxlbWVudHMgZG9uJ3QgZXhpc3Qgb24gd29ya2Vycy4gV2UgY29udmVydCBpdCB0byBhIGJsb2Igc28gaXQncyBub24tYmxvY2tpbmcuXG4gIC8vIFNlZTpcbiAgLy8gICAgaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTA0NDEwMiNjMzhcbiAgLy8gICAgaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9NTgwMjAyI2MxMFxuICBSZXNvdXJjZS5zdXBwb3J0c0ltYWdlQml0bWFwT3B0aW9ucygpXG4gICAgLnRoZW4oZnVuY3Rpb24gKHN1cHBvcnRzSW1hZ2VCaXRtYXApIHtcbiAgICAgIC8vIFdlIGNhbiBvbmx5IHVzZSBJbWFnZUJpdG1hcCBpZiB3ZSBjYW4gZmxpcCBvbiBkZWNvZGUuXG4gICAgICAvLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9DZXNpdW1HUy9jZXNpdW0vcHVsbC83NTc5I2lzc3VlY29tbWVudC00NjYxNDY4OThcbiAgICAgIGlmICghKHN1cHBvcnRzSW1hZ2VCaXRtYXAgJiYgcHJlZmVySW1hZ2VCaXRtYXApKSB7XG4gICAgICAgIGxvYWRJbWFnZUVsZW1lbnQodXJsLCBjcm9zc09yaWdpbiwgZGVmZXJyZWQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgcmVzcG9uc2VUeXBlID0gXCJibG9iXCI7XG4gICAgICB2YXIgbWV0aG9kID0gXCJHRVRcIjtcbiAgICAgIHZhciB4aHJEZWZlcnJlZCA9IHdoZW4uZGVmZXIoKTtcbiAgICAgIHZhciB4aHIgPSBSZXNvdXJjZS5fSW1wbGVtZW50YXRpb25zLmxvYWRXaXRoWGhyKFxuICAgICAgICB1cmwsXG4gICAgICAgIHJlc3BvbnNlVHlwZSxcbiAgICAgICAgbWV0aG9kLFxuICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgeGhyRGVmZXJyZWQsXG4gICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICB1bmRlZmluZWRcbiAgICAgICk7XG5cbiAgICAgIGlmIChkZWZpbmVkKHhocikgJiYgZGVmaW5lZCh4aHIuYWJvcnQpKSB7XG4gICAgICAgIHJlcXVlc3QuY2FuY2VsRnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgeGhyLmFib3J0KCk7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4geGhyRGVmZXJyZWQucHJvbWlzZVxuICAgICAgICAudGhlbihmdW5jdGlvbiAoYmxvYikge1xuICAgICAgICAgIGlmICghZGVmaW5lZChibG9iKSkge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KFxuICAgICAgICAgICAgICBuZXcgUnVudGltZUVycm9yKFxuICAgICAgICAgICAgICAgIFwiU3VjY2Vzc2Z1bGx5IHJldHJpZXZlZCBcIiArXG4gICAgICAgICAgICAgICAgICB1cmwgK1xuICAgICAgICAgICAgICAgICAgXCIgYnV0IGl0IGNvbnRhaW5lZCBubyBjb250ZW50LlwiXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIFJlc291cmNlLmNyZWF0ZUltYWdlQml0bWFwRnJvbUJsb2IoYmxvYiwge1xuICAgICAgICAgICAgZmxpcFk6IGZsaXBZLFxuICAgICAgICAgICAgcHJlbXVsdGlwbHlBbHBoYTogZmFsc2UsXG4gICAgICAgICAgICBza2lwQ29sb3JTcGFjZUNvbnZlcnNpb246IHNraXBDb2xvclNwYWNlQ29udmVyc2lvbixcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZGVmZXJyZWQucmVzb2x2ZSk7XG4gICAgfSlcbiAgICAub3RoZXJ3aXNlKGRlZmVycmVkLnJlamVjdCk7XG59O1xuXG4vKipcbiAqIFdyYXBwZXIgZm9yIGNyZWF0ZUltYWdlQml0bWFwXG4gKlxuICogQHByaXZhdGVcbiAqL1xuUmVzb3VyY2UuY3JlYXRlSW1hZ2VCaXRtYXBGcm9tQmxvYiA9IGZ1bmN0aW9uIChibG9iLCBvcHRpb25zKSB7XG4gIENoZWNrLmRlZmluZWQoXCJvcHRpb25zXCIsIG9wdGlvbnMpO1xuICBDaGVjay50eXBlT2YuYm9vbChcIm9wdGlvbnMuZmxpcFlcIiwgb3B0aW9ucy5mbGlwWSk7XG4gIENoZWNrLnR5cGVPZi5ib29sKFwib3B0aW9ucy5wcmVtdWx0aXBseUFscGhhXCIsIG9wdGlvbnMucHJlbXVsdGlwbHlBbHBoYSk7XG4gIENoZWNrLnR5cGVPZi5ib29sKFxuICAgIFwib3B0aW9ucy5za2lwQ29sb3JTcGFjZUNvbnZlcnNpb25cIixcbiAgICBvcHRpb25zLnNraXBDb2xvclNwYWNlQ29udmVyc2lvblxuICApO1xuXG4gIHJldHVybiBjcmVhdGVJbWFnZUJpdG1hcChibG9iLCB7XG4gICAgaW1hZ2VPcmllbnRhdGlvbjogb3B0aW9ucy5mbGlwWSA/IFwiZmxpcFlcIiA6IFwibm9uZVwiLFxuICAgIHByZW11bHRpcGx5QWxwaGE6IG9wdGlvbnMucHJlbXVsdGlwbHlBbHBoYSA/IFwicHJlbXVsdGlwbHlcIiA6IFwibm9uZVwiLFxuICAgIGNvbG9yU3BhY2VDb252ZXJzaW9uOiBvcHRpb25zLnNraXBDb2xvclNwYWNlQ29udmVyc2lvbiA/IFwibm9uZVwiIDogXCJkZWZhdWx0XCIsXG4gIH0pO1xufTtcblxuZnVuY3Rpb24gZGVjb2RlUmVzcG9uc2UobG9hZFdpdGhIdHRwUmVzcG9uc2UsIHJlc3BvbnNlVHlwZSkge1xuICBzd2l0Y2ggKHJlc3BvbnNlVHlwZSkge1xuICAgIGNhc2UgXCJ0ZXh0XCI6XG4gICAgICByZXR1cm4gbG9hZFdpdGhIdHRwUmVzcG9uc2UudG9TdHJpbmcoXCJ1dGY4XCIpO1xuICAgIGNhc2UgXCJqc29uXCI6XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShsb2FkV2l0aEh0dHBSZXNwb25zZS50b1N0cmluZyhcInV0ZjhcIikpO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkobG9hZFdpdGhIdHRwUmVzcG9uc2UpLmJ1ZmZlcjtcbiAgfVxufVxuXG5mdW5jdGlvbiBsb2FkV2l0aEh0dHBSZXF1ZXN0KFxuICB1cmwsXG4gIHJlc3BvbnNlVHlwZSxcbiAgbWV0aG9kLFxuICBkYXRhLFxuICBoZWFkZXJzLFxuICBkZWZlcnJlZCxcbiAgb3ZlcnJpZGVNaW1lVHlwZVxuKSB7XG4gIC8vIE5vdGU6IG9ubHkgdGhlICdqc29uJyBhbmQgJ3RleHQnIHJlc3BvbnNlVHlwZXMgdHJhbnNmb3JtcyB0aGUgbG9hZGVkIGJ1ZmZlclxuICAvKiBlc2xpbnQtZGlzYWJsZSBuby11bmRlZiAqL1xuICB2YXIgVVJMID0gcmVxdWlyZShcInVybFwiKS5wYXJzZSh1cmwpO1xuICB2YXIgaHR0cCA9IFVSTC5wcm90b2NvbCA9PT0gXCJodHRwczpcIiA/IHJlcXVpcmUoXCJodHRwc1wiKSA6IHJlcXVpcmUoXCJodHRwXCIpO1xuICB2YXIgemxpYiA9IHJlcXVpcmUoXCJ6bGliXCIpO1xuICAvKiBlc2xpbnQtZW5hYmxlIG5vLXVuZGVmICovXG5cbiAgdmFyIG9wdGlvbnMgPSB7XG4gICAgcHJvdG9jb2w6IFVSTC5wcm90b2NvbCxcbiAgICBob3N0bmFtZTogVVJMLmhvc3RuYW1lLFxuICAgIHBvcnQ6IFVSTC5wb3J0LFxuICAgIHBhdGg6IFVSTC5wYXRoLFxuICAgIHF1ZXJ5OiBVUkwucXVlcnksXG4gICAgbWV0aG9kOiBtZXRob2QsXG4gICAgaGVhZGVyczogaGVhZGVycyxcbiAgfTtcblxuICBodHRwXG4gICAgLnJlcXVlc3Qob3B0aW9ucylcbiAgICAub24oXCJyZXNwb25zZVwiLCBmdW5jdGlvbiAocmVzKSB7XG4gICAgICBpZiAocmVzLnN0YXR1c0NvZGUgPCAyMDAgfHwgcmVzLnN0YXR1c0NvZGUgPj0gMzAwKSB7XG4gICAgICAgIGRlZmVycmVkLnJlamVjdChcbiAgICAgICAgICBuZXcgUmVxdWVzdEVycm9yRXZlbnQocmVzLnN0YXR1c0NvZGUsIHJlcywgcmVzLmhlYWRlcnMpXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIGNodW5rQXJyYXkgPSBbXTtcbiAgICAgIHJlcy5vbihcImRhdGFcIiwgZnVuY3Rpb24gKGNodW5rKSB7XG4gICAgICAgIGNodW5rQXJyYXkucHVzaChjaHVuayk7XG4gICAgICB9KTtcblxuICAgICAgcmVzLm9uKFwiZW5kXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG4gICAgICAgIHZhciByZXN1bHQgPSBCdWZmZXIuY29uY2F0KGNodW5rQXJyYXkpO1xuICAgICAgICBpZiAocmVzLmhlYWRlcnNbXCJjb250ZW50LWVuY29kaW5nXCJdID09PSBcImd6aXBcIikge1xuICAgICAgICAgIHpsaWIuZ3VuemlwKHJlc3VsdCwgZnVuY3Rpb24gKGVycm9yLCByZXN1bHRVbnppcHBlZCkge1xuICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChcbiAgICAgICAgICAgICAgICBuZXcgUnVudGltZUVycm9yKFwiRXJyb3IgZGVjb21wcmVzc2luZyByZXNwb25zZS5cIilcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZGVjb2RlUmVzcG9uc2UocmVzdWx0VW56aXBwZWQsIHJlc3BvbnNlVHlwZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZGVjb2RlUmVzcG9uc2UocmVzdWx0LCByZXNwb25zZVR5cGUpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSlcbiAgICAub24oXCJlcnJvclwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgZGVmZXJyZWQucmVqZWN0KG5ldyBSZXF1ZXN0RXJyb3JFdmVudCgpKTtcbiAgICB9KVxuICAgIC5lbmQoKTtcbn1cblxudmFyIG5vWE1MSHR0cFJlcXVlc3QgPSB0eXBlb2YgWE1MSHR0cFJlcXVlc3QgPT09IFwidW5kZWZpbmVkXCI7XG5SZXNvdXJjZS5fSW1wbGVtZW50YXRpb25zLmxvYWRXaXRoWGhyID0gZnVuY3Rpb24gKFxuICB1cmwsXG4gIHJlc3BvbnNlVHlwZSxcbiAgbWV0aG9kLFxuICBkYXRhLFxuICBoZWFkZXJzLFxuICBkZWZlcnJlZCxcbiAgb3ZlcnJpZGVNaW1lVHlwZVxuKSB7XG4gIHZhciBkYXRhVXJpUmVnZXhSZXN1bHQgPSBkYXRhVXJpUmVnZXguZXhlYyh1cmwpO1xuICBpZiAoZGF0YVVyaVJlZ2V4UmVzdWx0ICE9PSBudWxsKSB7XG4gICAgZGVmZXJyZWQucmVzb2x2ZShkZWNvZGVEYXRhVXJpKGRhdGFVcmlSZWdleFJlc3VsdCwgcmVzcG9uc2VUeXBlKSk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKG5vWE1MSHR0cFJlcXVlc3QpIHtcbiAgICBsb2FkV2l0aEh0dHBSZXF1ZXN0KFxuICAgICAgdXJsLFxuICAgICAgcmVzcG9uc2VUeXBlLFxuICAgICAgbWV0aG9kLFxuICAgICAgZGF0YSxcbiAgICAgIGhlYWRlcnMsXG4gICAgICBkZWZlcnJlZCxcbiAgICAgIG92ZXJyaWRlTWltZVR5cGVcbiAgICApO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICBpZiAoVHJ1c3RlZFNlcnZlcnMuY29udGFpbnModXJsKSkge1xuICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlO1xuICB9XG5cbiAgeGhyLm9wZW4obWV0aG9kLCB1cmwsIHRydWUpO1xuXG4gIGlmIChkZWZpbmVkKG92ZXJyaWRlTWltZVR5cGUpICYmIGRlZmluZWQoeGhyLm92ZXJyaWRlTWltZVR5cGUpKSB7XG4gICAgeGhyLm92ZXJyaWRlTWltZVR5cGUob3ZlcnJpZGVNaW1lVHlwZSk7XG4gIH1cblxuICBpZiAoZGVmaW5lZChoZWFkZXJzKSkge1xuICAgIGZvciAodmFyIGtleSBpbiBoZWFkZXJzKSB7XG4gICAgICBpZiAoaGVhZGVycy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKGtleSwgaGVhZGVyc1trZXldKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAoZGVmaW5lZChyZXNwb25zZVR5cGUpKSB7XG4gICAgeGhyLnJlc3BvbnNlVHlwZSA9IHJlc3BvbnNlVHlwZTtcbiAgfVxuXG4gIC8vIFdoaWxlIG5vbi1zdGFuZGFyZCwgZmlsZSBwcm90b2NvbCBhbHdheXMgcmV0dXJucyBhIHN0YXR1cyBvZiAwIG9uIHN1Y2Nlc3NcbiAgdmFyIGxvY2FsRmlsZSA9IGZhbHNlO1xuICBpZiAodHlwZW9mIHVybCA9PT0gXCJzdHJpbmdcIikge1xuICAgIGxvY2FsRmlsZSA9XG4gICAgICB1cmwuaW5kZXhPZihcImZpbGU6Ly9cIikgPT09IDAgfHxcbiAgICAgICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4gPT09IFwiZmlsZTovL1wiKTtcbiAgfVxuXG4gIHhoci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKFxuICAgICAgKHhoci5zdGF0dXMgPCAyMDAgfHwgeGhyLnN0YXR1cyA+PSAzMDApICYmXG4gICAgICAhKGxvY2FsRmlsZSAmJiB4aHIuc3RhdHVzID09PSAwKVxuICAgICkge1xuICAgICAgZGVmZXJyZWQucmVqZWN0KFxuICAgICAgICBuZXcgUmVxdWVzdEVycm9yRXZlbnQoXG4gICAgICAgICAgeGhyLnN0YXR1cyxcbiAgICAgICAgICB4aHIucmVzcG9uc2UsXG4gICAgICAgICAgeGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIHJlc3BvbnNlID0geGhyLnJlc3BvbnNlO1xuICAgIHZhciBicm93c2VyUmVzcG9uc2VUeXBlID0geGhyLnJlc3BvbnNlVHlwZTtcblxuICAgIGlmIChtZXRob2QgPT09IFwiSEVBRFwiIHx8IG1ldGhvZCA9PT0gXCJPUFRJT05TXCIpIHtcbiAgICAgIHZhciByZXNwb25zZUhlYWRlclN0cmluZyA9IHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKTtcbiAgICAgIHZhciBzcGxpdEhlYWRlcnMgPSByZXNwb25zZUhlYWRlclN0cmluZy50cmltKCkuc3BsaXQoL1tcXHJcXG5dKy8pO1xuXG4gICAgICB2YXIgcmVzcG9uc2VIZWFkZXJzID0ge307XG4gICAgICBzcGxpdEhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbiAobGluZSkge1xuICAgICAgICB2YXIgcGFydHMgPSBsaW5lLnNwbGl0KFwiOiBcIik7XG4gICAgICAgIHZhciBoZWFkZXIgPSBwYXJ0cy5zaGlmdCgpO1xuICAgICAgICByZXNwb25zZUhlYWRlcnNbaGVhZGVyXSA9IHBhcnRzLmpvaW4oXCI6IFwiKTtcbiAgICAgIH0pO1xuXG4gICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3BvbnNlSGVhZGVycyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy9BbGwgbW9kZXJuIGJyb3dzZXJzIHdpbGwgZ28gaW50byBlaXRoZXIgdGhlIGZpcnN0IG9yIHNlY29uZCBpZiBibG9jayBvciBsYXN0IGVsc2UgYmxvY2suXG4gICAgLy9PdGhlciBjb2RlIHBhdGhzIHN1cHBvcnQgb2xkZXIgYnJvd3NlcnMgdGhhdCBlaXRoZXIgZG8gbm90IHN1cHBvcnQgdGhlIHN1cHBsaWVkIHJlc3BvbnNlVHlwZVxuICAgIC8vb3IgZG8gbm90IHN1cHBvcnQgdGhlIHhoci5yZXNwb25zZSBwcm9wZXJ0eS5cbiAgICBpZiAoeGhyLnN0YXR1cyA9PT0gMjA0KSB7XG4gICAgICAvLyBhY2NlcHQgbm8gY29udGVudFxuICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgIH0gZWxzZSBpZiAoXG4gICAgICBkZWZpbmVkKHJlc3BvbnNlKSAmJlxuICAgICAgKCFkZWZpbmVkKHJlc3BvbnNlVHlwZSkgfHwgYnJvd3NlclJlc3BvbnNlVHlwZSA9PT0gcmVzcG9uc2VUeXBlKVxuICAgICkge1xuICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXNwb25zZSk7XG4gICAgfSBlbHNlIGlmIChyZXNwb25zZVR5cGUgPT09IFwianNvblwiICYmIHR5cGVvZiByZXNwb25zZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShKU09OLnBhcnNlKHJlc3BvbnNlKSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGRlZmVycmVkLnJlamVjdChlKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKFxuICAgICAgKGJyb3dzZXJSZXNwb25zZVR5cGUgPT09IFwiXCIgfHwgYnJvd3NlclJlc3BvbnNlVHlwZSA9PT0gXCJkb2N1bWVudFwiKSAmJlxuICAgICAgZGVmaW5lZCh4aHIucmVzcG9uc2VYTUwpICYmXG4gICAgICB4aHIucmVzcG9uc2VYTUwuaGFzQ2hpbGROb2RlcygpXG4gICAgKSB7XG4gICAgICBkZWZlcnJlZC5yZXNvbHZlKHhoci5yZXNwb25zZVhNTCk7XG4gICAgfSBlbHNlIGlmIChcbiAgICAgIChicm93c2VyUmVzcG9uc2VUeXBlID09PSBcIlwiIHx8IGJyb3dzZXJSZXNwb25zZVR5cGUgPT09IFwidGV4dFwiKSAmJlxuICAgICAgZGVmaW5lZCh4aHIucmVzcG9uc2VUZXh0KVxuICAgICkge1xuICAgICAgZGVmZXJyZWQucmVzb2x2ZSh4aHIucmVzcG9uc2VUZXh0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGVmZXJyZWQucmVqZWN0KFxuICAgICAgICBuZXcgUnVudGltZUVycm9yKFwiSW52YWxpZCBYTUxIdHRwUmVxdWVzdCByZXNwb25zZSB0eXBlLlwiKVxuICAgICAgKTtcbiAgICB9XG4gIH07XG5cbiAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgIGRlZmVycmVkLnJlamVjdChuZXcgUmVxdWVzdEVycm9yRXZlbnQoKSk7XG4gIH07XG5cbiAgeGhyLnNlbmQoZGF0YSk7XG5cbiAgcmV0dXJuIHhocjtcbn07XG5cblJlc291cmNlLl9JbXBsZW1lbnRhdGlvbnMubG9hZEFuZEV4ZWN1dGVTY3JpcHQgPSBmdW5jdGlvbiAoXG4gIHVybCxcbiAgZnVuY3Rpb25OYW1lLFxuICBkZWZlcnJlZFxuKSB7XG4gIHJldHVybiBsb2FkQW5kRXhlY3V0ZVNjcmlwdCh1cmwsIGZ1bmN0aW9uTmFtZSkub3RoZXJ3aXNlKGRlZmVycmVkLnJlamVjdCk7XG59O1xuXG4vKipcbiAqIFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uc1xuICpcbiAqIEBwcml2YXRlXG4gKi9cblJlc291cmNlLl9EZWZhdWx0SW1wbGVtZW50YXRpb25zID0ge307XG5SZXNvdXJjZS5fRGVmYXVsdEltcGxlbWVudGF0aW9ucy5jcmVhdGVJbWFnZSA9XG4gIFJlc291cmNlLl9JbXBsZW1lbnRhdGlvbnMuY3JlYXRlSW1hZ2U7XG5SZXNvdXJjZS5fRGVmYXVsdEltcGxlbWVudGF0aW9ucy5sb2FkV2l0aFhociA9XG4gIFJlc291cmNlLl9JbXBsZW1lbnRhdGlvbnMubG9hZFdpdGhYaHI7XG5SZXNvdXJjZS5fRGVmYXVsdEltcGxlbWVudGF0aW9ucy5sb2FkQW5kRXhlY3V0ZVNjcmlwdCA9XG4gIFJlc291cmNlLl9JbXBsZW1lbnRhdGlvbnMubG9hZEFuZEV4ZWN1dGVTY3JpcHQ7XG5cbi8qKlxuICogQSByZXNvdXJjZSBpbnN0YW5jZSBpbml0aWFsaXplZCB0byB0aGUgY3VycmVudCBicm93c2VyIGxvY2F0aW9uXG4gKlxuICogQHR5cGUge1Jlc291cmNlfVxuICogQGNvbnN0YW50XG4gKi9cblJlc291cmNlLkRFRkFVTFQgPSBPYmplY3QuZnJlZXplKFxuICBuZXcgUmVzb3VyY2Uoe1xuICAgIHVybDpcbiAgICAgIHR5cGVvZiBkb2N1bWVudCA9PT0gXCJ1bmRlZmluZWRcIlxuICAgICAgICA/IFwiXCJcbiAgICAgICAgOiBkb2N1bWVudC5sb2NhdGlvbi5ocmVmLnNwbGl0KFwiP1wiKVswXSxcbiAgfSlcbik7XG5cbi8qKlxuICogQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eS5cbiAqIEBjYWxsYmFjayBSZXNvdXJjZS5SZXRyeUNhbGxiYWNrXG4gKlxuICogQHBhcmFtIHtSZXNvdXJjZX0gW3Jlc291cmNlXSBUaGUgcmVzb3VyY2UgdGhhdCBmYWlsZWQgdG8gbG9hZC5cbiAqIEBwYXJhbSB7RXJyb3J9IFtlcnJvcl0gVGhlIGVycm9yIHRoYXQgb2NjdXJyZWQgZHVyaW5nIHRoZSBsb2FkaW5nIG9mIHRoZSByZXNvdXJjZS5cbiAqIEByZXR1cm5zIHtCb29sZWFufFByb21pc2U8Qm9vbGVhbj59IElmIHRydWUgb3IgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZWQgdG8gdHJ1ZSwgdGhlIHJlc291cmNlIHdpbGwgYmUgcmV0cmllZC4gT3RoZXJ3aXNlIHRoZSBmYWlsdXJlIHdpbGwgYmUgcmV0dXJuZWQuXG4gKi9cbmV4cG9ydCBkZWZhdWx0IFJlc291cmNlO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///68985\n')},9407:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _defined_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(82982);\n\n\n/**\n * Constructs an exception object that is thrown due to an error that can occur at runtime, e.g.,\n * out of memory, could not compile shader, etc.  If a function may throw this\n * exception, the calling code should be prepared to catch it.\n * <br /><br />\n * On the other hand, a {@link DeveloperError} indicates an exception due\n * to a developer error, e.g., invalid argument, that usually indicates a bug in the\n * calling code.\n *\n * @alias RuntimeError\n * @constructor\n * @extends Error\n *\n * @param {String} [message] The error message for this exception.\n *\n * @see DeveloperError\n */\nfunction RuntimeError(message) {\n  /**\n   * \'RuntimeError\' indicating that this exception was thrown due to a runtime error.\n   * @type {String}\n   * @readonly\n   */\n  this.name = "RuntimeError";\n\n  /**\n   * The explanation for why this exception was thrown.\n   * @type {String}\n   * @readonly\n   */\n  this.message = message;\n\n  //Browsers such as IE don\'t have a stack property until you actually throw the error.\n  var stack;\n  try {\n    throw new Error();\n  } catch (e) {\n    stack = e.stack;\n  }\n\n  /**\n   * The stack trace of this exception, if available.\n   * @type {String}\n   * @readonly\n   */\n  this.stack = stack;\n}\n\nif ((0,_defined_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(Object.create)) {\n  RuntimeError.prototype = Object.create(Error.prototype);\n  RuntimeError.prototype.constructor = RuntimeError;\n}\n\nRuntimeError.prototype.toString = function () {\n  var str = this.name + ": " + this.message;\n\n  if ((0,_defined_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(this.stack)) {\n    str += "\\n" + this.stack.toString();\n  }\n\n  return str;\n};\n/* harmony default export */ __webpack_exports__["Z"] = (RuntimeError);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTQwNy5qcyIsIm1hcHBpbmdzIjoiO0FBQW1DOztBQUVuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHNCQUFzQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxJQUFJLGdFQUFPO0FBQ1g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsTUFBTSxnRUFBTztBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHlEQUFlLFlBQVksRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9Db3JlL1J1bnRpbWVFcnJvci5qcz9lYWM1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBkZWZpbmVkIGZyb20gXCIuL2RlZmluZWQuanNcIjtcblxuLyoqXG4gKiBDb25zdHJ1Y3RzIGFuIGV4Y2VwdGlvbiBvYmplY3QgdGhhdCBpcyB0aHJvd24gZHVlIHRvIGFuIGVycm9yIHRoYXQgY2FuIG9jY3VyIGF0IHJ1bnRpbWUsIGUuZy4sXG4gKiBvdXQgb2YgbWVtb3J5LCBjb3VsZCBub3QgY29tcGlsZSBzaGFkZXIsIGV0Yy4gIElmIGEgZnVuY3Rpb24gbWF5IHRocm93IHRoaXNcbiAqIGV4Y2VwdGlvbiwgdGhlIGNhbGxpbmcgY29kZSBzaG91bGQgYmUgcHJlcGFyZWQgdG8gY2F0Y2ggaXQuXG4gKiA8YnIgLz48YnIgLz5cbiAqIE9uIHRoZSBvdGhlciBoYW5kLCBhIHtAbGluayBEZXZlbG9wZXJFcnJvcn0gaW5kaWNhdGVzIGFuIGV4Y2VwdGlvbiBkdWVcbiAqIHRvIGEgZGV2ZWxvcGVyIGVycm9yLCBlLmcuLCBpbnZhbGlkIGFyZ3VtZW50LCB0aGF0IHVzdWFsbHkgaW5kaWNhdGVzIGEgYnVnIGluIHRoZVxuICogY2FsbGluZyBjb2RlLlxuICpcbiAqIEBhbGlhcyBSdW50aW1lRXJyb3JcbiAqIEBjb25zdHJ1Y3RvclxuICogQGV4dGVuZHMgRXJyb3JcbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gW21lc3NhZ2VdIFRoZSBlcnJvciBtZXNzYWdlIGZvciB0aGlzIGV4Y2VwdGlvbi5cbiAqXG4gKiBAc2VlIERldmVsb3BlckVycm9yXG4gKi9cbmZ1bmN0aW9uIFJ1bnRpbWVFcnJvcihtZXNzYWdlKSB7XG4gIC8qKlxuICAgKiAnUnVudGltZUVycm9yJyBpbmRpY2F0aW5nIHRoYXQgdGhpcyBleGNlcHRpb24gd2FzIHRocm93biBkdWUgdG8gYSBydW50aW1lIGVycm9yLlxuICAgKiBAdHlwZSB7U3RyaW5nfVxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIHRoaXMubmFtZSA9IFwiUnVudGltZUVycm9yXCI7XG5cbiAgLyoqXG4gICAqIFRoZSBleHBsYW5hdGlvbiBmb3Igd2h5IHRoaXMgZXhjZXB0aW9uIHdhcyB0aHJvd24uXG4gICAqIEB0eXBlIHtTdHJpbmd9XG4gICAqIEByZWFkb25seVxuICAgKi9cbiAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcblxuICAvL0Jyb3dzZXJzIHN1Y2ggYXMgSUUgZG9uJ3QgaGF2ZSBhIHN0YWNrIHByb3BlcnR5IHVudGlsIHlvdSBhY3R1YWxseSB0aHJvdyB0aGUgZXJyb3IuXG4gIHZhciBzdGFjaztcbiAgdHJ5IHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHN0YWNrID0gZS5zdGFjaztcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgc3RhY2sgdHJhY2Ugb2YgdGhpcyBleGNlcHRpb24sIGlmIGF2YWlsYWJsZS5cbiAgICogQHR5cGUge1N0cmluZ31cbiAgICogQHJlYWRvbmx5XG4gICAqL1xuICB0aGlzLnN0YWNrID0gc3RhY2s7XG59XG5cbmlmIChkZWZpbmVkKE9iamVjdC5jcmVhdGUpKSB7XG4gIFJ1bnRpbWVFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG4gIFJ1bnRpbWVFcnJvci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBSdW50aW1lRXJyb3I7XG59XG5cblJ1bnRpbWVFcnJvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBzdHIgPSB0aGlzLm5hbWUgKyBcIjogXCIgKyB0aGlzLm1lc3NhZ2U7XG5cbiAgaWYgKGRlZmluZWQodGhpcy5zdGFjaykpIHtcbiAgICBzdHIgKz0gXCJcXG5cIiArIHRoaXMuc3RhY2sudG9TdHJpbmcoKTtcbiAgfVxuXG4gIHJldHVybiBzdHI7XG59O1xuZXhwb3J0IGRlZmF1bHQgUnVudGltZUVycm9yO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///9407\n')}}]);