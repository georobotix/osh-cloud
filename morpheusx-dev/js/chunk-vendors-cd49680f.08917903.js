"use strict";(self["webpackChunkvue3_webpack5"]=self["webpackChunkvue3_webpack5"]||[]).push([[824],{61773:function(e,t,n){n.d(t,{Z:function(){return g}});var r=n(82982),o=n(86511),i=n(12572),s=n(22426),c=n(63181),u=n(6224),a=n(82968),h=n(9407),l=n(13222),f=n(41059),_=n(95563),p=n(20107),y=n(16240);function g(e,t,n,r){this._tileset=e,this._tile=t,this._tilesetResource=n,this._contents=[];var o=r.content;this._innerContentHeaders=o,this._requestsInFlight=0,this._cancelCount=0;var i=this._innerContentHeaders.length;this._arrayFetchPromises=new Array(i),this._requests=new Array(i),this._innerContentResources=new Array(i),this._serverKeys=new Array(i);for(var s=0;s<i;s++){var u=n.getDerivedResource({url:o[s].uri}),a=c.Z.getServerKey(u.getUrlComponent());this._innerContentResources[s]=u,this._serverKeys[s]=a}this._contentsFetchedPromise=void 0,this._readyPromise=l.Z.defer()}function d(e,t){e._requestsInFlight+=t,e.tileset.statistics.numberOfPendingRequests+=t}function v(e,t){e._cancelCount++,e._tile._contentState=t,e.tileset.statistics.numberOfPendingRequests-=e._requestsInFlight,e._requestsInFlight=0;var n=e._innerContentHeaders.length;e._arrayFetchPromises=new Array(n)}function m(e){for(var t={},n=0;n<e.length;n++){var o=e[n];(0,r.Z)(t[o])?t[o]++:t[o]=1}for(var i in t)if(t.hasOwnProperty(i)&&!c.Z.serverHasOpenSlots(i,t[i]))return!1;return c.Z.heapHasOpenSlots(e.length)}function P(e,t,n,r){var o=e._innerContentResources[t].clone(),i=e.tile,c=function(){return i._priority},h=e._serverKeys[t],l=new s.Z({throttle:!0,throttleByServer:!0,type:a.Z.TILES3D,priorityFunction:c,serverKey:h});return o.request=l,e._requests[t]=l,o.fetchArrayBuffer().then((function(t){if(!(n<e._cancelCount))return d(e,-1),t})).otherwise((function(i){n<e._cancelCount||(o.request.state!==u.Z.CANCELLED?(d(e,-1),b(e,t,i)):v(e,r))}))}function Z(e){var t=e._cancelCount;l.Z.all(e._arrayFetchPromises).then((function(n){if(!(t<e._cancelCount))return n.map((function(t,n){if((0,r.Z)(t))try{return C(e,t,n)}catch(o){return void b(e,n,o)}}))})).then((function(t){(0,r.Z)(t)?(e._contents=t.filter(r.Z),F(e),(0,r.Z)(e._contentsFetchedPromise)&&e._contentsFetchedPromise.resolve()):(0,r.Z)(e._contentsFetchedPromise)&&(e._contentsFetchedPromise.resolve(),e._contentsFetchedPromise=void 0)})).otherwise((function(t){(0,r.Z)(e._contentsFetchedPromise)&&e._contentsFetchedPromise.reject(t)}))}function C(e,t,n){var o=(0,y.Z)(t);if(o.contentType===f.Z.EXTERNAL_TILESET)throw new h.Z("External tilesets are disallowed inside the 3DTILES_multiple_contents extension");e._disableSkipLevelOfDetail=e._disableSkipLevelOfDetail||o.contentType===f.Z.GEOMETRY||o.contentType===f.Z.VECTOR;var i,s=e._tileset,c=e._innerContentResources[n],u=_.Z[o.contentType];i=(0,r.Z)(o.binaryPayload)?u(s,e._tile,c,o.binaryPayload.buffer,0):u(s,e._tile,c,o.jsonPayload);var a=e._innerContentHeaders[n];return i.groupMetadata=(0,p.Z)(s,a),i}function F(e){var t=e._contents.map((function(e){return e.readyPromise}));l.Z.all(t).then((function(){e._readyPromise.resolve(e)})).otherwise((function(t){e._readyPromise.reject(t)}))}function b(e,t,n){var o=e._tileset,i=e._innerContentResources[t].url,s=(0,r.Z)(n.message)?n.message:n.toString();o.tileFailed.numberOfListeners>0?o.tileFailed.raiseEvent({url:i,message:s}):(console.log("A content failed to load: "+i),console.log("Error: "+s))}Object.defineProperties(g.prototype,{featurePropertiesDirty:{get:function(){for(var e=this._contents,t=e.length,n=0;n<t;++n)if(e[n].featurePropertiesDirty)return!0;return!1},set:function(e){for(var t=this._contents,n=t.length,r=0;r<n;++r)t[r].featurePropertiesDirty=e}},featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){return this._contents}},readyPromise:{get:function(){return this._readyPromise.promise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){}},batchTable:{get:function(){}},groupMetadata:{get:function(){},set:function(){throw new i.Z("Multiple3DTileContent cannot have group metadata")}},innerContentUrls:{get:function(){return this._innerContentHeaders.map((function(e){return e.uri}))}},contentsFetchedPromise:{get:function(){if((0,r.Z)(this._contentsFetchedPromise))return this._contentsFetchedPromise.promise}}}),g.prototype.requestInnerContents=function(){if(!m(this._serverKeys))return this._serverKeys.length;var e=this._innerContentHeaders;d(this,e.length);for(var t=0;t<e.length;t++)this._arrayFetchPromises[t]=P(this,t,this._cancelCount,this._tile._contentState);return(0,r.Z)(this._contentsFetchedPromise)||(this._contentsFetchedPromise=l.Z.defer()),Z(this),0},g.prototype.cancelRequests=function(){for(var e=0;e<this._requests.length;e++){var t=this._requests[e];(0,r.Z)(t)&&t.cancel()}},g.prototype.hasProperty=function(e,t){return!1},g.prototype.getFeature=function(e){},g.prototype.applyDebugSettings=function(e,t){for(var n=this._contents,r=n.length,o=0;o<r;++o)n[o].applyDebugSettings(e,t)},g.prototype.applyStyle=function(e){for(var t=this._contents,n=t.length,r=0;r<n;++r)t[r].applyStyle(e)},g.prototype.update=function(e,t){for(var n=this._contents,r=n.length,o=0;o<r;++o)n[o].update(e,t)},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){for(var e=this._contents,t=e.length,n=0;n<t;++n)e[n].destroy();return(0,o.Z)(this)}},77706:function(){function e(e){}e.prototype.isReady=function(){return!0},e.prototype.shouldDiscardImage=function(e){return!1}}}]);
//# sourceMappingURL=chunk-vendors-cd49680f.08917903.js.map