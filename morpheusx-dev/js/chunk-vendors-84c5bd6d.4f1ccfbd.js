"use strict";(self["webpackChunkvue3_webpack5"]=self["webpackChunkvue3_webpack5"]||[]).push([[9504],{45216:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(88108);\n/* harmony import */ var _Core_Color_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(59947);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(82982);\n/* harmony import */ var _Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(86511);\n/* harmony import */ var _Core_PixelFormat_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(38443);\n/* harmony import */ var _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(52200);\n/* harmony import */ var _Renderer_ClearCommand_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(39899);\n/* harmony import */ var _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(60072);\n/* harmony import */ var _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2932);\n/* harmony import */ var _Renderer_PixelDatatype_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(21572);\n/* harmony import */ var _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(10667);\n/* harmony import */ var _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(53642);\n/* harmony import */ var _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(8743);\n/* harmony import */ var _Shaders_AdjustTranslucentFS_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(81154);\n/* harmony import */ var _Shaders_CompositeOITFS_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(19065);\n/* harmony import */ var _BlendEquation_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(33306);\n/* harmony import */ var _BlendFunction_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(18796);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * @private\n */\nfunction OIT(context) {\n  // We support multipass for the Chrome D3D9 backend and ES 2.0 on mobile.\n  this._translucentMultipassSupport = false;\n  this._translucentMRTSupport = false;\n\n  var extensionsSupported = context.colorBufferFloat && context.depthTexture;\n  this._translucentMRTSupport = context.drawBuffers && extensionsSupported;\n  this._translucentMultipassSupport =\n    !this._translucentMRTSupport && extensionsSupported;\n\n  this._opaqueFBO = undefined;\n  this._opaqueTexture = undefined;\n  this._depthStencilTexture = undefined;\n\n  this._accumulationTexture = undefined;\n\n  this._translucentFBO = undefined;\n  this._alphaFBO = undefined;\n\n  this._adjustTranslucentFBO = undefined;\n  this._adjustAlphaFBO = undefined;\n\n  this._opaqueClearCommand = new _Renderer_ClearCommand_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z({\n    color: new _Core_Color_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z(0.0, 0.0, 0.0, 0.0),\n    owner: this,\n  });\n  this._translucentMRTClearCommand = new _Renderer_ClearCommand_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z({\n    color: new _Core_Color_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z(0.0, 0.0, 0.0, 1.0),\n    owner: this,\n  });\n  this._translucentMultipassClearCommand = new _Renderer_ClearCommand_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z({\n    color: new _Core_Color_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z(0.0, 0.0, 0.0, 0.0),\n    owner: this,\n  });\n  this._alphaClearCommand = new _Renderer_ClearCommand_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z({\n    color: new _Core_Color_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z(1.0, 1.0, 1.0, 1.0),\n    owner: this,\n  });\n\n  this._translucentRenderStateCache = {};\n  this._alphaRenderStateCache = {};\n\n  this._compositeCommand = undefined;\n  this._adjustTranslucentCommand = undefined;\n  this._adjustAlphaCommand = undefined;\n\n  this._viewport = new _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\n  this._rs = undefined;\n\n  this._useScissorTest = false;\n  this._scissorRectangle = undefined;\n\n  this._useHDR = false;\n}\n\nfunction destroyTextures(oit) {\n  oit._accumulationTexture =\n    oit._accumulationTexture &&\n    !oit._accumulationTexture.isDestroyed() &&\n    oit._accumulationTexture.destroy();\n  oit._revealageTexture =\n    oit._revealageTexture &&\n    !oit._revealageTexture.isDestroyed() &&\n    oit._revealageTexture.destroy();\n}\n\nfunction destroyFramebuffers(oit) {\n  oit._translucentFBO =\n    oit._translucentFBO &&\n    !oit._translucentFBO.isDestroyed() &&\n    oit._translucentFBO.destroy();\n  oit._alphaFBO =\n    oit._alphaFBO && !oit._alphaFBO.isDestroyed() && oit._alphaFBO.destroy();\n  oit._adjustTranslucentFBO =\n    oit._adjustTranslucentFBO &&\n    !oit._adjustTranslucentFBO.isDestroyed() &&\n    oit._adjustTranslucentFBO.destroy();\n  oit._adjustAlphaFBO =\n    oit._adjustAlphaFBO &&\n    !oit._adjustAlphaFBO.isDestroyed() &&\n    oit._adjustAlphaFBO.destroy();\n}\n\nfunction destroyResources(oit) {\n  destroyTextures(oit);\n  destroyFramebuffers(oit);\n}\n\nfunction updateTextures(oit, context, width, height) {\n  destroyTextures(oit);\n\n  oit._accumulationTexture = new _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z({\n    context: context,\n    width: width,\n    height: height,\n    pixelFormat: _Core_PixelFormat_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].RGBA */ .Z.RGBA,\n    pixelDatatype: _Renderer_PixelDatatype_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].FLOAT */ .Z.FLOAT,\n  });\n\n  // Use zeroed arraybuffer instead of null to initialize texture\n  // to workaround Firefox. Only needed for the second color attachment.\n  var source = new Float32Array(width * height * 4);\n  oit._revealageTexture = new _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z({\n    context: context,\n    pixelFormat: _Core_PixelFormat_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].RGBA */ .Z.RGBA,\n    pixelDatatype: _Renderer_PixelDatatype_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].FLOAT */ .Z.FLOAT,\n    source: {\n      arrayBufferView: source,\n      width: width,\n      height: height,\n    },\n    flipY: false,\n  });\n}\n\nfunction updateFramebuffers(oit, context) {\n  destroyFramebuffers(oit);\n\n  var completeFBO = _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].FRAMEBUFFER_COMPLETE */ .Z.FRAMEBUFFER_COMPLETE;\n  var supported = true;\n\n  // if MRT is supported, attempt to make an FBO with multiple color attachments\n  if (oit._translucentMRTSupport) {\n    oit._translucentFBO = new _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n      context: context,\n      colorTextures: [oit._accumulationTexture, oit._revealageTexture],\n      depthStencilTexture: oit._depthStencilTexture,\n      destroyAttachments: false,\n    });\n    oit._adjustTranslucentFBO = new _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n      context: context,\n      colorTextures: [oit._accumulationTexture, oit._revealageTexture],\n      destroyAttachments: false,\n    });\n\n    if (\n      oit._translucentFBO.status !== completeFBO ||\n      oit._adjustTranslucentFBO.status !== completeFBO\n    ) {\n      destroyFramebuffers(oit);\n      oit._translucentMRTSupport = false;\n    }\n  }\n\n  // either MRT isn\'t supported or FBO creation failed, attempt multipass\n  if (!oit._translucentMRTSupport) {\n    oit._translucentFBO = new _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n      context: context,\n      colorTextures: [oit._accumulationTexture],\n      depthStencilTexture: oit._depthStencilTexture,\n      destroyAttachments: false,\n    });\n    oit._alphaFBO = new _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n      context: context,\n      colorTextures: [oit._revealageTexture],\n      depthStencilTexture: oit._depthStencilTexture,\n      destroyAttachments: false,\n    });\n    oit._adjustTranslucentFBO = new _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n      context: context,\n      colorTextures: [oit._accumulationTexture],\n      destroyAttachments: false,\n    });\n    oit._adjustAlphaFBO = new _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n      context: context,\n      colorTextures: [oit._revealageTexture],\n      destroyAttachments: false,\n    });\n\n    var translucentComplete = oit._translucentFBO.status === completeFBO;\n    var alphaComplete = oit._alphaFBO.status === completeFBO;\n    var adjustTranslucentComplete =\n      oit._adjustTranslucentFBO.status === completeFBO;\n    var adjustAlphaComplete = oit._adjustAlphaFBO.status === completeFBO;\n    if (\n      !translucentComplete ||\n      !alphaComplete ||\n      !adjustTranslucentComplete ||\n      !adjustAlphaComplete\n    ) {\n      destroyResources(oit);\n      oit._translucentMultipassSupport = false;\n      supported = false;\n    }\n  }\n\n  return supported;\n}\n\nOIT.prototype.update = function (context, passState, framebuffer, useHDR) {\n  if (!this.isSupported()) {\n    return;\n  }\n\n  this._opaqueFBO = framebuffer;\n  this._opaqueTexture = framebuffer.getColorTexture(0);\n  this._depthStencilTexture = framebuffer.depthStencilTexture;\n\n  var width = this._opaqueTexture.width;\n  var height = this._opaqueTexture.height;\n\n  var accumulationTexture = this._accumulationTexture;\n  var textureChanged =\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(accumulationTexture) ||\n    accumulationTexture.width !== width ||\n    accumulationTexture.height !== height ||\n    useHDR !== this._useHDR;\n  if (textureChanged) {\n    updateTextures(this, context, width, height);\n  }\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(this._translucentFBO) || textureChanged) {\n    if (!updateFramebuffers(this, context)) {\n      // framebuffer creation failed\n      return;\n    }\n  }\n\n  this._useHDR = useHDR;\n\n  var that = this;\n  var fs;\n  var uniformMap;\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(this._compositeCommand)) {\n    fs = new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z({\n      sources: [_Shaders_CompositeOITFS_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z],\n    });\n    if (this._translucentMRTSupport) {\n      fs.defines.push("MRT");\n    }\n\n    uniformMap = {\n      u_opaque: function () {\n        return that._opaqueTexture;\n      },\n      u_accumulation: function () {\n        return that._accumulationTexture;\n      },\n      u_revealage: function () {\n        return that._revealageTexture;\n      },\n    };\n    this._compositeCommand = context.createViewportQuadCommand(fs, {\n      uniformMap: uniformMap,\n      owner: this,\n    });\n  }\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(this._adjustTranslucentCommand)) {\n    if (this._translucentMRTSupport) {\n      fs = new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z({\n        defines: ["MRT"],\n        sources: [_Shaders_AdjustTranslucentFS_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z],\n      });\n\n      uniformMap = {\n        u_bgColor: function () {\n          return that._translucentMRTClearCommand.color;\n        },\n        u_depthTexture: function () {\n          return that._depthStencilTexture;\n        },\n      };\n\n      this._adjustTranslucentCommand = context.createViewportQuadCommand(fs, {\n        uniformMap: uniformMap,\n        owner: this,\n      });\n    } else if (this._translucentMultipassSupport) {\n      fs = new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z({\n        sources: [_Shaders_AdjustTranslucentFS_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z],\n      });\n\n      uniformMap = {\n        u_bgColor: function () {\n          return that._translucentMultipassClearCommand.color;\n        },\n        u_depthTexture: function () {\n          return that._depthStencilTexture;\n        },\n      };\n\n      this._adjustTranslucentCommand = context.createViewportQuadCommand(fs, {\n        uniformMap: uniformMap,\n        owner: this,\n      });\n\n      uniformMap = {\n        u_bgColor: function () {\n          return that._alphaClearCommand.color;\n        },\n        u_depthTexture: function () {\n          return that._depthStencilTexture;\n        },\n      };\n\n      this._adjustAlphaCommand = context.createViewportQuadCommand(fs, {\n        uniformMap: uniformMap,\n        owner: this,\n      });\n    }\n  }\n\n  this._viewport.width = width;\n  this._viewport.height = height;\n\n  var useScissorTest = !_Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].equals */ .Z.equals(\n    this._viewport,\n    passState.viewport\n  );\n  var updateScissor = useScissorTest !== this._useScissorTest;\n  this._useScissorTest = useScissorTest;\n\n  if (!_Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].equals */ .Z.equals(this._scissorRectangle, passState.viewport)) {\n    this._scissorRectangle = _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone(\n      passState.viewport,\n      this._scissorRectangle\n    );\n    updateScissor = true;\n  }\n\n  if (\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(this._rs) ||\n    !_Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].equals */ .Z.equals(this._viewport, this._rs.viewport) ||\n    updateScissor\n  ) {\n    this._rs = _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].fromCache */ .Z.fromCache({\n      viewport: this._viewport,\n      scissorTest: {\n        enabled: this._useScissorTest,\n        rectangle: this._scissorRectangle,\n      },\n    });\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(this._compositeCommand)) {\n    this._compositeCommand.renderState = this._rs;\n  }\n\n  if (this._adjustTranslucentCommand) {\n    this._adjustTranslucentCommand.renderState = this._rs;\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(this._adjustAlphaCommand)) {\n    this._adjustAlphaCommand.renderState = this._rs;\n  }\n};\n\nvar translucentMRTBlend = {\n  enabled: true,\n  color: new _Core_Color_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z(0.0, 0.0, 0.0, 0.0),\n  equationRgb: _BlendEquation_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].ADD */ .Z.ADD,\n  equationAlpha: _BlendEquation_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].ADD */ .Z.ADD,\n  functionSourceRgb: _BlendFunction_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].ONE */ .Z.ONE,\n  functionDestinationRgb: _BlendFunction_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].ONE */ .Z.ONE,\n  functionSourceAlpha: _BlendFunction_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].ZERO */ .Z.ZERO,\n  functionDestinationAlpha: _BlendFunction_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].ONE_MINUS_SOURCE_ALPHA */ .Z.ONE_MINUS_SOURCE_ALPHA,\n};\n\nvar translucentColorBlend = {\n  enabled: true,\n  color: new _Core_Color_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z(0.0, 0.0, 0.0, 0.0),\n  equationRgb: _BlendEquation_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].ADD */ .Z.ADD,\n  equationAlpha: _BlendEquation_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].ADD */ .Z.ADD,\n  functionSourceRgb: _BlendFunction_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].ONE */ .Z.ONE,\n  functionDestinationRgb: _BlendFunction_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].ONE */ .Z.ONE,\n  functionSourceAlpha: _BlendFunction_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].ONE */ .Z.ONE,\n  functionDestinationAlpha: _BlendFunction_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].ONE */ .Z.ONE,\n};\n\nvar translucentAlphaBlend = {\n  enabled: true,\n  color: new _Core_Color_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z(0.0, 0.0, 0.0, 0.0),\n  equationRgb: _BlendEquation_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].ADD */ .Z.ADD,\n  equationAlpha: _BlendEquation_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].ADD */ .Z.ADD,\n  functionSourceRgb: _BlendFunction_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].ZERO */ .Z.ZERO,\n  functionDestinationRgb: _BlendFunction_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].ONE_MINUS_SOURCE_ALPHA */ .Z.ONE_MINUS_SOURCE_ALPHA,\n  functionSourceAlpha: _BlendFunction_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].ZERO */ .Z.ZERO,\n  functionDestinationAlpha: _BlendFunction_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].ONE_MINUS_SOURCE_ALPHA */ .Z.ONE_MINUS_SOURCE_ALPHA,\n};\n\nfunction getTranslucentRenderState(\n  context,\n  translucentBlending,\n  cache,\n  renderState\n) {\n  var translucentState = cache[renderState.id];\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(translucentState)) {\n    var rs = _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].getState */ .Z.getState(renderState);\n    rs.depthMask = false;\n    rs.blending = translucentBlending;\n\n    translucentState = _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].fromCache */ .Z.fromCache(rs);\n    cache[renderState.id] = translucentState;\n  }\n\n  return translucentState;\n}\n\nfunction getTranslucentMRTRenderState(oit, context, renderState) {\n  return getTranslucentRenderState(\n    context,\n    translucentMRTBlend,\n    oit._translucentRenderStateCache,\n    renderState\n  );\n}\n\nfunction getTranslucentColorRenderState(oit, context, renderState) {\n  return getTranslucentRenderState(\n    context,\n    translucentColorBlend,\n    oit._translucentRenderStateCache,\n    renderState\n  );\n}\n\nfunction getTranslucentAlphaRenderState(oit, context, renderState) {\n  return getTranslucentRenderState(\n    context,\n    translucentAlphaBlend,\n    oit._alphaRenderStateCache,\n    renderState\n  );\n}\n\nvar mrtShaderSource =\n  "    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\\n" +\n  "    float ai = czm_gl_FragColor.a;\\n" +\n  "    float wzi = czm_alphaWeight(ai);\\n" +\n  "    gl_FragData[0] = vec4(Ci * wzi, ai);\\n" +\n  "    gl_FragData[1] = vec4(ai * wzi);\\n";\n\nvar colorShaderSource =\n  "    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\\n" +\n  "    float ai = czm_gl_FragColor.a;\\n" +\n  "    float wzi = czm_alphaWeight(ai);\\n" +\n  "    gl_FragColor = vec4(Ci, ai) * wzi;\\n";\n\nvar alphaShaderSource =\n  "    float ai = czm_gl_FragColor.a;\\n" + "    gl_FragColor = vec4(ai);\\n";\n\nfunction getTranslucentShaderProgram(context, shaderProgram, keyword, source) {\n  var shader = context.shaderCache.getDerivedShaderProgram(\n    shaderProgram,\n    keyword\n  );\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(shader)) {\n    var attributeLocations = shaderProgram._attributeLocations;\n\n    var fs = shaderProgram.fragmentShaderSource.clone();\n\n    fs.sources = fs.sources.map(function (source) {\n      source = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"].replaceMain */ .Z.replaceMain(source, "czm_translucent_main");\n      source = source.replace(/gl_FragColor/g, "czm_gl_FragColor");\n      source = source.replace(/\\bdiscard\\b/g, "czm_discard = true");\n      source = source.replace(/czm_phong/g, "czm_translucentPhong");\n      return source;\n    });\n\n    // Discarding the fragment in main is a workaround for ANGLE D3D9\n    // shader compilation errors.\n\n    fs.sources.splice(\n      0,\n      0,\n      (source.indexOf("gl_FragData") !== -1\n        ? "#extension GL_EXT_draw_buffers : enable \\n"\n        : "") +\n        "vec4 czm_gl_FragColor;\\n" +\n        "bool czm_discard = false;\\n"\n    );\n\n    fs.sources.push(\n      "void main()\\n" +\n        "{\\n" +\n        "    czm_translucent_main();\\n" +\n        "    if (czm_discard)\\n" +\n        "    {\\n" +\n        "        discard;\\n" +\n        "    }\\n" +\n        source +\n        "}\\n"\n    );\n\n    shader = context.shaderCache.createDerivedShaderProgram(\n      shaderProgram,\n      keyword,\n      {\n        vertexShaderSource: shaderProgram.vertexShaderSource,\n        fragmentShaderSource: fs,\n        attributeLocations: attributeLocations,\n      }\n    );\n  }\n\n  return shader;\n}\n\nfunction getTranslucentMRTShaderProgram(context, shaderProgram) {\n  return getTranslucentShaderProgram(\n    context,\n    shaderProgram,\n    "translucentMRT",\n    mrtShaderSource\n  );\n}\n\nfunction getTranslucentColorShaderProgram(context, shaderProgram) {\n  return getTranslucentShaderProgram(\n    context,\n    shaderProgram,\n    "translucentMultipass",\n    colorShaderSource\n  );\n}\n\nfunction getTranslucentAlphaShaderProgram(context, shaderProgram) {\n  return getTranslucentShaderProgram(\n    context,\n    shaderProgram,\n    "alphaMultipass",\n    alphaShaderSource\n  );\n}\n\nOIT.prototype.createDerivedCommands = function (command, context, result) {\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(result)) {\n    result = {};\n  }\n\n  if (this._translucentMRTSupport) {\n    var translucentShader;\n    var translucentRenderState;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(result.translucentCommand)) {\n      translucentShader = result.translucentCommand.shaderProgram;\n      translucentRenderState = result.translucentCommand.renderState;\n    }\n\n    result.translucentCommand = _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].shallowClone */ .Z.shallowClone(\n      command,\n      result.translucentCommand\n    );\n\n    if (\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(translucentShader) ||\n      result.shaderProgramId !== command.shaderProgram.id\n    ) {\n      result.translucentCommand.shaderProgram = getTranslucentMRTShaderProgram(\n        context,\n        command.shaderProgram\n      );\n      result.translucentCommand.renderState = getTranslucentMRTRenderState(\n        this,\n        context,\n        command.renderState\n      );\n      result.shaderProgramId = command.shaderProgram.id;\n    } else {\n      result.translucentCommand.shaderProgram = translucentShader;\n      result.translucentCommand.renderState = translucentRenderState;\n    }\n  } else {\n    var colorShader;\n    var colorRenderState;\n    var alphaShader;\n    var alphaRenderState;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(result.translucentCommand)) {\n      colorShader = result.translucentCommand.shaderProgram;\n      colorRenderState = result.translucentCommand.renderState;\n      alphaShader = result.alphaCommand.shaderProgram;\n      alphaRenderState = result.alphaCommand.renderState;\n    }\n\n    result.translucentCommand = _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].shallowClone */ .Z.shallowClone(\n      command,\n      result.translucentCommand\n    );\n    result.alphaCommand = _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].shallowClone */ .Z.shallowClone(\n      command,\n      result.alphaCommand\n    );\n\n    if (\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(colorShader) ||\n      result.shaderProgramId !== command.shaderProgram.id\n    ) {\n      result.translucentCommand.shaderProgram = getTranslucentColorShaderProgram(\n        context,\n        command.shaderProgram\n      );\n      result.translucentCommand.renderState = getTranslucentColorRenderState(\n        this,\n        context,\n        command.renderState\n      );\n      result.alphaCommand.shaderProgram = getTranslucentAlphaShaderProgram(\n        context,\n        command.shaderProgram\n      );\n      result.alphaCommand.renderState = getTranslucentAlphaRenderState(\n        this,\n        context,\n        command.renderState\n      );\n      result.shaderProgramId = command.shaderProgram.id;\n    } else {\n      result.translucentCommand.shaderProgram = colorShader;\n      result.translucentCommand.renderState = colorRenderState;\n      result.alphaCommand.shaderProgram = alphaShader;\n      result.alphaCommand.renderState = alphaRenderState;\n    }\n  }\n\n  return result;\n};\n\nfunction executeTranslucentCommandsSortedMultipass(\n  oit,\n  scene,\n  executeFunction,\n  passState,\n  commands,\n  invertClassification\n) {\n  var command;\n  var derivedCommand;\n  var j;\n\n  var context = scene.context;\n  var useLogDepth = scene.frameState.useLogDepth;\n  var useHdr = scene._hdr;\n  var framebuffer = passState.framebuffer;\n  var length = commands.length;\n\n  var lightShadowsEnabled = scene.frameState.shadowState.lightShadowsEnabled;\n\n  passState.framebuffer = oit._adjustTranslucentFBO;\n  oit._adjustTranslucentCommand.execute(context, passState);\n  passState.framebuffer = oit._adjustAlphaFBO;\n  oit._adjustAlphaCommand.execute(context, passState);\n\n  var debugFramebuffer = oit._opaqueFBO;\n  passState.framebuffer = oit._translucentFBO;\n\n  for (j = 0; j < length; ++j) {\n    command = commands[j];\n    command = useLogDepth ? command.derivedCommands.logDepth.command : command;\n    command = useHdr ? command.derivedCommands.hdr.command : command;\n    derivedCommand =\n      lightShadowsEnabled && command.receiveShadows\n        ? command.derivedCommands.oit.shadows.translucentCommand\n        : command.derivedCommands.oit.translucentCommand;\n    executeFunction(\n      derivedCommand,\n      scene,\n      context,\n      passState,\n      debugFramebuffer\n    );\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(invertClassification)) {\n    command = invertClassification.unclassifiedCommand;\n    derivedCommand =\n      lightShadowsEnabled && command.receiveShadows\n        ? command.derivedCommands.oit.shadows.translucentCommand\n        : command.derivedCommands.oit.translucentCommand;\n    executeFunction(\n      derivedCommand,\n      scene,\n      context,\n      passState,\n      debugFramebuffer\n    );\n  }\n\n  passState.framebuffer = oit._alphaFBO;\n\n  for (j = 0; j < length; ++j) {\n    command = commands[j];\n    command = useLogDepth ? command.derivedCommands.logDepth.command : command;\n    command = useHdr ? command.derivedCommands.hdr.command : command;\n    derivedCommand =\n      lightShadowsEnabled && command.receiveShadows\n        ? command.derivedCommands.oit.shadows.alphaCommand\n        : command.derivedCommands.oit.alphaCommand;\n    executeFunction(\n      derivedCommand,\n      scene,\n      context,\n      passState,\n      debugFramebuffer\n    );\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(invertClassification)) {\n    command = invertClassification.unclassifiedCommand;\n    derivedCommand =\n      lightShadowsEnabled && command.receiveShadows\n        ? command.derivedCommands.oit.shadows.alphaCommand\n        : command.derivedCommands.oit.alphaCommand;\n    executeFunction(\n      derivedCommand,\n      scene,\n      context,\n      passState,\n      debugFramebuffer\n    );\n  }\n\n  passState.framebuffer = framebuffer;\n}\n\nfunction executeTranslucentCommandsSortedMRT(\n  oit,\n  scene,\n  executeFunction,\n  passState,\n  commands,\n  invertClassification\n) {\n  var context = scene.context;\n  var useLogDepth = scene.frameState.useLogDepth;\n  var useHdr = scene._hdr;\n  var framebuffer = passState.framebuffer;\n  var length = commands.length;\n\n  var lightShadowsEnabled = scene.frameState.shadowState.lightShadowsEnabled;\n\n  passState.framebuffer = oit._adjustTranslucentFBO;\n  oit._adjustTranslucentCommand.execute(context, passState);\n\n  var debugFramebuffer = oit._opaqueFBO;\n  passState.framebuffer = oit._translucentFBO;\n\n  var command;\n  var derivedCommand;\n\n  for (var j = 0; j < length; ++j) {\n    command = commands[j];\n    command = useLogDepth ? command.derivedCommands.logDepth.command : command;\n    command = useHdr ? command.derivedCommands.hdr.command : command;\n    derivedCommand =\n      lightShadowsEnabled && command.receiveShadows\n        ? command.derivedCommands.oit.shadows.translucentCommand\n        : command.derivedCommands.oit.translucentCommand;\n    executeFunction(\n      derivedCommand,\n      scene,\n      context,\n      passState,\n      debugFramebuffer\n    );\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(invertClassification)) {\n    command = invertClassification.unclassifiedCommand;\n    derivedCommand =\n      lightShadowsEnabled && command.receiveShadows\n        ? command.derivedCommands.oit.shadows.translucentCommand\n        : command.derivedCommands.oit.translucentCommand;\n    executeFunction(\n      derivedCommand,\n      scene,\n      context,\n      passState,\n      debugFramebuffer\n    );\n  }\n\n  passState.framebuffer = framebuffer;\n}\n\nOIT.prototype.executeCommands = function (\n  scene,\n  executeFunction,\n  passState,\n  commands,\n  invertClassification\n) {\n  if (this._translucentMRTSupport) {\n    executeTranslucentCommandsSortedMRT(\n      this,\n      scene,\n      executeFunction,\n      passState,\n      commands,\n      invertClassification\n    );\n    return;\n  }\n\n  executeTranslucentCommandsSortedMultipass(\n    this,\n    scene,\n    executeFunction,\n    passState,\n    commands,\n    invertClassification\n  );\n};\n\nOIT.prototype.execute = function (context, passState) {\n  this._compositeCommand.execute(context, passState);\n};\n\nOIT.prototype.clear = function (context, passState, clearColor) {\n  var framebuffer = passState.framebuffer;\n\n  passState.framebuffer = this._opaqueFBO;\n  _Core_Color_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].clone */ .Z.clone(clearColor, this._opaqueClearCommand.color);\n  this._opaqueClearCommand.execute(context, passState);\n\n  passState.framebuffer = this._translucentFBO;\n  var translucentClearCommand = this._translucentMRTSupport\n    ? this._translucentMRTClearCommand\n    : this._translucentMultipassClearCommand;\n  translucentClearCommand.execute(context, passState);\n\n  if (this._translucentMultipassSupport) {\n    passState.framebuffer = this._alphaFBO;\n    this._alphaClearCommand.execute(context, passState);\n  }\n\n  passState.framebuffer = framebuffer;\n};\n\nOIT.prototype.isSupported = function () {\n  return this._translucentMRTSupport || this._translucentMultipassSupport;\n};\n\nOIT.prototype.isDestroyed = function () {\n  return false;\n};\n\nOIT.prototype.destroy = function () {\n  destroyResources(this);\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(this._compositeCommand)) {\n    this._compositeCommand.shaderProgram =\n      this._compositeCommand.shaderProgram &&\n      this._compositeCommand.shaderProgram.destroy();\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(this._adjustTranslucentCommand)) {\n    this._adjustTranslucentCommand.shaderProgram =\n      this._adjustTranslucentCommand.shaderProgram &&\n      this._adjustTranslucentCommand.shaderProgram.destroy();\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(this._adjustAlphaCommand)) {\n    this._adjustAlphaCommand.shaderProgram =\n      this._adjustAlphaCommand.shaderProgram &&\n      this._adjustAlphaCommand.shaderProgram.destroy();\n  }\n\n  return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(this);\n};\n/* harmony default export */ __webpack_exports__["Z"] = (OIT);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBLGNBQWMsWUFBWTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsTUFBTSxzRUFBTztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsa0JBQWtCLFlBQVk7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE1BQU0sc0VBQU87QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFLDJFQUFXO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxNQUFNLHNFQUFPO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsTUFBTSxzRUFBTztBQUNiO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE1BQU0sc0VBQU87QUFDYjtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxTQUFTLDJFQUFhO0FBQ3RCO0FBQ0EseURBQWUsR0FBRyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnVlMy13ZWJwYWNrNS8uL25vZGVfbW9kdWxlcy9jZXNpdW0vU291cmNlL1NjZW5lL09JVC5qcz9lYTUyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBCb3VuZGluZ1JlY3RhbmdsZSBmcm9tIFwiLi4vQ29yZS9Cb3VuZGluZ1JlY3RhbmdsZS5qc1wiO1xuaW1wb3J0IENvbG9yIGZyb20gXCIuLi9Db3JlL0NvbG9yLmpzXCI7XG5pbXBvcnQgZGVmaW5lZCBmcm9tIFwiLi4vQ29yZS9kZWZpbmVkLmpzXCI7XG5pbXBvcnQgZGVzdHJveU9iamVjdCBmcm9tIFwiLi4vQ29yZS9kZXN0cm95T2JqZWN0LmpzXCI7XG5pbXBvcnQgUGl4ZWxGb3JtYXQgZnJvbSBcIi4uL0NvcmUvUGl4ZWxGb3JtYXQuanNcIjtcbmltcG9ydCBXZWJHTENvbnN0YW50cyBmcm9tIFwiLi4vQ29yZS9XZWJHTENvbnN0YW50cy5qc1wiO1xuaW1wb3J0IENsZWFyQ29tbWFuZCBmcm9tIFwiLi4vUmVuZGVyZXIvQ2xlYXJDb21tYW5kLmpzXCI7XG5pbXBvcnQgRHJhd0NvbW1hbmQgZnJvbSBcIi4uL1JlbmRlcmVyL0RyYXdDb21tYW5kLmpzXCI7XG5pbXBvcnQgRnJhbWVidWZmZXIgZnJvbSBcIi4uL1JlbmRlcmVyL0ZyYW1lYnVmZmVyLmpzXCI7XG5pbXBvcnQgUGl4ZWxEYXRhdHlwZSBmcm9tIFwiLi4vUmVuZGVyZXIvUGl4ZWxEYXRhdHlwZS5qc1wiO1xuaW1wb3J0IFJlbmRlclN0YXRlIGZyb20gXCIuLi9SZW5kZXJlci9SZW5kZXJTdGF0ZS5qc1wiO1xuaW1wb3J0IFNoYWRlclNvdXJjZSBmcm9tIFwiLi4vUmVuZGVyZXIvU2hhZGVyU291cmNlLmpzXCI7XG5pbXBvcnQgVGV4dHVyZSBmcm9tIFwiLi4vUmVuZGVyZXIvVGV4dHVyZS5qc1wiO1xuaW1wb3J0IEFkanVzdFRyYW5zbHVjZW50RlMgZnJvbSBcIi4uL1NoYWRlcnMvQWRqdXN0VHJhbnNsdWNlbnRGUy5qc1wiO1xuaW1wb3J0IENvbXBvc2l0ZU9JVEZTIGZyb20gXCIuLi9TaGFkZXJzL0NvbXBvc2l0ZU9JVEZTLmpzXCI7XG5pbXBvcnQgQmxlbmRFcXVhdGlvbiBmcm9tIFwiLi9CbGVuZEVxdWF0aW9uLmpzXCI7XG5pbXBvcnQgQmxlbmRGdW5jdGlvbiBmcm9tIFwiLi9CbGVuZEZ1bmN0aW9uLmpzXCI7XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gT0lUKGNvbnRleHQpIHtcbiAgLy8gV2Ugc3VwcG9ydCBtdWx0aXBhc3MgZm9yIHRoZSBDaHJvbWUgRDNEOSBiYWNrZW5kIGFuZCBFUyAyLjAgb24gbW9iaWxlLlxuICB0aGlzLl90cmFuc2x1Y2VudE11bHRpcGFzc1N1cHBvcnQgPSBmYWxzZTtcbiAgdGhpcy5fdHJhbnNsdWNlbnRNUlRTdXBwb3J0ID0gZmFsc2U7XG5cbiAgdmFyIGV4dGVuc2lvbnNTdXBwb3J0ZWQgPSBjb250ZXh0LmNvbG9yQnVmZmVyRmxvYXQgJiYgY29udGV4dC5kZXB0aFRleHR1cmU7XG4gIHRoaXMuX3RyYW5zbHVjZW50TVJUU3VwcG9ydCA9IGNvbnRleHQuZHJhd0J1ZmZlcnMgJiYgZXh0ZW5zaW9uc1N1cHBvcnRlZDtcbiAgdGhpcy5fdHJhbnNsdWNlbnRNdWx0aXBhc3NTdXBwb3J0ID1cbiAgICAhdGhpcy5fdHJhbnNsdWNlbnRNUlRTdXBwb3J0ICYmIGV4dGVuc2lvbnNTdXBwb3J0ZWQ7XG5cbiAgdGhpcy5fb3BhcXVlRkJPID0gdW5kZWZpbmVkO1xuICB0aGlzLl9vcGFxdWVUZXh0dXJlID0gdW5kZWZpbmVkO1xuICB0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlID0gdW5kZWZpbmVkO1xuXG4gIHRoaXMuX2FjY3VtdWxhdGlvblRleHR1cmUgPSB1bmRlZmluZWQ7XG5cbiAgdGhpcy5fdHJhbnNsdWNlbnRGQk8gPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2FscGhhRkJPID0gdW5kZWZpbmVkO1xuXG4gIHRoaXMuX2FkanVzdFRyYW5zbHVjZW50RkJPID0gdW5kZWZpbmVkO1xuICB0aGlzLl9hZGp1c3RBbHBoYUZCTyA9IHVuZGVmaW5lZDtcblxuICB0aGlzLl9vcGFxdWVDbGVhckNvbW1hbmQgPSBuZXcgQ2xlYXJDb21tYW5kKHtcbiAgICBjb2xvcjogbmV3IENvbG9yKDAuMCwgMC4wLCAwLjAsIDAuMCksXG4gICAgb3duZXI6IHRoaXMsXG4gIH0pO1xuICB0aGlzLl90cmFuc2x1Y2VudE1SVENsZWFyQ29tbWFuZCA9IG5ldyBDbGVhckNvbW1hbmQoe1xuICAgIGNvbG9yOiBuZXcgQ29sb3IoMC4wLCAwLjAsIDAuMCwgMS4wKSxcbiAgICBvd25lcjogdGhpcyxcbiAgfSk7XG4gIHRoaXMuX3RyYW5zbHVjZW50TXVsdGlwYXNzQ2xlYXJDb21tYW5kID0gbmV3IENsZWFyQ29tbWFuZCh7XG4gICAgY29sb3I6IG5ldyBDb2xvcigwLjAsIDAuMCwgMC4wLCAwLjApLFxuICAgIG93bmVyOiB0aGlzLFxuICB9KTtcbiAgdGhpcy5fYWxwaGFDbGVhckNvbW1hbmQgPSBuZXcgQ2xlYXJDb21tYW5kKHtcbiAgICBjb2xvcjogbmV3IENvbG9yKDEuMCwgMS4wLCAxLjAsIDEuMCksXG4gICAgb3duZXI6IHRoaXMsXG4gIH0pO1xuXG4gIHRoaXMuX3RyYW5zbHVjZW50UmVuZGVyU3RhdGVDYWNoZSA9IHt9O1xuICB0aGlzLl9hbHBoYVJlbmRlclN0YXRlQ2FjaGUgPSB7fTtcblxuICB0aGlzLl9jb21wb3NpdGVDb21tYW5kID0gdW5kZWZpbmVkO1xuICB0aGlzLl9hZGp1c3RUcmFuc2x1Y2VudENvbW1hbmQgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2FkanVzdEFscGhhQ29tbWFuZCA9IHVuZGVmaW5lZDtcblxuICB0aGlzLl92aWV3cG9ydCA9IG5ldyBCb3VuZGluZ1JlY3RhbmdsZSgpO1xuICB0aGlzLl9ycyA9IHVuZGVmaW5lZDtcblxuICB0aGlzLl91c2VTY2lzc29yVGVzdCA9IGZhbHNlO1xuICB0aGlzLl9zY2lzc29yUmVjdGFuZ2xlID0gdW5kZWZpbmVkO1xuXG4gIHRoaXMuX3VzZUhEUiA9IGZhbHNlO1xufVxuXG5mdW5jdGlvbiBkZXN0cm95VGV4dHVyZXMob2l0KSB7XG4gIG9pdC5fYWNjdW11bGF0aW9uVGV4dHVyZSA9XG4gICAgb2l0Ll9hY2N1bXVsYXRpb25UZXh0dXJlICYmXG4gICAgIW9pdC5fYWNjdW11bGF0aW9uVGV4dHVyZS5pc0Rlc3Ryb3llZCgpICYmXG4gICAgb2l0Ll9hY2N1bXVsYXRpb25UZXh0dXJlLmRlc3Ryb3koKTtcbiAgb2l0Ll9yZXZlYWxhZ2VUZXh0dXJlID1cbiAgICBvaXQuX3JldmVhbGFnZVRleHR1cmUgJiZcbiAgICAhb2l0Ll9yZXZlYWxhZ2VUZXh0dXJlLmlzRGVzdHJveWVkKCkgJiZcbiAgICBvaXQuX3JldmVhbGFnZVRleHR1cmUuZGVzdHJveSgpO1xufVxuXG5mdW5jdGlvbiBkZXN0cm95RnJhbWVidWZmZXJzKG9pdCkge1xuICBvaXQuX3RyYW5zbHVjZW50RkJPID1cbiAgICBvaXQuX3RyYW5zbHVjZW50RkJPICYmXG4gICAgIW9pdC5fdHJhbnNsdWNlbnRGQk8uaXNEZXN0cm95ZWQoKSAmJlxuICAgIG9pdC5fdHJhbnNsdWNlbnRGQk8uZGVzdHJveSgpO1xuICBvaXQuX2FscGhhRkJPID1cbiAgICBvaXQuX2FscGhhRkJPICYmICFvaXQuX2FscGhhRkJPLmlzRGVzdHJveWVkKCkgJiYgb2l0Ll9hbHBoYUZCTy5kZXN0cm95KCk7XG4gIG9pdC5fYWRqdXN0VHJhbnNsdWNlbnRGQk8gPVxuICAgIG9pdC5fYWRqdXN0VHJhbnNsdWNlbnRGQk8gJiZcbiAgICAhb2l0Ll9hZGp1c3RUcmFuc2x1Y2VudEZCTy5pc0Rlc3Ryb3llZCgpICYmXG4gICAgb2l0Ll9hZGp1c3RUcmFuc2x1Y2VudEZCTy5kZXN0cm95KCk7XG4gIG9pdC5fYWRqdXN0QWxwaGFGQk8gPVxuICAgIG9pdC5fYWRqdXN0QWxwaGFGQk8gJiZcbiAgICAhb2l0Ll9hZGp1c3RBbHBoYUZCTy5pc0Rlc3Ryb3llZCgpICYmXG4gICAgb2l0Ll9hZGp1c3RBbHBoYUZCTy5kZXN0cm95KCk7XG59XG5cbmZ1bmN0aW9uIGRlc3Ryb3lSZXNvdXJjZXMob2l0KSB7XG4gIGRlc3Ryb3lUZXh0dXJlcyhvaXQpO1xuICBkZXN0cm95RnJhbWVidWZmZXJzKG9pdCk7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVRleHR1cmVzKG9pdCwgY29udGV4dCwgd2lkdGgsIGhlaWdodCkge1xuICBkZXN0cm95VGV4dHVyZXMob2l0KTtcblxuICBvaXQuX2FjY3VtdWxhdGlvblRleHR1cmUgPSBuZXcgVGV4dHVyZSh7XG4gICAgY29udGV4dDogY29udGV4dCxcbiAgICB3aWR0aDogd2lkdGgsXG4gICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgcGl4ZWxGb3JtYXQ6IFBpeGVsRm9ybWF0LlJHQkEsXG4gICAgcGl4ZWxEYXRhdHlwZTogUGl4ZWxEYXRhdHlwZS5GTE9BVCxcbiAgfSk7XG5cbiAgLy8gVXNlIHplcm9lZCBhcnJheWJ1ZmZlciBpbnN0ZWFkIG9mIG51bGwgdG8gaW5pdGlhbGl6ZSB0ZXh0dXJlXG4gIC8vIHRvIHdvcmthcm91bmQgRmlyZWZveC4gT25seSBuZWVkZWQgZm9yIHRoZSBzZWNvbmQgY29sb3IgYXR0YWNobWVudC5cbiAgdmFyIHNvdXJjZSA9IG5ldyBGbG9hdDMyQXJyYXkod2lkdGggKiBoZWlnaHQgKiA0KTtcbiAgb2l0Ll9yZXZlYWxhZ2VUZXh0dXJlID0gbmV3IFRleHR1cmUoe1xuICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgcGl4ZWxGb3JtYXQ6IFBpeGVsRm9ybWF0LlJHQkEsXG4gICAgcGl4ZWxEYXRhdHlwZTogUGl4ZWxEYXRhdHlwZS5GTE9BVCxcbiAgICBzb3VyY2U6IHtcbiAgICAgIGFycmF5QnVmZmVyVmlldzogc291cmNlLFxuICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgfSxcbiAgICBmbGlwWTogZmFsc2UsXG4gIH0pO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVGcmFtZWJ1ZmZlcnMob2l0LCBjb250ZXh0KSB7XG4gIGRlc3Ryb3lGcmFtZWJ1ZmZlcnMob2l0KTtcblxuICB2YXIgY29tcGxldGVGQk8gPSBXZWJHTENvbnN0YW50cy5GUkFNRUJVRkZFUl9DT01QTEVURTtcbiAgdmFyIHN1cHBvcnRlZCA9IHRydWU7XG5cbiAgLy8gaWYgTVJUIGlzIHN1cHBvcnRlZCwgYXR0ZW1wdCB0byBtYWtlIGFuIEZCTyB3aXRoIG11bHRpcGxlIGNvbG9yIGF0dGFjaG1lbnRzXG4gIGlmIChvaXQuX3RyYW5zbHVjZW50TVJUU3VwcG9ydCkge1xuICAgIG9pdC5fdHJhbnNsdWNlbnRGQk8gPSBuZXcgRnJhbWVidWZmZXIoe1xuICAgICAgY29udGV4dDogY29udGV4dCxcbiAgICAgIGNvbG9yVGV4dHVyZXM6IFtvaXQuX2FjY3VtdWxhdGlvblRleHR1cmUsIG9pdC5fcmV2ZWFsYWdlVGV4dHVyZV0sXG4gICAgICBkZXB0aFN0ZW5jaWxUZXh0dXJlOiBvaXQuX2RlcHRoU3RlbmNpbFRleHR1cmUsXG4gICAgICBkZXN0cm95QXR0YWNobWVudHM6IGZhbHNlLFxuICAgIH0pO1xuICAgIG9pdC5fYWRqdXN0VHJhbnNsdWNlbnRGQk8gPSBuZXcgRnJhbWVidWZmZXIoe1xuICAgICAgY29udGV4dDogY29udGV4dCxcbiAgICAgIGNvbG9yVGV4dHVyZXM6IFtvaXQuX2FjY3VtdWxhdGlvblRleHR1cmUsIG9pdC5fcmV2ZWFsYWdlVGV4dHVyZV0sXG4gICAgICBkZXN0cm95QXR0YWNobWVudHM6IGZhbHNlLFxuICAgIH0pO1xuXG4gICAgaWYgKFxuICAgICAgb2l0Ll90cmFuc2x1Y2VudEZCTy5zdGF0dXMgIT09IGNvbXBsZXRlRkJPIHx8XG4gICAgICBvaXQuX2FkanVzdFRyYW5zbHVjZW50RkJPLnN0YXR1cyAhPT0gY29tcGxldGVGQk9cbiAgICApIHtcbiAgICAgIGRlc3Ryb3lGcmFtZWJ1ZmZlcnMob2l0KTtcbiAgICAgIG9pdC5fdHJhbnNsdWNlbnRNUlRTdXBwb3J0ID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLy8gZWl0aGVyIE1SVCBpc24ndCBzdXBwb3J0ZWQgb3IgRkJPIGNyZWF0aW9uIGZhaWxlZCwgYXR0ZW1wdCBtdWx0aXBhc3NcbiAgaWYgKCFvaXQuX3RyYW5zbHVjZW50TVJUU3VwcG9ydCkge1xuICAgIG9pdC5fdHJhbnNsdWNlbnRGQk8gPSBuZXcgRnJhbWVidWZmZXIoe1xuICAgICAgY29udGV4dDogY29udGV4dCxcbiAgICAgIGNvbG9yVGV4dHVyZXM6IFtvaXQuX2FjY3VtdWxhdGlvblRleHR1cmVdLFxuICAgICAgZGVwdGhTdGVuY2lsVGV4dHVyZTogb2l0Ll9kZXB0aFN0ZW5jaWxUZXh0dXJlLFxuICAgICAgZGVzdHJveUF0dGFjaG1lbnRzOiBmYWxzZSxcbiAgICB9KTtcbiAgICBvaXQuX2FscGhhRkJPID0gbmV3IEZyYW1lYnVmZmVyKHtcbiAgICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgICBjb2xvclRleHR1cmVzOiBbb2l0Ll9yZXZlYWxhZ2VUZXh0dXJlXSxcbiAgICAgIGRlcHRoU3RlbmNpbFRleHR1cmU6IG9pdC5fZGVwdGhTdGVuY2lsVGV4dHVyZSxcbiAgICAgIGRlc3Ryb3lBdHRhY2htZW50czogZmFsc2UsXG4gICAgfSk7XG4gICAgb2l0Ll9hZGp1c3RUcmFuc2x1Y2VudEZCTyA9IG5ldyBGcmFtZWJ1ZmZlcih7XG4gICAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgICAgY29sb3JUZXh0dXJlczogW29pdC5fYWNjdW11bGF0aW9uVGV4dHVyZV0sXG4gICAgICBkZXN0cm95QXR0YWNobWVudHM6IGZhbHNlLFxuICAgIH0pO1xuICAgIG9pdC5fYWRqdXN0QWxwaGFGQk8gPSBuZXcgRnJhbWVidWZmZXIoe1xuICAgICAgY29udGV4dDogY29udGV4dCxcbiAgICAgIGNvbG9yVGV4dHVyZXM6IFtvaXQuX3JldmVhbGFnZVRleHR1cmVdLFxuICAgICAgZGVzdHJveUF0dGFjaG1lbnRzOiBmYWxzZSxcbiAgICB9KTtcblxuICAgIHZhciB0cmFuc2x1Y2VudENvbXBsZXRlID0gb2l0Ll90cmFuc2x1Y2VudEZCTy5zdGF0dXMgPT09IGNvbXBsZXRlRkJPO1xuICAgIHZhciBhbHBoYUNvbXBsZXRlID0gb2l0Ll9hbHBoYUZCTy5zdGF0dXMgPT09IGNvbXBsZXRlRkJPO1xuICAgIHZhciBhZGp1c3RUcmFuc2x1Y2VudENvbXBsZXRlID1cbiAgICAgIG9pdC5fYWRqdXN0VHJhbnNsdWNlbnRGQk8uc3RhdHVzID09PSBjb21wbGV0ZUZCTztcbiAgICB2YXIgYWRqdXN0QWxwaGFDb21wbGV0ZSA9IG9pdC5fYWRqdXN0QWxwaGFGQk8uc3RhdHVzID09PSBjb21wbGV0ZUZCTztcbiAgICBpZiAoXG4gICAgICAhdHJhbnNsdWNlbnRDb21wbGV0ZSB8fFxuICAgICAgIWFscGhhQ29tcGxldGUgfHxcbiAgICAgICFhZGp1c3RUcmFuc2x1Y2VudENvbXBsZXRlIHx8XG4gICAgICAhYWRqdXN0QWxwaGFDb21wbGV0ZVxuICAgICkge1xuICAgICAgZGVzdHJveVJlc291cmNlcyhvaXQpO1xuICAgICAgb2l0Ll90cmFuc2x1Y2VudE11bHRpcGFzc1N1cHBvcnQgPSBmYWxzZTtcbiAgICAgIHN1cHBvcnRlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBzdXBwb3J0ZWQ7XG59XG5cbk9JVC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGNvbnRleHQsIHBhc3NTdGF0ZSwgZnJhbWVidWZmZXIsIHVzZUhEUikge1xuICBpZiAoIXRoaXMuaXNTdXBwb3J0ZWQoKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRoaXMuX29wYXF1ZUZCTyA9IGZyYW1lYnVmZmVyO1xuICB0aGlzLl9vcGFxdWVUZXh0dXJlID0gZnJhbWVidWZmZXIuZ2V0Q29sb3JUZXh0dXJlKDApO1xuICB0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlID0gZnJhbWVidWZmZXIuZGVwdGhTdGVuY2lsVGV4dHVyZTtcblxuICB2YXIgd2lkdGggPSB0aGlzLl9vcGFxdWVUZXh0dXJlLndpZHRoO1xuICB2YXIgaGVpZ2h0ID0gdGhpcy5fb3BhcXVlVGV4dHVyZS5oZWlnaHQ7XG5cbiAgdmFyIGFjY3VtdWxhdGlvblRleHR1cmUgPSB0aGlzLl9hY2N1bXVsYXRpb25UZXh0dXJlO1xuICB2YXIgdGV4dHVyZUNoYW5nZWQgPVxuICAgICFkZWZpbmVkKGFjY3VtdWxhdGlvblRleHR1cmUpIHx8XG4gICAgYWNjdW11bGF0aW9uVGV4dHVyZS53aWR0aCAhPT0gd2lkdGggfHxcbiAgICBhY2N1bXVsYXRpb25UZXh0dXJlLmhlaWdodCAhPT0gaGVpZ2h0IHx8XG4gICAgdXNlSERSICE9PSB0aGlzLl91c2VIRFI7XG4gIGlmICh0ZXh0dXJlQ2hhbmdlZCkge1xuICAgIHVwZGF0ZVRleHR1cmVzKHRoaXMsIGNvbnRleHQsIHdpZHRoLCBoZWlnaHQpO1xuICB9XG5cbiAgaWYgKCFkZWZpbmVkKHRoaXMuX3RyYW5zbHVjZW50RkJPKSB8fCB0ZXh0dXJlQ2hhbmdlZCkge1xuICAgIGlmICghdXBkYXRlRnJhbWVidWZmZXJzKHRoaXMsIGNvbnRleHQpKSB7XG4gICAgICAvLyBmcmFtZWJ1ZmZlciBjcmVhdGlvbiBmYWlsZWRcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICB0aGlzLl91c2VIRFIgPSB1c2VIRFI7XG5cbiAgdmFyIHRoYXQgPSB0aGlzO1xuICB2YXIgZnM7XG4gIHZhciB1bmlmb3JtTWFwO1xuXG4gIGlmICghZGVmaW5lZCh0aGlzLl9jb21wb3NpdGVDb21tYW5kKSkge1xuICAgIGZzID0gbmV3IFNoYWRlclNvdXJjZSh7XG4gICAgICBzb3VyY2VzOiBbQ29tcG9zaXRlT0lURlNdLFxuICAgIH0pO1xuICAgIGlmICh0aGlzLl90cmFuc2x1Y2VudE1SVFN1cHBvcnQpIHtcbiAgICAgIGZzLmRlZmluZXMucHVzaChcIk1SVFwiKTtcbiAgICB9XG5cbiAgICB1bmlmb3JtTWFwID0ge1xuICAgICAgdV9vcGFxdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoYXQuX29wYXF1ZVRleHR1cmU7XG4gICAgICB9LFxuICAgICAgdV9hY2N1bXVsYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoYXQuX2FjY3VtdWxhdGlvblRleHR1cmU7XG4gICAgICB9LFxuICAgICAgdV9yZXZlYWxhZ2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoYXQuX3JldmVhbGFnZVRleHR1cmU7XG4gICAgICB9LFxuICAgIH07XG4gICAgdGhpcy5fY29tcG9zaXRlQ29tbWFuZCA9IGNvbnRleHQuY3JlYXRlVmlld3BvcnRRdWFkQ29tbWFuZChmcywge1xuICAgICAgdW5pZm9ybU1hcDogdW5pZm9ybU1hcCxcbiAgICAgIG93bmVyOiB0aGlzLFxuICAgIH0pO1xuICB9XG5cbiAgaWYgKCFkZWZpbmVkKHRoaXMuX2FkanVzdFRyYW5zbHVjZW50Q29tbWFuZCkpIHtcbiAgICBpZiAodGhpcy5fdHJhbnNsdWNlbnRNUlRTdXBwb3J0KSB7XG4gICAgICBmcyA9IG5ldyBTaGFkZXJTb3VyY2Uoe1xuICAgICAgICBkZWZpbmVzOiBbXCJNUlRcIl0sXG4gICAgICAgIHNvdXJjZXM6IFtBZGp1c3RUcmFuc2x1Y2VudEZTXSxcbiAgICAgIH0pO1xuXG4gICAgICB1bmlmb3JtTWFwID0ge1xuICAgICAgICB1X2JnQ29sb3I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gdGhhdC5fdHJhbnNsdWNlbnRNUlRDbGVhckNvbW1hbmQuY29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHVfZGVwdGhUZXh0dXJlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIHRoYXQuX2RlcHRoU3RlbmNpbFRleHR1cmU7XG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICB0aGlzLl9hZGp1c3RUcmFuc2x1Y2VudENvbW1hbmQgPSBjb250ZXh0LmNyZWF0ZVZpZXdwb3J0UXVhZENvbW1hbmQoZnMsIHtcbiAgICAgICAgdW5pZm9ybU1hcDogdW5pZm9ybU1hcCxcbiAgICAgICAgb3duZXI6IHRoaXMsXG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuX3RyYW5zbHVjZW50TXVsdGlwYXNzU3VwcG9ydCkge1xuICAgICAgZnMgPSBuZXcgU2hhZGVyU291cmNlKHtcbiAgICAgICAgc291cmNlczogW0FkanVzdFRyYW5zbHVjZW50RlNdLFxuICAgICAgfSk7XG5cbiAgICAgIHVuaWZvcm1NYXAgPSB7XG4gICAgICAgIHVfYmdDb2xvcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiB0aGF0Ll90cmFuc2x1Y2VudE11bHRpcGFzc0NsZWFyQ29tbWFuZC5jb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgdV9kZXB0aFRleHR1cmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gdGhhdC5fZGVwdGhTdGVuY2lsVGV4dHVyZTtcbiAgICAgICAgfSxcbiAgICAgIH07XG5cbiAgICAgIHRoaXMuX2FkanVzdFRyYW5zbHVjZW50Q29tbWFuZCA9IGNvbnRleHQuY3JlYXRlVmlld3BvcnRRdWFkQ29tbWFuZChmcywge1xuICAgICAgICB1bmlmb3JtTWFwOiB1bmlmb3JtTWFwLFxuICAgICAgICBvd25lcjogdGhpcyxcbiAgICAgIH0pO1xuXG4gICAgICB1bmlmb3JtTWFwID0ge1xuICAgICAgICB1X2JnQ29sb3I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gdGhhdC5fYWxwaGFDbGVhckNvbW1hbmQuY29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHVfZGVwdGhUZXh0dXJlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIHRoYXQuX2RlcHRoU3RlbmNpbFRleHR1cmU7XG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICB0aGlzLl9hZGp1c3RBbHBoYUNvbW1hbmQgPSBjb250ZXh0LmNyZWF0ZVZpZXdwb3J0UXVhZENvbW1hbmQoZnMsIHtcbiAgICAgICAgdW5pZm9ybU1hcDogdW5pZm9ybU1hcCxcbiAgICAgICAgb3duZXI6IHRoaXMsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICB0aGlzLl92aWV3cG9ydC53aWR0aCA9IHdpZHRoO1xuICB0aGlzLl92aWV3cG9ydC5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgdmFyIHVzZVNjaXNzb3JUZXN0ID0gIUJvdW5kaW5nUmVjdGFuZ2xlLmVxdWFscyhcbiAgICB0aGlzLl92aWV3cG9ydCxcbiAgICBwYXNzU3RhdGUudmlld3BvcnRcbiAgKTtcbiAgdmFyIHVwZGF0ZVNjaXNzb3IgPSB1c2VTY2lzc29yVGVzdCAhPT0gdGhpcy5fdXNlU2Npc3NvclRlc3Q7XG4gIHRoaXMuX3VzZVNjaXNzb3JUZXN0ID0gdXNlU2Npc3NvclRlc3Q7XG5cbiAgaWYgKCFCb3VuZGluZ1JlY3RhbmdsZS5lcXVhbHModGhpcy5fc2Npc3NvclJlY3RhbmdsZSwgcGFzc1N0YXRlLnZpZXdwb3J0KSkge1xuICAgIHRoaXMuX3NjaXNzb3JSZWN0YW5nbGUgPSBCb3VuZGluZ1JlY3RhbmdsZS5jbG9uZShcbiAgICAgIHBhc3NTdGF0ZS52aWV3cG9ydCxcbiAgICAgIHRoaXMuX3NjaXNzb3JSZWN0YW5nbGVcbiAgICApO1xuICAgIHVwZGF0ZVNjaXNzb3IgPSB0cnVlO1xuICB9XG5cbiAgaWYgKFxuICAgICFkZWZpbmVkKHRoaXMuX3JzKSB8fFxuICAgICFCb3VuZGluZ1JlY3RhbmdsZS5lcXVhbHModGhpcy5fdmlld3BvcnQsIHRoaXMuX3JzLnZpZXdwb3J0KSB8fFxuICAgIHVwZGF0ZVNjaXNzb3JcbiAgKSB7XG4gICAgdGhpcy5fcnMgPSBSZW5kZXJTdGF0ZS5mcm9tQ2FjaGUoe1xuICAgICAgdmlld3BvcnQ6IHRoaXMuX3ZpZXdwb3J0LFxuICAgICAgc2Npc3NvclRlc3Q6IHtcbiAgICAgICAgZW5hYmxlZDogdGhpcy5fdXNlU2Npc3NvclRlc3QsXG4gICAgICAgIHJlY3RhbmdsZTogdGhpcy5fc2Npc3NvclJlY3RhbmdsZSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICBpZiAoZGVmaW5lZCh0aGlzLl9jb21wb3NpdGVDb21tYW5kKSkge1xuICAgIHRoaXMuX2NvbXBvc2l0ZUNvbW1hbmQucmVuZGVyU3RhdGUgPSB0aGlzLl9ycztcbiAgfVxuXG4gIGlmICh0aGlzLl9hZGp1c3RUcmFuc2x1Y2VudENvbW1hbmQpIHtcbiAgICB0aGlzLl9hZGp1c3RUcmFuc2x1Y2VudENvbW1hbmQucmVuZGVyU3RhdGUgPSB0aGlzLl9ycztcbiAgfVxuXG4gIGlmIChkZWZpbmVkKHRoaXMuX2FkanVzdEFscGhhQ29tbWFuZCkpIHtcbiAgICB0aGlzLl9hZGp1c3RBbHBoYUNvbW1hbmQucmVuZGVyU3RhdGUgPSB0aGlzLl9ycztcbiAgfVxufTtcblxudmFyIHRyYW5zbHVjZW50TVJUQmxlbmQgPSB7XG4gIGVuYWJsZWQ6IHRydWUsXG4gIGNvbG9yOiBuZXcgQ29sb3IoMC4wLCAwLjAsIDAuMCwgMC4wKSxcbiAgZXF1YXRpb25SZ2I6IEJsZW5kRXF1YXRpb24uQURELFxuICBlcXVhdGlvbkFscGhhOiBCbGVuZEVxdWF0aW9uLkFERCxcbiAgZnVuY3Rpb25Tb3VyY2VSZ2I6IEJsZW5kRnVuY3Rpb24uT05FLFxuICBmdW5jdGlvbkRlc3RpbmF0aW9uUmdiOiBCbGVuZEZ1bmN0aW9uLk9ORSxcbiAgZnVuY3Rpb25Tb3VyY2VBbHBoYTogQmxlbmRGdW5jdGlvbi5aRVJPLFxuICBmdW5jdGlvbkRlc3RpbmF0aW9uQWxwaGE6IEJsZW5kRnVuY3Rpb24uT05FX01JTlVTX1NPVVJDRV9BTFBIQSxcbn07XG5cbnZhciB0cmFuc2x1Y2VudENvbG9yQmxlbmQgPSB7XG4gIGVuYWJsZWQ6IHRydWUsXG4gIGNvbG9yOiBuZXcgQ29sb3IoMC4wLCAwLjAsIDAuMCwgMC4wKSxcbiAgZXF1YXRpb25SZ2I6IEJsZW5kRXF1YXRpb24uQURELFxuICBlcXVhdGlvbkFscGhhOiBCbGVuZEVxdWF0aW9uLkFERCxcbiAgZnVuY3Rpb25Tb3VyY2VSZ2I6IEJsZW5kRnVuY3Rpb24uT05FLFxuICBmdW5jdGlvbkRlc3RpbmF0aW9uUmdiOiBCbGVuZEZ1bmN0aW9uLk9ORSxcbiAgZnVuY3Rpb25Tb3VyY2VBbHBoYTogQmxlbmRGdW5jdGlvbi5PTkUsXG4gIGZ1bmN0aW9uRGVzdGluYXRpb25BbHBoYTogQmxlbmRGdW5jdGlvbi5PTkUsXG59O1xuXG52YXIgdHJhbnNsdWNlbnRBbHBoYUJsZW5kID0ge1xuICBlbmFibGVkOiB0cnVlLFxuICBjb2xvcjogbmV3IENvbG9yKDAuMCwgMC4wLCAwLjAsIDAuMCksXG4gIGVxdWF0aW9uUmdiOiBCbGVuZEVxdWF0aW9uLkFERCxcbiAgZXF1YXRpb25BbHBoYTogQmxlbmRFcXVhdGlvbi5BREQsXG4gIGZ1bmN0aW9uU291cmNlUmdiOiBCbGVuZEZ1bmN0aW9uLlpFUk8sXG4gIGZ1bmN0aW9uRGVzdGluYXRpb25SZ2I6IEJsZW5kRnVuY3Rpb24uT05FX01JTlVTX1NPVVJDRV9BTFBIQSxcbiAgZnVuY3Rpb25Tb3VyY2VBbHBoYTogQmxlbmRGdW5jdGlvbi5aRVJPLFxuICBmdW5jdGlvbkRlc3RpbmF0aW9uQWxwaGE6IEJsZW5kRnVuY3Rpb24uT05FX01JTlVTX1NPVVJDRV9BTFBIQSxcbn07XG5cbmZ1bmN0aW9uIGdldFRyYW5zbHVjZW50UmVuZGVyU3RhdGUoXG4gIGNvbnRleHQsXG4gIHRyYW5zbHVjZW50QmxlbmRpbmcsXG4gIGNhY2hlLFxuICByZW5kZXJTdGF0ZVxuKSB7XG4gIHZhciB0cmFuc2x1Y2VudFN0YXRlID0gY2FjaGVbcmVuZGVyU3RhdGUuaWRdO1xuICBpZiAoIWRlZmluZWQodHJhbnNsdWNlbnRTdGF0ZSkpIHtcbiAgICB2YXIgcnMgPSBSZW5kZXJTdGF0ZS5nZXRTdGF0ZShyZW5kZXJTdGF0ZSk7XG4gICAgcnMuZGVwdGhNYXNrID0gZmFsc2U7XG4gICAgcnMuYmxlbmRpbmcgPSB0cmFuc2x1Y2VudEJsZW5kaW5nO1xuXG4gICAgdHJhbnNsdWNlbnRTdGF0ZSA9IFJlbmRlclN0YXRlLmZyb21DYWNoZShycyk7XG4gICAgY2FjaGVbcmVuZGVyU3RhdGUuaWRdID0gdHJhbnNsdWNlbnRTdGF0ZTtcbiAgfVxuXG4gIHJldHVybiB0cmFuc2x1Y2VudFN0YXRlO1xufVxuXG5mdW5jdGlvbiBnZXRUcmFuc2x1Y2VudE1SVFJlbmRlclN0YXRlKG9pdCwgY29udGV4dCwgcmVuZGVyU3RhdGUpIHtcbiAgcmV0dXJuIGdldFRyYW5zbHVjZW50UmVuZGVyU3RhdGUoXG4gICAgY29udGV4dCxcbiAgICB0cmFuc2x1Y2VudE1SVEJsZW5kLFxuICAgIG9pdC5fdHJhbnNsdWNlbnRSZW5kZXJTdGF0ZUNhY2hlLFxuICAgIHJlbmRlclN0YXRlXG4gICk7XG59XG5cbmZ1bmN0aW9uIGdldFRyYW5zbHVjZW50Q29sb3JSZW5kZXJTdGF0ZShvaXQsIGNvbnRleHQsIHJlbmRlclN0YXRlKSB7XG4gIHJldHVybiBnZXRUcmFuc2x1Y2VudFJlbmRlclN0YXRlKFxuICAgIGNvbnRleHQsXG4gICAgdHJhbnNsdWNlbnRDb2xvckJsZW5kLFxuICAgIG9pdC5fdHJhbnNsdWNlbnRSZW5kZXJTdGF0ZUNhY2hlLFxuICAgIHJlbmRlclN0YXRlXG4gICk7XG59XG5cbmZ1bmN0aW9uIGdldFRyYW5zbHVjZW50QWxwaGFSZW5kZXJTdGF0ZShvaXQsIGNvbnRleHQsIHJlbmRlclN0YXRlKSB7XG4gIHJldHVybiBnZXRUcmFuc2x1Y2VudFJlbmRlclN0YXRlKFxuICAgIGNvbnRleHQsXG4gICAgdHJhbnNsdWNlbnRBbHBoYUJsZW5kLFxuICAgIG9pdC5fYWxwaGFSZW5kZXJTdGF0ZUNhY2hlLFxuICAgIHJlbmRlclN0YXRlXG4gICk7XG59XG5cbnZhciBtcnRTaGFkZXJTb3VyY2UgPVxuICBcIiAgICB2ZWMzIENpID0gY3ptX2dsX0ZyYWdDb2xvci5yZ2IgKiBjem1fZ2xfRnJhZ0NvbG9yLmE7XFxuXCIgK1xuICBcIiAgICBmbG9hdCBhaSA9IGN6bV9nbF9GcmFnQ29sb3IuYTtcXG5cIiArXG4gIFwiICAgIGZsb2F0IHd6aSA9IGN6bV9hbHBoYVdlaWdodChhaSk7XFxuXCIgK1xuICBcIiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoQ2kgKiB3emksIGFpKTtcXG5cIiArXG4gIFwiICAgIGdsX0ZyYWdEYXRhWzFdID0gdmVjNChhaSAqIHd6aSk7XFxuXCI7XG5cbnZhciBjb2xvclNoYWRlclNvdXJjZSA9XG4gIFwiICAgIHZlYzMgQ2kgPSBjem1fZ2xfRnJhZ0NvbG9yLnJnYiAqIGN6bV9nbF9GcmFnQ29sb3IuYTtcXG5cIiArXG4gIFwiICAgIGZsb2F0IGFpID0gY3ptX2dsX0ZyYWdDb2xvci5hO1xcblwiICtcbiAgXCIgICAgZmxvYXQgd3ppID0gY3ptX2FscGhhV2VpZ2h0KGFpKTtcXG5cIiArXG4gIFwiICAgIGdsX0ZyYWdDb2xvciA9IHZlYzQoQ2ksIGFpKSAqIHd6aTtcXG5cIjtcblxudmFyIGFscGhhU2hhZGVyU291cmNlID1cbiAgXCIgICAgZmxvYXQgYWkgPSBjem1fZ2xfRnJhZ0NvbG9yLmE7XFxuXCIgKyBcIiAgICBnbF9GcmFnQ29sb3IgPSB2ZWM0KGFpKTtcXG5cIjtcblxuZnVuY3Rpb24gZ2V0VHJhbnNsdWNlbnRTaGFkZXJQcm9ncmFtKGNvbnRleHQsIHNoYWRlclByb2dyYW0sIGtleXdvcmQsIHNvdXJjZSkge1xuICB2YXIgc2hhZGVyID0gY29udGV4dC5zaGFkZXJDYWNoZS5nZXREZXJpdmVkU2hhZGVyUHJvZ3JhbShcbiAgICBzaGFkZXJQcm9ncmFtLFxuICAgIGtleXdvcmRcbiAgKTtcbiAgaWYgKCFkZWZpbmVkKHNoYWRlcikpIHtcbiAgICB2YXIgYXR0cmlidXRlTG9jYXRpb25zID0gc2hhZGVyUHJvZ3JhbS5fYXR0cmlidXRlTG9jYXRpb25zO1xuXG4gICAgdmFyIGZzID0gc2hhZGVyUHJvZ3JhbS5mcmFnbWVudFNoYWRlclNvdXJjZS5jbG9uZSgpO1xuXG4gICAgZnMuc291cmNlcyA9IGZzLnNvdXJjZXMubWFwKGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAgIHNvdXJjZSA9IFNoYWRlclNvdXJjZS5yZXBsYWNlTWFpbihzb3VyY2UsIFwiY3ptX3RyYW5zbHVjZW50X21haW5cIik7XG4gICAgICBzb3VyY2UgPSBzb3VyY2UucmVwbGFjZSgvZ2xfRnJhZ0NvbG9yL2csIFwiY3ptX2dsX0ZyYWdDb2xvclwiKTtcbiAgICAgIHNvdXJjZSA9IHNvdXJjZS5yZXBsYWNlKC9cXGJkaXNjYXJkXFxiL2csIFwiY3ptX2Rpc2NhcmQgPSB0cnVlXCIpO1xuICAgICAgc291cmNlID0gc291cmNlLnJlcGxhY2UoL2N6bV9waG9uZy9nLCBcImN6bV90cmFuc2x1Y2VudFBob25nXCIpO1xuICAgICAgcmV0dXJuIHNvdXJjZTtcbiAgICB9KTtcblxuICAgIC8vIERpc2NhcmRpbmcgdGhlIGZyYWdtZW50IGluIG1haW4gaXMgYSB3b3JrYXJvdW5kIGZvciBBTkdMRSBEM0Q5XG4gICAgLy8gc2hhZGVyIGNvbXBpbGF0aW9uIGVycm9ycy5cblxuICAgIGZzLnNvdXJjZXMuc3BsaWNlKFxuICAgICAgMCxcbiAgICAgIDAsXG4gICAgICAoc291cmNlLmluZGV4T2YoXCJnbF9GcmFnRGF0YVwiKSAhPT0gLTFcbiAgICAgICAgPyBcIiNleHRlbnNpb24gR0xfRVhUX2RyYXdfYnVmZmVycyA6IGVuYWJsZSBcXG5cIlxuICAgICAgICA6IFwiXCIpICtcbiAgICAgICAgXCJ2ZWM0IGN6bV9nbF9GcmFnQ29sb3I7XFxuXCIgK1xuICAgICAgICBcImJvb2wgY3ptX2Rpc2NhcmQgPSBmYWxzZTtcXG5cIlxuICAgICk7XG5cbiAgICBmcy5zb3VyY2VzLnB1c2goXG4gICAgICBcInZvaWQgbWFpbigpXFxuXCIgK1xuICAgICAgICBcIntcXG5cIiArXG4gICAgICAgIFwiICAgIGN6bV90cmFuc2x1Y2VudF9tYWluKCk7XFxuXCIgK1xuICAgICAgICBcIiAgICBpZiAoY3ptX2Rpc2NhcmQpXFxuXCIgK1xuICAgICAgICBcIiAgICB7XFxuXCIgK1xuICAgICAgICBcIiAgICAgICAgZGlzY2FyZDtcXG5cIiArXG4gICAgICAgIFwiICAgIH1cXG5cIiArXG4gICAgICAgIHNvdXJjZSArXG4gICAgICAgIFwifVxcblwiXG4gICAgKTtcblxuICAgIHNoYWRlciA9IGNvbnRleHQuc2hhZGVyQ2FjaGUuY3JlYXRlRGVyaXZlZFNoYWRlclByb2dyYW0oXG4gICAgICBzaGFkZXJQcm9ncmFtLFxuICAgICAga2V5d29yZCxcbiAgICAgIHtcbiAgICAgICAgdmVydGV4U2hhZGVyU291cmNlOiBzaGFkZXJQcm9ncmFtLnZlcnRleFNoYWRlclNvdXJjZSxcbiAgICAgICAgZnJhZ21lbnRTaGFkZXJTb3VyY2U6IGZzLFxuICAgICAgICBhdHRyaWJ1dGVMb2NhdGlvbnM6IGF0dHJpYnV0ZUxvY2F0aW9ucyxcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIHNoYWRlcjtcbn1cblxuZnVuY3Rpb24gZ2V0VHJhbnNsdWNlbnRNUlRTaGFkZXJQcm9ncmFtKGNvbnRleHQsIHNoYWRlclByb2dyYW0pIHtcbiAgcmV0dXJuIGdldFRyYW5zbHVjZW50U2hhZGVyUHJvZ3JhbShcbiAgICBjb250ZXh0LFxuICAgIHNoYWRlclByb2dyYW0sXG4gICAgXCJ0cmFuc2x1Y2VudE1SVFwiLFxuICAgIG1ydFNoYWRlclNvdXJjZVxuICApO1xufVxuXG5mdW5jdGlvbiBnZXRUcmFuc2x1Y2VudENvbG9yU2hhZGVyUHJvZ3JhbShjb250ZXh0LCBzaGFkZXJQcm9ncmFtKSB7XG4gIHJldHVybiBnZXRUcmFuc2x1Y2VudFNoYWRlclByb2dyYW0oXG4gICAgY29udGV4dCxcbiAgICBzaGFkZXJQcm9ncmFtLFxuICAgIFwidHJhbnNsdWNlbnRNdWx0aXBhc3NcIixcbiAgICBjb2xvclNoYWRlclNvdXJjZVxuICApO1xufVxuXG5mdW5jdGlvbiBnZXRUcmFuc2x1Y2VudEFscGhhU2hhZGVyUHJvZ3JhbShjb250ZXh0LCBzaGFkZXJQcm9ncmFtKSB7XG4gIHJldHVybiBnZXRUcmFuc2x1Y2VudFNoYWRlclByb2dyYW0oXG4gICAgY29udGV4dCxcbiAgICBzaGFkZXJQcm9ncmFtLFxuICAgIFwiYWxwaGFNdWx0aXBhc3NcIixcbiAgICBhbHBoYVNoYWRlclNvdXJjZVxuICApO1xufVxuXG5PSVQucHJvdG90eXBlLmNyZWF0ZURlcml2ZWRDb21tYW5kcyA9IGZ1bmN0aW9uIChjb21tYW5kLCBjb250ZXh0LCByZXN1bHQpIHtcbiAgaWYgKCFkZWZpbmVkKHJlc3VsdCkpIHtcbiAgICByZXN1bHQgPSB7fTtcbiAgfVxuXG4gIGlmICh0aGlzLl90cmFuc2x1Y2VudE1SVFN1cHBvcnQpIHtcbiAgICB2YXIgdHJhbnNsdWNlbnRTaGFkZXI7XG4gICAgdmFyIHRyYW5zbHVjZW50UmVuZGVyU3RhdGU7XG4gICAgaWYgKGRlZmluZWQocmVzdWx0LnRyYW5zbHVjZW50Q29tbWFuZCkpIHtcbiAgICAgIHRyYW5zbHVjZW50U2hhZGVyID0gcmVzdWx0LnRyYW5zbHVjZW50Q29tbWFuZC5zaGFkZXJQcm9ncmFtO1xuICAgICAgdHJhbnNsdWNlbnRSZW5kZXJTdGF0ZSA9IHJlc3VsdC50cmFuc2x1Y2VudENvbW1hbmQucmVuZGVyU3RhdGU7XG4gICAgfVxuXG4gICAgcmVzdWx0LnRyYW5zbHVjZW50Q29tbWFuZCA9IERyYXdDb21tYW5kLnNoYWxsb3dDbG9uZShcbiAgICAgIGNvbW1hbmQsXG4gICAgICByZXN1bHQudHJhbnNsdWNlbnRDb21tYW5kXG4gICAgKTtcblxuICAgIGlmIChcbiAgICAgICFkZWZpbmVkKHRyYW5zbHVjZW50U2hhZGVyKSB8fFxuICAgICAgcmVzdWx0LnNoYWRlclByb2dyYW1JZCAhPT0gY29tbWFuZC5zaGFkZXJQcm9ncmFtLmlkXG4gICAgKSB7XG4gICAgICByZXN1bHQudHJhbnNsdWNlbnRDb21tYW5kLnNoYWRlclByb2dyYW0gPSBnZXRUcmFuc2x1Y2VudE1SVFNoYWRlclByb2dyYW0oXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIGNvbW1hbmQuc2hhZGVyUHJvZ3JhbVxuICAgICAgKTtcbiAgICAgIHJlc3VsdC50cmFuc2x1Y2VudENvbW1hbmQucmVuZGVyU3RhdGUgPSBnZXRUcmFuc2x1Y2VudE1SVFJlbmRlclN0YXRlKFxuICAgICAgICB0aGlzLFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICBjb21tYW5kLnJlbmRlclN0YXRlXG4gICAgICApO1xuICAgICAgcmVzdWx0LnNoYWRlclByb2dyYW1JZCA9IGNvbW1hbmQuc2hhZGVyUHJvZ3JhbS5pZDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0LnRyYW5zbHVjZW50Q29tbWFuZC5zaGFkZXJQcm9ncmFtID0gdHJhbnNsdWNlbnRTaGFkZXI7XG4gICAgICByZXN1bHQudHJhbnNsdWNlbnRDb21tYW5kLnJlbmRlclN0YXRlID0gdHJhbnNsdWNlbnRSZW5kZXJTdGF0ZTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdmFyIGNvbG9yU2hhZGVyO1xuICAgIHZhciBjb2xvclJlbmRlclN0YXRlO1xuICAgIHZhciBhbHBoYVNoYWRlcjtcbiAgICB2YXIgYWxwaGFSZW5kZXJTdGF0ZTtcbiAgICBpZiAoZGVmaW5lZChyZXN1bHQudHJhbnNsdWNlbnRDb21tYW5kKSkge1xuICAgICAgY29sb3JTaGFkZXIgPSByZXN1bHQudHJhbnNsdWNlbnRDb21tYW5kLnNoYWRlclByb2dyYW07XG4gICAgICBjb2xvclJlbmRlclN0YXRlID0gcmVzdWx0LnRyYW5zbHVjZW50Q29tbWFuZC5yZW5kZXJTdGF0ZTtcbiAgICAgIGFscGhhU2hhZGVyID0gcmVzdWx0LmFscGhhQ29tbWFuZC5zaGFkZXJQcm9ncmFtO1xuICAgICAgYWxwaGFSZW5kZXJTdGF0ZSA9IHJlc3VsdC5hbHBoYUNvbW1hbmQucmVuZGVyU3RhdGU7XG4gICAgfVxuXG4gICAgcmVzdWx0LnRyYW5zbHVjZW50Q29tbWFuZCA9IERyYXdDb21tYW5kLnNoYWxsb3dDbG9uZShcbiAgICAgIGNvbW1hbmQsXG4gICAgICByZXN1bHQudHJhbnNsdWNlbnRDb21tYW5kXG4gICAgKTtcbiAgICByZXN1bHQuYWxwaGFDb21tYW5kID0gRHJhd0NvbW1hbmQuc2hhbGxvd0Nsb25lKFxuICAgICAgY29tbWFuZCxcbiAgICAgIHJlc3VsdC5hbHBoYUNvbW1hbmRcbiAgICApO1xuXG4gICAgaWYgKFxuICAgICAgIWRlZmluZWQoY29sb3JTaGFkZXIpIHx8XG4gICAgICByZXN1bHQuc2hhZGVyUHJvZ3JhbUlkICE9PSBjb21tYW5kLnNoYWRlclByb2dyYW0uaWRcbiAgICApIHtcbiAgICAgIHJlc3VsdC50cmFuc2x1Y2VudENvbW1hbmQuc2hhZGVyUHJvZ3JhbSA9IGdldFRyYW5zbHVjZW50Q29sb3JTaGFkZXJQcm9ncmFtKFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICBjb21tYW5kLnNoYWRlclByb2dyYW1cbiAgICAgICk7XG4gICAgICByZXN1bHQudHJhbnNsdWNlbnRDb21tYW5kLnJlbmRlclN0YXRlID0gZ2V0VHJhbnNsdWNlbnRDb2xvclJlbmRlclN0YXRlKFxuICAgICAgICB0aGlzLFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICBjb21tYW5kLnJlbmRlclN0YXRlXG4gICAgICApO1xuICAgICAgcmVzdWx0LmFscGhhQ29tbWFuZC5zaGFkZXJQcm9ncmFtID0gZ2V0VHJhbnNsdWNlbnRBbHBoYVNoYWRlclByb2dyYW0oXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIGNvbW1hbmQuc2hhZGVyUHJvZ3JhbVxuICAgICAgKTtcbiAgICAgIHJlc3VsdC5hbHBoYUNvbW1hbmQucmVuZGVyU3RhdGUgPSBnZXRUcmFuc2x1Y2VudEFscGhhUmVuZGVyU3RhdGUoXG4gICAgICAgIHRoaXMsXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIGNvbW1hbmQucmVuZGVyU3RhdGVcbiAgICAgICk7XG4gICAgICByZXN1bHQuc2hhZGVyUHJvZ3JhbUlkID0gY29tbWFuZC5zaGFkZXJQcm9ncmFtLmlkO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQudHJhbnNsdWNlbnRDb21tYW5kLnNoYWRlclByb2dyYW0gPSBjb2xvclNoYWRlcjtcbiAgICAgIHJlc3VsdC50cmFuc2x1Y2VudENvbW1hbmQucmVuZGVyU3RhdGUgPSBjb2xvclJlbmRlclN0YXRlO1xuICAgICAgcmVzdWx0LmFscGhhQ29tbWFuZC5zaGFkZXJQcm9ncmFtID0gYWxwaGFTaGFkZXI7XG4gICAgICByZXN1bHQuYWxwaGFDb21tYW5kLnJlbmRlclN0YXRlID0gYWxwaGFSZW5kZXJTdGF0ZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufTtcblxuZnVuY3Rpb24gZXhlY3V0ZVRyYW5zbHVjZW50Q29tbWFuZHNTb3J0ZWRNdWx0aXBhc3MoXG4gIG9pdCxcbiAgc2NlbmUsXG4gIGV4ZWN1dGVGdW5jdGlvbixcbiAgcGFzc1N0YXRlLFxuICBjb21tYW5kcyxcbiAgaW52ZXJ0Q2xhc3NpZmljYXRpb25cbikge1xuICB2YXIgY29tbWFuZDtcbiAgdmFyIGRlcml2ZWRDb21tYW5kO1xuICB2YXIgajtcblxuICB2YXIgY29udGV4dCA9IHNjZW5lLmNvbnRleHQ7XG4gIHZhciB1c2VMb2dEZXB0aCA9IHNjZW5lLmZyYW1lU3RhdGUudXNlTG9nRGVwdGg7XG4gIHZhciB1c2VIZHIgPSBzY2VuZS5faGRyO1xuICB2YXIgZnJhbWVidWZmZXIgPSBwYXNzU3RhdGUuZnJhbWVidWZmZXI7XG4gIHZhciBsZW5ndGggPSBjb21tYW5kcy5sZW5ndGg7XG5cbiAgdmFyIGxpZ2h0U2hhZG93c0VuYWJsZWQgPSBzY2VuZS5mcmFtZVN0YXRlLnNoYWRvd1N0YXRlLmxpZ2h0U2hhZG93c0VuYWJsZWQ7XG5cbiAgcGFzc1N0YXRlLmZyYW1lYnVmZmVyID0gb2l0Ll9hZGp1c3RUcmFuc2x1Y2VudEZCTztcbiAgb2l0Ll9hZGp1c3RUcmFuc2x1Y2VudENvbW1hbmQuZXhlY3V0ZShjb250ZXh0LCBwYXNzU3RhdGUpO1xuICBwYXNzU3RhdGUuZnJhbWVidWZmZXIgPSBvaXQuX2FkanVzdEFscGhhRkJPO1xuICBvaXQuX2FkanVzdEFscGhhQ29tbWFuZC5leGVjdXRlKGNvbnRleHQsIHBhc3NTdGF0ZSk7XG5cbiAgdmFyIGRlYnVnRnJhbWVidWZmZXIgPSBvaXQuX29wYXF1ZUZCTztcbiAgcGFzc1N0YXRlLmZyYW1lYnVmZmVyID0gb2l0Ll90cmFuc2x1Y2VudEZCTztcblxuICBmb3IgKGogPSAwOyBqIDwgbGVuZ3RoOyArK2opIHtcbiAgICBjb21tYW5kID0gY29tbWFuZHNbal07XG4gICAgY29tbWFuZCA9IHVzZUxvZ0RlcHRoID8gY29tbWFuZC5kZXJpdmVkQ29tbWFuZHMubG9nRGVwdGguY29tbWFuZCA6IGNvbW1hbmQ7XG4gICAgY29tbWFuZCA9IHVzZUhkciA/IGNvbW1hbmQuZGVyaXZlZENvbW1hbmRzLmhkci5jb21tYW5kIDogY29tbWFuZDtcbiAgICBkZXJpdmVkQ29tbWFuZCA9XG4gICAgICBsaWdodFNoYWRvd3NFbmFibGVkICYmIGNvbW1hbmQucmVjZWl2ZVNoYWRvd3NcbiAgICAgICAgPyBjb21tYW5kLmRlcml2ZWRDb21tYW5kcy5vaXQuc2hhZG93cy50cmFuc2x1Y2VudENvbW1hbmRcbiAgICAgICAgOiBjb21tYW5kLmRlcml2ZWRDb21tYW5kcy5vaXQudHJhbnNsdWNlbnRDb21tYW5kO1xuICAgIGV4ZWN1dGVGdW5jdGlvbihcbiAgICAgIGRlcml2ZWRDb21tYW5kLFxuICAgICAgc2NlbmUsXG4gICAgICBjb250ZXh0LFxuICAgICAgcGFzc1N0YXRlLFxuICAgICAgZGVidWdGcmFtZWJ1ZmZlclxuICAgICk7XG4gIH1cblxuICBpZiAoZGVmaW5lZChpbnZlcnRDbGFzc2lmaWNhdGlvbikpIHtcbiAgICBjb21tYW5kID0gaW52ZXJ0Q2xhc3NpZmljYXRpb24udW5jbGFzc2lmaWVkQ29tbWFuZDtcbiAgICBkZXJpdmVkQ29tbWFuZCA9XG4gICAgICBsaWdodFNoYWRvd3NFbmFibGVkICYmIGNvbW1hbmQucmVjZWl2ZVNoYWRvd3NcbiAgICAgICAgPyBjb21tYW5kLmRlcml2ZWRDb21tYW5kcy5vaXQuc2hhZG93cy50cmFuc2x1Y2VudENvbW1hbmRcbiAgICAgICAgOiBjb21tYW5kLmRlcml2ZWRDb21tYW5kcy5vaXQudHJhbnNsdWNlbnRDb21tYW5kO1xuICAgIGV4ZWN1dGVGdW5jdGlvbihcbiAgICAgIGRlcml2ZWRDb21tYW5kLFxuICAgICAgc2NlbmUsXG4gICAgICBjb250ZXh0LFxuICAgICAgcGFzc1N0YXRlLFxuICAgICAgZGVidWdGcmFtZWJ1ZmZlclxuICAgICk7XG4gIH1cblxuICBwYXNzU3RhdGUuZnJhbWVidWZmZXIgPSBvaXQuX2FscGhhRkJPO1xuXG4gIGZvciAoaiA9IDA7IGogPCBsZW5ndGg7ICsraikge1xuICAgIGNvbW1hbmQgPSBjb21tYW5kc1tqXTtcbiAgICBjb21tYW5kID0gdXNlTG9nRGVwdGggPyBjb21tYW5kLmRlcml2ZWRDb21tYW5kcy5sb2dEZXB0aC5jb21tYW5kIDogY29tbWFuZDtcbiAgICBjb21tYW5kID0gdXNlSGRyID8gY29tbWFuZC5kZXJpdmVkQ29tbWFuZHMuaGRyLmNvbW1hbmQgOiBjb21tYW5kO1xuICAgIGRlcml2ZWRDb21tYW5kID1cbiAgICAgIGxpZ2h0U2hhZG93c0VuYWJsZWQgJiYgY29tbWFuZC5yZWNlaXZlU2hhZG93c1xuICAgICAgICA/IGNvbW1hbmQuZGVyaXZlZENvbW1hbmRzLm9pdC5zaGFkb3dzLmFscGhhQ29tbWFuZFxuICAgICAgICA6IGNvbW1hbmQuZGVyaXZlZENvbW1hbmRzLm9pdC5hbHBoYUNvbW1hbmQ7XG4gICAgZXhlY3V0ZUZ1bmN0aW9uKFxuICAgICAgZGVyaXZlZENvbW1hbmQsXG4gICAgICBzY2VuZSxcbiAgICAgIGNvbnRleHQsXG4gICAgICBwYXNzU3RhdGUsXG4gICAgICBkZWJ1Z0ZyYW1lYnVmZmVyXG4gICAgKTtcbiAgfVxuXG4gIGlmIChkZWZpbmVkKGludmVydENsYXNzaWZpY2F0aW9uKSkge1xuICAgIGNvbW1hbmQgPSBpbnZlcnRDbGFzc2lmaWNhdGlvbi51bmNsYXNzaWZpZWRDb21tYW5kO1xuICAgIGRlcml2ZWRDb21tYW5kID1cbiAgICAgIGxpZ2h0U2hhZG93c0VuYWJsZWQgJiYgY29tbWFuZC5yZWNlaXZlU2hhZG93c1xuICAgICAgICA/IGNvbW1hbmQuZGVyaXZlZENvbW1hbmRzLm9pdC5zaGFkb3dzLmFscGhhQ29tbWFuZFxuICAgICAgICA6IGNvbW1hbmQuZGVyaXZlZENvbW1hbmRzLm9pdC5hbHBoYUNvbW1hbmQ7XG4gICAgZXhlY3V0ZUZ1bmN0aW9uKFxuICAgICAgZGVyaXZlZENvbW1hbmQsXG4gICAgICBzY2VuZSxcbiAgICAgIGNvbnRleHQsXG4gICAgICBwYXNzU3RhdGUsXG4gICAgICBkZWJ1Z0ZyYW1lYnVmZmVyXG4gICAgKTtcbiAgfVxuXG4gIHBhc3NTdGF0ZS5mcmFtZWJ1ZmZlciA9IGZyYW1lYnVmZmVyO1xufVxuXG5mdW5jdGlvbiBleGVjdXRlVHJhbnNsdWNlbnRDb21tYW5kc1NvcnRlZE1SVChcbiAgb2l0LFxuICBzY2VuZSxcbiAgZXhlY3V0ZUZ1bmN0aW9uLFxuICBwYXNzU3RhdGUsXG4gIGNvbW1hbmRzLFxuICBpbnZlcnRDbGFzc2lmaWNhdGlvblxuKSB7XG4gIHZhciBjb250ZXh0ID0gc2NlbmUuY29udGV4dDtcbiAgdmFyIHVzZUxvZ0RlcHRoID0gc2NlbmUuZnJhbWVTdGF0ZS51c2VMb2dEZXB0aDtcbiAgdmFyIHVzZUhkciA9IHNjZW5lLl9oZHI7XG4gIHZhciBmcmFtZWJ1ZmZlciA9IHBhc3NTdGF0ZS5mcmFtZWJ1ZmZlcjtcbiAgdmFyIGxlbmd0aCA9IGNvbW1hbmRzLmxlbmd0aDtcblxuICB2YXIgbGlnaHRTaGFkb3dzRW5hYmxlZCA9IHNjZW5lLmZyYW1lU3RhdGUuc2hhZG93U3RhdGUubGlnaHRTaGFkb3dzRW5hYmxlZDtcblxuICBwYXNzU3RhdGUuZnJhbWVidWZmZXIgPSBvaXQuX2FkanVzdFRyYW5zbHVjZW50RkJPO1xuICBvaXQuX2FkanVzdFRyYW5zbHVjZW50Q29tbWFuZC5leGVjdXRlKGNvbnRleHQsIHBhc3NTdGF0ZSk7XG5cbiAgdmFyIGRlYnVnRnJhbWVidWZmZXIgPSBvaXQuX29wYXF1ZUZCTztcbiAgcGFzc1N0YXRlLmZyYW1lYnVmZmVyID0gb2l0Ll90cmFuc2x1Y2VudEZCTztcblxuICB2YXIgY29tbWFuZDtcbiAgdmFyIGRlcml2ZWRDb21tYW5kO1xuXG4gIGZvciAodmFyIGogPSAwOyBqIDwgbGVuZ3RoOyArK2opIHtcbiAgICBjb21tYW5kID0gY29tbWFuZHNbal07XG4gICAgY29tbWFuZCA9IHVzZUxvZ0RlcHRoID8gY29tbWFuZC5kZXJpdmVkQ29tbWFuZHMubG9nRGVwdGguY29tbWFuZCA6IGNvbW1hbmQ7XG4gICAgY29tbWFuZCA9IHVzZUhkciA/IGNvbW1hbmQuZGVyaXZlZENvbW1hbmRzLmhkci5jb21tYW5kIDogY29tbWFuZDtcbiAgICBkZXJpdmVkQ29tbWFuZCA9XG4gICAgICBsaWdodFNoYWRvd3NFbmFibGVkICYmIGNvbW1hbmQucmVjZWl2ZVNoYWRvd3NcbiAgICAgICAgPyBjb21tYW5kLmRlcml2ZWRDb21tYW5kcy5vaXQuc2hhZG93cy50cmFuc2x1Y2VudENvbW1hbmRcbiAgICAgICAgOiBjb21tYW5kLmRlcml2ZWRDb21tYW5kcy5vaXQudHJhbnNsdWNlbnRDb21tYW5kO1xuICAgIGV4ZWN1dGVGdW5jdGlvbihcbiAgICAgIGRlcml2ZWRDb21tYW5kLFxuICAgICAgc2NlbmUsXG4gICAgICBjb250ZXh0LFxuICAgICAgcGFzc1N0YXRlLFxuICAgICAgZGVidWdGcmFtZWJ1ZmZlclxuICAgICk7XG4gIH1cblxuICBpZiAoZGVmaW5lZChpbnZlcnRDbGFzc2lmaWNhdGlvbikpIHtcbiAgICBjb21tYW5kID0gaW52ZXJ0Q2xhc3NpZmljYXRpb24udW5jbGFzc2lmaWVkQ29tbWFuZDtcbiAgICBkZXJpdmVkQ29tbWFuZCA9XG4gICAgICBsaWdodFNoYWRvd3NFbmFibGVkICYmIGNvbW1hbmQucmVjZWl2ZVNoYWRvd3NcbiAgICAgICAgPyBjb21tYW5kLmRlcml2ZWRDb21tYW5kcy5vaXQuc2hhZG93cy50cmFuc2x1Y2VudENvbW1hbmRcbiAgICAgICAgOiBjb21tYW5kLmRlcml2ZWRDb21tYW5kcy5vaXQudHJhbnNsdWNlbnRDb21tYW5kO1xuICAgIGV4ZWN1dGVGdW5jdGlvbihcbiAgICAgIGRlcml2ZWRDb21tYW5kLFxuICAgICAgc2NlbmUsXG4gICAgICBjb250ZXh0LFxuICAgICAgcGFzc1N0YXRlLFxuICAgICAgZGVidWdGcmFtZWJ1ZmZlclxuICAgICk7XG4gIH1cblxuICBwYXNzU3RhdGUuZnJhbWVidWZmZXIgPSBmcmFtZWJ1ZmZlcjtcbn1cblxuT0lULnByb3RvdHlwZS5leGVjdXRlQ29tbWFuZHMgPSBmdW5jdGlvbiAoXG4gIHNjZW5lLFxuICBleGVjdXRlRnVuY3Rpb24sXG4gIHBhc3NTdGF0ZSxcbiAgY29tbWFuZHMsXG4gIGludmVydENsYXNzaWZpY2F0aW9uXG4pIHtcbiAgaWYgKHRoaXMuX3RyYW5zbHVjZW50TVJUU3VwcG9ydCkge1xuICAgIGV4ZWN1dGVUcmFuc2x1Y2VudENvbW1hbmRzU29ydGVkTVJUKFxuICAgICAgdGhpcyxcbiAgICAgIHNjZW5lLFxuICAgICAgZXhlY3V0ZUZ1bmN0aW9uLFxuICAgICAgcGFzc1N0YXRlLFxuICAgICAgY29tbWFuZHMsXG4gICAgICBpbnZlcnRDbGFzc2lmaWNhdGlvblxuICAgICk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgZXhlY3V0ZVRyYW5zbHVjZW50Q29tbWFuZHNTb3J0ZWRNdWx0aXBhc3MoXG4gICAgdGhpcyxcbiAgICBzY2VuZSxcbiAgICBleGVjdXRlRnVuY3Rpb24sXG4gICAgcGFzc1N0YXRlLFxuICAgIGNvbW1hbmRzLFxuICAgIGludmVydENsYXNzaWZpY2F0aW9uXG4gICk7XG59O1xuXG5PSVQucHJvdG90eXBlLmV4ZWN1dGUgPSBmdW5jdGlvbiAoY29udGV4dCwgcGFzc1N0YXRlKSB7XG4gIHRoaXMuX2NvbXBvc2l0ZUNvbW1hbmQuZXhlY3V0ZShjb250ZXh0LCBwYXNzU3RhdGUpO1xufTtcblxuT0lULnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uIChjb250ZXh0LCBwYXNzU3RhdGUsIGNsZWFyQ29sb3IpIHtcbiAgdmFyIGZyYW1lYnVmZmVyID0gcGFzc1N0YXRlLmZyYW1lYnVmZmVyO1xuXG4gIHBhc3NTdGF0ZS5mcmFtZWJ1ZmZlciA9IHRoaXMuX29wYXF1ZUZCTztcbiAgQ29sb3IuY2xvbmUoY2xlYXJDb2xvciwgdGhpcy5fb3BhcXVlQ2xlYXJDb21tYW5kLmNvbG9yKTtcbiAgdGhpcy5fb3BhcXVlQ2xlYXJDb21tYW5kLmV4ZWN1dGUoY29udGV4dCwgcGFzc1N0YXRlKTtcblxuICBwYXNzU3RhdGUuZnJhbWVidWZmZXIgPSB0aGlzLl90cmFuc2x1Y2VudEZCTztcbiAgdmFyIHRyYW5zbHVjZW50Q2xlYXJDb21tYW5kID0gdGhpcy5fdHJhbnNsdWNlbnRNUlRTdXBwb3J0XG4gICAgPyB0aGlzLl90cmFuc2x1Y2VudE1SVENsZWFyQ29tbWFuZFxuICAgIDogdGhpcy5fdHJhbnNsdWNlbnRNdWx0aXBhc3NDbGVhckNvbW1hbmQ7XG4gIHRyYW5zbHVjZW50Q2xlYXJDb21tYW5kLmV4ZWN1dGUoY29udGV4dCwgcGFzc1N0YXRlKTtcblxuICBpZiAodGhpcy5fdHJhbnNsdWNlbnRNdWx0aXBhc3NTdXBwb3J0KSB7XG4gICAgcGFzc1N0YXRlLmZyYW1lYnVmZmVyID0gdGhpcy5fYWxwaGFGQk87XG4gICAgdGhpcy5fYWxwaGFDbGVhckNvbW1hbmQuZXhlY3V0ZShjb250ZXh0LCBwYXNzU3RhdGUpO1xuICB9XG5cbiAgcGFzc1N0YXRlLmZyYW1lYnVmZmVyID0gZnJhbWVidWZmZXI7XG59O1xuXG5PSVQucHJvdG90eXBlLmlzU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5fdHJhbnNsdWNlbnRNUlRTdXBwb3J0IHx8IHRoaXMuX3RyYW5zbHVjZW50TXVsdGlwYXNzU3VwcG9ydDtcbn07XG5cbk9JVC5wcm90b3R5cGUuaXNEZXN0cm95ZWQgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBmYWxzZTtcbn07XG5cbk9JVC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgZGVzdHJveVJlc291cmNlcyh0aGlzKTtcblxuICBpZiAoZGVmaW5lZCh0aGlzLl9jb21wb3NpdGVDb21tYW5kKSkge1xuICAgIHRoaXMuX2NvbXBvc2l0ZUNvbW1hbmQuc2hhZGVyUHJvZ3JhbSA9XG4gICAgICB0aGlzLl9jb21wb3NpdGVDb21tYW5kLnNoYWRlclByb2dyYW0gJiZcbiAgICAgIHRoaXMuX2NvbXBvc2l0ZUNvbW1hbmQuc2hhZGVyUHJvZ3JhbS5kZXN0cm95KCk7XG4gIH1cblxuICBpZiAoZGVmaW5lZCh0aGlzLl9hZGp1c3RUcmFuc2x1Y2VudENvbW1hbmQpKSB7XG4gICAgdGhpcy5fYWRqdXN0VHJhbnNsdWNlbnRDb21tYW5kLnNoYWRlclByb2dyYW0gPVxuICAgICAgdGhpcy5fYWRqdXN0VHJhbnNsdWNlbnRDb21tYW5kLnNoYWRlclByb2dyYW0gJiZcbiAgICAgIHRoaXMuX2FkanVzdFRyYW5zbHVjZW50Q29tbWFuZC5zaGFkZXJQcm9ncmFtLmRlc3Ryb3koKTtcbiAgfVxuXG4gIGlmIChkZWZpbmVkKHRoaXMuX2FkanVzdEFscGhhQ29tbWFuZCkpIHtcbiAgICB0aGlzLl9hZGp1c3RBbHBoYUNvbW1hbmQuc2hhZGVyUHJvZ3JhbSA9XG4gICAgICB0aGlzLl9hZGp1c3RBbHBoYUNvbW1hbmQuc2hhZGVyUHJvZ3JhbSAmJlxuICAgICAgdGhpcy5fYWRqdXN0QWxwaGFDb21tYW5kLnNoYWRlclByb2dyYW0uZGVzdHJveSgpO1xuICB9XG5cbiAgcmV0dXJuIGRlc3Ryb3lPYmplY3QodGhpcyk7XG59O1xuZXhwb3J0IGRlZmF1bHQgT0lUO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///45216\n')},22277:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(60216);\n/* harmony import */ var _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(84828);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(82982);\n/* harmony import */ var _Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(86511);\n/* harmony import */ var _Core_IndexDatatype_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(22832);\n/* harmony import */ var _Core_loadKTX2_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(54973);\n/* harmony import */ var _Core_PixelFormat_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(38443);\n/* harmony import */ var _Renderer_Buffer_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(99095);\n/* harmony import */ var _Renderer_BufferUsage_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(58597);\n/* harmony import */ var _Renderer_ComputeCommand_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(92357);\n/* harmony import */ var _Renderer_CubeMap_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(51107);\n/* harmony import */ var _Renderer_PixelDatatype_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(21572);\n/* harmony import */ var _Renderer_ShaderProgram_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(46588);\n/* harmony import */ var _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(53642);\n/* harmony import */ var _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(8743);\n/* harmony import */ var _Renderer_VertexArray_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(18192);\n/* harmony import */ var _Shaders_OctahedralProjectionAtlasFS_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(60120);\n/* harmony import */ var _Shaders_OctahedralProjectionFS_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(362);\n/* harmony import */ var _Shaders_OctahedralProjectionVS_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(7736);\n/* harmony import */ var _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(13222);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Packs all mip levels of a cube map into a 2D texture atlas.\n *\n * Octahedral projection is a way of putting the cube maps onto a 2D texture\n * with minimal distortion and easy look up.\n * See Chapter 16 of WebGL Insights "HDR Image-Based Lighting on the Web" by Jeff Russell\n * and "Octahedron Environment Maps" for reference.\n *\n * @private\n */\nfunction OctahedralProjectedCubeMap(url) {\n  this._url = url;\n\n  this._cubeMapBuffers = undefined;\n  this._cubeMaps = undefined;\n  this._texture = undefined;\n  this._mipTextures = undefined;\n  this._va = undefined;\n  this._sp = undefined;\n\n  this._maximumMipmapLevel = undefined;\n\n  this._loading = false;\n  this._ready = false;\n  this._readyPromise = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"].defer */ .Z.defer();\n}\n\nObject.defineProperties(OctahedralProjectedCubeMap.prototype, {\n  /**\n   * The url to the KTX2 file containing the specular environment map and convoluted mipmaps.\n   * @memberof OctahedralProjectedCubeMap.prototype\n   * @type {String}\n   * @readonly\n   */\n  url: {\n    get: function () {\n      return this._url;\n    },\n  },\n  /**\n   * A texture containing all the packed convolutions.\n   * @memberof OctahedralProjectedCubeMap.prototype\n   * @type {Texture}\n   * @readonly\n   */\n  texture: {\n    get: function () {\n      return this._texture;\n    },\n  },\n  /**\n   * The maximum number of mip levels.\n   * @memberOf OctahedralProjectedCubeMap.prototype\n   * @type {Number}\n   * @readonly\n   */\n  maximumMipmapLevel: {\n    get: function () {\n      return this._maximumMipmapLevel;\n    },\n  },\n  /**\n   * Determines if the texture atlas is complete and ready to use.\n   * @memberof OctahedralProjectedCubeMap.prototype\n   * @type {Boolean}\n   * @readonly\n   */\n  ready: {\n    get: function () {\n      return this._ready;\n    },\n  },\n  /**\n   * Gets a promise that resolves when the texture atlas is ready to use.\n   * @memberof OctahedralProjectedCubeMap.prototype\n   * @type {Promise<void>}\n   * @readonly\n   */\n  readyPromise: {\n    get: function () {\n      return this._readyPromise.promise;\n    },\n  },\n});\n\nOctahedralProjectedCubeMap.isSupported = function (context) {\n  return (\n    (context.colorBufferHalfFloat && context.halfFloatingPointTexture) ||\n    (context.floatingPointTexture && context.colorBufferFloat)\n  );\n};\n\n// These vertices are based on figure 1 from "Octahedron Environment Maps".\nvar v1 = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(1.0, 0.0, 0.0);\nvar v2 = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(0.0, 0.0, 1.0);\nvar v3 = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(-1.0, 0.0, 0.0);\nvar v4 = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(0.0, 0.0, -1.0);\nvar v5 = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(0.0, 1.0, 0.0);\nvar v6 = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(0.0, -1.0, 0.0);\n\n// top left, left, top, center, right, top right, bottom, bottom left, bottom right\nvar cubeMapCoordinates = [v5, v3, v2, v6, v1, v5, v4, v5, v5];\nvar length = cubeMapCoordinates.length;\nvar flatCubeMapCoordinates = new Float32Array(length * 3);\n\nvar offset = 0;\nfor (var i = 0; i < length; ++i, offset += 3) {\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].pack */ .Z.pack(cubeMapCoordinates[i], flatCubeMapCoordinates, offset);\n}\n\nvar flatPositions = new Float32Array([\n  -1.0,\n  1.0, // top left\n  -1.0,\n  0.0, // left\n  0.0,\n  1.0, // top\n  0.0,\n  0.0, // center\n  1.0,\n  0.0, // right\n  1.0,\n  1.0, // top right\n  0.0,\n  -1.0, // bottom\n  -1.0,\n  -1.0, // bottom left\n  1.0,\n  -1.0, // bottom right\n]);\nvar indices = new Uint16Array([\n  0,\n  1,\n  2, // top left, left, top,\n  2,\n  3,\n  1, // top, center, left,\n  7,\n  6,\n  1, // bottom left, bottom, left,\n  3,\n  6,\n  1, // center, bottom, left,\n  2,\n  5,\n  4, // top, top right, right,\n  3,\n  4,\n  2, // center, right, top,\n  4,\n  8,\n  6, // right, bottom right, bottom,\n  3,\n  4,\n  6, //center, right, bottom\n]);\n\nfunction createVertexArray(context) {\n  var positionBuffer = _Renderer_Buffer_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].createVertexBuffer */ .Z.createVertexBuffer({\n    context: context,\n    typedArray: flatPositions,\n    usage: _Renderer_BufferUsage_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].STATIC_DRAW */ .Z.STATIC_DRAW,\n  });\n  var cubeMapCoordinatesBuffer = _Renderer_Buffer_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].createVertexBuffer */ .Z.createVertexBuffer({\n    context: context,\n    typedArray: flatCubeMapCoordinates,\n    usage: _Renderer_BufferUsage_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].STATIC_DRAW */ .Z.STATIC_DRAW,\n  });\n  var indexBuffer = _Renderer_Buffer_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].createIndexBuffer */ .Z.createIndexBuffer({\n    context: context,\n    typedArray: indices,\n    usage: _Renderer_BufferUsage_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].STATIC_DRAW */ .Z.STATIC_DRAW,\n    indexDatatype: _Core_IndexDatatype_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].UNSIGNED_SHORT */ .Z.UNSIGNED_SHORT,\n  });\n\n  var attributes = [\n    {\n      index: 0,\n      vertexBuffer: positionBuffer,\n      componentsPerAttribute: 2,\n      componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].FLOAT */ .Z.FLOAT,\n    },\n    {\n      index: 1,\n      vertexBuffer: cubeMapCoordinatesBuffer,\n      componentsPerAttribute: 3,\n      componentDatatype: _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].FLOAT */ .Z.FLOAT,\n    },\n  ];\n  return new _Renderer_VertexArray_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z({\n    context: context,\n    attributes: attributes,\n    indexBuffer: indexBuffer,\n  });\n}\n\nfunction createUniformTexture(texture) {\n  return function () {\n    return texture;\n  };\n}\n\nfunction cleanupResources(map) {\n  map._va = map._va && map._va.destroy();\n  map._sp = map._sp && map._sp.destroy();\n\n  var i;\n  var length;\n\n  var cubeMaps = map._cubeMaps;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z)(cubeMaps)) {\n    length = cubeMaps.length;\n    for (i = 0; i < length; ++i) {\n      cubeMaps[i].destroy();\n    }\n  }\n  var mipTextures = map._mipTextures;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z)(mipTextures)) {\n    length = mipTextures.length;\n    for (i = 0; i < length; ++i) {\n      mipTextures[i].destroy();\n    }\n  }\n\n  map._va = undefined;\n  map._sp = undefined;\n  map._cubeMaps = undefined;\n  map._cubeMapBuffers = undefined;\n  map._mipTextures = undefined;\n}\n\n/**\n * Creates compute commands to generate octahedral projections of each cube map\n * and then renders them to an atlas.\n * <p>\n * Only needs to be called twice. The first call queues the compute commands to generate the atlas.\n * The second call cleans up unused resources. Every call afterwards is a no-op.\n * </p>\n *\n * @param {FrameState} frameState The frame state.\n *\n * @private\n */\nOctahedralProjectedCubeMap.prototype.update = function (frameState) {\n  var context = frameState.context;\n\n  if (!OctahedralProjectedCubeMap.isSupported(context)) {\n    return;\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z)(this._texture) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z)(this._va)) {\n    cleanupResources(this);\n  }\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z)(this._texture)) {\n    return;\n  }\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z)(this._texture) && !this._loading) {\n    var cachedTexture = context.textureCache.getTexture(this._url);\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z)(cachedTexture)) {\n      cleanupResources(this);\n      this._texture = cachedTexture;\n      this._maximumMipmapLevel = this._texture.maximumMipmapLevel;\n      this._ready = true;\n      this._readyPromise.resolve();\n      return;\n    }\n  }\n\n  var cubeMapBuffers = this._cubeMapBuffers;\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z)(cubeMapBuffers) && !this._loading) {\n    var that = this;\n    (0,_Core_loadKTX2_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(this._url)\n      .then(function (buffers) {\n        that._cubeMapBuffers = buffers;\n        that._loading = false;\n      })\n      .otherwise(this._readyPromise.reject);\n    this._loading = true;\n  }\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z)(this._cubeMapBuffers)) {\n    return;\n  }\n\n  var defines = [];\n  // Datatype is defined if it is a normalized type (i.e. ..._UNORM, ..._SFLOAT)\n  var pixelDatatype = cubeMapBuffers[0].positiveX.pixelDatatype;\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z)(pixelDatatype)) {\n    pixelDatatype = context.halfFloatingPointTexture\n      ? _Renderer_PixelDatatype_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"].HALF_FLOAT */ .Z.HALF_FLOAT\n      : _Renderer_PixelDatatype_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"].FLOAT */ .Z.FLOAT;\n  } else {\n    defines.push("RGBA_NORMALIZED");\n  }\n  var pixelFormat = _Core_PixelFormat_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].RGBA */ .Z.RGBA;\n\n  var fs = new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z({\n    defines: defines,\n    sources: [_Shaders_OctahedralProjectionFS_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"] */ .Z],\n  });\n\n  this._va = createVertexArray(context);\n  this._sp = _Renderer_ShaderProgram_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"].fromCache */ .Z.fromCache({\n    context: context,\n    vertexShaderSource: _Shaders_OctahedralProjectionVS_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z,\n    fragmentShaderSource: fs,\n    attributeLocations: {\n      position: 0,\n      cubeMapCoordinates: 1,\n    },\n  });\n\n  // We only need up to 6 mip levels to avoid artifacts.\n  var length = Math.min(cubeMapBuffers.length, 6);\n  this._maximumMipmapLevel = length - 1;\n  var cubeMaps = (this._cubeMaps = new Array(length));\n  var mipTextures = (this._mipTextures = new Array(length));\n  var originalSize = cubeMapBuffers[0].positiveX.width * 2.0;\n  var uniformMap = {\n    originalSize: function () {\n      return originalSize;\n    },\n  };\n\n  // First we project each cubemap onto a flat octahedron, and write that to a texture.\n  for (var i = 0; i < length; ++i) {\n    // Swap +Y/-Y faces since the octahedral projection expects this order.\n    var positiveY = cubeMapBuffers[i].positiveY;\n    cubeMapBuffers[i].positiveY = cubeMapBuffers[i].negativeY;\n    cubeMapBuffers[i].negativeY = positiveY;\n\n    var cubeMap = (cubeMaps[i] = new _Renderer_CubeMap_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z({\n      context: context,\n      source: cubeMapBuffers[i],\n      pixelDatatype: pixelDatatype,\n    }));\n    var size = cubeMaps[i].width * 2;\n\n    var mipTexture = (mipTextures[i] = new _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z({\n      context: context,\n      width: size,\n      height: size,\n      pixelDatatype: pixelDatatype,\n      pixelFormat: pixelFormat,\n    }));\n\n    var command = new _Renderer_ComputeCommand_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z({\n      vertexArray: this._va,\n      shaderProgram: this._sp,\n      uniformMap: {\n        cubeMap: createUniformTexture(cubeMap),\n      },\n      outputTexture: mipTexture,\n      persists: true,\n      owner: this,\n    });\n    frameState.commandList.push(command);\n\n    uniformMap["texture" + i] = createUniformTexture(mipTexture);\n  }\n\n  this._texture = new _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z({\n    context: context,\n    width: originalSize * 1.5 + 2.0, // We add a 1 pixel border to avoid linear sampling artifacts.\n    height: originalSize,\n    pixelDatatype: pixelDatatype,\n    pixelFormat: pixelFormat,\n  });\n\n  this._texture.maximumMipmapLevel = this._maximumMipmapLevel;\n  context.textureCache.addTexture(this._url, this._texture);\n\n  var atlasCommand = new _Renderer_ComputeCommand_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z({\n    fragmentShaderSource: _Shaders_OctahedralProjectionAtlasFS_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z,\n    uniformMap: uniformMap,\n    outputTexture: this._texture,\n    persists: false,\n    owner: this,\n  });\n  frameState.commandList.push(atlasCommand);\n\n  this._ready = true;\n  this._readyPromise.resolve();\n};\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <p>\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n * </p>\n *\n * @returns {Boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n *\n * @see OctahedralProjectedCubeMap#destroy\n */\nOctahedralProjectedCubeMap.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the WebGL resources held by this object.  Destroying an object allows for deterministic\n * release of WebGL resources, instead of relying on the garbage collector to destroy this object.\n * <p>\n * Once an object is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n * </p>\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n * @see OctahedralProjectedCubeMap#isDestroyed\n */\nOctahedralProjectedCubeMap.prototype.destroy = function () {\n  cleanupResources(this);\n  this._texture = this._texture && this._texture.destroy();\n  return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(this);\n};\n/* harmony default export */ __webpack_exports__["Z"] = (OctahedralProjectedCubeMap);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsOENBQThDO0FBQzlDO0FBQ0Esd0RBQXdEO0FBQ3hELDhDQUE4QyxzQkFBc0I7QUFDcEU7QUFDQTtBQUNBLGFBQWEsU0FBUyxnREFBZ0Q7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVEO0FBQ3ZELDhDQUE4QyxzQkFBc0I7QUFDcEU7QUFDQTtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUywyRUFBYTtBQUN0QjtBQUNBLHlEQUFlLDBCQUEwQixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnVlMy13ZWJwYWNrNS8uL25vZGVfbW9kdWxlcy9jZXNpdW0vU291cmNlL1NjZW5lL09jdGFoZWRyYWxQcm9qZWN0ZWRDdWJlTWFwLmpzP2MzZWMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENhcnRlc2lhbjMgZnJvbSBcIi4uL0NvcmUvQ2FydGVzaWFuMy5qc1wiO1xuaW1wb3J0IENvbXBvbmVudERhdGF0eXBlIGZyb20gXCIuLi9Db3JlL0NvbXBvbmVudERhdGF0eXBlLmpzXCI7XG5pbXBvcnQgZGVmaW5lZCBmcm9tIFwiLi4vQ29yZS9kZWZpbmVkLmpzXCI7XG5pbXBvcnQgZGVzdHJveU9iamVjdCBmcm9tIFwiLi4vQ29yZS9kZXN0cm95T2JqZWN0LmpzXCI7XG5pbXBvcnQgSW5kZXhEYXRhdHlwZSBmcm9tIFwiLi4vQ29yZS9JbmRleERhdGF0eXBlLmpzXCI7XG5pbXBvcnQgbG9hZEtUWDIgZnJvbSBcIi4uL0NvcmUvbG9hZEtUWDIuanNcIjtcbmltcG9ydCBQaXhlbEZvcm1hdCBmcm9tIFwiLi4vQ29yZS9QaXhlbEZvcm1hdC5qc1wiO1xuaW1wb3J0IEJ1ZmZlciBmcm9tIFwiLi4vUmVuZGVyZXIvQnVmZmVyLmpzXCI7XG5pbXBvcnQgQnVmZmVyVXNhZ2UgZnJvbSBcIi4uL1JlbmRlcmVyL0J1ZmZlclVzYWdlLmpzXCI7XG5pbXBvcnQgQ29tcHV0ZUNvbW1hbmQgZnJvbSBcIi4uL1JlbmRlcmVyL0NvbXB1dGVDb21tYW5kLmpzXCI7XG5pbXBvcnQgQ3ViZU1hcCBmcm9tIFwiLi4vUmVuZGVyZXIvQ3ViZU1hcC5qc1wiO1xuaW1wb3J0IFBpeGVsRGF0YXR5cGUgZnJvbSBcIi4uL1JlbmRlcmVyL1BpeGVsRGF0YXR5cGUuanNcIjtcbmltcG9ydCBTaGFkZXJQcm9ncmFtIGZyb20gXCIuLi9SZW5kZXJlci9TaGFkZXJQcm9ncmFtLmpzXCI7XG5pbXBvcnQgU2hhZGVyU291cmNlIGZyb20gXCIuLi9SZW5kZXJlci9TaGFkZXJTb3VyY2UuanNcIjtcbmltcG9ydCBUZXh0dXJlIGZyb20gXCIuLi9SZW5kZXJlci9UZXh0dXJlLmpzXCI7XG5pbXBvcnQgVmVydGV4QXJyYXkgZnJvbSBcIi4uL1JlbmRlcmVyL1ZlcnRleEFycmF5LmpzXCI7XG5pbXBvcnQgT2N0YWhlZHJhbFByb2plY3Rpb25BdGxhc0ZTIGZyb20gXCIuLi9TaGFkZXJzL09jdGFoZWRyYWxQcm9qZWN0aW9uQXRsYXNGUy5qc1wiO1xuaW1wb3J0IE9jdGFoZWRyYWxQcm9qZWN0aW9uRlMgZnJvbSBcIi4uL1NoYWRlcnMvT2N0YWhlZHJhbFByb2plY3Rpb25GUy5qc1wiO1xuaW1wb3J0IE9jdGFoZWRyYWxQcm9qZWN0aW9uVlMgZnJvbSBcIi4uL1NoYWRlcnMvT2N0YWhlZHJhbFByb2plY3Rpb25WUy5qc1wiO1xuaW1wb3J0IHdoZW4gZnJvbSBcIi4uL1RoaXJkUGFydHkvd2hlbi5qc1wiO1xuXG4vKipcbiAqIFBhY2tzIGFsbCBtaXAgbGV2ZWxzIG9mIGEgY3ViZSBtYXAgaW50byBhIDJEIHRleHR1cmUgYXRsYXMuXG4gKlxuICogT2N0YWhlZHJhbCBwcm9qZWN0aW9uIGlzIGEgd2F5IG9mIHB1dHRpbmcgdGhlIGN1YmUgbWFwcyBvbnRvIGEgMkQgdGV4dHVyZVxuICogd2l0aCBtaW5pbWFsIGRpc3RvcnRpb24gYW5kIGVhc3kgbG9vayB1cC5cbiAqIFNlZSBDaGFwdGVyIDE2IG9mIFdlYkdMIEluc2lnaHRzIFwiSERSIEltYWdlLUJhc2VkIExpZ2h0aW5nIG9uIHRoZSBXZWJcIiBieSBKZWZmIFJ1c3NlbGxcbiAqIGFuZCBcIk9jdGFoZWRyb24gRW52aXJvbm1lbnQgTWFwc1wiIGZvciByZWZlcmVuY2UuXG4gKlxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gT2N0YWhlZHJhbFByb2plY3RlZEN1YmVNYXAodXJsKSB7XG4gIHRoaXMuX3VybCA9IHVybDtcblxuICB0aGlzLl9jdWJlTWFwQnVmZmVycyA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fY3ViZU1hcHMgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX3RleHR1cmUgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX21pcFRleHR1cmVzID0gdW5kZWZpbmVkO1xuICB0aGlzLl92YSA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fc3AgPSB1bmRlZmluZWQ7XG5cbiAgdGhpcy5fbWF4aW11bU1pcG1hcExldmVsID0gdW5kZWZpbmVkO1xuXG4gIHRoaXMuX2xvYWRpbmcgPSBmYWxzZTtcbiAgdGhpcy5fcmVhZHkgPSBmYWxzZTtcbiAgdGhpcy5fcmVhZHlQcm9taXNlID0gd2hlbi5kZWZlcigpO1xufVxuXG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhPY3RhaGVkcmFsUHJvamVjdGVkQ3ViZU1hcC5wcm90b3R5cGUsIHtcbiAgLyoqXG4gICAqIFRoZSB1cmwgdG8gdGhlIEtUWDIgZmlsZSBjb250YWluaW5nIHRoZSBzcGVjdWxhciBlbnZpcm9ubWVudCBtYXAgYW5kIGNvbnZvbHV0ZWQgbWlwbWFwcy5cbiAgICogQG1lbWJlcm9mIE9jdGFoZWRyYWxQcm9qZWN0ZWRDdWJlTWFwLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7U3RyaW5nfVxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIHVybDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3VybDtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogQSB0ZXh0dXJlIGNvbnRhaW5pbmcgYWxsIHRoZSBwYWNrZWQgY29udm9sdXRpb25zLlxuICAgKiBAbWVtYmVyb2YgT2N0YWhlZHJhbFByb2plY3RlZEN1YmVNYXAucHJvdG90eXBlXG4gICAqIEB0eXBlIHtUZXh0dXJlfVxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIHRleHR1cmU6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl90ZXh0dXJlO1xuICAgIH0sXG4gIH0sXG4gIC8qKlxuICAgKiBUaGUgbWF4aW11bSBudW1iZXIgb2YgbWlwIGxldmVscy5cbiAgICogQG1lbWJlck9mIE9jdGFoZWRyYWxQcm9qZWN0ZWRDdWJlTWFwLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIG1heGltdW1NaXBtYXBMZXZlbDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX21heGltdW1NaXBtYXBMZXZlbDtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiB0aGUgdGV4dHVyZSBhdGxhcyBpcyBjb21wbGV0ZSBhbmQgcmVhZHkgdG8gdXNlLlxuICAgKiBAbWVtYmVyb2YgT2N0YWhlZHJhbFByb2plY3RlZEN1YmVNYXAucHJvdG90eXBlXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIHJlYWR5OiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcmVhZHk7XG4gICAgfSxcbiAgfSxcbiAgLyoqXG4gICAqIEdldHMgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2hlbiB0aGUgdGV4dHVyZSBhdGxhcyBpcyByZWFkeSB0byB1c2UuXG4gICAqIEBtZW1iZXJvZiBPY3RhaGVkcmFsUHJvamVjdGVkQ3ViZU1hcC5wcm90b3R5cGVcbiAgICogQHR5cGUge1Byb21pc2U8dm9pZD59XG4gICAqIEByZWFkb25seVxuICAgKi9cbiAgcmVhZHlQcm9taXNlOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcmVhZHlQcm9taXNlLnByb21pc2U7XG4gICAgfSxcbiAgfSxcbn0pO1xuXG5PY3RhaGVkcmFsUHJvamVjdGVkQ3ViZU1hcC5pc1N1cHBvcnRlZCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gIHJldHVybiAoXG4gICAgKGNvbnRleHQuY29sb3JCdWZmZXJIYWxmRmxvYXQgJiYgY29udGV4dC5oYWxmRmxvYXRpbmdQb2ludFRleHR1cmUpIHx8XG4gICAgKGNvbnRleHQuZmxvYXRpbmdQb2ludFRleHR1cmUgJiYgY29udGV4dC5jb2xvckJ1ZmZlckZsb2F0KVxuICApO1xufTtcblxuLy8gVGhlc2UgdmVydGljZXMgYXJlIGJhc2VkIG9uIGZpZ3VyZSAxIGZyb20gXCJPY3RhaGVkcm9uIEVudmlyb25tZW50IE1hcHNcIi5cbnZhciB2MSA9IG5ldyBDYXJ0ZXNpYW4zKDEuMCwgMC4wLCAwLjApO1xudmFyIHYyID0gbmV3IENhcnRlc2lhbjMoMC4wLCAwLjAsIDEuMCk7XG52YXIgdjMgPSBuZXcgQ2FydGVzaWFuMygtMS4wLCAwLjAsIDAuMCk7XG52YXIgdjQgPSBuZXcgQ2FydGVzaWFuMygwLjAsIDAuMCwgLTEuMCk7XG52YXIgdjUgPSBuZXcgQ2FydGVzaWFuMygwLjAsIDEuMCwgMC4wKTtcbnZhciB2NiA9IG5ldyBDYXJ0ZXNpYW4zKDAuMCwgLTEuMCwgMC4wKTtcblxuLy8gdG9wIGxlZnQsIGxlZnQsIHRvcCwgY2VudGVyLCByaWdodCwgdG9wIHJpZ2h0LCBib3R0b20sIGJvdHRvbSBsZWZ0LCBib3R0b20gcmlnaHRcbnZhciBjdWJlTWFwQ29vcmRpbmF0ZXMgPSBbdjUsIHYzLCB2MiwgdjYsIHYxLCB2NSwgdjQsIHY1LCB2NV07XG52YXIgbGVuZ3RoID0gY3ViZU1hcENvb3JkaW5hdGVzLmxlbmd0aDtcbnZhciBmbGF0Q3ViZU1hcENvb3JkaW5hdGVzID0gbmV3IEZsb2F0MzJBcnJheShsZW5ndGggKiAzKTtcblxudmFyIG9mZnNldCA9IDA7XG5mb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpLCBvZmZzZXQgKz0gMykge1xuICBDYXJ0ZXNpYW4zLnBhY2soY3ViZU1hcENvb3JkaW5hdGVzW2ldLCBmbGF0Q3ViZU1hcENvb3JkaW5hdGVzLCBvZmZzZXQpO1xufVxuXG52YXIgZmxhdFBvc2l0aW9ucyA9IG5ldyBGbG9hdDMyQXJyYXkoW1xuICAtMS4wLFxuICAxLjAsIC8vIHRvcCBsZWZ0XG4gIC0xLjAsXG4gIDAuMCwgLy8gbGVmdFxuICAwLjAsXG4gIDEuMCwgLy8gdG9wXG4gIDAuMCxcbiAgMC4wLCAvLyBjZW50ZXJcbiAgMS4wLFxuICAwLjAsIC8vIHJpZ2h0XG4gIDEuMCxcbiAgMS4wLCAvLyB0b3AgcmlnaHRcbiAgMC4wLFxuICAtMS4wLCAvLyBib3R0b21cbiAgLTEuMCxcbiAgLTEuMCwgLy8gYm90dG9tIGxlZnRcbiAgMS4wLFxuICAtMS4wLCAvLyBib3R0b20gcmlnaHRcbl0pO1xudmFyIGluZGljZXMgPSBuZXcgVWludDE2QXJyYXkoW1xuICAwLFxuICAxLFxuICAyLCAvLyB0b3AgbGVmdCwgbGVmdCwgdG9wLFxuICAyLFxuICAzLFxuICAxLCAvLyB0b3AsIGNlbnRlciwgbGVmdCxcbiAgNyxcbiAgNixcbiAgMSwgLy8gYm90dG9tIGxlZnQsIGJvdHRvbSwgbGVmdCxcbiAgMyxcbiAgNixcbiAgMSwgLy8gY2VudGVyLCBib3R0b20sIGxlZnQsXG4gIDIsXG4gIDUsXG4gIDQsIC8vIHRvcCwgdG9wIHJpZ2h0LCByaWdodCxcbiAgMyxcbiAgNCxcbiAgMiwgLy8gY2VudGVyLCByaWdodCwgdG9wLFxuICA0LFxuICA4LFxuICA2LCAvLyByaWdodCwgYm90dG9tIHJpZ2h0LCBib3R0b20sXG4gIDMsXG4gIDQsXG4gIDYsIC8vY2VudGVyLCByaWdodCwgYm90dG9tXG5dKTtcblxuZnVuY3Rpb24gY3JlYXRlVmVydGV4QXJyYXkoY29udGV4dCkge1xuICB2YXIgcG9zaXRpb25CdWZmZXIgPSBCdWZmZXIuY3JlYXRlVmVydGV4QnVmZmVyKHtcbiAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgIHR5cGVkQXJyYXk6IGZsYXRQb3NpdGlvbnMsXG4gICAgdXNhZ2U6IEJ1ZmZlclVzYWdlLlNUQVRJQ19EUkFXLFxuICB9KTtcbiAgdmFyIGN1YmVNYXBDb29yZGluYXRlc0J1ZmZlciA9IEJ1ZmZlci5jcmVhdGVWZXJ0ZXhCdWZmZXIoe1xuICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgdHlwZWRBcnJheTogZmxhdEN1YmVNYXBDb29yZGluYXRlcyxcbiAgICB1c2FnZTogQnVmZmVyVXNhZ2UuU1RBVElDX0RSQVcsXG4gIH0pO1xuICB2YXIgaW5kZXhCdWZmZXIgPSBCdWZmZXIuY3JlYXRlSW5kZXhCdWZmZXIoe1xuICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgdHlwZWRBcnJheTogaW5kaWNlcyxcbiAgICB1c2FnZTogQnVmZmVyVXNhZ2UuU1RBVElDX0RSQVcsXG4gICAgaW5kZXhEYXRhdHlwZTogSW5kZXhEYXRhdHlwZS5VTlNJR05FRF9TSE9SVCxcbiAgfSk7XG5cbiAgdmFyIGF0dHJpYnV0ZXMgPSBbXG4gICAge1xuICAgICAgaW5kZXg6IDAsXG4gICAgICB2ZXJ0ZXhCdWZmZXI6IHBvc2l0aW9uQnVmZmVyLFxuICAgICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogMixcbiAgICAgIGNvbXBvbmVudERhdGF0eXBlOiBDb21wb25lbnREYXRhdHlwZS5GTE9BVCxcbiAgICB9LFxuICAgIHtcbiAgICAgIGluZGV4OiAxLFxuICAgICAgdmVydGV4QnVmZmVyOiBjdWJlTWFwQ29vcmRpbmF0ZXNCdWZmZXIsXG4gICAgICBjb21wb25lbnRzUGVyQXR0cmlidXRlOiAzLFxuICAgICAgY29tcG9uZW50RGF0YXR5cGU6IENvbXBvbmVudERhdGF0eXBlLkZMT0FULFxuICAgIH0sXG4gIF07XG4gIHJldHVybiBuZXcgVmVydGV4QXJyYXkoe1xuICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgYXR0cmlidXRlczogYXR0cmlidXRlcyxcbiAgICBpbmRleEJ1ZmZlcjogaW5kZXhCdWZmZXIsXG4gIH0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVVbmlmb3JtVGV4dHVyZSh0ZXh0dXJlKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRleHR1cmU7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGNsZWFudXBSZXNvdXJjZXMobWFwKSB7XG4gIG1hcC5fdmEgPSBtYXAuX3ZhICYmIG1hcC5fdmEuZGVzdHJveSgpO1xuICBtYXAuX3NwID0gbWFwLl9zcCAmJiBtYXAuX3NwLmRlc3Ryb3koKTtcblxuICB2YXIgaTtcbiAgdmFyIGxlbmd0aDtcblxuICB2YXIgY3ViZU1hcHMgPSBtYXAuX2N1YmVNYXBzO1xuICBpZiAoZGVmaW5lZChjdWJlTWFwcykpIHtcbiAgICBsZW5ndGggPSBjdWJlTWFwcy5sZW5ndGg7XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgICBjdWJlTWFwc1tpXS5kZXN0cm95KCk7XG4gICAgfVxuICB9XG4gIHZhciBtaXBUZXh0dXJlcyA9IG1hcC5fbWlwVGV4dHVyZXM7XG4gIGlmIChkZWZpbmVkKG1pcFRleHR1cmVzKSkge1xuICAgIGxlbmd0aCA9IG1pcFRleHR1cmVzLmxlbmd0aDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICAgIG1pcFRleHR1cmVzW2ldLmRlc3Ryb3koKTtcbiAgICB9XG4gIH1cblxuICBtYXAuX3ZhID0gdW5kZWZpbmVkO1xuICBtYXAuX3NwID0gdW5kZWZpbmVkO1xuICBtYXAuX2N1YmVNYXBzID0gdW5kZWZpbmVkO1xuICBtYXAuX2N1YmVNYXBCdWZmZXJzID0gdW5kZWZpbmVkO1xuICBtYXAuX21pcFRleHR1cmVzID0gdW5kZWZpbmVkO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgY29tcHV0ZSBjb21tYW5kcyB0byBnZW5lcmF0ZSBvY3RhaGVkcmFsIHByb2plY3Rpb25zIG9mIGVhY2ggY3ViZSBtYXBcbiAqIGFuZCB0aGVuIHJlbmRlcnMgdGhlbSB0byBhbiBhdGxhcy5cbiAqIDxwPlxuICogT25seSBuZWVkcyB0byBiZSBjYWxsZWQgdHdpY2UuIFRoZSBmaXJzdCBjYWxsIHF1ZXVlcyB0aGUgY29tcHV0ZSBjb21tYW5kcyB0byBnZW5lcmF0ZSB0aGUgYXRsYXMuXG4gKiBUaGUgc2Vjb25kIGNhbGwgY2xlYW5zIHVwIHVudXNlZCByZXNvdXJjZXMuIEV2ZXJ5IGNhbGwgYWZ0ZXJ3YXJkcyBpcyBhIG5vLW9wLlxuICogPC9wPlxuICpcbiAqIEBwYXJhbSB7RnJhbWVTdGF0ZX0gZnJhbWVTdGF0ZSBUaGUgZnJhbWUgc3RhdGUuXG4gKlxuICogQHByaXZhdGVcbiAqL1xuT2N0YWhlZHJhbFByb2plY3RlZEN1YmVNYXAucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChmcmFtZVN0YXRlKSB7XG4gIHZhciBjb250ZXh0ID0gZnJhbWVTdGF0ZS5jb250ZXh0O1xuXG4gIGlmICghT2N0YWhlZHJhbFByb2plY3RlZEN1YmVNYXAuaXNTdXBwb3J0ZWQoY29udGV4dCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoZGVmaW5lZCh0aGlzLl90ZXh0dXJlKSAmJiBkZWZpbmVkKHRoaXMuX3ZhKSkge1xuICAgIGNsZWFudXBSZXNvdXJjZXModGhpcyk7XG4gIH1cbiAgaWYgKGRlZmluZWQodGhpcy5fdGV4dHVyZSkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoIWRlZmluZWQodGhpcy5fdGV4dHVyZSkgJiYgIXRoaXMuX2xvYWRpbmcpIHtcbiAgICB2YXIgY2FjaGVkVGV4dHVyZSA9IGNvbnRleHQudGV4dHVyZUNhY2hlLmdldFRleHR1cmUodGhpcy5fdXJsKTtcbiAgICBpZiAoZGVmaW5lZChjYWNoZWRUZXh0dXJlKSkge1xuICAgICAgY2xlYW51cFJlc291cmNlcyh0aGlzKTtcbiAgICAgIHRoaXMuX3RleHR1cmUgPSBjYWNoZWRUZXh0dXJlO1xuICAgICAgdGhpcy5fbWF4aW11bU1pcG1hcExldmVsID0gdGhpcy5fdGV4dHVyZS5tYXhpbXVtTWlwbWFwTGV2ZWw7XG4gICAgICB0aGlzLl9yZWFkeSA9IHRydWU7XG4gICAgICB0aGlzLl9yZWFkeVByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuXG4gIHZhciBjdWJlTWFwQnVmZmVycyA9IHRoaXMuX2N1YmVNYXBCdWZmZXJzO1xuICBpZiAoIWRlZmluZWQoY3ViZU1hcEJ1ZmZlcnMpICYmICF0aGlzLl9sb2FkaW5nKSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIGxvYWRLVFgyKHRoaXMuX3VybClcbiAgICAgIC50aGVuKGZ1bmN0aW9uIChidWZmZXJzKSB7XG4gICAgICAgIHRoYXQuX2N1YmVNYXBCdWZmZXJzID0gYnVmZmVycztcbiAgICAgICAgdGhhdC5fbG9hZGluZyA9IGZhbHNlO1xuICAgICAgfSlcbiAgICAgIC5vdGhlcndpc2UodGhpcy5fcmVhZHlQcm9taXNlLnJlamVjdCk7XG4gICAgdGhpcy5fbG9hZGluZyA9IHRydWU7XG4gIH1cbiAgaWYgKCFkZWZpbmVkKHRoaXMuX2N1YmVNYXBCdWZmZXJzKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBkZWZpbmVzID0gW107XG4gIC8vIERhdGF0eXBlIGlzIGRlZmluZWQgaWYgaXQgaXMgYSBub3JtYWxpemVkIHR5cGUgKGkuZS4gLi4uX1VOT1JNLCAuLi5fU0ZMT0FUKVxuICB2YXIgcGl4ZWxEYXRhdHlwZSA9IGN1YmVNYXBCdWZmZXJzWzBdLnBvc2l0aXZlWC5waXhlbERhdGF0eXBlO1xuICBpZiAoIWRlZmluZWQocGl4ZWxEYXRhdHlwZSkpIHtcbiAgICBwaXhlbERhdGF0eXBlID0gY29udGV4dC5oYWxmRmxvYXRpbmdQb2ludFRleHR1cmVcbiAgICAgID8gUGl4ZWxEYXRhdHlwZS5IQUxGX0ZMT0FUXG4gICAgICA6IFBpeGVsRGF0YXR5cGUuRkxPQVQ7XG4gIH0gZWxzZSB7XG4gICAgZGVmaW5lcy5wdXNoKFwiUkdCQV9OT1JNQUxJWkVEXCIpO1xuICB9XG4gIHZhciBwaXhlbEZvcm1hdCA9IFBpeGVsRm9ybWF0LlJHQkE7XG5cbiAgdmFyIGZzID0gbmV3IFNoYWRlclNvdXJjZSh7XG4gICAgZGVmaW5lczogZGVmaW5lcyxcbiAgICBzb3VyY2VzOiBbT2N0YWhlZHJhbFByb2plY3Rpb25GU10sXG4gIH0pO1xuXG4gIHRoaXMuX3ZhID0gY3JlYXRlVmVydGV4QXJyYXkoY29udGV4dCk7XG4gIHRoaXMuX3NwID0gU2hhZGVyUHJvZ3JhbS5mcm9tQ2FjaGUoe1xuICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgdmVydGV4U2hhZGVyU291cmNlOiBPY3RhaGVkcmFsUHJvamVjdGlvblZTLFxuICAgIGZyYWdtZW50U2hhZGVyU291cmNlOiBmcyxcbiAgICBhdHRyaWJ1dGVMb2NhdGlvbnM6IHtcbiAgICAgIHBvc2l0aW9uOiAwLFxuICAgICAgY3ViZU1hcENvb3JkaW5hdGVzOiAxLFxuICAgIH0sXG4gIH0pO1xuXG4gIC8vIFdlIG9ubHkgbmVlZCB1cCB0byA2IG1pcCBsZXZlbHMgdG8gYXZvaWQgYXJ0aWZhY3RzLlxuICB2YXIgbGVuZ3RoID0gTWF0aC5taW4oY3ViZU1hcEJ1ZmZlcnMubGVuZ3RoLCA2KTtcbiAgdGhpcy5fbWF4aW11bU1pcG1hcExldmVsID0gbGVuZ3RoIC0gMTtcbiAgdmFyIGN1YmVNYXBzID0gKHRoaXMuX2N1YmVNYXBzID0gbmV3IEFycmF5KGxlbmd0aCkpO1xuICB2YXIgbWlwVGV4dHVyZXMgPSAodGhpcy5fbWlwVGV4dHVyZXMgPSBuZXcgQXJyYXkobGVuZ3RoKSk7XG4gIHZhciBvcmlnaW5hbFNpemUgPSBjdWJlTWFwQnVmZmVyc1swXS5wb3NpdGl2ZVgud2lkdGggKiAyLjA7XG4gIHZhciB1bmlmb3JtTWFwID0ge1xuICAgIG9yaWdpbmFsU2l6ZTogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIG9yaWdpbmFsU2l6ZTtcbiAgICB9LFxuICB9O1xuXG4gIC8vIEZpcnN0IHdlIHByb2plY3QgZWFjaCBjdWJlbWFwIG9udG8gYSBmbGF0IG9jdGFoZWRyb24sIGFuZCB3cml0ZSB0aGF0IHRvIGEgdGV4dHVyZS5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIC8vIFN3YXAgK1kvLVkgZmFjZXMgc2luY2UgdGhlIG9jdGFoZWRyYWwgcHJvamVjdGlvbiBleHBlY3RzIHRoaXMgb3JkZXIuXG4gICAgdmFyIHBvc2l0aXZlWSA9IGN1YmVNYXBCdWZmZXJzW2ldLnBvc2l0aXZlWTtcbiAgICBjdWJlTWFwQnVmZmVyc1tpXS5wb3NpdGl2ZVkgPSBjdWJlTWFwQnVmZmVyc1tpXS5uZWdhdGl2ZVk7XG4gICAgY3ViZU1hcEJ1ZmZlcnNbaV0ubmVnYXRpdmVZID0gcG9zaXRpdmVZO1xuXG4gICAgdmFyIGN1YmVNYXAgPSAoY3ViZU1hcHNbaV0gPSBuZXcgQ3ViZU1hcCh7XG4gICAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgICAgc291cmNlOiBjdWJlTWFwQnVmZmVyc1tpXSxcbiAgICAgIHBpeGVsRGF0YXR5cGU6IHBpeGVsRGF0YXR5cGUsXG4gICAgfSkpO1xuICAgIHZhciBzaXplID0gY3ViZU1hcHNbaV0ud2lkdGggKiAyO1xuXG4gICAgdmFyIG1pcFRleHR1cmUgPSAobWlwVGV4dHVyZXNbaV0gPSBuZXcgVGV4dHVyZSh7XG4gICAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgICAgd2lkdGg6IHNpemUsXG4gICAgICBoZWlnaHQ6IHNpemUsXG4gICAgICBwaXhlbERhdGF0eXBlOiBwaXhlbERhdGF0eXBlLFxuICAgICAgcGl4ZWxGb3JtYXQ6IHBpeGVsRm9ybWF0LFxuICAgIH0pKTtcblxuICAgIHZhciBjb21tYW5kID0gbmV3IENvbXB1dGVDb21tYW5kKHtcbiAgICAgIHZlcnRleEFycmF5OiB0aGlzLl92YSxcbiAgICAgIHNoYWRlclByb2dyYW06IHRoaXMuX3NwLFxuICAgICAgdW5pZm9ybU1hcDoge1xuICAgICAgICBjdWJlTWFwOiBjcmVhdGVVbmlmb3JtVGV4dHVyZShjdWJlTWFwKSxcbiAgICAgIH0sXG4gICAgICBvdXRwdXRUZXh0dXJlOiBtaXBUZXh0dXJlLFxuICAgICAgcGVyc2lzdHM6IHRydWUsXG4gICAgICBvd25lcjogdGhpcyxcbiAgICB9KTtcbiAgICBmcmFtZVN0YXRlLmNvbW1hbmRMaXN0LnB1c2goY29tbWFuZCk7XG5cbiAgICB1bmlmb3JtTWFwW1widGV4dHVyZVwiICsgaV0gPSBjcmVhdGVVbmlmb3JtVGV4dHVyZShtaXBUZXh0dXJlKTtcbiAgfVxuXG4gIHRoaXMuX3RleHR1cmUgPSBuZXcgVGV4dHVyZSh7XG4gICAgY29udGV4dDogY29udGV4dCxcbiAgICB3aWR0aDogb3JpZ2luYWxTaXplICogMS41ICsgMi4wLCAvLyBXZSBhZGQgYSAxIHBpeGVsIGJvcmRlciB0byBhdm9pZCBsaW5lYXIgc2FtcGxpbmcgYXJ0aWZhY3RzLlxuICAgIGhlaWdodDogb3JpZ2luYWxTaXplLFxuICAgIHBpeGVsRGF0YXR5cGU6IHBpeGVsRGF0YXR5cGUsXG4gICAgcGl4ZWxGb3JtYXQ6IHBpeGVsRm9ybWF0LFxuICB9KTtcblxuICB0aGlzLl90ZXh0dXJlLm1heGltdW1NaXBtYXBMZXZlbCA9IHRoaXMuX21heGltdW1NaXBtYXBMZXZlbDtcbiAgY29udGV4dC50ZXh0dXJlQ2FjaGUuYWRkVGV4dHVyZSh0aGlzLl91cmwsIHRoaXMuX3RleHR1cmUpO1xuXG4gIHZhciBhdGxhc0NvbW1hbmQgPSBuZXcgQ29tcHV0ZUNvbW1hbmQoe1xuICAgIGZyYWdtZW50U2hhZGVyU291cmNlOiBPY3RhaGVkcmFsUHJvamVjdGlvbkF0bGFzRlMsXG4gICAgdW5pZm9ybU1hcDogdW5pZm9ybU1hcCxcbiAgICBvdXRwdXRUZXh0dXJlOiB0aGlzLl90ZXh0dXJlLFxuICAgIHBlcnNpc3RzOiBmYWxzZSxcbiAgICBvd25lcjogdGhpcyxcbiAgfSk7XG4gIGZyYW1lU3RhdGUuY29tbWFuZExpc3QucHVzaChhdGxhc0NvbW1hbmQpO1xuXG4gIHRoaXMuX3JlYWR5ID0gdHJ1ZTtcbiAgdGhpcy5fcmVhZHlQcm9taXNlLnJlc29sdmUoKTtcbn07XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQ7IG90aGVyd2lzZSwgZmFsc2UuXG4gKiA8cD5cbiAqIElmIHRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQsIGl0IHNob3VsZCBub3QgYmUgdXNlZDsgY2FsbGluZyBhbnkgZnVuY3Rpb24gb3RoZXIgdGhhblxuICogPGNvZGU+aXNEZXN0cm95ZWQ8L2NvZGU+IHdpbGwgcmVzdWx0IGluIGEge0BsaW5rIERldmVsb3BlckVycm9yfSBleGNlcHRpb24uXG4gKiA8L3A+XG4gKlxuICogQHJldHVybnMge0Jvb2xlYW59IDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQ7IG90aGVyd2lzZSwgPGNvZGU+ZmFsc2U8L2NvZGU+LlxuICpcbiAqIEBzZWUgT2N0YWhlZHJhbFByb2plY3RlZEN1YmVNYXAjZGVzdHJveVxuICovXG5PY3RhaGVkcmFsUHJvamVjdGVkQ3ViZU1hcC5wcm90b3R5cGUuaXNEZXN0cm95ZWQgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBmYWxzZTtcbn07XG5cbi8qKlxuICogRGVzdHJveXMgdGhlIFdlYkdMIHJlc291cmNlcyBoZWxkIGJ5IHRoaXMgb2JqZWN0LiAgRGVzdHJveWluZyBhbiBvYmplY3QgYWxsb3dzIGZvciBkZXRlcm1pbmlzdGljXG4gKiByZWxlYXNlIG9mIFdlYkdMIHJlc291cmNlcywgaW5zdGVhZCBvZiByZWx5aW5nIG9uIHRoZSBnYXJiYWdlIGNvbGxlY3RvciB0byBkZXN0cm95IHRoaXMgb2JqZWN0LlxuICogPHA+XG4gKiBPbmNlIGFuIG9iamVjdCBpcyBkZXN0cm95ZWQsIGl0IHNob3VsZCBub3QgYmUgdXNlZDsgY2FsbGluZyBhbnkgZnVuY3Rpb24gb3RoZXIgdGhhblxuICogPGNvZGU+aXNEZXN0cm95ZWQ8L2NvZGU+IHdpbGwgcmVzdWx0IGluIGEge0BsaW5rIERldmVsb3BlckVycm9yfSBleGNlcHRpb24uICBUaGVyZWZvcmUsXG4gKiBhc3NpZ24gdGhlIHJldHVybiB2YWx1ZSAoPGNvZGU+dW5kZWZpbmVkPC9jb2RlPikgdG8gdGhlIG9iamVjdCBhcyBkb25lIGluIHRoZSBleGFtcGxlLlxuICogPC9wPlxuICpcbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSBUaGlzIG9iamVjdCB3YXMgZGVzdHJveWVkLCBpLmUuLCBkZXN0cm95KCkgd2FzIGNhbGxlZC5cbiAqXG4gKiBAc2VlIE9jdGFoZWRyYWxQcm9qZWN0ZWRDdWJlTWFwI2lzRGVzdHJveWVkXG4gKi9cbk9jdGFoZWRyYWxQcm9qZWN0ZWRDdWJlTWFwLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICBjbGVhbnVwUmVzb3VyY2VzKHRoaXMpO1xuICB0aGlzLl90ZXh0dXJlID0gdGhpcy5fdGV4dHVyZSAmJiB0aGlzLl90ZXh0dXJlLmRlc3Ryb3koKTtcbiAgcmV0dXJuIGRlc3Ryb3lPYmplY3QodGhpcyk7XG59O1xuZXhwb3J0IGRlZmF1bHQgT2N0YWhlZHJhbFByb2plY3RlZEN1YmVNYXA7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///22277\n')},75436:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_Credit_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(52975);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(82982);\n/* harmony import */ var _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12572);\n/* harmony import */ var _Core_Rectangle_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(96190);\n/* harmony import */ var _Core_Resource_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(68985);\n/* harmony import */ var _Core_WebMercatorTilingScheme_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(42423);\n/* harmony import */ var _UrlTemplateImageryProvider_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(24855);\n\n\n\n\n\n\n\n\n\nvar defaultCredit = new _Core_Credit_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(\n  "MapQuest, Open Street Map and contributors, CC-BY-SA"\n);\n\n/**\n * @typedef {Object} OpenStreetMapImageryProvider.ConstructorOptions\n *\n * Initialization options for the OpenStreetMapImageryProvider constructor\n *\n * @property {String} [url=\'https://a.tile.openstreetmap.org\'] The OpenStreetMap server url.\n * @property {String} [fileExtension=\'png\'] The file extension for images on the server.\n * @property {Rectangle} [rectangle=Rectangle.MAX_VALUE] The rectangle of the layer.\n * @property {Number} [minimumLevel=0] The minimum level-of-detail supported by the imagery provider.\n * @property {Number} [maximumLevel] The maximum level-of-detail supported by the imagery provider, or undefined if there is no limit.\n * @property {Ellipsoid} [ellipsoid] The ellipsoid.  If not specified, the WGS84 ellipsoid is used.\n * @property {Credit|String} [credit=\'MapQuest, Open Street Map and contributors, CC-BY-SA\'] A credit for the data source, which is displayed on the canvas.\n */\n\n/**\n * An imagery provider that provides tiled imagery hosted by OpenStreetMap\n * or another provider of Slippy tiles.  The default url connects to OpenStreetMap\'s volunteer-run\n * servers, so you must conform to their\n * {@link http://wiki.openstreetmap.org/wiki/Tile_usage_policy|Tile Usage Policy}.\n *\n * @alias OpenStreetMapImageryProvider\n * @constructor\n * @extends UrlTemplateImageryProvider\n *\n * @param {OpenStreetMapImageryProvider.ConstructorOptions} options Object describing initialization options\n * @exception {DeveloperError} The rectangle and minimumLevel indicate that there are more than four tiles at the minimum level. Imagery providers with more than four tiles at the minimum level are not supported.\n *\n * @see ArcGisMapServerImageryProvider\n * @see BingMapsImageryProvider\n * @see GoogleEarthEnterpriseMapsProvider\n * @see SingleTileImageryProvider\n * @see TileMapServiceImageryProvider\n * @see WebMapServiceImageryProvider\n * @see WebMapTileServiceImageryProvider\n * @see UrlTemplateImageryProvider\n *\n * @example\n * var osm = new Cesium.OpenStreetMapImageryProvider({\n *     url : \'https://a.tile.openstreetmap.org/\'\n * });\n *\n * @see {@link http://wiki.openstreetmap.org/wiki/Main_Page|OpenStreetMap Wiki}\n * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\n */\nfunction OpenStreetMapImageryProvider(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n\n  var resource = _Core_Resource_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].createIfNeeded */ .Z.createIfNeeded(\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(options.url, "https://a.tile.openstreetmap.org/")\n  );\n  resource.appendForwardSlash();\n  resource.url += "{z}/{x}/{y}." + (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(options.fileExtension, "png");\n\n  var tilingScheme = new _Core_WebMercatorTilingScheme_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z({\n    ellipsoid: options.ellipsoid,\n  });\n\n  var tileWidth = 256;\n  var tileHeight = 256;\n\n  var minimumLevel = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(options.minimumLevel, 0);\n  var maximumLevel = options.maximumLevel;\n\n  var rectangle = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(options.rectangle, tilingScheme.rectangle);\n\n  // Check the number of tiles at the minimum level.  If it\'s more than four,\n  // throw an exception, because starting at the higher minimum\n  // level will cause too many tiles to be downloaded and rendered.\n  var swTile = tilingScheme.positionToTileXY(\n    _Core_Rectangle_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].southwest */ .Z.southwest(rectangle),\n    minimumLevel\n  );\n  var neTile = tilingScheme.positionToTileXY(\n    _Core_Rectangle_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].northeast */ .Z.northeast(rectangle),\n    minimumLevel\n  );\n  var tileCount =\n    (Math.abs(neTile.x - swTile.x) + 1) * (Math.abs(neTile.y - swTile.y) + 1);\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (tileCount > 4) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z(\n      "The rectangle and minimumLevel indicate that there are " +\n        tileCount +\n        " tiles at the minimum level. Imagery providers with more than four tiles at the minimum level are not supported."\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  var credit = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(options.credit, defaultCredit);\n  if (typeof credit === "string") {\n    credit = new _Core_Credit_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(credit);\n  }\n\n  _UrlTemplateImageryProvider_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].call */ .Z.call(this, {\n    url: resource,\n    credit: credit,\n    tilingScheme: tilingScheme,\n    tileWidth: tileWidth,\n    tileHeight: tileHeight,\n    minimumLevel: minimumLevel,\n    maximumLevel: maximumLevel,\n    rectangle: rectangle,\n  });\n}\n\nif ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(Object.create)) {\n  OpenStreetMapImageryProvider.prototype = Object.create(\n    _UrlTemplateImageryProvider_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].prototype */ .Z.prototype\n  );\n  OpenStreetMapImageryProvider.prototype.constructor = OpenStreetMapImageryProvider;\n}\n\n/* harmony default export */ __webpack_exports__["Z"] = (OpenStreetMapImageryProvider);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzU0MzYuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBdUM7QUFDWTtBQUNWO0FBQ2M7QUFDVjtBQUNGO0FBQzhCO0FBQ0E7O0FBRXpFLHdCQUF3QixnRUFBTTtBQUM5QjtBQUNBOztBQUVBO0FBQ0EsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLGNBQWMsUUFBUTtBQUN0QixjQUFjLFFBQVE7QUFDdEIsY0FBYyxXQUFXO0FBQ3pCLGNBQWMsUUFBUTtBQUN0QixjQUFjLFFBQVE7QUFDdEIsY0FBYyxXQUFXO0FBQ3pCLGNBQWMsZUFBZTtBQUM3Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksNkVBQTZFO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLGlEQUFpRDtBQUM1RCxlQUFlLGdCQUFnQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLFNBQVM7QUFDVCxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFlBQVksMEVBQVksVUFBVSxnR0FBeUI7O0FBRTNELGlCQUFpQixnR0FBdUI7QUFDeEMsSUFBSSwwRUFBWTtBQUNoQjtBQUNBO0FBQ0Esb0JBQW9CLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxLQUFLLDBFQUFZOztBQUUvQyx5QkFBeUIsaUZBQXVCO0FBQ2hEO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBLHFCQUFxQiwwRUFBWTtBQUNqQzs7QUFFQSxrQkFBa0IsMEVBQVk7O0FBRTlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSx1RkFBbUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsSUFBSSx1RkFBbUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyx3RUFBYztBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsZUFBZSwwRUFBWTtBQUMzQjtBQUNBLGlCQUFpQixnRUFBTTtBQUN2Qjs7QUFFQSxFQUFFLHlGQUErQjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBLElBQUkscUVBQU87QUFDWDtBQUNBLElBQUksbUdBQW9DO0FBQ3hDO0FBQ0E7QUFDQTs7QUFFQSx5REFBZSw0QkFBNEIsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9TY2VuZS9PcGVuU3RyZWV0TWFwSW1hZ2VyeVByb3ZpZGVyLmpzPzRjZWIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENyZWRpdCBmcm9tIFwiLi4vQ29yZS9DcmVkaXQuanNcIjtcbmltcG9ydCBkZWZhdWx0VmFsdWUgZnJvbSBcIi4uL0NvcmUvZGVmYXVsdFZhbHVlLmpzXCI7XG5pbXBvcnQgZGVmaW5lZCBmcm9tIFwiLi4vQ29yZS9kZWZpbmVkLmpzXCI7XG5pbXBvcnQgRGV2ZWxvcGVyRXJyb3IgZnJvbSBcIi4uL0NvcmUvRGV2ZWxvcGVyRXJyb3IuanNcIjtcbmltcG9ydCBSZWN0YW5nbGUgZnJvbSBcIi4uL0NvcmUvUmVjdGFuZ2xlLmpzXCI7XG5pbXBvcnQgUmVzb3VyY2UgZnJvbSBcIi4uL0NvcmUvUmVzb3VyY2UuanNcIjtcbmltcG9ydCBXZWJNZXJjYXRvclRpbGluZ1NjaGVtZSBmcm9tIFwiLi4vQ29yZS9XZWJNZXJjYXRvclRpbGluZ1NjaGVtZS5qc1wiO1xuaW1wb3J0IFVybFRlbXBsYXRlSW1hZ2VyeVByb3ZpZGVyIGZyb20gXCIuL1VybFRlbXBsYXRlSW1hZ2VyeVByb3ZpZGVyLmpzXCI7XG5cbnZhciBkZWZhdWx0Q3JlZGl0ID0gbmV3IENyZWRpdChcbiAgXCJNYXBRdWVzdCwgT3BlbiBTdHJlZXQgTWFwIGFuZCBjb250cmlidXRvcnMsIENDLUJZLVNBXCJcbik7XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gT3BlblN0cmVldE1hcEltYWdlcnlQcm92aWRlci5Db25zdHJ1Y3Rvck9wdGlvbnNcbiAqXG4gKiBJbml0aWFsaXphdGlvbiBvcHRpb25zIGZvciB0aGUgT3BlblN0cmVldE1hcEltYWdlcnlQcm92aWRlciBjb25zdHJ1Y3RvclxuICpcbiAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBbdXJsPSdodHRwczovL2EudGlsZS5vcGVuc3RyZWV0bWFwLm9yZyddIFRoZSBPcGVuU3RyZWV0TWFwIHNlcnZlciB1cmwuXG4gKiBAcHJvcGVydHkge1N0cmluZ30gW2ZpbGVFeHRlbnNpb249J3BuZyddIFRoZSBmaWxlIGV4dGVuc2lvbiBmb3IgaW1hZ2VzIG9uIHRoZSBzZXJ2ZXIuXG4gKiBAcHJvcGVydHkge1JlY3RhbmdsZX0gW3JlY3RhbmdsZT1SZWN0YW5nbGUuTUFYX1ZBTFVFXSBUaGUgcmVjdGFuZ2xlIG9mIHRoZSBsYXllci5cbiAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBbbWluaW11bUxldmVsPTBdIFRoZSBtaW5pbXVtIGxldmVsLW9mLWRldGFpbCBzdXBwb3J0ZWQgYnkgdGhlIGltYWdlcnkgcHJvdmlkZXIuXG4gKiBAcHJvcGVydHkge051bWJlcn0gW21heGltdW1MZXZlbF0gVGhlIG1heGltdW0gbGV2ZWwtb2YtZGV0YWlsIHN1cHBvcnRlZCBieSB0aGUgaW1hZ2VyeSBwcm92aWRlciwgb3IgdW5kZWZpbmVkIGlmIHRoZXJlIGlzIG5vIGxpbWl0LlxuICogQHByb3BlcnR5IHtFbGxpcHNvaWR9IFtlbGxpcHNvaWRdIFRoZSBlbGxpcHNvaWQuICBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgV0dTODQgZWxsaXBzb2lkIGlzIHVzZWQuXG4gKiBAcHJvcGVydHkge0NyZWRpdHxTdHJpbmd9IFtjcmVkaXQ9J01hcFF1ZXN0LCBPcGVuIFN0cmVldCBNYXAgYW5kIGNvbnRyaWJ1dG9ycywgQ0MtQlktU0EnXSBBIGNyZWRpdCBmb3IgdGhlIGRhdGEgc291cmNlLCB3aGljaCBpcyBkaXNwbGF5ZWQgb24gdGhlIGNhbnZhcy5cbiAqL1xuXG4vKipcbiAqIEFuIGltYWdlcnkgcHJvdmlkZXIgdGhhdCBwcm92aWRlcyB0aWxlZCBpbWFnZXJ5IGhvc3RlZCBieSBPcGVuU3RyZWV0TWFwXG4gKiBvciBhbm90aGVyIHByb3ZpZGVyIG9mIFNsaXBweSB0aWxlcy4gIFRoZSBkZWZhdWx0IHVybCBjb25uZWN0cyB0byBPcGVuU3RyZWV0TWFwJ3Mgdm9sdW50ZWVyLXJ1blxuICogc2VydmVycywgc28geW91IG11c3QgY29uZm9ybSB0byB0aGVpclxuICoge0BsaW5rIGh0dHA6Ly93aWtpLm9wZW5zdHJlZXRtYXAub3JnL3dpa2kvVGlsZV91c2FnZV9wb2xpY3l8VGlsZSBVc2FnZSBQb2xpY3l9LlxuICpcbiAqIEBhbGlhcyBPcGVuU3RyZWV0TWFwSW1hZ2VyeVByb3ZpZGVyXG4gKiBAY29uc3RydWN0b3JcbiAqIEBleHRlbmRzIFVybFRlbXBsYXRlSW1hZ2VyeVByb3ZpZGVyXG4gKlxuICogQHBhcmFtIHtPcGVuU3RyZWV0TWFwSW1hZ2VyeVByb3ZpZGVyLkNvbnN0cnVjdG9yT3B0aW9uc30gb3B0aW9ucyBPYmplY3QgZGVzY3JpYmluZyBpbml0aWFsaXphdGlvbiBvcHRpb25zXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gVGhlIHJlY3RhbmdsZSBhbmQgbWluaW11bUxldmVsIGluZGljYXRlIHRoYXQgdGhlcmUgYXJlIG1vcmUgdGhhbiBmb3VyIHRpbGVzIGF0IHRoZSBtaW5pbXVtIGxldmVsLiBJbWFnZXJ5IHByb3ZpZGVycyB3aXRoIG1vcmUgdGhhbiBmb3VyIHRpbGVzIGF0IHRoZSBtaW5pbXVtIGxldmVsIGFyZSBub3Qgc3VwcG9ydGVkLlxuICpcbiAqIEBzZWUgQXJjR2lzTWFwU2VydmVySW1hZ2VyeVByb3ZpZGVyXG4gKiBAc2VlIEJpbmdNYXBzSW1hZ2VyeVByb3ZpZGVyXG4gKiBAc2VlIEdvb2dsZUVhcnRoRW50ZXJwcmlzZU1hcHNQcm92aWRlclxuICogQHNlZSBTaW5nbGVUaWxlSW1hZ2VyeVByb3ZpZGVyXG4gKiBAc2VlIFRpbGVNYXBTZXJ2aWNlSW1hZ2VyeVByb3ZpZGVyXG4gKiBAc2VlIFdlYk1hcFNlcnZpY2VJbWFnZXJ5UHJvdmlkZXJcbiAqIEBzZWUgV2ViTWFwVGlsZVNlcnZpY2VJbWFnZXJ5UHJvdmlkZXJcbiAqIEBzZWUgVXJsVGVtcGxhdGVJbWFnZXJ5UHJvdmlkZXJcbiAqXG4gKiBAZXhhbXBsZVxuICogdmFyIG9zbSA9IG5ldyBDZXNpdW0uT3BlblN0cmVldE1hcEltYWdlcnlQcm92aWRlcih7XG4gKiAgICAgdXJsIDogJ2h0dHBzOi8vYS50aWxlLm9wZW5zdHJlZXRtYXAub3JnLydcbiAqIH0pO1xuICpcbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly93aWtpLm9wZW5zdHJlZXRtYXAub3JnL3dpa2kvTWFpbl9QYWdlfE9wZW5TdHJlZXRNYXAgV2lraX1cbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly93d3cudzMub3JnL1RSL2NvcnMvfENyb3NzLU9yaWdpbiBSZXNvdXJjZSBTaGFyaW5nfVxuICovXG5mdW5jdGlvbiBPcGVuU3RyZWV0TWFwSW1hZ2VyeVByb3ZpZGVyKG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLCBkZWZhdWx0VmFsdWUuRU1QVFlfT0JKRUNUKTtcblxuICB2YXIgcmVzb3VyY2UgPSBSZXNvdXJjZS5jcmVhdGVJZk5lZWRlZChcbiAgICBkZWZhdWx0VmFsdWUob3B0aW9ucy51cmwsIFwiaHR0cHM6Ly9hLnRpbGUub3BlbnN0cmVldG1hcC5vcmcvXCIpXG4gICk7XG4gIHJlc291cmNlLmFwcGVuZEZvcndhcmRTbGFzaCgpO1xuICByZXNvdXJjZS51cmwgKz0gXCJ7en0ve3h9L3t5fS5cIiArIGRlZmF1bHRWYWx1ZShvcHRpb25zLmZpbGVFeHRlbnNpb24sIFwicG5nXCIpO1xuXG4gIHZhciB0aWxpbmdTY2hlbWUgPSBuZXcgV2ViTWVyY2F0b3JUaWxpbmdTY2hlbWUoe1xuICAgIGVsbGlwc29pZDogb3B0aW9ucy5lbGxpcHNvaWQsXG4gIH0pO1xuXG4gIHZhciB0aWxlV2lkdGggPSAyNTY7XG4gIHZhciB0aWxlSGVpZ2h0ID0gMjU2O1xuXG4gIHZhciBtaW5pbXVtTGV2ZWwgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5taW5pbXVtTGV2ZWwsIDApO1xuICB2YXIgbWF4aW11bUxldmVsID0gb3B0aW9ucy5tYXhpbXVtTGV2ZWw7XG5cbiAgdmFyIHJlY3RhbmdsZSA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLnJlY3RhbmdsZSwgdGlsaW5nU2NoZW1lLnJlY3RhbmdsZSk7XG5cbiAgLy8gQ2hlY2sgdGhlIG51bWJlciBvZiB0aWxlcyBhdCB0aGUgbWluaW11bSBsZXZlbC4gIElmIGl0J3MgbW9yZSB0aGFuIGZvdXIsXG4gIC8vIHRocm93IGFuIGV4Y2VwdGlvbiwgYmVjYXVzZSBzdGFydGluZyBhdCB0aGUgaGlnaGVyIG1pbmltdW1cbiAgLy8gbGV2ZWwgd2lsbCBjYXVzZSB0b28gbWFueSB0aWxlcyB0byBiZSBkb3dubG9hZGVkIGFuZCByZW5kZXJlZC5cbiAgdmFyIHN3VGlsZSA9IHRpbGluZ1NjaGVtZS5wb3NpdGlvblRvVGlsZVhZKFxuICAgIFJlY3RhbmdsZS5zb3V0aHdlc3QocmVjdGFuZ2xlKSxcbiAgICBtaW5pbXVtTGV2ZWxcbiAgKTtcbiAgdmFyIG5lVGlsZSA9IHRpbGluZ1NjaGVtZS5wb3NpdGlvblRvVGlsZVhZKFxuICAgIFJlY3RhbmdsZS5ub3J0aGVhc3QocmVjdGFuZ2xlKSxcbiAgICBtaW5pbXVtTGV2ZWxcbiAgKTtcbiAgdmFyIHRpbGVDb3VudCA9XG4gICAgKE1hdGguYWJzKG5lVGlsZS54IC0gc3dUaWxlLngpICsgMSkgKiAoTWF0aC5hYnMobmVUaWxlLnkgLSBzd1RpbGUueSkgKyAxKTtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgaWYgKHRpbGVDb3VudCA+IDQpIHtcbiAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgICBcIlRoZSByZWN0YW5nbGUgYW5kIG1pbmltdW1MZXZlbCBpbmRpY2F0ZSB0aGF0IHRoZXJlIGFyZSBcIiArXG4gICAgICAgIHRpbGVDb3VudCArXG4gICAgICAgIFwiIHRpbGVzIGF0IHRoZSBtaW5pbXVtIGxldmVsLiBJbWFnZXJ5IHByb3ZpZGVycyB3aXRoIG1vcmUgdGhhbiBmb3VyIHRpbGVzIGF0IHRoZSBtaW5pbXVtIGxldmVsIGFyZSBub3Qgc3VwcG9ydGVkLlwiXG4gICAgKTtcbiAgfVxuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB2YXIgY3JlZGl0ID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuY3JlZGl0LCBkZWZhdWx0Q3JlZGl0KTtcbiAgaWYgKHR5cGVvZiBjcmVkaXQgPT09IFwic3RyaW5nXCIpIHtcbiAgICBjcmVkaXQgPSBuZXcgQ3JlZGl0KGNyZWRpdCk7XG4gIH1cblxuICBVcmxUZW1wbGF0ZUltYWdlcnlQcm92aWRlci5jYWxsKHRoaXMsIHtcbiAgICB1cmw6IHJlc291cmNlLFxuICAgIGNyZWRpdDogY3JlZGl0LFxuICAgIHRpbGluZ1NjaGVtZTogdGlsaW5nU2NoZW1lLFxuICAgIHRpbGVXaWR0aDogdGlsZVdpZHRoLFxuICAgIHRpbGVIZWlnaHQ6IHRpbGVIZWlnaHQsXG4gICAgbWluaW11bUxldmVsOiBtaW5pbXVtTGV2ZWwsXG4gICAgbWF4aW11bUxldmVsOiBtYXhpbXVtTGV2ZWwsXG4gICAgcmVjdGFuZ2xlOiByZWN0YW5nbGUsXG4gIH0pO1xufVxuXG5pZiAoZGVmaW5lZChPYmplY3QuY3JlYXRlKSkge1xuICBPcGVuU3RyZWV0TWFwSW1hZ2VyeVByb3ZpZGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoXG4gICAgVXJsVGVtcGxhdGVJbWFnZXJ5UHJvdmlkZXIucHJvdG90eXBlXG4gICk7XG4gIE9wZW5TdHJlZXRNYXBJbWFnZXJ5UHJvdmlkZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gT3BlblN0cmVldE1hcEltYWdlcnlQcm92aWRlcjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgT3BlblN0cmVldE1hcEltYWdlcnlQcm92aWRlcjtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///75436\n')},32073:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(66553);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(82982);\n/* harmony import */ var _Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(86511);\n/* harmony import */ var _PrimitiveCollection_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(73316);\n\n\n\n\n\n\n/**\n * A primitive collection for helping maintain the order or ground primitives based on a z-index\n *\n * @private\n */\nfunction OrderedGroundPrimitiveCollection() {\n  this._length = 0;\n  this._collections = {};\n  this._collectionsArray = [];\n\n  this.show = true;\n}\n\nObject.defineProperties(OrderedGroundPrimitiveCollection.prototype, {\n  /**\n   * Gets the number of primitives in the collection.\n   *\n   * @memberof OrderedGroundPrimitiveCollection.prototype\n   *\n   * @type {Number}\n   * @readonly\n   */\n  length: {\n    get: function () {\n      return this._length;\n    },\n  },\n});\n\n/**\n * Adds a primitive to the collection.\n *\n * @param {GroundPrimitive} primitive The primitive to add.\n * @param {Number} [zIndex = 0] The index of the primitive\n * @returns {GroundPrimitive} The primitive added to the collection.\n */\nOrderedGroundPrimitiveCollection.prototype.add = function (primitive, zIndex) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].defined */ .Z.defined("primitive", primitive);\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(zIndex)) {\n    _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.number */ .Z.typeOf.number("zIndex", zIndex);\n  }\n  //>>includeEnd(\'debug\');\n\n  zIndex = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(zIndex, 0);\n  var collection = this._collections[zIndex];\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(collection)) {\n    collection = new _PrimitiveCollection_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z({ destroyPrimitives: false });\n    collection._zIndex = zIndex;\n    this._collections[zIndex] = collection;\n    var array = this._collectionsArray;\n    var i = 0;\n    while (i < array.length && array[i]._zIndex < zIndex) {\n      i++;\n    }\n    array.splice(i, 0, collection);\n  }\n\n  collection.add(primitive);\n  this._length++;\n  primitive._zIndex = zIndex;\n\n  return primitive;\n};\n\n/**\n * Adjusts the z-index\n * @param {GroundPrimitive} primitive\n * @param {Number} zIndex\n */\nOrderedGroundPrimitiveCollection.prototype.set = function (primitive, zIndex) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].defined */ .Z.defined("primitive", primitive);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.number */ .Z.typeOf.number("zIndex", zIndex);\n  //>>includeEnd(\'debug\');\n\n  if (zIndex === primitive._zIndex) {\n    return primitive;\n  }\n\n  this.remove(primitive, true);\n  this.add(primitive, zIndex);\n\n  return primitive;\n};\n\n/**\n * Removes a primitive from the collection.\n *\n * @param {Object} primitive The primitive to remove.\n * @param {Boolean} [doNotDestroy = false]\n * @returns {Boolean} <code>true</code> if the primitive was removed; <code>false</code> if the primitive is <code>undefined</code> or was not found in the collection.\n */\nOrderedGroundPrimitiveCollection.prototype.remove = function (\n  primitive,\n  doNotDestroy\n) {\n  if (this.contains(primitive)) {\n    var index = primitive._zIndex;\n    var collection = this._collections[index];\n    var result;\n    if (doNotDestroy) {\n      result = collection.remove(primitive);\n    } else {\n      result = collection.removeAndDestroy(primitive);\n    }\n\n    if (result) {\n      this._length--;\n    }\n\n    if (collection.length === 0) {\n      this._collectionsArray.splice(\n        this._collectionsArray.indexOf(collection),\n        1\n      );\n      this._collections[index] = undefined;\n      collection.destroy();\n    }\n\n    return result;\n  }\n\n  return false;\n};\n\n/**\n * Removes all primitives in the collection.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n * @see OrderedGroundPrimitiveCollection#destroyPrimitives\n */\nOrderedGroundPrimitiveCollection.prototype.removeAll = function () {\n  var collections = this._collectionsArray;\n  for (var i = 0; i < collections.length; i++) {\n    var collection = collections[i];\n    collection.destroyPrimitives = true;\n    collection.destroy();\n  }\n\n  this._collections = {};\n  this._collectionsArray = [];\n  this._length = 0;\n};\n\n/**\n * Determines if this collection contains a primitive.\n *\n * @param {Object} primitive The primitive to check for.\n * @returns {Boolean} <code>true</code> if the primitive is in the collection; <code>false</code> if the primitive is <code>undefined</code> or was not found in the collection.\n */\nOrderedGroundPrimitiveCollection.prototype.contains = function (primitive) {\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(primitive)) {\n    return false;\n  }\n  var collection = this._collections[primitive._zIndex];\n  return (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(collection) && collection.contains(primitive);\n};\n\n/**\n * @private\n */\nOrderedGroundPrimitiveCollection.prototype.update = function (frameState) {\n  if (!this.show) {\n    return;\n  }\n\n  var collections = this._collectionsArray;\n  for (var i = 0; i < collections.length; i++) {\n    collections[i].update(frameState);\n  }\n};\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <br /><br />\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n *\n * @returns {Boolean} True if this object was destroyed; otherwise, false.\n *\n * @see OrderedGroundPrimitiveCollection#destroy\n */\nOrderedGroundPrimitiveCollection.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the WebGL resources held by each primitive in this collection.  Explicitly destroying this\n * collection allows for deterministic release of WebGL resources, instead of relying on the garbage\n * collector to destroy this collection.\n * <br /><br />\n * Since destroying a collection destroys all the contained primitives, only destroy a collection\n * when you are sure no other code is still using any of the contained primitives.\n * <br /><br />\n * Once this collection is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n *\n * @example\n * primitives = primitives && primitives.destroy();\n *\n * @see OrderedGroundPrimitiveCollection#isDestroyed\n */\nOrderedGroundPrimitiveCollection.prototype.destroy = function () {\n  this.removeAll();\n  return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(this);\n};\n/* harmony default export */ __webpack_exports__["Z"] = (OrderedGroundPrimitiveCollection);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzIwNzMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBcUM7QUFDYztBQUNWO0FBQ1k7QUFDTTs7QUFFM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNILENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0EsV0FBVyxpQkFBaUI7QUFDNUIsV0FBVyxRQUFRO0FBQ25CLGFBQWEsaUJBQWlCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLEVBQUUsK0VBQWE7QUFDZixNQUFNLHFFQUFPO0FBQ2IsSUFBSSwyRkFBbUI7QUFDdkI7QUFDQTs7QUFFQSxXQUFXLDBFQUFZO0FBQ3ZCO0FBQ0EsT0FBTyxxRUFBTztBQUNkLHFCQUFxQix3RUFBbUIsR0FBRywwQkFBMEI7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxXQUFXLGlCQUFpQjtBQUM1QixXQUFXLFFBQVE7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsRUFBRSwrRUFBYTtBQUNmLEVBQUUsMkZBQW1CO0FBQ3JCOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLFdBQVcsU0FBUztBQUNwQixhQUFhLFNBQVMsZ0RBQWdEO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQix3QkFBd0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLGFBQWEsU0FBUyx5REFBeUQ7QUFDL0U7QUFDQTtBQUNBLE9BQU8scUVBQU87QUFDZDtBQUNBO0FBQ0E7QUFDQSxTQUFTLHFFQUFPO0FBQ2hCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esa0JBQWtCLHdCQUF3QjtBQUMxQztBQUNBO0FBQ0E7O0FBRUE7QUFDQSw4Q0FBOEM7QUFDOUM7QUFDQSx3REFBd0Q7QUFDeEQsOENBQThDLHNCQUFzQjtBQUNwRTtBQUNBLGFBQWEsU0FBUyxtQ0FBbUM7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQ7QUFDN0QsOENBQThDLHNCQUFzQjtBQUNwRTtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUywyRUFBYTtBQUN0QjtBQUNBLHlEQUFlLGdDQUFnQyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnVlMy13ZWJwYWNrNS8uL25vZGVfbW9kdWxlcy9jZXNpdW0vU291cmNlL1NjZW5lL09yZGVyZWRHcm91bmRQcmltaXRpdmVDb2xsZWN0aW9uLmpzPzQxODUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENoZWNrIGZyb20gXCIuLi9Db3JlL0NoZWNrLmpzXCI7XG5pbXBvcnQgZGVmYXVsdFZhbHVlIGZyb20gXCIuLi9Db3JlL2RlZmF1bHRWYWx1ZS5qc1wiO1xuaW1wb3J0IGRlZmluZWQgZnJvbSBcIi4uL0NvcmUvZGVmaW5lZC5qc1wiO1xuaW1wb3J0IGRlc3Ryb3lPYmplY3QgZnJvbSBcIi4uL0NvcmUvZGVzdHJveU9iamVjdC5qc1wiO1xuaW1wb3J0IFByaW1pdGl2ZUNvbGxlY3Rpb24gZnJvbSBcIi4vUHJpbWl0aXZlQ29sbGVjdGlvbi5qc1wiO1xuXG4vKipcbiAqIEEgcHJpbWl0aXZlIGNvbGxlY3Rpb24gZm9yIGhlbHBpbmcgbWFpbnRhaW4gdGhlIG9yZGVyIG9yIGdyb3VuZCBwcmltaXRpdmVzIGJhc2VkIG9uIGEgei1pbmRleFxuICpcbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIE9yZGVyZWRHcm91bmRQcmltaXRpdmVDb2xsZWN0aW9uKCkge1xuICB0aGlzLl9sZW5ndGggPSAwO1xuICB0aGlzLl9jb2xsZWN0aW9ucyA9IHt9O1xuICB0aGlzLl9jb2xsZWN0aW9uc0FycmF5ID0gW107XG5cbiAgdGhpcy5zaG93ID0gdHJ1ZTtcbn1cblxuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoT3JkZXJlZEdyb3VuZFByaW1pdGl2ZUNvbGxlY3Rpb24ucHJvdG90eXBlLCB7XG4gIC8qKlxuICAgKiBHZXRzIHRoZSBudW1iZXIgb2YgcHJpbWl0aXZlcyBpbiB0aGUgY29sbGVjdGlvbi5cbiAgICpcbiAgICogQG1lbWJlcm9mIE9yZGVyZWRHcm91bmRQcmltaXRpdmVDb2xsZWN0aW9uLnByb3RvdHlwZVxuICAgKlxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIGxlbmd0aDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2xlbmd0aDtcbiAgICB9LFxuICB9LFxufSk7XG5cbi8qKlxuICogQWRkcyBhIHByaW1pdGl2ZSB0byB0aGUgY29sbGVjdGlvbi5cbiAqXG4gKiBAcGFyYW0ge0dyb3VuZFByaW1pdGl2ZX0gcHJpbWl0aXZlIFRoZSBwcmltaXRpdmUgdG8gYWRkLlxuICogQHBhcmFtIHtOdW1iZXJ9IFt6SW5kZXggPSAwXSBUaGUgaW5kZXggb2YgdGhlIHByaW1pdGl2ZVxuICogQHJldHVybnMge0dyb3VuZFByaW1pdGl2ZX0gVGhlIHByaW1pdGl2ZSBhZGRlZCB0byB0aGUgY29sbGVjdGlvbi5cbiAqL1xuT3JkZXJlZEdyb3VuZFByaW1pdGl2ZUNvbGxlY3Rpb24ucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChwcmltaXRpdmUsIHpJbmRleCkge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay5kZWZpbmVkKFwicHJpbWl0aXZlXCIsIHByaW1pdGl2ZSk7XG4gIGlmIChkZWZpbmVkKHpJbmRleCkpIHtcbiAgICBDaGVjay50eXBlT2YubnVtYmVyKFwiekluZGV4XCIsIHpJbmRleCk7XG4gIH1cbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgekluZGV4ID0gZGVmYXVsdFZhbHVlKHpJbmRleCwgMCk7XG4gIHZhciBjb2xsZWN0aW9uID0gdGhpcy5fY29sbGVjdGlvbnNbekluZGV4XTtcbiAgaWYgKCFkZWZpbmVkKGNvbGxlY3Rpb24pKSB7XG4gICAgY29sbGVjdGlvbiA9IG5ldyBQcmltaXRpdmVDb2xsZWN0aW9uKHsgZGVzdHJveVByaW1pdGl2ZXM6IGZhbHNlIH0pO1xuICAgIGNvbGxlY3Rpb24uX3pJbmRleCA9IHpJbmRleDtcbiAgICB0aGlzLl9jb2xsZWN0aW9uc1t6SW5kZXhdID0gY29sbGVjdGlvbjtcbiAgICB2YXIgYXJyYXkgPSB0aGlzLl9jb2xsZWN0aW9uc0FycmF5O1xuICAgIHZhciBpID0gMDtcbiAgICB3aGlsZSAoaSA8IGFycmF5Lmxlbmd0aCAmJiBhcnJheVtpXS5fekluZGV4IDwgekluZGV4KSB7XG4gICAgICBpKys7XG4gICAgfVxuICAgIGFycmF5LnNwbGljZShpLCAwLCBjb2xsZWN0aW9uKTtcbiAgfVxuXG4gIGNvbGxlY3Rpb24uYWRkKHByaW1pdGl2ZSk7XG4gIHRoaXMuX2xlbmd0aCsrO1xuICBwcmltaXRpdmUuX3pJbmRleCA9IHpJbmRleDtcblxuICByZXR1cm4gcHJpbWl0aXZlO1xufTtcblxuLyoqXG4gKiBBZGp1c3RzIHRoZSB6LWluZGV4XG4gKiBAcGFyYW0ge0dyb3VuZFByaW1pdGl2ZX0gcHJpbWl0aXZlXG4gKiBAcGFyYW0ge051bWJlcn0gekluZGV4XG4gKi9cbk9yZGVyZWRHcm91bmRQcmltaXRpdmVDb2xsZWN0aW9uLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAocHJpbWl0aXZlLCB6SW5kZXgpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2suZGVmaW5lZChcInByaW1pdGl2ZVwiLCBwcmltaXRpdmUpO1xuICBDaGVjay50eXBlT2YubnVtYmVyKFwiekluZGV4XCIsIHpJbmRleCk7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIGlmICh6SW5kZXggPT09IHByaW1pdGl2ZS5fekluZGV4KSB7XG4gICAgcmV0dXJuIHByaW1pdGl2ZTtcbiAgfVxuXG4gIHRoaXMucmVtb3ZlKHByaW1pdGl2ZSwgdHJ1ZSk7XG4gIHRoaXMuYWRkKHByaW1pdGl2ZSwgekluZGV4KTtcblxuICByZXR1cm4gcHJpbWl0aXZlO1xufTtcblxuLyoqXG4gKiBSZW1vdmVzIGEgcHJpbWl0aXZlIGZyb20gdGhlIGNvbGxlY3Rpb24uXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHByaW1pdGl2ZSBUaGUgcHJpbWl0aXZlIHRvIHJlbW92ZS5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW2RvTm90RGVzdHJveSA9IGZhbHNlXVxuICogQHJldHVybnMge0Jvb2xlYW59IDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoZSBwcmltaXRpdmUgd2FzIHJlbW92ZWQ7IDxjb2RlPmZhbHNlPC9jb2RlPiBpZiB0aGUgcHJpbWl0aXZlIGlzIDxjb2RlPnVuZGVmaW5lZDwvY29kZT4gb3Igd2FzIG5vdCBmb3VuZCBpbiB0aGUgY29sbGVjdGlvbi5cbiAqL1xuT3JkZXJlZEdyb3VuZFByaW1pdGl2ZUNvbGxlY3Rpb24ucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChcbiAgcHJpbWl0aXZlLFxuICBkb05vdERlc3Ryb3lcbikge1xuICBpZiAodGhpcy5jb250YWlucyhwcmltaXRpdmUpKSB7XG4gICAgdmFyIGluZGV4ID0gcHJpbWl0aXZlLl96SW5kZXg7XG4gICAgdmFyIGNvbGxlY3Rpb24gPSB0aGlzLl9jb2xsZWN0aW9uc1tpbmRleF07XG4gICAgdmFyIHJlc3VsdDtcbiAgICBpZiAoZG9Ob3REZXN0cm95KSB7XG4gICAgICByZXN1bHQgPSBjb2xsZWN0aW9uLnJlbW92ZShwcmltaXRpdmUpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQgPSBjb2xsZWN0aW9uLnJlbW92ZUFuZERlc3Ryb3kocHJpbWl0aXZlKTtcbiAgICB9XG5cbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICB0aGlzLl9sZW5ndGgtLTtcbiAgICB9XG5cbiAgICBpZiAoY29sbGVjdGlvbi5sZW5ndGggPT09IDApIHtcbiAgICAgIHRoaXMuX2NvbGxlY3Rpb25zQXJyYXkuc3BsaWNlKFxuICAgICAgICB0aGlzLl9jb2xsZWN0aW9uc0FycmF5LmluZGV4T2YoY29sbGVjdGlvbiksXG4gICAgICAgIDFcbiAgICAgICk7XG4gICAgICB0aGlzLl9jb2xsZWN0aW9uc1tpbmRleF0gPSB1bmRlZmluZWQ7XG4gICAgICBjb2xsZWN0aW9uLmRlc3Ryb3koKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuLyoqXG4gKiBSZW1vdmVzIGFsbCBwcmltaXRpdmVzIGluIHRoZSBjb2xsZWN0aW9uLlxuICpcbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSBUaGlzIG9iamVjdCB3YXMgZGVzdHJveWVkLCBpLmUuLCBkZXN0cm95KCkgd2FzIGNhbGxlZC5cbiAqXG4gKiBAc2VlIE9yZGVyZWRHcm91bmRQcmltaXRpdmVDb2xsZWN0aW9uI2Rlc3Ryb3lQcmltaXRpdmVzXG4gKi9cbk9yZGVyZWRHcm91bmRQcmltaXRpdmVDb2xsZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVBbGwgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBjb2xsZWN0aW9ucyA9IHRoaXMuX2NvbGxlY3Rpb25zQXJyYXk7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY29sbGVjdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgY29sbGVjdGlvbiA9IGNvbGxlY3Rpb25zW2ldO1xuICAgIGNvbGxlY3Rpb24uZGVzdHJveVByaW1pdGl2ZXMgPSB0cnVlO1xuICAgIGNvbGxlY3Rpb24uZGVzdHJveSgpO1xuICB9XG5cbiAgdGhpcy5fY29sbGVjdGlvbnMgPSB7fTtcbiAgdGhpcy5fY29sbGVjdGlvbnNBcnJheSA9IFtdO1xuICB0aGlzLl9sZW5ndGggPSAwO1xufTtcblxuLyoqXG4gKiBEZXRlcm1pbmVzIGlmIHRoaXMgY29sbGVjdGlvbiBjb250YWlucyBhIHByaW1pdGl2ZS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcHJpbWl0aXZlIFRoZSBwcmltaXRpdmUgdG8gY2hlY2sgZm9yLlxuICogQHJldHVybnMge0Jvb2xlYW59IDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoZSBwcmltaXRpdmUgaXMgaW4gdGhlIGNvbGxlY3Rpb247IDxjb2RlPmZhbHNlPC9jb2RlPiBpZiB0aGUgcHJpbWl0aXZlIGlzIDxjb2RlPnVuZGVmaW5lZDwvY29kZT4gb3Igd2FzIG5vdCBmb3VuZCBpbiB0aGUgY29sbGVjdGlvbi5cbiAqL1xuT3JkZXJlZEdyb3VuZFByaW1pdGl2ZUNvbGxlY3Rpb24ucHJvdG90eXBlLmNvbnRhaW5zID0gZnVuY3Rpb24gKHByaW1pdGl2ZSkge1xuICBpZiAoIWRlZmluZWQocHJpbWl0aXZlKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICB2YXIgY29sbGVjdGlvbiA9IHRoaXMuX2NvbGxlY3Rpb25zW3ByaW1pdGl2ZS5fekluZGV4XTtcbiAgcmV0dXJuIGRlZmluZWQoY29sbGVjdGlvbikgJiYgY29sbGVjdGlvbi5jb250YWlucyhwcmltaXRpdmUpO1xufTtcblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5PcmRlcmVkR3JvdW5kUHJpbWl0aXZlQ29sbGVjdGlvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGZyYW1lU3RhdGUpIHtcbiAgaWYgKCF0aGlzLnNob3cpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgY29sbGVjdGlvbnMgPSB0aGlzLl9jb2xsZWN0aW9uc0FycmF5O1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbGxlY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgY29sbGVjdGlvbnNbaV0udXBkYXRlKGZyYW1lU3RhdGUpO1xuICB9XG59O1xuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIG9iamVjdCB3YXMgZGVzdHJveWVkOyBvdGhlcndpc2UsIGZhbHNlLlxuICogPGJyIC8+PGJyIC8+XG4gKiBJZiB0aGlzIG9iamVjdCB3YXMgZGVzdHJveWVkLCBpdCBzaG91bGQgbm90IGJlIHVzZWQ7IGNhbGxpbmcgYW55IGZ1bmN0aW9uIG90aGVyIHRoYW5cbiAqIDxjb2RlPmlzRGVzdHJveWVkPC9jb2RlPiB3aWxsIHJlc3VsdCBpbiBhIHtAbGluayBEZXZlbG9wZXJFcnJvcn0gZXhjZXB0aW9uLlxuICpcbiAqIEByZXR1cm5zIHtCb29sZWFufSBUcnVlIGlmIHRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQ7IG90aGVyd2lzZSwgZmFsc2UuXG4gKlxuICogQHNlZSBPcmRlcmVkR3JvdW5kUHJpbWl0aXZlQ29sbGVjdGlvbiNkZXN0cm95XG4gKi9cbk9yZGVyZWRHcm91bmRQcmltaXRpdmVDb2xsZWN0aW9uLnByb3RvdHlwZS5pc0Rlc3Ryb3llZCA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuLyoqXG4gKiBEZXN0cm95cyB0aGUgV2ViR0wgcmVzb3VyY2VzIGhlbGQgYnkgZWFjaCBwcmltaXRpdmUgaW4gdGhpcyBjb2xsZWN0aW9uLiAgRXhwbGljaXRseSBkZXN0cm95aW5nIHRoaXNcbiAqIGNvbGxlY3Rpb24gYWxsb3dzIGZvciBkZXRlcm1pbmlzdGljIHJlbGVhc2Ugb2YgV2ViR0wgcmVzb3VyY2VzLCBpbnN0ZWFkIG9mIHJlbHlpbmcgb24gdGhlIGdhcmJhZ2VcbiAqIGNvbGxlY3RvciB0byBkZXN0cm95IHRoaXMgY29sbGVjdGlvbi5cbiAqIDxiciAvPjxiciAvPlxuICogU2luY2UgZGVzdHJveWluZyBhIGNvbGxlY3Rpb24gZGVzdHJveXMgYWxsIHRoZSBjb250YWluZWQgcHJpbWl0aXZlcywgb25seSBkZXN0cm95IGEgY29sbGVjdGlvblxuICogd2hlbiB5b3UgYXJlIHN1cmUgbm8gb3RoZXIgY29kZSBpcyBzdGlsbCB1c2luZyBhbnkgb2YgdGhlIGNvbnRhaW5lZCBwcmltaXRpdmVzLlxuICogPGJyIC8+PGJyIC8+XG4gKiBPbmNlIHRoaXMgY29sbGVjdGlvbiBpcyBkZXN0cm95ZWQsIGl0IHNob3VsZCBub3QgYmUgdXNlZDsgY2FsbGluZyBhbnkgZnVuY3Rpb24gb3RoZXIgdGhhblxuICogPGNvZGU+aXNEZXN0cm95ZWQ8L2NvZGU+IHdpbGwgcmVzdWx0IGluIGEge0BsaW5rIERldmVsb3BlckVycm9yfSBleGNlcHRpb24uICBUaGVyZWZvcmUsXG4gKiBhc3NpZ24gdGhlIHJldHVybiB2YWx1ZSAoPGNvZGU+dW5kZWZpbmVkPC9jb2RlPikgdG8gdGhlIG9iamVjdCBhcyBkb25lIGluIHRoZSBleGFtcGxlLlxuICpcbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSBUaGlzIG9iamVjdCB3YXMgZGVzdHJveWVkLCBpLmUuLCBkZXN0cm95KCkgd2FzIGNhbGxlZC5cbiAqXG4gKlxuICogQGV4YW1wbGVcbiAqIHByaW1pdGl2ZXMgPSBwcmltaXRpdmVzICYmIHByaW1pdGl2ZXMuZGVzdHJveSgpO1xuICpcbiAqIEBzZWUgT3JkZXJlZEdyb3VuZFByaW1pdGl2ZUNvbGxlY3Rpb24jaXNEZXN0cm95ZWRcbiAqL1xuT3JkZXJlZEdyb3VuZFByaW1pdGl2ZUNvbGxlY3Rpb24ucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMucmVtb3ZlQWxsKCk7XG4gIHJldHVybiBkZXN0cm95T2JqZWN0KHRoaXMpO1xufTtcbmV4cG9ydCBkZWZhdWx0IE9yZGVyZWRHcm91bmRQcmltaXRpdmVDb2xsZWN0aW9uO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///32073\n')},1629:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(60838);\n/* harmony import */ var _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(60216);\n/* harmony import */ var _Core_Color_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(59947);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(82982);\n\n\n\n\n\n\nvar defaultSize = new _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(1.0, 1.0);\n\n/**\n * A particle emitted by a {@link ParticleSystem}.\n *\n * @alias Particle\n * @constructor\n *\n * @param {Object} options An object with the following properties:\n * @param {Number} [options.mass=1.0] The mass of the particle in kilograms.\n * @param {Cartesian3} [options.position=Cartesian3.ZERO] The initial position of the particle in world coordinates.\n * @param {Cartesian3} [options.velocity=Cartesian3.ZERO] The velocity vector of the particle in world coordinates.\n * @param {Number} [options.life=Number.MAX_VALUE] The life of the particle in seconds.\n * @param {Object} [options.image] The URI, HTMLImageElement, or HTMLCanvasElement to use for the billboard.\n * @param {Color} [options.startColor=Color.WHITE] The color of a particle when it is born.\n * @param {Color} [options.endColor=Color.WHITE] The color of a particle when it dies.\n * @param {Number} [options.startScale=1.0] The scale of the particle when it is born.\n * @param {Number} [options.endScale=1.0] The scale of the particle when it dies.\n * @param {Cartesian2} [options.imageSize=new Cartesian2(1.0, 1.0)] The dimensions, width by height, to scale the particle image in pixels.\n */\nfunction Particle(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n\n  /**\n   * The mass of the particle in kilograms.\n   * @type {Number}\n   * @default 1.0\n   */\n  this.mass = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(options.mass, 1.0);\n  /**\n   * The positon of the particle in world coordinates.\n   * @type {Cartesian3}\n   * @default Cartesian3.ZERO\n   */\n  this.position = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].clone */ .Z.clone(\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(options.position, _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].ZERO */ .Z.ZERO)\n  );\n  /**\n   * The velocity of the particle in world coordinates.\n   * @type {Cartesian3}\n   * @default Cartesian3.ZERO\n   */\n  this.velocity = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].clone */ .Z.clone(\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(options.velocity, _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].ZERO */ .Z.ZERO)\n  );\n  /**\n   * The life of the particle in seconds.\n   * @type {Number}\n   * @default Number.MAX_VALUE\n   */\n  this.life = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(options.life, Number.MAX_VALUE);\n  /**\n   * The image to use for the particle.\n   * @type {Object}\n   * @default undefined\n   */\n  this.image = options.image;\n  /**\n   * The color of the particle when it is born.\n   * @type {Color}\n   * @default Color.WHITE\n   */\n  this.startColor = _Core_Color_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].clone */ .Z.clone((0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(options.startColor, _Core_Color_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].WHITE */ .Z.WHITE));\n  /**\n   * The color of the particle when it dies.\n   * @type {Color}\n   * @default Color.WHITE\n   */\n  this.endColor = _Core_Color_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].clone */ .Z.clone((0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(options.endColor, _Core_Color_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].WHITE */ .Z.WHITE));\n  /**\n   * the scale of the particle when it is born.\n   * @type {Number}\n   * @default 1.0\n   */\n  this.startScale = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(options.startScale, 1.0);\n  /**\n   * The scale of the particle when it dies.\n   * @type {Number}\n   * @default 1.0\n   */\n  this.endScale = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(options.endScale, 1.0);\n  /**\n   * The dimensions, width by height, to scale the particle image in pixels.\n   * @type {Cartesian2}\n   * @default new Cartesian(1.0, 1.0)\n   */\n  this.imageSize = _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone(\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(options.imageSize, defaultSize)\n  );\n\n  this._age = 0.0;\n  this._normalizedAge = 0.0;\n\n  // used by ParticleSystem\n  this._billboard = undefined;\n}\n\nObject.defineProperties(Particle.prototype, {\n  /**\n   * Gets the age of the particle in seconds.\n   * @memberof Particle.prototype\n   * @type {Number}\n   */\n  age: {\n    get: function () {\n      return this._age;\n    },\n  },\n  /**\n   * Gets the age normalized to a value in the range [0.0, 1.0].\n   * @memberof Particle.prototype\n   * @type {Number}\n   */\n  normalizedAge: {\n    get: function () {\n      return this._normalizedAge;\n    },\n  },\n});\n\nvar deltaScratch = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\n\n/**\n * @private\n */\nParticle.prototype.update = function (dt, particleUpdateFunction) {\n  // Apply the velocity\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].multiplyByScalar */ .Z.multiplyByScalar(this.velocity, dt, deltaScratch);\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].add */ .Z.add(this.position, deltaScratch, this.position);\n\n  // Update any forces.\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(particleUpdateFunction)) {\n    particleUpdateFunction(this, dt);\n  }\n\n  // Age the particle\n  this._age += dt;\n\n  // Compute the normalized age.\n  if (this.life === Number.MAX_VALUE) {\n    this._normalizedAge = 0.0;\n  } else {\n    this._normalizedAge = this._age / this.life;\n  }\n\n  // If this particle is older than it\'s lifespan then die.\n  return this._age <= this.life;\n};\n/* harmony default export */ __webpack_exports__["Z"] = (Particle);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTYyOS5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUErQztBQUNBO0FBQ1Y7QUFDYztBQUNWOztBQUV6QyxzQkFBc0Isb0VBQVU7O0FBRWhDO0FBQ0EsNEJBQTRCLHFCQUFxQjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLFFBQVE7QUFDbkIsV0FBVyxZQUFZO0FBQ3ZCLFdBQVcsWUFBWTtBQUN2QixXQUFXLFFBQVE7QUFDbkIsV0FBVyxRQUFRO0FBQ25CLFdBQVcsT0FBTztBQUNsQixXQUFXLE9BQU87QUFDbEIsV0FBVyxRQUFRO0FBQ25CLFdBQVcsUUFBUTtBQUNuQixXQUFXLFlBQVk7QUFDdkI7QUFDQTtBQUNBLFlBQVksMEVBQVksVUFBVSxnR0FBeUI7O0FBRTNEO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBLGNBQWMsMEVBQVk7QUFDMUI7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0Esa0JBQWtCLGdGQUFnQjtBQUNsQyxJQUFJLDBFQUFZLG1CQUFtQiw4RUFBZTtBQUNsRDtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBLGtCQUFrQixnRkFBZ0I7QUFDbEMsSUFBSSwwRUFBWSxtQkFBbUIsOEVBQWU7QUFDbEQ7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQSxjQUFjLDBFQUFZO0FBQzFCO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0Esb0JBQW9CLDJFQUFXLENBQUMsMEVBQVkscUJBQXFCLDJFQUFXO0FBQzVFO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBLGtCQUFrQiwyRUFBVyxDQUFDLDBFQUFZLG1CQUFtQiwyRUFBVztBQUN4RTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQSxvQkFBb0IsMEVBQVk7QUFDaEM7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0Esa0JBQWtCLDBFQUFZO0FBQzlCO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBLG1CQUFtQixnRkFBZ0I7QUFDbkMsSUFBSSwwRUFBWTtBQUNoQjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSCxDQUFDOztBQUVELHVCQUF1QixvRUFBVTs7QUFFakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUUsc0dBQTJCO0FBQzdCLEVBQUUsNEVBQWM7O0FBRWhCO0FBQ0EsTUFBTSxxRUFBTztBQUNiO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSx5REFBZSxRQUFRLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92dWUzLXdlYnBhY2s1Ly4vbm9kZV9tb2R1bGVzL2Nlc2l1bS9Tb3VyY2UvU2NlbmUvUGFydGljbGUuanM/ZWRkZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ2FydGVzaWFuMiBmcm9tIFwiLi4vQ29yZS9DYXJ0ZXNpYW4yLmpzXCI7XG5pbXBvcnQgQ2FydGVzaWFuMyBmcm9tIFwiLi4vQ29yZS9DYXJ0ZXNpYW4zLmpzXCI7XG5pbXBvcnQgQ29sb3IgZnJvbSBcIi4uL0NvcmUvQ29sb3IuanNcIjtcbmltcG9ydCBkZWZhdWx0VmFsdWUgZnJvbSBcIi4uL0NvcmUvZGVmYXVsdFZhbHVlLmpzXCI7XG5pbXBvcnQgZGVmaW5lZCBmcm9tIFwiLi4vQ29yZS9kZWZpbmVkLmpzXCI7XG5cbnZhciBkZWZhdWx0U2l6ZSA9IG5ldyBDYXJ0ZXNpYW4yKDEuMCwgMS4wKTtcblxuLyoqXG4gKiBBIHBhcnRpY2xlIGVtaXR0ZWQgYnkgYSB7QGxpbmsgUGFydGljbGVTeXN0ZW19LlxuICpcbiAqIEBhbGlhcyBQYXJ0aWNsZVxuICogQGNvbnN0cnVjdG9yXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgQW4gb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLm1hc3M9MS4wXSBUaGUgbWFzcyBvZiB0aGUgcGFydGljbGUgaW4ga2lsb2dyYW1zLlxuICogQHBhcmFtIHtDYXJ0ZXNpYW4zfSBbb3B0aW9ucy5wb3NpdGlvbj1DYXJ0ZXNpYW4zLlpFUk9dIFRoZSBpbml0aWFsIHBvc2l0aW9uIG9mIHRoZSBwYXJ0aWNsZSBpbiB3b3JsZCBjb29yZGluYXRlcy5cbiAqIEBwYXJhbSB7Q2FydGVzaWFuM30gW29wdGlvbnMudmVsb2NpdHk9Q2FydGVzaWFuMy5aRVJPXSBUaGUgdmVsb2NpdHkgdmVjdG9yIG9mIHRoZSBwYXJ0aWNsZSBpbiB3b3JsZCBjb29yZGluYXRlcy5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5saWZlPU51bWJlci5NQVhfVkFMVUVdIFRoZSBsaWZlIG9mIHRoZSBwYXJ0aWNsZSBpbiBzZWNvbmRzLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLmltYWdlXSBUaGUgVVJJLCBIVE1MSW1hZ2VFbGVtZW50LCBvciBIVE1MQ2FudmFzRWxlbWVudCB0byB1c2UgZm9yIHRoZSBiaWxsYm9hcmQuXG4gKiBAcGFyYW0ge0NvbG9yfSBbb3B0aW9ucy5zdGFydENvbG9yPUNvbG9yLldISVRFXSBUaGUgY29sb3Igb2YgYSBwYXJ0aWNsZSB3aGVuIGl0IGlzIGJvcm4uXG4gKiBAcGFyYW0ge0NvbG9yfSBbb3B0aW9ucy5lbmRDb2xvcj1Db2xvci5XSElURV0gVGhlIGNvbG9yIG9mIGEgcGFydGljbGUgd2hlbiBpdCBkaWVzLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLnN0YXJ0U2NhbGU9MS4wXSBUaGUgc2NhbGUgb2YgdGhlIHBhcnRpY2xlIHdoZW4gaXQgaXMgYm9ybi5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5lbmRTY2FsZT0xLjBdIFRoZSBzY2FsZSBvZiB0aGUgcGFydGljbGUgd2hlbiBpdCBkaWVzLlxuICogQHBhcmFtIHtDYXJ0ZXNpYW4yfSBbb3B0aW9ucy5pbWFnZVNpemU9bmV3IENhcnRlc2lhbjIoMS4wLCAxLjApXSBUaGUgZGltZW5zaW9ucywgd2lkdGggYnkgaGVpZ2h0LCB0byBzY2FsZSB0aGUgcGFydGljbGUgaW1hZ2UgaW4gcGl4ZWxzLlxuICovXG5mdW5jdGlvbiBQYXJ0aWNsZShvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBkZWZhdWx0VmFsdWUob3B0aW9ucywgZGVmYXVsdFZhbHVlLkVNUFRZX09CSkVDVCk7XG5cbiAgLyoqXG4gICAqIFRoZSBtYXNzIG9mIHRoZSBwYXJ0aWNsZSBpbiBraWxvZ3JhbXMuXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqIEBkZWZhdWx0IDEuMFxuICAgKi9cbiAgdGhpcy5tYXNzID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMubWFzcywgMS4wKTtcbiAgLyoqXG4gICAqIFRoZSBwb3NpdG9uIG9mIHRoZSBwYXJ0aWNsZSBpbiB3b3JsZCBjb29yZGluYXRlcy5cbiAgICogQHR5cGUge0NhcnRlc2lhbjN9XG4gICAqIEBkZWZhdWx0IENhcnRlc2lhbjMuWkVST1xuICAgKi9cbiAgdGhpcy5wb3NpdGlvbiA9IENhcnRlc2lhbjMuY2xvbmUoXG4gICAgZGVmYXVsdFZhbHVlKG9wdGlvbnMucG9zaXRpb24sIENhcnRlc2lhbjMuWkVSTylcbiAgKTtcbiAgLyoqXG4gICAqIFRoZSB2ZWxvY2l0eSBvZiB0aGUgcGFydGljbGUgaW4gd29ybGQgY29vcmRpbmF0ZXMuXG4gICAqIEB0eXBlIHtDYXJ0ZXNpYW4zfVxuICAgKiBAZGVmYXVsdCBDYXJ0ZXNpYW4zLlpFUk9cbiAgICovXG4gIHRoaXMudmVsb2NpdHkgPSBDYXJ0ZXNpYW4zLmNsb25lKFxuICAgIGRlZmF1bHRWYWx1ZShvcHRpb25zLnZlbG9jaXR5LCBDYXJ0ZXNpYW4zLlpFUk8pXG4gICk7XG4gIC8qKlxuICAgKiBUaGUgbGlmZSBvZiB0aGUgcGFydGljbGUgaW4gc2Vjb25kcy5cbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQGRlZmF1bHQgTnVtYmVyLk1BWF9WQUxVRVxuICAgKi9cbiAgdGhpcy5saWZlID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMubGlmZSwgTnVtYmVyLk1BWF9WQUxVRSk7XG4gIC8qKlxuICAgKiBUaGUgaW1hZ2UgdG8gdXNlIGZvciB0aGUgcGFydGljbGUuXG4gICAqIEB0eXBlIHtPYmplY3R9XG4gICAqIEBkZWZhdWx0IHVuZGVmaW5lZFxuICAgKi9cbiAgdGhpcy5pbWFnZSA9IG9wdGlvbnMuaW1hZ2U7XG4gIC8qKlxuICAgKiBUaGUgY29sb3Igb2YgdGhlIHBhcnRpY2xlIHdoZW4gaXQgaXMgYm9ybi5cbiAgICogQHR5cGUge0NvbG9yfVxuICAgKiBAZGVmYXVsdCBDb2xvci5XSElURVxuICAgKi9cbiAgdGhpcy5zdGFydENvbG9yID0gQ29sb3IuY2xvbmUoZGVmYXVsdFZhbHVlKG9wdGlvbnMuc3RhcnRDb2xvciwgQ29sb3IuV0hJVEUpKTtcbiAgLyoqXG4gICAqIFRoZSBjb2xvciBvZiB0aGUgcGFydGljbGUgd2hlbiBpdCBkaWVzLlxuICAgKiBAdHlwZSB7Q29sb3J9XG4gICAqIEBkZWZhdWx0IENvbG9yLldISVRFXG4gICAqL1xuICB0aGlzLmVuZENvbG9yID0gQ29sb3IuY2xvbmUoZGVmYXVsdFZhbHVlKG9wdGlvbnMuZW5kQ29sb3IsIENvbG9yLldISVRFKSk7XG4gIC8qKlxuICAgKiB0aGUgc2NhbGUgb2YgdGhlIHBhcnRpY2xlIHdoZW4gaXQgaXMgYm9ybi5cbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQGRlZmF1bHQgMS4wXG4gICAqL1xuICB0aGlzLnN0YXJ0U2NhbGUgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5zdGFydFNjYWxlLCAxLjApO1xuICAvKipcbiAgICogVGhlIHNjYWxlIG9mIHRoZSBwYXJ0aWNsZSB3aGVuIGl0IGRpZXMuXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqIEBkZWZhdWx0IDEuMFxuICAgKi9cbiAgdGhpcy5lbmRTY2FsZSA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmVuZFNjYWxlLCAxLjApO1xuICAvKipcbiAgICogVGhlIGRpbWVuc2lvbnMsIHdpZHRoIGJ5IGhlaWdodCwgdG8gc2NhbGUgdGhlIHBhcnRpY2xlIGltYWdlIGluIHBpeGVscy5cbiAgICogQHR5cGUge0NhcnRlc2lhbjJ9XG4gICAqIEBkZWZhdWx0IG5ldyBDYXJ0ZXNpYW4oMS4wLCAxLjApXG4gICAqL1xuICB0aGlzLmltYWdlU2l6ZSA9IENhcnRlc2lhbjIuY2xvbmUoXG4gICAgZGVmYXVsdFZhbHVlKG9wdGlvbnMuaW1hZ2VTaXplLCBkZWZhdWx0U2l6ZSlcbiAgKTtcblxuICB0aGlzLl9hZ2UgPSAwLjA7XG4gIHRoaXMuX25vcm1hbGl6ZWRBZ2UgPSAwLjA7XG5cbiAgLy8gdXNlZCBieSBQYXJ0aWNsZVN5c3RlbVxuICB0aGlzLl9iaWxsYm9hcmQgPSB1bmRlZmluZWQ7XG59XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFBhcnRpY2xlLnByb3RvdHlwZSwge1xuICAvKipcbiAgICogR2V0cyB0aGUgYWdlIG9mIHRoZSBwYXJ0aWNsZSBpbiBzZWNvbmRzLlxuICAgKiBAbWVtYmVyb2YgUGFydGljbGUucHJvdG90eXBlXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqL1xuICBhZ2U6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9hZ2U7XG4gICAgfSxcbiAgfSxcbiAgLyoqXG4gICAqIEdldHMgdGhlIGFnZSBub3JtYWxpemVkIHRvIGEgdmFsdWUgaW4gdGhlIHJhbmdlIFswLjAsIDEuMF0uXG4gICAqIEBtZW1iZXJvZiBQYXJ0aWNsZS5wcm90b3R5cGVcbiAgICogQHR5cGUge051bWJlcn1cbiAgICovXG4gIG5vcm1hbGl6ZWRBZ2U6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9ub3JtYWxpemVkQWdlO1xuICAgIH0sXG4gIH0sXG59KTtcblxudmFyIGRlbHRhU2NyYXRjaCA9IG5ldyBDYXJ0ZXNpYW4zKCk7XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuUGFydGljbGUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChkdCwgcGFydGljbGVVcGRhdGVGdW5jdGlvbikge1xuICAvLyBBcHBseSB0aGUgdmVsb2NpdHlcbiAgQ2FydGVzaWFuMy5tdWx0aXBseUJ5U2NhbGFyKHRoaXMudmVsb2NpdHksIGR0LCBkZWx0YVNjcmF0Y2gpO1xuICBDYXJ0ZXNpYW4zLmFkZCh0aGlzLnBvc2l0aW9uLCBkZWx0YVNjcmF0Y2gsIHRoaXMucG9zaXRpb24pO1xuXG4gIC8vIFVwZGF0ZSBhbnkgZm9yY2VzLlxuICBpZiAoZGVmaW5lZChwYXJ0aWNsZVVwZGF0ZUZ1bmN0aW9uKSkge1xuICAgIHBhcnRpY2xlVXBkYXRlRnVuY3Rpb24odGhpcywgZHQpO1xuICB9XG5cbiAgLy8gQWdlIHRoZSBwYXJ0aWNsZVxuICB0aGlzLl9hZ2UgKz0gZHQ7XG5cbiAgLy8gQ29tcHV0ZSB0aGUgbm9ybWFsaXplZCBhZ2UuXG4gIGlmICh0aGlzLmxpZmUgPT09IE51bWJlci5NQVhfVkFMVUUpIHtcbiAgICB0aGlzLl9ub3JtYWxpemVkQWdlID0gMC4wO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuX25vcm1hbGl6ZWRBZ2UgPSB0aGlzLl9hZ2UgLyB0aGlzLmxpZmU7XG4gIH1cblxuICAvLyBJZiB0aGlzIHBhcnRpY2xlIGlzIG9sZGVyIHRoYW4gaXQncyBsaWZlc3BhbiB0aGVuIGRpZS5cbiAgcmV0dXJuIHRoaXMuX2FnZSA8PSB0aGlzLmxpZmU7XG59O1xuZXhwb3J0IGRlZmF1bHQgUGFydGljbGU7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///1629\n')},11992:function(__unused_webpack___webpack_module__,__unused_webpack___webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(62200);\n\n\n/**\n * Represents a burst of {@link Particle}s from a {@link ParticleSystem} at a given time in the systems lifetime.\n *\n * @alias ParticleBurst\n * @constructor\n *\n * @param {Object} [options] An object with the following properties:\n * @param {Number} [options.time=0.0] The time in seconds after the beginning of the particle system\'s lifetime that the burst will occur.\n * @param {Number} [options.minimum=0.0] The minimum number of particles emmitted in the burst.\n * @param {Number} [options.maximum=50.0] The maximum number of particles emitted in the burst.\n */\nfunction ParticleBurst(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n\n  /**\n   * The time in seconds after the beginning of the particle system\'s lifetime that the burst will occur.\n   * @type {Number}\n   * @default 0.0\n   */\n  this.time = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options.time, 0.0);\n  /**\n   * The minimum number of particles emitted.\n   * @type {Number}\n   * @default 0.0\n   */\n  this.minimum = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options.minimum, 0.0);\n  /**\n   * The maximum number of particles emitted.\n   * @type {Number}\n   * @default 50.0\n   */\n  this.maximum = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options.maximum, 50.0);\n\n  this._complete = false;\n}\n\nObject.defineProperties(ParticleBurst.prototype, {\n  /**\n   * <code>true</code> if the burst has been completed; <code>false</code> otherwise.\n   * @memberof ParticleBurst.prototype\n   * @type {Boolean}\n   */\n  complete: {\n    get: function () {\n      return this._complete;\n    },\n  },\n});\n/* unused harmony default export */ var __WEBPACK_DEFAULT_EXPORT__ = ((/* unused pure expression or super */ null && (ParticleBurst)));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTE5OTIuanMiLCJtYXBwaW5ncyI6IjtBQUFtRDs7QUFFbkQ7QUFDQSwwQkFBMEIsZUFBZSxVQUFVLHNCQUFzQjtBQUN6RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLFFBQVE7QUFDbkIsV0FBVyxRQUFRO0FBQ25CLFdBQVcsUUFBUTtBQUNuQjtBQUNBO0FBQ0EsWUFBWSwwRUFBWSxVQUFVLGdHQUF5Qjs7QUFFM0Q7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0EsY0FBYywwRUFBWTtBQUMxQjtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQSxpQkFBaUIsMEVBQVk7QUFDN0I7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0EsaUJBQWlCLDBFQUFZOztBQUU3QjtBQUNBOztBQUVBO0FBQ0E7QUFDQSx3REFBd0Q7QUFDeEQ7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNILENBQUM7QUFDRCxzRUFBZSw2REFBYSxJQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnVlMy13ZWJwYWNrNS8uL25vZGVfbW9kdWxlcy9jZXNpdW0vU291cmNlL1NjZW5lL1BhcnRpY2xlQnVyc3QuanM/OTg4NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZGVmYXVsdFZhbHVlIGZyb20gXCIuLi9Db3JlL2RlZmF1bHRWYWx1ZS5qc1wiO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgYSBidXJzdCBvZiB7QGxpbmsgUGFydGljbGV9cyBmcm9tIGEge0BsaW5rIFBhcnRpY2xlU3lzdGVtfSBhdCBhIGdpdmVuIHRpbWUgaW4gdGhlIHN5c3RlbXMgbGlmZXRpbWUuXG4gKlxuICogQGFsaWFzIFBhcnRpY2xlQnVyc3RcbiAqIEBjb25zdHJ1Y3RvclxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gQW4gb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLnRpbWU9MC4wXSBUaGUgdGltZSBpbiBzZWNvbmRzIGFmdGVyIHRoZSBiZWdpbm5pbmcgb2YgdGhlIHBhcnRpY2xlIHN5c3RlbSdzIGxpZmV0aW1lIHRoYXQgdGhlIGJ1cnN0IHdpbGwgb2NjdXIuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMubWluaW11bT0wLjBdIFRoZSBtaW5pbXVtIG51bWJlciBvZiBwYXJ0aWNsZXMgZW1taXR0ZWQgaW4gdGhlIGJ1cnN0LlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLm1heGltdW09NTAuMF0gVGhlIG1heGltdW0gbnVtYmVyIG9mIHBhcnRpY2xlcyBlbWl0dGVkIGluIHRoZSBidXJzdC5cbiAqL1xuZnVuY3Rpb24gUGFydGljbGVCdXJzdChvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBkZWZhdWx0VmFsdWUob3B0aW9ucywgZGVmYXVsdFZhbHVlLkVNUFRZX09CSkVDVCk7XG5cbiAgLyoqXG4gICAqIFRoZSB0aW1lIGluIHNlY29uZHMgYWZ0ZXIgdGhlIGJlZ2lubmluZyBvZiB0aGUgcGFydGljbGUgc3lzdGVtJ3MgbGlmZXRpbWUgdGhhdCB0aGUgYnVyc3Qgd2lsbCBvY2N1ci5cbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQGRlZmF1bHQgMC4wXG4gICAqL1xuICB0aGlzLnRpbWUgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy50aW1lLCAwLjApO1xuICAvKipcbiAgICogVGhlIG1pbmltdW0gbnVtYmVyIG9mIHBhcnRpY2xlcyBlbWl0dGVkLlxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKiBAZGVmYXVsdCAwLjBcbiAgICovXG4gIHRoaXMubWluaW11bSA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLm1pbmltdW0sIDAuMCk7XG4gIC8qKlxuICAgKiBUaGUgbWF4aW11bSBudW1iZXIgb2YgcGFydGljbGVzIGVtaXR0ZWQuXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqIEBkZWZhdWx0IDUwLjBcbiAgICovXG4gIHRoaXMubWF4aW11bSA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLm1heGltdW0sIDUwLjApO1xuXG4gIHRoaXMuX2NvbXBsZXRlID0gZmFsc2U7XG59XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFBhcnRpY2xlQnVyc3QucHJvdG90eXBlLCB7XG4gIC8qKlxuICAgKiA8Y29kZT50cnVlPC9jb2RlPiBpZiB0aGUgYnVyc3QgaGFzIGJlZW4gY29tcGxldGVkOyA8Y29kZT5mYWxzZTwvY29kZT4gb3RoZXJ3aXNlLlxuICAgKiBAbWVtYmVyb2YgUGFydGljbGVCdXJzdC5wcm90b3R5cGVcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqL1xuICBjb21wbGV0ZToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NvbXBsZXRlO1xuICAgIH0sXG4gIH0sXG59KTtcbmV4cG9ydCBkZWZhdWx0IFBhcnRpY2xlQnVyc3Q7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///11992\n')},90164:function(__unused_webpack___webpack_module__,__unused_webpack___webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(12572);\n\n\n/**\n * <p>\n * An object that initializes a {@link Particle} from a {@link ParticleSystem}.\n * </p>\n * <p>\n * This type describes an interface and is not intended to be instantiated directly.\n * </p>\n *\n * @alias ParticleEmitter\n * @constructor\n *\n * @see BoxEmitter\n * @see CircleEmitter\n * @see ConeEmitter\n * @see SphereEmitter\n */\nfunction ParticleEmitter(options) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(\n    "This type should not be instantiated directly.  Instead, use BoxEmitter, CircleEmitter, ConeEmitter or SphereEmitter."\n  );\n  //>>includeEnd(\'debug\');\n}\n\n/**\n * Initializes the given {Particle} by setting it\'s position and velocity.\n *\n * @private\n * @param {Particle} The particle to initialize\n */\nParticleEmitter.prototype.emit = function (particle) {\n  _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].throwInstantiationError */ .Z.throwInstantiationError();\n};\n/* unused harmony default export */ var __WEBPACK_DEFAULT_EXPORT__ = ((/* unused pure expression or super */ null && (ParticleEmitter)));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTAxNjQuanMiLCJtYXBwaW5ncyI6IjtBQUF1RDs7QUFFdkQ7QUFDQTtBQUNBLGlDQUFpQyxnQkFBZ0IsUUFBUSxxQkFBcUI7QUFDOUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx3RUFBYztBQUMxQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDBCQUEwQixVQUFVO0FBQ3BDO0FBQ0E7QUFDQSxXQUFXLFVBQVU7QUFDckI7QUFDQTtBQUNBLEVBQUUsd0hBQXNDO0FBQ3hDO0FBQ0Esc0VBQWUsK0RBQWUsSUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9TY2VuZS9QYXJ0aWNsZUVtaXR0ZXIuanM/NzQ1NyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgRGV2ZWxvcGVyRXJyb3IgZnJvbSBcIi4uL0NvcmUvRGV2ZWxvcGVyRXJyb3IuanNcIjtcblxuLyoqXG4gKiA8cD5cbiAqIEFuIG9iamVjdCB0aGF0IGluaXRpYWxpemVzIGEge0BsaW5rIFBhcnRpY2xlfSBmcm9tIGEge0BsaW5rIFBhcnRpY2xlU3lzdGVtfS5cbiAqIDwvcD5cbiAqIDxwPlxuICogVGhpcyB0eXBlIGRlc2NyaWJlcyBhbiBpbnRlcmZhY2UgYW5kIGlzIG5vdCBpbnRlbmRlZCB0byBiZSBpbnN0YW50aWF0ZWQgZGlyZWN0bHkuXG4gKiA8L3A+XG4gKlxuICogQGFsaWFzIFBhcnRpY2xlRW1pdHRlclxuICogQGNvbnN0cnVjdG9yXG4gKlxuICogQHNlZSBCb3hFbWl0dGVyXG4gKiBAc2VlIENpcmNsZUVtaXR0ZXJcbiAqIEBzZWUgQ29uZUVtaXR0ZXJcbiAqIEBzZWUgU3BoZXJlRW1pdHRlclxuICovXG5mdW5jdGlvbiBQYXJ0aWNsZUVtaXR0ZXIob3B0aW9ucykge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgXCJUaGlzIHR5cGUgc2hvdWxkIG5vdCBiZSBpbnN0YW50aWF0ZWQgZGlyZWN0bHkuICBJbnN0ZWFkLCB1c2UgQm94RW1pdHRlciwgQ2lyY2xlRW1pdHRlciwgQ29uZUVtaXR0ZXIgb3IgU3BoZXJlRW1pdHRlci5cIlxuICApO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcbn1cblxuLyoqXG4gKiBJbml0aWFsaXplcyB0aGUgZ2l2ZW4ge1BhcnRpY2xlfSBieSBzZXR0aW5nIGl0J3MgcG9zaXRpb24gYW5kIHZlbG9jaXR5LlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge1BhcnRpY2xlfSBUaGUgcGFydGljbGUgdG8gaW5pdGlhbGl6ZVxuICovXG5QYXJ0aWNsZUVtaXR0ZXIucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbiAocGFydGljbGUpIHtcbiAgRGV2ZWxvcGVyRXJyb3IudGhyb3dJbnN0YW50aWF0aW9uRXJyb3IoKTtcbn07XG5leHBvcnQgZGVmYXVsdCBQYXJ0aWNsZUVtaXR0ZXI7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///90164\n')},34992:function(__unused_webpack___webpack_module__,__unused_webpack___webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(60838);\n/* harmony import */ var _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(60216);\n/* harmony import */ var _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(66553);\n/* harmony import */ var _Core_Color_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(59947);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(82982);\n/* harmony import */ var _Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(86511);\n/* harmony import */ var _Core_Event_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(14459);\n/* harmony import */ var _Core_JulianDate_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(55293);\n/* harmony import */ var _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(99417);\n/* harmony import */ var _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(72248);\n/* harmony import */ var _BillboardCollection_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(8044);\n/* harmony import */ var _CircleEmitter_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(27377);\n/* harmony import */ var _Particle_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(1629);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar defaultImageSize = new _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(1.0, 1.0);\n\n/**\n * A ParticleSystem manages the updating and display of a collection of particles.\n *\n * @alias ParticleSystem\n * @constructor\n *\n * @param {Object} [options] Object with the following properties:\n * @param {Boolean} [options.show=true] Whether to display the particle system.\n * @param {ParticleSystem.updateCallback} [options.updateCallback] The callback function to be called each frame to update a particle.\n * @param {ParticleEmitter} [options.emitter=new CircleEmitter(0.5)] The particle emitter for this system.\n * @param {Matrix4} [options.modelMatrix=Matrix4.IDENTITY] The 4x4 transformation matrix that transforms the particle system from model to world coordinates.\n * @param {Matrix4} [options.emitterModelMatrix=Matrix4.IDENTITY] The 4x4 transformation matrix that transforms the particle system emitter within the particle systems local coordinate system.\n * @param {Number} [options.emissionRate=5] The number of particles to emit per second.\n * @param {ParticleBurst[]} [options.bursts] An array of {@link ParticleBurst}, emitting bursts of particles at periodic times.\n * @param {Boolean} [options.loop=true] Whether the particle system should loop its bursts when it is complete.\n * @param {Number} [options.scale=1.0] Sets the scale to apply to the image of the particle for the duration of its particleLife.\n * @param {Number} [options.startScale] The initial scale to apply to the image of the particle at the beginning of its life.\n * @param {Number} [options.endScale] The final scale to apply to the image of the particle at the end of its life.\n * @param {Color} [options.color=Color.WHITE] Sets the color of a particle for the duration of its particleLife.\n * @param {Color} [options.startColor] The color of the particle at the beginning of its life.\n * @param {Color} [options.endColor] The color of the particle at the end of its life.\n * @param {Object} [options.image] The URI, HTMLImageElement, or HTMLCanvasElement to use for the billboard.\n * @param {Cartesian2} [options.imageSize=new Cartesian2(1.0, 1.0)] If set, overrides the minimumImageSize and maximumImageSize inputs that scale the particle image\'s dimensions in pixels.\n * @param {Cartesian2} [options.minimumImageSize] Sets the minimum bound, width by height, above which to randomly scale the particle image\'s dimensions in pixels.\n * @param {Cartesian2} [options.maximumImageSize] Sets the maximum bound, width by height, below which to randomly scale the particle image\'s dimensions in pixels.\n * @param {Boolean} [options.sizeInMeters] Sets if the size of particles is in meters or pixels. <code>true</code> to size the particles in meters; otherwise, the size is in pixels.\n * @param {Number} [options.speed=1.0] If set, overrides the minimumSpeed and maximumSpeed inputs with this value.\n * @param {Number} [options.minimumSpeed] Sets the minimum bound in meters per second above which a particle\'s actual speed will be randomly chosen.\n * @param {Number} [options.maximumSpeed] Sets the maximum bound in meters per second below which a particle\'s actual speed will be randomly chosen.\n * @param {Number} [options.lifetime=Number.MAX_VALUE] How long the particle system will emit particles, in seconds.\n * @param {Number} [options.particleLife=5.0] If set, overrides the minimumParticleLife and maximumParticleLife inputs with this value.\n * @param {Number} [options.minimumParticleLife] Sets the minimum bound in seconds for the possible duration of a particle\'s life above which a particle\'s actual life will be randomly chosen.\n * @param {Number} [options.maximumParticleLife] Sets the maximum bound in seconds for the possible duration of a particle\'s life below which a particle\'s actual life will be randomly chosen.\n * @param {Number} [options.mass=1.0] Sets the minimum and maximum mass of particles in kilograms.\n * @param {Number} [options.minimumMass] Sets the minimum bound for the mass of a particle in kilograms. A particle\'s actual mass will be chosen as a random amount above this value.\n * @param {Number} [options.maximumMass] Sets the maximum mass of particles in kilograms. A particle\'s actual mass will be chosen as a random amount below this value.\n * @demo {@link https://cesium.com/learn/cesiumjs-learn/cesiumjs-particle-systems/|Particle Systems Tutorial}\n * @demo {@link https://sandcastle.cesium.com/?src=Particle%20System.html&label=Showcases|Particle Systems Tutorial Demo}\n * @demo {@link https://sandcastle.cesium.com/?src=Particle%20System%20Fireworks.html&label=Showcases|Particle Systems Fireworks Demo}\n */\nfunction ParticleSystem(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n\n  /**\n   * Whether to display the particle system.\n   * @type {Boolean}\n   * @default true\n   */\n  this.show = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.show, true);\n\n  /**\n   * An array of force callbacks. The callback is passed a {@link Particle} and the difference from the last time\n   * @type {ParticleSystem.updateCallback}\n   * @default undefined\n   */\n  this.updateCallback = options.updateCallback;\n\n  /**\n   * Whether the particle system should loop it\'s bursts when it is complete.\n   * @type {Boolean}\n   * @default true\n   */\n  this.loop = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.loop, true);\n\n  /**\n   * The URI, HTMLImageElement, or HTMLCanvasElement to use for the billboard.\n   * @type {Object}\n   * @default undefined\n   */\n  this.image = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.image, undefined);\n\n  var emitter = options.emitter;\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z)(emitter)) {\n    emitter = new _CircleEmitter_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z(0.5);\n  }\n  this._emitter = emitter;\n\n  this._bursts = options.bursts;\n\n  this._modelMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].clone */ .Z.clone(\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.modelMatrix, _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].IDENTITY */ .Z.IDENTITY)\n  );\n  this._emitterModelMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].clone */ .Z.clone(\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.emitterModelMatrix, _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].IDENTITY */ .Z.IDENTITY)\n  );\n  this._matrixDirty = true;\n  this._combinedMatrix = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z();\n\n  this._startColor = _Core_Color_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].clone */ .Z.clone(\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.color, (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.startColor, _Core_Color_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].WHITE */ .Z.WHITE))\n  );\n  this._endColor = _Core_Color_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].clone */ .Z.clone(\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.color, (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.endColor, _Core_Color_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].WHITE */ .Z.WHITE))\n  );\n\n  this._startScale = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(\n    options.scale,\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.startScale, 1.0)\n  );\n  this._endScale = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(\n    options.scale,\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.endScale, 1.0)\n  );\n\n  this._emissionRate = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.emissionRate, 5.0);\n\n  this._minimumSpeed = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(\n    options.speed,\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.minimumSpeed, 1.0)\n  );\n  this._maximumSpeed = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(\n    options.speed,\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.maximumSpeed, 1.0)\n  );\n\n  this._minimumParticleLife = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(\n    options.particleLife,\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.minimumParticleLife, 5.0)\n  );\n  this._maximumParticleLife = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(\n    options.particleLife,\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.maximumParticleLife, 5.0)\n  );\n\n  this._minimumMass = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(\n    options.mass,\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.minimumMass, 1.0)\n  );\n  this._maximumMass = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(\n    options.mass,\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.maximumMass, 1.0)\n  );\n\n  this._minimumImageSize = _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone(\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(\n      options.imageSize,\n      (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.minimumImageSize, defaultImageSize)\n    )\n  );\n  this._maximumImageSize = _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone(\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(\n      options.imageSize,\n      (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.maximumImageSize, defaultImageSize)\n    )\n  );\n\n  this._sizeInMeters = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.sizeInMeters, false);\n\n  this._lifetime = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.lifetime, Number.MAX_VALUE);\n\n  this._billboardCollection = undefined;\n  this._particles = [];\n\n  // An array of available particles that we can reuse instead of allocating new.\n  this._particlePool = [];\n\n  this._previousTime = undefined;\n  this._currentTime = 0.0;\n  this._carryOver = 0.0;\n\n  this._complete = new _Core_Event_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z();\n  this._isComplete = false;\n\n  this._updateParticlePool = true;\n  this._particleEstimate = 0;\n}\n\nObject.defineProperties(ParticleSystem.prototype, {\n  /**\n   * The particle emitter for this\n   * @memberof ParticleSystem.prototype\n   * @type {ParticleEmitter}\n   * @default CircleEmitter\n   */\n  emitter: {\n    get: function () {\n      return this._emitter;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].defined */ .Z.defined("value", value);\n      //>>includeEnd(\'debug\');\n      this._emitter = value;\n    },\n  },\n  /**\n   * An array of {@link ParticleBurst}, emitting bursts of particles at periodic times.\n   * @memberof ParticleSystem.prototype\n   * @type {ParticleBurst[]}\n   * @default undefined\n   */\n  bursts: {\n    get: function () {\n      return this._bursts;\n    },\n    set: function (value) {\n      this._bursts = value;\n      this._updateParticlePool = true;\n    },\n  },\n  /**\n   * The 4x4 transformation matrix that transforms the particle system from model to world coordinates.\n   * @memberof ParticleSystem.prototype\n   * @type {Matrix4}\n   * @default Matrix4.IDENTITY\n   */\n  modelMatrix: {\n    get: function () {\n      return this._modelMatrix;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].defined */ .Z.defined("value", value);\n      //>>includeEnd(\'debug\');\n      this._matrixDirty =\n        this._matrixDirty || !_Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].equals */ .Z.equals(this._modelMatrix, value);\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].clone */ .Z.clone(value, this._modelMatrix);\n    },\n  },\n  /**\n   * The 4x4 transformation matrix that transforms the particle system emitter within the particle systems local coordinate system.\n   * @memberof ParticleSystem.prototype\n   * @type {Matrix4}\n   * @default Matrix4.IDENTITY\n   */\n  emitterModelMatrix: {\n    get: function () {\n      return this._emitterModelMatrix;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].defined */ .Z.defined("value", value);\n      //>>includeEnd(\'debug\');\n      this._matrixDirty =\n        this._matrixDirty || !_Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].equals */ .Z.equals(this._emitterModelMatrix, value);\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].clone */ .Z.clone(value, this._emitterModelMatrix);\n    },\n  },\n  /**\n   * The color of the particle at the beginning of its life.\n   * @memberof ParticleSystem.prototype\n   * @type {Color}\n   * @default Color.WHITE\n   */\n  startColor: {\n    get: function () {\n      return this._startColor;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].defined */ .Z.defined("value", value);\n      //>>includeEnd(\'debug\');\n      _Core_Color_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].clone */ .Z.clone(value, this._startColor);\n    },\n  },\n  /**\n   * The color of the particle at the end of its life.\n   * @memberof ParticleSystem.prototype\n   * @type {Color}\n   * @default Color.WHITE\n   */\n  endColor: {\n    get: function () {\n      return this._endColor;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].defined */ .Z.defined("value", value);\n      //>>includeEnd(\'debug\');\n      _Core_Color_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].clone */ .Z.clone(value, this._endColor);\n    },\n  },\n  /**\n   * The initial scale to apply to the image of the particle at the beginning of its life.\n   * @memberof ParticleSystem.prototype\n   * @type {Number}\n   * @default 1.0\n   */\n  startScale: {\n    get: function () {\n      return this._startScale;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals("value", value, 0.0);\n      //>>includeEnd(\'debug\');\n      this._startScale = value;\n    },\n  },\n  /**\n   * The final scale to apply to the image of the particle at the end of its life.\n   * @memberof ParticleSystem.prototype\n   * @type {Number}\n   * @default 1.0\n   */\n  endScale: {\n    get: function () {\n      return this._endScale;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals("value", value, 0.0);\n      //>>includeEnd(\'debug\');\n      this._endScale = value;\n    },\n  },\n  /**\n   * The number of particles to emit per second.\n   * @memberof ParticleSystem.prototype\n   * @type {Number}\n   * @default 5\n   */\n  emissionRate: {\n    get: function () {\n      return this._emissionRate;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals("value", value, 0.0);\n      //>>includeEnd(\'debug\');\n      this._emissionRate = value;\n      this._updateParticlePool = true;\n    },\n  },\n  /**\n   * Sets the minimum bound in meters per second above which a particle\'s actual speed will be randomly chosen.\n   * @memberof ParticleSystem.prototype\n   * @type {Number}\n   * @default 1.0\n   */\n  minimumSpeed: {\n    get: function () {\n      return this._minimumSpeed;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals("value", value, 0.0);\n      //>>includeEnd(\'debug\');\n      this._minimumSpeed = value;\n    },\n  },\n  /**\n   * Sets the maximum bound in meters per second below which a particle\'s actual speed will be randomly chosen.\n   * @memberof ParticleSystem.prototype\n   * @type {Number}\n   * @default 1.0\n   */\n  maximumSpeed: {\n    get: function () {\n      return this._maximumSpeed;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals("value", value, 0.0);\n      //>>includeEnd(\'debug\');\n      this._maximumSpeed = value;\n    },\n  },\n  /**\n   * Sets the minimum bound in seconds for the possible duration of a particle\'s life above which a particle\'s actual life will be randomly chosen.\n   * @memberof ParticleSystem.prototype\n   * @type {Number}\n   * @default 5.0\n   */\n  minimumParticleLife: {\n    get: function () {\n      return this._minimumParticleLife;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals("value", value, 0.0);\n      //>>includeEnd(\'debug\');\n      this._minimumParticleLife = value;\n    },\n  },\n  /**\n   * Sets the maximum bound in seconds for the possible duration of a particle\'s life below which a particle\'s actual life will be randomly chosen.\n   * @memberof ParticleSystem.prototype\n   * @type {Number}\n   * @default 5.0\n   */\n  maximumParticleLife: {\n    get: function () {\n      return this._maximumParticleLife;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals("value", value, 0.0);\n      //>>includeEnd(\'debug\');\n      this._maximumParticleLife = value;\n      this._updateParticlePool = true;\n    },\n  },\n  /**\n   * Sets the minimum mass of particles in kilograms.\n   * @memberof ParticleSystem.prototype\n   * @type {Number}\n   * @default 1.0\n   */\n  minimumMass: {\n    get: function () {\n      return this._minimumMass;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals("value", value, 0.0);\n      //>>includeEnd(\'debug\');\n      this._minimumMass = value;\n    },\n  },\n  /**\n   * Sets the maximum mass of particles in kilograms.\n   * @memberof ParticleSystem.prototype\n   * @type {Number}\n   * @default 1.0\n   */\n  maximumMass: {\n    get: function () {\n      return this._maximumMass;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals("value", value, 0.0);\n      //>>includeEnd(\'debug\');\n      this._maximumMass = value;\n    },\n  },\n  /**\n   * Sets the minimum bound, width by height, above which to randomly scale the particle image\'s dimensions in pixels.\n   * @memberof ParticleSystem.prototype\n   * @type {Cartesian2}\n   * @default new Cartesian2(1.0, 1.0)\n   */\n  minimumImageSize: {\n    get: function () {\n      return this._minimumImageSize;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.object */ .Z.typeOf.object("value", value);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals("value.x", value.x, 0.0);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals("value.y", value.y, 0.0);\n      //>>includeEnd(\'debug\');\n      this._minimumImageSize = value;\n    },\n  },\n  /**\n   * Sets the maximum bound, width by height, below which to randomly scale the particle image\'s dimensions in pixels.\n   * @memberof ParticleSystem.prototype\n   * @type {Cartesian2}\n   * @default new Cartesian2(1.0, 1.0)\n   */\n  maximumImageSize: {\n    get: function () {\n      return this._maximumImageSize;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.object */ .Z.typeOf.object("value", value);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals("value.x", value.x, 0.0);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals("value.y", value.y, 0.0);\n      //>>includeEnd(\'debug\');\n      this._maximumImageSize = value;\n    },\n  },\n  /**\n   * Gets or sets if the particle size is in meters or pixels. <code>true</code> to size particles in meters; otherwise, the size is in pixels.\n   * @memberof ParticleSystem.prototype\n   * @type {Boolean}\n   * @default false\n   */\n  sizeInMeters: {\n    get: function () {\n      return this._sizeInMeters;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.bool */ .Z.typeOf.bool("value", value);\n      //>>includeEnd(\'debug\');\n      this._sizeInMeters = value;\n    },\n  },\n  /**\n   * How long the particle system will emit particles, in seconds.\n   * @memberof ParticleSystem.prototype\n   * @type {Number}\n   * @default Number.MAX_VALUE\n   */\n  lifetime: {\n    get: function () {\n      return this._lifetime;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals("value", value, 0.0);\n      //>>includeEnd(\'debug\');\n      this._lifetime = value;\n    },\n  },\n  /**\n   * Fires an event when the particle system has reached the end of its lifetime.\n   * @memberof ParticleSystem.prototype\n   * @type {Event}\n   */\n  complete: {\n    get: function () {\n      return this._complete;\n    },\n  },\n  /**\n   * When <code>true</code>, the particle system has reached the end of its lifetime; <code>false</code> otherwise.\n   * @memberof ParticleSystem.prototype\n   * @type {Boolean}\n   */\n  isComplete: {\n    get: function () {\n      return this._isComplete;\n    },\n  },\n});\n\nfunction updateParticlePool(system) {\n  var emissionRate = system._emissionRate;\n  var life = system._maximumParticleLife;\n\n  var burstAmount = 0;\n  var bursts = system._bursts;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z)(bursts)) {\n    var length = bursts.length;\n    for (var i = 0; i < length; ++i) {\n      burstAmount += bursts[i].maximum;\n    }\n  }\n\n  var billboardCollection = system._billboardCollection;\n  var image = system.image;\n\n  var particleEstimate = Math.ceil(emissionRate * life + burstAmount);\n  var particles = system._particles;\n  var particlePool = system._particlePool;\n  var numToAdd = Math.max(\n    particleEstimate - particles.length - particlePool.length,\n    0\n  );\n\n  for (var j = 0; j < numToAdd; ++j) {\n    var particle = new _Particle_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z();\n    particle._billboard = billboardCollection.add({\n      image: image,\n    });\n    particlePool.push(particle);\n  }\n\n  system._particleEstimate = particleEstimate;\n}\n\nfunction getOrCreateParticle(system) {\n  // Try to reuse an existing particle from the pool.\n  var particle = system._particlePool.pop();\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z)(particle)) {\n    // Create a new one\n    particle = new _Particle_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z();\n  }\n  return particle;\n}\n\nfunction addParticleToPool(system, particle) {\n  system._particlePool.push(particle);\n}\n\nfunction freeParticlePool(system) {\n  var particles = system._particles;\n  var particlePool = system._particlePool;\n  var billboardCollection = system._billboardCollection;\n\n  var numParticles = particles.length;\n  var numInPool = particlePool.length;\n  var estimate = system._particleEstimate;\n\n  var start = numInPool - Math.max(estimate - numParticles - numInPool, 0);\n  for (var i = start; i < numInPool; ++i) {\n    var p = particlePool[i];\n    billboardCollection.remove(p._billboard);\n  }\n  particlePool.length = start;\n}\n\nfunction removeBillboard(particle) {\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z)(particle._billboard)) {\n    particle._billboard.show = false;\n  }\n}\n\nfunction updateBillboard(system, particle) {\n  var billboard = particle._billboard;\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z)(billboard)) {\n    billboard = particle._billboard = system._billboardCollection.add({\n      image: particle.image,\n    });\n  }\n  billboard.width = particle.imageSize.x;\n  billboard.height = particle.imageSize.y;\n  billboard.position = particle.position;\n  billboard.sizeInMeters = system.sizeInMeters;\n  billboard.show = true;\n\n  // Update the color\n  var r = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].lerp */ .Z.lerp(\n    particle.startColor.red,\n    particle.endColor.red,\n    particle.normalizedAge\n  );\n  var g = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].lerp */ .Z.lerp(\n    particle.startColor.green,\n    particle.endColor.green,\n    particle.normalizedAge\n  );\n  var b = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].lerp */ .Z.lerp(\n    particle.startColor.blue,\n    particle.endColor.blue,\n    particle.normalizedAge\n  );\n  var a = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].lerp */ .Z.lerp(\n    particle.startColor.alpha,\n    particle.endColor.alpha,\n    particle.normalizedAge\n  );\n  billboard.color = new _Core_Color_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z(r, g, b, a);\n\n  // Update the scale\n  billboard.scale = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].lerp */ .Z.lerp(\n    particle.startScale,\n    particle.endScale,\n    particle.normalizedAge\n  );\n}\n\nfunction addParticle(system, particle) {\n  particle.startColor = _Core_Color_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].clone */ .Z.clone(system._startColor, particle.startColor);\n  particle.endColor = _Core_Color_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].clone */ .Z.clone(system._endColor, particle.endColor);\n  particle.startScale = system._startScale;\n  particle.endScale = system._endScale;\n  particle.image = system.image;\n  particle.life = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].randomBetween */ .Z.randomBetween(\n    system._minimumParticleLife,\n    system._maximumParticleLife\n  );\n  particle.mass = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].randomBetween */ .Z.randomBetween(\n    system._minimumMass,\n    system._maximumMass\n  );\n  particle.imageSize.x = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].randomBetween */ .Z.randomBetween(\n    system._minimumImageSize.x,\n    system._maximumImageSize.x\n  );\n  particle.imageSize.y = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].randomBetween */ .Z.randomBetween(\n    system._minimumImageSize.y,\n    system._maximumImageSize.y\n  );\n\n  // Reset the normalizedAge and age in case the particle was reused.\n  particle._normalizedAge = 0.0;\n  particle._age = 0.0;\n\n  var speed = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].randomBetween */ .Z.randomBetween(\n    system._minimumSpeed,\n    system._maximumSpeed\n  );\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].multiplyByScalar */ .Z.multiplyByScalar(particle.velocity, speed, particle.velocity);\n\n  system._particles.push(particle);\n}\n\nfunction calculateNumberToEmit(system, dt) {\n  // This emitter is finished if it exceeds it\'s lifetime.\n  if (system._isComplete) {\n    return 0;\n  }\n\n  dt = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].mod */ .Z.mod(dt, system._lifetime);\n\n  // Compute the number of particles to emit based on the emissionRate.\n  var v = dt * system._emissionRate;\n  var numToEmit = Math.floor(v);\n  system._carryOver += v - numToEmit;\n  if (system._carryOver > 1.0) {\n    numToEmit++;\n    system._carryOver -= 1.0;\n  }\n\n  // Apply any bursts\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z)(system.bursts)) {\n    var length = system.bursts.length;\n    for (var i = 0; i < length; i++) {\n      var burst = system.bursts[i];\n      var currentTime = system._currentTime;\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z)(burst) && !burst._complete && currentTime > burst.time) {\n        numToEmit += _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].randomBetween */ .Z.randomBetween(burst.minimum, burst.maximum);\n        burst._complete = true;\n      }\n    }\n  }\n\n  return numToEmit;\n}\n\nvar rotatedVelocityScratch = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\n\n/**\n * @private\n */\nParticleSystem.prototype.update = function (frameState) {\n  if (!this.show) {\n    return;\n  }\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z)(this._billboardCollection)) {\n    this._billboardCollection = new _BillboardCollection_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z();\n  }\n\n  if (this._updateParticlePool) {\n    updateParticlePool(this);\n    this._updateParticlePool = false;\n  }\n\n  // Compute the frame time\n  var dt = 0.0;\n  if (this._previousTime) {\n    dt = _Core_JulianDate_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].secondsDifference */ .Z.secondsDifference(frameState.time, this._previousTime);\n  }\n\n  if (dt < 0.0) {\n    dt = 0.0;\n  }\n\n  var particles = this._particles;\n  var emitter = this._emitter;\n  var updateCallback = this.updateCallback;\n\n  var i;\n  var particle;\n\n  // update particles and remove dead particles\n  var length = particles.length;\n  for (i = 0; i < length; ++i) {\n    particle = particles[i];\n    if (!particle.update(dt, updateCallback)) {\n      removeBillboard(particle);\n      // Add the particle back to the pool so it can be reused.\n      addParticleToPool(this, particle);\n      particles[i] = particles[length - 1];\n      --i;\n      --length;\n    } else {\n      updateBillboard(this, particle);\n    }\n  }\n  particles.length = length;\n\n  var numToEmit = calculateNumberToEmit(this, dt);\n\n  if (numToEmit > 0 && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z)(emitter)) {\n    // Compute the final model matrix by combining the particle systems model matrix and the emitter matrix.\n    if (this._matrixDirty) {\n      this._combinedMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].multiply */ .Z.multiply(\n        this.modelMatrix,\n        this.emitterModelMatrix,\n        this._combinedMatrix\n      );\n      this._matrixDirty = false;\n    }\n\n    var combinedMatrix = this._combinedMatrix;\n\n    for (i = 0; i < numToEmit; i++) {\n      // Create a new particle.\n      particle = getOrCreateParticle(this);\n\n      // Let the emitter initialize the particle.\n      this._emitter.emit(particle);\n\n      //For the velocity we need to add it to the original position and then multiply by point.\n      _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].add */ .Z.add(\n        particle.position,\n        particle.velocity,\n        rotatedVelocityScratch\n      );\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].multiplyByPoint */ .Z.multiplyByPoint(\n        combinedMatrix,\n        rotatedVelocityScratch,\n        rotatedVelocityScratch\n      );\n\n      // Change the position to be in world coordinates\n      particle.position = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].multiplyByPoint */ .Z.multiplyByPoint(\n        combinedMatrix,\n        particle.position,\n        particle.position\n      );\n\n      // Orient the velocity in world space as well.\n      _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].subtract */ .Z.subtract(\n        rotatedVelocityScratch,\n        particle.position,\n        particle.velocity\n      );\n      _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].normalize */ .Z.normalize(particle.velocity, particle.velocity);\n\n      // Add the particle to the system.\n      addParticle(this, particle);\n      updateBillboard(this, particle);\n    }\n  }\n\n  this._billboardCollection.update(frameState);\n  this._previousTime = _Core_JulianDate_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].clone */ .Z.clone(frameState.time, this._previousTime);\n  this._currentTime += dt;\n\n  if (\n    this._lifetime !== Number.MAX_VALUE &&\n    this._currentTime > this._lifetime\n  ) {\n    if (this.loop) {\n      this._currentTime = _Core_Math_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].mod */ .Z.mod(this._currentTime, this._lifetime);\n      if (this.bursts) {\n        var burstLength = this.bursts.length;\n        // Reset any bursts\n        for (i = 0; i < burstLength; i++) {\n          this.bursts[i]._complete = false;\n        }\n      }\n    } else {\n      this._isComplete = true;\n      this._complete.raiseEvent(this);\n    }\n  }\n\n  // free particles in the pool and release billboard GPU memory\n  if (frameState.frameNumber % 120 === 0) {\n    freeParticlePool(this);\n  }\n};\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <br /><br />\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n *\n * @returns {Boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n *\n * @see ParticleSystem#destroy\n */\nParticleSystem.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the WebGL resources held by this object.  Destroying an object allows for deterministic\n * release of WebGL resources, instead of relying on the garbage collector to destroy this object.\n * <br /><br />\n * Once an object is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n * @see ParticleSystem#isDestroyed\n */\nParticleSystem.prototype.destroy = function () {\n  this._billboardCollection =\n    this._billboardCollection && this._billboardCollection.destroy();\n  return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(this);\n};\n\n/**\n * A function used to modify attributes of the particle at each time step. This can include force modifications,\n * color, sizing, etc.\n *\n * @callback ParticleSystem.updateCallback\n *\n * @param {Particle} particle The particle being updated.\n * @param {Number} dt The time in seconds since the last update.\n *\n * @example\n * function applyGravity(particle, dt) {\n *    var position = particle.position;\n *    var gravityVector = Cesium.Cartesian3.normalize(position, new Cesium.Cartesian3());\n *    Cesium.Cartesian3.multiplyByScalar(gravityVector, GRAVITATIONAL_CONSTANT * dt, gravityVector);\n *    particle.velocity = Cesium.Cartesian3.add(particle.velocity, gravityVector, particle.velocity);\n * }\n */\n/* unused harmony default export */ var __WEBPACK_DEFAULT_EXPORT__ = ((/* unused pure expression or super */ null && (ParticleSystem)));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0E7QUFDQSxNQUFNLHdGQUFvQjs7QUFFMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHVCQUF1QixnRkFBZ0I7QUFDdkM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixzRUFBYztBQUN4QztBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsaUJBQWlCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsOENBQThDO0FBQzlDO0FBQ0Esd0RBQXdEO0FBQ3hELDhDQUE4QyxzQkFBc0I7QUFDcEU7QUFDQSxhQUFhLFNBQVMsZ0RBQWdEO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RDtBQUN2RCw4Q0FBOEMsc0JBQXNCO0FBQ3BFO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLDJFQUFhO0FBQ3RCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsVUFBVTtBQUNyQixXQUFXLFFBQVE7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0VBQWUsOERBQWMsSUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9TY2VuZS9QYXJ0aWNsZVN5c3RlbS5qcz9lMWE2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDYXJ0ZXNpYW4yIGZyb20gXCIuLi9Db3JlL0NhcnRlc2lhbjIuanNcIjtcbmltcG9ydCBDYXJ0ZXNpYW4zIGZyb20gXCIuLi9Db3JlL0NhcnRlc2lhbjMuanNcIjtcbmltcG9ydCBDaGVjayBmcm9tIFwiLi4vQ29yZS9DaGVjay5qc1wiO1xuaW1wb3J0IENvbG9yIGZyb20gXCIuLi9Db3JlL0NvbG9yLmpzXCI7XG5pbXBvcnQgZGVmYXVsdFZhbHVlIGZyb20gXCIuLi9Db3JlL2RlZmF1bHRWYWx1ZS5qc1wiO1xuaW1wb3J0IGRlZmluZWQgZnJvbSBcIi4uL0NvcmUvZGVmaW5lZC5qc1wiO1xuaW1wb3J0IGRlc3Ryb3lPYmplY3QgZnJvbSBcIi4uL0NvcmUvZGVzdHJveU9iamVjdC5qc1wiO1xuaW1wb3J0IEV2ZW50IGZyb20gXCIuLi9Db3JlL0V2ZW50LmpzXCI7XG5pbXBvcnQgSnVsaWFuRGF0ZSBmcm9tIFwiLi4vQ29yZS9KdWxpYW5EYXRlLmpzXCI7XG5pbXBvcnQgQ2VzaXVtTWF0aCBmcm9tIFwiLi4vQ29yZS9NYXRoLmpzXCI7XG5pbXBvcnQgTWF0cml4NCBmcm9tIFwiLi4vQ29yZS9NYXRyaXg0LmpzXCI7XG5pbXBvcnQgQmlsbGJvYXJkQ29sbGVjdGlvbiBmcm9tIFwiLi9CaWxsYm9hcmRDb2xsZWN0aW9uLmpzXCI7XG5pbXBvcnQgQ2lyY2xlRW1pdHRlciBmcm9tIFwiLi9DaXJjbGVFbWl0dGVyLmpzXCI7XG5pbXBvcnQgUGFydGljbGUgZnJvbSBcIi4vUGFydGljbGUuanNcIjtcblxudmFyIGRlZmF1bHRJbWFnZVNpemUgPSBuZXcgQ2FydGVzaWFuMigxLjAsIDEuMCk7XG5cbi8qKlxuICogQSBQYXJ0aWNsZVN5c3RlbSBtYW5hZ2VzIHRoZSB1cGRhdGluZyBhbmQgZGlzcGxheSBvZiBhIGNvbGxlY3Rpb24gb2YgcGFydGljbGVzLlxuICpcbiAqIEBhbGlhcyBQYXJ0aWNsZVN5c3RlbVxuICogQGNvbnN0cnVjdG9yXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXSBPYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLnNob3c9dHJ1ZV0gV2hldGhlciB0byBkaXNwbGF5IHRoZSBwYXJ0aWNsZSBzeXN0ZW0uXG4gKiBAcGFyYW0ge1BhcnRpY2xlU3lzdGVtLnVwZGF0ZUNhbGxiYWNrfSBbb3B0aW9ucy51cGRhdGVDYWxsYmFja10gVGhlIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBlYWNoIGZyYW1lIHRvIHVwZGF0ZSBhIHBhcnRpY2xlLlxuICogQHBhcmFtIHtQYXJ0aWNsZUVtaXR0ZXJ9IFtvcHRpb25zLmVtaXR0ZXI9bmV3IENpcmNsZUVtaXR0ZXIoMC41KV0gVGhlIHBhcnRpY2xlIGVtaXR0ZXIgZm9yIHRoaXMgc3lzdGVtLlxuICogQHBhcmFtIHtNYXRyaXg0fSBbb3B0aW9ucy5tb2RlbE1hdHJpeD1NYXRyaXg0LklERU5USVRZXSBUaGUgNHg0IHRyYW5zZm9ybWF0aW9uIG1hdHJpeCB0aGF0IHRyYW5zZm9ybXMgdGhlIHBhcnRpY2xlIHN5c3RlbSBmcm9tIG1vZGVsIHRvIHdvcmxkIGNvb3JkaW5hdGVzLlxuICogQHBhcmFtIHtNYXRyaXg0fSBbb3B0aW9ucy5lbWl0dGVyTW9kZWxNYXRyaXg9TWF0cml4NC5JREVOVElUWV0gVGhlIDR4NCB0cmFuc2Zvcm1hdGlvbiBtYXRyaXggdGhhdCB0cmFuc2Zvcm1zIHRoZSBwYXJ0aWNsZSBzeXN0ZW0gZW1pdHRlciB3aXRoaW4gdGhlIHBhcnRpY2xlIHN5c3RlbXMgbG9jYWwgY29vcmRpbmF0ZSBzeXN0ZW0uXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMuZW1pc3Npb25SYXRlPTVdIFRoZSBudW1iZXIgb2YgcGFydGljbGVzIHRvIGVtaXQgcGVyIHNlY29uZC5cbiAqIEBwYXJhbSB7UGFydGljbGVCdXJzdFtdfSBbb3B0aW9ucy5idXJzdHNdIEFuIGFycmF5IG9mIHtAbGluayBQYXJ0aWNsZUJ1cnN0fSwgZW1pdHRpbmcgYnVyc3RzIG9mIHBhcnRpY2xlcyBhdCBwZXJpb2RpYyB0aW1lcy5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMubG9vcD10cnVlXSBXaGV0aGVyIHRoZSBwYXJ0aWNsZSBzeXN0ZW0gc2hvdWxkIGxvb3AgaXRzIGJ1cnN0cyB3aGVuIGl0IGlzIGNvbXBsZXRlLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLnNjYWxlPTEuMF0gU2V0cyB0aGUgc2NhbGUgdG8gYXBwbHkgdG8gdGhlIGltYWdlIG9mIHRoZSBwYXJ0aWNsZSBmb3IgdGhlIGR1cmF0aW9uIG9mIGl0cyBwYXJ0aWNsZUxpZmUuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMuc3RhcnRTY2FsZV0gVGhlIGluaXRpYWwgc2NhbGUgdG8gYXBwbHkgdG8gdGhlIGltYWdlIG9mIHRoZSBwYXJ0aWNsZSBhdCB0aGUgYmVnaW5uaW5nIG9mIGl0cyBsaWZlLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLmVuZFNjYWxlXSBUaGUgZmluYWwgc2NhbGUgdG8gYXBwbHkgdG8gdGhlIGltYWdlIG9mIHRoZSBwYXJ0aWNsZSBhdCB0aGUgZW5kIG9mIGl0cyBsaWZlLlxuICogQHBhcmFtIHtDb2xvcn0gW29wdGlvbnMuY29sb3I9Q29sb3IuV0hJVEVdIFNldHMgdGhlIGNvbG9yIG9mIGEgcGFydGljbGUgZm9yIHRoZSBkdXJhdGlvbiBvZiBpdHMgcGFydGljbGVMaWZlLlxuICogQHBhcmFtIHtDb2xvcn0gW29wdGlvbnMuc3RhcnRDb2xvcl0gVGhlIGNvbG9yIG9mIHRoZSBwYXJ0aWNsZSBhdCB0aGUgYmVnaW5uaW5nIG9mIGl0cyBsaWZlLlxuICogQHBhcmFtIHtDb2xvcn0gW29wdGlvbnMuZW5kQ29sb3JdIFRoZSBjb2xvciBvZiB0aGUgcGFydGljbGUgYXQgdGhlIGVuZCBvZiBpdHMgbGlmZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5pbWFnZV0gVGhlIFVSSSwgSFRNTEltYWdlRWxlbWVudCwgb3IgSFRNTENhbnZhc0VsZW1lbnQgdG8gdXNlIGZvciB0aGUgYmlsbGJvYXJkLlxuICogQHBhcmFtIHtDYXJ0ZXNpYW4yfSBbb3B0aW9ucy5pbWFnZVNpemU9bmV3IENhcnRlc2lhbjIoMS4wLCAxLjApXSBJZiBzZXQsIG92ZXJyaWRlcyB0aGUgbWluaW11bUltYWdlU2l6ZSBhbmQgbWF4aW11bUltYWdlU2l6ZSBpbnB1dHMgdGhhdCBzY2FsZSB0aGUgcGFydGljbGUgaW1hZ2UncyBkaW1lbnNpb25zIGluIHBpeGVscy5cbiAqIEBwYXJhbSB7Q2FydGVzaWFuMn0gW29wdGlvbnMubWluaW11bUltYWdlU2l6ZV0gU2V0cyB0aGUgbWluaW11bSBib3VuZCwgd2lkdGggYnkgaGVpZ2h0LCBhYm92ZSB3aGljaCB0byByYW5kb21seSBzY2FsZSB0aGUgcGFydGljbGUgaW1hZ2UncyBkaW1lbnNpb25zIGluIHBpeGVscy5cbiAqIEBwYXJhbSB7Q2FydGVzaWFuMn0gW29wdGlvbnMubWF4aW11bUltYWdlU2l6ZV0gU2V0cyB0aGUgbWF4aW11bSBib3VuZCwgd2lkdGggYnkgaGVpZ2h0LCBiZWxvdyB3aGljaCB0byByYW5kb21seSBzY2FsZSB0aGUgcGFydGljbGUgaW1hZ2UncyBkaW1lbnNpb25zIGluIHBpeGVscy5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuc2l6ZUluTWV0ZXJzXSBTZXRzIGlmIHRoZSBzaXplIG9mIHBhcnRpY2xlcyBpcyBpbiBtZXRlcnMgb3IgcGl4ZWxzLiA8Y29kZT50cnVlPC9jb2RlPiB0byBzaXplIHRoZSBwYXJ0aWNsZXMgaW4gbWV0ZXJzOyBvdGhlcndpc2UsIHRoZSBzaXplIGlzIGluIHBpeGVscy5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5zcGVlZD0xLjBdIElmIHNldCwgb3ZlcnJpZGVzIHRoZSBtaW5pbXVtU3BlZWQgYW5kIG1heGltdW1TcGVlZCBpbnB1dHMgd2l0aCB0aGlzIHZhbHVlLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLm1pbmltdW1TcGVlZF0gU2V0cyB0aGUgbWluaW11bSBib3VuZCBpbiBtZXRlcnMgcGVyIHNlY29uZCBhYm92ZSB3aGljaCBhIHBhcnRpY2xlJ3MgYWN0dWFsIHNwZWVkIHdpbGwgYmUgcmFuZG9tbHkgY2hvc2VuLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLm1heGltdW1TcGVlZF0gU2V0cyB0aGUgbWF4aW11bSBib3VuZCBpbiBtZXRlcnMgcGVyIHNlY29uZCBiZWxvdyB3aGljaCBhIHBhcnRpY2xlJ3MgYWN0dWFsIHNwZWVkIHdpbGwgYmUgcmFuZG9tbHkgY2hvc2VuLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLmxpZmV0aW1lPU51bWJlci5NQVhfVkFMVUVdIEhvdyBsb25nIHRoZSBwYXJ0aWNsZSBzeXN0ZW0gd2lsbCBlbWl0IHBhcnRpY2xlcywgaW4gc2Vjb25kcy5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5wYXJ0aWNsZUxpZmU9NS4wXSBJZiBzZXQsIG92ZXJyaWRlcyB0aGUgbWluaW11bVBhcnRpY2xlTGlmZSBhbmQgbWF4aW11bVBhcnRpY2xlTGlmZSBpbnB1dHMgd2l0aCB0aGlzIHZhbHVlLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLm1pbmltdW1QYXJ0aWNsZUxpZmVdIFNldHMgdGhlIG1pbmltdW0gYm91bmQgaW4gc2Vjb25kcyBmb3IgdGhlIHBvc3NpYmxlIGR1cmF0aW9uIG9mIGEgcGFydGljbGUncyBsaWZlIGFib3ZlIHdoaWNoIGEgcGFydGljbGUncyBhY3R1YWwgbGlmZSB3aWxsIGJlIHJhbmRvbWx5IGNob3Nlbi5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5tYXhpbXVtUGFydGljbGVMaWZlXSBTZXRzIHRoZSBtYXhpbXVtIGJvdW5kIGluIHNlY29uZHMgZm9yIHRoZSBwb3NzaWJsZSBkdXJhdGlvbiBvZiBhIHBhcnRpY2xlJ3MgbGlmZSBiZWxvdyB3aGljaCBhIHBhcnRpY2xlJ3MgYWN0dWFsIGxpZmUgd2lsbCBiZSByYW5kb21seSBjaG9zZW4uXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMubWFzcz0xLjBdIFNldHMgdGhlIG1pbmltdW0gYW5kIG1heGltdW0gbWFzcyBvZiBwYXJ0aWNsZXMgaW4ga2lsb2dyYW1zLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLm1pbmltdW1NYXNzXSBTZXRzIHRoZSBtaW5pbXVtIGJvdW5kIGZvciB0aGUgbWFzcyBvZiBhIHBhcnRpY2xlIGluIGtpbG9ncmFtcy4gQSBwYXJ0aWNsZSdzIGFjdHVhbCBtYXNzIHdpbGwgYmUgY2hvc2VuIGFzIGEgcmFuZG9tIGFtb3VudCBhYm92ZSB0aGlzIHZhbHVlLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLm1heGltdW1NYXNzXSBTZXRzIHRoZSBtYXhpbXVtIG1hc3Mgb2YgcGFydGljbGVzIGluIGtpbG9ncmFtcy4gQSBwYXJ0aWNsZSdzIGFjdHVhbCBtYXNzIHdpbGwgYmUgY2hvc2VuIGFzIGEgcmFuZG9tIGFtb3VudCBiZWxvdyB0aGlzIHZhbHVlLlxuICogQGRlbW8ge0BsaW5rIGh0dHBzOi8vY2VzaXVtLmNvbS9sZWFybi9jZXNpdW1qcy1sZWFybi9jZXNpdW1qcy1wYXJ0aWNsZS1zeXN0ZW1zL3xQYXJ0aWNsZSBTeXN0ZW1zIFR1dG9yaWFsfVxuICogQGRlbW8ge0BsaW5rIGh0dHBzOi8vc2FuZGNhc3RsZS5jZXNpdW0uY29tLz9zcmM9UGFydGljbGUlMjBTeXN0ZW0uaHRtbCZsYWJlbD1TaG93Y2FzZXN8UGFydGljbGUgU3lzdGVtcyBUdXRvcmlhbCBEZW1vfVxuICogQGRlbW8ge0BsaW5rIGh0dHBzOi8vc2FuZGNhc3RsZS5jZXNpdW0uY29tLz9zcmM9UGFydGljbGUlMjBTeXN0ZW0lMjBGaXJld29ya3MuaHRtbCZsYWJlbD1TaG93Y2FzZXN8UGFydGljbGUgU3lzdGVtcyBGaXJld29ya3MgRGVtb31cbiAqL1xuZnVuY3Rpb24gUGFydGljbGVTeXN0ZW0ob3B0aW9ucykge1xuICBvcHRpb25zID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMsIGRlZmF1bHRWYWx1ZS5FTVBUWV9PQkpFQ1QpO1xuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRvIGRpc3BsYXkgdGhlIHBhcnRpY2xlIHN5c3RlbS5cbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqIEBkZWZhdWx0IHRydWVcbiAgICovXG4gIHRoaXMuc2hvdyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLnNob3csIHRydWUpO1xuXG4gIC8qKlxuICAgKiBBbiBhcnJheSBvZiBmb3JjZSBjYWxsYmFja3MuIFRoZSBjYWxsYmFjayBpcyBwYXNzZWQgYSB7QGxpbmsgUGFydGljbGV9IGFuZCB0aGUgZGlmZmVyZW5jZSBmcm9tIHRoZSBsYXN0IHRpbWVcbiAgICogQHR5cGUge1BhcnRpY2xlU3lzdGVtLnVwZGF0ZUNhbGxiYWNrfVxuICAgKiBAZGVmYXVsdCB1bmRlZmluZWRcbiAgICovXG4gIHRoaXMudXBkYXRlQ2FsbGJhY2sgPSBvcHRpb25zLnVwZGF0ZUNhbGxiYWNrO1xuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoZSBwYXJ0aWNsZSBzeXN0ZW0gc2hvdWxkIGxvb3AgaXQncyBidXJzdHMgd2hlbiBpdCBpcyBjb21wbGV0ZS5cbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqIEBkZWZhdWx0IHRydWVcbiAgICovXG4gIHRoaXMubG9vcCA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmxvb3AsIHRydWUpO1xuXG4gIC8qKlxuICAgKiBUaGUgVVJJLCBIVE1MSW1hZ2VFbGVtZW50LCBvciBIVE1MQ2FudmFzRWxlbWVudCB0byB1c2UgZm9yIHRoZSBiaWxsYm9hcmQuXG4gICAqIEB0eXBlIHtPYmplY3R9XG4gICAqIEBkZWZhdWx0IHVuZGVmaW5lZFxuICAgKi9cbiAgdGhpcy5pbWFnZSA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmltYWdlLCB1bmRlZmluZWQpO1xuXG4gIHZhciBlbWl0dGVyID0gb3B0aW9ucy5lbWl0dGVyO1xuICBpZiAoIWRlZmluZWQoZW1pdHRlcikpIHtcbiAgICBlbWl0dGVyID0gbmV3IENpcmNsZUVtaXR0ZXIoMC41KTtcbiAgfVxuICB0aGlzLl9lbWl0dGVyID0gZW1pdHRlcjtcblxuICB0aGlzLl9idXJzdHMgPSBvcHRpb25zLmJ1cnN0cztcblxuICB0aGlzLl9tb2RlbE1hdHJpeCA9IE1hdHJpeDQuY2xvbmUoXG4gICAgZGVmYXVsdFZhbHVlKG9wdGlvbnMubW9kZWxNYXRyaXgsIE1hdHJpeDQuSURFTlRJVFkpXG4gICk7XG4gIHRoaXMuX2VtaXR0ZXJNb2RlbE1hdHJpeCA9IE1hdHJpeDQuY2xvbmUoXG4gICAgZGVmYXVsdFZhbHVlKG9wdGlvbnMuZW1pdHRlck1vZGVsTWF0cml4LCBNYXRyaXg0LklERU5USVRZKVxuICApO1xuICB0aGlzLl9tYXRyaXhEaXJ0eSA9IHRydWU7XG4gIHRoaXMuX2NvbWJpbmVkTWF0cml4ID0gbmV3IE1hdHJpeDQoKTtcblxuICB0aGlzLl9zdGFydENvbG9yID0gQ29sb3IuY2xvbmUoXG4gICAgZGVmYXVsdFZhbHVlKG9wdGlvbnMuY29sb3IsIGRlZmF1bHRWYWx1ZShvcHRpb25zLnN0YXJ0Q29sb3IsIENvbG9yLldISVRFKSlcbiAgKTtcbiAgdGhpcy5fZW5kQ29sb3IgPSBDb2xvci5jbG9uZShcbiAgICBkZWZhdWx0VmFsdWUob3B0aW9ucy5jb2xvciwgZGVmYXVsdFZhbHVlKG9wdGlvbnMuZW5kQ29sb3IsIENvbG9yLldISVRFKSlcbiAgKTtcblxuICB0aGlzLl9zdGFydFNjYWxlID0gZGVmYXVsdFZhbHVlKFxuICAgIG9wdGlvbnMuc2NhbGUsXG4gICAgZGVmYXVsdFZhbHVlKG9wdGlvbnMuc3RhcnRTY2FsZSwgMS4wKVxuICApO1xuICB0aGlzLl9lbmRTY2FsZSA9IGRlZmF1bHRWYWx1ZShcbiAgICBvcHRpb25zLnNjYWxlLFxuICAgIGRlZmF1bHRWYWx1ZShvcHRpb25zLmVuZFNjYWxlLCAxLjApXG4gICk7XG5cbiAgdGhpcy5fZW1pc3Npb25SYXRlID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuZW1pc3Npb25SYXRlLCA1LjApO1xuXG4gIHRoaXMuX21pbmltdW1TcGVlZCA9IGRlZmF1bHRWYWx1ZShcbiAgICBvcHRpb25zLnNwZWVkLFxuICAgIGRlZmF1bHRWYWx1ZShvcHRpb25zLm1pbmltdW1TcGVlZCwgMS4wKVxuICApO1xuICB0aGlzLl9tYXhpbXVtU3BlZWQgPSBkZWZhdWx0VmFsdWUoXG4gICAgb3B0aW9ucy5zcGVlZCxcbiAgICBkZWZhdWx0VmFsdWUob3B0aW9ucy5tYXhpbXVtU3BlZWQsIDEuMClcbiAgKTtcblxuICB0aGlzLl9taW5pbXVtUGFydGljbGVMaWZlID0gZGVmYXVsdFZhbHVlKFxuICAgIG9wdGlvbnMucGFydGljbGVMaWZlLFxuICAgIGRlZmF1bHRWYWx1ZShvcHRpb25zLm1pbmltdW1QYXJ0aWNsZUxpZmUsIDUuMClcbiAgKTtcbiAgdGhpcy5fbWF4aW11bVBhcnRpY2xlTGlmZSA9IGRlZmF1bHRWYWx1ZShcbiAgICBvcHRpb25zLnBhcnRpY2xlTGlmZSxcbiAgICBkZWZhdWx0VmFsdWUob3B0aW9ucy5tYXhpbXVtUGFydGljbGVMaWZlLCA1LjApXG4gICk7XG5cbiAgdGhpcy5fbWluaW11bU1hc3MgPSBkZWZhdWx0VmFsdWUoXG4gICAgb3B0aW9ucy5tYXNzLFxuICAgIGRlZmF1bHRWYWx1ZShvcHRpb25zLm1pbmltdW1NYXNzLCAxLjApXG4gICk7XG4gIHRoaXMuX21heGltdW1NYXNzID0gZGVmYXVsdFZhbHVlKFxuICAgIG9wdGlvbnMubWFzcyxcbiAgICBkZWZhdWx0VmFsdWUob3B0aW9ucy5tYXhpbXVtTWFzcywgMS4wKVxuICApO1xuXG4gIHRoaXMuX21pbmltdW1JbWFnZVNpemUgPSBDYXJ0ZXNpYW4yLmNsb25lKFxuICAgIGRlZmF1bHRWYWx1ZShcbiAgICAgIG9wdGlvbnMuaW1hZ2VTaXplLFxuICAgICAgZGVmYXVsdFZhbHVlKG9wdGlvbnMubWluaW11bUltYWdlU2l6ZSwgZGVmYXVsdEltYWdlU2l6ZSlcbiAgICApXG4gICk7XG4gIHRoaXMuX21heGltdW1JbWFnZVNpemUgPSBDYXJ0ZXNpYW4yLmNsb25lKFxuICAgIGRlZmF1bHRWYWx1ZShcbiAgICAgIG9wdGlvbnMuaW1hZ2VTaXplLFxuICAgICAgZGVmYXVsdFZhbHVlKG9wdGlvbnMubWF4aW11bUltYWdlU2l6ZSwgZGVmYXVsdEltYWdlU2l6ZSlcbiAgICApXG4gICk7XG5cbiAgdGhpcy5fc2l6ZUluTWV0ZXJzID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuc2l6ZUluTWV0ZXJzLCBmYWxzZSk7XG5cbiAgdGhpcy5fbGlmZXRpbWUgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5saWZldGltZSwgTnVtYmVyLk1BWF9WQUxVRSk7XG5cbiAgdGhpcy5fYmlsbGJvYXJkQ29sbGVjdGlvbiA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fcGFydGljbGVzID0gW107XG5cbiAgLy8gQW4gYXJyYXkgb2YgYXZhaWxhYmxlIHBhcnRpY2xlcyB0aGF0IHdlIGNhbiByZXVzZSBpbnN0ZWFkIG9mIGFsbG9jYXRpbmcgbmV3LlxuICB0aGlzLl9wYXJ0aWNsZVBvb2wgPSBbXTtcblxuICB0aGlzLl9wcmV2aW91c1RpbWUgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2N1cnJlbnRUaW1lID0gMC4wO1xuICB0aGlzLl9jYXJyeU92ZXIgPSAwLjA7XG5cbiAgdGhpcy5fY29tcGxldGUgPSBuZXcgRXZlbnQoKTtcbiAgdGhpcy5faXNDb21wbGV0ZSA9IGZhbHNlO1xuXG4gIHRoaXMuX3VwZGF0ZVBhcnRpY2xlUG9vbCA9IHRydWU7XG4gIHRoaXMuX3BhcnRpY2xlRXN0aW1hdGUgPSAwO1xufVxuXG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhQYXJ0aWNsZVN5c3RlbS5wcm90b3R5cGUsIHtcbiAgLyoqXG4gICAqIFRoZSBwYXJ0aWNsZSBlbWl0dGVyIGZvciB0aGlzXG4gICAqIEBtZW1iZXJvZiBQYXJ0aWNsZVN5c3RlbS5wcm90b3R5cGVcbiAgICogQHR5cGUge1BhcnRpY2xlRW1pdHRlcn1cbiAgICogQGRlZmF1bHQgQ2lyY2xlRW1pdHRlclxuICAgKi9cbiAgZW1pdHRlcjoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2VtaXR0ZXI7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgICAgIENoZWNrLmRlZmluZWQoXCJ2YWx1ZVwiLCB2YWx1ZSk7XG4gICAgICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcbiAgICAgIHRoaXMuX2VtaXR0ZXIgPSB2YWx1ZTtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogQW4gYXJyYXkgb2Yge0BsaW5rIFBhcnRpY2xlQnVyc3R9LCBlbWl0dGluZyBidXJzdHMgb2YgcGFydGljbGVzIGF0IHBlcmlvZGljIHRpbWVzLlxuICAgKiBAbWVtYmVyb2YgUGFydGljbGVTeXN0ZW0ucHJvdG90eXBlXG4gICAqIEB0eXBlIHtQYXJ0aWNsZUJ1cnN0W119XG4gICAqIEBkZWZhdWx0IHVuZGVmaW5lZFxuICAgKi9cbiAgYnVyc3RzOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fYnVyc3RzO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHRoaXMuX2J1cnN0cyA9IHZhbHVlO1xuICAgICAgdGhpcy5fdXBkYXRlUGFydGljbGVQb29sID0gdHJ1ZTtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogVGhlIDR4NCB0cmFuc2Zvcm1hdGlvbiBtYXRyaXggdGhhdCB0cmFuc2Zvcm1zIHRoZSBwYXJ0aWNsZSBzeXN0ZW0gZnJvbSBtb2RlbCB0byB3b3JsZCBjb29yZGluYXRlcy5cbiAgICogQG1lbWJlcm9mIFBhcnRpY2xlU3lzdGVtLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7TWF0cml4NH1cbiAgICogQGRlZmF1bHQgTWF0cml4NC5JREVOVElUWVxuICAgKi9cbiAgbW9kZWxNYXRyaXg6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9tb2RlbE1hdHJpeDtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICAgICAgQ2hlY2suZGVmaW5lZChcInZhbHVlXCIsIHZhbHVlKTtcbiAgICAgIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuICAgICAgdGhpcy5fbWF0cml4RGlydHkgPVxuICAgICAgICB0aGlzLl9tYXRyaXhEaXJ0eSB8fCAhTWF0cml4NC5lcXVhbHModGhpcy5fbW9kZWxNYXRyaXgsIHZhbHVlKTtcbiAgICAgIE1hdHJpeDQuY2xvbmUodmFsdWUsIHRoaXMuX21vZGVsTWF0cml4KTtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogVGhlIDR4NCB0cmFuc2Zvcm1hdGlvbiBtYXRyaXggdGhhdCB0cmFuc2Zvcm1zIHRoZSBwYXJ0aWNsZSBzeXN0ZW0gZW1pdHRlciB3aXRoaW4gdGhlIHBhcnRpY2xlIHN5c3RlbXMgbG9jYWwgY29vcmRpbmF0ZSBzeXN0ZW0uXG4gICAqIEBtZW1iZXJvZiBQYXJ0aWNsZVN5c3RlbS5wcm90b3R5cGVcbiAgICogQHR5cGUge01hdHJpeDR9XG4gICAqIEBkZWZhdWx0IE1hdHJpeDQuSURFTlRJVFlcbiAgICovXG4gIGVtaXR0ZXJNb2RlbE1hdHJpeDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2VtaXR0ZXJNb2RlbE1hdHJpeDtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICAgICAgQ2hlY2suZGVmaW5lZChcInZhbHVlXCIsIHZhbHVlKTtcbiAgICAgIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuICAgICAgdGhpcy5fbWF0cml4RGlydHkgPVxuICAgICAgICB0aGlzLl9tYXRyaXhEaXJ0eSB8fCAhTWF0cml4NC5lcXVhbHModGhpcy5fZW1pdHRlck1vZGVsTWF0cml4LCB2YWx1ZSk7XG4gICAgICBNYXRyaXg0LmNsb25lKHZhbHVlLCB0aGlzLl9lbWl0dGVyTW9kZWxNYXRyaXgpO1xuICAgIH0sXG4gIH0sXG4gIC8qKlxuICAgKiBUaGUgY29sb3Igb2YgdGhlIHBhcnRpY2xlIGF0IHRoZSBiZWdpbm5pbmcgb2YgaXRzIGxpZmUuXG4gICAqIEBtZW1iZXJvZiBQYXJ0aWNsZVN5c3RlbS5wcm90b3R5cGVcbiAgICogQHR5cGUge0NvbG9yfVxuICAgKiBAZGVmYXVsdCBDb2xvci5XSElURVxuICAgKi9cbiAgc3RhcnRDb2xvcjoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3N0YXJ0Q29sb3I7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgICAgIENoZWNrLmRlZmluZWQoXCJ2YWx1ZVwiLCB2YWx1ZSk7XG4gICAgICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcbiAgICAgIENvbG9yLmNsb25lKHZhbHVlLCB0aGlzLl9zdGFydENvbG9yKTtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogVGhlIGNvbG9yIG9mIHRoZSBwYXJ0aWNsZSBhdCB0aGUgZW5kIG9mIGl0cyBsaWZlLlxuICAgKiBAbWVtYmVyb2YgUGFydGljbGVTeXN0ZW0ucHJvdG90eXBlXG4gICAqIEB0eXBlIHtDb2xvcn1cbiAgICogQGRlZmF1bHQgQ29sb3IuV0hJVEVcbiAgICovXG4gIGVuZENvbG9yOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZW5kQ29sb3I7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgICAgIENoZWNrLmRlZmluZWQoXCJ2YWx1ZVwiLCB2YWx1ZSk7XG4gICAgICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcbiAgICAgIENvbG9yLmNsb25lKHZhbHVlLCB0aGlzLl9lbmRDb2xvcik7XG4gICAgfSxcbiAgfSxcbiAgLyoqXG4gICAqIFRoZSBpbml0aWFsIHNjYWxlIHRvIGFwcGx5IHRvIHRoZSBpbWFnZSBvZiB0aGUgcGFydGljbGUgYXQgdGhlIGJlZ2lubmluZyBvZiBpdHMgbGlmZS5cbiAgICogQG1lbWJlcm9mIFBhcnRpY2xlU3lzdGVtLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKiBAZGVmYXVsdCAxLjBcbiAgICovXG4gIHN0YXJ0U2NhbGU6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zdGFydFNjYWxlO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gICAgICBDaGVjay50eXBlT2YubnVtYmVyLmdyZWF0ZXJUaGFuT3JFcXVhbHMoXCJ2YWx1ZVwiLCB2YWx1ZSwgMC4wKTtcbiAgICAgIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuICAgICAgdGhpcy5fc3RhcnRTY2FsZSA9IHZhbHVlO1xuICAgIH0sXG4gIH0sXG4gIC8qKlxuICAgKiBUaGUgZmluYWwgc2NhbGUgdG8gYXBwbHkgdG8gdGhlIGltYWdlIG9mIHRoZSBwYXJ0aWNsZSBhdCB0aGUgZW5kIG9mIGl0cyBsaWZlLlxuICAgKiBAbWVtYmVyb2YgUGFydGljbGVTeXN0ZW0ucHJvdG90eXBlXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqIEBkZWZhdWx0IDEuMFxuICAgKi9cbiAgZW5kU2NhbGU6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9lbmRTY2FsZTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICAgICAgQ2hlY2sudHlwZU9mLm51bWJlci5ncmVhdGVyVGhhbk9yRXF1YWxzKFwidmFsdWVcIiwgdmFsdWUsIDAuMCk7XG4gICAgICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcbiAgICAgIHRoaXMuX2VuZFNjYWxlID0gdmFsdWU7XG4gICAgfSxcbiAgfSxcbiAgLyoqXG4gICAqIFRoZSBudW1iZXIgb2YgcGFydGljbGVzIHRvIGVtaXQgcGVyIHNlY29uZC5cbiAgICogQG1lbWJlcm9mIFBhcnRpY2xlU3lzdGVtLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKiBAZGVmYXVsdCA1XG4gICAqL1xuICBlbWlzc2lvblJhdGU6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9lbWlzc2lvblJhdGU7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgICAgIENoZWNrLnR5cGVPZi5udW1iZXIuZ3JlYXRlclRoYW5PckVxdWFscyhcInZhbHVlXCIsIHZhbHVlLCAwLjApO1xuICAgICAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG4gICAgICB0aGlzLl9lbWlzc2lvblJhdGUgPSB2YWx1ZTtcbiAgICAgIHRoaXMuX3VwZGF0ZVBhcnRpY2xlUG9vbCA9IHRydWU7XG4gICAgfSxcbiAgfSxcbiAgLyoqXG4gICAqIFNldHMgdGhlIG1pbmltdW0gYm91bmQgaW4gbWV0ZXJzIHBlciBzZWNvbmQgYWJvdmUgd2hpY2ggYSBwYXJ0aWNsZSdzIGFjdHVhbCBzcGVlZCB3aWxsIGJlIHJhbmRvbWx5IGNob3Nlbi5cbiAgICogQG1lbWJlcm9mIFBhcnRpY2xlU3lzdGVtLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKiBAZGVmYXVsdCAxLjBcbiAgICovXG4gIG1pbmltdW1TcGVlZDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX21pbmltdW1TcGVlZDtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICAgICAgQ2hlY2sudHlwZU9mLm51bWJlci5ncmVhdGVyVGhhbk9yRXF1YWxzKFwidmFsdWVcIiwgdmFsdWUsIDAuMCk7XG4gICAgICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcbiAgICAgIHRoaXMuX21pbmltdW1TcGVlZCA9IHZhbHVlO1xuICAgIH0sXG4gIH0sXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBtYXhpbXVtIGJvdW5kIGluIG1ldGVycyBwZXIgc2Vjb25kIGJlbG93IHdoaWNoIGEgcGFydGljbGUncyBhY3R1YWwgc3BlZWQgd2lsbCBiZSByYW5kb21seSBjaG9zZW4uXG4gICAqIEBtZW1iZXJvZiBQYXJ0aWNsZVN5c3RlbS5wcm90b3R5cGVcbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQGRlZmF1bHQgMS4wXG4gICAqL1xuICBtYXhpbXVtU3BlZWQ6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9tYXhpbXVtU3BlZWQ7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgICAgIENoZWNrLnR5cGVPZi5udW1iZXIuZ3JlYXRlclRoYW5PckVxdWFscyhcInZhbHVlXCIsIHZhbHVlLCAwLjApO1xuICAgICAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG4gICAgICB0aGlzLl9tYXhpbXVtU3BlZWQgPSB2YWx1ZTtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogU2V0cyB0aGUgbWluaW11bSBib3VuZCBpbiBzZWNvbmRzIGZvciB0aGUgcG9zc2libGUgZHVyYXRpb24gb2YgYSBwYXJ0aWNsZSdzIGxpZmUgYWJvdmUgd2hpY2ggYSBwYXJ0aWNsZSdzIGFjdHVhbCBsaWZlIHdpbGwgYmUgcmFuZG9tbHkgY2hvc2VuLlxuICAgKiBAbWVtYmVyb2YgUGFydGljbGVTeXN0ZW0ucHJvdG90eXBlXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqIEBkZWZhdWx0IDUuMFxuICAgKi9cbiAgbWluaW11bVBhcnRpY2xlTGlmZToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX21pbmltdW1QYXJ0aWNsZUxpZmU7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgICAgIENoZWNrLnR5cGVPZi5udW1iZXIuZ3JlYXRlclRoYW5PckVxdWFscyhcInZhbHVlXCIsIHZhbHVlLCAwLjApO1xuICAgICAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG4gICAgICB0aGlzLl9taW5pbXVtUGFydGljbGVMaWZlID0gdmFsdWU7XG4gICAgfSxcbiAgfSxcbiAgLyoqXG4gICAqIFNldHMgdGhlIG1heGltdW0gYm91bmQgaW4gc2Vjb25kcyBmb3IgdGhlIHBvc3NpYmxlIGR1cmF0aW9uIG9mIGEgcGFydGljbGUncyBsaWZlIGJlbG93IHdoaWNoIGEgcGFydGljbGUncyBhY3R1YWwgbGlmZSB3aWxsIGJlIHJhbmRvbWx5IGNob3Nlbi5cbiAgICogQG1lbWJlcm9mIFBhcnRpY2xlU3lzdGVtLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKiBAZGVmYXVsdCA1LjBcbiAgICovXG4gIG1heGltdW1QYXJ0aWNsZUxpZmU6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9tYXhpbXVtUGFydGljbGVMaWZlO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gICAgICBDaGVjay50eXBlT2YubnVtYmVyLmdyZWF0ZXJUaGFuT3JFcXVhbHMoXCJ2YWx1ZVwiLCB2YWx1ZSwgMC4wKTtcbiAgICAgIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuICAgICAgdGhpcy5fbWF4aW11bVBhcnRpY2xlTGlmZSA9IHZhbHVlO1xuICAgICAgdGhpcy5fdXBkYXRlUGFydGljbGVQb29sID0gdHJ1ZTtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogU2V0cyB0aGUgbWluaW11bSBtYXNzIG9mIHBhcnRpY2xlcyBpbiBraWxvZ3JhbXMuXG4gICAqIEBtZW1iZXJvZiBQYXJ0aWNsZVN5c3RlbS5wcm90b3R5cGVcbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQGRlZmF1bHQgMS4wXG4gICAqL1xuICBtaW5pbXVtTWFzczoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX21pbmltdW1NYXNzO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gICAgICBDaGVjay50eXBlT2YubnVtYmVyLmdyZWF0ZXJUaGFuT3JFcXVhbHMoXCJ2YWx1ZVwiLCB2YWx1ZSwgMC4wKTtcbiAgICAgIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuICAgICAgdGhpcy5fbWluaW11bU1hc3MgPSB2YWx1ZTtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogU2V0cyB0aGUgbWF4aW11bSBtYXNzIG9mIHBhcnRpY2xlcyBpbiBraWxvZ3JhbXMuXG4gICAqIEBtZW1iZXJvZiBQYXJ0aWNsZVN5c3RlbS5wcm90b3R5cGVcbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQGRlZmF1bHQgMS4wXG4gICAqL1xuICBtYXhpbXVtTWFzczoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX21heGltdW1NYXNzO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gICAgICBDaGVjay50eXBlT2YubnVtYmVyLmdyZWF0ZXJUaGFuT3JFcXVhbHMoXCJ2YWx1ZVwiLCB2YWx1ZSwgMC4wKTtcbiAgICAgIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuICAgICAgdGhpcy5fbWF4aW11bU1hc3MgPSB2YWx1ZTtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogU2V0cyB0aGUgbWluaW11bSBib3VuZCwgd2lkdGggYnkgaGVpZ2h0LCBhYm92ZSB3aGljaCB0byByYW5kb21seSBzY2FsZSB0aGUgcGFydGljbGUgaW1hZ2UncyBkaW1lbnNpb25zIGluIHBpeGVscy5cbiAgICogQG1lbWJlcm9mIFBhcnRpY2xlU3lzdGVtLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7Q2FydGVzaWFuMn1cbiAgICogQGRlZmF1bHQgbmV3IENhcnRlc2lhbjIoMS4wLCAxLjApXG4gICAqL1xuICBtaW5pbXVtSW1hZ2VTaXplOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbWluaW11bUltYWdlU2l6ZTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICAgICAgQ2hlY2sudHlwZU9mLm9iamVjdChcInZhbHVlXCIsIHZhbHVlKTtcbiAgICAgIENoZWNrLnR5cGVPZi5udW1iZXIuZ3JlYXRlclRoYW5PckVxdWFscyhcInZhbHVlLnhcIiwgdmFsdWUueCwgMC4wKTtcbiAgICAgIENoZWNrLnR5cGVPZi5udW1iZXIuZ3JlYXRlclRoYW5PckVxdWFscyhcInZhbHVlLnlcIiwgdmFsdWUueSwgMC4wKTtcbiAgICAgIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuICAgICAgdGhpcy5fbWluaW11bUltYWdlU2l6ZSA9IHZhbHVlO1xuICAgIH0sXG4gIH0sXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBtYXhpbXVtIGJvdW5kLCB3aWR0aCBieSBoZWlnaHQsIGJlbG93IHdoaWNoIHRvIHJhbmRvbWx5IHNjYWxlIHRoZSBwYXJ0aWNsZSBpbWFnZSdzIGRpbWVuc2lvbnMgaW4gcGl4ZWxzLlxuICAgKiBAbWVtYmVyb2YgUGFydGljbGVTeXN0ZW0ucHJvdG90eXBlXG4gICAqIEB0eXBlIHtDYXJ0ZXNpYW4yfVxuICAgKiBAZGVmYXVsdCBuZXcgQ2FydGVzaWFuMigxLjAsIDEuMClcbiAgICovXG4gIG1heGltdW1JbWFnZVNpemU6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9tYXhpbXVtSW1hZ2VTaXplO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gICAgICBDaGVjay50eXBlT2Yub2JqZWN0KFwidmFsdWVcIiwgdmFsdWUpO1xuICAgICAgQ2hlY2sudHlwZU9mLm51bWJlci5ncmVhdGVyVGhhbk9yRXF1YWxzKFwidmFsdWUueFwiLCB2YWx1ZS54LCAwLjApO1xuICAgICAgQ2hlY2sudHlwZU9mLm51bWJlci5ncmVhdGVyVGhhbk9yRXF1YWxzKFwidmFsdWUueVwiLCB2YWx1ZS55LCAwLjApO1xuICAgICAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG4gICAgICB0aGlzLl9tYXhpbXVtSW1hZ2VTaXplID0gdmFsdWU7XG4gICAgfSxcbiAgfSxcbiAgLyoqXG4gICAqIEdldHMgb3Igc2V0cyBpZiB0aGUgcGFydGljbGUgc2l6ZSBpcyBpbiBtZXRlcnMgb3IgcGl4ZWxzLiA8Y29kZT50cnVlPC9jb2RlPiB0byBzaXplIHBhcnRpY2xlcyBpbiBtZXRlcnM7IG90aGVyd2lzZSwgdGhlIHNpemUgaXMgaW4gcGl4ZWxzLlxuICAgKiBAbWVtYmVyb2YgUGFydGljbGVTeXN0ZW0ucHJvdG90eXBlXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgKi9cbiAgc2l6ZUluTWV0ZXJzOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2l6ZUluTWV0ZXJzO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gICAgICBDaGVjay50eXBlT2YuYm9vbChcInZhbHVlXCIsIHZhbHVlKTtcbiAgICAgIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuICAgICAgdGhpcy5fc2l6ZUluTWV0ZXJzID0gdmFsdWU7XG4gICAgfSxcbiAgfSxcbiAgLyoqXG4gICAqIEhvdyBsb25nIHRoZSBwYXJ0aWNsZSBzeXN0ZW0gd2lsbCBlbWl0IHBhcnRpY2xlcywgaW4gc2Vjb25kcy5cbiAgICogQG1lbWJlcm9mIFBhcnRpY2xlU3lzdGVtLnByb3RvdHlwZVxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKiBAZGVmYXVsdCBOdW1iZXIuTUFYX1ZBTFVFXG4gICAqL1xuICBsaWZldGltZToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2xpZmV0aW1lO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gICAgICBDaGVjay50eXBlT2YubnVtYmVyLmdyZWF0ZXJUaGFuT3JFcXVhbHMoXCJ2YWx1ZVwiLCB2YWx1ZSwgMC4wKTtcbiAgICAgIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuICAgICAgdGhpcy5fbGlmZXRpbWUgPSB2YWx1ZTtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogRmlyZXMgYW4gZXZlbnQgd2hlbiB0aGUgcGFydGljbGUgc3lzdGVtIGhhcyByZWFjaGVkIHRoZSBlbmQgb2YgaXRzIGxpZmV0aW1lLlxuICAgKiBAbWVtYmVyb2YgUGFydGljbGVTeXN0ZW0ucHJvdG90eXBlXG4gICAqIEB0eXBlIHtFdmVudH1cbiAgICovXG4gIGNvbXBsZXRlOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fY29tcGxldGU7XG4gICAgfSxcbiAgfSxcbiAgLyoqXG4gICAqIFdoZW4gPGNvZGU+dHJ1ZTwvY29kZT4sIHRoZSBwYXJ0aWNsZSBzeXN0ZW0gaGFzIHJlYWNoZWQgdGhlIGVuZCBvZiBpdHMgbGlmZXRpbWU7IDxjb2RlPmZhbHNlPC9jb2RlPiBvdGhlcndpc2UuXG4gICAqIEBtZW1iZXJvZiBQYXJ0aWNsZVN5c3RlbS5wcm90b3R5cGVcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqL1xuICBpc0NvbXBsZXRlOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5faXNDb21wbGV0ZTtcbiAgICB9LFxuICB9LFxufSk7XG5cbmZ1bmN0aW9uIHVwZGF0ZVBhcnRpY2xlUG9vbChzeXN0ZW0pIHtcbiAgdmFyIGVtaXNzaW9uUmF0ZSA9IHN5c3RlbS5fZW1pc3Npb25SYXRlO1xuICB2YXIgbGlmZSA9IHN5c3RlbS5fbWF4aW11bVBhcnRpY2xlTGlmZTtcblxuICB2YXIgYnVyc3RBbW91bnQgPSAwO1xuICB2YXIgYnVyc3RzID0gc3lzdGVtLl9idXJzdHM7XG4gIGlmIChkZWZpbmVkKGJ1cnN0cykpIHtcbiAgICB2YXIgbGVuZ3RoID0gYnVyc3RzLmxlbmd0aDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgICBidXJzdEFtb3VudCArPSBidXJzdHNbaV0ubWF4aW11bTtcbiAgICB9XG4gIH1cblxuICB2YXIgYmlsbGJvYXJkQ29sbGVjdGlvbiA9IHN5c3RlbS5fYmlsbGJvYXJkQ29sbGVjdGlvbjtcbiAgdmFyIGltYWdlID0gc3lzdGVtLmltYWdlO1xuXG4gIHZhciBwYXJ0aWNsZUVzdGltYXRlID0gTWF0aC5jZWlsKGVtaXNzaW9uUmF0ZSAqIGxpZmUgKyBidXJzdEFtb3VudCk7XG4gIHZhciBwYXJ0aWNsZXMgPSBzeXN0ZW0uX3BhcnRpY2xlcztcbiAgdmFyIHBhcnRpY2xlUG9vbCA9IHN5c3RlbS5fcGFydGljbGVQb29sO1xuICB2YXIgbnVtVG9BZGQgPSBNYXRoLm1heChcbiAgICBwYXJ0aWNsZUVzdGltYXRlIC0gcGFydGljbGVzLmxlbmd0aCAtIHBhcnRpY2xlUG9vbC5sZW5ndGgsXG4gICAgMFxuICApO1xuXG4gIGZvciAodmFyIGogPSAwOyBqIDwgbnVtVG9BZGQ7ICsraikge1xuICAgIHZhciBwYXJ0aWNsZSA9IG5ldyBQYXJ0aWNsZSgpO1xuICAgIHBhcnRpY2xlLl9iaWxsYm9hcmQgPSBiaWxsYm9hcmRDb2xsZWN0aW9uLmFkZCh7XG4gICAgICBpbWFnZTogaW1hZ2UsXG4gICAgfSk7XG4gICAgcGFydGljbGVQb29sLnB1c2gocGFydGljbGUpO1xuICB9XG5cbiAgc3lzdGVtLl9wYXJ0aWNsZUVzdGltYXRlID0gcGFydGljbGVFc3RpbWF0ZTtcbn1cblxuZnVuY3Rpb24gZ2V0T3JDcmVhdGVQYXJ0aWNsZShzeXN0ZW0pIHtcbiAgLy8gVHJ5IHRvIHJldXNlIGFuIGV4aXN0aW5nIHBhcnRpY2xlIGZyb20gdGhlIHBvb2wuXG4gIHZhciBwYXJ0aWNsZSA9IHN5c3RlbS5fcGFydGljbGVQb29sLnBvcCgpO1xuICBpZiAoIWRlZmluZWQocGFydGljbGUpKSB7XG4gICAgLy8gQ3JlYXRlIGEgbmV3IG9uZVxuICAgIHBhcnRpY2xlID0gbmV3IFBhcnRpY2xlKCk7XG4gIH1cbiAgcmV0dXJuIHBhcnRpY2xlO1xufVxuXG5mdW5jdGlvbiBhZGRQYXJ0aWNsZVRvUG9vbChzeXN0ZW0sIHBhcnRpY2xlKSB7XG4gIHN5c3RlbS5fcGFydGljbGVQb29sLnB1c2gocGFydGljbGUpO1xufVxuXG5mdW5jdGlvbiBmcmVlUGFydGljbGVQb29sKHN5c3RlbSkge1xuICB2YXIgcGFydGljbGVzID0gc3lzdGVtLl9wYXJ0aWNsZXM7XG4gIHZhciBwYXJ0aWNsZVBvb2wgPSBzeXN0ZW0uX3BhcnRpY2xlUG9vbDtcbiAgdmFyIGJpbGxib2FyZENvbGxlY3Rpb24gPSBzeXN0ZW0uX2JpbGxib2FyZENvbGxlY3Rpb247XG5cbiAgdmFyIG51bVBhcnRpY2xlcyA9IHBhcnRpY2xlcy5sZW5ndGg7XG4gIHZhciBudW1JblBvb2wgPSBwYXJ0aWNsZVBvb2wubGVuZ3RoO1xuICB2YXIgZXN0aW1hdGUgPSBzeXN0ZW0uX3BhcnRpY2xlRXN0aW1hdGU7XG5cbiAgdmFyIHN0YXJ0ID0gbnVtSW5Qb29sIC0gTWF0aC5tYXgoZXN0aW1hdGUgLSBudW1QYXJ0aWNsZXMgLSBudW1JblBvb2wsIDApO1xuICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBudW1JblBvb2w7ICsraSkge1xuICAgIHZhciBwID0gcGFydGljbGVQb29sW2ldO1xuICAgIGJpbGxib2FyZENvbGxlY3Rpb24ucmVtb3ZlKHAuX2JpbGxib2FyZCk7XG4gIH1cbiAgcGFydGljbGVQb29sLmxlbmd0aCA9IHN0YXJ0O1xufVxuXG5mdW5jdGlvbiByZW1vdmVCaWxsYm9hcmQocGFydGljbGUpIHtcbiAgaWYgKGRlZmluZWQocGFydGljbGUuX2JpbGxib2FyZCkpIHtcbiAgICBwYXJ0aWNsZS5fYmlsbGJvYXJkLnNob3cgPSBmYWxzZTtcbiAgfVxufVxuXG5mdW5jdGlvbiB1cGRhdGVCaWxsYm9hcmQoc3lzdGVtLCBwYXJ0aWNsZSkge1xuICB2YXIgYmlsbGJvYXJkID0gcGFydGljbGUuX2JpbGxib2FyZDtcbiAgaWYgKCFkZWZpbmVkKGJpbGxib2FyZCkpIHtcbiAgICBiaWxsYm9hcmQgPSBwYXJ0aWNsZS5fYmlsbGJvYXJkID0gc3lzdGVtLl9iaWxsYm9hcmRDb2xsZWN0aW9uLmFkZCh7XG4gICAgICBpbWFnZTogcGFydGljbGUuaW1hZ2UsXG4gICAgfSk7XG4gIH1cbiAgYmlsbGJvYXJkLndpZHRoID0gcGFydGljbGUuaW1hZ2VTaXplLng7XG4gIGJpbGxib2FyZC5oZWlnaHQgPSBwYXJ0aWNsZS5pbWFnZVNpemUueTtcbiAgYmlsbGJvYXJkLnBvc2l0aW9uID0gcGFydGljbGUucG9zaXRpb247XG4gIGJpbGxib2FyZC5zaXplSW5NZXRlcnMgPSBzeXN0ZW0uc2l6ZUluTWV0ZXJzO1xuICBiaWxsYm9hcmQuc2hvdyA9IHRydWU7XG5cbiAgLy8gVXBkYXRlIHRoZSBjb2xvclxuICB2YXIgciA9IENlc2l1bU1hdGgubGVycChcbiAgICBwYXJ0aWNsZS5zdGFydENvbG9yLnJlZCxcbiAgICBwYXJ0aWNsZS5lbmRDb2xvci5yZWQsXG4gICAgcGFydGljbGUubm9ybWFsaXplZEFnZVxuICApO1xuICB2YXIgZyA9IENlc2l1bU1hdGgubGVycChcbiAgICBwYXJ0aWNsZS5zdGFydENvbG9yLmdyZWVuLFxuICAgIHBhcnRpY2xlLmVuZENvbG9yLmdyZWVuLFxuICAgIHBhcnRpY2xlLm5vcm1hbGl6ZWRBZ2VcbiAgKTtcbiAgdmFyIGIgPSBDZXNpdW1NYXRoLmxlcnAoXG4gICAgcGFydGljbGUuc3RhcnRDb2xvci5ibHVlLFxuICAgIHBhcnRpY2xlLmVuZENvbG9yLmJsdWUsXG4gICAgcGFydGljbGUubm9ybWFsaXplZEFnZVxuICApO1xuICB2YXIgYSA9IENlc2l1bU1hdGgubGVycChcbiAgICBwYXJ0aWNsZS5zdGFydENvbG9yLmFscGhhLFxuICAgIHBhcnRpY2xlLmVuZENvbG9yLmFscGhhLFxuICAgIHBhcnRpY2xlLm5vcm1hbGl6ZWRBZ2VcbiAgKTtcbiAgYmlsbGJvYXJkLmNvbG9yID0gbmV3IENvbG9yKHIsIGcsIGIsIGEpO1xuXG4gIC8vIFVwZGF0ZSB0aGUgc2NhbGVcbiAgYmlsbGJvYXJkLnNjYWxlID0gQ2VzaXVtTWF0aC5sZXJwKFxuICAgIHBhcnRpY2xlLnN0YXJ0U2NhbGUsXG4gICAgcGFydGljbGUuZW5kU2NhbGUsXG4gICAgcGFydGljbGUubm9ybWFsaXplZEFnZVxuICApO1xufVxuXG5mdW5jdGlvbiBhZGRQYXJ0aWNsZShzeXN0ZW0sIHBhcnRpY2xlKSB7XG4gIHBhcnRpY2xlLnN0YXJ0Q29sb3IgPSBDb2xvci5jbG9uZShzeXN0ZW0uX3N0YXJ0Q29sb3IsIHBhcnRpY2xlLnN0YXJ0Q29sb3IpO1xuICBwYXJ0aWNsZS5lbmRDb2xvciA9IENvbG9yLmNsb25lKHN5c3RlbS5fZW5kQ29sb3IsIHBhcnRpY2xlLmVuZENvbG9yKTtcbiAgcGFydGljbGUuc3RhcnRTY2FsZSA9IHN5c3RlbS5fc3RhcnRTY2FsZTtcbiAgcGFydGljbGUuZW5kU2NhbGUgPSBzeXN0ZW0uX2VuZFNjYWxlO1xuICBwYXJ0aWNsZS5pbWFnZSA9IHN5c3RlbS5pbWFnZTtcbiAgcGFydGljbGUubGlmZSA9IENlc2l1bU1hdGgucmFuZG9tQmV0d2VlbihcbiAgICBzeXN0ZW0uX21pbmltdW1QYXJ0aWNsZUxpZmUsXG4gICAgc3lzdGVtLl9tYXhpbXVtUGFydGljbGVMaWZlXG4gICk7XG4gIHBhcnRpY2xlLm1hc3MgPSBDZXNpdW1NYXRoLnJhbmRvbUJldHdlZW4oXG4gICAgc3lzdGVtLl9taW5pbXVtTWFzcyxcbiAgICBzeXN0ZW0uX21heGltdW1NYXNzXG4gICk7XG4gIHBhcnRpY2xlLmltYWdlU2l6ZS54ID0gQ2VzaXVtTWF0aC5yYW5kb21CZXR3ZWVuKFxuICAgIHN5c3RlbS5fbWluaW11bUltYWdlU2l6ZS54LFxuICAgIHN5c3RlbS5fbWF4aW11bUltYWdlU2l6ZS54XG4gICk7XG4gIHBhcnRpY2xlLmltYWdlU2l6ZS55ID0gQ2VzaXVtTWF0aC5yYW5kb21CZXR3ZWVuKFxuICAgIHN5c3RlbS5fbWluaW11bUltYWdlU2l6ZS55LFxuICAgIHN5c3RlbS5fbWF4aW11bUltYWdlU2l6ZS55XG4gICk7XG5cbiAgLy8gUmVzZXQgdGhlIG5vcm1hbGl6ZWRBZ2UgYW5kIGFnZSBpbiBjYXNlIHRoZSBwYXJ0aWNsZSB3YXMgcmV1c2VkLlxuICBwYXJ0aWNsZS5fbm9ybWFsaXplZEFnZSA9IDAuMDtcbiAgcGFydGljbGUuX2FnZSA9IDAuMDtcblxuICB2YXIgc3BlZWQgPSBDZXNpdW1NYXRoLnJhbmRvbUJldHdlZW4oXG4gICAgc3lzdGVtLl9taW5pbXVtU3BlZWQsXG4gICAgc3lzdGVtLl9tYXhpbXVtU3BlZWRcbiAgKTtcbiAgQ2FydGVzaWFuMy5tdWx0aXBseUJ5U2NhbGFyKHBhcnRpY2xlLnZlbG9jaXR5LCBzcGVlZCwgcGFydGljbGUudmVsb2NpdHkpO1xuXG4gIHN5c3RlbS5fcGFydGljbGVzLnB1c2gocGFydGljbGUpO1xufVxuXG5mdW5jdGlvbiBjYWxjdWxhdGVOdW1iZXJUb0VtaXQoc3lzdGVtLCBkdCkge1xuICAvLyBUaGlzIGVtaXR0ZXIgaXMgZmluaXNoZWQgaWYgaXQgZXhjZWVkcyBpdCdzIGxpZmV0aW1lLlxuICBpZiAoc3lzdGVtLl9pc0NvbXBsZXRlKSB7XG4gICAgcmV0dXJuIDA7XG4gIH1cblxuICBkdCA9IENlc2l1bU1hdGgubW9kKGR0LCBzeXN0ZW0uX2xpZmV0aW1lKTtcblxuICAvLyBDb21wdXRlIHRoZSBudW1iZXIgb2YgcGFydGljbGVzIHRvIGVtaXQgYmFzZWQgb24gdGhlIGVtaXNzaW9uUmF0ZS5cbiAgdmFyIHYgPSBkdCAqIHN5c3RlbS5fZW1pc3Npb25SYXRlO1xuICB2YXIgbnVtVG9FbWl0ID0gTWF0aC5mbG9vcih2KTtcbiAgc3lzdGVtLl9jYXJyeU92ZXIgKz0gdiAtIG51bVRvRW1pdDtcbiAgaWYgKHN5c3RlbS5fY2FycnlPdmVyID4gMS4wKSB7XG4gICAgbnVtVG9FbWl0Kys7XG4gICAgc3lzdGVtLl9jYXJyeU92ZXIgLT0gMS4wO1xuICB9XG5cbiAgLy8gQXBwbHkgYW55IGJ1cnN0c1xuICBpZiAoZGVmaW5lZChzeXN0ZW0uYnVyc3RzKSkge1xuICAgIHZhciBsZW5ndGggPSBzeXN0ZW0uYnVyc3RzLmxlbmd0aDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgYnVyc3QgPSBzeXN0ZW0uYnVyc3RzW2ldO1xuICAgICAgdmFyIGN1cnJlbnRUaW1lID0gc3lzdGVtLl9jdXJyZW50VGltZTtcbiAgICAgIGlmIChkZWZpbmVkKGJ1cnN0KSAmJiAhYnVyc3QuX2NvbXBsZXRlICYmIGN1cnJlbnRUaW1lID4gYnVyc3QudGltZSkge1xuICAgICAgICBudW1Ub0VtaXQgKz0gQ2VzaXVtTWF0aC5yYW5kb21CZXR3ZWVuKGJ1cnN0Lm1pbmltdW0sIGJ1cnN0Lm1heGltdW0pO1xuICAgICAgICBidXJzdC5fY29tcGxldGUgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBudW1Ub0VtaXQ7XG59XG5cbnZhciByb3RhdGVkVmVsb2NpdHlTY3JhdGNoID0gbmV3IENhcnRlc2lhbjMoKTtcblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5QYXJ0aWNsZVN5c3RlbS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGZyYW1lU3RhdGUpIHtcbiAgaWYgKCF0aGlzLnNob3cpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoIWRlZmluZWQodGhpcy5fYmlsbGJvYXJkQ29sbGVjdGlvbikpIHtcbiAgICB0aGlzLl9iaWxsYm9hcmRDb2xsZWN0aW9uID0gbmV3IEJpbGxib2FyZENvbGxlY3Rpb24oKTtcbiAgfVxuXG4gIGlmICh0aGlzLl91cGRhdGVQYXJ0aWNsZVBvb2wpIHtcbiAgICB1cGRhdGVQYXJ0aWNsZVBvb2wodGhpcyk7XG4gICAgdGhpcy5fdXBkYXRlUGFydGljbGVQb29sID0gZmFsc2U7XG4gIH1cblxuICAvLyBDb21wdXRlIHRoZSBmcmFtZSB0aW1lXG4gIHZhciBkdCA9IDAuMDtcbiAgaWYgKHRoaXMuX3ByZXZpb3VzVGltZSkge1xuICAgIGR0ID0gSnVsaWFuRGF0ZS5zZWNvbmRzRGlmZmVyZW5jZShmcmFtZVN0YXRlLnRpbWUsIHRoaXMuX3ByZXZpb3VzVGltZSk7XG4gIH1cblxuICBpZiAoZHQgPCAwLjApIHtcbiAgICBkdCA9IDAuMDtcbiAgfVxuXG4gIHZhciBwYXJ0aWNsZXMgPSB0aGlzLl9wYXJ0aWNsZXM7XG4gIHZhciBlbWl0dGVyID0gdGhpcy5fZW1pdHRlcjtcbiAgdmFyIHVwZGF0ZUNhbGxiYWNrID0gdGhpcy51cGRhdGVDYWxsYmFjaztcblxuICB2YXIgaTtcbiAgdmFyIHBhcnRpY2xlO1xuXG4gIC8vIHVwZGF0ZSBwYXJ0aWNsZXMgYW5kIHJlbW92ZSBkZWFkIHBhcnRpY2xlc1xuICB2YXIgbGVuZ3RoID0gcGFydGljbGVzLmxlbmd0aDtcbiAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgcGFydGljbGUgPSBwYXJ0aWNsZXNbaV07XG4gICAgaWYgKCFwYXJ0aWNsZS51cGRhdGUoZHQsIHVwZGF0ZUNhbGxiYWNrKSkge1xuICAgICAgcmVtb3ZlQmlsbGJvYXJkKHBhcnRpY2xlKTtcbiAgICAgIC8vIEFkZCB0aGUgcGFydGljbGUgYmFjayB0byB0aGUgcG9vbCBzbyBpdCBjYW4gYmUgcmV1c2VkLlxuICAgICAgYWRkUGFydGljbGVUb1Bvb2wodGhpcywgcGFydGljbGUpO1xuICAgICAgcGFydGljbGVzW2ldID0gcGFydGljbGVzW2xlbmd0aCAtIDFdO1xuICAgICAgLS1pO1xuICAgICAgLS1sZW5ndGg7XG4gICAgfSBlbHNlIHtcbiAgICAgIHVwZGF0ZUJpbGxib2FyZCh0aGlzLCBwYXJ0aWNsZSk7XG4gICAgfVxuICB9XG4gIHBhcnRpY2xlcy5sZW5ndGggPSBsZW5ndGg7XG5cbiAgdmFyIG51bVRvRW1pdCA9IGNhbGN1bGF0ZU51bWJlclRvRW1pdCh0aGlzLCBkdCk7XG5cbiAgaWYgKG51bVRvRW1pdCA+IDAgJiYgZGVmaW5lZChlbWl0dGVyKSkge1xuICAgIC8vIENvbXB1dGUgdGhlIGZpbmFsIG1vZGVsIG1hdHJpeCBieSBjb21iaW5pbmcgdGhlIHBhcnRpY2xlIHN5c3RlbXMgbW9kZWwgbWF0cml4IGFuZCB0aGUgZW1pdHRlciBtYXRyaXguXG4gICAgaWYgKHRoaXMuX21hdHJpeERpcnR5KSB7XG4gICAgICB0aGlzLl9jb21iaW5lZE1hdHJpeCA9IE1hdHJpeDQubXVsdGlwbHkoXG4gICAgICAgIHRoaXMubW9kZWxNYXRyaXgsXG4gICAgICAgIHRoaXMuZW1pdHRlck1vZGVsTWF0cml4LFxuICAgICAgICB0aGlzLl9jb21iaW5lZE1hdHJpeFxuICAgICAgKTtcbiAgICAgIHRoaXMuX21hdHJpeERpcnR5ID0gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIGNvbWJpbmVkTWF0cml4ID0gdGhpcy5fY29tYmluZWRNYXRyaXg7XG5cbiAgICBmb3IgKGkgPSAwOyBpIDwgbnVtVG9FbWl0OyBpKyspIHtcbiAgICAgIC8vIENyZWF0ZSBhIG5ldyBwYXJ0aWNsZS5cbiAgICAgIHBhcnRpY2xlID0gZ2V0T3JDcmVhdGVQYXJ0aWNsZSh0aGlzKTtcblxuICAgICAgLy8gTGV0IHRoZSBlbWl0dGVyIGluaXRpYWxpemUgdGhlIHBhcnRpY2xlLlxuICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KHBhcnRpY2xlKTtcblxuICAgICAgLy9Gb3IgdGhlIHZlbG9jaXR5IHdlIG5lZWQgdG8gYWRkIGl0IHRvIHRoZSBvcmlnaW5hbCBwb3NpdGlvbiBhbmQgdGhlbiBtdWx0aXBseSBieSBwb2ludC5cbiAgICAgIENhcnRlc2lhbjMuYWRkKFxuICAgICAgICBwYXJ0aWNsZS5wb3NpdGlvbixcbiAgICAgICAgcGFydGljbGUudmVsb2NpdHksXG4gICAgICAgIHJvdGF0ZWRWZWxvY2l0eVNjcmF0Y2hcbiAgICAgICk7XG4gICAgICBNYXRyaXg0Lm11bHRpcGx5QnlQb2ludChcbiAgICAgICAgY29tYmluZWRNYXRyaXgsXG4gICAgICAgIHJvdGF0ZWRWZWxvY2l0eVNjcmF0Y2gsXG4gICAgICAgIHJvdGF0ZWRWZWxvY2l0eVNjcmF0Y2hcbiAgICAgICk7XG5cbiAgICAgIC8vIENoYW5nZSB0aGUgcG9zaXRpb24gdG8gYmUgaW4gd29ybGQgY29vcmRpbmF0ZXNcbiAgICAgIHBhcnRpY2xlLnBvc2l0aW9uID0gTWF0cml4NC5tdWx0aXBseUJ5UG9pbnQoXG4gICAgICAgIGNvbWJpbmVkTWF0cml4LFxuICAgICAgICBwYXJ0aWNsZS5wb3NpdGlvbixcbiAgICAgICAgcGFydGljbGUucG9zaXRpb25cbiAgICAgICk7XG5cbiAgICAgIC8vIE9yaWVudCB0aGUgdmVsb2NpdHkgaW4gd29ybGQgc3BhY2UgYXMgd2VsbC5cbiAgICAgIENhcnRlc2lhbjMuc3VidHJhY3QoXG4gICAgICAgIHJvdGF0ZWRWZWxvY2l0eVNjcmF0Y2gsXG4gICAgICAgIHBhcnRpY2xlLnBvc2l0aW9uLFxuICAgICAgICBwYXJ0aWNsZS52ZWxvY2l0eVxuICAgICAgKTtcbiAgICAgIENhcnRlc2lhbjMubm9ybWFsaXplKHBhcnRpY2xlLnZlbG9jaXR5LCBwYXJ0aWNsZS52ZWxvY2l0eSk7XG5cbiAgICAgIC8vIEFkZCB0aGUgcGFydGljbGUgdG8gdGhlIHN5c3RlbS5cbiAgICAgIGFkZFBhcnRpY2xlKHRoaXMsIHBhcnRpY2xlKTtcbiAgICAgIHVwZGF0ZUJpbGxib2FyZCh0aGlzLCBwYXJ0aWNsZSk7XG4gICAgfVxuICB9XG5cbiAgdGhpcy5fYmlsbGJvYXJkQ29sbGVjdGlvbi51cGRhdGUoZnJhbWVTdGF0ZSk7XG4gIHRoaXMuX3ByZXZpb3VzVGltZSA9IEp1bGlhbkRhdGUuY2xvbmUoZnJhbWVTdGF0ZS50aW1lLCB0aGlzLl9wcmV2aW91c1RpbWUpO1xuICB0aGlzLl9jdXJyZW50VGltZSArPSBkdDtcblxuICBpZiAoXG4gICAgdGhpcy5fbGlmZXRpbWUgIT09IE51bWJlci5NQVhfVkFMVUUgJiZcbiAgICB0aGlzLl9jdXJyZW50VGltZSA+IHRoaXMuX2xpZmV0aW1lXG4gICkge1xuICAgIGlmICh0aGlzLmxvb3ApIHtcbiAgICAgIHRoaXMuX2N1cnJlbnRUaW1lID0gQ2VzaXVtTWF0aC5tb2QodGhpcy5fY3VycmVudFRpbWUsIHRoaXMuX2xpZmV0aW1lKTtcbiAgICAgIGlmICh0aGlzLmJ1cnN0cykge1xuICAgICAgICB2YXIgYnVyc3RMZW5ndGggPSB0aGlzLmJ1cnN0cy5sZW5ndGg7XG4gICAgICAgIC8vIFJlc2V0IGFueSBidXJzdHNcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGJ1cnN0TGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB0aGlzLmJ1cnN0c1tpXS5fY29tcGxldGUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9pc0NvbXBsZXRlID0gdHJ1ZTtcbiAgICAgIHRoaXMuX2NvbXBsZXRlLnJhaXNlRXZlbnQodGhpcyk7XG4gICAgfVxuICB9XG5cbiAgLy8gZnJlZSBwYXJ0aWNsZXMgaW4gdGhlIHBvb2wgYW5kIHJlbGVhc2UgYmlsbGJvYXJkIEdQVSBtZW1vcnlcbiAgaWYgKGZyYW1lU3RhdGUuZnJhbWVOdW1iZXIgJSAxMjAgPT09IDApIHtcbiAgICBmcmVlUGFydGljbGVQb29sKHRoaXMpO1xuICB9XG59O1xuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIG9iamVjdCB3YXMgZGVzdHJveWVkOyBvdGhlcndpc2UsIGZhbHNlLlxuICogPGJyIC8+PGJyIC8+XG4gKiBJZiB0aGlzIG9iamVjdCB3YXMgZGVzdHJveWVkLCBpdCBzaG91bGQgbm90IGJlIHVzZWQ7IGNhbGxpbmcgYW55IGZ1bmN0aW9uIG90aGVyIHRoYW5cbiAqIDxjb2RlPmlzRGVzdHJveWVkPC9jb2RlPiB3aWxsIHJlc3VsdCBpbiBhIHtAbGluayBEZXZlbG9wZXJFcnJvcn0gZXhjZXB0aW9uLlxuICpcbiAqIEByZXR1cm5zIHtCb29sZWFufSA8Y29kZT50cnVlPC9jb2RlPiBpZiB0aGlzIG9iamVjdCB3YXMgZGVzdHJveWVkOyBvdGhlcndpc2UsIDxjb2RlPmZhbHNlPC9jb2RlPi5cbiAqXG4gKiBAc2VlIFBhcnRpY2xlU3lzdGVtI2Rlc3Ryb3lcbiAqL1xuUGFydGljbGVTeXN0ZW0ucHJvdG90eXBlLmlzRGVzdHJveWVkID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gZmFsc2U7XG59O1xuXG4vKipcbiAqIERlc3Ryb3lzIHRoZSBXZWJHTCByZXNvdXJjZXMgaGVsZCBieSB0aGlzIG9iamVjdC4gIERlc3Ryb3lpbmcgYW4gb2JqZWN0IGFsbG93cyBmb3IgZGV0ZXJtaW5pc3RpY1xuICogcmVsZWFzZSBvZiBXZWJHTCByZXNvdXJjZXMsIGluc3RlYWQgb2YgcmVseWluZyBvbiB0aGUgZ2FyYmFnZSBjb2xsZWN0b3IgdG8gZGVzdHJveSB0aGlzIG9iamVjdC5cbiAqIDxiciAvPjxiciAvPlxuICogT25jZSBhbiBvYmplY3QgaXMgZGVzdHJveWVkLCBpdCBzaG91bGQgbm90IGJlIHVzZWQ7IGNhbGxpbmcgYW55IGZ1bmN0aW9uIG90aGVyIHRoYW5cbiAqIDxjb2RlPmlzRGVzdHJveWVkPC9jb2RlPiB3aWxsIHJlc3VsdCBpbiBhIHtAbGluayBEZXZlbG9wZXJFcnJvcn0gZXhjZXB0aW9uLiAgVGhlcmVmb3JlLFxuICogYXNzaWduIHRoZSByZXR1cm4gdmFsdWUgKDxjb2RlPnVuZGVmaW5lZDwvY29kZT4pIHRvIHRoZSBvYmplY3QgYXMgZG9uZSBpbiB0aGUgZXhhbXBsZS5cbiAqXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gVGhpcyBvYmplY3Qgd2FzIGRlc3Ryb3llZCwgaS5lLiwgZGVzdHJveSgpIHdhcyBjYWxsZWQuXG4gKlxuICogQHNlZSBQYXJ0aWNsZVN5c3RlbSNpc0Rlc3Ryb3llZFxuICovXG5QYXJ0aWNsZVN5c3RlbS5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5fYmlsbGJvYXJkQ29sbGVjdGlvbiA9XG4gICAgdGhpcy5fYmlsbGJvYXJkQ29sbGVjdGlvbiAmJiB0aGlzLl9iaWxsYm9hcmRDb2xsZWN0aW9uLmRlc3Ryb3koKTtcbiAgcmV0dXJuIGRlc3Ryb3lPYmplY3QodGhpcyk7XG59O1xuXG4vKipcbiAqIEEgZnVuY3Rpb24gdXNlZCB0byBtb2RpZnkgYXR0cmlidXRlcyBvZiB0aGUgcGFydGljbGUgYXQgZWFjaCB0aW1lIHN0ZXAuIFRoaXMgY2FuIGluY2x1ZGUgZm9yY2UgbW9kaWZpY2F0aW9ucyxcbiAqIGNvbG9yLCBzaXppbmcsIGV0Yy5cbiAqXG4gKiBAY2FsbGJhY2sgUGFydGljbGVTeXN0ZW0udXBkYXRlQ2FsbGJhY2tcbiAqXG4gKiBAcGFyYW0ge1BhcnRpY2xlfSBwYXJ0aWNsZSBUaGUgcGFydGljbGUgYmVpbmcgdXBkYXRlZC5cbiAqIEBwYXJhbSB7TnVtYmVyfSBkdCBUaGUgdGltZSBpbiBzZWNvbmRzIHNpbmNlIHRoZSBsYXN0IHVwZGF0ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogZnVuY3Rpb24gYXBwbHlHcmF2aXR5KHBhcnRpY2xlLCBkdCkge1xuICogICAgdmFyIHBvc2l0aW9uID0gcGFydGljbGUucG9zaXRpb247XG4gKiAgICB2YXIgZ3Jhdml0eVZlY3RvciA9IENlc2l1bS5DYXJ0ZXNpYW4zLm5vcm1hbGl6ZShwb3NpdGlvbiwgbmV3IENlc2l1bS5DYXJ0ZXNpYW4zKCkpO1xuICogICAgQ2VzaXVtLkNhcnRlc2lhbjMubXVsdGlwbHlCeVNjYWxhcihncmF2aXR5VmVjdG9yLCBHUkFWSVRBVElPTkFMX0NPTlNUQU5UICogZHQsIGdyYXZpdHlWZWN0b3IpO1xuICogICAgcGFydGljbGUudmVsb2NpdHkgPSBDZXNpdW0uQ2FydGVzaWFuMy5hZGQocGFydGljbGUudmVsb2NpdHksIGdyYXZpdHlWZWN0b3IsIHBhcnRpY2xlLnZlbG9jaXR5KTtcbiAqIH1cbiAqL1xuZXhwb3J0IGRlZmF1bHQgUGFydGljbGVTeXN0ZW07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///34992\n')},64060:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(62200);\n/* harmony import */ var _Core_VertexFormat_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(67252);\n/* harmony import */ var _Shaders_Appearances_PerInstanceColorAppearanceFS_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(26712);\n/* harmony import */ var _Shaders_Appearances_PerInstanceColorAppearanceVS_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(82926);\n/* harmony import */ var _Shaders_Appearances_PerInstanceFlatColorAppearanceFS_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(76257);\n/* harmony import */ var _Shaders_Appearances_PerInstanceFlatColorAppearanceVS_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(32321);\n/* harmony import */ var _Appearance_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12804);\n\n\n\n\n\n\n\n\n/**\n * An appearance for {@link GeometryInstance} instances with color attributes.\n * This allows several geometry instances, each with a different color, to\n * be drawn with the same {@link Primitive} as shown in the second example below.\n *\n * @alias PerInstanceColorAppearance\n * @constructor\n *\n * @param {Object} [options] Object with the following properties:\n * @param {Boolean} [options.flat=false] When <code>true</code>, flat shading is used in the fragment shader, which means lighting is not taking into account.\n * @param {Boolean} [options.faceForward=!options.closed] When <code>true</code>, the fragment shader flips the surface normal as needed to ensure that the normal faces the viewer to avoid dark spots.  This is useful when both sides of a geometry should be shaded like {@link WallGeometry}.\n * @param {Boolean} [options.translucent=true] When <code>true</code>, the geometry is expected to appear translucent so {@link PerInstanceColorAppearance#renderState} has alpha blending enabled.\n * @param {Boolean} [options.closed=false] When <code>true</code>, the geometry is expected to be closed so {@link PerInstanceColorAppearance#renderState} has backface culling enabled.\n * @param {String} [options.vertexShaderSource] Optional GLSL vertex shader source to override the default vertex shader.\n * @param {String} [options.fragmentShaderSource] Optional GLSL fragment shader source to override the default fragment shader.\n * @param {Object} [options.renderState] Optional render state to override the default render state.\n *\n * @example\n * // A solid white line segment\n * var primitive = new Cesium.Primitive({\n *   geometryInstances : new Cesium.GeometryInstance({\n *     geometry : new Cesium.SimplePolylineGeometry({\n *       positions : Cesium.Cartesian3.fromDegreesArray([\n *         0.0, 0.0,\n *         5.0, 0.0\n *       ])\n *     }),\n *     attributes : {\n *       color : Cesium.ColorGeometryInstanceAttribute.fromColor(new Cesium.Color(1.0, 1.0, 1.0, 1.0))\n *     }\n *   }),\n *   appearance : new Cesium.PerInstanceColorAppearance({\n *     flat : true,\n *     translucent : false\n *   })\n * });\n *\n * // Two rectangles in a primitive, each with a different color\n * var instance = new Cesium.GeometryInstance({\n *   geometry : new Cesium.RectangleGeometry({\n *     rectangle : Cesium.Rectangle.fromDegrees(0.0, 20.0, 10.0, 30.0)\n *   }),\n *   attributes : {\n *     color : new Cesium.ColorGeometryInstanceAttribute(1.0, 0.0, 0.0, 0.5)\n *   }\n * });\n *\n * var anotherInstance = new Cesium.GeometryInstance({\n *   geometry : new Cesium.RectangleGeometry({\n *     rectangle : Cesium.Rectangle.fromDegrees(0.0, 40.0, 10.0, 50.0)\n *   }),\n *   attributes : {\n *     color : new Cesium.ColorGeometryInstanceAttribute(0.0, 0.0, 1.0, 0.5)\n *   }\n * });\n *\n * var rectanglePrimitive = new Cesium.Primitive({\n *   geometryInstances : [instance, anotherInstance],\n *   appearance : new Cesium.PerInstanceColorAppearance()\n * });\n */\nfunction PerInstanceColorAppearance(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n\n  var translucent = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options.translucent, true);\n  var closed = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options.closed, false);\n  var flat = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options.flat, false);\n  var vs = flat\n    ? _Shaders_Appearances_PerInstanceFlatColorAppearanceVS_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z\n    : _Shaders_Appearances_PerInstanceColorAppearanceVS_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z;\n  var fs = flat\n    ? _Shaders_Appearances_PerInstanceFlatColorAppearanceFS_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z\n    : _Shaders_Appearances_PerInstanceColorAppearanceFS_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z;\n  var vertexFormat = flat\n    ? PerInstanceColorAppearance.FLAT_VERTEX_FORMAT\n    : PerInstanceColorAppearance.VERTEX_FORMAT;\n\n  /**\n   * This property is part of the {@link Appearance} interface, but is not\n   * used by {@link PerInstanceColorAppearance} since a fully custom fragment shader is used.\n   *\n   * @type Material\n   *\n   * @default undefined\n   */\n  this.material = undefined;\n\n  /**\n   * When <code>true</code>, the geometry is expected to appear translucent so\n   * {@link PerInstanceColorAppearance#renderState} has alpha blending enabled.\n   *\n   * @type {Boolean}\n   *\n   * @default true\n   */\n  this.translucent = translucent;\n\n  this._vertexShaderSource = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options.vertexShaderSource, vs);\n  this._fragmentShaderSource = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options.fragmentShaderSource, fs);\n  this._renderState = _Appearance_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].getDefaultRenderState */ .Z.getDefaultRenderState(\n    translucent,\n    closed,\n    options.renderState\n  );\n  this._closed = closed;\n\n  // Non-derived members\n\n  this._vertexFormat = vertexFormat;\n  this._flat = flat;\n  this._faceForward = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options.faceForward, !closed);\n}\n\nObject.defineProperties(PerInstanceColorAppearance.prototype, {\n  /**\n   * The GLSL source code for the vertex shader.\n   *\n   * @memberof PerInstanceColorAppearance.prototype\n   *\n   * @type {String}\n   * @readonly\n   */\n  vertexShaderSource: {\n    get: function () {\n      return this._vertexShaderSource;\n    },\n  },\n\n  /**\n   * The GLSL source code for the fragment shader.\n   *\n   * @memberof PerInstanceColorAppearance.prototype\n   *\n   * @type {String}\n   * @readonly\n   */\n  fragmentShaderSource: {\n    get: function () {\n      return this._fragmentShaderSource;\n    },\n  },\n\n  /**\n   * The WebGL fixed-function state to use when rendering the geometry.\n   * <p>\n   * The render state can be explicitly defined when constructing a {@link PerInstanceColorAppearance}\n   * instance, or it is set implicitly via {@link PerInstanceColorAppearance#translucent}\n   * and {@link PerInstanceColorAppearance#closed}.\n   * </p>\n   *\n   * @memberof PerInstanceColorAppearance.prototype\n   *\n   * @type {Object}\n   * @readonly\n   */\n  renderState: {\n    get: function () {\n      return this._renderState;\n    },\n  },\n\n  /**\n   * When <code>true</code>, the geometry is expected to be closed so\n   * {@link PerInstanceColorAppearance#renderState} has backface culling enabled.\n   * If the viewer enters the geometry, it will not be visible.\n   *\n   * @memberof PerInstanceColorAppearance.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default false\n   */\n  closed: {\n    get: function () {\n      return this._closed;\n    },\n  },\n\n  /**\n   * The {@link VertexFormat} that this appearance instance is compatible with.\n   * A geometry can have more vertex attributes and still be compatible - at a\n   * potential performance cost - but it can\'t have less.\n   *\n   * @memberof PerInstanceColorAppearance.prototype\n   *\n   * @type VertexFormat\n   * @readonly\n   */\n  vertexFormat: {\n    get: function () {\n      return this._vertexFormat;\n    },\n  },\n\n  /**\n   * When <code>true</code>, flat shading is used in the fragment shader,\n   * which means lighting is not taking into account.\n   *\n   * @memberof PerInstanceColorAppearance.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default false\n   */\n  flat: {\n    get: function () {\n      return this._flat;\n    },\n  },\n\n  /**\n   * When <code>true</code>, the fragment shader flips the surface normal\n   * as needed to ensure that the normal faces the viewer to avoid\n   * dark spots.  This is useful when both sides of a geometry should be\n   * shaded like {@link WallGeometry}.\n   *\n   * @memberof PerInstanceColorAppearance.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  faceForward: {\n    get: function () {\n      return this._faceForward;\n    },\n  },\n});\n\n/**\n * The {@link VertexFormat} that all {@link PerInstanceColorAppearance} instances\n * are compatible with.  This requires only <code>position</code> and <code>normal</code>\n * attributes.\n *\n * @type VertexFormat\n *\n * @constant\n */\nPerInstanceColorAppearance.VERTEX_FORMAT = _Core_VertexFormat_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].POSITION_AND_NORMAL */ .Z.POSITION_AND_NORMAL;\n\n/**\n * The {@link VertexFormat} that all {@link PerInstanceColorAppearance} instances\n * are compatible with when {@link PerInstanceColorAppearance#flat} is <code>true</code>.\n * This requires only a <code>position</code> attribute.\n *\n * @type VertexFormat\n *\n * @constant\n */\nPerInstanceColorAppearance.FLAT_VERTEX_FORMAT = _Core_VertexFormat_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].POSITION_ONLY */ .Z.POSITION_ONLY;\n\n/**\n * Procedurally creates the full GLSL fragment shader source.  For {@link PerInstanceColorAppearance},\n * this is derived from {@link PerInstanceColorAppearance#fragmentShaderSource}, {@link PerInstanceColorAppearance#flat},\n * and {@link PerInstanceColorAppearance#faceForward}.\n *\n * @function\n *\n * @returns {String} The full GLSL fragment shader source.\n */\nPerInstanceColorAppearance.prototype.getFragmentShaderSource =\n  _Appearance_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].prototype.getFragmentShaderSource */ .Z.prototype.getFragmentShaderSource;\n\n/**\n * Determines if the geometry is translucent based on {@link PerInstanceColorAppearance#translucent}.\n *\n * @function\n *\n * @returns {Boolean} <code>true</code> if the appearance is translucent.\n */\nPerInstanceColorAppearance.prototype.isTranslucent =\n  _Appearance_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].prototype.isTranslucent */ .Z.prototype.isTranslucent;\n\n/**\n * Creates a render state.  This is not the final render state instance; instead,\n * it can contain a subset of render state properties identical to the render state\n * created in the context.\n *\n * @function\n *\n * @returns {Object} The render state.\n */\nPerInstanceColorAppearance.prototype.getRenderState =\n  _Appearance_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].prototype.getRenderState */ .Z.prototype.getRenderState;\n/* harmony default export */ __webpack_exports__["Z"] = (PerInstanceColorAppearance);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFFBQVEsb0JBQW9CLFVBQVUsa0NBQWtDO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLDhHQUFnQzs7QUFFM0U7QUFDQSxRQUFRLG9CQUFvQixVQUFVLGtDQUFrQztBQUN4RSw2QkFBNkIsdUNBQXVDO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCxrR0FBMEI7O0FBRTFFO0FBQ0Esb0VBQW9FLGlDQUFpQztBQUNyRyx5QkFBeUIsc0RBQXNELEdBQUcsc0NBQXNDO0FBQ3hILFFBQVEsNkNBQTZDO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBLGFBQWEsUUFBUTtBQUNyQjtBQUNBO0FBQ0EsRUFBRSxtSUFBNEM7O0FBRTlDO0FBQ0EsdURBQXVELDZDQUE2QztBQUNwRztBQUNBO0FBQ0E7QUFDQSxhQUFhLFNBQVM7QUFDdEI7QUFDQTtBQUNBLEVBQUUsK0dBQWtDOztBQUVwQztBQUNBLHlFQUF5RTtBQUN6RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQSxFQUFFLGlIQUFtQztBQUNyQyx5REFBZSwwQkFBMEIsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9TY2VuZS9QZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZS5qcz8zNDY5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBkZWZhdWx0VmFsdWUgZnJvbSBcIi4uL0NvcmUvZGVmYXVsdFZhbHVlLmpzXCI7XG5pbXBvcnQgVmVydGV4Rm9ybWF0IGZyb20gXCIuLi9Db3JlL1ZlcnRleEZvcm1hdC5qc1wiO1xuaW1wb3J0IFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlRlMgZnJvbSBcIi4uL1NoYWRlcnMvQXBwZWFyYW5jZXMvUGVySW5zdGFuY2VDb2xvckFwcGVhcmFuY2VGUy5qc1wiO1xuaW1wb3J0IFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlVlMgZnJvbSBcIi4uL1NoYWRlcnMvQXBwZWFyYW5jZXMvUGVySW5zdGFuY2VDb2xvckFwcGVhcmFuY2VWUy5qc1wiO1xuaW1wb3J0IFBlckluc3RhbmNlRmxhdENvbG9yQXBwZWFyYW5jZUZTIGZyb20gXCIuLi9TaGFkZXJzL0FwcGVhcmFuY2VzL1Blckluc3RhbmNlRmxhdENvbG9yQXBwZWFyYW5jZUZTLmpzXCI7XG5pbXBvcnQgUGVySW5zdGFuY2VGbGF0Q29sb3JBcHBlYXJhbmNlVlMgZnJvbSBcIi4uL1NoYWRlcnMvQXBwZWFyYW5jZXMvUGVySW5zdGFuY2VGbGF0Q29sb3JBcHBlYXJhbmNlVlMuanNcIjtcbmltcG9ydCBBcHBlYXJhbmNlIGZyb20gXCIuL0FwcGVhcmFuY2UuanNcIjtcblxuLyoqXG4gKiBBbiBhcHBlYXJhbmNlIGZvciB7QGxpbmsgR2VvbWV0cnlJbnN0YW5jZX0gaW5zdGFuY2VzIHdpdGggY29sb3IgYXR0cmlidXRlcy5cbiAqIFRoaXMgYWxsb3dzIHNldmVyYWwgZ2VvbWV0cnkgaW5zdGFuY2VzLCBlYWNoIHdpdGggYSBkaWZmZXJlbnQgY29sb3IsIHRvXG4gKiBiZSBkcmF3biB3aXRoIHRoZSBzYW1lIHtAbGluayBQcmltaXRpdmV9IGFzIHNob3duIGluIHRoZSBzZWNvbmQgZXhhbXBsZSBiZWxvdy5cbiAqXG4gKiBAYWxpYXMgUGVySW5zdGFuY2VDb2xvckFwcGVhcmFuY2VcbiAqIEBjb25zdHJ1Y3RvclxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gT2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5mbGF0PWZhbHNlXSBXaGVuIDxjb2RlPnRydWU8L2NvZGU+LCBmbGF0IHNoYWRpbmcgaXMgdXNlZCBpbiB0aGUgZnJhZ21lbnQgc2hhZGVyLCB3aGljaCBtZWFucyBsaWdodGluZyBpcyBub3QgdGFraW5nIGludG8gYWNjb3VudC5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuZmFjZUZvcndhcmQ9IW9wdGlvbnMuY2xvc2VkXSBXaGVuIDxjb2RlPnRydWU8L2NvZGU+LCB0aGUgZnJhZ21lbnQgc2hhZGVyIGZsaXBzIHRoZSBzdXJmYWNlIG5vcm1hbCBhcyBuZWVkZWQgdG8gZW5zdXJlIHRoYXQgdGhlIG5vcm1hbCBmYWNlcyB0aGUgdmlld2VyIHRvIGF2b2lkIGRhcmsgc3BvdHMuICBUaGlzIGlzIHVzZWZ1bCB3aGVuIGJvdGggc2lkZXMgb2YgYSBnZW9tZXRyeSBzaG91bGQgYmUgc2hhZGVkIGxpa2Uge0BsaW5rIFdhbGxHZW9tZXRyeX0uXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLnRyYW5zbHVjZW50PXRydWVdIFdoZW4gPGNvZGU+dHJ1ZTwvY29kZT4sIHRoZSBnZW9tZXRyeSBpcyBleHBlY3RlZCB0byBhcHBlYXIgdHJhbnNsdWNlbnQgc28ge0BsaW5rIFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlI3JlbmRlclN0YXRlfSBoYXMgYWxwaGEgYmxlbmRpbmcgZW5hYmxlZC5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuY2xvc2VkPWZhbHNlXSBXaGVuIDxjb2RlPnRydWU8L2NvZGU+LCB0aGUgZ2VvbWV0cnkgaXMgZXhwZWN0ZWQgdG8gYmUgY2xvc2VkIHNvIHtAbGluayBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZSNyZW5kZXJTdGF0ZX0gaGFzIGJhY2tmYWNlIGN1bGxpbmcgZW5hYmxlZC5cbiAqIEBwYXJhbSB7U3RyaW5nfSBbb3B0aW9ucy52ZXJ0ZXhTaGFkZXJTb3VyY2VdIE9wdGlvbmFsIEdMU0wgdmVydGV4IHNoYWRlciBzb3VyY2UgdG8gb3ZlcnJpZGUgdGhlIGRlZmF1bHQgdmVydGV4IHNoYWRlci5cbiAqIEBwYXJhbSB7U3RyaW5nfSBbb3B0aW9ucy5mcmFnbWVudFNoYWRlclNvdXJjZV0gT3B0aW9uYWwgR0xTTCBmcmFnbWVudCBzaGFkZXIgc291cmNlIHRvIG92ZXJyaWRlIHRoZSBkZWZhdWx0IGZyYWdtZW50IHNoYWRlci5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5yZW5kZXJTdGF0ZV0gT3B0aW9uYWwgcmVuZGVyIHN0YXRlIHRvIG92ZXJyaWRlIHRoZSBkZWZhdWx0IHJlbmRlciBzdGF0ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gQSBzb2xpZCB3aGl0ZSBsaW5lIHNlZ21lbnRcbiAqIHZhciBwcmltaXRpdmUgPSBuZXcgQ2VzaXVtLlByaW1pdGl2ZSh7XG4gKiAgIGdlb21ldHJ5SW5zdGFuY2VzIDogbmV3IENlc2l1bS5HZW9tZXRyeUluc3RhbmNlKHtcbiAqICAgICBnZW9tZXRyeSA6IG5ldyBDZXNpdW0uU2ltcGxlUG9seWxpbmVHZW9tZXRyeSh7XG4gKiAgICAgICBwb3NpdGlvbnMgOiBDZXNpdW0uQ2FydGVzaWFuMy5mcm9tRGVncmVlc0FycmF5KFtcbiAqICAgICAgICAgMC4wLCAwLjAsXG4gKiAgICAgICAgIDUuMCwgMC4wXG4gKiAgICAgICBdKVxuICogICAgIH0pLFxuICogICAgIGF0dHJpYnV0ZXMgOiB7XG4gKiAgICAgICBjb2xvciA6IENlc2l1bS5Db2xvckdlb21ldHJ5SW5zdGFuY2VBdHRyaWJ1dGUuZnJvbUNvbG9yKG5ldyBDZXNpdW0uQ29sb3IoMS4wLCAxLjAsIDEuMCwgMS4wKSlcbiAqICAgICB9XG4gKiAgIH0pLFxuICogICBhcHBlYXJhbmNlIDogbmV3IENlc2l1bS5QZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZSh7XG4gKiAgICAgZmxhdCA6IHRydWUsXG4gKiAgICAgdHJhbnNsdWNlbnQgOiBmYWxzZVxuICogICB9KVxuICogfSk7XG4gKlxuICogLy8gVHdvIHJlY3RhbmdsZXMgaW4gYSBwcmltaXRpdmUsIGVhY2ggd2l0aCBhIGRpZmZlcmVudCBjb2xvclxuICogdmFyIGluc3RhbmNlID0gbmV3IENlc2l1bS5HZW9tZXRyeUluc3RhbmNlKHtcbiAqICAgZ2VvbWV0cnkgOiBuZXcgQ2VzaXVtLlJlY3RhbmdsZUdlb21ldHJ5KHtcbiAqICAgICByZWN0YW5nbGUgOiBDZXNpdW0uUmVjdGFuZ2xlLmZyb21EZWdyZWVzKDAuMCwgMjAuMCwgMTAuMCwgMzAuMClcbiAqICAgfSksXG4gKiAgIGF0dHJpYnV0ZXMgOiB7XG4gKiAgICAgY29sb3IgOiBuZXcgQ2VzaXVtLkNvbG9yR2VvbWV0cnlJbnN0YW5jZUF0dHJpYnV0ZSgxLjAsIDAuMCwgMC4wLCAwLjUpXG4gKiAgIH1cbiAqIH0pO1xuICpcbiAqIHZhciBhbm90aGVySW5zdGFuY2UgPSBuZXcgQ2VzaXVtLkdlb21ldHJ5SW5zdGFuY2Uoe1xuICogICBnZW9tZXRyeSA6IG5ldyBDZXNpdW0uUmVjdGFuZ2xlR2VvbWV0cnkoe1xuICogICAgIHJlY3RhbmdsZSA6IENlc2l1bS5SZWN0YW5nbGUuZnJvbURlZ3JlZXMoMC4wLCA0MC4wLCAxMC4wLCA1MC4wKVxuICogICB9KSxcbiAqICAgYXR0cmlidXRlcyA6IHtcbiAqICAgICBjb2xvciA6IG5ldyBDZXNpdW0uQ29sb3JHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlKDAuMCwgMC4wLCAxLjAsIDAuNSlcbiAqICAgfVxuICogfSk7XG4gKlxuICogdmFyIHJlY3RhbmdsZVByaW1pdGl2ZSA9IG5ldyBDZXNpdW0uUHJpbWl0aXZlKHtcbiAqICAgZ2VvbWV0cnlJbnN0YW5jZXMgOiBbaW5zdGFuY2UsIGFub3RoZXJJbnN0YW5jZV0sXG4gKiAgIGFwcGVhcmFuY2UgOiBuZXcgQ2VzaXVtLlBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlKClcbiAqIH0pO1xuICovXG5mdW5jdGlvbiBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZShvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBkZWZhdWx0VmFsdWUob3B0aW9ucywgZGVmYXVsdFZhbHVlLkVNUFRZX09CSkVDVCk7XG5cbiAgdmFyIHRyYW5zbHVjZW50ID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMudHJhbnNsdWNlbnQsIHRydWUpO1xuICB2YXIgY2xvc2VkID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuY2xvc2VkLCBmYWxzZSk7XG4gIHZhciBmbGF0ID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuZmxhdCwgZmFsc2UpO1xuICB2YXIgdnMgPSBmbGF0XG4gICAgPyBQZXJJbnN0YW5jZUZsYXRDb2xvckFwcGVhcmFuY2VWU1xuICAgIDogUGVySW5zdGFuY2VDb2xvckFwcGVhcmFuY2VWUztcbiAgdmFyIGZzID0gZmxhdFxuICAgID8gUGVySW5zdGFuY2VGbGF0Q29sb3JBcHBlYXJhbmNlRlNcbiAgICA6IFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlRlM7XG4gIHZhciB2ZXJ0ZXhGb3JtYXQgPSBmbGF0XG4gICAgPyBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZS5GTEFUX1ZFUlRFWF9GT1JNQVRcbiAgICA6IFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlLlZFUlRFWF9GT1JNQVQ7XG5cbiAgLyoqXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgcGFydCBvZiB0aGUge0BsaW5rIEFwcGVhcmFuY2V9IGludGVyZmFjZSwgYnV0IGlzIG5vdFxuICAgKiB1c2VkIGJ5IHtAbGluayBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZX0gc2luY2UgYSBmdWxseSBjdXN0b20gZnJhZ21lbnQgc2hhZGVyIGlzIHVzZWQuXG4gICAqXG4gICAqIEB0eXBlIE1hdGVyaWFsXG4gICAqXG4gICAqIEBkZWZhdWx0IHVuZGVmaW5lZFxuICAgKi9cbiAgdGhpcy5tYXRlcmlhbCA9IHVuZGVmaW5lZDtcblxuICAvKipcbiAgICogV2hlbiA8Y29kZT50cnVlPC9jb2RlPiwgdGhlIGdlb21ldHJ5IGlzIGV4cGVjdGVkIHRvIGFwcGVhciB0cmFuc2x1Y2VudCBzb1xuICAgKiB7QGxpbmsgUGVySW5zdGFuY2VDb2xvckFwcGVhcmFuY2UjcmVuZGVyU3RhdGV9IGhhcyBhbHBoYSBibGVuZGluZyBlbmFibGVkLlxuICAgKlxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICpcbiAgICogQGRlZmF1bHQgdHJ1ZVxuICAgKi9cbiAgdGhpcy50cmFuc2x1Y2VudCA9IHRyYW5zbHVjZW50O1xuXG4gIHRoaXMuX3ZlcnRleFNoYWRlclNvdXJjZSA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLnZlcnRleFNoYWRlclNvdXJjZSwgdnMpO1xuICB0aGlzLl9mcmFnbWVudFNoYWRlclNvdXJjZSA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmZyYWdtZW50U2hhZGVyU291cmNlLCBmcyk7XG4gIHRoaXMuX3JlbmRlclN0YXRlID0gQXBwZWFyYW5jZS5nZXREZWZhdWx0UmVuZGVyU3RhdGUoXG4gICAgdHJhbnNsdWNlbnQsXG4gICAgY2xvc2VkLFxuICAgIG9wdGlvbnMucmVuZGVyU3RhdGVcbiAgKTtcbiAgdGhpcy5fY2xvc2VkID0gY2xvc2VkO1xuXG4gIC8vIE5vbi1kZXJpdmVkIG1lbWJlcnNcblxuICB0aGlzLl92ZXJ0ZXhGb3JtYXQgPSB2ZXJ0ZXhGb3JtYXQ7XG4gIHRoaXMuX2ZsYXQgPSBmbGF0O1xuICB0aGlzLl9mYWNlRm9yd2FyZCA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmZhY2VGb3J3YXJkLCAhY2xvc2VkKTtcbn1cblxuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoUGVySW5zdGFuY2VDb2xvckFwcGVhcmFuY2UucHJvdG90eXBlLCB7XG4gIC8qKlxuICAgKiBUaGUgR0xTTCBzb3VyY2UgY29kZSBmb3IgdGhlIHZlcnRleCBzaGFkZXIuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZS5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge1N0cmluZ31cbiAgICogQHJlYWRvbmx5XG4gICAqL1xuICB2ZXJ0ZXhTaGFkZXJTb3VyY2U6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl92ZXJ0ZXhTaGFkZXJTb3VyY2U7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogVGhlIEdMU0wgc291cmNlIGNvZGUgZm9yIHRoZSBmcmFnbWVudCBzaGFkZXIuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZS5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge1N0cmluZ31cbiAgICogQHJlYWRvbmx5XG4gICAqL1xuICBmcmFnbWVudFNoYWRlclNvdXJjZToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2ZyYWdtZW50U2hhZGVyU291cmNlO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFRoZSBXZWJHTCBmaXhlZC1mdW5jdGlvbiBzdGF0ZSB0byB1c2Ugd2hlbiByZW5kZXJpbmcgdGhlIGdlb21ldHJ5LlxuICAgKiA8cD5cbiAgICogVGhlIHJlbmRlciBzdGF0ZSBjYW4gYmUgZXhwbGljaXRseSBkZWZpbmVkIHdoZW4gY29uc3RydWN0aW5nIGEge0BsaW5rIFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlfVxuICAgKiBpbnN0YW5jZSwgb3IgaXQgaXMgc2V0IGltcGxpY2l0bHkgdmlhIHtAbGluayBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZSN0cmFuc2x1Y2VudH1cbiAgICogYW5kIHtAbGluayBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZSNjbG9zZWR9LlxuICAgKiA8L3A+XG4gICAqXG4gICAqIEBtZW1iZXJvZiBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZS5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge09iamVjdH1cbiAgICogQHJlYWRvbmx5XG4gICAqL1xuICByZW5kZXJTdGF0ZToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3JlbmRlclN0YXRlO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFdoZW4gPGNvZGU+dHJ1ZTwvY29kZT4sIHRoZSBnZW9tZXRyeSBpcyBleHBlY3RlZCB0byBiZSBjbG9zZWQgc29cbiAgICoge0BsaW5rIFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlI3JlbmRlclN0YXRlfSBoYXMgYmFja2ZhY2UgY3VsbGluZyBlbmFibGVkLlxuICAgKiBJZiB0aGUgdmlld2VyIGVudGVycyB0aGUgZ2VvbWV0cnksIGl0IHdpbGwgbm90IGJlIHZpc2libGUuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZS5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqIEByZWFkb25seVxuICAgKlxuICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgKi9cbiAgY2xvc2VkOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fY2xvc2VkO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFRoZSB7QGxpbmsgVmVydGV4Rm9ybWF0fSB0aGF0IHRoaXMgYXBwZWFyYW5jZSBpbnN0YW5jZSBpcyBjb21wYXRpYmxlIHdpdGguXG4gICAqIEEgZ2VvbWV0cnkgY2FuIGhhdmUgbW9yZSB2ZXJ0ZXggYXR0cmlidXRlcyBhbmQgc3RpbGwgYmUgY29tcGF0aWJsZSAtIGF0IGFcbiAgICogcG90ZW50aWFsIHBlcmZvcm1hbmNlIGNvc3QgLSBidXQgaXQgY2FuJ3QgaGF2ZSBsZXNzLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgUGVySW5zdGFuY2VDb2xvckFwcGVhcmFuY2UucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIFZlcnRleEZvcm1hdFxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIHZlcnRleEZvcm1hdDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3ZlcnRleEZvcm1hdDtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBXaGVuIDxjb2RlPnRydWU8L2NvZGU+LCBmbGF0IHNoYWRpbmcgaXMgdXNlZCBpbiB0aGUgZnJhZ21lbnQgc2hhZGVyLFxuICAgKiB3aGljaCBtZWFucyBsaWdodGluZyBpcyBub3QgdGFraW5nIGludG8gYWNjb3VudC5cbiAgICpcbiAgICogQG1lbWJlcm9mIFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlLnByb3RvdHlwZVxuICAgKlxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEBkZWZhdWx0IGZhbHNlXG4gICAqL1xuICBmbGF0OiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZmxhdDtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBXaGVuIDxjb2RlPnRydWU8L2NvZGU+LCB0aGUgZnJhZ21lbnQgc2hhZGVyIGZsaXBzIHRoZSBzdXJmYWNlIG5vcm1hbFxuICAgKiBhcyBuZWVkZWQgdG8gZW5zdXJlIHRoYXQgdGhlIG5vcm1hbCBmYWNlcyB0aGUgdmlld2VyIHRvIGF2b2lkXG4gICAqIGRhcmsgc3BvdHMuICBUaGlzIGlzIHVzZWZ1bCB3aGVuIGJvdGggc2lkZXMgb2YgYSBnZW9tZXRyeSBzaG91bGQgYmVcbiAgICogc2hhZGVkIGxpa2Uge0BsaW5rIFdhbGxHZW9tZXRyeX0uXG4gICAqXG4gICAqIEBtZW1iZXJvZiBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZS5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqIEByZWFkb25seVxuICAgKlxuICAgKiBAZGVmYXVsdCB0cnVlXG4gICAqL1xuICBmYWNlRm9yd2FyZDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2ZhY2VGb3J3YXJkO1xuICAgIH0sXG4gIH0sXG59KTtcblxuLyoqXG4gKiBUaGUge0BsaW5rIFZlcnRleEZvcm1hdH0gdGhhdCBhbGwge0BsaW5rIFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlfSBpbnN0YW5jZXNcbiAqIGFyZSBjb21wYXRpYmxlIHdpdGguICBUaGlzIHJlcXVpcmVzIG9ubHkgPGNvZGU+cG9zaXRpb248L2NvZGU+IGFuZCA8Y29kZT5ub3JtYWw8L2NvZGU+XG4gKiBhdHRyaWJ1dGVzLlxuICpcbiAqIEB0eXBlIFZlcnRleEZvcm1hdFxuICpcbiAqIEBjb25zdGFudFxuICovXG5QZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZS5WRVJURVhfRk9STUFUID0gVmVydGV4Rm9ybWF0LlBPU0lUSU9OX0FORF9OT1JNQUw7XG5cbi8qKlxuICogVGhlIHtAbGluayBWZXJ0ZXhGb3JtYXR9IHRoYXQgYWxsIHtAbGluayBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZX0gaW5zdGFuY2VzXG4gKiBhcmUgY29tcGF0aWJsZSB3aXRoIHdoZW4ge0BsaW5rIFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlI2ZsYXR9IGlzIDxjb2RlPnRydWU8L2NvZGU+LlxuICogVGhpcyByZXF1aXJlcyBvbmx5IGEgPGNvZGU+cG9zaXRpb248L2NvZGU+IGF0dHJpYnV0ZS5cbiAqXG4gKiBAdHlwZSBWZXJ0ZXhGb3JtYXRcbiAqXG4gKiBAY29uc3RhbnRcbiAqL1xuUGVySW5zdGFuY2VDb2xvckFwcGVhcmFuY2UuRkxBVF9WRVJURVhfRk9STUFUID0gVmVydGV4Rm9ybWF0LlBPU0lUSU9OX09OTFk7XG5cbi8qKlxuICogUHJvY2VkdXJhbGx5IGNyZWF0ZXMgdGhlIGZ1bGwgR0xTTCBmcmFnbWVudCBzaGFkZXIgc291cmNlLiAgRm9yIHtAbGluayBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZX0sXG4gKiB0aGlzIGlzIGRlcml2ZWQgZnJvbSB7QGxpbmsgUGVySW5zdGFuY2VDb2xvckFwcGVhcmFuY2UjZnJhZ21lbnRTaGFkZXJTb3VyY2V9LCB7QGxpbmsgUGVySW5zdGFuY2VDb2xvckFwcGVhcmFuY2UjZmxhdH0sXG4gKiBhbmQge0BsaW5rIFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlI2ZhY2VGb3J3YXJkfS5cbiAqXG4gKiBAZnVuY3Rpb25cbiAqXG4gKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgZnVsbCBHTFNMIGZyYWdtZW50IHNoYWRlciBzb3VyY2UuXG4gKi9cblBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlLnByb3RvdHlwZS5nZXRGcmFnbWVudFNoYWRlclNvdXJjZSA9XG4gIEFwcGVhcmFuY2UucHJvdG90eXBlLmdldEZyYWdtZW50U2hhZGVyU291cmNlO1xuXG4vKipcbiAqIERldGVybWluZXMgaWYgdGhlIGdlb21ldHJ5IGlzIHRyYW5zbHVjZW50IGJhc2VkIG9uIHtAbGluayBQZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZSN0cmFuc2x1Y2VudH0uXG4gKlxuICogQGZ1bmN0aW9uXG4gKlxuICogQHJldHVybnMge0Jvb2xlYW59IDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoZSBhcHBlYXJhbmNlIGlzIHRyYW5zbHVjZW50LlxuICovXG5QZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZS5wcm90b3R5cGUuaXNUcmFuc2x1Y2VudCA9XG4gIEFwcGVhcmFuY2UucHJvdG90eXBlLmlzVHJhbnNsdWNlbnQ7XG5cbi8qKlxuICogQ3JlYXRlcyBhIHJlbmRlciBzdGF0ZS4gIFRoaXMgaXMgbm90IHRoZSBmaW5hbCByZW5kZXIgc3RhdGUgaW5zdGFuY2U7IGluc3RlYWQsXG4gKiBpdCBjYW4gY29udGFpbiBhIHN1YnNldCBvZiByZW5kZXIgc3RhdGUgcHJvcGVydGllcyBpZGVudGljYWwgdG8gdGhlIHJlbmRlciBzdGF0ZVxuICogY3JlYXRlZCBpbiB0aGUgY29udGV4dC5cbiAqXG4gKiBAZnVuY3Rpb25cbiAqXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBUaGUgcmVuZGVyIHN0YXRlLlxuICovXG5QZXJJbnN0YW5jZUNvbG9yQXBwZWFyYW5jZS5wcm90b3R5cGUuZ2V0UmVuZGVyU3RhdGUgPVxuICBBcHBlYXJhbmNlLnByb3RvdHlwZS5nZXRSZW5kZXJTdGF0ZTtcbmV4cG9ydCBkZWZhdWx0IFBlckluc3RhbmNlQ29sb3JBcHBlYXJhbmNlO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///64060\n')},73829:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(82982);\n/* harmony import */ var _Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(86511);\n/* harmony import */ var _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12572);\n/* harmony import */ var _Core_getTimestamp_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(59081);\n/* harmony import */ var _Widgets_getElement_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(43412);\n\n\n\n\n\n\n\n/**\n * @private\n */\nfunction PerformanceDisplay(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n\n  var container = (0,_Widgets_getElement_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(options.container);\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(container)) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z("container is required");\n  }\n  //>>includeEnd(\'debug\');\n\n  this._container = container;\n\n  var display = document.createElement("div");\n  display.className = "cesium-performanceDisplay";\n  var fpsElement = document.createElement("div");\n  fpsElement.className = "cesium-performanceDisplay-fps";\n  this._fpsText = document.createTextNode("");\n  fpsElement.appendChild(this._fpsText);\n  var msElement = document.createElement("div");\n  msElement.className = "cesium-performanceDisplay-ms";\n  this._msText = document.createTextNode("");\n  msElement.appendChild(this._msText);\n  display.appendChild(msElement);\n  display.appendChild(fpsElement);\n  this._container.appendChild(display);\n\n  this._lastFpsSampleTime = (0,_Core_getTimestamp_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)();\n  this._lastMsSampleTime = (0,_Core_getTimestamp_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)();\n  this._fpsFrameCount = 0;\n  this._msFrameCount = 0;\n\n  this._throttled = false;\n  var throttledElement = document.createElement("div");\n  throttledElement.className = "cesium-performanceDisplay-throttled";\n  this._throttledText = document.createTextNode("");\n  throttledElement.appendChild(this._throttledText);\n  display.appendChild(throttledElement);\n}\n\nObject.defineProperties(PerformanceDisplay.prototype, {\n  /**\n   * The display should indicate the FPS is being throttled.\n   * @memberof PerformanceDisplay.prototype\n   *\n   * @type {Boolean}\n   */\n  throttled: {\n    get: function () {\n      return this._throttled;\n    },\n    set: function (value) {\n      if (this._throttled === value) {\n        return;\n      }\n\n      if (value) {\n        this._throttledText.nodeValue = "(throttled)";\n      } else {\n        this._throttledText.nodeValue = "";\n      }\n\n      this._throttled = value;\n    },\n  },\n});\n\n/**\n * Update the display.  This function should only be called once per frame, because\n * each call records a frame in the internal buffer and redraws the display.\n *\n * @param {Boolean} [renderedThisFrame=true] If provided, the FPS count will only update and display if true.\n */\nPerformanceDisplay.prototype.update = function (renderedThisFrame) {\n  var time = (0,_Core_getTimestamp_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)();\n  var updateDisplay = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(renderedThisFrame, true);\n\n  this._fpsFrameCount++;\n  var fpsElapsedTime = time - this._lastFpsSampleTime;\n  if (fpsElapsedTime > 1000) {\n    var fps = "N/A";\n    if (updateDisplay) {\n      fps = ((this._fpsFrameCount * 1000) / fpsElapsedTime) | 0;\n    }\n\n    this._fpsText.nodeValue = fps + " FPS";\n    this._lastFpsSampleTime = time;\n    this._fpsFrameCount = 0;\n  }\n\n  this._msFrameCount++;\n  var msElapsedTime = time - this._lastMsSampleTime;\n  if (msElapsedTime > 200) {\n    var ms = "N/A";\n    if (updateDisplay) {\n      ms = (msElapsedTime / this._msFrameCount).toFixed(2);\n    }\n\n    this._msText.nodeValue = ms + " MS";\n    this._lastMsSampleTime = time;\n    this._msFrameCount = 0;\n  }\n};\n\n/**\n * Destroys the WebGL resources held by this object.\n */\nPerformanceDisplay.prototype.destroy = function () {\n  return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(this);\n};\n/* harmony default export */ __webpack_exports__["Z"] = (PerformanceDisplay);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzM4MjkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQW1EO0FBQ1Y7QUFDWTtBQUNFO0FBQ0o7QUFDRDs7QUFFbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDBFQUFZLFVBQVUsZ0dBQXlCOztBQUUzRCxrQkFBa0IsMkVBQVU7QUFDNUI7QUFDQSxPQUFPLHFFQUFPO0FBQ2QsY0FBYyx3RUFBYztBQUM1QjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDRCQUE0QiwwRUFBWTtBQUN4QywyQkFBMkIsMEVBQVk7QUFDdkM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0gsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsU0FBUztBQUNwQjtBQUNBO0FBQ0EsYUFBYSwwRUFBWTtBQUN6QixzQkFBc0IsMEVBQVk7O0FBRWxDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLDJFQUFhO0FBQ3RCO0FBQ0EseURBQWUsa0JBQWtCLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92dWUzLXdlYnBhY2s1Ly4vbm9kZV9tb2R1bGVzL2Nlc2l1bS9Tb3VyY2UvU2NlbmUvUGVyZm9ybWFuY2VEaXNwbGF5LmpzP2IxMDEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGRlZmF1bHRWYWx1ZSBmcm9tIFwiLi4vQ29yZS9kZWZhdWx0VmFsdWUuanNcIjtcbmltcG9ydCBkZWZpbmVkIGZyb20gXCIuLi9Db3JlL2RlZmluZWQuanNcIjtcbmltcG9ydCBkZXN0cm95T2JqZWN0IGZyb20gXCIuLi9Db3JlL2Rlc3Ryb3lPYmplY3QuanNcIjtcbmltcG9ydCBEZXZlbG9wZXJFcnJvciBmcm9tIFwiLi4vQ29yZS9EZXZlbG9wZXJFcnJvci5qc1wiO1xuaW1wb3J0IGdldFRpbWVzdGFtcCBmcm9tIFwiLi4vQ29yZS9nZXRUaW1lc3RhbXAuanNcIjtcbmltcG9ydCBnZXRFbGVtZW50IGZyb20gXCIuLi9XaWRnZXRzL2dldEVsZW1lbnQuanNcIjtcblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBQZXJmb3JtYW5jZURpc3BsYXkob3B0aW9ucykge1xuICBvcHRpb25zID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMsIGRlZmF1bHRWYWx1ZS5FTVBUWV9PQkpFQ1QpO1xuXG4gIHZhciBjb250YWluZXIgPSBnZXRFbGVtZW50KG9wdGlvbnMuY29udGFpbmVyKTtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgaWYgKCFkZWZpbmVkKGNvbnRhaW5lcikpIHtcbiAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXCJjb250YWluZXIgaXMgcmVxdWlyZWRcIik7XG4gIH1cbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xuXG4gIHZhciBkaXNwbGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgZGlzcGxheS5jbGFzc05hbWUgPSBcImNlc2l1bS1wZXJmb3JtYW5jZURpc3BsYXlcIjtcbiAgdmFyIGZwc0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBmcHNFbGVtZW50LmNsYXNzTmFtZSA9IFwiY2VzaXVtLXBlcmZvcm1hbmNlRGlzcGxheS1mcHNcIjtcbiAgdGhpcy5fZnBzVGV4dCA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFwiXCIpO1xuICBmcHNFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuX2Zwc1RleHQpO1xuICB2YXIgbXNFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgbXNFbGVtZW50LmNsYXNzTmFtZSA9IFwiY2VzaXVtLXBlcmZvcm1hbmNlRGlzcGxheS1tc1wiO1xuICB0aGlzLl9tc1RleHQgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcIlwiKTtcbiAgbXNFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuX21zVGV4dCk7XG4gIGRpc3BsYXkuYXBwZW5kQ2hpbGQobXNFbGVtZW50KTtcbiAgZGlzcGxheS5hcHBlbmRDaGlsZChmcHNFbGVtZW50KTtcbiAgdGhpcy5fY29udGFpbmVyLmFwcGVuZENoaWxkKGRpc3BsYXkpO1xuXG4gIHRoaXMuX2xhc3RGcHNTYW1wbGVUaW1lID0gZ2V0VGltZXN0YW1wKCk7XG4gIHRoaXMuX2xhc3RNc1NhbXBsZVRpbWUgPSBnZXRUaW1lc3RhbXAoKTtcbiAgdGhpcy5fZnBzRnJhbWVDb3VudCA9IDA7XG4gIHRoaXMuX21zRnJhbWVDb3VudCA9IDA7XG5cbiAgdGhpcy5fdGhyb3R0bGVkID0gZmFsc2U7XG4gIHZhciB0aHJvdHRsZWRFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgdGhyb3R0bGVkRWxlbWVudC5jbGFzc05hbWUgPSBcImNlc2l1bS1wZXJmb3JtYW5jZURpc3BsYXktdGhyb3R0bGVkXCI7XG4gIHRoaXMuX3Rocm90dGxlZFRleHQgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcIlwiKTtcbiAgdGhyb3R0bGVkRWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLl90aHJvdHRsZWRUZXh0KTtcbiAgZGlzcGxheS5hcHBlbmRDaGlsZCh0aHJvdHRsZWRFbGVtZW50KTtcbn1cblxuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoUGVyZm9ybWFuY2VEaXNwbGF5LnByb3RvdHlwZSwge1xuICAvKipcbiAgICogVGhlIGRpc3BsYXkgc2hvdWxkIGluZGljYXRlIHRoZSBGUFMgaXMgYmVpbmcgdGhyb3R0bGVkLlxuICAgKiBAbWVtYmVyb2YgUGVyZm9ybWFuY2VEaXNwbGF5LnByb3RvdHlwZVxuICAgKlxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICovXG4gIHRocm90dGxlZDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3Rocm90dGxlZDtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICBpZiAodGhpcy5fdGhyb3R0bGVkID09PSB2YWx1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl90aHJvdHRsZWRUZXh0Lm5vZGVWYWx1ZSA9IFwiKHRocm90dGxlZClcIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3Rocm90dGxlZFRleHQubm9kZVZhbHVlID0gXCJcIjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fdGhyb3R0bGVkID0gdmFsdWU7XG4gICAgfSxcbiAgfSxcbn0pO1xuXG4vKipcbiAqIFVwZGF0ZSB0aGUgZGlzcGxheS4gIFRoaXMgZnVuY3Rpb24gc2hvdWxkIG9ubHkgYmUgY2FsbGVkIG9uY2UgcGVyIGZyYW1lLCBiZWNhdXNlXG4gKiBlYWNoIGNhbGwgcmVjb3JkcyBhIGZyYW1lIGluIHRoZSBpbnRlcm5hbCBidWZmZXIgYW5kIHJlZHJhd3MgdGhlIGRpc3BsYXkuXG4gKlxuICogQHBhcmFtIHtCb29sZWFufSBbcmVuZGVyZWRUaGlzRnJhbWU9dHJ1ZV0gSWYgcHJvdmlkZWQsIHRoZSBGUFMgY291bnQgd2lsbCBvbmx5IHVwZGF0ZSBhbmQgZGlzcGxheSBpZiB0cnVlLlxuICovXG5QZXJmb3JtYW5jZURpc3BsYXkucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChyZW5kZXJlZFRoaXNGcmFtZSkge1xuICB2YXIgdGltZSA9IGdldFRpbWVzdGFtcCgpO1xuICB2YXIgdXBkYXRlRGlzcGxheSA9IGRlZmF1bHRWYWx1ZShyZW5kZXJlZFRoaXNGcmFtZSwgdHJ1ZSk7XG5cbiAgdGhpcy5fZnBzRnJhbWVDb3VudCsrO1xuICB2YXIgZnBzRWxhcHNlZFRpbWUgPSB0aW1lIC0gdGhpcy5fbGFzdEZwc1NhbXBsZVRpbWU7XG4gIGlmIChmcHNFbGFwc2VkVGltZSA+IDEwMDApIHtcbiAgICB2YXIgZnBzID0gXCJOL0FcIjtcbiAgICBpZiAodXBkYXRlRGlzcGxheSkge1xuICAgICAgZnBzID0gKCh0aGlzLl9mcHNGcmFtZUNvdW50ICogMTAwMCkgLyBmcHNFbGFwc2VkVGltZSkgfCAwO1xuICAgIH1cblxuICAgIHRoaXMuX2Zwc1RleHQubm9kZVZhbHVlID0gZnBzICsgXCIgRlBTXCI7XG4gICAgdGhpcy5fbGFzdEZwc1NhbXBsZVRpbWUgPSB0aW1lO1xuICAgIHRoaXMuX2Zwc0ZyYW1lQ291bnQgPSAwO1xuICB9XG5cbiAgdGhpcy5fbXNGcmFtZUNvdW50Kys7XG4gIHZhciBtc0VsYXBzZWRUaW1lID0gdGltZSAtIHRoaXMuX2xhc3RNc1NhbXBsZVRpbWU7XG4gIGlmIChtc0VsYXBzZWRUaW1lID4gMjAwKSB7XG4gICAgdmFyIG1zID0gXCJOL0FcIjtcbiAgICBpZiAodXBkYXRlRGlzcGxheSkge1xuICAgICAgbXMgPSAobXNFbGFwc2VkVGltZSAvIHRoaXMuX21zRnJhbWVDb3VudCkudG9GaXhlZCgyKTtcbiAgICB9XG5cbiAgICB0aGlzLl9tc1RleHQubm9kZVZhbHVlID0gbXMgKyBcIiBNU1wiO1xuICAgIHRoaXMuX2xhc3RNc1NhbXBsZVRpbWUgPSB0aW1lO1xuICAgIHRoaXMuX21zRnJhbWVDb3VudCA9IDA7XG4gIH1cbn07XG5cbi8qKlxuICogRGVzdHJveXMgdGhlIFdlYkdMIHJlc291cmNlcyBoZWxkIGJ5IHRoaXMgb2JqZWN0LlxuICovXG5QZXJmb3JtYW5jZURpc3BsYXkucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBkZXN0cm95T2JqZWN0KHRoaXMpO1xufTtcbmV4cG9ydCBkZWZhdWx0IFBlcmZvcm1hbmNlRGlzcGxheTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///73829\n')},43623:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(63367);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(82982);\n/* harmony import */ var _Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(86511);\n/* harmony import */ var _Core_PixelFormat_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(38443);\n/* harmony import */ var _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2932);\n/* harmony import */ var _Renderer_PixelDatatype_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(21572);\n/* harmony import */ var _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(10667);\n/* harmony import */ var _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(53642);\n/* harmony import */ var _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(8743);\n\n\n\n\n\n\n\n\n\n\n/**\n * @private\n */\nfunction PickDepth() {\n  this._framebuffer = undefined;\n\n  this._depthTexture = undefined;\n  this._textureToCopy = undefined;\n  this._copyDepthCommand = undefined;\n\n  this._useLogDepth = undefined;\n\n  this._debugPickDepthViewportCommand = undefined;\n}\n\nfunction executeDebugPickDepth(pickDepth, context, passState, useLogDepth) {\n  if (\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(pickDepth._debugPickDepthViewportCommand) ||\n    useLogDepth !== pickDepth._useLogDepth\n  ) {\n    var fsSource =\n      "uniform highp sampler2D u_texture;\\n" +\n      "varying vec2 v_textureCoordinates;\\n" +\n      "void main()\\n" +\n      "{\\n" +\n      "    float z_window = czm_unpackDepth(texture2D(u_texture, v_textureCoordinates));\\n" +\n      "    z_window = czm_reverseLogDepth(z_window); \\n" +\n      "    float n_range = czm_depthRange.near;\\n" +\n      "    float f_range = czm_depthRange.far;\\n" +\n      "    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\\n" +\n      "    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\\n" +\n      "    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\\n" +\n      "}\\n";\n    var fs = new _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z({\n      defines: [useLogDepth ? "LOG_DEPTH" : ""],\n      sources: [fsSource],\n    });\n\n    pickDepth._debugPickDepthViewportCommand = context.createViewportQuadCommand(\n      fs,\n      {\n        uniformMap: {\n          u_texture: function () {\n            return pickDepth._depthTexture;\n          },\n        },\n        owner: pickDepth,\n      }\n    );\n\n    pickDepth._useLogDepth = useLogDepth;\n  }\n\n  pickDepth._debugPickDepthViewportCommand.execute(context, passState);\n}\n\nfunction destroyTextures(pickDepth) {\n  pickDepth._depthTexture =\n    pickDepth._depthTexture &&\n    !pickDepth._depthTexture.isDestroyed() &&\n    pickDepth._depthTexture.destroy();\n}\n\nfunction destroyFramebuffers(pickDepth) {\n  pickDepth._framebuffer =\n    pickDepth._framebuffer &&\n    !pickDepth._framebuffer.isDestroyed() &&\n    pickDepth._framebuffer.destroy();\n}\n\nfunction createTextures(pickDepth, context, width, height) {\n  pickDepth._depthTexture = new _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n    context: context,\n    width: width,\n    height: height,\n    pixelFormat: _Core_PixelFormat_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].RGBA */ .Z.RGBA,\n    pixelDatatype: _Renderer_PixelDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].UNSIGNED_BYTE */ .Z.UNSIGNED_BYTE,\n  });\n}\n\nfunction createFramebuffers(pickDepth, context, width, height) {\n  destroyTextures(pickDepth);\n  destroyFramebuffers(pickDepth);\n\n  createTextures(pickDepth, context, width, height);\n\n  pickDepth._framebuffer = new _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z({\n    context: context,\n    colorTextures: [pickDepth._depthTexture],\n    destroyAttachments: false,\n  });\n}\n\nfunction updateFramebuffers(pickDepth, context, depthTexture) {\n  var width = depthTexture.width;\n  var height = depthTexture.height;\n\n  var texture = pickDepth._depthTexture;\n  var textureChanged =\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(texture) || texture.width !== width || texture.height !== height;\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(pickDepth._framebuffer) || textureChanged) {\n    createFramebuffers(pickDepth, context, width, height);\n  }\n}\n\nfunction updateCopyCommands(pickDepth, context, depthTexture) {\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(pickDepth._copyDepthCommand)) {\n    var fs =\n      "uniform highp sampler2D u_texture;\\n" +\n      "varying vec2 v_textureCoordinates;\\n" +\n      "void main()\\n" +\n      "{\\n" +\n      "    gl_FragColor = czm_packDepth(texture2D(u_texture, v_textureCoordinates).r);\\n" +\n      "}\\n";\n    pickDepth._copyDepthCommand = context.createViewportQuadCommand(fs, {\n      renderState: _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].fromCache */ .Z.fromCache(),\n      uniformMap: {\n        u_texture: function () {\n          return pickDepth._textureToCopy;\n        },\n      },\n      owner: pickDepth,\n    });\n  }\n\n  pickDepth._textureToCopy = depthTexture;\n  pickDepth._copyDepthCommand.framebuffer = pickDepth._framebuffer;\n}\n\nPickDepth.prototype.executeDebugPickDepth = function (\n  context,\n  passState,\n  useLogDepth\n) {\n  executeDebugPickDepth(this, context, passState, useLogDepth);\n};\n\nPickDepth.prototype.update = function (context, depthTexture) {\n  updateFramebuffers(this, context, depthTexture);\n  updateCopyCommands(this, context, depthTexture);\n};\n\nvar scratchPackedDepth = new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\nvar packedDepthScale = new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(\n  1.0,\n  1.0 / 255.0,\n  1.0 / 65025.0,\n  1.0 / 16581375.0\n);\n\nPickDepth.prototype.getDepth = function (context, x, y) {\n  // If this function is called before the framebuffer is created, the depth is undefined.\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(this._framebuffer)) {\n    return undefined;\n  }\n\n  var pixels = context.readPixels({\n    x: x,\n    y: y,\n    width: 1,\n    height: 1,\n    framebuffer: this._framebuffer,\n  });\n\n  var packedDepth = _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].unpack */ .Z.unpack(pixels, 0, scratchPackedDepth);\n  _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].divideByScalar */ .Z.divideByScalar(packedDepth, 255.0, packedDepth);\n  return _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].dot */ .Z.dot(packedDepth, packedDepthScale);\n};\n\nPickDepth.prototype.executeCopyDepth = function (context, passState) {\n  this._copyDepthCommand.execute(context, passState);\n};\n\nPickDepth.prototype.isDestroyed = function () {\n  return false;\n};\n\nPickDepth.prototype.destroy = function () {\n  destroyTextures(this);\n  destroyFramebuffers(this);\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(this._copyDepthCommand)) {\n    this._copyDepthCommand.shaderProgram =\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(this._copyDepthCommand.shaderProgram) &&\n      this._copyDepthCommand.shaderProgram.destroy();\n  }\n\n  return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(this);\n};\n/* harmony default export */ __webpack_exports__["Z"] = (PickDepth);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDM2MjMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQStDO0FBQ047QUFDWTtBQUNKO0FBQ0k7QUFDSTtBQUNKO0FBQ0U7QUFDVjs7QUFFN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSyxxRUFBTztBQUNaO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6Qyx5Q0FBeUM7QUFDekM7QUFDQSxRQUFRO0FBQ1Isd0ZBQXdGO0FBQ3hGLHFEQUFxRDtBQUNyRCwrQ0FBK0M7QUFDL0MsOENBQThDO0FBQzlDLG9GQUFvRjtBQUNwRixxREFBcUQ7QUFDckQsc0VBQXNFO0FBQ3RFLFFBQVE7QUFDUixpQkFBaUIsMEVBQVk7QUFDN0I7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxnQ0FBZ0MscUVBQU87QUFDdkM7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLCtFQUFnQjtBQUNqQyxtQkFBbUIsdUdBQTJCO0FBQzlDLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsK0JBQStCLHlFQUFXO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUsscUVBQU87QUFDWixPQUFPLHFFQUFPO0FBQ2Q7QUFDQTtBQUNBOztBQUVBO0FBQ0EsT0FBTyxxRUFBTztBQUNkO0FBQ0EseUNBQXlDO0FBQ3pDLHlDQUF5QztBQUN6QztBQUNBLFFBQVE7QUFDUixzRkFBc0Y7QUFDdEYsUUFBUTtBQUNSO0FBQ0EsbUJBQW1CLDZGQUFxQjtBQUN4QztBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSw2QkFBNkIsb0VBQVU7QUFDdkMsMkJBQTJCLG9FQUFVO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE9BQU8scUVBQU87QUFDZDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUgsb0JBQW9CLGtGQUFpQjtBQUNyQyxFQUFFLGtHQUF5QjtBQUMzQixTQUFTLDRFQUFjO0FBQ3ZCOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLE1BQU0scUVBQU87QUFDYjtBQUNBLE1BQU0scUVBQU87QUFDYjtBQUNBOztBQUVBLFNBQVMsMkVBQWE7QUFDdEI7QUFDQSx5REFBZSxTQUFTLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92dWUzLXdlYnBhY2s1Ly4vbm9kZV9tb2R1bGVzL2Nlc2l1bS9Tb3VyY2UvU2NlbmUvUGlja0RlcHRoLmpzP2JiOWEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENhcnRlc2lhbjQgZnJvbSBcIi4uL0NvcmUvQ2FydGVzaWFuNC5qc1wiO1xuaW1wb3J0IGRlZmluZWQgZnJvbSBcIi4uL0NvcmUvZGVmaW5lZC5qc1wiO1xuaW1wb3J0IGRlc3Ryb3lPYmplY3QgZnJvbSBcIi4uL0NvcmUvZGVzdHJveU9iamVjdC5qc1wiO1xuaW1wb3J0IFBpeGVsRm9ybWF0IGZyb20gXCIuLi9Db3JlL1BpeGVsRm9ybWF0LmpzXCI7XG5pbXBvcnQgRnJhbWVidWZmZXIgZnJvbSBcIi4uL1JlbmRlcmVyL0ZyYW1lYnVmZmVyLmpzXCI7XG5pbXBvcnQgUGl4ZWxEYXRhdHlwZSBmcm9tIFwiLi4vUmVuZGVyZXIvUGl4ZWxEYXRhdHlwZS5qc1wiO1xuaW1wb3J0IFJlbmRlclN0YXRlIGZyb20gXCIuLi9SZW5kZXJlci9SZW5kZXJTdGF0ZS5qc1wiO1xuaW1wb3J0IFNoYWRlclNvdXJjZSBmcm9tIFwiLi4vUmVuZGVyZXIvU2hhZGVyU291cmNlLmpzXCI7XG5pbXBvcnQgVGV4dHVyZSBmcm9tIFwiLi4vUmVuZGVyZXIvVGV4dHVyZS5qc1wiO1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIFBpY2tEZXB0aCgpIHtcbiAgdGhpcy5fZnJhbWVidWZmZXIgPSB1bmRlZmluZWQ7XG5cbiAgdGhpcy5fZGVwdGhUZXh0dXJlID0gdW5kZWZpbmVkO1xuICB0aGlzLl90ZXh0dXJlVG9Db3B5ID0gdW5kZWZpbmVkO1xuICB0aGlzLl9jb3B5RGVwdGhDb21tYW5kID0gdW5kZWZpbmVkO1xuXG4gIHRoaXMuX3VzZUxvZ0RlcHRoID0gdW5kZWZpbmVkO1xuXG4gIHRoaXMuX2RlYnVnUGlja0RlcHRoVmlld3BvcnRDb21tYW5kID0gdW5kZWZpbmVkO1xufVxuXG5mdW5jdGlvbiBleGVjdXRlRGVidWdQaWNrRGVwdGgocGlja0RlcHRoLCBjb250ZXh0LCBwYXNzU3RhdGUsIHVzZUxvZ0RlcHRoKSB7XG4gIGlmIChcbiAgICAhZGVmaW5lZChwaWNrRGVwdGguX2RlYnVnUGlja0RlcHRoVmlld3BvcnRDb21tYW5kKSB8fFxuICAgIHVzZUxvZ0RlcHRoICE9PSBwaWNrRGVwdGguX3VzZUxvZ0RlcHRoXG4gICkge1xuICAgIHZhciBmc1NvdXJjZSA9XG4gICAgICBcInVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEIHVfdGV4dHVyZTtcXG5cIiArXG4gICAgICBcInZhcnlpbmcgdmVjMiB2X3RleHR1cmVDb29yZGluYXRlcztcXG5cIiArXG4gICAgICBcInZvaWQgbWFpbigpXFxuXCIgK1xuICAgICAgXCJ7XFxuXCIgK1xuICAgICAgXCIgICAgZmxvYXQgel93aW5kb3cgPSBjem1fdW5wYWNrRGVwdGgodGV4dHVyZTJEKHVfdGV4dHVyZSwgdl90ZXh0dXJlQ29vcmRpbmF0ZXMpKTtcXG5cIiArXG4gICAgICBcIiAgICB6X3dpbmRvdyA9IGN6bV9yZXZlcnNlTG9nRGVwdGgoel93aW5kb3cpOyBcXG5cIiArXG4gICAgICBcIiAgICBmbG9hdCBuX3JhbmdlID0gY3ptX2RlcHRoUmFuZ2UubmVhcjtcXG5cIiArXG4gICAgICBcIiAgICBmbG9hdCBmX3JhbmdlID0gY3ptX2RlcHRoUmFuZ2UuZmFyO1xcblwiICtcbiAgICAgIFwiICAgIGZsb2F0IHpfbmRjID0gKDIuMCAqIHpfd2luZG93IC0gbl9yYW5nZSAtIGZfcmFuZ2UpIC8gKGZfcmFuZ2UgLSBuX3JhbmdlKTtcXG5cIiArXG4gICAgICBcIiAgICBmbG9hdCBzY2FsZSA9IHBvdyh6X25kYyAqIDAuNSArIDAuNSwgOC4wKTtcXG5cIiArXG4gICAgICBcIiAgICBnbF9GcmFnQ29sb3IgPSB2ZWM0KG1peCh2ZWMzKDAuMCksIHZlYzMoMS4wKSwgc2NhbGUpLCAxLjApO1xcblwiICtcbiAgICAgIFwifVxcblwiO1xuICAgIHZhciBmcyA9IG5ldyBTaGFkZXJTb3VyY2Uoe1xuICAgICAgZGVmaW5lczogW3VzZUxvZ0RlcHRoID8gXCJMT0dfREVQVEhcIiA6IFwiXCJdLFxuICAgICAgc291cmNlczogW2ZzU291cmNlXSxcbiAgICB9KTtcblxuICAgIHBpY2tEZXB0aC5fZGVidWdQaWNrRGVwdGhWaWV3cG9ydENvbW1hbmQgPSBjb250ZXh0LmNyZWF0ZVZpZXdwb3J0UXVhZENvbW1hbmQoXG4gICAgICBmcyxcbiAgICAgIHtcbiAgICAgICAgdW5pZm9ybU1hcDoge1xuICAgICAgICAgIHVfdGV4dHVyZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHBpY2tEZXB0aC5fZGVwdGhUZXh0dXJlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIG93bmVyOiBwaWNrRGVwdGgsXG4gICAgICB9XG4gICAgKTtcblxuICAgIHBpY2tEZXB0aC5fdXNlTG9nRGVwdGggPSB1c2VMb2dEZXB0aDtcbiAgfVxuXG4gIHBpY2tEZXB0aC5fZGVidWdQaWNrRGVwdGhWaWV3cG9ydENvbW1hbmQuZXhlY3V0ZShjb250ZXh0LCBwYXNzU3RhdGUpO1xufVxuXG5mdW5jdGlvbiBkZXN0cm95VGV4dHVyZXMocGlja0RlcHRoKSB7XG4gIHBpY2tEZXB0aC5fZGVwdGhUZXh0dXJlID1cbiAgICBwaWNrRGVwdGguX2RlcHRoVGV4dHVyZSAmJlxuICAgICFwaWNrRGVwdGguX2RlcHRoVGV4dHVyZS5pc0Rlc3Ryb3llZCgpICYmXG4gICAgcGlja0RlcHRoLl9kZXB0aFRleHR1cmUuZGVzdHJveSgpO1xufVxuXG5mdW5jdGlvbiBkZXN0cm95RnJhbWVidWZmZXJzKHBpY2tEZXB0aCkge1xuICBwaWNrRGVwdGguX2ZyYW1lYnVmZmVyID1cbiAgICBwaWNrRGVwdGguX2ZyYW1lYnVmZmVyICYmXG4gICAgIXBpY2tEZXB0aC5fZnJhbWVidWZmZXIuaXNEZXN0cm95ZWQoKSAmJlxuICAgIHBpY2tEZXB0aC5fZnJhbWVidWZmZXIuZGVzdHJveSgpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVUZXh0dXJlcyhwaWNrRGVwdGgsIGNvbnRleHQsIHdpZHRoLCBoZWlnaHQpIHtcbiAgcGlja0RlcHRoLl9kZXB0aFRleHR1cmUgPSBuZXcgVGV4dHVyZSh7XG4gICAgY29udGV4dDogY29udGV4dCxcbiAgICB3aWR0aDogd2lkdGgsXG4gICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgcGl4ZWxGb3JtYXQ6IFBpeGVsRm9ybWF0LlJHQkEsXG4gICAgcGl4ZWxEYXRhdHlwZTogUGl4ZWxEYXRhdHlwZS5VTlNJR05FRF9CWVRFLFxuICB9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlRnJhbWVidWZmZXJzKHBpY2tEZXB0aCwgY29udGV4dCwgd2lkdGgsIGhlaWdodCkge1xuICBkZXN0cm95VGV4dHVyZXMocGlja0RlcHRoKTtcbiAgZGVzdHJveUZyYW1lYnVmZmVycyhwaWNrRGVwdGgpO1xuXG4gIGNyZWF0ZVRleHR1cmVzKHBpY2tEZXB0aCwgY29udGV4dCwgd2lkdGgsIGhlaWdodCk7XG5cbiAgcGlja0RlcHRoLl9mcmFtZWJ1ZmZlciA9IG5ldyBGcmFtZWJ1ZmZlcih7XG4gICAgY29udGV4dDogY29udGV4dCxcbiAgICBjb2xvclRleHR1cmVzOiBbcGlja0RlcHRoLl9kZXB0aFRleHR1cmVdLFxuICAgIGRlc3Ryb3lBdHRhY2htZW50czogZmFsc2UsXG4gIH0pO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVGcmFtZWJ1ZmZlcnMocGlja0RlcHRoLCBjb250ZXh0LCBkZXB0aFRleHR1cmUpIHtcbiAgdmFyIHdpZHRoID0gZGVwdGhUZXh0dXJlLndpZHRoO1xuICB2YXIgaGVpZ2h0ID0gZGVwdGhUZXh0dXJlLmhlaWdodDtcblxuICB2YXIgdGV4dHVyZSA9IHBpY2tEZXB0aC5fZGVwdGhUZXh0dXJlO1xuICB2YXIgdGV4dHVyZUNoYW5nZWQgPVxuICAgICFkZWZpbmVkKHRleHR1cmUpIHx8IHRleHR1cmUud2lkdGggIT09IHdpZHRoIHx8IHRleHR1cmUuaGVpZ2h0ICE9PSBoZWlnaHQ7XG4gIGlmICghZGVmaW5lZChwaWNrRGVwdGguX2ZyYW1lYnVmZmVyKSB8fCB0ZXh0dXJlQ2hhbmdlZCkge1xuICAgIGNyZWF0ZUZyYW1lYnVmZmVycyhwaWNrRGVwdGgsIGNvbnRleHQsIHdpZHRoLCBoZWlnaHQpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUNvcHlDb21tYW5kcyhwaWNrRGVwdGgsIGNvbnRleHQsIGRlcHRoVGV4dHVyZSkge1xuICBpZiAoIWRlZmluZWQocGlja0RlcHRoLl9jb3B5RGVwdGhDb21tYW5kKSkge1xuICAgIHZhciBmcyA9XG4gICAgICBcInVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEIHVfdGV4dHVyZTtcXG5cIiArXG4gICAgICBcInZhcnlpbmcgdmVjMiB2X3RleHR1cmVDb29yZGluYXRlcztcXG5cIiArXG4gICAgICBcInZvaWQgbWFpbigpXFxuXCIgK1xuICAgICAgXCJ7XFxuXCIgK1xuICAgICAgXCIgICAgZ2xfRnJhZ0NvbG9yID0gY3ptX3BhY2tEZXB0aCh0ZXh0dXJlMkQodV90ZXh0dXJlLCB2X3RleHR1cmVDb29yZGluYXRlcykucik7XFxuXCIgK1xuICAgICAgXCJ9XFxuXCI7XG4gICAgcGlja0RlcHRoLl9jb3B5RGVwdGhDb21tYW5kID0gY29udGV4dC5jcmVhdGVWaWV3cG9ydFF1YWRDb21tYW5kKGZzLCB7XG4gICAgICByZW5kZXJTdGF0ZTogUmVuZGVyU3RhdGUuZnJvbUNhY2hlKCksXG4gICAgICB1bmlmb3JtTWFwOiB7XG4gICAgICAgIHVfdGV4dHVyZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBwaWNrRGVwdGguX3RleHR1cmVUb0NvcHk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgb3duZXI6IHBpY2tEZXB0aCxcbiAgICB9KTtcbiAgfVxuXG4gIHBpY2tEZXB0aC5fdGV4dHVyZVRvQ29weSA9IGRlcHRoVGV4dHVyZTtcbiAgcGlja0RlcHRoLl9jb3B5RGVwdGhDb21tYW5kLmZyYW1lYnVmZmVyID0gcGlja0RlcHRoLl9mcmFtZWJ1ZmZlcjtcbn1cblxuUGlja0RlcHRoLnByb3RvdHlwZS5leGVjdXRlRGVidWdQaWNrRGVwdGggPSBmdW5jdGlvbiAoXG4gIGNvbnRleHQsXG4gIHBhc3NTdGF0ZSxcbiAgdXNlTG9nRGVwdGhcbikge1xuICBleGVjdXRlRGVidWdQaWNrRGVwdGgodGhpcywgY29udGV4dCwgcGFzc1N0YXRlLCB1c2VMb2dEZXB0aCk7XG59O1xuXG5QaWNrRGVwdGgucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChjb250ZXh0LCBkZXB0aFRleHR1cmUpIHtcbiAgdXBkYXRlRnJhbWVidWZmZXJzKHRoaXMsIGNvbnRleHQsIGRlcHRoVGV4dHVyZSk7XG4gIHVwZGF0ZUNvcHlDb21tYW5kcyh0aGlzLCBjb250ZXh0LCBkZXB0aFRleHR1cmUpO1xufTtcblxudmFyIHNjcmF0Y2hQYWNrZWREZXB0aCA9IG5ldyBDYXJ0ZXNpYW40KCk7XG52YXIgcGFja2VkRGVwdGhTY2FsZSA9IG5ldyBDYXJ0ZXNpYW40KFxuICAxLjAsXG4gIDEuMCAvIDI1NS4wLFxuICAxLjAgLyA2NTAyNS4wLFxuICAxLjAgLyAxNjU4MTM3NS4wXG4pO1xuXG5QaWNrRGVwdGgucHJvdG90eXBlLmdldERlcHRoID0gZnVuY3Rpb24gKGNvbnRleHQsIHgsIHkpIHtcbiAgLy8gSWYgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYmVmb3JlIHRoZSBmcmFtZWJ1ZmZlciBpcyBjcmVhdGVkLCB0aGUgZGVwdGggaXMgdW5kZWZpbmVkLlxuICBpZiAoIWRlZmluZWQodGhpcy5fZnJhbWVidWZmZXIpKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIHZhciBwaXhlbHMgPSBjb250ZXh0LnJlYWRQaXhlbHMoe1xuICAgIHg6IHgsXG4gICAgeTogeSxcbiAgICB3aWR0aDogMSxcbiAgICBoZWlnaHQ6IDEsXG4gICAgZnJhbWVidWZmZXI6IHRoaXMuX2ZyYW1lYnVmZmVyLFxuICB9KTtcblxuICB2YXIgcGFja2VkRGVwdGggPSBDYXJ0ZXNpYW40LnVucGFjayhwaXhlbHMsIDAsIHNjcmF0Y2hQYWNrZWREZXB0aCk7XG4gIENhcnRlc2lhbjQuZGl2aWRlQnlTY2FsYXIocGFja2VkRGVwdGgsIDI1NS4wLCBwYWNrZWREZXB0aCk7XG4gIHJldHVybiBDYXJ0ZXNpYW40LmRvdChwYWNrZWREZXB0aCwgcGFja2VkRGVwdGhTY2FsZSk7XG59O1xuXG5QaWNrRGVwdGgucHJvdG90eXBlLmV4ZWN1dGVDb3B5RGVwdGggPSBmdW5jdGlvbiAoY29udGV4dCwgcGFzc1N0YXRlKSB7XG4gIHRoaXMuX2NvcHlEZXB0aENvbW1hbmQuZXhlY3V0ZShjb250ZXh0LCBwYXNzU3RhdGUpO1xufTtcblxuUGlja0RlcHRoLnByb3RvdHlwZS5pc0Rlc3Ryb3llZCA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuUGlja0RlcHRoLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICBkZXN0cm95VGV4dHVyZXModGhpcyk7XG4gIGRlc3Ryb3lGcmFtZWJ1ZmZlcnModGhpcyk7XG5cbiAgaWYgKGRlZmluZWQodGhpcy5fY29weURlcHRoQ29tbWFuZCkpIHtcbiAgICB0aGlzLl9jb3B5RGVwdGhDb21tYW5kLnNoYWRlclByb2dyYW0gPVxuICAgICAgZGVmaW5lZCh0aGlzLl9jb3B5RGVwdGhDb21tYW5kLnNoYWRlclByb2dyYW0pICYmXG4gICAgICB0aGlzLl9jb3B5RGVwdGhDb21tYW5kLnNoYWRlclByb2dyYW0uZGVzdHJveSgpO1xuICB9XG5cbiAgcmV0dXJuIGRlc3Ryb3lPYmplY3QodGhpcyk7XG59O1xuZXhwb3J0IGRlZmF1bHQgUGlja0RlcHRoO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///43623\n')},37811:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(88108);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(82982);\n/* harmony import */ var _Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(86511);\n/* harmony import */ var _Core_PixelFormat_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(38443);\n/* harmony import */ var _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2932);\n/* harmony import */ var _Renderer_PassState_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(65121);\n/* harmony import */ var _Renderer_PixelDatatype_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(21572);\n/* harmony import */ var _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(8743);\n\n\n\n\n\n\n\n\n\n/**\n * @private\n */\nfunction PickDepthFramebuffer() {\n  this._depthStencilTexture = undefined;\n  this._framebuffer = undefined;\n  this._passState = undefined;\n}\n\nfunction destroyResources(pickDepth) {\n  pickDepth._framebuffer =\n    pickDepth._framebuffer && pickDepth._framebuffer.destroy();\n  pickDepth._depthStencilTexture =\n    pickDepth._depthStencilTexture && pickDepth._depthStencilTexture.destroy();\n}\n\nfunction createResources(pickDepth, context) {\n  var width = context.drawingBufferWidth;\n  var height = context.drawingBufferHeight;\n\n  pickDepth._depthStencilTexture = new _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z({\n    context: context,\n    width: width,\n    height: height,\n    pixelFormat: _Core_PixelFormat_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].DEPTH_STENCIL */ .Z.DEPTH_STENCIL,\n    pixelDatatype: _Renderer_PixelDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].UNSIGNED_INT_24_8 */ .Z.UNSIGNED_INT_24_8,\n  });\n\n  pickDepth._framebuffer = new _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z({\n    context: context,\n    depthStencilTexture: pickDepth._depthStencilTexture,\n    destroyAttachments: false,\n  });\n\n  var passState = new _Renderer_PassState_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z(context);\n  passState.blendingEnabled = false;\n  passState.scissorTest = {\n    enabled: true,\n    rectangle: new _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(),\n  };\n  passState.viewport = new _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\n  pickDepth._passState = passState;\n}\n\nPickDepthFramebuffer.prototype.update = function (\n  context,\n  drawingBufferPosition,\n  viewport\n) {\n  var width = viewport.width;\n  var height = viewport.height;\n\n  if (\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(this._framebuffer) ||\n    width !== this._depthStencilTexture.width ||\n    height !== this._depthStencilTexture.height\n  ) {\n    destroyResources(this);\n    createResources(this, context);\n  }\n\n  var framebuffer = this._framebuffer;\n  var passState = this._passState;\n  passState.framebuffer = framebuffer;\n  passState.viewport.width = width;\n  passState.viewport.height = height;\n  passState.scissorTest.rectangle.x = drawingBufferPosition.x;\n  passState.scissorTest.rectangle.y = height - drawingBufferPosition.y;\n  passState.scissorTest.rectangle.width = 1;\n  passState.scissorTest.rectangle.height = 1;\n\n  return passState;\n};\n\nPickDepthFramebuffer.prototype.isDestroyed = function () {\n  return false;\n};\n\nPickDepthFramebuffer.prototype.destroy = function () {\n  destroyResources(this);\n  return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(this);\n};\n/* harmony default export */ __webpack_exports__["Z"] = (PickDepthFramebuffer);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzc4MTEuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBNkQ7QUFDcEI7QUFDWTtBQUNKO0FBQ0k7QUFDSjtBQUNRO0FBQ1o7O0FBRTdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSx1Q0FBdUMscUVBQU87QUFDOUM7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGlHQUF5QjtBQUMxQyxtQkFBbUIsK0dBQStCO0FBQ2xELEdBQUc7O0FBRUgsK0JBQStCLHlFQUFXO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUgsc0JBQXNCLHVFQUFTO0FBQy9CO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiwyRUFBaUI7QUFDcEM7QUFDQSwyQkFBMkIsMkVBQWlCO0FBQzVDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLLHFFQUFPO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUywyRUFBYTtBQUN0QjtBQUNBLHlEQUFlLG9CQUFvQixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnVlMy13ZWJwYWNrNS8uL25vZGVfbW9kdWxlcy9jZXNpdW0vU291cmNlL1NjZW5lL1BpY2tEZXB0aEZyYW1lYnVmZmVyLmpzPzliYzciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEJvdW5kaW5nUmVjdGFuZ2xlIGZyb20gXCIuLi9Db3JlL0JvdW5kaW5nUmVjdGFuZ2xlLmpzXCI7XG5pbXBvcnQgZGVmaW5lZCBmcm9tIFwiLi4vQ29yZS9kZWZpbmVkLmpzXCI7XG5pbXBvcnQgZGVzdHJveU9iamVjdCBmcm9tIFwiLi4vQ29yZS9kZXN0cm95T2JqZWN0LmpzXCI7XG5pbXBvcnQgUGl4ZWxGb3JtYXQgZnJvbSBcIi4uL0NvcmUvUGl4ZWxGb3JtYXQuanNcIjtcbmltcG9ydCBGcmFtZWJ1ZmZlciBmcm9tIFwiLi4vUmVuZGVyZXIvRnJhbWVidWZmZXIuanNcIjtcbmltcG9ydCBQYXNzU3RhdGUgZnJvbSBcIi4uL1JlbmRlcmVyL1Bhc3NTdGF0ZS5qc1wiO1xuaW1wb3J0IFBpeGVsRGF0YXR5cGUgZnJvbSBcIi4uL1JlbmRlcmVyL1BpeGVsRGF0YXR5cGUuanNcIjtcbmltcG9ydCBUZXh0dXJlIGZyb20gXCIuLi9SZW5kZXJlci9UZXh0dXJlLmpzXCI7XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gUGlja0RlcHRoRnJhbWVidWZmZXIoKSB7XG4gIHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmUgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2ZyYW1lYnVmZmVyID0gdW5kZWZpbmVkO1xuICB0aGlzLl9wYXNzU3RhdGUgPSB1bmRlZmluZWQ7XG59XG5cbmZ1bmN0aW9uIGRlc3Ryb3lSZXNvdXJjZXMocGlja0RlcHRoKSB7XG4gIHBpY2tEZXB0aC5fZnJhbWVidWZmZXIgPVxuICAgIHBpY2tEZXB0aC5fZnJhbWVidWZmZXIgJiYgcGlja0RlcHRoLl9mcmFtZWJ1ZmZlci5kZXN0cm95KCk7XG4gIHBpY2tEZXB0aC5fZGVwdGhTdGVuY2lsVGV4dHVyZSA9XG4gICAgcGlja0RlcHRoLl9kZXB0aFN0ZW5jaWxUZXh0dXJlICYmIHBpY2tEZXB0aC5fZGVwdGhTdGVuY2lsVGV4dHVyZS5kZXN0cm95KCk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVJlc291cmNlcyhwaWNrRGVwdGgsIGNvbnRleHQpIHtcbiAgdmFyIHdpZHRoID0gY29udGV4dC5kcmF3aW5nQnVmZmVyV2lkdGg7XG4gIHZhciBoZWlnaHQgPSBjb250ZXh0LmRyYXdpbmdCdWZmZXJIZWlnaHQ7XG5cbiAgcGlja0RlcHRoLl9kZXB0aFN0ZW5jaWxUZXh0dXJlID0gbmV3IFRleHR1cmUoe1xuICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgd2lkdGg6IHdpZHRoLFxuICAgIGhlaWdodDogaGVpZ2h0LFxuICAgIHBpeGVsRm9ybWF0OiBQaXhlbEZvcm1hdC5ERVBUSF9TVEVOQ0lMLFxuICAgIHBpeGVsRGF0YXR5cGU6IFBpeGVsRGF0YXR5cGUuVU5TSUdORURfSU5UXzI0XzgsXG4gIH0pO1xuXG4gIHBpY2tEZXB0aC5fZnJhbWVidWZmZXIgPSBuZXcgRnJhbWVidWZmZXIoe1xuICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgZGVwdGhTdGVuY2lsVGV4dHVyZTogcGlja0RlcHRoLl9kZXB0aFN0ZW5jaWxUZXh0dXJlLFxuICAgIGRlc3Ryb3lBdHRhY2htZW50czogZmFsc2UsXG4gIH0pO1xuXG4gIHZhciBwYXNzU3RhdGUgPSBuZXcgUGFzc1N0YXRlKGNvbnRleHQpO1xuICBwYXNzU3RhdGUuYmxlbmRpbmdFbmFibGVkID0gZmFsc2U7XG4gIHBhc3NTdGF0ZS5zY2lzc29yVGVzdCA9IHtcbiAgICBlbmFibGVkOiB0cnVlLFxuICAgIHJlY3RhbmdsZTogbmV3IEJvdW5kaW5nUmVjdGFuZ2xlKCksXG4gIH07XG4gIHBhc3NTdGF0ZS52aWV3cG9ydCA9IG5ldyBCb3VuZGluZ1JlY3RhbmdsZSgpO1xuICBwaWNrRGVwdGguX3Bhc3NTdGF0ZSA9IHBhc3NTdGF0ZTtcbn1cblxuUGlja0RlcHRoRnJhbWVidWZmZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChcbiAgY29udGV4dCxcbiAgZHJhd2luZ0J1ZmZlclBvc2l0aW9uLFxuICB2aWV3cG9ydFxuKSB7XG4gIHZhciB3aWR0aCA9IHZpZXdwb3J0LndpZHRoO1xuICB2YXIgaGVpZ2h0ID0gdmlld3BvcnQuaGVpZ2h0O1xuXG4gIGlmIChcbiAgICAhZGVmaW5lZCh0aGlzLl9mcmFtZWJ1ZmZlcikgfHxcbiAgICB3aWR0aCAhPT0gdGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZS53aWR0aCB8fFxuICAgIGhlaWdodCAhPT0gdGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZS5oZWlnaHRcbiAgKSB7XG4gICAgZGVzdHJveVJlc291cmNlcyh0aGlzKTtcbiAgICBjcmVhdGVSZXNvdXJjZXModGhpcywgY29udGV4dCk7XG4gIH1cblxuICB2YXIgZnJhbWVidWZmZXIgPSB0aGlzLl9mcmFtZWJ1ZmZlcjtcbiAgdmFyIHBhc3NTdGF0ZSA9IHRoaXMuX3Bhc3NTdGF0ZTtcbiAgcGFzc1N0YXRlLmZyYW1lYnVmZmVyID0gZnJhbWVidWZmZXI7XG4gIHBhc3NTdGF0ZS52aWV3cG9ydC53aWR0aCA9IHdpZHRoO1xuICBwYXNzU3RhdGUudmlld3BvcnQuaGVpZ2h0ID0gaGVpZ2h0O1xuICBwYXNzU3RhdGUuc2Npc3NvclRlc3QucmVjdGFuZ2xlLnggPSBkcmF3aW5nQnVmZmVyUG9zaXRpb24ueDtcbiAgcGFzc1N0YXRlLnNjaXNzb3JUZXN0LnJlY3RhbmdsZS55ID0gaGVpZ2h0IC0gZHJhd2luZ0J1ZmZlclBvc2l0aW9uLnk7XG4gIHBhc3NTdGF0ZS5zY2lzc29yVGVzdC5yZWN0YW5nbGUud2lkdGggPSAxO1xuICBwYXNzU3RhdGUuc2Npc3NvclRlc3QucmVjdGFuZ2xlLmhlaWdodCA9IDE7XG5cbiAgcmV0dXJuIHBhc3NTdGF0ZTtcbn07XG5cblBpY2tEZXB0aEZyYW1lYnVmZmVyLnByb3RvdHlwZS5pc0Rlc3Ryb3llZCA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuUGlja0RlcHRoRnJhbWVidWZmZXIucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gIGRlc3Ryb3lSZXNvdXJjZXModGhpcyk7XG4gIHJldHVybiBkZXN0cm95T2JqZWN0KHRoaXMpO1xufTtcbmV4cG9ydCBkZWZhdWx0IFBpY2tEZXB0aEZyYW1lYnVmZmVyO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///37811\n')},93704:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(88108);\n/* harmony import */ var _Core_Color_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(59947);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(82982);\n/* harmony import */ var _Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(86511);\n/* harmony import */ var _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2932);\n/* harmony import */ var _Renderer_PassState_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(65121);\n/* harmony import */ var _Renderer_Renderbuffer_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(17941);\n/* harmony import */ var _Renderer_RenderbufferFormat_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(89032);\n/* harmony import */ var _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(8743);\n\n\n\n\n\n\n\n\n\n\n\n/**\n * @private\n */\nfunction PickFramebuffer(context) {\n  // Override per-command states\n  var passState = new _Renderer_PassState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z(context);\n  passState.blendingEnabled = false;\n  passState.scissorTest = {\n    enabled: true,\n    rectangle: new _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(),\n  };\n  passState.viewport = new _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\n\n  this._context = context;\n  this._fb = undefined;\n  this._passState = passState;\n  this._width = 0;\n  this._height = 0;\n}\nPickFramebuffer.prototype.begin = function (screenSpaceRectangle, viewport) {\n  var context = this._context;\n  var width = viewport.width;\n  var height = viewport.height;\n\n  _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone(\n    screenSpaceRectangle,\n    this._passState.scissorTest.rectangle\n  );\n\n  // Initially create or recreate renderbuffers and framebuffer used for picking\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(this._fb) || this._width !== width || this._height !== height) {\n    this._width = width;\n    this._height = height;\n\n    this._fb = this._fb && this._fb.destroy();\n    this._fb = new _Renderer_Framebuffer_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z({\n      context: context,\n      colorTextures: [\n        new _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z({\n          context: context,\n          width: width,\n          height: height,\n        }),\n      ],\n      depthStencilRenderbuffer: new _Renderer_Renderbuffer_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z({\n        context: context,\n        width: width,\n        height: height,\n        format: _Renderer_RenderbufferFormat_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].DEPTH_STENCIL */ .Z.DEPTH_STENCIL,\n      }),\n    });\n    this._passState.framebuffer = this._fb;\n  }\n\n  this._passState.viewport.width = width;\n  this._passState.viewport.height = height;\n\n  return this._passState;\n};\n\nvar colorScratch = new _Core_Color_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\n\nPickFramebuffer.prototype.end = function (screenSpaceRectangle) {\n  var width = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(screenSpaceRectangle.width, 1.0);\n  var height = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(screenSpaceRectangle.height, 1.0);\n\n  var context = this._context;\n  var pixels = context.readPixels({\n    x: screenSpaceRectangle.x,\n    y: screenSpaceRectangle.y,\n    width: width,\n    height: height,\n    framebuffer: this._fb,\n  });\n\n  var max = Math.max(width, height);\n  var length = max * max;\n  var halfWidth = Math.floor(width * 0.5);\n  var halfHeight = Math.floor(height * 0.5);\n\n  var x = 0;\n  var y = 0;\n  var dx = 0;\n  var dy = -1;\n\n  // Spiral around the center pixel, this is a workaround until\n  // we can access the depth buffer on all browsers.\n\n  // The region does not have to square and the dimensions do not have to be odd, but\n  // loop iterations would be wasted. Prefer square regions where the size is odd.\n  for (var i = 0; i < length; ++i) {\n    if (\n      -halfWidth <= x &&\n      x <= halfWidth &&\n      -halfHeight <= y &&\n      y <= halfHeight\n    ) {\n      var index = 4 * ((halfHeight - y) * width + x + halfWidth);\n\n      colorScratch.red = _Core_Color_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].byteToFloat */ .Z.byteToFloat(pixels[index]);\n      colorScratch.green = _Core_Color_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].byteToFloat */ .Z.byteToFloat(pixels[index + 1]);\n      colorScratch.blue = _Core_Color_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].byteToFloat */ .Z.byteToFloat(pixels[index + 2]);\n      colorScratch.alpha = _Core_Color_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].byteToFloat */ .Z.byteToFloat(pixels[index + 3]);\n\n      var object = context.getObjectByPickColor(colorScratch);\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(object)) {\n        return object;\n      }\n    }\n\n    // if (top right || bottom left corners) || (top left corner) || (bottom right corner + (1, 0))\n    // change spiral direction\n    if (x === y || (x < 0 && -x === y) || (x > 0 && x === 1 - y)) {\n      var temp = dx;\n      dx = -dy;\n      dy = temp;\n    }\n\n    x += dx;\n    y += dy;\n  }\n\n  return undefined;\n};\n\nPickFramebuffer.prototype.isDestroyed = function () {\n  return false;\n};\n\nPickFramebuffer.prototype.destroy = function () {\n  this._fb = this._fb && this._fb.destroy();\n  return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(this);\n};\n/* harmony default export */ __webpack_exports__["Z"] = (PickFramebuffer);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTM3MDQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUE2RDtBQUN4QjtBQUNjO0FBQ1Y7QUFDWTtBQUNBO0FBQ0o7QUFDTTtBQUNZO0FBQ3RCOztBQUU3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHVFQUFTO0FBQy9CO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiwyRUFBaUI7QUFDcEM7QUFDQSwyQkFBMkIsMkVBQWlCOztBQUU1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxFQUFFLHVGQUF1QjtBQUN6QjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxPQUFPLHFFQUFPO0FBQ2Q7QUFDQTs7QUFFQTtBQUNBLG1CQUFtQix5RUFBVztBQUM5QjtBQUNBO0FBQ0EsWUFBWSxxRUFBTztBQUNuQjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxvQ0FBb0MsMEVBQVk7QUFDaEQ7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDRHQUFnQztBQUNoRCxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBLHVCQUF1QiwrREFBSzs7QUFFNUI7QUFDQSxjQUFjLDBFQUFZO0FBQzFCLGVBQWUsMEVBQVk7O0FBRTNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxrQkFBa0IsWUFBWTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSx5QkFBeUIsdUZBQWlCO0FBQzFDLDJCQUEyQix1RkFBaUI7QUFDNUMsMEJBQTBCLHVGQUFpQjtBQUMzQywyQkFBMkIsdUZBQWlCOztBQUU1QztBQUNBLFVBQVUscUVBQU87QUFDakI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUywyRUFBYTtBQUN0QjtBQUNBLHlEQUFlLGVBQWUsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9TY2VuZS9QaWNrRnJhbWVidWZmZXIuanM/NTIzNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQm91bmRpbmdSZWN0YW5nbGUgZnJvbSBcIi4uL0NvcmUvQm91bmRpbmdSZWN0YW5nbGUuanNcIjtcbmltcG9ydCBDb2xvciBmcm9tIFwiLi4vQ29yZS9Db2xvci5qc1wiO1xuaW1wb3J0IGRlZmF1bHRWYWx1ZSBmcm9tIFwiLi4vQ29yZS9kZWZhdWx0VmFsdWUuanNcIjtcbmltcG9ydCBkZWZpbmVkIGZyb20gXCIuLi9Db3JlL2RlZmluZWQuanNcIjtcbmltcG9ydCBkZXN0cm95T2JqZWN0IGZyb20gXCIuLi9Db3JlL2Rlc3Ryb3lPYmplY3QuanNcIjtcbmltcG9ydCBGcmFtZWJ1ZmZlciBmcm9tIFwiLi4vUmVuZGVyZXIvRnJhbWVidWZmZXIuanNcIjtcbmltcG9ydCBQYXNzU3RhdGUgZnJvbSBcIi4uL1JlbmRlcmVyL1Bhc3NTdGF0ZS5qc1wiO1xuaW1wb3J0IFJlbmRlcmJ1ZmZlciBmcm9tIFwiLi4vUmVuZGVyZXIvUmVuZGVyYnVmZmVyLmpzXCI7XG5pbXBvcnQgUmVuZGVyYnVmZmVyRm9ybWF0IGZyb20gXCIuLi9SZW5kZXJlci9SZW5kZXJidWZmZXJGb3JtYXQuanNcIjtcbmltcG9ydCBUZXh0dXJlIGZyb20gXCIuLi9SZW5kZXJlci9UZXh0dXJlLmpzXCI7XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gUGlja0ZyYW1lYnVmZmVyKGNvbnRleHQpIHtcbiAgLy8gT3ZlcnJpZGUgcGVyLWNvbW1hbmQgc3RhdGVzXG4gIHZhciBwYXNzU3RhdGUgPSBuZXcgUGFzc1N0YXRlKGNvbnRleHQpO1xuICBwYXNzU3RhdGUuYmxlbmRpbmdFbmFibGVkID0gZmFsc2U7XG4gIHBhc3NTdGF0ZS5zY2lzc29yVGVzdCA9IHtcbiAgICBlbmFibGVkOiB0cnVlLFxuICAgIHJlY3RhbmdsZTogbmV3IEJvdW5kaW5nUmVjdGFuZ2xlKCksXG4gIH07XG4gIHBhc3NTdGF0ZS52aWV3cG9ydCA9IG5ldyBCb3VuZGluZ1JlY3RhbmdsZSgpO1xuXG4gIHRoaXMuX2NvbnRleHQgPSBjb250ZXh0O1xuICB0aGlzLl9mYiA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fcGFzc1N0YXRlID0gcGFzc1N0YXRlO1xuICB0aGlzLl93aWR0aCA9IDA7XG4gIHRoaXMuX2hlaWdodCA9IDA7XG59XG5QaWNrRnJhbWVidWZmZXIucHJvdG90eXBlLmJlZ2luID0gZnVuY3Rpb24gKHNjcmVlblNwYWNlUmVjdGFuZ2xlLCB2aWV3cG9ydCkge1xuICB2YXIgY29udGV4dCA9IHRoaXMuX2NvbnRleHQ7XG4gIHZhciB3aWR0aCA9IHZpZXdwb3J0LndpZHRoO1xuICB2YXIgaGVpZ2h0ID0gdmlld3BvcnQuaGVpZ2h0O1xuXG4gIEJvdW5kaW5nUmVjdGFuZ2xlLmNsb25lKFxuICAgIHNjcmVlblNwYWNlUmVjdGFuZ2xlLFxuICAgIHRoaXMuX3Bhc3NTdGF0ZS5zY2lzc29yVGVzdC5yZWN0YW5nbGVcbiAgKTtcblxuICAvLyBJbml0aWFsbHkgY3JlYXRlIG9yIHJlY3JlYXRlIHJlbmRlcmJ1ZmZlcnMgYW5kIGZyYW1lYnVmZmVyIHVzZWQgZm9yIHBpY2tpbmdcbiAgaWYgKCFkZWZpbmVkKHRoaXMuX2ZiKSB8fCB0aGlzLl93aWR0aCAhPT0gd2lkdGggfHwgdGhpcy5faGVpZ2h0ICE9PSBoZWlnaHQpIHtcbiAgICB0aGlzLl93aWR0aCA9IHdpZHRoO1xuICAgIHRoaXMuX2hlaWdodCA9IGhlaWdodDtcblxuICAgIHRoaXMuX2ZiID0gdGhpcy5fZmIgJiYgdGhpcy5fZmIuZGVzdHJveSgpO1xuICAgIHRoaXMuX2ZiID0gbmV3IEZyYW1lYnVmZmVyKHtcbiAgICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgICBjb2xvclRleHR1cmVzOiBbXG4gICAgICAgIG5ldyBUZXh0dXJlKHtcbiAgICAgICAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgICAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgICAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICAgICAgfSksXG4gICAgICBdLFxuICAgICAgZGVwdGhTdGVuY2lsUmVuZGVyYnVmZmVyOiBuZXcgUmVuZGVyYnVmZmVyKHtcbiAgICAgICAgY29udGV4dDogY29udGV4dCxcbiAgICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICAgICAgZm9ybWF0OiBSZW5kZXJidWZmZXJGb3JtYXQuREVQVEhfU1RFTkNJTCxcbiAgICAgIH0pLFxuICAgIH0pO1xuICAgIHRoaXMuX3Bhc3NTdGF0ZS5mcmFtZWJ1ZmZlciA9IHRoaXMuX2ZiO1xuICB9XG5cbiAgdGhpcy5fcGFzc1N0YXRlLnZpZXdwb3J0LndpZHRoID0gd2lkdGg7XG4gIHRoaXMuX3Bhc3NTdGF0ZS52aWV3cG9ydC5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgcmV0dXJuIHRoaXMuX3Bhc3NTdGF0ZTtcbn07XG5cbnZhciBjb2xvclNjcmF0Y2ggPSBuZXcgQ29sb3IoKTtcblxuUGlja0ZyYW1lYnVmZmVyLnByb3RvdHlwZS5lbmQgPSBmdW5jdGlvbiAoc2NyZWVuU3BhY2VSZWN0YW5nbGUpIHtcbiAgdmFyIHdpZHRoID0gZGVmYXVsdFZhbHVlKHNjcmVlblNwYWNlUmVjdGFuZ2xlLndpZHRoLCAxLjApO1xuICB2YXIgaGVpZ2h0ID0gZGVmYXVsdFZhbHVlKHNjcmVlblNwYWNlUmVjdGFuZ2xlLmhlaWdodCwgMS4wKTtcblxuICB2YXIgY29udGV4dCA9IHRoaXMuX2NvbnRleHQ7XG4gIHZhciBwaXhlbHMgPSBjb250ZXh0LnJlYWRQaXhlbHMoe1xuICAgIHg6IHNjcmVlblNwYWNlUmVjdGFuZ2xlLngsXG4gICAgeTogc2NyZWVuU3BhY2VSZWN0YW5nbGUueSxcbiAgICB3aWR0aDogd2lkdGgsXG4gICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgZnJhbWVidWZmZXI6IHRoaXMuX2ZiLFxuICB9KTtcblxuICB2YXIgbWF4ID0gTWF0aC5tYXgod2lkdGgsIGhlaWdodCk7XG4gIHZhciBsZW5ndGggPSBtYXggKiBtYXg7XG4gIHZhciBoYWxmV2lkdGggPSBNYXRoLmZsb29yKHdpZHRoICogMC41KTtcbiAgdmFyIGhhbGZIZWlnaHQgPSBNYXRoLmZsb29yKGhlaWdodCAqIDAuNSk7XG5cbiAgdmFyIHggPSAwO1xuICB2YXIgeSA9IDA7XG4gIHZhciBkeCA9IDA7XG4gIHZhciBkeSA9IC0xO1xuXG4gIC8vIFNwaXJhbCBhcm91bmQgdGhlIGNlbnRlciBwaXhlbCwgdGhpcyBpcyBhIHdvcmthcm91bmQgdW50aWxcbiAgLy8gd2UgY2FuIGFjY2VzcyB0aGUgZGVwdGggYnVmZmVyIG9uIGFsbCBicm93c2Vycy5cblxuICAvLyBUaGUgcmVnaW9uIGRvZXMgbm90IGhhdmUgdG8gc3F1YXJlIGFuZCB0aGUgZGltZW5zaW9ucyBkbyBub3QgaGF2ZSB0byBiZSBvZGQsIGJ1dFxuICAvLyBsb29wIGl0ZXJhdGlvbnMgd291bGQgYmUgd2FzdGVkLiBQcmVmZXIgc3F1YXJlIHJlZ2lvbnMgd2hlcmUgdGhlIHNpemUgaXMgb2RkLlxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgaWYgKFxuICAgICAgLWhhbGZXaWR0aCA8PSB4ICYmXG4gICAgICB4IDw9IGhhbGZXaWR0aCAmJlxuICAgICAgLWhhbGZIZWlnaHQgPD0geSAmJlxuICAgICAgeSA8PSBoYWxmSGVpZ2h0XG4gICAgKSB7XG4gICAgICB2YXIgaW5kZXggPSA0ICogKChoYWxmSGVpZ2h0IC0geSkgKiB3aWR0aCArIHggKyBoYWxmV2lkdGgpO1xuXG4gICAgICBjb2xvclNjcmF0Y2gucmVkID0gQ29sb3IuYnl0ZVRvRmxvYXQocGl4ZWxzW2luZGV4XSk7XG4gICAgICBjb2xvclNjcmF0Y2guZ3JlZW4gPSBDb2xvci5ieXRlVG9GbG9hdChwaXhlbHNbaW5kZXggKyAxXSk7XG4gICAgICBjb2xvclNjcmF0Y2guYmx1ZSA9IENvbG9yLmJ5dGVUb0Zsb2F0KHBpeGVsc1tpbmRleCArIDJdKTtcbiAgICAgIGNvbG9yU2NyYXRjaC5hbHBoYSA9IENvbG9yLmJ5dGVUb0Zsb2F0KHBpeGVsc1tpbmRleCArIDNdKTtcblxuICAgICAgdmFyIG9iamVjdCA9IGNvbnRleHQuZ2V0T2JqZWN0QnlQaWNrQ29sb3IoY29sb3JTY3JhdGNoKTtcbiAgICAgIGlmIChkZWZpbmVkKG9iamVjdCkpIHtcbiAgICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBpZiAodG9wIHJpZ2h0IHx8IGJvdHRvbSBsZWZ0IGNvcm5lcnMpIHx8ICh0b3AgbGVmdCBjb3JuZXIpIHx8IChib3R0b20gcmlnaHQgY29ybmVyICsgKDEsIDApKVxuICAgIC8vIGNoYW5nZSBzcGlyYWwgZGlyZWN0aW9uXG4gICAgaWYgKHggPT09IHkgfHwgKHggPCAwICYmIC14ID09PSB5KSB8fCAoeCA+IDAgJiYgeCA9PT0gMSAtIHkpKSB7XG4gICAgICB2YXIgdGVtcCA9IGR4O1xuICAgICAgZHggPSAtZHk7XG4gICAgICBkeSA9IHRlbXA7XG4gICAgfVxuXG4gICAgeCArPSBkeDtcbiAgICB5ICs9IGR5O1xuICB9XG5cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn07XG5cblBpY2tGcmFtZWJ1ZmZlci5wcm90b3R5cGUuaXNEZXN0cm95ZWQgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBmYWxzZTtcbn07XG5cblBpY2tGcmFtZWJ1ZmZlci5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5fZmIgPSB0aGlzLl9mYiAmJiB0aGlzLl9mYi5kZXN0cm95KCk7XG4gIHJldHVybiBkZXN0cm95T2JqZWN0KHRoaXMpO1xufTtcbmV4cG9ydCBkZWZhdWx0IFBpY2tGcmFtZWJ1ZmZlcjtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///93704\n')},18441:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_ApproximateTerrainHeights_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(53773);\n/* harmony import */ var _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(88108);\n/* harmony import */ var _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(60838);\n/* harmony import */ var _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(60216);\n/* harmony import */ var _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(51688);\n/* harmony import */ var _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(66553);\n/* harmony import */ var _Core_Color_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(59947);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(82982);\n/* harmony import */ var _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(12572);\n/* harmony import */ var _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(72248);\n/* harmony import */ var _Core_OrthographicFrustum_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(91473);\n/* harmony import */ var _Core_OrthographicOffCenterFrustum_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(35131);\n/* harmony import */ var _Core_PerspectiveFrustum_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(66854);\n/* harmony import */ var _Core_PerspectiveOffCenterFrustum_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(36135);\n/* harmony import */ var _Core_Ray_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(68457);\n/* harmony import */ var _Core_ShowGeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(37939);\n/* harmony import */ var _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(13222);\n/* harmony import */ var _Camera_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(70561);\n/* harmony import */ var _Cesium3DTileFeature_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(52381);\n/* harmony import */ var _Cesium3DTilePass_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(94170);\n/* harmony import */ var _Cesium3DTilePassState_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(55715);\n/* harmony import */ var _PickDepth_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(43623);\n/* harmony import */ var _PrimitiveCollection_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(73316);\n/* harmony import */ var _SceneMode_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(89917);\n/* harmony import */ var _SceneTransforms_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(48244);\n/* harmony import */ var _View_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(70419);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar offscreenDefaultWidth = 0.1;\n\nvar mostDetailedPreloadTilesetPassState = new _Cesium3DTilePassState_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"] */ .Z({\n  pass: _Cesium3DTilePass_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].MOST_DETAILED_PRELOAD */ .Z.MOST_DETAILED_PRELOAD,\n});\n\nvar mostDetailedPickTilesetPassState = new _Cesium3DTilePassState_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"] */ .Z({\n  pass: _Cesium3DTilePass_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].MOST_DETAILED_PICK */ .Z.MOST_DETAILED_PICK,\n});\n\nvar pickTilesetPassState = new _Cesium3DTilePassState_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"] */ .Z({\n  pass: _Cesium3DTilePass_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].PICK */ .Z.PICK,\n});\n\n/**\n * @private\n */\nfunction Picking(scene) {\n  this._mostDetailedRayPicks = [];\n  this.pickRenderStateCache = {};\n  this._pickPositionCache = {};\n  this._pickPositionCacheDirty = false;\n\n  var pickOffscreenViewport = new _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z(0, 0, 1, 1);\n  var pickOffscreenCamera = new _Camera_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"] */ .Z(scene);\n  pickOffscreenCamera.frustum = new _Core_OrthographicFrustum_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z({\n    width: offscreenDefaultWidth,\n    aspectRatio: 1.0,\n    near: 0.1,\n  });\n\n  this._pickOffscreenView = new _View_js__WEBPACK_IMPORTED_MODULE_25__/* ["default"] */ .Z(\n    scene,\n    pickOffscreenCamera,\n    pickOffscreenViewport\n  );\n}\n\nPicking.prototype.update = function () {\n  this._pickPositionCacheDirty = true;\n};\n\nPicking.prototype.getPickDepth = function (scene, index) {\n  var pickDepths = scene.view.pickDepths;\n  var pickDepth = pickDepths[index];\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(pickDepth)) {\n    pickDepth = new _PickDepth_js__WEBPACK_IMPORTED_MODULE_21__/* ["default"] */ .Z();\n    pickDepths[index] = pickDepth;\n  }\n  return pickDepth;\n};\n\nvar scratchOrthoPickingFrustum = new _Core_OrthographicOffCenterFrustum_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z();\nvar scratchOrthoOrigin = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\nvar scratchOrthoDirection = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\nvar scratchOrthoPixelSize = new _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\nvar scratchOrthoPickVolumeMatrix4 = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z();\n\nfunction getPickOrthographicCullingVolume(\n  scene,\n  drawingBufferPosition,\n  width,\n  height,\n  viewport\n) {\n  var camera = scene.camera;\n  var frustum = camera.frustum;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(frustum._offCenterFrustum)) {\n    frustum = frustum._offCenterFrustum;\n  }\n\n  var x = (2.0 * (drawingBufferPosition.x - viewport.x)) / viewport.width - 1.0;\n  x *= (frustum.right - frustum.left) * 0.5;\n  var y =\n    (2.0 * (viewport.height - drawingBufferPosition.y - viewport.y)) /\n      viewport.height -\n    1.0;\n  y *= (frustum.top - frustum.bottom) * 0.5;\n\n  var transform = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].clone */ .Z.clone(\n    camera.transform,\n    scratchOrthoPickVolumeMatrix4\n  );\n  camera._setTransform(_Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].IDENTITY */ .Z.IDENTITY);\n\n  var origin = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].clone */ .Z.clone(camera.position, scratchOrthoOrigin);\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].multiplyByScalar */ .Z.multiplyByScalar(camera.right, x, scratchOrthoDirection);\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].add */ .Z.add(scratchOrthoDirection, origin, origin);\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].multiplyByScalar */ .Z.multiplyByScalar(camera.up, y, scratchOrthoDirection);\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].add */ .Z.add(scratchOrthoDirection, origin, origin);\n\n  camera._setTransform(transform);\n\n  if (scene.mode === _SceneMode_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].SCENE2D */ .Z.SCENE2D) {\n    _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].fromElements */ .Z.fromElements(origin.z, origin.x, origin.y, origin);\n  }\n\n  var pixelSize = frustum.getPixelDimensions(\n    viewport.width,\n    viewport.height,\n    1.0,\n    1.0,\n    scratchOrthoPixelSize\n  );\n\n  var ortho = scratchOrthoPickingFrustum;\n  ortho.right = pixelSize.x * 0.5;\n  ortho.left = -ortho.right;\n  ortho.top = pixelSize.y * 0.5;\n  ortho.bottom = -ortho.top;\n  ortho.near = frustum.near;\n  ortho.far = frustum.far;\n\n  return ortho.computeCullingVolume(origin, camera.directionWC, camera.upWC);\n}\n\nvar scratchPerspPickingFrustum = new _Core_PerspectiveOffCenterFrustum_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z();\nvar scratchPerspPixelSize = new _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\n\nfunction getPickPerspectiveCullingVolume(\n  scene,\n  drawingBufferPosition,\n  width,\n  height,\n  viewport\n) {\n  var camera = scene.camera;\n  var frustum = camera.frustum;\n  var near = frustum.near;\n\n  var tanPhi = Math.tan(frustum.fovy * 0.5);\n  var tanTheta = frustum.aspectRatio * tanPhi;\n\n  var x = (2.0 * (drawingBufferPosition.x - viewport.x)) / viewport.width - 1.0;\n  var y =\n    (2.0 * (viewport.height - drawingBufferPosition.y - viewport.y)) /\n      viewport.height -\n    1.0;\n\n  var xDir = x * near * tanTheta;\n  var yDir = y * near * tanPhi;\n\n  var pixelSize = frustum.getPixelDimensions(\n    viewport.width,\n    viewport.height,\n    1.0,\n    1.0,\n    scratchPerspPixelSize\n  );\n  var pickWidth = pixelSize.x * width * 0.5;\n  var pickHeight = pixelSize.y * height * 0.5;\n\n  var offCenter = scratchPerspPickingFrustum;\n  offCenter.top = yDir + pickHeight;\n  offCenter.bottom = yDir - pickHeight;\n  offCenter.right = xDir + pickWidth;\n  offCenter.left = xDir - pickWidth;\n  offCenter.near = near;\n  offCenter.far = frustum.far;\n\n  return offCenter.computeCullingVolume(\n    camera.positionWC,\n    camera.directionWC,\n    camera.upWC\n  );\n}\n\nfunction getPickCullingVolume(\n  scene,\n  drawingBufferPosition,\n  width,\n  height,\n  viewport\n) {\n  var frustum = scene.camera.frustum;\n  if (\n    frustum instanceof _Core_OrthographicFrustum_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z ||\n    frustum instanceof _Core_OrthographicOffCenterFrustum_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z\n  ) {\n    return getPickOrthographicCullingVolume(\n      scene,\n      drawingBufferPosition,\n      width,\n      height,\n      viewport\n    );\n  }\n\n  return getPickPerspectiveCullingVolume(\n    scene,\n    drawingBufferPosition,\n    width,\n    height,\n    viewport\n  );\n}\n\n// pick rectangle width and height, assumed odd\nvar scratchRectangleWidth = 3.0;\nvar scratchRectangleHeight = 3.0;\nvar scratchRectangle = new _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z(\n  0.0,\n  0.0,\n  scratchRectangleWidth,\n  scratchRectangleHeight\n);\nvar scratchPosition = new _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\nvar scratchColorZero = new _Core_Color_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z(0.0, 0.0, 0.0, 0.0);\n\nPicking.prototype.pick = function (scene, windowPosition, width, height) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(windowPosition)) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z("windowPosition is undefined.");\n  }\n  //>>includeEnd(\'debug\');\n\n  scratchRectangleWidth = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(width, 3.0);\n  scratchRectangleHeight = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(height, scratchRectangleWidth);\n\n  var context = scene.context;\n  var us = context.uniformState;\n  var frameState = scene.frameState;\n\n  var view = scene.defaultView;\n  scene.view = view;\n\n  var viewport = view.viewport;\n  viewport.x = 0;\n  viewport.y = 0;\n  viewport.width = context.drawingBufferWidth;\n  viewport.height = context.drawingBufferHeight;\n\n  var passState = view.passState;\n  passState.viewport = _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].clone */ .Z.clone(viewport, passState.viewport);\n\n  var drawingBufferPosition = _SceneTransforms_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].transformWindowToDrawingBuffer */ .Z.transformWindowToDrawingBuffer(\n    scene,\n    windowPosition,\n    scratchPosition\n  );\n\n  scene.jobScheduler.disableThisFrame();\n\n  scene.updateFrameState();\n  frameState.cullingVolume = getPickCullingVolume(\n    scene,\n    drawingBufferPosition,\n    scratchRectangleWidth,\n    scratchRectangleHeight,\n    viewport\n  );\n  frameState.invertClassification = false;\n  frameState.passes.pick = true;\n  frameState.tilesetPassState = pickTilesetPassState;\n\n  us.update(frameState);\n\n  scene.updateEnvironment();\n\n  scratchRectangle.x =\n    drawingBufferPosition.x - (scratchRectangleWidth - 1.0) * 0.5;\n  scratchRectangle.y =\n    scene.drawingBufferHeight -\n    drawingBufferPosition.y -\n    (scratchRectangleHeight - 1.0) * 0.5;\n  scratchRectangle.width = scratchRectangleWidth;\n  scratchRectangle.height = scratchRectangleHeight;\n  passState = view.pickFramebuffer.begin(scratchRectangle, view.viewport);\n\n  scene.updateAndExecuteCommands(passState, scratchColorZero);\n  scene.resolveFramebuffers(passState);\n\n  var object = view.pickFramebuffer.end(scratchRectangle);\n  context.endFrame();\n  return object;\n};\n\nfunction renderTranslucentDepthForPick(scene, drawingBufferPosition) {\n  // PERFORMANCE_IDEA: render translucent only and merge with the previous frame\n  var context = scene.context;\n  var frameState = scene.frameState;\n  var environmentState = scene.environmentState;\n\n  var view = scene.defaultView;\n  scene.view = view;\n\n  var viewport = view.viewport;\n  viewport.x = 0;\n  viewport.y = 0;\n  viewport.width = context.drawingBufferWidth;\n  viewport.height = context.drawingBufferHeight;\n\n  var passState = view.passState;\n  passState.viewport = _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].clone */ .Z.clone(viewport, passState.viewport);\n\n  scene.clearPasses(frameState.passes);\n  frameState.passes.pick = true;\n  frameState.passes.depth = true;\n  frameState.cullingVolume = getPickCullingVolume(\n    scene,\n    drawingBufferPosition,\n    1,\n    1,\n    viewport\n  );\n  frameState.tilesetPassState = pickTilesetPassState;\n\n  scene.updateEnvironment();\n  environmentState.renderTranslucentDepthForPick = true;\n  passState = view.pickDepthFramebuffer.update(\n    context,\n    drawingBufferPosition,\n    viewport\n  );\n\n  scene.updateAndExecuteCommands(passState, scratchColorZero);\n  scene.resolveFramebuffers(passState);\n\n  context.endFrame();\n}\n\nvar scratchPerspectiveFrustum = new _Core_PerspectiveFrustum_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z();\nvar scratchPerspectiveOffCenterFrustum = new _Core_PerspectiveOffCenterFrustum_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z();\nvar scratchOrthographicFrustum = new _Core_OrthographicFrustum_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z();\nvar scratchOrthographicOffCenterFrustum = new _Core_OrthographicOffCenterFrustum_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z();\n\nPicking.prototype.pickPositionWorldCoordinates = function (\n  scene,\n  windowPosition,\n  result\n) {\n  if (!scene.useDepthPicking) {\n    return undefined;\n  }\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(windowPosition)) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z("windowPosition is undefined.");\n  }\n  if (!scene.context.depthTexture) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z(\n      "Picking from the depth buffer is not supported. Check pickPositionSupported."\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  var cacheKey = windowPosition.toString();\n\n  if (this._pickPositionCacheDirty) {\n    this._pickPositionCache = {};\n    this._pickPositionCacheDirty = false;\n  } else if (this._pickPositionCache.hasOwnProperty(cacheKey)) {\n    return _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].clone */ .Z.clone(this._pickPositionCache[cacheKey], result);\n  }\n\n  var frameState = scene.frameState;\n  var context = scene.context;\n  var uniformState = context.uniformState;\n\n  var view = scene.defaultView;\n  scene.view = view;\n\n  var drawingBufferPosition = _SceneTransforms_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].transformWindowToDrawingBuffer */ .Z.transformWindowToDrawingBuffer(\n    scene,\n    windowPosition,\n    scratchPosition\n  );\n  if (scene.pickTranslucentDepth) {\n    renderTranslucentDepthForPick(scene, drawingBufferPosition);\n  } else {\n    scene.updateFrameState();\n    uniformState.update(frameState);\n    scene.updateEnvironment();\n  }\n  drawingBufferPosition.y = scene.drawingBufferHeight - drawingBufferPosition.y;\n\n  var camera = scene.camera;\n\n  // Create a working frustum from the original camera frustum.\n  var frustum;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(camera.frustum.fov)) {\n    frustum = camera.frustum.clone(scratchPerspectiveFrustum);\n  } else if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(camera.frustum.infiniteProjectionMatrix)) {\n    frustum = camera.frustum.clone(scratchPerspectiveOffCenterFrustum);\n  } else if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(camera.frustum.width)) {\n    frustum = camera.frustum.clone(scratchOrthographicFrustum);\n  } else {\n    frustum = camera.frustum.clone(scratchOrthographicOffCenterFrustum);\n  }\n\n  var frustumCommandsList = view.frustumCommandsList;\n  var numFrustums = frustumCommandsList.length;\n  for (var i = 0; i < numFrustums; ++i) {\n    var pickDepth = this.getPickDepth(scene, i);\n    var depth = pickDepth.getDepth(\n      context,\n      drawingBufferPosition.x,\n      drawingBufferPosition.y\n    );\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(depth)) {\n      continue;\n    }\n    if (depth > 0.0 && depth < 1.0) {\n      var renderedFrustum = frustumCommandsList[i];\n      var height2D;\n      if (scene.mode === _SceneMode_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].SCENE2D */ .Z.SCENE2D) {\n        height2D = camera.position.z;\n        camera.position.z = height2D - renderedFrustum.near + 1.0;\n        frustum.far = Math.max(1.0, renderedFrustum.far - renderedFrustum.near);\n        frustum.near = 1.0;\n        uniformState.update(frameState);\n        uniformState.updateFrustum(frustum);\n      } else {\n        frustum.near =\n          renderedFrustum.near *\n          (i !== 0 ? scene.opaqueFrustumNearOffset : 1.0);\n        frustum.far = renderedFrustum.far;\n        uniformState.updateFrustum(frustum);\n      }\n\n      result = _SceneTransforms_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].drawingBufferToWgs84Coordinates */ .Z.drawingBufferToWgs84Coordinates(\n        scene,\n        drawingBufferPosition,\n        depth,\n        result\n      );\n\n      if (scene.mode === _SceneMode_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].SCENE2D */ .Z.SCENE2D) {\n        camera.position.z = height2D;\n        uniformState.update(frameState);\n      }\n\n      this._pickPositionCache[cacheKey] = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].clone */ .Z.clone(result);\n      return result;\n    }\n  }\n\n  this._pickPositionCache[cacheKey] = undefined;\n  return undefined;\n};\n\nvar scratchPickPositionCartographic = new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\n\nPicking.prototype.pickPosition = function (scene, windowPosition, result) {\n  result = this.pickPositionWorldCoordinates(scene, windowPosition, result);\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(result) && scene.mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].SCENE3D */ .Z.SCENE3D) {\n    _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].fromElements */ .Z.fromElements(result.y, result.z, result.x, result);\n\n    var projection = scene.mapProjection;\n    var ellipsoid = projection.ellipsoid;\n\n    var cart = projection.unproject(result, scratchPickPositionCartographic);\n    ellipsoid.cartographicToCartesian(cart, result);\n  }\n\n  return result;\n};\n\nfunction drillPick(limit, pickCallback) {\n  // PERFORMANCE_IDEA: This function calls each primitive\'s update for each pass. Instead\n  // we could update the primitive once, and then just execute their commands for each pass,\n  // and cull commands for picked primitives.  e.g., base on the command\'s owner.\n  var i;\n  var attributes;\n  var result = [];\n  var pickedPrimitives = [];\n  var pickedAttributes = [];\n  var pickedFeatures = [];\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(limit)) {\n    limit = Number.MAX_VALUE;\n  }\n\n  var pickedResult = pickCallback();\n  while ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(pickedResult)) {\n    var object = pickedResult.object;\n    var position = pickedResult.position;\n    var exclude = pickedResult.exclude;\n\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(position) && !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(object)) {\n      result.push(pickedResult);\n      break;\n    }\n\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(object) || !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(object.primitive)) {\n      break;\n    }\n\n    if (!exclude) {\n      result.push(pickedResult);\n      if (0 >= --limit) {\n        break;\n      }\n    }\n\n    var primitive = object.primitive;\n    var hasShowAttribute = false;\n\n    // If the picked object has a show attribute, use it.\n    if (typeof primitive.getGeometryInstanceAttributes === "function") {\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(object.id)) {\n        attributes = primitive.getGeometryInstanceAttributes(object.id);\n        if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(attributes) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(attributes.show)) {\n          hasShowAttribute = true;\n          attributes.show = _Core_ShowGeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"].toValue */ .Z.toValue(\n            false,\n            attributes.show\n          );\n          pickedAttributes.push(attributes);\n        }\n      }\n    }\n\n    if (object instanceof _Cesium3DTileFeature_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z) {\n      hasShowAttribute = true;\n      object.show = false;\n      pickedFeatures.push(object);\n    }\n\n    // Otherwise, hide the entire primitive\n    if (!hasShowAttribute) {\n      primitive.show = false;\n      pickedPrimitives.push(primitive);\n    }\n\n    pickedResult = pickCallback();\n  }\n\n  // Unhide everything we hid while drill picking\n  for (i = 0; i < pickedPrimitives.length; ++i) {\n    pickedPrimitives[i].show = true;\n  }\n\n  for (i = 0; i < pickedAttributes.length; ++i) {\n    attributes = pickedAttributes[i];\n    attributes.show = _Core_ShowGeometryInstanceAttribute_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"].toValue */ .Z.toValue(\n      true,\n      attributes.show\n    );\n  }\n\n  for (i = 0; i < pickedFeatures.length; ++i) {\n    pickedFeatures[i].show = true;\n  }\n\n  return result;\n}\n\nPicking.prototype.drillPick = function (\n  scene,\n  windowPosition,\n  limit,\n  width,\n  height\n) {\n  var that = this;\n  var pickCallback = function () {\n    var object = that.pick(scene, windowPosition, width, height);\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(object)) {\n      return {\n        object: object,\n        position: undefined,\n        exclude: false,\n      };\n    }\n  };\n  var objects = drillPick(limit, pickCallback);\n  return objects.map(function (element) {\n    return element.object;\n  });\n};\n\nvar scratchRight = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\nvar scratchUp = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\n\nfunction MostDetailedRayPick(ray, width, tilesets) {\n  this.ray = ray;\n  this.width = width;\n  this.tilesets = tilesets;\n  this.ready = false;\n  this.deferred = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].defer */ .Z.defer();\n  this.promise = this.deferred.promise;\n}\n\nfunction updateOffscreenCameraFromRay(picking, ray, width, camera) {\n  var direction = ray.direction;\n  var orthogonalAxis = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].mostOrthogonalAxis */ .Z.mostOrthogonalAxis(direction, scratchRight);\n  var right = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].cross */ .Z.cross(direction, orthogonalAxis, scratchRight);\n  var up = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].cross */ .Z.cross(direction, right, scratchUp);\n\n  camera.position = ray.origin;\n  camera.direction = direction;\n  camera.up = up;\n  camera.right = right;\n\n  camera.frustum.width = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(width, offscreenDefaultWidth);\n  return camera.frustum.computeCullingVolume(\n    camera.positionWC,\n    camera.directionWC,\n    camera.upWC\n  );\n}\n\nfunction updateMostDetailedRayPick(picking, scene, rayPick) {\n  var frameState = scene.frameState;\n\n  var ray = rayPick.ray;\n  var width = rayPick.width;\n  var tilesets = rayPick.tilesets;\n\n  var camera = picking._pickOffscreenView.camera;\n  var cullingVolume = updateOffscreenCameraFromRay(picking, ray, width, camera);\n\n  var tilesetPassState = mostDetailedPreloadTilesetPassState;\n  tilesetPassState.camera = camera;\n  tilesetPassState.cullingVolume = cullingVolume;\n\n  var ready = true;\n  var tilesetsLength = tilesets.length;\n  for (var i = 0; i < tilesetsLength; ++i) {\n    var tileset = tilesets[i];\n    if (tileset.show && scene.primitives.contains(tileset)) {\n      // Only update tilesets that are still contained in the scene\'s primitive collection and are still visible\n      // Update tilesets continually until all tilesets are ready. This way tiles are never removed from the cache.\n      tileset.updateForPass(frameState, tilesetPassState);\n      ready = ready && tilesetPassState.ready;\n    }\n  }\n\n  if (ready) {\n    rayPick.deferred.resolve();\n  }\n\n  return ready;\n}\n\nPicking.prototype.updateMostDetailedRayPicks = function (scene) {\n  // Modifies array during iteration\n  var rayPicks = this._mostDetailedRayPicks;\n  for (var i = 0; i < rayPicks.length; ++i) {\n    if (updateMostDetailedRayPick(this, scene, rayPicks[i])) {\n      rayPicks.splice(i--, 1);\n    }\n  }\n};\n\nfunction getTilesets(primitives, objectsToExclude, tilesets) {\n  var length = primitives.length;\n  for (var i = 0; i < length; ++i) {\n    var primitive = primitives.get(i);\n    if (primitive.show) {\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(primitive.isCesium3DTileset)) {\n        if (\n          !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(objectsToExclude) ||\n          objectsToExclude.indexOf(primitive) === -1\n        ) {\n          tilesets.push(primitive);\n        }\n      } else if (primitive instanceof _PrimitiveCollection_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z) {\n        getTilesets(primitive, objectsToExclude, tilesets);\n      }\n    }\n  }\n}\n\nfunction launchMostDetailedRayPick(\n  picking,\n  scene,\n  ray,\n  objectsToExclude,\n  width,\n  callback\n) {\n  var tilesets = [];\n  getTilesets(scene.primitives, objectsToExclude, tilesets);\n  if (tilesets.length === 0) {\n    return _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].resolve */ .Z.resolve(callback());\n  }\n\n  var rayPick = new MostDetailedRayPick(ray, width, tilesets);\n  picking._mostDetailedRayPicks.push(rayPick);\n  return rayPick.promise.then(function () {\n    return callback();\n  });\n}\n\nfunction isExcluded(object, objectsToExclude) {\n  if (\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(object) ||\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(objectsToExclude) ||\n    objectsToExclude.length === 0\n  ) {\n    return false;\n  }\n  return (\n    objectsToExclude.indexOf(object) > -1 ||\n    objectsToExclude.indexOf(object.primitive) > -1 ||\n    objectsToExclude.indexOf(object.id) > -1\n  );\n}\n\nfunction getRayIntersection(\n  picking,\n  scene,\n  ray,\n  objectsToExclude,\n  width,\n  requirePosition,\n  mostDetailed\n) {\n  var context = scene.context;\n  var uniformState = context.uniformState;\n  var frameState = scene.frameState;\n\n  var view = picking._pickOffscreenView;\n  scene.view = view;\n\n  updateOffscreenCameraFromRay(picking, ray, width, view.camera);\n\n  scratchRectangle = _Core_BoundingRectangle_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].clone */ .Z.clone(view.viewport, scratchRectangle);\n\n  var passState = view.pickFramebuffer.begin(scratchRectangle, view.viewport);\n\n  scene.jobScheduler.disableThisFrame();\n\n  scene.updateFrameState();\n  frameState.invertClassification = false;\n  frameState.passes.pick = true;\n  frameState.passes.offscreen = true;\n\n  if (mostDetailed) {\n    frameState.tilesetPassState = mostDetailedPickTilesetPassState;\n  } else {\n    frameState.tilesetPassState = pickTilesetPassState;\n  }\n\n  uniformState.update(frameState);\n\n  scene.updateEnvironment();\n  scene.updateAndExecuteCommands(passState, scratchColorZero);\n  scene.resolveFramebuffers(passState);\n\n  var position;\n  var object = view.pickFramebuffer.end(scratchRectangle);\n\n  if (scene.context.depthTexture) {\n    var numFrustums = view.frustumCommandsList.length;\n    for (var i = 0; i < numFrustums; ++i) {\n      var pickDepth = picking.getPickDepth(scene, i);\n      var depth = pickDepth.getDepth(context, 0, 0);\n      if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(depth)) {\n        continue;\n      }\n      if (depth > 0.0 && depth < 1.0) {\n        var renderedFrustum = view.frustumCommandsList[i];\n        var near =\n          renderedFrustum.near *\n          (i !== 0 ? scene.opaqueFrustumNearOffset : 1.0);\n        var far = renderedFrustum.far;\n        var distance = near + depth * (far - near);\n        position = _Core_Ray_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].getPoint */ .Z.getPoint(ray, distance);\n        break;\n      }\n    }\n  }\n\n  scene.view = scene.defaultView;\n  context.endFrame();\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(object) || (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(position)) {\n    return {\n      object: object,\n      position: position,\n      exclude:\n        (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(position) && requirePosition) ||\n        isExcluded(object, objectsToExclude),\n    };\n  }\n}\n\nfunction getRayIntersections(\n  picking,\n  scene,\n  ray,\n  limit,\n  objectsToExclude,\n  width,\n  requirePosition,\n  mostDetailed\n) {\n  var pickCallback = function () {\n    return getRayIntersection(\n      picking,\n      scene,\n      ray,\n      objectsToExclude,\n      width,\n      requirePosition,\n      mostDetailed\n    );\n  };\n  return drillPick(limit, pickCallback);\n}\n\nfunction pickFromRay(\n  picking,\n  scene,\n  ray,\n  objectsToExclude,\n  width,\n  requirePosition,\n  mostDetailed\n) {\n  var results = getRayIntersections(\n    picking,\n    scene,\n    ray,\n    1,\n    objectsToExclude,\n    width,\n    requirePosition,\n    mostDetailed\n  );\n  if (results.length > 0) {\n    return results[0];\n  }\n}\n\nfunction drillPickFromRay(\n  picking,\n  scene,\n  ray,\n  limit,\n  objectsToExclude,\n  width,\n  requirePosition,\n  mostDetailed\n) {\n  return getRayIntersections(\n    picking,\n    scene,\n    ray,\n    limit,\n    objectsToExclude,\n    width,\n    requirePosition,\n    mostDetailed\n  );\n}\n\nfunction deferPromiseUntilPostRender(scene, promise) {\n  // Resolve promise after scene\'s postRender in case entities are created when the promise resolves.\n  // Entities can\'t be created between viewer._onTick and viewer._postRender.\n  var deferred = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].defer */ .Z.defer();\n  promise\n    .then(function (result) {\n      var removeCallback = scene.postRender.addEventListener(function () {\n        deferred.resolve(result);\n        removeCallback();\n      });\n      scene.requestRender();\n    })\n    .otherwise(function (error) {\n      deferred.reject(error);\n    });\n  return deferred.promise;\n}\n\nPicking.prototype.pickFromRay = function (scene, ray, objectsToExclude, width) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].defined */ .Z.defined("ray", ray);\n  if (scene.mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].SCENE3D */ .Z.SCENE3D) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z(\n      "Ray intersections are only supported in 3D mode."\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  return pickFromRay(this, scene, ray, objectsToExclude, width, false, false);\n};\n\nPicking.prototype.drillPickFromRay = function (\n  scene,\n  ray,\n  limit,\n  objectsToExclude,\n  width\n) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].defined */ .Z.defined("ray", ray);\n  if (scene.mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].SCENE3D */ .Z.SCENE3D) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z(\n      "Ray intersections are only supported in 3D mode."\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  return drillPickFromRay(\n    this,\n    scene,\n    ray,\n    limit,\n    objectsToExclude,\n    width,\n    false,\n    false\n  );\n};\n\nPicking.prototype.pickFromRayMostDetailed = function (\n  scene,\n  ray,\n  objectsToExclude,\n  width\n) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].defined */ .Z.defined("ray", ray);\n  if (scene.mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].SCENE3D */ .Z.SCENE3D) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z(\n      "Ray intersections are only supported in 3D mode."\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  var that = this;\n  ray = _Core_Ray_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].clone */ .Z.clone(ray);\n  objectsToExclude = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(objectsToExclude)\n    ? objectsToExclude.slice()\n    : objectsToExclude;\n  return deferPromiseUntilPostRender(\n    scene,\n    launchMostDetailedRayPick(\n      that,\n      scene,\n      ray,\n      objectsToExclude,\n      width,\n      function () {\n        return pickFromRay(\n          that,\n          scene,\n          ray,\n          objectsToExclude,\n          width,\n          false,\n          true\n        );\n      }\n    )\n  );\n};\n\nPicking.prototype.drillPickFromRayMostDetailed = function (\n  scene,\n  ray,\n  limit,\n  objectsToExclude,\n  width\n) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].defined */ .Z.defined("ray", ray);\n  if (scene.mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].SCENE3D */ .Z.SCENE3D) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z(\n      "Ray intersections are only supported in 3D mode."\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  var that = this;\n  ray = _Core_Ray_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].clone */ .Z.clone(ray);\n  objectsToExclude = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(objectsToExclude)\n    ? objectsToExclude.slice()\n    : objectsToExclude;\n  return deferPromiseUntilPostRender(\n    scene,\n    launchMostDetailedRayPick(\n      that,\n      scene,\n      ray,\n      objectsToExclude,\n      width,\n      function () {\n        return drillPickFromRay(\n          that,\n          scene,\n          ray,\n          limit,\n          objectsToExclude,\n          width,\n          false,\n          true\n        );\n      }\n    )\n  );\n};\n\nvar scratchSurfacePosition = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\nvar scratchSurfaceNormal = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\nvar scratchSurfaceRay = new _Core_Ray_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z();\nvar scratchCartographic = new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\n\nfunction getRayForSampleHeight(scene, cartographic) {\n  var globe = scene.globe;\n  var ellipsoid = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(globe)\n    ? globe.ellipsoid\n    : scene.mapProjection.ellipsoid;\n  var height = _Core_ApproximateTerrainHeights_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"]._defaultMaxTerrainHeight */ .Z._defaultMaxTerrainHeight;\n  var surfaceNormal = ellipsoid.geodeticSurfaceNormalCartographic(\n    cartographic,\n    scratchSurfaceNormal\n  );\n  var surfacePosition = _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].toCartesian */ .Z.toCartesian(\n    cartographic,\n    ellipsoid,\n    scratchSurfacePosition\n  );\n  var surfaceRay = scratchSurfaceRay;\n  surfaceRay.origin = surfacePosition;\n  surfaceRay.direction = surfaceNormal;\n  var ray = new _Core_Ray_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z();\n  _Core_Ray_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].getPoint */ .Z.getPoint(surfaceRay, height, ray.origin);\n  _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].negate */ .Z.negate(surfaceNormal, ray.direction);\n  return ray;\n}\n\nfunction getRayForClampToHeight(scene, cartesian) {\n  var globe = scene.globe;\n  var ellipsoid = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(globe)\n    ? globe.ellipsoid\n    : scene.mapProjection.ellipsoid;\n  var cartographic = _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].fromCartesian */ .Z.fromCartesian(\n    cartesian,\n    ellipsoid,\n    scratchCartographic\n  );\n  return getRayForSampleHeight(scene, cartographic);\n}\n\nfunction getHeightFromCartesian(scene, cartesian) {\n  var globe = scene.globe;\n  var ellipsoid = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(globe)\n    ? globe.ellipsoid\n    : scene.mapProjection.ellipsoid;\n  var cartographic = _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].fromCartesian */ .Z.fromCartesian(\n    cartesian,\n    ellipsoid,\n    scratchCartographic\n  );\n  return cartographic.height;\n}\n\nfunction sampleHeightMostDetailed(\n  picking,\n  scene,\n  cartographic,\n  objectsToExclude,\n  width\n) {\n  var ray = getRayForSampleHeight(scene, cartographic);\n  return launchMostDetailedRayPick(\n    picking,\n    scene,\n    ray,\n    objectsToExclude,\n    width,\n    function () {\n      var pickResult = pickFromRay(\n        picking,\n        scene,\n        ray,\n        objectsToExclude,\n        width,\n        true,\n        true\n      );\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(pickResult)) {\n        return getHeightFromCartesian(scene, pickResult.position);\n      }\n    }\n  );\n}\n\nfunction clampToHeightMostDetailed(\n  picking,\n  scene,\n  cartesian,\n  objectsToExclude,\n  width,\n  result\n) {\n  var ray = getRayForClampToHeight(scene, cartesian);\n  return launchMostDetailedRayPick(\n    picking,\n    scene,\n    ray,\n    objectsToExclude,\n    width,\n    function () {\n      var pickResult = pickFromRay(\n        picking,\n        scene,\n        ray,\n        objectsToExclude,\n        width,\n        true,\n        true\n      );\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(pickResult)) {\n        return _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].clone */ .Z.clone(pickResult.position, result);\n      }\n    }\n  );\n}\n\nPicking.prototype.sampleHeight = function (\n  scene,\n  position,\n  objectsToExclude,\n  width\n) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].defined */ .Z.defined("position", position);\n  if (scene.mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].SCENE3D */ .Z.SCENE3D) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z("sampleHeight is only supported in 3D mode.");\n  }\n  if (!scene.sampleHeightSupported) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z(\n      "sampleHeight requires depth texture support. Check sampleHeightSupported."\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  var ray = getRayForSampleHeight(scene, position);\n  var pickResult = pickFromRay(\n    this,\n    scene,\n    ray,\n    objectsToExclude,\n    width,\n    true,\n    false\n  );\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(pickResult)) {\n    return getHeightFromCartesian(scene, pickResult.position);\n  }\n};\n\nPicking.prototype.clampToHeight = function (\n  scene,\n  cartesian,\n  objectsToExclude,\n  width,\n  result\n) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].defined */ .Z.defined("cartesian", cartesian);\n  if (scene.mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].SCENE3D */ .Z.SCENE3D) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z("clampToHeight is only supported in 3D mode.");\n  }\n  if (!scene.clampToHeightSupported) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z(\n      "clampToHeight requires depth texture support. Check clampToHeightSupported."\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  var ray = getRayForClampToHeight(scene, cartesian);\n  var pickResult = pickFromRay(\n    this,\n    scene,\n    ray,\n    objectsToExclude,\n    width,\n    true,\n    false\n  );\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(pickResult)) {\n    return _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].clone */ .Z.clone(pickResult.position, result);\n  }\n};\n\nPicking.prototype.sampleHeightMostDetailed = function (\n  scene,\n  positions,\n  objectsToExclude,\n  width\n) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].defined */ .Z.defined("positions", positions);\n  if (scene.mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].SCENE3D */ .Z.SCENE3D) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z(\n      "sampleHeightMostDetailed is only supported in 3D mode."\n    );\n  }\n  if (!scene.sampleHeightSupported) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z(\n      "sampleHeightMostDetailed requires depth texture support. Check sampleHeightSupported."\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  objectsToExclude = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(objectsToExclude)\n    ? objectsToExclude.slice()\n    : objectsToExclude;\n  var length = positions.length;\n  var promises = new Array(length);\n  for (var i = 0; i < length; ++i) {\n    promises[i] = sampleHeightMostDetailed(\n      this,\n      scene,\n      positions[i],\n      objectsToExclude,\n      width\n    );\n  }\n  return deferPromiseUntilPostRender(\n    scene,\n    _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].all */ .Z.all(promises).then(function (heights) {\n      var length = heights.length;\n      for (var i = 0; i < length; ++i) {\n        positions[i].height = heights[i];\n      }\n      return positions;\n    })\n  );\n};\n\nPicking.prototype.clampToHeightMostDetailed = function (\n  scene,\n  cartesians,\n  objectsToExclude,\n  width\n) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].defined */ .Z.defined("cartesians", cartesians);\n  if (scene.mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].SCENE3D */ .Z.SCENE3D) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z(\n      "clampToHeightMostDetailed is only supported in 3D mode."\n    );\n  }\n  if (!scene.clampToHeightSupported) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z(\n      "clampToHeightMostDetailed requires depth texture support. Check clampToHeightSupported."\n    );\n  }\n  //>>includeEnd(\'debug\');\n\n  objectsToExclude = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z)(objectsToExclude)\n    ? objectsToExclude.slice()\n    : objectsToExclude;\n  var length = cartesians.length;\n  var promises = new Array(length);\n  for (var i = 0; i < length; ++i) {\n    promises[i] = clampToHeightMostDetailed(\n      this,\n      scene,\n      cartesians[i],\n      objectsToExclude,\n      width,\n      cartesians[i]\n    );\n  }\n  return deferPromiseUntilPostRender(\n    scene,\n    _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].all */ .Z.all(promises).then(function (clampedCartesians) {\n      var length = clampedCartesians.length;\n      for (var i = 0; i < length; ++i) {\n        cartesians[i] = clampedCartesians[i];\n      }\n      return cartesians;\n    })\n  );\n};\n\nPicking.prototype.destroy = function () {\n  this._pickOffscreenView =\n    this._pickOffscreenView && this._pickOffscreenView.destroy();\n};\n/* harmony default export */ __webpack_exports__["Z"] = (Picking);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTg0NDEuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQTZFO0FBQ2hCO0FBQ2Q7QUFDQTtBQUNJO0FBQ2Q7QUFDQTtBQUNjO0FBQ1Y7QUFDYztBQUNkO0FBQ3dCO0FBQ2tCO0FBQ3BCO0FBQ2tCO0FBQ2hEO0FBQ29EO0FBQzVDO0FBQ1I7QUFDMEI7QUFDTjtBQUNVO0FBQ3hCO0FBQ29CO0FBQ3BCO0FBQ1k7QUFDdEI7O0FBRTdCOztBQUVBLDhDQUE4QywyRUFBcUI7QUFDbkUsUUFBUSxrSEFBc0M7QUFDOUMsQ0FBQzs7QUFFRCwyQ0FBMkMsMkVBQXFCO0FBQ2hFLFFBQVEsNEdBQW1DO0FBQzNDLENBQUM7O0FBRUQsK0JBQStCLDJFQUFxQjtBQUNwRCxRQUFRLGdGQUFxQjtBQUM3QixDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsa0NBQWtDLDJFQUFpQjtBQUNuRCxnQ0FBZ0MsNERBQU07QUFDdEMsb0NBQW9DLDhFQUFtQjtBQUN2RDtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVILGdDQUFnQywwREFBSTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxPQUFPLHNFQUFPO0FBQ2Qsb0JBQW9CLCtEQUFTO0FBQzdCO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHFDQUFxQyx1RkFBNEI7QUFDakUsNkJBQTZCLG9FQUFVO0FBQ3ZDLGdDQUFnQyxvRUFBVTtBQUMxQyxnQ0FBZ0Msb0VBQVU7QUFDMUMsd0NBQXdDLGlFQUFPOztBQUUvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLHNFQUFPO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxrQkFBa0IsNkVBQWE7QUFDL0I7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLG1GQUFnQjs7QUFFdkMsZUFBZSxnRkFBZ0I7QUFDL0IsRUFBRSxzR0FBMkI7QUFDN0IsRUFBRSw0RUFBYztBQUNoQixFQUFFLHNHQUEyQjtBQUM3QixFQUFFLDRFQUFjOztBQUVoQjs7QUFFQSxxQkFBcUIsK0VBQWlCO0FBQ3RDLElBQUksOEZBQXVCO0FBQzNCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEscUNBQXFDLHNGQUEyQjtBQUNoRSxnQ0FBZ0Msb0VBQVU7O0FBRTFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDhFQUFtQjtBQUMxQyx1QkFBdUIsdUZBQTRCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiwyRUFBaUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixvRUFBVTtBQUNwQywyQkFBMkIsK0RBQUs7O0FBRWhDO0FBQ0E7QUFDQSxPQUFPLHNFQUFPO0FBQ2QsY0FBYyx3RUFBYztBQUM1QjtBQUNBOztBQUVBLDBCQUEwQiwwRUFBWTtBQUN0QywyQkFBMkIsMEVBQVk7O0FBRXZDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx1QkFBdUIsdUZBQXVCOztBQUU5Qyw4QkFBOEIsbUlBQThDO0FBQzVFO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx1QkFBdUIsdUZBQXVCOztBQUU5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxvQ0FBb0MsNkVBQWtCO0FBQ3RELDZDQUE2QyxzRkFBMkI7QUFDeEUscUNBQXFDLDhFQUFtQjtBQUN4RCw4Q0FBOEMsdUZBQTRCOztBQUUxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsT0FBTyxzRUFBTztBQUNkLGNBQWMsd0VBQWM7QUFDNUI7QUFDQTtBQUNBLGNBQWMsd0VBQWM7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLFdBQVcsZ0ZBQWdCO0FBQzNCOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLDhCQUE4QixtSUFBOEM7QUFDNUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLE1BQU0sc0VBQU87QUFDYjtBQUNBLElBQUksU0FBUyxzRUFBTztBQUNwQjtBQUNBLElBQUksU0FBUyxzRUFBTztBQUNwQjtBQUNBLElBQUk7QUFDSjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxrQkFBa0IsaUJBQWlCO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsc0VBQU87QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QiwrRUFBaUI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxlQUFlLHFJQUErQztBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHlCQUF5QiwrRUFBaUI7QUFDMUM7QUFDQTtBQUNBOztBQUVBLDBDQUEwQyxnRkFBZ0I7QUFDMUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSwwQ0FBMEMsc0VBQVk7O0FBRXREO0FBQ0E7QUFDQSxNQUFNLHNFQUFPLDJCQUEyQiwrRUFBaUI7QUFDekQsSUFBSSw4RkFBdUI7O0FBRTNCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPLHNFQUFPO0FBQ2Q7QUFDQTs7QUFFQTtBQUNBLFNBQVMsc0VBQU87QUFDaEI7QUFDQTtBQUNBOztBQUVBLFFBQVEsc0VBQU8sZUFBZSxzRUFBTztBQUNyQztBQUNBO0FBQ0E7O0FBRUEsU0FBUyxzRUFBTyxhQUFhLHNFQUFPO0FBQ3BDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVUsc0VBQU87QUFDakI7QUFDQSxZQUFZLHNFQUFPLGdCQUFnQixzRUFBTztBQUMxQztBQUNBLDRCQUE0Qix3R0FBcUM7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsMEJBQTBCLHlFQUFtQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxjQUFjLDZCQUE2QjtBQUMzQztBQUNBOztBQUVBLGNBQWMsNkJBQTZCO0FBQzNDO0FBQ0Esc0JBQXNCLHdHQUFxQztBQUMzRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxjQUFjLDJCQUEyQjtBQUN6QztBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNFQUFPO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUEsdUJBQXVCLG9FQUFVO0FBQ2pDLG9CQUFvQixvRUFBVTs7QUFFOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixpRkFBVTtBQUM1QjtBQUNBOztBQUVBO0FBQ0E7QUFDQSx1QkFBdUIsMEdBQTZCO0FBQ3BELGNBQWMsZ0ZBQWdCO0FBQzlCLFdBQVcsZ0ZBQWdCOztBQUUzQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQSx5QkFBeUIsMEVBQVk7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxrQkFBa0Isb0JBQW9CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHFCQUFxQjtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxrQkFBa0IsWUFBWTtBQUM5QjtBQUNBO0FBQ0EsVUFBVSxzRUFBTztBQUNqQjtBQUNBLFdBQVcsc0VBQU87QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDhCQUE4Qix5RUFBbUI7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxxRkFBWTtBQUN2Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0EsS0FBSyxzRUFBTztBQUNaLEtBQUssc0VBQU87QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQSxxQkFBcUIsdUZBQXVCOztBQUU1Qzs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9CQUFvQixpQkFBaUI7QUFDckM7QUFDQTtBQUNBLFdBQVcsc0VBQU87QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLGdGQUFZO0FBQy9CO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsTUFBTSxzRUFBTyxZQUFZLHNFQUFPO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxzRUFBTztBQUNqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixpRkFBVTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRSwrRUFBYTtBQUNmLHFCQUFxQiwrRUFBaUI7QUFDdEMsY0FBYyx3RUFBYztBQUM1QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFLCtFQUFhO0FBQ2YscUJBQXFCLCtFQUFpQjtBQUN0QyxjQUFjLHdFQUFjO0FBQzVCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFLCtFQUFhO0FBQ2YscUJBQXFCLCtFQUFpQjtBQUN0QyxjQUFjLHdFQUFjO0FBQzVCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsUUFBUSwwRUFBUztBQUNqQixxQkFBcUIsc0VBQU87QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFLCtFQUFhO0FBQ2YscUJBQXFCLCtFQUFpQjtBQUN0QyxjQUFjLHdFQUFjO0FBQzVCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsUUFBUSwwRUFBUztBQUNqQixxQkFBcUIsc0VBQU87QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsaUNBQWlDLG9FQUFVO0FBQzNDLCtCQUErQixvRUFBVTtBQUN6Qyw0QkFBNEIsOERBQUc7QUFDL0IsOEJBQThCLHNFQUFZOztBQUUxQztBQUNBO0FBQ0Esa0JBQWtCLHNFQUFPO0FBQ3pCO0FBQ0E7QUFDQSxlQUFlLHFJQUFrRDtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qiw4RkFBd0I7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsOERBQUc7QUFDbkIsRUFBRSxnRkFBWTtBQUNkLEVBQUUsa0ZBQWlCO0FBQ25CO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGtCQUFrQixzRUFBTztBQUN6QjtBQUNBO0FBQ0EscUJBQXFCLGtHQUEwQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGtCQUFrQixzRUFBTztBQUN6QjtBQUNBO0FBQ0EscUJBQXFCLGtHQUEwQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxzRUFBTztBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxzRUFBTztBQUNqQixlQUFlLGdGQUFnQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUUsK0VBQWE7QUFDZixxQkFBcUIsK0VBQWlCO0FBQ3RDLGNBQWMsd0VBQWM7QUFDNUI7QUFDQTtBQUNBLGNBQWMsd0VBQWM7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLHNFQUFPO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFLCtFQUFhO0FBQ2YscUJBQXFCLCtFQUFpQjtBQUN0QyxjQUFjLHdFQUFjO0FBQzVCO0FBQ0E7QUFDQSxjQUFjLHdFQUFjO0FBQzVCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxzRUFBTztBQUNiLFdBQVcsZ0ZBQWdCO0FBQzNCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFLCtFQUFhO0FBQ2YscUJBQXFCLCtFQUFpQjtBQUN0QyxjQUFjLHdFQUFjO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyx3RUFBYztBQUM1QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxxQkFBcUIsc0VBQU87QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsWUFBWTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksNkVBQVE7QUFDWjtBQUNBLHNCQUFzQixZQUFZO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRSwrRUFBYTtBQUNmLHFCQUFxQiwrRUFBaUI7QUFDdEMsY0FBYyx3RUFBYztBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsd0VBQWM7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7O0FBRUEscUJBQXFCLHNFQUFPO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLFlBQVk7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksNkVBQVE7QUFDWjtBQUNBLHNCQUFzQixZQUFZO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQWUsT0FBTyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnVlMy13ZWJwYWNrNS8uL25vZGVfbW9kdWxlcy9jZXNpdW0vU291cmNlL1NjZW5lL1BpY2tpbmcuanM/NTk0OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXBwcm94aW1hdGVUZXJyYWluSGVpZ2h0cyBmcm9tIFwiLi4vQ29yZS9BcHByb3hpbWF0ZVRlcnJhaW5IZWlnaHRzLmpzXCI7XG5pbXBvcnQgQm91bmRpbmdSZWN0YW5nbGUgZnJvbSBcIi4uL0NvcmUvQm91bmRpbmdSZWN0YW5nbGUuanNcIjtcbmltcG9ydCBDYXJ0ZXNpYW4yIGZyb20gXCIuLi9Db3JlL0NhcnRlc2lhbjIuanNcIjtcbmltcG9ydCBDYXJ0ZXNpYW4zIGZyb20gXCIuLi9Db3JlL0NhcnRlc2lhbjMuanNcIjtcbmltcG9ydCBDYXJ0b2dyYXBoaWMgZnJvbSBcIi4uL0NvcmUvQ2FydG9ncmFwaGljLmpzXCI7XG5pbXBvcnQgQ2hlY2sgZnJvbSBcIi4uL0NvcmUvQ2hlY2suanNcIjtcbmltcG9ydCBDb2xvciBmcm9tIFwiLi4vQ29yZS9Db2xvci5qc1wiO1xuaW1wb3J0IGRlZmF1bHRWYWx1ZSBmcm9tIFwiLi4vQ29yZS9kZWZhdWx0VmFsdWUuanNcIjtcbmltcG9ydCBkZWZpbmVkIGZyb20gXCIuLi9Db3JlL2RlZmluZWQuanNcIjtcbmltcG9ydCBEZXZlbG9wZXJFcnJvciBmcm9tIFwiLi4vQ29yZS9EZXZlbG9wZXJFcnJvci5qc1wiO1xuaW1wb3J0IE1hdHJpeDQgZnJvbSBcIi4uL0NvcmUvTWF0cml4NC5qc1wiO1xuaW1wb3J0IE9ydGhvZ3JhcGhpY0ZydXN0dW0gZnJvbSBcIi4uL0NvcmUvT3J0aG9ncmFwaGljRnJ1c3R1bS5qc1wiO1xuaW1wb3J0IE9ydGhvZ3JhcGhpY09mZkNlbnRlckZydXN0dW0gZnJvbSBcIi4uL0NvcmUvT3J0aG9ncmFwaGljT2ZmQ2VudGVyRnJ1c3R1bS5qc1wiO1xuaW1wb3J0IFBlcnNwZWN0aXZlRnJ1c3R1bSBmcm9tIFwiLi4vQ29yZS9QZXJzcGVjdGl2ZUZydXN0dW0uanNcIjtcbmltcG9ydCBQZXJzcGVjdGl2ZU9mZkNlbnRlckZydXN0dW0gZnJvbSBcIi4uL0NvcmUvUGVyc3BlY3RpdmVPZmZDZW50ZXJGcnVzdHVtLmpzXCI7XG5pbXBvcnQgUmF5IGZyb20gXCIuLi9Db3JlL1JheS5qc1wiO1xuaW1wb3J0IFNob3dHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlIGZyb20gXCIuLi9Db3JlL1Nob3dHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlLmpzXCI7XG5pbXBvcnQgd2hlbiBmcm9tIFwiLi4vVGhpcmRQYXJ0eS93aGVuLmpzXCI7XG5pbXBvcnQgQ2FtZXJhIGZyb20gXCIuL0NhbWVyYS5qc1wiO1xuaW1wb3J0IENlc2l1bTNEVGlsZUZlYXR1cmUgZnJvbSBcIi4vQ2VzaXVtM0RUaWxlRmVhdHVyZS5qc1wiO1xuaW1wb3J0IENlc2l1bTNEVGlsZVBhc3MgZnJvbSBcIi4vQ2VzaXVtM0RUaWxlUGFzcy5qc1wiO1xuaW1wb3J0IENlc2l1bTNEVGlsZVBhc3NTdGF0ZSBmcm9tIFwiLi9DZXNpdW0zRFRpbGVQYXNzU3RhdGUuanNcIjtcbmltcG9ydCBQaWNrRGVwdGggZnJvbSBcIi4vUGlja0RlcHRoLmpzXCI7XG5pbXBvcnQgUHJpbWl0aXZlQ29sbGVjdGlvbiBmcm9tIFwiLi9QcmltaXRpdmVDb2xsZWN0aW9uLmpzXCI7XG5pbXBvcnQgU2NlbmVNb2RlIGZyb20gXCIuL1NjZW5lTW9kZS5qc1wiO1xuaW1wb3J0IFNjZW5lVHJhbnNmb3JtcyBmcm9tIFwiLi9TY2VuZVRyYW5zZm9ybXMuanNcIjtcbmltcG9ydCBWaWV3IGZyb20gXCIuL1ZpZXcuanNcIjtcblxudmFyIG9mZnNjcmVlbkRlZmF1bHRXaWR0aCA9IDAuMTtcblxudmFyIG1vc3REZXRhaWxlZFByZWxvYWRUaWxlc2V0UGFzc1N0YXRlID0gbmV3IENlc2l1bTNEVGlsZVBhc3NTdGF0ZSh7XG4gIHBhc3M6IENlc2l1bTNEVGlsZVBhc3MuTU9TVF9ERVRBSUxFRF9QUkVMT0FELFxufSk7XG5cbnZhciBtb3N0RGV0YWlsZWRQaWNrVGlsZXNldFBhc3NTdGF0ZSA9IG5ldyBDZXNpdW0zRFRpbGVQYXNzU3RhdGUoe1xuICBwYXNzOiBDZXNpdW0zRFRpbGVQYXNzLk1PU1RfREVUQUlMRURfUElDSyxcbn0pO1xuXG52YXIgcGlja1RpbGVzZXRQYXNzU3RhdGUgPSBuZXcgQ2VzaXVtM0RUaWxlUGFzc1N0YXRlKHtcbiAgcGFzczogQ2VzaXVtM0RUaWxlUGFzcy5QSUNLLFxufSk7XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gUGlja2luZyhzY2VuZSkge1xuICB0aGlzLl9tb3N0RGV0YWlsZWRSYXlQaWNrcyA9IFtdO1xuICB0aGlzLnBpY2tSZW5kZXJTdGF0ZUNhY2hlID0ge307XG4gIHRoaXMuX3BpY2tQb3NpdGlvbkNhY2hlID0ge307XG4gIHRoaXMuX3BpY2tQb3NpdGlvbkNhY2hlRGlydHkgPSBmYWxzZTtcblxuICB2YXIgcGlja09mZnNjcmVlblZpZXdwb3J0ID0gbmV3IEJvdW5kaW5nUmVjdGFuZ2xlKDAsIDAsIDEsIDEpO1xuICB2YXIgcGlja09mZnNjcmVlbkNhbWVyYSA9IG5ldyBDYW1lcmEoc2NlbmUpO1xuICBwaWNrT2Zmc2NyZWVuQ2FtZXJhLmZydXN0dW0gPSBuZXcgT3J0aG9ncmFwaGljRnJ1c3R1bSh7XG4gICAgd2lkdGg6IG9mZnNjcmVlbkRlZmF1bHRXaWR0aCxcbiAgICBhc3BlY3RSYXRpbzogMS4wLFxuICAgIG5lYXI6IDAuMSxcbiAgfSk7XG5cbiAgdGhpcy5fcGlja09mZnNjcmVlblZpZXcgPSBuZXcgVmlldyhcbiAgICBzY2VuZSxcbiAgICBwaWNrT2Zmc2NyZWVuQ2FtZXJhLFxuICAgIHBpY2tPZmZzY3JlZW5WaWV3cG9ydFxuICApO1xufVxuXG5QaWNraW5nLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuX3BpY2tQb3NpdGlvbkNhY2hlRGlydHkgPSB0cnVlO1xufTtcblxuUGlja2luZy5wcm90b3R5cGUuZ2V0UGlja0RlcHRoID0gZnVuY3Rpb24gKHNjZW5lLCBpbmRleCkge1xuICB2YXIgcGlja0RlcHRocyA9IHNjZW5lLnZpZXcucGlja0RlcHRocztcbiAgdmFyIHBpY2tEZXB0aCA9IHBpY2tEZXB0aHNbaW5kZXhdO1xuICBpZiAoIWRlZmluZWQocGlja0RlcHRoKSkge1xuICAgIHBpY2tEZXB0aCA9IG5ldyBQaWNrRGVwdGgoKTtcbiAgICBwaWNrRGVwdGhzW2luZGV4XSA9IHBpY2tEZXB0aDtcbiAgfVxuICByZXR1cm4gcGlja0RlcHRoO1xufTtcblxudmFyIHNjcmF0Y2hPcnRob1BpY2tpbmdGcnVzdHVtID0gbmV3IE9ydGhvZ3JhcGhpY09mZkNlbnRlckZydXN0dW0oKTtcbnZhciBzY3JhdGNoT3J0aG9PcmlnaW4gPSBuZXcgQ2FydGVzaWFuMygpO1xudmFyIHNjcmF0Y2hPcnRob0RpcmVjdGlvbiA9IG5ldyBDYXJ0ZXNpYW4zKCk7XG52YXIgc2NyYXRjaE9ydGhvUGl4ZWxTaXplID0gbmV3IENhcnRlc2lhbjIoKTtcbnZhciBzY3JhdGNoT3J0aG9QaWNrVm9sdW1lTWF0cml4NCA9IG5ldyBNYXRyaXg0KCk7XG5cbmZ1bmN0aW9uIGdldFBpY2tPcnRob2dyYXBoaWNDdWxsaW5nVm9sdW1lKFxuICBzY2VuZSxcbiAgZHJhd2luZ0J1ZmZlclBvc2l0aW9uLFxuICB3aWR0aCxcbiAgaGVpZ2h0LFxuICB2aWV3cG9ydFxuKSB7XG4gIHZhciBjYW1lcmEgPSBzY2VuZS5jYW1lcmE7XG4gIHZhciBmcnVzdHVtID0gY2FtZXJhLmZydXN0dW07XG4gIGlmIChkZWZpbmVkKGZydXN0dW0uX29mZkNlbnRlckZydXN0dW0pKSB7XG4gICAgZnJ1c3R1bSA9IGZydXN0dW0uX29mZkNlbnRlckZydXN0dW07XG4gIH1cblxuICB2YXIgeCA9ICgyLjAgKiAoZHJhd2luZ0J1ZmZlclBvc2l0aW9uLnggLSB2aWV3cG9ydC54KSkgLyB2aWV3cG9ydC53aWR0aCAtIDEuMDtcbiAgeCAqPSAoZnJ1c3R1bS5yaWdodCAtIGZydXN0dW0ubGVmdCkgKiAwLjU7XG4gIHZhciB5ID1cbiAgICAoMi4wICogKHZpZXdwb3J0LmhlaWdodCAtIGRyYXdpbmdCdWZmZXJQb3NpdGlvbi55IC0gdmlld3BvcnQueSkpIC9cbiAgICAgIHZpZXdwb3J0LmhlaWdodCAtXG4gICAgMS4wO1xuICB5ICo9IChmcnVzdHVtLnRvcCAtIGZydXN0dW0uYm90dG9tKSAqIDAuNTtcblxuICB2YXIgdHJhbnNmb3JtID0gTWF0cml4NC5jbG9uZShcbiAgICBjYW1lcmEudHJhbnNmb3JtLFxuICAgIHNjcmF0Y2hPcnRob1BpY2tWb2x1bWVNYXRyaXg0XG4gICk7XG4gIGNhbWVyYS5fc2V0VHJhbnNmb3JtKE1hdHJpeDQuSURFTlRJVFkpO1xuXG4gIHZhciBvcmlnaW4gPSBDYXJ0ZXNpYW4zLmNsb25lKGNhbWVyYS5wb3NpdGlvbiwgc2NyYXRjaE9ydGhvT3JpZ2luKTtcbiAgQ2FydGVzaWFuMy5tdWx0aXBseUJ5U2NhbGFyKGNhbWVyYS5yaWdodCwgeCwgc2NyYXRjaE9ydGhvRGlyZWN0aW9uKTtcbiAgQ2FydGVzaWFuMy5hZGQoc2NyYXRjaE9ydGhvRGlyZWN0aW9uLCBvcmlnaW4sIG9yaWdpbik7XG4gIENhcnRlc2lhbjMubXVsdGlwbHlCeVNjYWxhcihjYW1lcmEudXAsIHksIHNjcmF0Y2hPcnRob0RpcmVjdGlvbik7XG4gIENhcnRlc2lhbjMuYWRkKHNjcmF0Y2hPcnRob0RpcmVjdGlvbiwgb3JpZ2luLCBvcmlnaW4pO1xuXG4gIGNhbWVyYS5fc2V0VHJhbnNmb3JtKHRyYW5zZm9ybSk7XG5cbiAgaWYgKHNjZW5lLm1vZGUgPT09IFNjZW5lTW9kZS5TQ0VORTJEKSB7XG4gICAgQ2FydGVzaWFuMy5mcm9tRWxlbWVudHMob3JpZ2luLnosIG9yaWdpbi54LCBvcmlnaW4ueSwgb3JpZ2luKTtcbiAgfVxuXG4gIHZhciBwaXhlbFNpemUgPSBmcnVzdHVtLmdldFBpeGVsRGltZW5zaW9ucyhcbiAgICB2aWV3cG9ydC53aWR0aCxcbiAgICB2aWV3cG9ydC5oZWlnaHQsXG4gICAgMS4wLFxuICAgIDEuMCxcbiAgICBzY3JhdGNoT3J0aG9QaXhlbFNpemVcbiAgKTtcblxuICB2YXIgb3J0aG8gPSBzY3JhdGNoT3J0aG9QaWNraW5nRnJ1c3R1bTtcbiAgb3J0aG8ucmlnaHQgPSBwaXhlbFNpemUueCAqIDAuNTtcbiAgb3J0aG8ubGVmdCA9IC1vcnRoby5yaWdodDtcbiAgb3J0aG8udG9wID0gcGl4ZWxTaXplLnkgKiAwLjU7XG4gIG9ydGhvLmJvdHRvbSA9IC1vcnRoby50b3A7XG4gIG9ydGhvLm5lYXIgPSBmcnVzdHVtLm5lYXI7XG4gIG9ydGhvLmZhciA9IGZydXN0dW0uZmFyO1xuXG4gIHJldHVybiBvcnRoby5jb21wdXRlQ3VsbGluZ1ZvbHVtZShvcmlnaW4sIGNhbWVyYS5kaXJlY3Rpb25XQywgY2FtZXJhLnVwV0MpO1xufVxuXG52YXIgc2NyYXRjaFBlcnNwUGlja2luZ0ZydXN0dW0gPSBuZXcgUGVyc3BlY3RpdmVPZmZDZW50ZXJGcnVzdHVtKCk7XG52YXIgc2NyYXRjaFBlcnNwUGl4ZWxTaXplID0gbmV3IENhcnRlc2lhbjIoKTtcblxuZnVuY3Rpb24gZ2V0UGlja1BlcnNwZWN0aXZlQ3VsbGluZ1ZvbHVtZShcbiAgc2NlbmUsXG4gIGRyYXdpbmdCdWZmZXJQb3NpdGlvbixcbiAgd2lkdGgsXG4gIGhlaWdodCxcbiAgdmlld3BvcnRcbikge1xuICB2YXIgY2FtZXJhID0gc2NlbmUuY2FtZXJhO1xuICB2YXIgZnJ1c3R1bSA9IGNhbWVyYS5mcnVzdHVtO1xuICB2YXIgbmVhciA9IGZydXN0dW0ubmVhcjtcblxuICB2YXIgdGFuUGhpID0gTWF0aC50YW4oZnJ1c3R1bS5mb3Z5ICogMC41KTtcbiAgdmFyIHRhblRoZXRhID0gZnJ1c3R1bS5hc3BlY3RSYXRpbyAqIHRhblBoaTtcblxuICB2YXIgeCA9ICgyLjAgKiAoZHJhd2luZ0J1ZmZlclBvc2l0aW9uLnggLSB2aWV3cG9ydC54KSkgLyB2aWV3cG9ydC53aWR0aCAtIDEuMDtcbiAgdmFyIHkgPVxuICAgICgyLjAgKiAodmlld3BvcnQuaGVpZ2h0IC0gZHJhd2luZ0J1ZmZlclBvc2l0aW9uLnkgLSB2aWV3cG9ydC55KSkgL1xuICAgICAgdmlld3BvcnQuaGVpZ2h0IC1cbiAgICAxLjA7XG5cbiAgdmFyIHhEaXIgPSB4ICogbmVhciAqIHRhblRoZXRhO1xuICB2YXIgeURpciA9IHkgKiBuZWFyICogdGFuUGhpO1xuXG4gIHZhciBwaXhlbFNpemUgPSBmcnVzdHVtLmdldFBpeGVsRGltZW5zaW9ucyhcbiAgICB2aWV3cG9ydC53aWR0aCxcbiAgICB2aWV3cG9ydC5oZWlnaHQsXG4gICAgMS4wLFxuICAgIDEuMCxcbiAgICBzY3JhdGNoUGVyc3BQaXhlbFNpemVcbiAgKTtcbiAgdmFyIHBpY2tXaWR0aCA9IHBpeGVsU2l6ZS54ICogd2lkdGggKiAwLjU7XG4gIHZhciBwaWNrSGVpZ2h0ID0gcGl4ZWxTaXplLnkgKiBoZWlnaHQgKiAwLjU7XG5cbiAgdmFyIG9mZkNlbnRlciA9IHNjcmF0Y2hQZXJzcFBpY2tpbmdGcnVzdHVtO1xuICBvZmZDZW50ZXIudG9wID0geURpciArIHBpY2tIZWlnaHQ7XG4gIG9mZkNlbnRlci5ib3R0b20gPSB5RGlyIC0gcGlja0hlaWdodDtcbiAgb2ZmQ2VudGVyLnJpZ2h0ID0geERpciArIHBpY2tXaWR0aDtcbiAgb2ZmQ2VudGVyLmxlZnQgPSB4RGlyIC0gcGlja1dpZHRoO1xuICBvZmZDZW50ZXIubmVhciA9IG5lYXI7XG4gIG9mZkNlbnRlci5mYXIgPSBmcnVzdHVtLmZhcjtcblxuICByZXR1cm4gb2ZmQ2VudGVyLmNvbXB1dGVDdWxsaW5nVm9sdW1lKFxuICAgIGNhbWVyYS5wb3NpdGlvbldDLFxuICAgIGNhbWVyYS5kaXJlY3Rpb25XQyxcbiAgICBjYW1lcmEudXBXQ1xuICApO1xufVxuXG5mdW5jdGlvbiBnZXRQaWNrQ3VsbGluZ1ZvbHVtZShcbiAgc2NlbmUsXG4gIGRyYXdpbmdCdWZmZXJQb3NpdGlvbixcbiAgd2lkdGgsXG4gIGhlaWdodCxcbiAgdmlld3BvcnRcbikge1xuICB2YXIgZnJ1c3R1bSA9IHNjZW5lLmNhbWVyYS5mcnVzdHVtO1xuICBpZiAoXG4gICAgZnJ1c3R1bSBpbnN0YW5jZW9mIE9ydGhvZ3JhcGhpY0ZydXN0dW0gfHxcbiAgICBmcnVzdHVtIGluc3RhbmNlb2YgT3J0aG9ncmFwaGljT2ZmQ2VudGVyRnJ1c3R1bVxuICApIHtcbiAgICByZXR1cm4gZ2V0UGlja09ydGhvZ3JhcGhpY0N1bGxpbmdWb2x1bWUoXG4gICAgICBzY2VuZSxcbiAgICAgIGRyYXdpbmdCdWZmZXJQb3NpdGlvbixcbiAgICAgIHdpZHRoLFxuICAgICAgaGVpZ2h0LFxuICAgICAgdmlld3BvcnRcbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIGdldFBpY2tQZXJzcGVjdGl2ZUN1bGxpbmdWb2x1bWUoXG4gICAgc2NlbmUsXG4gICAgZHJhd2luZ0J1ZmZlclBvc2l0aW9uLFxuICAgIHdpZHRoLFxuICAgIGhlaWdodCxcbiAgICB2aWV3cG9ydFxuICApO1xufVxuXG4vLyBwaWNrIHJlY3RhbmdsZSB3aWR0aCBhbmQgaGVpZ2h0LCBhc3N1bWVkIG9kZFxudmFyIHNjcmF0Y2hSZWN0YW5nbGVXaWR0aCA9IDMuMDtcbnZhciBzY3JhdGNoUmVjdGFuZ2xlSGVpZ2h0ID0gMy4wO1xudmFyIHNjcmF0Y2hSZWN0YW5nbGUgPSBuZXcgQm91bmRpbmdSZWN0YW5nbGUoXG4gIDAuMCxcbiAgMC4wLFxuICBzY3JhdGNoUmVjdGFuZ2xlV2lkdGgsXG4gIHNjcmF0Y2hSZWN0YW5nbGVIZWlnaHRcbik7XG52YXIgc2NyYXRjaFBvc2l0aW9uID0gbmV3IENhcnRlc2lhbjIoKTtcbnZhciBzY3JhdGNoQ29sb3JaZXJvID0gbmV3IENvbG9yKDAuMCwgMC4wLCAwLjAsIDAuMCk7XG5cblBpY2tpbmcucHJvdG90eXBlLnBpY2sgPSBmdW5jdGlvbiAoc2NlbmUsIHdpbmRvd1Bvc2l0aW9uLCB3aWR0aCwgaGVpZ2h0KSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIGlmICghZGVmaW5lZCh3aW5kb3dQb3NpdGlvbikpIHtcbiAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXCJ3aW5kb3dQb3NpdGlvbiBpcyB1bmRlZmluZWQuXCIpO1xuICB9XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIHNjcmF0Y2hSZWN0YW5nbGVXaWR0aCA9IGRlZmF1bHRWYWx1ZSh3aWR0aCwgMy4wKTtcbiAgc2NyYXRjaFJlY3RhbmdsZUhlaWdodCA9IGRlZmF1bHRWYWx1ZShoZWlnaHQsIHNjcmF0Y2hSZWN0YW5nbGVXaWR0aCk7XG5cbiAgdmFyIGNvbnRleHQgPSBzY2VuZS5jb250ZXh0O1xuICB2YXIgdXMgPSBjb250ZXh0LnVuaWZvcm1TdGF0ZTtcbiAgdmFyIGZyYW1lU3RhdGUgPSBzY2VuZS5mcmFtZVN0YXRlO1xuXG4gIHZhciB2aWV3ID0gc2NlbmUuZGVmYXVsdFZpZXc7XG4gIHNjZW5lLnZpZXcgPSB2aWV3O1xuXG4gIHZhciB2aWV3cG9ydCA9IHZpZXcudmlld3BvcnQ7XG4gIHZpZXdwb3J0LnggPSAwO1xuICB2aWV3cG9ydC55ID0gMDtcbiAgdmlld3BvcnQud2lkdGggPSBjb250ZXh0LmRyYXdpbmdCdWZmZXJXaWR0aDtcbiAgdmlld3BvcnQuaGVpZ2h0ID0gY29udGV4dC5kcmF3aW5nQnVmZmVySGVpZ2h0O1xuXG4gIHZhciBwYXNzU3RhdGUgPSB2aWV3LnBhc3NTdGF0ZTtcbiAgcGFzc1N0YXRlLnZpZXdwb3J0ID0gQm91bmRpbmdSZWN0YW5nbGUuY2xvbmUodmlld3BvcnQsIHBhc3NTdGF0ZS52aWV3cG9ydCk7XG5cbiAgdmFyIGRyYXdpbmdCdWZmZXJQb3NpdGlvbiA9IFNjZW5lVHJhbnNmb3Jtcy50cmFuc2Zvcm1XaW5kb3dUb0RyYXdpbmdCdWZmZXIoXG4gICAgc2NlbmUsXG4gICAgd2luZG93UG9zaXRpb24sXG4gICAgc2NyYXRjaFBvc2l0aW9uXG4gICk7XG5cbiAgc2NlbmUuam9iU2NoZWR1bGVyLmRpc2FibGVUaGlzRnJhbWUoKTtcblxuICBzY2VuZS51cGRhdGVGcmFtZVN0YXRlKCk7XG4gIGZyYW1lU3RhdGUuY3VsbGluZ1ZvbHVtZSA9IGdldFBpY2tDdWxsaW5nVm9sdW1lKFxuICAgIHNjZW5lLFxuICAgIGRyYXdpbmdCdWZmZXJQb3NpdGlvbixcbiAgICBzY3JhdGNoUmVjdGFuZ2xlV2lkdGgsXG4gICAgc2NyYXRjaFJlY3RhbmdsZUhlaWdodCxcbiAgICB2aWV3cG9ydFxuICApO1xuICBmcmFtZVN0YXRlLmludmVydENsYXNzaWZpY2F0aW9uID0gZmFsc2U7XG4gIGZyYW1lU3RhdGUucGFzc2VzLnBpY2sgPSB0cnVlO1xuICBmcmFtZVN0YXRlLnRpbGVzZXRQYXNzU3RhdGUgPSBwaWNrVGlsZXNldFBhc3NTdGF0ZTtcblxuICB1cy51cGRhdGUoZnJhbWVTdGF0ZSk7XG5cbiAgc2NlbmUudXBkYXRlRW52aXJvbm1lbnQoKTtcblxuICBzY3JhdGNoUmVjdGFuZ2xlLnggPVxuICAgIGRyYXdpbmdCdWZmZXJQb3NpdGlvbi54IC0gKHNjcmF0Y2hSZWN0YW5nbGVXaWR0aCAtIDEuMCkgKiAwLjU7XG4gIHNjcmF0Y2hSZWN0YW5nbGUueSA9XG4gICAgc2NlbmUuZHJhd2luZ0J1ZmZlckhlaWdodCAtXG4gICAgZHJhd2luZ0J1ZmZlclBvc2l0aW9uLnkgLVxuICAgIChzY3JhdGNoUmVjdGFuZ2xlSGVpZ2h0IC0gMS4wKSAqIDAuNTtcbiAgc2NyYXRjaFJlY3RhbmdsZS53aWR0aCA9IHNjcmF0Y2hSZWN0YW5nbGVXaWR0aDtcbiAgc2NyYXRjaFJlY3RhbmdsZS5oZWlnaHQgPSBzY3JhdGNoUmVjdGFuZ2xlSGVpZ2h0O1xuICBwYXNzU3RhdGUgPSB2aWV3LnBpY2tGcmFtZWJ1ZmZlci5iZWdpbihzY3JhdGNoUmVjdGFuZ2xlLCB2aWV3LnZpZXdwb3J0KTtcblxuICBzY2VuZS51cGRhdGVBbmRFeGVjdXRlQ29tbWFuZHMocGFzc1N0YXRlLCBzY3JhdGNoQ29sb3JaZXJvKTtcbiAgc2NlbmUucmVzb2x2ZUZyYW1lYnVmZmVycyhwYXNzU3RhdGUpO1xuXG4gIHZhciBvYmplY3QgPSB2aWV3LnBpY2tGcmFtZWJ1ZmZlci5lbmQoc2NyYXRjaFJlY3RhbmdsZSk7XG4gIGNvbnRleHQuZW5kRnJhbWUoKTtcbiAgcmV0dXJuIG9iamVjdDtcbn07XG5cbmZ1bmN0aW9uIHJlbmRlclRyYW5zbHVjZW50RGVwdGhGb3JQaWNrKHNjZW5lLCBkcmF3aW5nQnVmZmVyUG9zaXRpb24pIHtcbiAgLy8gUEVSRk9STUFOQ0VfSURFQTogcmVuZGVyIHRyYW5zbHVjZW50IG9ubHkgYW5kIG1lcmdlIHdpdGggdGhlIHByZXZpb3VzIGZyYW1lXG4gIHZhciBjb250ZXh0ID0gc2NlbmUuY29udGV4dDtcbiAgdmFyIGZyYW1lU3RhdGUgPSBzY2VuZS5mcmFtZVN0YXRlO1xuICB2YXIgZW52aXJvbm1lbnRTdGF0ZSA9IHNjZW5lLmVudmlyb25tZW50U3RhdGU7XG5cbiAgdmFyIHZpZXcgPSBzY2VuZS5kZWZhdWx0VmlldztcbiAgc2NlbmUudmlldyA9IHZpZXc7XG5cbiAgdmFyIHZpZXdwb3J0ID0gdmlldy52aWV3cG9ydDtcbiAgdmlld3BvcnQueCA9IDA7XG4gIHZpZXdwb3J0LnkgPSAwO1xuICB2aWV3cG9ydC53aWR0aCA9IGNvbnRleHQuZHJhd2luZ0J1ZmZlcldpZHRoO1xuICB2aWV3cG9ydC5oZWlnaHQgPSBjb250ZXh0LmRyYXdpbmdCdWZmZXJIZWlnaHQ7XG5cbiAgdmFyIHBhc3NTdGF0ZSA9IHZpZXcucGFzc1N0YXRlO1xuICBwYXNzU3RhdGUudmlld3BvcnQgPSBCb3VuZGluZ1JlY3RhbmdsZS5jbG9uZSh2aWV3cG9ydCwgcGFzc1N0YXRlLnZpZXdwb3J0KTtcblxuICBzY2VuZS5jbGVhclBhc3NlcyhmcmFtZVN0YXRlLnBhc3Nlcyk7XG4gIGZyYW1lU3RhdGUucGFzc2VzLnBpY2sgPSB0cnVlO1xuICBmcmFtZVN0YXRlLnBhc3Nlcy5kZXB0aCA9IHRydWU7XG4gIGZyYW1lU3RhdGUuY3VsbGluZ1ZvbHVtZSA9IGdldFBpY2tDdWxsaW5nVm9sdW1lKFxuICAgIHNjZW5lLFxuICAgIGRyYXdpbmdCdWZmZXJQb3NpdGlvbixcbiAgICAxLFxuICAgIDEsXG4gICAgdmlld3BvcnRcbiAgKTtcbiAgZnJhbWVTdGF0ZS50aWxlc2V0UGFzc1N0YXRlID0gcGlja1RpbGVzZXRQYXNzU3RhdGU7XG5cbiAgc2NlbmUudXBkYXRlRW52aXJvbm1lbnQoKTtcbiAgZW52aXJvbm1lbnRTdGF0ZS5yZW5kZXJUcmFuc2x1Y2VudERlcHRoRm9yUGljayA9IHRydWU7XG4gIHBhc3NTdGF0ZSA9IHZpZXcucGlja0RlcHRoRnJhbWVidWZmZXIudXBkYXRlKFxuICAgIGNvbnRleHQsXG4gICAgZHJhd2luZ0J1ZmZlclBvc2l0aW9uLFxuICAgIHZpZXdwb3J0XG4gICk7XG5cbiAgc2NlbmUudXBkYXRlQW5kRXhlY3V0ZUNvbW1hbmRzKHBhc3NTdGF0ZSwgc2NyYXRjaENvbG9yWmVybyk7XG4gIHNjZW5lLnJlc29sdmVGcmFtZWJ1ZmZlcnMocGFzc1N0YXRlKTtcblxuICBjb250ZXh0LmVuZEZyYW1lKCk7XG59XG5cbnZhciBzY3JhdGNoUGVyc3BlY3RpdmVGcnVzdHVtID0gbmV3IFBlcnNwZWN0aXZlRnJ1c3R1bSgpO1xudmFyIHNjcmF0Y2hQZXJzcGVjdGl2ZU9mZkNlbnRlckZydXN0dW0gPSBuZXcgUGVyc3BlY3RpdmVPZmZDZW50ZXJGcnVzdHVtKCk7XG52YXIgc2NyYXRjaE9ydGhvZ3JhcGhpY0ZydXN0dW0gPSBuZXcgT3J0aG9ncmFwaGljRnJ1c3R1bSgpO1xudmFyIHNjcmF0Y2hPcnRob2dyYXBoaWNPZmZDZW50ZXJGcnVzdHVtID0gbmV3IE9ydGhvZ3JhcGhpY09mZkNlbnRlckZydXN0dW0oKTtcblxuUGlja2luZy5wcm90b3R5cGUucGlja1Bvc2l0aW9uV29ybGRDb29yZGluYXRlcyA9IGZ1bmN0aW9uIChcbiAgc2NlbmUsXG4gIHdpbmRvd1Bvc2l0aW9uLFxuICByZXN1bHRcbikge1xuICBpZiAoIXNjZW5lLnVzZURlcHRoUGlja2luZykge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBpZiAoIWRlZmluZWQod2luZG93UG9zaXRpb24pKSB7XG4gICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFwid2luZG93UG9zaXRpb24gaXMgdW5kZWZpbmVkLlwiKTtcbiAgfVxuICBpZiAoIXNjZW5lLmNvbnRleHQuZGVwdGhUZXh0dXJlKSB7XG4gICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFxuICAgICAgXCJQaWNraW5nIGZyb20gdGhlIGRlcHRoIGJ1ZmZlciBpcyBub3Qgc3VwcG9ydGVkLiBDaGVjayBwaWNrUG9zaXRpb25TdXBwb3J0ZWQuXCJcbiAgICApO1xuICB9XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIHZhciBjYWNoZUtleSA9IHdpbmRvd1Bvc2l0aW9uLnRvU3RyaW5nKCk7XG5cbiAgaWYgKHRoaXMuX3BpY2tQb3NpdGlvbkNhY2hlRGlydHkpIHtcbiAgICB0aGlzLl9waWNrUG9zaXRpb25DYWNoZSA9IHt9O1xuICAgIHRoaXMuX3BpY2tQb3NpdGlvbkNhY2hlRGlydHkgPSBmYWxzZTtcbiAgfSBlbHNlIGlmICh0aGlzLl9waWNrUG9zaXRpb25DYWNoZS5oYXNPd25Qcm9wZXJ0eShjYWNoZUtleSkpIHtcbiAgICByZXR1cm4gQ2FydGVzaWFuMy5jbG9uZSh0aGlzLl9waWNrUG9zaXRpb25DYWNoZVtjYWNoZUtleV0sIHJlc3VsdCk7XG4gIH1cblxuICB2YXIgZnJhbWVTdGF0ZSA9IHNjZW5lLmZyYW1lU3RhdGU7XG4gIHZhciBjb250ZXh0ID0gc2NlbmUuY29udGV4dDtcbiAgdmFyIHVuaWZvcm1TdGF0ZSA9IGNvbnRleHQudW5pZm9ybVN0YXRlO1xuXG4gIHZhciB2aWV3ID0gc2NlbmUuZGVmYXVsdFZpZXc7XG4gIHNjZW5lLnZpZXcgPSB2aWV3O1xuXG4gIHZhciBkcmF3aW5nQnVmZmVyUG9zaXRpb24gPSBTY2VuZVRyYW5zZm9ybXMudHJhbnNmb3JtV2luZG93VG9EcmF3aW5nQnVmZmVyKFxuICAgIHNjZW5lLFxuICAgIHdpbmRvd1Bvc2l0aW9uLFxuICAgIHNjcmF0Y2hQb3NpdGlvblxuICApO1xuICBpZiAoc2NlbmUucGlja1RyYW5zbHVjZW50RGVwdGgpIHtcbiAgICByZW5kZXJUcmFuc2x1Y2VudERlcHRoRm9yUGljayhzY2VuZSwgZHJhd2luZ0J1ZmZlclBvc2l0aW9uKTtcbiAgfSBlbHNlIHtcbiAgICBzY2VuZS51cGRhdGVGcmFtZVN0YXRlKCk7XG4gICAgdW5pZm9ybVN0YXRlLnVwZGF0ZShmcmFtZVN0YXRlKTtcbiAgICBzY2VuZS51cGRhdGVFbnZpcm9ubWVudCgpO1xuICB9XG4gIGRyYXdpbmdCdWZmZXJQb3NpdGlvbi55ID0gc2NlbmUuZHJhd2luZ0J1ZmZlckhlaWdodCAtIGRyYXdpbmdCdWZmZXJQb3NpdGlvbi55O1xuXG4gIHZhciBjYW1lcmEgPSBzY2VuZS5jYW1lcmE7XG5cbiAgLy8gQ3JlYXRlIGEgd29ya2luZyBmcnVzdHVtIGZyb20gdGhlIG9yaWdpbmFsIGNhbWVyYSBmcnVzdHVtLlxuICB2YXIgZnJ1c3R1bTtcbiAgaWYgKGRlZmluZWQoY2FtZXJhLmZydXN0dW0uZm92KSkge1xuICAgIGZydXN0dW0gPSBjYW1lcmEuZnJ1c3R1bS5jbG9uZShzY3JhdGNoUGVyc3BlY3RpdmVGcnVzdHVtKTtcbiAgfSBlbHNlIGlmIChkZWZpbmVkKGNhbWVyYS5mcnVzdHVtLmluZmluaXRlUHJvamVjdGlvbk1hdHJpeCkpIHtcbiAgICBmcnVzdHVtID0gY2FtZXJhLmZydXN0dW0uY2xvbmUoc2NyYXRjaFBlcnNwZWN0aXZlT2ZmQ2VudGVyRnJ1c3R1bSk7XG4gIH0gZWxzZSBpZiAoZGVmaW5lZChjYW1lcmEuZnJ1c3R1bS53aWR0aCkpIHtcbiAgICBmcnVzdHVtID0gY2FtZXJhLmZydXN0dW0uY2xvbmUoc2NyYXRjaE9ydGhvZ3JhcGhpY0ZydXN0dW0pO1xuICB9IGVsc2Uge1xuICAgIGZydXN0dW0gPSBjYW1lcmEuZnJ1c3R1bS5jbG9uZShzY3JhdGNoT3J0aG9ncmFwaGljT2ZmQ2VudGVyRnJ1c3R1bSk7XG4gIH1cblxuICB2YXIgZnJ1c3R1bUNvbW1hbmRzTGlzdCA9IHZpZXcuZnJ1c3R1bUNvbW1hbmRzTGlzdDtcbiAgdmFyIG51bUZydXN0dW1zID0gZnJ1c3R1bUNvbW1hbmRzTGlzdC5sZW5ndGg7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtRnJ1c3R1bXM7ICsraSkge1xuICAgIHZhciBwaWNrRGVwdGggPSB0aGlzLmdldFBpY2tEZXB0aChzY2VuZSwgaSk7XG4gICAgdmFyIGRlcHRoID0gcGlja0RlcHRoLmdldERlcHRoKFxuICAgICAgY29udGV4dCxcbiAgICAgIGRyYXdpbmdCdWZmZXJQb3NpdGlvbi54LFxuICAgICAgZHJhd2luZ0J1ZmZlclBvc2l0aW9uLnlcbiAgICApO1xuICAgIGlmICghZGVmaW5lZChkZXB0aCkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoZGVwdGggPiAwLjAgJiYgZGVwdGggPCAxLjApIHtcbiAgICAgIHZhciByZW5kZXJlZEZydXN0dW0gPSBmcnVzdHVtQ29tbWFuZHNMaXN0W2ldO1xuICAgICAgdmFyIGhlaWdodDJEO1xuICAgICAgaWYgKHNjZW5lLm1vZGUgPT09IFNjZW5lTW9kZS5TQ0VORTJEKSB7XG4gICAgICAgIGhlaWdodDJEID0gY2FtZXJhLnBvc2l0aW9uLno7XG4gICAgICAgIGNhbWVyYS5wb3NpdGlvbi56ID0gaGVpZ2h0MkQgLSByZW5kZXJlZEZydXN0dW0ubmVhciArIDEuMDtcbiAgICAgICAgZnJ1c3R1bS5mYXIgPSBNYXRoLm1heCgxLjAsIHJlbmRlcmVkRnJ1c3R1bS5mYXIgLSByZW5kZXJlZEZydXN0dW0ubmVhcik7XG4gICAgICAgIGZydXN0dW0ubmVhciA9IDEuMDtcbiAgICAgICAgdW5pZm9ybVN0YXRlLnVwZGF0ZShmcmFtZVN0YXRlKTtcbiAgICAgICAgdW5pZm9ybVN0YXRlLnVwZGF0ZUZydXN0dW0oZnJ1c3R1bSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmcnVzdHVtLm5lYXIgPVxuICAgICAgICAgIHJlbmRlcmVkRnJ1c3R1bS5uZWFyICpcbiAgICAgICAgICAoaSAhPT0gMCA/IHNjZW5lLm9wYXF1ZUZydXN0dW1OZWFyT2Zmc2V0IDogMS4wKTtcbiAgICAgICAgZnJ1c3R1bS5mYXIgPSByZW5kZXJlZEZydXN0dW0uZmFyO1xuICAgICAgICB1bmlmb3JtU3RhdGUudXBkYXRlRnJ1c3R1bShmcnVzdHVtKTtcbiAgICAgIH1cblxuICAgICAgcmVzdWx0ID0gU2NlbmVUcmFuc2Zvcm1zLmRyYXdpbmdCdWZmZXJUb1dnczg0Q29vcmRpbmF0ZXMoXG4gICAgICAgIHNjZW5lLFxuICAgICAgICBkcmF3aW5nQnVmZmVyUG9zaXRpb24sXG4gICAgICAgIGRlcHRoLFxuICAgICAgICByZXN1bHRcbiAgICAgICk7XG5cbiAgICAgIGlmIChzY2VuZS5tb2RlID09PSBTY2VuZU1vZGUuU0NFTkUyRCkge1xuICAgICAgICBjYW1lcmEucG9zaXRpb24ueiA9IGhlaWdodDJEO1xuICAgICAgICB1bmlmb3JtU3RhdGUudXBkYXRlKGZyYW1lU3RhdGUpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9waWNrUG9zaXRpb25DYWNoZVtjYWNoZUtleV0gPSBDYXJ0ZXNpYW4zLmNsb25lKHJlc3VsdCk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgfVxuXG4gIHRoaXMuX3BpY2tQb3NpdGlvbkNhY2hlW2NhY2hlS2V5XSA9IHVuZGVmaW5lZDtcbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn07XG5cbnZhciBzY3JhdGNoUGlja1Bvc2l0aW9uQ2FydG9ncmFwaGljID0gbmV3IENhcnRvZ3JhcGhpYygpO1xuXG5QaWNraW5nLnByb3RvdHlwZS5waWNrUG9zaXRpb24gPSBmdW5jdGlvbiAoc2NlbmUsIHdpbmRvd1Bvc2l0aW9uLCByZXN1bHQpIHtcbiAgcmVzdWx0ID0gdGhpcy5waWNrUG9zaXRpb25Xb3JsZENvb3JkaW5hdGVzKHNjZW5lLCB3aW5kb3dQb3NpdGlvbiwgcmVzdWx0KTtcbiAgaWYgKGRlZmluZWQocmVzdWx0KSAmJiBzY2VuZS5tb2RlICE9PSBTY2VuZU1vZGUuU0NFTkUzRCkge1xuICAgIENhcnRlc2lhbjMuZnJvbUVsZW1lbnRzKHJlc3VsdC55LCByZXN1bHQueiwgcmVzdWx0LngsIHJlc3VsdCk7XG5cbiAgICB2YXIgcHJvamVjdGlvbiA9IHNjZW5lLm1hcFByb2plY3Rpb247XG4gICAgdmFyIGVsbGlwc29pZCA9IHByb2plY3Rpb24uZWxsaXBzb2lkO1xuXG4gICAgdmFyIGNhcnQgPSBwcm9qZWN0aW9uLnVucHJvamVjdChyZXN1bHQsIHNjcmF0Y2hQaWNrUG9zaXRpb25DYXJ0b2dyYXBoaWMpO1xuICAgIGVsbGlwc29pZC5jYXJ0b2dyYXBoaWNUb0NhcnRlc2lhbihjYXJ0LCByZXN1bHQpO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbmZ1bmN0aW9uIGRyaWxsUGljayhsaW1pdCwgcGlja0NhbGxiYWNrKSB7XG4gIC8vIFBFUkZPUk1BTkNFX0lERUE6IFRoaXMgZnVuY3Rpb24gY2FsbHMgZWFjaCBwcmltaXRpdmUncyB1cGRhdGUgZm9yIGVhY2ggcGFzcy4gSW5zdGVhZFxuICAvLyB3ZSBjb3VsZCB1cGRhdGUgdGhlIHByaW1pdGl2ZSBvbmNlLCBhbmQgdGhlbiBqdXN0IGV4ZWN1dGUgdGhlaXIgY29tbWFuZHMgZm9yIGVhY2ggcGFzcyxcbiAgLy8gYW5kIGN1bGwgY29tbWFuZHMgZm9yIHBpY2tlZCBwcmltaXRpdmVzLiAgZS5nLiwgYmFzZSBvbiB0aGUgY29tbWFuZCdzIG93bmVyLlxuICB2YXIgaTtcbiAgdmFyIGF0dHJpYnV0ZXM7XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgdmFyIHBpY2tlZFByaW1pdGl2ZXMgPSBbXTtcbiAgdmFyIHBpY2tlZEF0dHJpYnV0ZXMgPSBbXTtcbiAgdmFyIHBpY2tlZEZlYXR1cmVzID0gW107XG4gIGlmICghZGVmaW5lZChsaW1pdCkpIHtcbiAgICBsaW1pdCA9IE51bWJlci5NQVhfVkFMVUU7XG4gIH1cblxuICB2YXIgcGlja2VkUmVzdWx0ID0gcGlja0NhbGxiYWNrKCk7XG4gIHdoaWxlIChkZWZpbmVkKHBpY2tlZFJlc3VsdCkpIHtcbiAgICB2YXIgb2JqZWN0ID0gcGlja2VkUmVzdWx0Lm9iamVjdDtcbiAgICB2YXIgcG9zaXRpb24gPSBwaWNrZWRSZXN1bHQucG9zaXRpb247XG4gICAgdmFyIGV4Y2x1ZGUgPSBwaWNrZWRSZXN1bHQuZXhjbHVkZTtcblxuICAgIGlmIChkZWZpbmVkKHBvc2l0aW9uKSAmJiAhZGVmaW5lZChvYmplY3QpKSB7XG4gICAgICByZXN1bHQucHVzaChwaWNrZWRSZXN1bHQpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgaWYgKCFkZWZpbmVkKG9iamVjdCkgfHwgIWRlZmluZWQob2JqZWN0LnByaW1pdGl2ZSkpIHtcbiAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGlmICghZXhjbHVkZSkge1xuICAgICAgcmVzdWx0LnB1c2gocGlja2VkUmVzdWx0KTtcbiAgICAgIGlmICgwID49IC0tbGltaXQpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHByaW1pdGl2ZSA9IG9iamVjdC5wcmltaXRpdmU7XG4gICAgdmFyIGhhc1Nob3dBdHRyaWJ1dGUgPSBmYWxzZTtcblxuICAgIC8vIElmIHRoZSBwaWNrZWQgb2JqZWN0IGhhcyBhIHNob3cgYXR0cmlidXRlLCB1c2UgaXQuXG4gICAgaWYgKHR5cGVvZiBwcmltaXRpdmUuZ2V0R2VvbWV0cnlJbnN0YW5jZUF0dHJpYnV0ZXMgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgaWYgKGRlZmluZWQob2JqZWN0LmlkKSkge1xuICAgICAgICBhdHRyaWJ1dGVzID0gcHJpbWl0aXZlLmdldEdlb21ldHJ5SW5zdGFuY2VBdHRyaWJ1dGVzKG9iamVjdC5pZCk7XG4gICAgICAgIGlmIChkZWZpbmVkKGF0dHJpYnV0ZXMpICYmIGRlZmluZWQoYXR0cmlidXRlcy5zaG93KSkge1xuICAgICAgICAgIGhhc1Nob3dBdHRyaWJ1dGUgPSB0cnVlO1xuICAgICAgICAgIGF0dHJpYnV0ZXMuc2hvdyA9IFNob3dHZW9tZXRyeUluc3RhbmNlQXR0cmlidXRlLnRvVmFsdWUoXG4gICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgIGF0dHJpYnV0ZXMuc2hvd1xuICAgICAgICAgICk7XG4gICAgICAgICAgcGlja2VkQXR0cmlidXRlcy5wdXNoKGF0dHJpYnV0ZXMpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG9iamVjdCBpbnN0YW5jZW9mIENlc2l1bTNEVGlsZUZlYXR1cmUpIHtcbiAgICAgIGhhc1Nob3dBdHRyaWJ1dGUgPSB0cnVlO1xuICAgICAgb2JqZWN0LnNob3cgPSBmYWxzZTtcbiAgICAgIHBpY2tlZEZlYXR1cmVzLnB1c2gob2JqZWN0KTtcbiAgICB9XG5cbiAgICAvLyBPdGhlcndpc2UsIGhpZGUgdGhlIGVudGlyZSBwcmltaXRpdmVcbiAgICBpZiAoIWhhc1Nob3dBdHRyaWJ1dGUpIHtcbiAgICAgIHByaW1pdGl2ZS5zaG93ID0gZmFsc2U7XG4gICAgICBwaWNrZWRQcmltaXRpdmVzLnB1c2gocHJpbWl0aXZlKTtcbiAgICB9XG5cbiAgICBwaWNrZWRSZXN1bHQgPSBwaWNrQ2FsbGJhY2soKTtcbiAgfVxuXG4gIC8vIFVuaGlkZSBldmVyeXRoaW5nIHdlIGhpZCB3aGlsZSBkcmlsbCBwaWNraW5nXG4gIGZvciAoaSA9IDA7IGkgPCBwaWNrZWRQcmltaXRpdmVzLmxlbmd0aDsgKytpKSB7XG4gICAgcGlja2VkUHJpbWl0aXZlc1tpXS5zaG93ID0gdHJ1ZTtcbiAgfVxuXG4gIGZvciAoaSA9IDA7IGkgPCBwaWNrZWRBdHRyaWJ1dGVzLmxlbmd0aDsgKytpKSB7XG4gICAgYXR0cmlidXRlcyA9IHBpY2tlZEF0dHJpYnV0ZXNbaV07XG4gICAgYXR0cmlidXRlcy5zaG93ID0gU2hvd0dlb21ldHJ5SW5zdGFuY2VBdHRyaWJ1dGUudG9WYWx1ZShcbiAgICAgIHRydWUsXG4gICAgICBhdHRyaWJ1dGVzLnNob3dcbiAgICApO1xuICB9XG5cbiAgZm9yIChpID0gMDsgaSA8IHBpY2tlZEZlYXR1cmVzLmxlbmd0aDsgKytpKSB7XG4gICAgcGlja2VkRmVhdHVyZXNbaV0uc2hvdyA9IHRydWU7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5QaWNraW5nLnByb3RvdHlwZS5kcmlsbFBpY2sgPSBmdW5jdGlvbiAoXG4gIHNjZW5lLFxuICB3aW5kb3dQb3NpdGlvbixcbiAgbGltaXQsXG4gIHdpZHRoLFxuICBoZWlnaHRcbikge1xuICB2YXIgdGhhdCA9IHRoaXM7XG4gIHZhciBwaWNrQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9iamVjdCA9IHRoYXQucGljayhzY2VuZSwgd2luZG93UG9zaXRpb24sIHdpZHRoLCBoZWlnaHQpO1xuICAgIGlmIChkZWZpbmVkKG9iamVjdCkpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG9iamVjdDogb2JqZWN0LFxuICAgICAgICBwb3NpdGlvbjogdW5kZWZpbmVkLFxuICAgICAgICBleGNsdWRlOiBmYWxzZSxcbiAgICAgIH07XG4gICAgfVxuICB9O1xuICB2YXIgb2JqZWN0cyA9IGRyaWxsUGljayhsaW1pdCwgcGlja0NhbGxiYWNrKTtcbiAgcmV0dXJuIG9iamVjdHMubWFwKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQub2JqZWN0O1xuICB9KTtcbn07XG5cbnZhciBzY3JhdGNoUmlnaHQgPSBuZXcgQ2FydGVzaWFuMygpO1xudmFyIHNjcmF0Y2hVcCA9IG5ldyBDYXJ0ZXNpYW4zKCk7XG5cbmZ1bmN0aW9uIE1vc3REZXRhaWxlZFJheVBpY2socmF5LCB3aWR0aCwgdGlsZXNldHMpIHtcbiAgdGhpcy5yYXkgPSByYXk7XG4gIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgdGhpcy50aWxlc2V0cyA9IHRpbGVzZXRzO1xuICB0aGlzLnJlYWR5ID0gZmFsc2U7XG4gIHRoaXMuZGVmZXJyZWQgPSB3aGVuLmRlZmVyKCk7XG4gIHRoaXMucHJvbWlzZSA9IHRoaXMuZGVmZXJyZWQucHJvbWlzZTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlT2Zmc2NyZWVuQ2FtZXJhRnJvbVJheShwaWNraW5nLCByYXksIHdpZHRoLCBjYW1lcmEpIHtcbiAgdmFyIGRpcmVjdGlvbiA9IHJheS5kaXJlY3Rpb247XG4gIHZhciBvcnRob2dvbmFsQXhpcyA9IENhcnRlc2lhbjMubW9zdE9ydGhvZ29uYWxBeGlzKGRpcmVjdGlvbiwgc2NyYXRjaFJpZ2h0KTtcbiAgdmFyIHJpZ2h0ID0gQ2FydGVzaWFuMy5jcm9zcyhkaXJlY3Rpb24sIG9ydGhvZ29uYWxBeGlzLCBzY3JhdGNoUmlnaHQpO1xuICB2YXIgdXAgPSBDYXJ0ZXNpYW4zLmNyb3NzKGRpcmVjdGlvbiwgcmlnaHQsIHNjcmF0Y2hVcCk7XG5cbiAgY2FtZXJhLnBvc2l0aW9uID0gcmF5Lm9yaWdpbjtcbiAgY2FtZXJhLmRpcmVjdGlvbiA9IGRpcmVjdGlvbjtcbiAgY2FtZXJhLnVwID0gdXA7XG4gIGNhbWVyYS5yaWdodCA9IHJpZ2h0O1xuXG4gIGNhbWVyYS5mcnVzdHVtLndpZHRoID0gZGVmYXVsdFZhbHVlKHdpZHRoLCBvZmZzY3JlZW5EZWZhdWx0V2lkdGgpO1xuICByZXR1cm4gY2FtZXJhLmZydXN0dW0uY29tcHV0ZUN1bGxpbmdWb2x1bWUoXG4gICAgY2FtZXJhLnBvc2l0aW9uV0MsXG4gICAgY2FtZXJhLmRpcmVjdGlvbldDLFxuICAgIGNhbWVyYS51cFdDXG4gICk7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZU1vc3REZXRhaWxlZFJheVBpY2socGlja2luZywgc2NlbmUsIHJheVBpY2spIHtcbiAgdmFyIGZyYW1lU3RhdGUgPSBzY2VuZS5mcmFtZVN0YXRlO1xuXG4gIHZhciByYXkgPSByYXlQaWNrLnJheTtcbiAgdmFyIHdpZHRoID0gcmF5UGljay53aWR0aDtcbiAgdmFyIHRpbGVzZXRzID0gcmF5UGljay50aWxlc2V0cztcblxuICB2YXIgY2FtZXJhID0gcGlja2luZy5fcGlja09mZnNjcmVlblZpZXcuY2FtZXJhO1xuICB2YXIgY3VsbGluZ1ZvbHVtZSA9IHVwZGF0ZU9mZnNjcmVlbkNhbWVyYUZyb21SYXkocGlja2luZywgcmF5LCB3aWR0aCwgY2FtZXJhKTtcblxuICB2YXIgdGlsZXNldFBhc3NTdGF0ZSA9IG1vc3REZXRhaWxlZFByZWxvYWRUaWxlc2V0UGFzc1N0YXRlO1xuICB0aWxlc2V0UGFzc1N0YXRlLmNhbWVyYSA9IGNhbWVyYTtcbiAgdGlsZXNldFBhc3NTdGF0ZS5jdWxsaW5nVm9sdW1lID0gY3VsbGluZ1ZvbHVtZTtcblxuICB2YXIgcmVhZHkgPSB0cnVlO1xuICB2YXIgdGlsZXNldHNMZW5ndGggPSB0aWxlc2V0cy5sZW5ndGg7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdGlsZXNldHNMZW5ndGg7ICsraSkge1xuICAgIHZhciB0aWxlc2V0ID0gdGlsZXNldHNbaV07XG4gICAgaWYgKHRpbGVzZXQuc2hvdyAmJiBzY2VuZS5wcmltaXRpdmVzLmNvbnRhaW5zKHRpbGVzZXQpKSB7XG4gICAgICAvLyBPbmx5IHVwZGF0ZSB0aWxlc2V0cyB0aGF0IGFyZSBzdGlsbCBjb250YWluZWQgaW4gdGhlIHNjZW5lJ3MgcHJpbWl0aXZlIGNvbGxlY3Rpb24gYW5kIGFyZSBzdGlsbCB2aXNpYmxlXG4gICAgICAvLyBVcGRhdGUgdGlsZXNldHMgY29udGludWFsbHkgdW50aWwgYWxsIHRpbGVzZXRzIGFyZSByZWFkeS4gVGhpcyB3YXkgdGlsZXMgYXJlIG5ldmVyIHJlbW92ZWQgZnJvbSB0aGUgY2FjaGUuXG4gICAgICB0aWxlc2V0LnVwZGF0ZUZvclBhc3MoZnJhbWVTdGF0ZSwgdGlsZXNldFBhc3NTdGF0ZSk7XG4gICAgICByZWFkeSA9IHJlYWR5ICYmIHRpbGVzZXRQYXNzU3RhdGUucmVhZHk7XG4gICAgfVxuICB9XG5cbiAgaWYgKHJlYWR5KSB7XG4gICAgcmF5UGljay5kZWZlcnJlZC5yZXNvbHZlKCk7XG4gIH1cblxuICByZXR1cm4gcmVhZHk7XG59XG5cblBpY2tpbmcucHJvdG90eXBlLnVwZGF0ZU1vc3REZXRhaWxlZFJheVBpY2tzID0gZnVuY3Rpb24gKHNjZW5lKSB7XG4gIC8vIE1vZGlmaWVzIGFycmF5IGR1cmluZyBpdGVyYXRpb25cbiAgdmFyIHJheVBpY2tzID0gdGhpcy5fbW9zdERldGFpbGVkUmF5UGlja3M7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcmF5UGlja3MubGVuZ3RoOyArK2kpIHtcbiAgICBpZiAodXBkYXRlTW9zdERldGFpbGVkUmF5UGljayh0aGlzLCBzY2VuZSwgcmF5UGlja3NbaV0pKSB7XG4gICAgICByYXlQaWNrcy5zcGxpY2UoaS0tLCAxKTtcbiAgICB9XG4gIH1cbn07XG5cbmZ1bmN0aW9uIGdldFRpbGVzZXRzKHByaW1pdGl2ZXMsIG9iamVjdHNUb0V4Y2x1ZGUsIHRpbGVzZXRzKSB7XG4gIHZhciBsZW5ndGggPSBwcmltaXRpdmVzLmxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIHZhciBwcmltaXRpdmUgPSBwcmltaXRpdmVzLmdldChpKTtcbiAgICBpZiAocHJpbWl0aXZlLnNob3cpIHtcbiAgICAgIGlmIChkZWZpbmVkKHByaW1pdGl2ZS5pc0Nlc2l1bTNEVGlsZXNldCkpIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICFkZWZpbmVkKG9iamVjdHNUb0V4Y2x1ZGUpIHx8XG4gICAgICAgICAgb2JqZWN0c1RvRXhjbHVkZS5pbmRleE9mKHByaW1pdGl2ZSkgPT09IC0xXG4gICAgICAgICkge1xuICAgICAgICAgIHRpbGVzZXRzLnB1c2gocHJpbWl0aXZlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChwcmltaXRpdmUgaW5zdGFuY2VvZiBQcmltaXRpdmVDb2xsZWN0aW9uKSB7XG4gICAgICAgIGdldFRpbGVzZXRzKHByaW1pdGl2ZSwgb2JqZWN0c1RvRXhjbHVkZSwgdGlsZXNldHMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBsYXVuY2hNb3N0RGV0YWlsZWRSYXlQaWNrKFxuICBwaWNraW5nLFxuICBzY2VuZSxcbiAgcmF5LFxuICBvYmplY3RzVG9FeGNsdWRlLFxuICB3aWR0aCxcbiAgY2FsbGJhY2tcbikge1xuICB2YXIgdGlsZXNldHMgPSBbXTtcbiAgZ2V0VGlsZXNldHMoc2NlbmUucHJpbWl0aXZlcywgb2JqZWN0c1RvRXhjbHVkZSwgdGlsZXNldHMpO1xuICBpZiAodGlsZXNldHMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIHdoZW4ucmVzb2x2ZShjYWxsYmFjaygpKTtcbiAgfVxuXG4gIHZhciByYXlQaWNrID0gbmV3IE1vc3REZXRhaWxlZFJheVBpY2socmF5LCB3aWR0aCwgdGlsZXNldHMpO1xuICBwaWNraW5nLl9tb3N0RGV0YWlsZWRSYXlQaWNrcy5wdXNoKHJheVBpY2spO1xuICByZXR1cm4gcmF5UGljay5wcm9taXNlLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBjYWxsYmFjaygpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gaXNFeGNsdWRlZChvYmplY3QsIG9iamVjdHNUb0V4Y2x1ZGUpIHtcbiAgaWYgKFxuICAgICFkZWZpbmVkKG9iamVjdCkgfHxcbiAgICAhZGVmaW5lZChvYmplY3RzVG9FeGNsdWRlKSB8fFxuICAgIG9iamVjdHNUb0V4Y2x1ZGUubGVuZ3RoID09PSAwXG4gICkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gKFxuICAgIG9iamVjdHNUb0V4Y2x1ZGUuaW5kZXhPZihvYmplY3QpID4gLTEgfHxcbiAgICBvYmplY3RzVG9FeGNsdWRlLmluZGV4T2Yob2JqZWN0LnByaW1pdGl2ZSkgPiAtMSB8fFxuICAgIG9iamVjdHNUb0V4Y2x1ZGUuaW5kZXhPZihvYmplY3QuaWQpID4gLTFcbiAgKTtcbn1cblxuZnVuY3Rpb24gZ2V0UmF5SW50ZXJzZWN0aW9uKFxuICBwaWNraW5nLFxuICBzY2VuZSxcbiAgcmF5LFxuICBvYmplY3RzVG9FeGNsdWRlLFxuICB3aWR0aCxcbiAgcmVxdWlyZVBvc2l0aW9uLFxuICBtb3N0RGV0YWlsZWRcbikge1xuICB2YXIgY29udGV4dCA9IHNjZW5lLmNvbnRleHQ7XG4gIHZhciB1bmlmb3JtU3RhdGUgPSBjb250ZXh0LnVuaWZvcm1TdGF0ZTtcbiAgdmFyIGZyYW1lU3RhdGUgPSBzY2VuZS5mcmFtZVN0YXRlO1xuXG4gIHZhciB2aWV3ID0gcGlja2luZy5fcGlja09mZnNjcmVlblZpZXc7XG4gIHNjZW5lLnZpZXcgPSB2aWV3O1xuXG4gIHVwZGF0ZU9mZnNjcmVlbkNhbWVyYUZyb21SYXkocGlja2luZywgcmF5LCB3aWR0aCwgdmlldy5jYW1lcmEpO1xuXG4gIHNjcmF0Y2hSZWN0YW5nbGUgPSBCb3VuZGluZ1JlY3RhbmdsZS5jbG9uZSh2aWV3LnZpZXdwb3J0LCBzY3JhdGNoUmVjdGFuZ2xlKTtcblxuICB2YXIgcGFzc1N0YXRlID0gdmlldy5waWNrRnJhbWVidWZmZXIuYmVnaW4oc2NyYXRjaFJlY3RhbmdsZSwgdmlldy52aWV3cG9ydCk7XG5cbiAgc2NlbmUuam9iU2NoZWR1bGVyLmRpc2FibGVUaGlzRnJhbWUoKTtcblxuICBzY2VuZS51cGRhdGVGcmFtZVN0YXRlKCk7XG4gIGZyYW1lU3RhdGUuaW52ZXJ0Q2xhc3NpZmljYXRpb24gPSBmYWxzZTtcbiAgZnJhbWVTdGF0ZS5wYXNzZXMucGljayA9IHRydWU7XG4gIGZyYW1lU3RhdGUucGFzc2VzLm9mZnNjcmVlbiA9IHRydWU7XG5cbiAgaWYgKG1vc3REZXRhaWxlZCkge1xuICAgIGZyYW1lU3RhdGUudGlsZXNldFBhc3NTdGF0ZSA9IG1vc3REZXRhaWxlZFBpY2tUaWxlc2V0UGFzc1N0YXRlO1xuICB9IGVsc2Uge1xuICAgIGZyYW1lU3RhdGUudGlsZXNldFBhc3NTdGF0ZSA9IHBpY2tUaWxlc2V0UGFzc1N0YXRlO1xuICB9XG5cbiAgdW5pZm9ybVN0YXRlLnVwZGF0ZShmcmFtZVN0YXRlKTtcblxuICBzY2VuZS51cGRhdGVFbnZpcm9ubWVudCgpO1xuICBzY2VuZS51cGRhdGVBbmRFeGVjdXRlQ29tbWFuZHMocGFzc1N0YXRlLCBzY3JhdGNoQ29sb3JaZXJvKTtcbiAgc2NlbmUucmVzb2x2ZUZyYW1lYnVmZmVycyhwYXNzU3RhdGUpO1xuXG4gIHZhciBwb3NpdGlvbjtcbiAgdmFyIG9iamVjdCA9IHZpZXcucGlja0ZyYW1lYnVmZmVyLmVuZChzY3JhdGNoUmVjdGFuZ2xlKTtcblxuICBpZiAoc2NlbmUuY29udGV4dC5kZXB0aFRleHR1cmUpIHtcbiAgICB2YXIgbnVtRnJ1c3R1bXMgPSB2aWV3LmZydXN0dW1Db21tYW5kc0xpc3QubGVuZ3RoO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtRnJ1c3R1bXM7ICsraSkge1xuICAgICAgdmFyIHBpY2tEZXB0aCA9IHBpY2tpbmcuZ2V0UGlja0RlcHRoKHNjZW5lLCBpKTtcbiAgICAgIHZhciBkZXB0aCA9IHBpY2tEZXB0aC5nZXREZXB0aChjb250ZXh0LCAwLCAwKTtcbiAgICAgIGlmICghZGVmaW5lZChkZXB0aCkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBpZiAoZGVwdGggPiAwLjAgJiYgZGVwdGggPCAxLjApIHtcbiAgICAgICAgdmFyIHJlbmRlcmVkRnJ1c3R1bSA9IHZpZXcuZnJ1c3R1bUNvbW1hbmRzTGlzdFtpXTtcbiAgICAgICAgdmFyIG5lYXIgPVxuICAgICAgICAgIHJlbmRlcmVkRnJ1c3R1bS5uZWFyICpcbiAgICAgICAgICAoaSAhPT0gMCA/IHNjZW5lLm9wYXF1ZUZydXN0dW1OZWFyT2Zmc2V0IDogMS4wKTtcbiAgICAgICAgdmFyIGZhciA9IHJlbmRlcmVkRnJ1c3R1bS5mYXI7XG4gICAgICAgIHZhciBkaXN0YW5jZSA9IG5lYXIgKyBkZXB0aCAqIChmYXIgLSBuZWFyKTtcbiAgICAgICAgcG9zaXRpb24gPSBSYXkuZ2V0UG9pbnQocmF5LCBkaXN0YW5jZSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHNjZW5lLnZpZXcgPSBzY2VuZS5kZWZhdWx0VmlldztcbiAgY29udGV4dC5lbmRGcmFtZSgpO1xuXG4gIGlmIChkZWZpbmVkKG9iamVjdCkgfHwgZGVmaW5lZChwb3NpdGlvbikpIHtcbiAgICByZXR1cm4ge1xuICAgICAgb2JqZWN0OiBvYmplY3QsXG4gICAgICBwb3NpdGlvbjogcG9zaXRpb24sXG4gICAgICBleGNsdWRlOlxuICAgICAgICAoIWRlZmluZWQocG9zaXRpb24pICYmIHJlcXVpcmVQb3NpdGlvbikgfHxcbiAgICAgICAgaXNFeGNsdWRlZChvYmplY3QsIG9iamVjdHNUb0V4Y2x1ZGUpLFxuICAgIH07XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0UmF5SW50ZXJzZWN0aW9ucyhcbiAgcGlja2luZyxcbiAgc2NlbmUsXG4gIHJheSxcbiAgbGltaXQsXG4gIG9iamVjdHNUb0V4Y2x1ZGUsXG4gIHdpZHRoLFxuICByZXF1aXJlUG9zaXRpb24sXG4gIG1vc3REZXRhaWxlZFxuKSB7XG4gIHZhciBwaWNrQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGdldFJheUludGVyc2VjdGlvbihcbiAgICAgIHBpY2tpbmcsXG4gICAgICBzY2VuZSxcbiAgICAgIHJheSxcbiAgICAgIG9iamVjdHNUb0V4Y2x1ZGUsXG4gICAgICB3aWR0aCxcbiAgICAgIHJlcXVpcmVQb3NpdGlvbixcbiAgICAgIG1vc3REZXRhaWxlZFxuICAgICk7XG4gIH07XG4gIHJldHVybiBkcmlsbFBpY2sobGltaXQsIHBpY2tDYWxsYmFjayk7XG59XG5cbmZ1bmN0aW9uIHBpY2tGcm9tUmF5KFxuICBwaWNraW5nLFxuICBzY2VuZSxcbiAgcmF5LFxuICBvYmplY3RzVG9FeGNsdWRlLFxuICB3aWR0aCxcbiAgcmVxdWlyZVBvc2l0aW9uLFxuICBtb3N0RGV0YWlsZWRcbikge1xuICB2YXIgcmVzdWx0cyA9IGdldFJheUludGVyc2VjdGlvbnMoXG4gICAgcGlja2luZyxcbiAgICBzY2VuZSxcbiAgICByYXksXG4gICAgMSxcbiAgICBvYmplY3RzVG9FeGNsdWRlLFxuICAgIHdpZHRoLFxuICAgIHJlcXVpcmVQb3NpdGlvbixcbiAgICBtb3N0RGV0YWlsZWRcbiAgKTtcbiAgaWYgKHJlc3VsdHMubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiByZXN1bHRzWzBdO1xuICB9XG59XG5cbmZ1bmN0aW9uIGRyaWxsUGlja0Zyb21SYXkoXG4gIHBpY2tpbmcsXG4gIHNjZW5lLFxuICByYXksXG4gIGxpbWl0LFxuICBvYmplY3RzVG9FeGNsdWRlLFxuICB3aWR0aCxcbiAgcmVxdWlyZVBvc2l0aW9uLFxuICBtb3N0RGV0YWlsZWRcbikge1xuICByZXR1cm4gZ2V0UmF5SW50ZXJzZWN0aW9ucyhcbiAgICBwaWNraW5nLFxuICAgIHNjZW5lLFxuICAgIHJheSxcbiAgICBsaW1pdCxcbiAgICBvYmplY3RzVG9FeGNsdWRlLFxuICAgIHdpZHRoLFxuICAgIHJlcXVpcmVQb3NpdGlvbixcbiAgICBtb3N0RGV0YWlsZWRcbiAgKTtcbn1cblxuZnVuY3Rpb24gZGVmZXJQcm9taXNlVW50aWxQb3N0UmVuZGVyKHNjZW5lLCBwcm9taXNlKSB7XG4gIC8vIFJlc29sdmUgcHJvbWlzZSBhZnRlciBzY2VuZSdzIHBvc3RSZW5kZXIgaW4gY2FzZSBlbnRpdGllcyBhcmUgY3JlYXRlZCB3aGVuIHRoZSBwcm9taXNlIHJlc29sdmVzLlxuICAvLyBFbnRpdGllcyBjYW4ndCBiZSBjcmVhdGVkIGJldHdlZW4gdmlld2VyLl9vblRpY2sgYW5kIHZpZXdlci5fcG9zdFJlbmRlci5cbiAgdmFyIGRlZmVycmVkID0gd2hlbi5kZWZlcigpO1xuICBwcm9taXNlXG4gICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgdmFyIHJlbW92ZUNhbGxiYWNrID0gc2NlbmUucG9zdFJlbmRlci5hZGRFdmVudExpc3RlbmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICByZW1vdmVDYWxsYmFjaygpO1xuICAgICAgfSk7XG4gICAgICBzY2VuZS5yZXF1ZXN0UmVuZGVyKCk7XG4gICAgfSlcbiAgICAub3RoZXJ3aXNlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgZGVmZXJyZWQucmVqZWN0KGVycm9yKTtcbiAgICB9KTtcbiAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG59XG5cblBpY2tpbmcucHJvdG90eXBlLnBpY2tGcm9tUmF5ID0gZnVuY3Rpb24gKHNjZW5lLCByYXksIG9iamVjdHNUb0V4Y2x1ZGUsIHdpZHRoKSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLmRlZmluZWQoXCJyYXlcIiwgcmF5KTtcbiAgaWYgKHNjZW5lLm1vZGUgIT09IFNjZW5lTW9kZS5TQ0VORTNEKSB7XG4gICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFxuICAgICAgXCJSYXkgaW50ZXJzZWN0aW9ucyBhcmUgb25seSBzdXBwb3J0ZWQgaW4gM0QgbW9kZS5cIlxuICAgICk7XG4gIH1cbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgcmV0dXJuIHBpY2tGcm9tUmF5KHRoaXMsIHNjZW5lLCByYXksIG9iamVjdHNUb0V4Y2x1ZGUsIHdpZHRoLCBmYWxzZSwgZmFsc2UpO1xufTtcblxuUGlja2luZy5wcm90b3R5cGUuZHJpbGxQaWNrRnJvbVJheSA9IGZ1bmN0aW9uIChcbiAgc2NlbmUsXG4gIHJheSxcbiAgbGltaXQsXG4gIG9iamVjdHNUb0V4Y2x1ZGUsXG4gIHdpZHRoXG4pIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2suZGVmaW5lZChcInJheVwiLCByYXkpO1xuICBpZiAoc2NlbmUubW9kZSAhPT0gU2NlbmVNb2RlLlNDRU5FM0QpIHtcbiAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgICBcIlJheSBpbnRlcnNlY3Rpb25zIGFyZSBvbmx5IHN1cHBvcnRlZCBpbiAzRCBtb2RlLlwiXG4gICAgKTtcbiAgfVxuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICByZXR1cm4gZHJpbGxQaWNrRnJvbVJheShcbiAgICB0aGlzLFxuICAgIHNjZW5lLFxuICAgIHJheSxcbiAgICBsaW1pdCxcbiAgICBvYmplY3RzVG9FeGNsdWRlLFxuICAgIHdpZHRoLFxuICAgIGZhbHNlLFxuICAgIGZhbHNlXG4gICk7XG59O1xuXG5QaWNraW5nLnByb3RvdHlwZS5waWNrRnJvbVJheU1vc3REZXRhaWxlZCA9IGZ1bmN0aW9uIChcbiAgc2NlbmUsXG4gIHJheSxcbiAgb2JqZWN0c1RvRXhjbHVkZSxcbiAgd2lkdGhcbikge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay5kZWZpbmVkKFwicmF5XCIsIHJheSk7XG4gIGlmIChzY2VuZS5tb2RlICE9PSBTY2VuZU1vZGUuU0NFTkUzRCkge1xuICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcbiAgICAgIFwiUmF5IGludGVyc2VjdGlvbnMgYXJlIG9ubHkgc3VwcG9ydGVkIGluIDNEIG1vZGUuXCJcbiAgICApO1xuICB9XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIHZhciB0aGF0ID0gdGhpcztcbiAgcmF5ID0gUmF5LmNsb25lKHJheSk7XG4gIG9iamVjdHNUb0V4Y2x1ZGUgPSBkZWZpbmVkKG9iamVjdHNUb0V4Y2x1ZGUpXG4gICAgPyBvYmplY3RzVG9FeGNsdWRlLnNsaWNlKClcbiAgICA6IG9iamVjdHNUb0V4Y2x1ZGU7XG4gIHJldHVybiBkZWZlclByb21pc2VVbnRpbFBvc3RSZW5kZXIoXG4gICAgc2NlbmUsXG4gICAgbGF1bmNoTW9zdERldGFpbGVkUmF5UGljayhcbiAgICAgIHRoYXQsXG4gICAgICBzY2VuZSxcbiAgICAgIHJheSxcbiAgICAgIG9iamVjdHNUb0V4Y2x1ZGUsXG4gICAgICB3aWR0aCxcbiAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHBpY2tGcm9tUmF5KFxuICAgICAgICAgIHRoYXQsXG4gICAgICAgICAgc2NlbmUsXG4gICAgICAgICAgcmF5LFxuICAgICAgICAgIG9iamVjdHNUb0V4Y2x1ZGUsXG4gICAgICAgICAgd2lkdGgsXG4gICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgdHJ1ZVxuICAgICAgICApO1xuICAgICAgfVxuICAgIClcbiAgKTtcbn07XG5cblBpY2tpbmcucHJvdG90eXBlLmRyaWxsUGlja0Zyb21SYXlNb3N0RGV0YWlsZWQgPSBmdW5jdGlvbiAoXG4gIHNjZW5lLFxuICByYXksXG4gIGxpbWl0LFxuICBvYmplY3RzVG9FeGNsdWRlLFxuICB3aWR0aFxuKSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLmRlZmluZWQoXCJyYXlcIiwgcmF5KTtcbiAgaWYgKHNjZW5lLm1vZGUgIT09IFNjZW5lTW9kZS5TQ0VORTNEKSB7XG4gICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFxuICAgICAgXCJSYXkgaW50ZXJzZWN0aW9ucyBhcmUgb25seSBzdXBwb3J0ZWQgaW4gM0QgbW9kZS5cIlxuICAgICk7XG4gIH1cbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgdmFyIHRoYXQgPSB0aGlzO1xuICByYXkgPSBSYXkuY2xvbmUocmF5KTtcbiAgb2JqZWN0c1RvRXhjbHVkZSA9IGRlZmluZWQob2JqZWN0c1RvRXhjbHVkZSlcbiAgICA/IG9iamVjdHNUb0V4Y2x1ZGUuc2xpY2UoKVxuICAgIDogb2JqZWN0c1RvRXhjbHVkZTtcbiAgcmV0dXJuIGRlZmVyUHJvbWlzZVVudGlsUG9zdFJlbmRlcihcbiAgICBzY2VuZSxcbiAgICBsYXVuY2hNb3N0RGV0YWlsZWRSYXlQaWNrKFxuICAgICAgdGhhdCxcbiAgICAgIHNjZW5lLFxuICAgICAgcmF5LFxuICAgICAgb2JqZWN0c1RvRXhjbHVkZSxcbiAgICAgIHdpZHRoLFxuICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZHJpbGxQaWNrRnJvbVJheShcbiAgICAgICAgICB0aGF0LFxuICAgICAgICAgIHNjZW5lLFxuICAgICAgICAgIHJheSxcbiAgICAgICAgICBsaW1pdCxcbiAgICAgICAgICBvYmplY3RzVG9FeGNsdWRlLFxuICAgICAgICAgIHdpZHRoLFxuICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgIHRydWVcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICApXG4gICk7XG59O1xuXG52YXIgc2NyYXRjaFN1cmZhY2VQb3NpdGlvbiA9IG5ldyBDYXJ0ZXNpYW4zKCk7XG52YXIgc2NyYXRjaFN1cmZhY2VOb3JtYWwgPSBuZXcgQ2FydGVzaWFuMygpO1xudmFyIHNjcmF0Y2hTdXJmYWNlUmF5ID0gbmV3IFJheSgpO1xudmFyIHNjcmF0Y2hDYXJ0b2dyYXBoaWMgPSBuZXcgQ2FydG9ncmFwaGljKCk7XG5cbmZ1bmN0aW9uIGdldFJheUZvclNhbXBsZUhlaWdodChzY2VuZSwgY2FydG9ncmFwaGljKSB7XG4gIHZhciBnbG9iZSA9IHNjZW5lLmdsb2JlO1xuICB2YXIgZWxsaXBzb2lkID0gZGVmaW5lZChnbG9iZSlcbiAgICA/IGdsb2JlLmVsbGlwc29pZFxuICAgIDogc2NlbmUubWFwUHJvamVjdGlvbi5lbGxpcHNvaWQ7XG4gIHZhciBoZWlnaHQgPSBBcHByb3hpbWF0ZVRlcnJhaW5IZWlnaHRzLl9kZWZhdWx0TWF4VGVycmFpbkhlaWdodDtcbiAgdmFyIHN1cmZhY2VOb3JtYWwgPSBlbGxpcHNvaWQuZ2VvZGV0aWNTdXJmYWNlTm9ybWFsQ2FydG9ncmFwaGljKFxuICAgIGNhcnRvZ3JhcGhpYyxcbiAgICBzY3JhdGNoU3VyZmFjZU5vcm1hbFxuICApO1xuICB2YXIgc3VyZmFjZVBvc2l0aW9uID0gQ2FydG9ncmFwaGljLnRvQ2FydGVzaWFuKFxuICAgIGNhcnRvZ3JhcGhpYyxcbiAgICBlbGxpcHNvaWQsXG4gICAgc2NyYXRjaFN1cmZhY2VQb3NpdGlvblxuICApO1xuICB2YXIgc3VyZmFjZVJheSA9IHNjcmF0Y2hTdXJmYWNlUmF5O1xuICBzdXJmYWNlUmF5Lm9yaWdpbiA9IHN1cmZhY2VQb3NpdGlvbjtcbiAgc3VyZmFjZVJheS5kaXJlY3Rpb24gPSBzdXJmYWNlTm9ybWFsO1xuICB2YXIgcmF5ID0gbmV3IFJheSgpO1xuICBSYXkuZ2V0UG9pbnQoc3VyZmFjZVJheSwgaGVpZ2h0LCByYXkub3JpZ2luKTtcbiAgQ2FydGVzaWFuMy5uZWdhdGUoc3VyZmFjZU5vcm1hbCwgcmF5LmRpcmVjdGlvbik7XG4gIHJldHVybiByYXk7XG59XG5cbmZ1bmN0aW9uIGdldFJheUZvckNsYW1wVG9IZWlnaHQoc2NlbmUsIGNhcnRlc2lhbikge1xuICB2YXIgZ2xvYmUgPSBzY2VuZS5nbG9iZTtcbiAgdmFyIGVsbGlwc29pZCA9IGRlZmluZWQoZ2xvYmUpXG4gICAgPyBnbG9iZS5lbGxpcHNvaWRcbiAgICA6IHNjZW5lLm1hcFByb2plY3Rpb24uZWxsaXBzb2lkO1xuICB2YXIgY2FydG9ncmFwaGljID0gQ2FydG9ncmFwaGljLmZyb21DYXJ0ZXNpYW4oXG4gICAgY2FydGVzaWFuLFxuICAgIGVsbGlwc29pZCxcbiAgICBzY3JhdGNoQ2FydG9ncmFwaGljXG4gICk7XG4gIHJldHVybiBnZXRSYXlGb3JTYW1wbGVIZWlnaHQoc2NlbmUsIGNhcnRvZ3JhcGhpYyk7XG59XG5cbmZ1bmN0aW9uIGdldEhlaWdodEZyb21DYXJ0ZXNpYW4oc2NlbmUsIGNhcnRlc2lhbikge1xuICB2YXIgZ2xvYmUgPSBzY2VuZS5nbG9iZTtcbiAgdmFyIGVsbGlwc29pZCA9IGRlZmluZWQoZ2xvYmUpXG4gICAgPyBnbG9iZS5lbGxpcHNvaWRcbiAgICA6IHNjZW5lLm1hcFByb2plY3Rpb24uZWxsaXBzb2lkO1xuICB2YXIgY2FydG9ncmFwaGljID0gQ2FydG9ncmFwaGljLmZyb21DYXJ0ZXNpYW4oXG4gICAgY2FydGVzaWFuLFxuICAgIGVsbGlwc29pZCxcbiAgICBzY3JhdGNoQ2FydG9ncmFwaGljXG4gICk7XG4gIHJldHVybiBjYXJ0b2dyYXBoaWMuaGVpZ2h0O1xufVxuXG5mdW5jdGlvbiBzYW1wbGVIZWlnaHRNb3N0RGV0YWlsZWQoXG4gIHBpY2tpbmcsXG4gIHNjZW5lLFxuICBjYXJ0b2dyYXBoaWMsXG4gIG9iamVjdHNUb0V4Y2x1ZGUsXG4gIHdpZHRoXG4pIHtcbiAgdmFyIHJheSA9IGdldFJheUZvclNhbXBsZUhlaWdodChzY2VuZSwgY2FydG9ncmFwaGljKTtcbiAgcmV0dXJuIGxhdW5jaE1vc3REZXRhaWxlZFJheVBpY2soXG4gICAgcGlja2luZyxcbiAgICBzY2VuZSxcbiAgICByYXksXG4gICAgb2JqZWN0c1RvRXhjbHVkZSxcbiAgICB3aWR0aCxcbiAgICBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgcGlja1Jlc3VsdCA9IHBpY2tGcm9tUmF5KFxuICAgICAgICBwaWNraW5nLFxuICAgICAgICBzY2VuZSxcbiAgICAgICAgcmF5LFxuICAgICAgICBvYmplY3RzVG9FeGNsdWRlLFxuICAgICAgICB3aWR0aCxcbiAgICAgICAgdHJ1ZSxcbiAgICAgICAgdHJ1ZVxuICAgICAgKTtcbiAgICAgIGlmIChkZWZpbmVkKHBpY2tSZXN1bHQpKSB7XG4gICAgICAgIHJldHVybiBnZXRIZWlnaHRGcm9tQ2FydGVzaWFuKHNjZW5lLCBwaWNrUmVzdWx0LnBvc2l0aW9uKTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG59XG5cbmZ1bmN0aW9uIGNsYW1wVG9IZWlnaHRNb3N0RGV0YWlsZWQoXG4gIHBpY2tpbmcsXG4gIHNjZW5lLFxuICBjYXJ0ZXNpYW4sXG4gIG9iamVjdHNUb0V4Y2x1ZGUsXG4gIHdpZHRoLFxuICByZXN1bHRcbikge1xuICB2YXIgcmF5ID0gZ2V0UmF5Rm9yQ2xhbXBUb0hlaWdodChzY2VuZSwgY2FydGVzaWFuKTtcbiAgcmV0dXJuIGxhdW5jaE1vc3REZXRhaWxlZFJheVBpY2soXG4gICAgcGlja2luZyxcbiAgICBzY2VuZSxcbiAgICByYXksXG4gICAgb2JqZWN0c1RvRXhjbHVkZSxcbiAgICB3aWR0aCxcbiAgICBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgcGlja1Jlc3VsdCA9IHBpY2tGcm9tUmF5KFxuICAgICAgICBwaWNraW5nLFxuICAgICAgICBzY2VuZSxcbiAgICAgICAgcmF5LFxuICAgICAgICBvYmplY3RzVG9FeGNsdWRlLFxuICAgICAgICB3aWR0aCxcbiAgICAgICAgdHJ1ZSxcbiAgICAgICAgdHJ1ZVxuICAgICAgKTtcbiAgICAgIGlmIChkZWZpbmVkKHBpY2tSZXN1bHQpKSB7XG4gICAgICAgIHJldHVybiBDYXJ0ZXNpYW4zLmNsb25lKHBpY2tSZXN1bHQucG9zaXRpb24sIHJlc3VsdCk7XG4gICAgICB9XG4gICAgfVxuICApO1xufVxuXG5QaWNraW5nLnByb3RvdHlwZS5zYW1wbGVIZWlnaHQgPSBmdW5jdGlvbiAoXG4gIHNjZW5lLFxuICBwb3NpdGlvbixcbiAgb2JqZWN0c1RvRXhjbHVkZSxcbiAgd2lkdGhcbikge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay5kZWZpbmVkKFwicG9zaXRpb25cIiwgcG9zaXRpb24pO1xuICBpZiAoc2NlbmUubW9kZSAhPT0gU2NlbmVNb2RlLlNDRU5FM0QpIHtcbiAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXCJzYW1wbGVIZWlnaHQgaXMgb25seSBzdXBwb3J0ZWQgaW4gM0QgbW9kZS5cIik7XG4gIH1cbiAgaWYgKCFzY2VuZS5zYW1wbGVIZWlnaHRTdXBwb3J0ZWQpIHtcbiAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgICBcInNhbXBsZUhlaWdodCByZXF1aXJlcyBkZXB0aCB0ZXh0dXJlIHN1cHBvcnQuIENoZWNrIHNhbXBsZUhlaWdodFN1cHBvcnRlZC5cIlxuICAgICk7XG4gIH1cbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgdmFyIHJheSA9IGdldFJheUZvclNhbXBsZUhlaWdodChzY2VuZSwgcG9zaXRpb24pO1xuICB2YXIgcGlja1Jlc3VsdCA9IHBpY2tGcm9tUmF5KFxuICAgIHRoaXMsXG4gICAgc2NlbmUsXG4gICAgcmF5LFxuICAgIG9iamVjdHNUb0V4Y2x1ZGUsXG4gICAgd2lkdGgsXG4gICAgdHJ1ZSxcbiAgICBmYWxzZVxuICApO1xuICBpZiAoZGVmaW5lZChwaWNrUmVzdWx0KSkge1xuICAgIHJldHVybiBnZXRIZWlnaHRGcm9tQ2FydGVzaWFuKHNjZW5lLCBwaWNrUmVzdWx0LnBvc2l0aW9uKTtcbiAgfVxufTtcblxuUGlja2luZy5wcm90b3R5cGUuY2xhbXBUb0hlaWdodCA9IGZ1bmN0aW9uIChcbiAgc2NlbmUsXG4gIGNhcnRlc2lhbixcbiAgb2JqZWN0c1RvRXhjbHVkZSxcbiAgd2lkdGgsXG4gIHJlc3VsdFxuKSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLmRlZmluZWQoXCJjYXJ0ZXNpYW5cIiwgY2FydGVzaWFuKTtcbiAgaWYgKHNjZW5lLm1vZGUgIT09IFNjZW5lTW9kZS5TQ0VORTNEKSB7XG4gICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFwiY2xhbXBUb0hlaWdodCBpcyBvbmx5IHN1cHBvcnRlZCBpbiAzRCBtb2RlLlwiKTtcbiAgfVxuICBpZiAoIXNjZW5lLmNsYW1wVG9IZWlnaHRTdXBwb3J0ZWQpIHtcbiAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgICBcImNsYW1wVG9IZWlnaHQgcmVxdWlyZXMgZGVwdGggdGV4dHVyZSBzdXBwb3J0LiBDaGVjayBjbGFtcFRvSGVpZ2h0U3VwcG9ydGVkLlwiXG4gICAgKTtcbiAgfVxuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB2YXIgcmF5ID0gZ2V0UmF5Rm9yQ2xhbXBUb0hlaWdodChzY2VuZSwgY2FydGVzaWFuKTtcbiAgdmFyIHBpY2tSZXN1bHQgPSBwaWNrRnJvbVJheShcbiAgICB0aGlzLFxuICAgIHNjZW5lLFxuICAgIHJheSxcbiAgICBvYmplY3RzVG9FeGNsdWRlLFxuICAgIHdpZHRoLFxuICAgIHRydWUsXG4gICAgZmFsc2VcbiAgKTtcbiAgaWYgKGRlZmluZWQocGlja1Jlc3VsdCkpIHtcbiAgICByZXR1cm4gQ2FydGVzaWFuMy5jbG9uZShwaWNrUmVzdWx0LnBvc2l0aW9uLCByZXN1bHQpO1xuICB9XG59O1xuXG5QaWNraW5nLnByb3RvdHlwZS5zYW1wbGVIZWlnaHRNb3N0RGV0YWlsZWQgPSBmdW5jdGlvbiAoXG4gIHNjZW5lLFxuICBwb3NpdGlvbnMsXG4gIG9iamVjdHNUb0V4Y2x1ZGUsXG4gIHdpZHRoXG4pIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2suZGVmaW5lZChcInBvc2l0aW9uc1wiLCBwb3NpdGlvbnMpO1xuICBpZiAoc2NlbmUubW9kZSAhPT0gU2NlbmVNb2RlLlNDRU5FM0QpIHtcbiAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgICBcInNhbXBsZUhlaWdodE1vc3REZXRhaWxlZCBpcyBvbmx5IHN1cHBvcnRlZCBpbiAzRCBtb2RlLlwiXG4gICAgKTtcbiAgfVxuICBpZiAoIXNjZW5lLnNhbXBsZUhlaWdodFN1cHBvcnRlZCkge1xuICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcbiAgICAgIFwic2FtcGxlSGVpZ2h0TW9zdERldGFpbGVkIHJlcXVpcmVzIGRlcHRoIHRleHR1cmUgc3VwcG9ydC4gQ2hlY2sgc2FtcGxlSGVpZ2h0U3VwcG9ydGVkLlwiXG4gICAgKTtcbiAgfVxuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICBvYmplY3RzVG9FeGNsdWRlID0gZGVmaW5lZChvYmplY3RzVG9FeGNsdWRlKVxuICAgID8gb2JqZWN0c1RvRXhjbHVkZS5zbGljZSgpXG4gICAgOiBvYmplY3RzVG9FeGNsdWRlO1xuICB2YXIgbGVuZ3RoID0gcG9zaXRpb25zLmxlbmd0aDtcbiAgdmFyIHByb21pc2VzID0gbmV3IEFycmF5KGxlbmd0aCk7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICBwcm9taXNlc1tpXSA9IHNhbXBsZUhlaWdodE1vc3REZXRhaWxlZChcbiAgICAgIHRoaXMsXG4gICAgICBzY2VuZSxcbiAgICAgIHBvc2l0aW9uc1tpXSxcbiAgICAgIG9iamVjdHNUb0V4Y2x1ZGUsXG4gICAgICB3aWR0aFxuICAgICk7XG4gIH1cbiAgcmV0dXJuIGRlZmVyUHJvbWlzZVVudGlsUG9zdFJlbmRlcihcbiAgICBzY2VuZSxcbiAgICB3aGVuLmFsbChwcm9taXNlcykudGhlbihmdW5jdGlvbiAoaGVpZ2h0cykge1xuICAgICAgdmFyIGxlbmd0aCA9IGhlaWdodHMubGVuZ3RoO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgICAgICBwb3NpdGlvbnNbaV0uaGVpZ2h0ID0gaGVpZ2h0c1tpXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwb3NpdGlvbnM7XG4gICAgfSlcbiAgKTtcbn07XG5cblBpY2tpbmcucHJvdG90eXBlLmNsYW1wVG9IZWlnaHRNb3N0RGV0YWlsZWQgPSBmdW5jdGlvbiAoXG4gIHNjZW5lLFxuICBjYXJ0ZXNpYW5zLFxuICBvYmplY3RzVG9FeGNsdWRlLFxuICB3aWR0aFxuKSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLmRlZmluZWQoXCJjYXJ0ZXNpYW5zXCIsIGNhcnRlc2lhbnMpO1xuICBpZiAoc2NlbmUubW9kZSAhPT0gU2NlbmVNb2RlLlNDRU5FM0QpIHtcbiAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgICBcImNsYW1wVG9IZWlnaHRNb3N0RGV0YWlsZWQgaXMgb25seSBzdXBwb3J0ZWQgaW4gM0QgbW9kZS5cIlxuICAgICk7XG4gIH1cbiAgaWYgKCFzY2VuZS5jbGFtcFRvSGVpZ2h0U3VwcG9ydGVkKSB7XG4gICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFxuICAgICAgXCJjbGFtcFRvSGVpZ2h0TW9zdERldGFpbGVkIHJlcXVpcmVzIGRlcHRoIHRleHR1cmUgc3VwcG9ydC4gQ2hlY2sgY2xhbXBUb0hlaWdodFN1cHBvcnRlZC5cIlxuICAgICk7XG4gIH1cbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgb2JqZWN0c1RvRXhjbHVkZSA9IGRlZmluZWQob2JqZWN0c1RvRXhjbHVkZSlcbiAgICA/IG9iamVjdHNUb0V4Y2x1ZGUuc2xpY2UoKVxuICAgIDogb2JqZWN0c1RvRXhjbHVkZTtcbiAgdmFyIGxlbmd0aCA9IGNhcnRlc2lhbnMubGVuZ3RoO1xuICB2YXIgcHJvbWlzZXMgPSBuZXcgQXJyYXkobGVuZ3RoKTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIHByb21pc2VzW2ldID0gY2xhbXBUb0hlaWdodE1vc3REZXRhaWxlZChcbiAgICAgIHRoaXMsXG4gICAgICBzY2VuZSxcbiAgICAgIGNhcnRlc2lhbnNbaV0sXG4gICAgICBvYmplY3RzVG9FeGNsdWRlLFxuICAgICAgd2lkdGgsXG4gICAgICBjYXJ0ZXNpYW5zW2ldXG4gICAgKTtcbiAgfVxuICByZXR1cm4gZGVmZXJQcm9taXNlVW50aWxQb3N0UmVuZGVyKFxuICAgIHNjZW5lLFxuICAgIHdoZW4uYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uIChjbGFtcGVkQ2FydGVzaWFucykge1xuICAgICAgdmFyIGxlbmd0aCA9IGNsYW1wZWRDYXJ0ZXNpYW5zLmxlbmd0aDtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICAgICAgY2FydGVzaWFuc1tpXSA9IGNsYW1wZWRDYXJ0ZXNpYW5zW2ldO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGNhcnRlc2lhbnM7XG4gICAgfSlcbiAgKTtcbn07XG5cblBpY2tpbmcucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuX3BpY2tPZmZzY3JlZW5WaWV3ID1cbiAgICB0aGlzLl9waWNrT2Zmc2NyZWVuVmlldyAmJiB0aGlzLl9waWNrT2Zmc2NyZWVuVmlldy5kZXN0cm95KCk7XG59O1xuZXhwb3J0IGRlZmF1bHQgUGlja2luZztcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///18441\n')}}]);