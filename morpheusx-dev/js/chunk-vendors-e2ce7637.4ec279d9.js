"use strict";(self["webpackChunkvue3_webpack5"]=self["webpackChunkvue3_webpack5"]||[]).push([[3924],{16626:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(48243);\n/* harmony import */ var _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(60838);\n/* harmony import */ var _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(60216);\n/* harmony import */ var _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(63367);\n/* harmony import */ var _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(51688);\n/* harmony import */ var _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(66553);\n/* harmony import */ var _Core_clone_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(83856);\n/* harmony import */ var _Core_Color_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(59947);\n/* harmony import */ var _Core_combine_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(8182);\n/* harmony import */ var _Core_createGuid_js__WEBPACK_IMPORTED_MODULE_75__ = __webpack_require__(39960);\n/* harmony import */ var _Core_Credit_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(52975);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_74__ = __webpack_require__(82982);\n/* harmony import */ var _Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(86511);\n/* harmony import */ var _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(12572);\n/* harmony import */ var _Core_DistanceDisplayCondition_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(47861);\n/* harmony import */ var _Core_FeatureDetection_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(96037);\n/* harmony import */ var _Core_getAbsoluteUri_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(83295);\n/* harmony import */ var _Core_getJsonFromTypedArray_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(12540);\n/* harmony import */ var _Core_getMagic_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(3020);\n/* harmony import */ var _Core_getStringFromTypedArray_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(66659);\n/* harmony import */ var _Core_IndexDatatype_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(22832);\n/* harmony import */ var _Core_loadImageFromTypedArray_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(10945);\n/* harmony import */ var _Core_loadKTX2_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(54973);\n/* harmony import */ var _Core_Math_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(99417);\n/* harmony import */ var _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(68201);\n/* harmony import */ var _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(72248);\n/* harmony import */ var _Core_PixelFormat_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(38443);\n/* harmony import */ var _Core_PrimitiveType_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(97264);\n/* harmony import */ var _Core_Quaternion_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(87811);\n/* harmony import */ var _Core_Resource_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(68985);\n/* harmony import */ var _Core_Transforms_js__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(95555);\n/* harmony import */ var _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(52200);\n/* harmony import */ var _Renderer_Buffer_js__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(99095);\n/* harmony import */ var _Renderer_BufferUsage_js__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(58597);\n/* harmony import */ var _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(60072);\n/* harmony import */ var _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(8379);\n/* harmony import */ var _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(10667);\n/* harmony import */ var _Renderer_Sampler_js__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(87721);\n/* harmony import */ var _Renderer_ShaderProgram_js__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(46588);\n/* harmony import */ var _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(53642);\n/* harmony import */ var _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(8743);\n/* harmony import */ var _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(80188);\n/* harmony import */ var _Renderer_TextureWrap_js__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(88453);\n/* harmony import */ var _Renderer_VertexArray_js__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(18192);\n/* harmony import */ var _GltfPipeline_addDefaults_js__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(32550);\n/* harmony import */ var _GltfPipeline_addPipelineExtras_js__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(93410);\n/* harmony import */ var _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(56629);\n/* harmony import */ var _GltfPipeline_getAccessorByteStride_js__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(93224);\n/* harmony import */ var _GltfPipeline_usesExtension_js__WEBPACK_IMPORTED_MODULE_76__ = __webpack_require__(29745);\n/* harmony import */ var _GltfPipeline_numberOfComponentsForType_js__WEBPACK_IMPORTED_MODULE_77__ = __webpack_require__(26806);\n/* harmony import */ var _GltfPipeline_parseGlb_js__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(52655);\n/* harmony import */ var _GltfPipeline_updateVersion_js__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(6186);\n/* harmony import */ var _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(13222);\n/* harmony import */ var _Axis_js__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(66577);\n/* harmony import */ var _BlendingState_js__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(13633);\n/* harmony import */ var _ClippingPlaneCollection_js__WEBPACK_IMPORTED_MODULE_52__ = __webpack_require__(21809);\n/* harmony import */ var _ColorBlendMode_js__WEBPACK_IMPORTED_MODULE_53__ = __webpack_require__(75464);\n/* harmony import */ var _DepthFunction_js__WEBPACK_IMPORTED_MODULE_54__ = __webpack_require__(7976);\n/* harmony import */ var _DracoLoader_js__WEBPACK_IMPORTED_MODULE_55__ = __webpack_require__(8056);\n/* harmony import */ var _getClipAndStyleCode_js__WEBPACK_IMPORTED_MODULE_56__ = __webpack_require__(11013);\n/* harmony import */ var _getClippingFunction_js__WEBPACK_IMPORTED_MODULE_57__ = __webpack_require__(84167);\n/* harmony import */ var _HeightReference_js__WEBPACK_IMPORTED_MODULE_58__ = __webpack_require__(4260);\n/* harmony import */ var _JobType_js__WEBPACK_IMPORTED_MODULE_59__ = __webpack_require__(92454);\n/* harmony import */ var _ModelAnimationCache_js__WEBPACK_IMPORTED_MODULE_60__ = __webpack_require__(81977);\n/* harmony import */ var _ModelAnimationCollection_js__WEBPACK_IMPORTED_MODULE_61__ = __webpack_require__(73431);\n/* harmony import */ var _ModelLoadResources_js__WEBPACK_IMPORTED_MODULE_62__ = __webpack_require__(28770);\n/* harmony import */ var _ModelMaterial_js__WEBPACK_IMPORTED_MODULE_63__ = __webpack_require__(74333);\n/* harmony import */ var _ModelMesh_js__WEBPACK_IMPORTED_MODULE_64__ = __webpack_require__(55531);\n/* harmony import */ var _ModelNode_js__WEBPACK_IMPORTED_MODULE_65__ = __webpack_require__(10531);\n/* harmony import */ var _ModelOutlineLoader_js__WEBPACK_IMPORTED_MODULE_66__ = __webpack_require__(32851);\n/* harmony import */ var _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__ = __webpack_require__(15322);\n/* harmony import */ var _OctahedralProjectedCubeMap_js__WEBPACK_IMPORTED_MODULE_68__ = __webpack_require__(22277);\n/* harmony import */ var _processModelMaterialsCommon_js__WEBPACK_IMPORTED_MODULE_69__ = __webpack_require__(51240);\n/* harmony import */ var _processPbrMaterials_js__WEBPACK_IMPORTED_MODULE_70__ = __webpack_require__(14503);\n/* harmony import */ var _SceneMode_js__WEBPACK_IMPORTED_MODULE_71__ = __webpack_require__(89917);\n/* harmony import */ var _ShadowMode_js__WEBPACK_IMPORTED_MODULE_72__ = __webpack_require__(34125);\n/* harmony import */ var _StencilConstants_js__WEBPACK_IMPORTED_MODULE_73__ = __webpack_require__(87233);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar boundingSphereCartesian3Scratch = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\n\nvar ModelState = _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].ModelState */ .Z.ModelState;\n\n// glTF MIME types discussed in https://github.com/KhronosGroup/glTF/issues/412 and https://github.com/KhronosGroup/glTF/issues/943\nvar defaultModelAccept =\n  "model/gltf-binary,model/gltf+json;q=0.8,application/json;q=0.2,*/*;q=0.01";\n\nvar articulationEpsilon = _Core_Math_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].EPSILON16 */ .Z.EPSILON16;\n\n///////////////////////////////////////////////////////////////////////////\n\nfunction setCachedGltf(model, cachedGltf) {\n  model._cachedGltf = cachedGltf;\n}\n\n// glTF JSON can be big given embedded geometry, textures, and animations, so we\n// cache it across all models using the same url/cache-key.  This also reduces the\n// slight overhead in assigning defaults to missing values.\n//\n// Note that this is a global cache, compared to renderer resources, which\n// are cached per context.\nfunction CachedGltf(options) {\n  this._gltf = options.gltf;\n  this.ready = options.ready;\n  this.modelsToLoad = [];\n  this.count = 0;\n}\n\nObject.defineProperties(CachedGltf.prototype, {\n  gltf: {\n    set: function (value) {\n      this._gltf = value;\n    },\n\n    get: function () {\n      return this._gltf;\n    },\n  },\n});\n\nCachedGltf.prototype.makeReady = function (gltfJson) {\n  this.gltf = gltfJson;\n\n  var models = this.modelsToLoad;\n  var length = models.length;\n  for (var i = 0; i < length; ++i) {\n    var m = models[i];\n    if (!m.isDestroyed()) {\n      setCachedGltf(m, this);\n    }\n  }\n  this.modelsToLoad = undefined;\n  this.ready = true;\n};\n\nvar gltfCache = {};\nvar uriToGuid = {};\n///////////////////////////////////////////////////////////////////////////\n\n/**\n * A 3D model based on glTF, the runtime asset format for WebGL, OpenGL ES, and OpenGL.\n * <p>\n * Cesium includes support for geometry and materials, glTF animations, and glTF skinning.\n * In addition, individual glTF nodes are pickable with {@link Scene#pick} and animatable\n * with {@link Model#getNode}.  glTF cameras and lights are not currently supported.\n * </p>\n * <p>\n * An external glTF asset is created with {@link Model.fromGltf}.  glTF JSON can also be\n * created at runtime and passed to this constructor function.  In either case, the\n * {@link Model#readyPromise} is resolved when the model is ready to render, i.e.,\n * when the external binary, image, and shader files are downloaded and the WebGL\n * resources are created.\n * </p>\n * <p>\n * Cesium supports glTF assets with the following extensions:\n * <ul>\n * <li>\n * {@link https://github.com/KhronosGroup/glTF/blob/master/extensions/1.0/Khronos/KHR_binary_glTF/README.md|KHR_binary_glTF (glTF 1.0)}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/blob/master/extensions/1.0/Khronos/KHR_materials_common/README.md|KHR_materials_common (glTF 1.0)}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/blob/master/extensions/1.0/Vendor/WEB3D_quantized_attributes/README.md|WEB3D_quantized_attributes (glTF 1.0)}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/AGI_articulations/README.md|AGI_articulations}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/pull/1302|KHR_blend (draft)}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_draco_mesh_compression/README.md|KHR_draco_mesh_compression}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness/README.md|KHR_materials_pbrSpecularGlossiness}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit/README.md|KHR_materials_unlit}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_techniques_webgl/README.md|KHR_techniques_webgl}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_texture_transform/README.md|KHR_texture_transform}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_texture_basisu|KHR_texture_basisu}\n * </li>\n * </ul>\n * </p>\n * <p>\n * Note: for models with compressed textures using the KHR_texture_basisu extension, we recommend power of 2 textures in both dimensions\n * for maximum compatibility. This is because some samplers require power of 2 textures ({@link https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Tutorial/Using_textures_in_WebGL|Using textures in WebGL})\n * and KHR_texture_basisu requires multiple of 4 dimensions ({@link https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_texture_basisu/README.md#additional-requirements|KHR_texture_basisu additional requirements}).\n * </p>\n * <p>\n * For high-precision rendering, Cesium supports the {@link https://github.com/KhronosGroup/glTF/blob/master/extensions/1.0/Vendor/CESIUM_RTC/README.md|CESIUM_RTC} extension, which introduces the\n * CESIUM_RTC_MODELVIEW parameter semantic that says the node is in WGS84 coordinates translated\n * relative to a local origin.\n * </p>\n *\n * @alias Model\n * @constructor\n *\n * @param {Object} [options] Object with the following properties:\n * @param {Object|ArrayBuffer|Uint8Array} [options.gltf] A glTF JSON object, or a binary glTF buffer.\n * @param {Resource|String} [options.basePath=\'\'] The base path that paths in the glTF JSON are relative to.\n * @param {Boolean} [options.show=true] Determines if the model primitive will be shown.\n * @param {Matrix4} [options.modelMatrix=Matrix4.IDENTITY] The 4x4 transformation matrix that transforms the model from model to world coordinates.\n * @param {Number} [options.scale=1.0] A uniform scale applied to this model.\n * @param {Number} [options.minimumPixelSize=0.0] The approximate minimum pixel size of the model regardless of zoom.\n * @param {Number} [options.maximumScale] The maximum scale size of a model. An upper limit for minimumPixelSize.\n * @param {Object} [options.id] A user-defined object to return when the model is picked with {@link Scene#pick}.\n * @param {Boolean} [options.allowPicking=true] When <code>true</code>, each glTF mesh and primitive is pickable with {@link Scene#pick}.\n * @param {Boolean} [options.incrementallyLoadTextures=true] Determine if textures may continue to stream in after the model is loaded.\n * @param {Boolean} [options.asynchronous=true] Determines if model WebGL resource creation will be spread out over several frames or block until completion once all glTF files are loaded.\n * @param {Boolean} [options.clampAnimations=true] Determines if the model\'s animations should hold a pose over frames where no keyframes are specified.\n * @param {ShadowMode} [options.shadows=ShadowMode.ENABLED] Determines whether the model casts or receives shadows from light sources.\n * @param {Boolean} [options.debugShowBoundingVolume=false] For debugging only. Draws the bounding sphere for each draw command in the model.\n * @param {Boolean} [options.debugWireframe=false] For debugging only. Draws the model in wireframe.\n * @param {HeightReference} [options.heightReference=HeightReference.NONE] Determines how the model is drawn relative to terrain.\n * @param {Scene} [options.scene] Must be passed in for models that use the height reference property.\n * @param {DistanceDisplayCondition} [options.distanceDisplayCondition] The condition specifying at what distance from the camera that this model will be displayed.\n * @param {Color} [options.color=Color.WHITE] A color that blends with the model\'s rendered color.\n * @param {ColorBlendMode} [options.colorBlendMode=ColorBlendMode.HIGHLIGHT] Defines how the color blends with the model.\n * @param {Number} [options.colorBlendAmount=0.5] Value used to determine the color strength when the <code>colorBlendMode</code> is <code>MIX</code>. A value of 0.0 results in the model\'s rendered color while a value of 1.0 results in a solid color, with any value in-between resulting in a mix of the two.\n * @param {Color} [options.silhouetteColor=Color.RED] The silhouette color. If more than 256 models have silhouettes enabled, there is a small chance that overlapping models will have minor artifacts.\n * @param {Number} [options.silhouetteSize=0.0] The size of the silhouette in pixels.\n * @param {ClippingPlaneCollection} [options.clippingPlanes] The {@link ClippingPlaneCollection} used to selectively disable rendering the model.\n * @param {Boolean} [options.dequantizeInShader=true] Determines if a {@link https://github.com/google/draco|Draco} encoded model is dequantized on the GPU. This decreases total memory usage for encoded models.\n * @param {Cartesian2} [options.imageBasedLightingFactor=Cartesian2(1.0, 1.0)] Scales diffuse and specular image-based lighting from the earth, sky, atmosphere and star skybox.\n * @param {Cartesian3} [options.lightColor] The light color when shading the model. When <code>undefined</code> the scene\'s light color is used instead.\n * @param {Number} [options.luminanceAtZenith=0.2] The sun\'s luminance at the zenith in kilo candela per meter squared to use for this model\'s procedural environment map.\n * @param {Cartesian3[]} [options.sphericalHarmonicCoefficients] The third order spherical harmonic coefficients used for the diffuse color of image-based lighting.\n * @param {String} [options.specularEnvironmentMaps] A URL to a KTX2 file that contains a cube map of the specular lighting and the convoluted specular mipmaps.\n * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n * @param {Boolean} [options.backFaceCulling=true] Whether to cull back-facing geometry. When true, back face culling is determined by the material\'s doubleSided property; when false, back face culling is disabled. Back faces are not culled if {@link Model#color} is translucent or {@link Model#silhouetteSize} is greater than 0.0.\n * @param {Boolean} [options.showOutline=true] Whether to display the outline for models using the {@link https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/CESIUM_primitive_outline|CESIUM_primitive_outline} extension. When true, outlines are displayed. When false, outlines are not displayed.\n *\n * @see Model.fromGltf\n *\n * @demo {@link https://sandcastle.cesium.com/index.html?src=3D%20Models.html|Cesium Sandcastle Models Demo}\n */\nfunction Model(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n\n  var cacheKey = options.cacheKey;\n  this._cacheKey = cacheKey;\n  this._cachedGltf = undefined;\n  this._releaseGltfJson = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.releaseGltfJson, false);\n\n  var cachedGltf;\n  if (\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(cacheKey) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(gltfCache[cacheKey]) &&\n    gltfCache[cacheKey].ready\n  ) {\n    // glTF JSON is in cache and ready\n    cachedGltf = gltfCache[cacheKey];\n    ++cachedGltf.count;\n  } else {\n    // glTF was explicitly provided, e.g., when a user uses the Model constructor directly\n    var gltf = options.gltf;\n\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(gltf)) {\n      if (gltf instanceof ArrayBuffer) {\n        gltf = new Uint8Array(gltf);\n      }\n\n      if (gltf instanceof Uint8Array) {\n        // Binary glTF\n        var parsedGltf = (0,_GltfPipeline_parseGlb_js__WEBPACK_IMPORTED_MODULE_47__/* ["default"] */ .Z)(gltf);\n\n        cachedGltf = new CachedGltf({\n          gltf: parsedGltf,\n          ready: true,\n        });\n      } else {\n        // Normal glTF (JSON)\n        cachedGltf = new CachedGltf({\n          gltf: options.gltf,\n          ready: true,\n        });\n      }\n\n      cachedGltf.count = 1;\n\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(cacheKey)) {\n        gltfCache[cacheKey] = cachedGltf;\n      }\n    }\n  }\n  setCachedGltf(this, cachedGltf);\n\n  var basePath = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.basePath, "");\n  this._resource = _Core_Resource_js__WEBPACK_IMPORTED_MODULE_28__/* ["default"].createIfNeeded */ .Z.createIfNeeded(basePath);\n\n  // User specified credit\n  var credit = options.credit;\n  if (typeof credit === "string") {\n    credit = new _Core_Credit_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z(credit);\n  }\n  this._credit = credit;\n\n  // Create a list of Credit\'s so they can be added from the Resource later\n  this._resourceCredits = [];\n\n  /**\n   * Determines if the model primitive will be shown.\n   *\n   * @type {Boolean}\n   *\n   * @default true\n   */\n  this.show = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.show, true);\n\n  /**\n   * The silhouette color.\n   *\n   * @type {Color}\n   *\n   * @default Color.RED\n   */\n  this.silhouetteColor = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.silhouetteColor, _Core_Color_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].RED */ .Z.RED);\n  this._silhouetteColor = new _Core_Color_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z();\n  this._silhouetteColorPreviousAlpha = 1.0;\n  this._normalAttributeName = undefined;\n\n  /**\n   * The size of the silhouette in pixels.\n   *\n   * @type {Number}\n   *\n   * @default 0.0\n   */\n  this.silhouetteSize = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.silhouetteSize, 0.0);\n\n  /**\n   * The 4x4 transformation matrix that transforms the model from model to world coordinates.\n   * When this is the identity matrix, the model is drawn in world coordinates, i.e., Earth\'s WGS84 coordinates.\n   * Local reference frames can be used by providing a different transformation matrix, like that returned\n   * by {@link Transforms.eastNorthUpToFixedFrame}.\n   *\n   * @type {Matrix4}\n   *\n   * @default {@link Matrix4.IDENTITY}\n   *\n   * @example\n   * var origin = Cesium.Cartesian3.fromDegrees(-95.0, 40.0, 200000.0);\n   * m.modelMatrix = Cesium.Transforms.eastNorthUpToFixedFrame(origin);\n   */\n  this.modelMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].clone */ .Z.clone(\n    (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.modelMatrix, _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].IDENTITY */ .Z.IDENTITY)\n  );\n  this._modelMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].clone */ .Z.clone(this.modelMatrix);\n  this._clampedModelMatrix = undefined;\n\n  /**\n   * A uniform scale applied to this model before the {@link Model#modelMatrix}.\n   * Values greater than <code>1.0</code> increase the size of the model; values\n   * less than <code>1.0</code> decrease.\n   *\n   * @type {Number}\n   *\n   * @default 1.0\n   */\n  this.scale = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.scale, 1.0);\n  this._scale = this.scale;\n\n  /**\n   * The approximate minimum pixel size of the model regardless of zoom.\n   * This can be used to ensure that a model is visible even when the viewer\n   * zooms out.  When <code>0.0</code>, no minimum size is enforced.\n   *\n   * @type {Number}\n   *\n   * @default 0.0\n   */\n  this.minimumPixelSize = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.minimumPixelSize, 0.0);\n  this._minimumPixelSize = this.minimumPixelSize;\n\n  /**\n   * The maximum scale size for a model. This can be used to give\n   * an upper limit to the {@link Model#minimumPixelSize}, ensuring that the model\n   * is never an unreasonable scale.\n   *\n   * @type {Number}\n   */\n  this.maximumScale = options.maximumScale;\n  this._maximumScale = this.maximumScale;\n\n  /**\n   * User-defined object returned when the model is picked.\n   *\n   * @type Object\n   *\n   * @default undefined\n   *\n   * @see Scene#pick\n   */\n  this.id = options.id;\n  this._id = options.id;\n\n  /**\n   * Returns the height reference of the model\n   *\n   * @type {HeightReference}\n   *\n   * @default HeightReference.NONE\n   */\n  this.heightReference = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(\n    options.heightReference,\n    _HeightReference_js__WEBPACK_IMPORTED_MODULE_58__/* ["default"].NONE */ .Z.NONE\n  );\n  this._heightReference = this.heightReference;\n  this._heightChanged = false;\n  this._removeUpdateHeightCallback = undefined;\n  var scene = options.scene;\n  this._scene = scene;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(scene) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(scene.terrainProviderChanged)) {\n    this._terrainProviderChangedCallback = scene.terrainProviderChanged.addEventListener(\n      function () {\n        this._heightChanged = true;\n      },\n      this\n    );\n  }\n\n  /**\n   * Used for picking primitives that wrap a model.\n   *\n   * @private\n   */\n  this._pickObject = options.pickObject;\n  this._allowPicking = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.allowPicking, true);\n\n  this._ready = false;\n  this._readyPromise = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_49__/* ["default"].defer */ .Z.defer();\n\n  /**\n   * The currently playing glTF animations.\n   *\n   * @type {ModelAnimationCollection}\n   */\n  this.activeAnimations = new _ModelAnimationCollection_js__WEBPACK_IMPORTED_MODULE_61__/* ["default"] */ .Z(this);\n\n  /**\n   * Determines if the model\'s animations should hold a pose over frames where no keyframes are specified.\n   *\n   * @type {Boolean}\n   */\n  this.clampAnimations = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.clampAnimations, true);\n\n  this._defaultTexture = undefined;\n  this._incrementallyLoadTextures = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(\n    options.incrementallyLoadTextures,\n    true\n  );\n  this._asynchronous = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.asynchronous, true);\n\n  /**\n   * Determines whether the model casts or receives shadows from light sources.\n   *\n   * @type {ShadowMode}\n   *\n   * @default ShadowMode.ENABLED\n   */\n  this.shadows = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.shadows, _ShadowMode_js__WEBPACK_IMPORTED_MODULE_72__/* ["default"].ENABLED */ .Z.ENABLED);\n  this._shadows = this.shadows;\n\n  /**\n   * A color that blends with the model\'s rendered color.\n   *\n   * @type {Color}\n   *\n   * @default Color.WHITE\n   */\n  this.color = _Core_Color_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].clone */ .Z.clone((0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.color, _Core_Color_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].WHITE */ .Z.WHITE));\n  this._colorPreviousAlpha = 1.0;\n\n  /**\n   * Defines how the color blends with the model.\n   *\n   * @type {ColorBlendMode}\n   *\n   * @default ColorBlendMode.HIGHLIGHT\n   */\n  this.colorBlendMode = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(\n    options.colorBlendMode,\n    _ColorBlendMode_js__WEBPACK_IMPORTED_MODULE_53__/* ["default"].HIGHLIGHT */ .Z.HIGHLIGHT\n  );\n\n  /**\n   * Value used to determine the color strength when the <code>colorBlendMode</code> is <code>MIX</code>.\n   * A value of 0.0 results in the model\'s rendered color while a value of 1.0 results in a solid color, with\n   * any value in-between resulting in a mix of the two.\n   *\n   * @type {Number}\n   *\n   * @default 0.5\n   */\n  this.colorBlendAmount = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.colorBlendAmount, 0.5);\n\n  this._colorShadingEnabled = false;\n\n  this._clippingPlanes = undefined;\n  this.clippingPlanes = options.clippingPlanes;\n  // Used for checking if shaders need to be regenerated due to clipping plane changes.\n  this._clippingPlanesState = 0;\n\n  // If defined, use this matrix to transform miscellaneous properties like\n  // clipping planes and IBL instead of the modelMatrix. This is so that when\n  // models are part of a tileset these properties get transformed relative to\n  // a common reference (such as the root).\n  this.referenceMatrix = undefined;\n\n  /**\n   * Whether to cull back-facing geometry. When true, back face culling is\n   * determined by the material\'s doubleSided property; when false, back face\n   * culling is disabled. Back faces are not culled if {@link Model#color} is\n   * translucent or {@link Model#silhouetteSize} is greater than 0.0.\n   *\n   * @type {Boolean}\n   *\n   * @default true\n   */\n  this.backFaceCulling = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.backFaceCulling, true);\n\n  /**\n   * Whether to display the outline for models using the\n   * {@link https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/CESIUM_primitive_outline|CESIUM_primitive_outline} extension.\n   * When true, outlines are displayed. When false, outlines are not displayed.\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  this.showOutline = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.showOutline, true);\n\n  /**\n   * This property is for debugging only; it is not for production use nor is it optimized.\n   * <p>\n   * Draws the bounding sphere for each draw command in the model.  A glTF primitive corresponds\n   * to one draw command.  A glTF mesh has an array of primitives, often of length one.\n   * </p>\n   *\n   * @type {Boolean}\n   *\n   * @default false\n   */\n  this.debugShowBoundingVolume = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(\n    options.debugShowBoundingVolume,\n    false\n  );\n  this._debugShowBoundingVolume = false;\n\n  /**\n   * This property is for debugging only; it is not for production use nor is it optimized.\n   * <p>\n   * Draws the model in wireframe.\n   * </p>\n   *\n   * @type {Boolean}\n   *\n   * @default false\n   */\n  this.debugWireframe = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.debugWireframe, false);\n  this._debugWireframe = false;\n\n  this._distanceDisplayCondition = options.distanceDisplayCondition;\n\n  // Undocumented options\n  this._addBatchIdToGeneratedShaders = options.addBatchIdToGeneratedShaders;\n  this._precreatedAttributes = options.precreatedAttributes;\n  this._vertexShaderLoaded = options.vertexShaderLoaded;\n  this._fragmentShaderLoaded = options.fragmentShaderLoaded;\n  this._uniformMapLoaded = options.uniformMapLoaded;\n  this._pickIdLoaded = options.pickIdLoaded;\n  this._ignoreCommands = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.ignoreCommands, false);\n  this._requestType = options.requestType;\n  this._upAxis = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.upAxis, _Axis_js__WEBPACK_IMPORTED_MODULE_50__/* ["default"].Y */ .Z.Y);\n  this._gltfForwardAxis = _Axis_js__WEBPACK_IMPORTED_MODULE_50__/* ["default"].Z */ .Z.Z;\n  this._forwardAxis = options.forwardAxis;\n\n  /**\n   * @private\n   * @readonly\n   */\n  this.cull = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.cull, true);\n\n  /**\n   * @private\n   * @readonly\n   */\n  this.opaquePass = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.opaquePass, _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_34__/* ["default"].OPAQUE */ .Z.OPAQUE);\n\n  this._computedModelMatrix = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z(); // Derived from modelMatrix and scale\n  this._clippingPlanesMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].clone */ .Z.clone(_Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].IDENTITY */ .Z.IDENTITY); // Derived from reference matrix and the current view matrix\n  this._iblReferenceFrameMatrix = _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].clone */ .Z.clone(_Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].IDENTITY */ .Z.IDENTITY); // Derived from reference matrix and the current view matrix\n  this._initialRadius = undefined; // Radius without model\'s scale property, model-matrix scale, animations, or skins\n  this._boundingSphere = undefined;\n  this._scaledBoundingSphere = new _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\n  this._state = ModelState.NEEDS_LOAD;\n  this._loadResources = undefined;\n\n  this._mode = undefined;\n\n  this._perNodeShowDirty = false; // true when the Cesium API was used to change a node\'s show property\n  this._cesiumAnimationsDirty = false; // true when the Cesium API, not a glTF animation, changed a node transform\n  this._dirty = false; // true when the model was transformed this frame\n  this._maxDirtyNumber = 0; // Used in place of a dirty boolean flag to avoid an extra graph traversal\n\n  this._runtime = {\n    animations: undefined,\n    articulationsByName: undefined,\n    articulationsByStageKey: undefined,\n    stagesByKey: undefined,\n    rootNodes: undefined,\n    nodes: undefined, // Indexed with the node\'s index\n    nodesByName: undefined, // Indexed with name property in the node\n    skinnedNodes: undefined,\n    meshesByName: undefined, // Indexed with the name property in the mesh\n    materialsByName: undefined, // Indexed with the name property in the material\n    materialsById: undefined, // Indexed with the material\'s index\n  };\n\n  this._uniformMaps = {}; // Not cached since it can be targeted by glTF animation\n  this._extensionsUsed = undefined; // Cached used glTF extensions\n  this._extensionsRequired = undefined; // Cached required glTF extensions\n  this._quantizedUniforms = {}; // Quantized uniforms for each program for WEB3D_quantized_attributes\n  this._programPrimitives = {};\n  this._rendererResources = {\n    // Cached between models with the same url/cache-key\n    buffers: {},\n    vertexArrays: {},\n    programs: {},\n    sourceShaders: {},\n    silhouettePrograms: {},\n    textures: {},\n    samplers: {},\n    renderStates: {},\n  };\n  this._cachedRendererResources = undefined;\n  this._loadRendererResourcesFromCache = false;\n\n  this._dequantizeInShader = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.dequantizeInShader, true);\n  this._decodedData = {};\n\n  this._cachedGeometryByteLength = 0;\n  this._cachedTexturesByteLength = 0;\n  this._geometryByteLength = 0;\n  this._texturesByteLength = 0;\n  this._trianglesLength = 0;\n  this._pointsLength = 0;\n\n  // Hold references for shader reconstruction.\n  // Hold these separately because _cachedGltf may get released (this.releaseGltfJson)\n  this._sourceTechniques = {};\n  this._sourcePrograms = {};\n  this._quantizedVertexShaders = {};\n\n  this._nodeCommands = [];\n  this._pickIds = [];\n\n  // CESIUM_RTC extension\n  this._rtcCenter = undefined; // reference to either 3D or 2D\n  this._rtcCenterEye = undefined; // in eye coordinates\n  this._rtcCenter3D = undefined; // in world coordinates\n  this._rtcCenter2D = undefined; // in projected world coordinates\n\n  this._sourceVersion = undefined;\n  this._sourceKHRTechniquesWebGL = undefined;\n\n  this._imageBasedLightingFactor = new _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z(1.0, 1.0);\n  _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].clone */ .Z.clone(\n    options.imageBasedLightingFactor,\n    this._imageBasedLightingFactor\n  );\n  this._lightColor = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].clone */ .Z.clone(options.lightColor);\n\n  this._luminanceAtZenith = undefined;\n  this.luminanceAtZenith = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.luminanceAtZenith, 0.2);\n\n  this._sphericalHarmonicCoefficients = options.sphericalHarmonicCoefficients;\n  this._specularEnvironmentMaps = options.specularEnvironmentMaps;\n  this._shouldUpdateSpecularMapAtlas = true;\n  this._specularEnvironmentMapAtlas = undefined;\n\n  this._useDefaultSphericalHarmonics = false;\n  this._useDefaultSpecularMaps = false;\n\n  this._shouldRegenerateShaders = false;\n}\n\nObject.defineProperties(Model.prototype, {\n  /**\n   * The object for the glTF JSON, including properties with default values omitted\n   * from the JSON provided to this model.\n   *\n   * @memberof Model.prototype\n   *\n   * @type {Object}\n   * @readonly\n   *\n   * @default undefined\n   */\n  gltf: {\n    get: function () {\n      return (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._cachedGltf) ? this._cachedGltf.gltf : undefined;\n    },\n  },\n\n  /**\n   * When <code>true</code>, the glTF JSON is not stored with the model once the model is\n   * loaded (when {@link Model#ready} is <code>true</code>).  This saves memory when\n   * geometry, textures, and animations are embedded in the .gltf file.\n   * This is especially useful for cases like 3D buildings, where each .gltf model is unique\n   * and caching the glTF JSON is not effective.\n   *\n   * @memberof Model.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default false\n   *\n   * @private\n   */\n  releaseGltfJson: {\n    get: function () {\n      return this._releaseGltfJson;\n    },\n  },\n\n  /**\n   * The key identifying this model in the model cache for glTF JSON, renderer resources, and animations.\n   * Caching saves memory and improves loading speed when several models with the same url are created.\n   * <p>\n   * This key is automatically generated when the model is created with {@link Model.fromGltf}.  If the model\n   * is created directly from glTF JSON using the {@link Model} constructor, this key can be manually\n   * provided; otherwise, the model will not be changed.\n   * </p>\n   *\n   * @memberof Model.prototype\n   *\n   * @type {String}\n   * @readonly\n   *\n   * @private\n   */\n  cacheKey: {\n    get: function () {\n      return this._cacheKey;\n    },\n  },\n\n  /**\n   * The base path that paths in the glTF JSON are relative to.  The base\n   * path is the same path as the path containing the .gltf file\n   * minus the .gltf file, when binary, image, and shader files are\n   * in the same directory as the .gltf.  When this is <code>\'\'</code>,\n   * the app\'s base path is used.\n   *\n   * @memberof Model.prototype\n   *\n   * @type {String}\n   * @readonly\n   *\n   * @default \'\'\n   */\n  basePath: {\n    get: function () {\n      return this._resource.url;\n    },\n  },\n\n  /**\n   * The model\'s bounding sphere in its local coordinate system.  This does not take into\n   * account glTF animations and skins nor does it take into account {@link Model#minimumPixelSize}.\n   *\n   * @memberof Model.prototype\n   *\n   * @type {BoundingSphere}\n   * @readonly\n   *\n   * @default undefined\n   *\n   * @exception {DeveloperError} The model is not loaded.  Use Model.readyPromise or wait for Model.ready to be true.\n   *\n   * @example\n   * // Center in WGS84 coordinates\n   * var center = Cesium.Matrix4.multiplyByPoint(model.modelMatrix, model.boundingSphere.center, new Cesium.Cartesian3());\n   */\n  boundingSphere: {\n    get: function () {\n      //>>includeStart(\'debug\', pragmas.debug);\n      if (this._state !== ModelState.LOADED) {\n        throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z(\n          "The model is not loaded.  Use Model.readyPromise or wait for Model.ready to be true."\n        );\n      }\n      //>>includeEnd(\'debug\');\n\n      var modelMatrix = this.modelMatrix;\n      if (\n        this.heightReference !== _HeightReference_js__WEBPACK_IMPORTED_MODULE_58__/* ["default"].NONE */ .Z.NONE &&\n        this._clampedModelMatrix\n      ) {\n        modelMatrix = this._clampedModelMatrix;\n      }\n\n      var nonUniformScale = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].getScale */ .Z.getScale(\n        modelMatrix,\n        boundingSphereCartesian3Scratch\n      );\n      var scale = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this.maximumScale)\n        ? Math.min(this.maximumScale, this.scale)\n        : this.scale;\n      _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].multiplyByScalar */ .Z.multiplyByScalar(nonUniformScale, scale, nonUniformScale);\n\n      var scaledBoundingSphere = this._scaledBoundingSphere;\n      scaledBoundingSphere.center = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].multiplyComponents */ .Z.multiplyComponents(\n        this._boundingSphere.center,\n        nonUniformScale,\n        scaledBoundingSphere.center\n      );\n      scaledBoundingSphere.radius =\n        _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].maximumComponent */ .Z.maximumComponent(nonUniformScale) * this._initialRadius;\n\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._rtcCenter)) {\n        _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].add */ .Z.add(\n          this._rtcCenter,\n          scaledBoundingSphere.center,\n          scaledBoundingSphere.center\n        );\n      }\n\n      return scaledBoundingSphere;\n    },\n  },\n\n  /**\n   * When <code>true</code>, this model is ready to render, i.e., the external binary, image,\n   * and shader files were downloaded and the WebGL resources were created.  This is set to\n   * <code>true</code> right before {@link Model#readyPromise} is resolved.\n   *\n   * @memberof Model.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default false\n   */\n  ready: {\n    get: function () {\n      return this._ready;\n    },\n  },\n\n  /**\n   * Gets the promise that will be resolved when this model is ready to render, i.e., when the external binary, image,\n   * and shader files were downloaded and the WebGL resources were created.\n   * <p>\n   * This promise is resolved at the end of the frame before the first frame the model is rendered in.\n   * </p>\n   *\n   * @memberof Model.prototype\n   * @type {Promise.<Model>}\n   * @readonly\n   *\n   * @example\n   * // Play all animations at half-speed when the model is ready to render\n   * Cesium.when(model.readyPromise).then(function(model) {\n   *   model.activeAnimations.addAll({\n   *     multiplier : 0.5\n   *   });\n   * }).otherwise(function(error){\n   *   window.alert(error);\n   * });\n   *\n   * @see Model#ready\n   */\n  readyPromise: {\n    get: function () {\n      return this._readyPromise.promise;\n    },\n  },\n\n  /**\n   * Determines if model WebGL resource creation will be spread out over several frames or\n   * block until completion once all glTF files are loaded.\n   *\n   * @memberof Model.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  asynchronous: {\n    get: function () {\n      return this._asynchronous;\n    },\n  },\n\n  /**\n   * When <code>true</code>, each glTF mesh and primitive is pickable with {@link Scene#pick}.  When <code>false</code>, GPU memory is saved.\n   *\n   * @memberof Model.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  allowPicking: {\n    get: function () {\n      return this._allowPicking;\n    },\n  },\n\n  /**\n   * Determine if textures may continue to stream in after the model is loaded.\n   *\n   * @memberof Model.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  incrementallyLoadTextures: {\n    get: function () {\n      return this._incrementallyLoadTextures;\n    },\n  },\n\n  /**\n   * Return the number of pending texture loads.\n   *\n   * @memberof Model.prototype\n   *\n   * @type {Number}\n   * @readonly\n   */\n  pendingTextureLoads: {\n    get: function () {\n      return (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._loadResources)\n        ? this._loadResources.pendingTextureLoads\n        : 0;\n    },\n  },\n\n  /**\n   * Returns true if the model was transformed this frame\n   *\n   * @memberof Model.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @private\n   */\n  dirty: {\n    get: function () {\n      return this._dirty;\n    },\n  },\n\n  /**\n   * Gets or sets the condition specifying at what distance from the camera that this model will be displayed.\n   * @memberof Model.prototype\n   * @type {DistanceDisplayCondition}\n   * @default undefined\n   */\n  distanceDisplayCondition: {\n    get: function () {\n      return this._distanceDisplayCondition;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(value) && value.far <= value.near) {\n        throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z("far must be greater than near");\n      }\n      //>>includeEnd(\'debug\');\n      this._distanceDisplayCondition = _Core_DistanceDisplayCondition_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].clone */ .Z.clone(\n        value,\n        this._distanceDisplayCondition\n      );\n    },\n  },\n\n  extensionsUsed: {\n    get: function () {\n      if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._extensionsUsed)) {\n        this._extensionsUsed = _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].getUsedExtensions */ .Z.getUsedExtensions(this.gltf);\n      }\n      return this._extensionsUsed;\n    },\n  },\n\n  extensionsRequired: {\n    get: function () {\n      if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._extensionsRequired)) {\n        this._extensionsRequired = _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].getRequiredExtensions */ .Z.getRequiredExtensions(\n          this.gltf\n        );\n      }\n      return this._extensionsRequired;\n    },\n  },\n\n  /**\n   * Gets the model\'s up-axis.\n   * By default models are y-up according to the glTF spec, however geo-referenced models will typically be z-up.\n   *\n   * @memberof Model.prototype\n   *\n   * @type {Number}\n   * @default Axis.Y\n   * @readonly\n   *\n   * @private\n   */\n  upAxis: {\n    get: function () {\n      return this._upAxis;\n    },\n  },\n\n  /**\n   * Gets the model\'s forward axis.\n   * By default, glTF 2.0 models are z-forward according to the glTF spec, however older\n   * glTF (1.0, 0.8) models used x-forward.  Note that only Axis.X and Axis.Z are supported.\n   *\n   * @memberof Model.prototype\n   *\n   * @type {Number}\n   * @default Axis.Z\n   * @readonly\n   *\n   * @private\n   */\n  forwardAxis: {\n    get: function () {\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._forwardAxis)) {\n        return this._forwardAxis;\n      }\n      return this._gltfForwardAxis;\n    },\n  },\n\n  /**\n   * Gets the model\'s triangle count.\n   *\n   * @private\n   */\n  trianglesLength: {\n    get: function () {\n      return this._trianglesLength;\n    },\n  },\n\n  /**\n   * Gets the model\'s point count.\n   *\n   * @private\n   */\n  pointsLength: {\n    get: function () {\n      return this._pointsLength;\n    },\n  },\n\n  /**\n   * Gets the model\'s geometry memory in bytes. This includes all vertex and index buffers.\n   *\n   * @private\n   */\n  geometryByteLength: {\n    get: function () {\n      return this._geometryByteLength;\n    },\n  },\n\n  /**\n   * Gets the model\'s texture memory in bytes.\n   *\n   * @private\n   */\n  texturesByteLength: {\n    get: function () {\n      return this._texturesByteLength;\n    },\n  },\n\n  /**\n   * Gets the model\'s cached geometry memory in bytes. This includes all vertex and index buffers.\n   *\n   * @private\n   */\n  cachedGeometryByteLength: {\n    get: function () {\n      return this._cachedGeometryByteLength;\n    },\n  },\n\n  /**\n   * Gets the model\'s cached texture memory in bytes.\n   *\n   * @private\n   */\n  cachedTexturesByteLength: {\n    get: function () {\n      return this._cachedTexturesByteLength;\n    },\n  },\n\n  /**\n   * The {@link ClippingPlaneCollection} used to selectively disable rendering the model.\n   *\n   * @memberof Model.prototype\n   *\n   * @type {ClippingPlaneCollection}\n   */\n  clippingPlanes: {\n    get: function () {\n      return this._clippingPlanes;\n    },\n    set: function (value) {\n      if (value === this._clippingPlanes) {\n        return;\n      }\n      // Handle destroying, checking of unknown, checking for existing ownership\n      _ClippingPlaneCollection_js__WEBPACK_IMPORTED_MODULE_52__/* ["default"].setOwner */ .Z.setOwner(value, this, "_clippingPlanes");\n    },\n  },\n\n  /**\n   * @private\n   */\n  pickIds: {\n    get: function () {\n      return this._pickIds;\n    },\n  },\n\n  /**\n   * Cesium adds lighting from the earth, sky, atmosphere, and star skybox. This cartesian is used to scale the final\n   * diffuse and specular lighting contribution from those sources to the final color. A value of 0.0 will disable those light sources.\n   *\n   * @memberof Model.prototype\n   *\n   * @type {Cartesian2}\n   * @default Cartesian2(1.0, 1.0)\n   */\n  imageBasedLightingFactor: {\n    get: function () {\n      return this._imageBasedLightingFactor;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].typeOf.object */ .Z.typeOf.object("imageBasedLightingFactor", value);\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals(\n        "imageBasedLightingFactor.x",\n        value.x,\n        0.0\n      );\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].typeOf.number.lessThanOrEquals */ .Z.typeOf.number.lessThanOrEquals(\n        "imageBasedLightingFactor.x",\n        value.x,\n        1.0\n      );\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].typeOf.number.greaterThanOrEquals */ .Z.typeOf.number.greaterThanOrEquals(\n        "imageBasedLightingFactor.y",\n        value.y,\n        0.0\n      );\n      _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].typeOf.number.lessThanOrEquals */ .Z.typeOf.number.lessThanOrEquals(\n        "imageBasedLightingFactor.y",\n        value.y,\n        1.0\n      );\n      //>>includeEnd(\'debug\');\n      var imageBasedLightingFactor = this._imageBasedLightingFactor;\n      if (\n        value === imageBasedLightingFactor ||\n        _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].equals */ .Z.equals(value, imageBasedLightingFactor)\n      ) {\n        return;\n      }\n      this._shouldRegenerateShaders =\n        this._shouldRegenerateShaders ||\n        (this._imageBasedLightingFactor.x > 0.0 && value.x === 0.0) ||\n        (this._imageBasedLightingFactor.x === 0.0 && value.x > 0.0);\n      this._shouldRegenerateShaders =\n        this._shouldRegenerateShaders ||\n        (this._imageBasedLightingFactor.y > 0.0 && value.y === 0.0) ||\n        (this._imageBasedLightingFactor.y === 0.0 && value.y > 0.0);\n      _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].clone */ .Z.clone(value, this._imageBasedLightingFactor);\n    },\n  },\n\n  /**\n   * The light color when shading the model. When <code>undefined</code> the scene\'s light color is used instead.\n   * <p>\n   * For example, disabling additional light sources by setting <code>model.imageBasedLightingFactor = new Cesium.Cartesian2(0.0, 0.0)</code> will make the\n   * model much darker. Here, increasing the intensity of the light source will make the model brighter.\n   * </p>\n   *\n   * @memberof Model.prototype\n   *\n   * @type {Cartesian3}\n   * @default undefined\n   */\n  lightColor: {\n    get: function () {\n      return this._lightColor;\n    },\n    set: function (value) {\n      var lightColor = this._lightColor;\n      if (value === lightColor || _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].equals */ .Z.equals(value, lightColor)) {\n        return;\n      }\n      this._shouldRegenerateShaders =\n        this._shouldRegenerateShaders ||\n        ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(lightColor) && !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(value)) ||\n        ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(value) && !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(lightColor));\n      this._lightColor = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].clone */ .Z.clone(value, lightColor);\n    },\n  },\n\n  /**\n   * The sun\'s luminance at the zenith in kilo candela per meter squared to use for this model\'s procedural environment map.\n   * This is used when {@link Model#specularEnvironmentMaps} and {@link Model#sphericalHarmonicCoefficients} are not defined.\n   *\n   * @memberof Model.prototype\n   *\n   * @demo {@link https://sandcastle.cesium.com/index.html?src=Image-Based Lighting.html|Sandcastle Image Based Lighting Demo}\n   * @type {Number}\n   * @default 0.2\n   */\n  luminanceAtZenith: {\n    get: function () {\n      return this._luminanceAtZenith;\n    },\n    set: function (value) {\n      var lum = this._luminanceAtZenith;\n      if (value === lum) {\n        return;\n      }\n      this._shouldRegenerateShaders =\n        this._shouldRegenerateShaders ||\n        ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(lum) && !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(value)) ||\n        ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(value) && !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(lum));\n      this._luminanceAtZenith = value;\n    },\n  },\n\n  /**\n   * The third order spherical harmonic coefficients used for the diffuse color of image-based lighting. When <code>undefined</code>, a diffuse irradiance\n   * computed from the atmosphere color is used.\n   * <p>\n   * There are nine <code>Cartesian3</code> coefficients.\n   * The order of the coefficients is: L<sub>00</sub>, L<sub>1-1</sub>, L<sub>10</sub>, L<sub>11</sub>, L<sub>2-2</sub>, L<sub>2-1</sub>, L<sub>20</sub>, L<sub>21</sub>, L<sub>22</sub>\n   * </p>\n   *\n   * These values can be obtained by preprocessing the environment map using the <code>cmgen</code> tool of\n   * {@link https://github.com/google/filament/releases|Google\'s Filament project}. This will also generate a KTX file that can be\n   * supplied to {@link Model#specularEnvironmentMaps}.\n   *\n   * @memberof Model.prototype\n   *\n   * @type {Cartesian3[]}\n   * @demo {@link https://sandcastle.cesium.com/index.html?src=Image-Based Lighting.html|Sandcastle Image Based Lighting Demo}\n   * @see {@link https://graphics.stanford.edu/papers/envmap/envmap.pdf|An Efficient Representation for Irradiance Environment Maps}\n   */\n  sphericalHarmonicCoefficients: {\n    get: function () {\n      return this._sphericalHarmonicCoefficients;\n    },\n    set: function (value) {\n      //>>includeStart(\'debug\', pragmas.debug);\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(value) && (!Array.isArray(value) || value.length !== 9)) {\n        throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z(\n          "sphericalHarmonicCoefficients must be an array of 9 Cartesian3 values."\n        );\n      }\n      //>>includeEnd(\'debug\');\n      if (value === this._sphericalHarmonicCoefficients) {\n        return;\n      }\n      this._sphericalHarmonicCoefficients = value;\n      this._shouldRegenerateShaders = true;\n    },\n  },\n\n  /**\n   * A URL to a KTX2 file that contains a cube map of the specular lighting and the convoluted specular mipmaps.\n   *\n   * @memberof Model.prototype\n   * @demo {@link https://sandcastle.cesium.com/index.html?src=Image-Based Lighting.html|Sandcastle Image Based Lighting Demo}\n   * @type {String}\n   * @see Model#sphericalHarmonicCoefficients\n   */\n  specularEnvironmentMaps: {\n    get: function () {\n      return this._specularEnvironmentMaps;\n    },\n    set: function (value) {\n      this._shouldUpdateSpecularMapAtlas =\n        this._shouldUpdateSpecularMapAtlas ||\n        value !== this._specularEnvironmentMaps;\n      this._specularEnvironmentMaps = value;\n    },\n  },\n  /**\n   * Gets the credit that will be displayed for the model\n   * @memberof Model.prototype\n   * @type {Credit}\n   */\n  credit: {\n    get: function () {\n      return this._credit;\n    },\n  },\n});\n\nfunction silhouetteSupported(context) {\n  return context.stencilBuffer;\n}\n\nfunction isColorShadingEnabled(model) {\n  return (\n    !_Core_Color_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].equals */ .Z.equals(model.color, _Core_Color_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].WHITE */ .Z.WHITE) ||\n    model.colorBlendMode !== _ColorBlendMode_js__WEBPACK_IMPORTED_MODULE_53__/* ["default"].HIGHLIGHT */ .Z.HIGHLIGHT\n  );\n}\n\nfunction isClippingEnabled(model) {\n  var clippingPlanes = model._clippingPlanes;\n  return (\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(clippingPlanes) &&\n    clippingPlanes.enabled &&\n    clippingPlanes.length !== 0\n  );\n}\n\n/**\n * Determines if silhouettes are supported.\n *\n * @param {Scene} scene The scene.\n * @returns {Boolean} <code>true</code> if silhouettes are supported; otherwise, returns <code>false</code>\n */\nModel.silhouetteSupported = function (scene) {\n  return silhouetteSupported(scene.context);\n};\n\nfunction containsGltfMagic(uint8Array) {\n  var magic = (0,_Core_getMagic_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"] */ .Z)(uint8Array);\n  return magic === "glTF";\n}\n\n/**\n * <p>\n * Creates a model from a glTF asset.  When the model is ready to render, i.e., when the external binary, image,\n * and shader files are downloaded and the WebGL resources are created, the {@link Model#readyPromise} is resolved.\n * </p>\n * <p>\n * The model can be a traditional glTF asset with a .gltf extension or a Binary glTF using the .glb extension.\n * </p>\n * <p>\n * Cesium supports glTF assets with the following extensions:\n * <ul>\n * <li>\n * {@link https://github.com/KhronosGroup/glTF/blob/master/extensions/1.0/Khronos/KHR_binary_glTF/README.md|KHR_binary_glTF (glTF 1.0)}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/blob/master/extensions/1.0/Khronos/KHR_materials_common/README.md|KHR_materials_common (glTF 1.0)}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/blob/master/extensions/1.0/Vendor/WEB3D_quantized_attributes/README.md|WEB3D_quantized_attributes (glTF 1.0)}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/AGI_articulations/README.md|AGI_articulations}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/pull/1302|KHR_blend (draft)}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_draco_mesh_compression/README.md|KHR_draco_mesh_compression}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness/README.md|KHR_materials_pbrSpecularGlossiness}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit/README.md|KHR_materials_unlit}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_techniques_webgl/README.md|KHR_techniques_webgl}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_texture_transform/README.md|KHR_texture_transform}\n * </li><li>\n * {@link https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_texture_basisu/README.md|KHR_texture_basisu}\n * </li>\n * </ul>\n * </p>\n * <p>\n * For high-precision rendering, Cesium supports the {@link https://github.com/KhronosGroup/glTF/blob/master/extensions/1.0/Vendor/CESIUM_RTC/README.md|CESIUM_RTC} extension, which introduces the\n * CESIUM_RTC_MODELVIEW parameter semantic that says the node is in WGS84 coordinates translated\n * relative to a local origin.\n * </p>\n *\n * @param {Object} options Object with the following properties:\n * @param {Resource|String} options.url The url to the .gltf file.\n * @param {Resource|String} [options.basePath] The base path that paths in the glTF JSON are relative to.\n * @param {Boolean} [options.show=true] Determines if the model primitive will be shown.\n * @param {Matrix4} [options.modelMatrix=Matrix4.IDENTITY] The 4x4 transformation matrix that transforms the model from model to world coordinates.\n * @param {Number} [options.scale=1.0] A uniform scale applied to this model.\n * @param {Number} [options.minimumPixelSize=0.0] The approximate minimum pixel size of the model regardless of zoom.\n * @param {Number} [options.maximumScale] The maximum scale for the model.\n * @param {Object} [options.id] A user-defined object to return when the model is picked with {@link Scene#pick}.\n * @param {Boolean} [options.allowPicking=true] When <code>true</code>, each glTF mesh and primitive is pickable with {@link Scene#pick}.\n * @param {Boolean} [options.incrementallyLoadTextures=true] Determine if textures may continue to stream in after the model is loaded.\n * @param {Boolean} [options.asynchronous=true] Determines if model WebGL resource creation will be spread out over several frames or block until completion once all glTF files are loaded.\n * @param {Boolean} [options.clampAnimations=true] Determines if the model\'s animations should hold a pose over frames where no keyframes are specified.\n * @param {ShadowMode} [options.shadows=ShadowMode.ENABLED] Determines whether the model casts or receives shadows from light sources.\n * @param {Boolean} [options.debugShowBoundingVolume=false] For debugging only. Draws the bounding sphere for each draw command in the model.\n * @param {Boolean} [options.debugWireframe=false] For debugging only. Draws the model in wireframe.\n * @param {HeightReference} [options.heightReference=HeightReference.NONE] Determines how the model is drawn relative to terrain.\n * @param {Scene} [options.scene] Must be passed in for models that use the height reference property.\n * @param {DistanceDisplayCondition} [options.distanceDisplayCondition] The condition specifying at what distance from the camera that this model will be displayed.\n * @param {Color} [options.color=Color.WHITE] A color that blends with the model\'s rendered color.\n * @param {ColorBlendMode} [options.colorBlendMode=ColorBlendMode.HIGHLIGHT] Defines how the color blends with the model.\n * @param {Number} [options.colorBlendAmount=0.5] Value used to determine the color strength when the <code>colorBlendMode</code> is <code>MIX</code>. A value of 0.0 results in the model\'s rendered color while a value of 1.0 results in a solid color, with any value in-between resulting in a mix of the two.\n * @param {Color} [options.silhouetteColor=Color.RED] The silhouette color. If more than 256 models have silhouettes enabled, there is a small chance that overlapping models will have minor artifacts.\n * @param {Number} [options.silhouetteSize=0.0] The size of the silhouette in pixels.\n * @param {ClippingPlaneCollection} [options.clippingPlanes] The {@link ClippingPlaneCollection} used to selectively disable rendering the model.\n * @param {Boolean} [options.dequantizeInShader=true] Determines if a {@link https://github.com/google/draco|Draco} encoded model is dequantized on the GPU. This decreases total memory usage for encoded models.\n * @param {Credit|String} [options.credit] A credit for the model, which is displayed on the canvas.\n * @param {Boolean} [options.backFaceCulling=true] Whether to cull back-facing geometry. When true, back face culling is determined by the material\'s doubleSided property; when false, back face culling is disabled. Back faces are not culled if {@link Model#color} is translucent or {@link Model#silhouetteSize} is greater than 0.0.\n * @param {Boolean} [options.showOutline=true] Whether to display the outline for models using the {@link https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/CESIUM_primitive_outline|CESIUM_primitive_outline} extension. When true, outlines are displayed. When false, outlines are not displayed.\n * @returns {Model} The newly created model.\n *\n * @example\n * // Example 1. Create a model from a glTF asset\n * var model = scene.primitives.add(Cesium.Model.fromGltf({\n *   url : \'./duck/duck.gltf\'\n * }));\n *\n * @example\n * // Example 2. Create model and provide all properties and events\n * var origin = Cesium.Cartesian3.fromDegrees(-95.0, 40.0, 200000.0);\n * var modelMatrix = Cesium.Transforms.eastNorthUpToFixedFrame(origin);\n *\n * var model = scene.primitives.add(Cesium.Model.fromGltf({\n *   url : \'./duck/duck.gltf\',\n *   show : true,                     // default\n *   modelMatrix : modelMatrix,\n *   scale : 2.0,                     // double size\n *   minimumPixelSize : 128,          // never smaller than 128 pixels\n *   maximumScale: 20000,             // never larger than 20000 * model size (overrides minimumPixelSize)\n *   allowPicking : false,            // not pickable\n *   debugShowBoundingVolume : false, // default\n *   debugWireframe : false\n * }));\n *\n * model.readyPromise.then(function(model) {\n *   // Play all animations when the model is ready to render\n *   model.activeAnimations.addAll();\n * });\n */\nModel.fromGltf = function (options) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(options) || !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(options.url)) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z("options.url is required");\n  }\n  //>>includeEnd(\'debug\');\n\n  var url = options.url;\n  options = (0,_Core_clone_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(options);\n\n  // Create resource for the model file\n  var modelResource = _Core_Resource_js__WEBPACK_IMPORTED_MODULE_28__/* ["default"].createIfNeeded */ .Z.createIfNeeded(url);\n\n  // Setup basePath to get dependent files\n  var basePath = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(options.basePath, modelResource.clone());\n  var resource = _Core_Resource_js__WEBPACK_IMPORTED_MODULE_28__/* ["default"].createIfNeeded */ .Z.createIfNeeded(basePath);\n\n  // If no cache key is provided, use a GUID.\n  // Check using a URI to GUID dictionary that we have not already added this model.\n  var cacheKey = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(\n    options.cacheKey,\n    uriToGuid[(0,_Core_getAbsoluteUri_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(modelResource.url)]\n  );\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(cacheKey)) {\n    cacheKey = (0,_Core_createGuid_js__WEBPACK_IMPORTED_MODULE_75__/* ["default"] */ .Z)();\n    uriToGuid[(0,_Core_getAbsoluteUri_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(modelResource.url)] = cacheKey;\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(options.basePath) && !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(options.cacheKey)) {\n    cacheKey += resource.url;\n  }\n  options.cacheKey = cacheKey;\n  options.basePath = resource;\n\n  var model = new Model(options);\n\n  var cachedGltf = gltfCache[cacheKey];\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(cachedGltf)) {\n    cachedGltf = new CachedGltf({\n      ready: false,\n    });\n    cachedGltf.count = 1;\n    cachedGltf.modelsToLoad.push(model);\n    setCachedGltf(model, cachedGltf);\n    gltfCache[cacheKey] = cachedGltf;\n\n    // Add Accept header if we need it\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(modelResource.headers.Accept)) {\n      modelResource.headers.Accept = defaultModelAccept;\n    }\n\n    modelResource\n      .fetchArrayBuffer()\n      .then(function (arrayBuffer) {\n        var array = new Uint8Array(arrayBuffer);\n        if (containsGltfMagic(array)) {\n          // Load binary glTF\n          var parsedGltf = (0,_GltfPipeline_parseGlb_js__WEBPACK_IMPORTED_MODULE_47__/* ["default"] */ .Z)(array);\n          cachedGltf.makeReady(parsedGltf);\n        } else {\n          // Load text (JSON) glTF\n          var json = (0,_Core_getJsonFromTypedArray_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z)(array);\n          cachedGltf.makeReady(json);\n        }\n\n        var resourceCredits = model._resourceCredits;\n        var credits = modelResource.credits;\n        if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(credits)) {\n          var length = credits.length;\n          for (var i = 0; i < length; i++) {\n            resourceCredits.push(credits[i]);\n          }\n        }\n      })\n      .otherwise(\n        _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].getFailedLoadFunction */ .Z.getFailedLoadFunction(model, "model", modelResource.url)\n      );\n  } else if (!cachedGltf.ready) {\n    // Cache hit but the fetchArrayBuffer() or fetchText() request is still pending\n    ++cachedGltf.count;\n    cachedGltf.modelsToLoad.push(model);\n  }\n  // else if the cached glTF is defined and ready, the\n  // model constructor will pick it up using the cache key.\n\n  return model;\n};\n\n/**\n * For the unit tests to verify model caching.\n *\n * @private\n */\nModel._gltfCache = gltfCache;\n\nfunction getRuntime(model, runtimeName, name) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  if (model._state !== ModelState.LOADED) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z(\n      "The model is not loaded.  Use Model.readyPromise or wait for Model.ready to be true."\n    );\n  }\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(name)) {\n    throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z("name is required.");\n  }\n  //>>includeEnd(\'debug\');\n\n  return model._runtime[runtimeName][name];\n}\n\n/**\n * Returns the glTF node with the given <code>name</code> property.  This is used to\n * modify a node\'s transform for animation outside of glTF animations.\n *\n * @param {String} name The glTF name of the node.\n * @returns {ModelNode} The node or <code>undefined</code> if no node with <code>name</code> exists.\n *\n * @exception {DeveloperError} The model is not loaded.  Use Model.readyPromise or wait for Model.ready to be true.\n *\n * @example\n * // Apply non-uniform scale to node LOD3sp\n * var node = model.getNode(\'LOD3sp\');\n * node.matrix = Cesium.Matrix4.fromScale(new Cesium.Cartesian3(5.0, 1.0, 1.0), node.matrix);\n */\nModel.prototype.getNode = function (name) {\n  var node = getRuntime(this, "nodesByName", name);\n  return (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(node) ? node.publicNode : undefined;\n};\n\n/**\n * Returns the glTF mesh with the given <code>name</code> property.\n *\n * @param {String} name The glTF name of the mesh.\n *\n * @returns {ModelMesh} The mesh or <code>undefined</code> if no mesh with <code>name</code> exists.\n *\n * @exception {DeveloperError} The model is not loaded.  Use Model.readyPromise or wait for Model.ready to be true.\n */\nModel.prototype.getMesh = function (name) {\n  return getRuntime(this, "meshesByName", name);\n};\n\n/**\n * Returns the glTF material with the given <code>name</code> property.\n *\n * @param {String} name The glTF name of the material.\n * @returns {ModelMaterial} The material or <code>undefined</code> if no material with <code>name</code> exists.\n *\n * @exception {DeveloperError} The model is not loaded.  Use Model.readyPromise or wait for Model.ready to be true.\n */\nModel.prototype.getMaterial = function (name) {\n  return getRuntime(this, "materialsByName", name);\n};\n\n/**\n * Sets the current value of an articulation stage.  After setting one or multiple stage values, call\n * Model.applyArticulations() to cause the node matrices to be recalculated.\n *\n * @param {String} articulationStageKey The name of the articulation, a space, and the name of the stage.\n * @param {Number} value The numeric value of this stage of the articulation.\n *\n * @exception {DeveloperError} The model is not loaded.  Use Model.readyPromise or wait for Model.ready to be true.\n *\n * @see Model#applyArticulations\n */\nModel.prototype.setArticulationStage = function (articulationStageKey, value) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].typeOf.number */ .Z.typeOf.number("value", value);\n  //>>includeEnd(\'debug\');\n\n  var stage = getRuntime(this, "stagesByKey", articulationStageKey);\n  var articulation = getRuntime(\n    this,\n    "articulationsByStageKey",\n    articulationStageKey\n  );\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(stage) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(articulation)) {\n    value = _Core_Math_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].clamp */ .Z.clamp(value, stage.minimumValue, stage.maximumValue);\n    if (\n      !_Core_Math_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].equalsEpsilon */ .Z.equalsEpsilon(stage.currentValue, value, articulationEpsilon)\n    ) {\n      stage.currentValue = value;\n      articulation.isDirty = true;\n    }\n  }\n};\n\nvar scratchArticulationCartesian = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\nvar scratchArticulationRotation = new _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z();\n\n/**\n * Modifies a Matrix4 by applying a transformation for a given value of a stage.  Note this is different usage\n * from the typical <code>result</code> parameter, in that the incoming value of <code>result</code> is\n * meaningful.  Various stages of an articulation can be multiplied together, so their\n * transformations are all merged into a composite Matrix4 representing them all.\n *\n * @param {object} stage The stage of an articulation that is being evaluated.\n * @param {Matrix4} result The matrix to be modified.\n * @returns {Matrix4} A matrix transformed as requested by the articulation stage.\n *\n * @private\n */\nfunction applyArticulationStageMatrix(stage, result) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].typeOf.object */ .Z.typeOf.object("stage", stage);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].typeOf.object */ .Z.typeOf.object("result", result);\n  //>>includeEnd(\'debug\');\n\n  var value = stage.currentValue;\n  var cartesian = scratchArticulationCartesian;\n  var rotation;\n  switch (stage.type) {\n    case "xRotate":\n      rotation = _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].fromRotationX */ .Z.fromRotationX(\n        _Core_Math_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].toRadians */ .Z.toRadians(value),\n        scratchArticulationRotation\n      );\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyByMatrix3 */ .Z.multiplyByMatrix3(result, rotation, result);\n      break;\n    case "yRotate":\n      rotation = _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].fromRotationY */ .Z.fromRotationY(\n        _Core_Math_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].toRadians */ .Z.toRadians(value),\n        scratchArticulationRotation\n      );\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyByMatrix3 */ .Z.multiplyByMatrix3(result, rotation, result);\n      break;\n    case "zRotate":\n      rotation = _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].fromRotationZ */ .Z.fromRotationZ(\n        _Core_Math_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].toRadians */ .Z.toRadians(value),\n        scratchArticulationRotation\n      );\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyByMatrix3 */ .Z.multiplyByMatrix3(result, rotation, result);\n      break;\n    case "xTranslate":\n      cartesian.x = value;\n      cartesian.y = 0.0;\n      cartesian.z = 0.0;\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyByTranslation */ .Z.multiplyByTranslation(result, cartesian, result);\n      break;\n    case "yTranslate":\n      cartesian.x = 0.0;\n      cartesian.y = value;\n      cartesian.z = 0.0;\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyByTranslation */ .Z.multiplyByTranslation(result, cartesian, result);\n      break;\n    case "zTranslate":\n      cartesian.x = 0.0;\n      cartesian.y = 0.0;\n      cartesian.z = value;\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyByTranslation */ .Z.multiplyByTranslation(result, cartesian, result);\n      break;\n    case "xScale":\n      cartesian.x = value;\n      cartesian.y = 1.0;\n      cartesian.z = 1.0;\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyByScale */ .Z.multiplyByScale(result, cartesian, result);\n      break;\n    case "yScale":\n      cartesian.x = 1.0;\n      cartesian.y = value;\n      cartesian.z = 1.0;\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyByScale */ .Z.multiplyByScale(result, cartesian, result);\n      break;\n    case "zScale":\n      cartesian.x = 1.0;\n      cartesian.y = 1.0;\n      cartesian.z = value;\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyByScale */ .Z.multiplyByScale(result, cartesian, result);\n      break;\n    case "uniformScale":\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyByUniformScale */ .Z.multiplyByUniformScale(result, value, result);\n      break;\n    default:\n      break;\n  }\n  return result;\n}\n\nvar scratchApplyArticulationTransform = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\n\n/**\n * Applies any modified articulation stages to the matrix of each node that participates\n * in any articulation.  Note that this will overwrite any nodeTransformations on participating nodes.\n *\n * @exception {DeveloperError} The model is not loaded.  Use Model.readyPromise or wait for Model.ready to be true.\n */\nModel.prototype.applyArticulations = function () {\n  var articulationsByName = this._runtime.articulationsByName;\n  for (var articulationName in articulationsByName) {\n    if (articulationsByName.hasOwnProperty(articulationName)) {\n      var articulation = articulationsByName[articulationName];\n      if (articulation.isDirty) {\n        articulation.isDirty = false;\n        var numNodes = articulation.nodes.length;\n        for (var n = 0; n < numNodes; ++n) {\n          var node = articulation.nodes[n];\n          var transform = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].clone */ .Z.clone(\n            node.originalMatrix,\n            scratchApplyArticulationTransform\n          );\n\n          var numStages = articulation.stages.length;\n          for (var s = 0; s < numStages; ++s) {\n            var stage = articulation.stages[s];\n            transform = applyArticulationStageMatrix(stage, transform);\n          }\n          node.matrix = transform;\n        }\n      }\n    }\n  }\n};\n\n///////////////////////////////////////////////////////////////////////////\n\nfunction addBuffersToLoadResources(model) {\n  var gltf = model.gltf;\n  var loadResources = model._loadResources;\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].buffer */ .Z.buffer(gltf, function (buffer, id) {\n    loadResources.buffers[id] = buffer.extras._pipeline.source;\n  });\n}\n\nfunction bufferLoad(model, id) {\n  return function (arrayBuffer) {\n    var loadResources = model._loadResources;\n    var buffer = new Uint8Array(arrayBuffer);\n    --loadResources.pendingBufferLoads;\n    model.gltf.buffers[id].extras._pipeline.source = buffer;\n  };\n}\n\nfunction parseBufferViews(model) {\n  var bufferViews = model.gltf.bufferViews;\n  var vertexBuffersToCreate = model._loadResources.vertexBuffersToCreate;\n\n  // Only ARRAY_BUFFER here.  ELEMENT_ARRAY_BUFFER created below.\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].bufferView */ .Z.bufferView(model.gltf, function (bufferView, id) {\n    if (bufferView.target === _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].ARRAY_BUFFER */ .Z.ARRAY_BUFFER) {\n      vertexBuffersToCreate.enqueue(id);\n    }\n  });\n\n  var indexBuffersToCreate = model._loadResources.indexBuffersToCreate;\n  var indexBufferIds = {};\n\n  // The Cesium Renderer requires knowing the datatype for an index buffer\n  // at creation type, which is not part of the glTF bufferview so loop\n  // through glTF accessors to create the bufferview\'s index buffer.\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].accessor */ .Z.accessor(model.gltf, function (accessor) {\n    var bufferViewId = accessor.bufferView;\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(bufferViewId)) {\n      return;\n    }\n\n    var bufferView = bufferViews[bufferViewId];\n    if (\n      bufferView.target === _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].ELEMENT_ARRAY_BUFFER */ .Z.ELEMENT_ARRAY_BUFFER &&\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(indexBufferIds[bufferViewId])\n    ) {\n      indexBufferIds[bufferViewId] = true;\n      indexBuffersToCreate.enqueue({\n        id: bufferViewId,\n        componentType: accessor.componentType,\n      });\n    }\n  });\n}\n\nfunction parseTechniques(model) {\n  // retain references to gltf techniques\n  var gltf = model.gltf;\n  if (!(0,_GltfPipeline_usesExtension_js__WEBPACK_IMPORTED_MODULE_76__/* ["default"] */ .Z)(gltf, "KHR_techniques_webgl")) {\n    return;\n  }\n\n  var sourcePrograms = model._sourcePrograms;\n  var sourceTechniques = model._sourceTechniques;\n  var programs = gltf.extensions.KHR_techniques_webgl.programs;\n\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].technique */ .Z.technique(gltf, function (technique, techniqueId) {\n    sourceTechniques[techniqueId] = (0,_Core_clone_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(technique);\n\n    var programId = technique.program;\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(sourcePrograms[programId])) {\n      sourcePrograms[programId] = (0,_Core_clone_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(programs[programId]);\n    }\n  });\n}\n\nfunction shaderLoad(model, type, id) {\n  return function (source) {\n    var loadResources = model._loadResources;\n    loadResources.shaders[id] = {\n      source: source,\n      type: type,\n      bufferView: undefined,\n    };\n    --loadResources.pendingShaderLoads;\n    model._rendererResources.sourceShaders[id] = source;\n  };\n}\n\nfunction parseShaders(model) {\n  var gltf = model.gltf;\n  var buffers = gltf.buffers;\n  var bufferViews = gltf.bufferViews;\n  var sourceShaders = model._rendererResources.sourceShaders;\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].shader */ .Z.shader(gltf, function (shader, id) {\n    // Shader references either uri (external or base64-encoded) or bufferView\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(shader.bufferView)) {\n      var bufferViewId = shader.bufferView;\n      var bufferView = bufferViews[bufferViewId];\n      var bufferId = bufferView.buffer;\n      var buffer = buffers[bufferId];\n      var source = (0,_Core_getStringFromTypedArray_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(\n        buffer.extras._pipeline.source,\n        bufferView.byteOffset,\n        bufferView.byteLength\n      );\n      sourceShaders[id] = source;\n    } else if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(shader.extras._pipeline.source)) {\n      sourceShaders[id] = shader.extras._pipeline.source;\n    } else {\n      ++model._loadResources.pendingShaderLoads;\n\n      var shaderResource = model._resource.getDerivedResource({\n        url: shader.uri,\n      });\n\n      shaderResource\n        .fetchText()\n        .then(shaderLoad(model, shader.type, id))\n        .otherwise(\n          _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].getFailedLoadFunction */ .Z.getFailedLoadFunction(\n            model,\n            "shader",\n            shaderResource.url\n          )\n        );\n    }\n  });\n}\n\nfunction parsePrograms(model) {\n  var sourceTechniques = model._sourceTechniques;\n  for (var techniqueId in sourceTechniques) {\n    if (sourceTechniques.hasOwnProperty(techniqueId)) {\n      var technique = sourceTechniques[techniqueId];\n      model._loadResources.programsToCreate.enqueue({\n        programId: technique.program,\n        techniqueId: techniqueId,\n      });\n    }\n  }\n}\n\nfunction parseArticulations(model) {\n  var articulationsByName = {};\n  var articulationsByStageKey = {};\n  var runtimeStagesByKey = {};\n\n  model._runtime.articulationsByName = articulationsByName;\n  model._runtime.articulationsByStageKey = articulationsByStageKey;\n  model._runtime.stagesByKey = runtimeStagesByKey;\n\n  var gltf = model.gltf;\n  if (\n    !(0,_GltfPipeline_usesExtension_js__WEBPACK_IMPORTED_MODULE_76__/* ["default"] */ .Z)(gltf, "AGI_articulations") ||\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(gltf.extensions) ||\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(gltf.extensions.AGI_articulations)\n  ) {\n    return;\n  }\n\n  var gltfArticulations = gltf.extensions.AGI_articulations.articulations;\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(gltfArticulations)) {\n    return;\n  }\n\n  var numArticulations = gltfArticulations.length;\n  for (var i = 0; i < numArticulations; ++i) {\n    var articulation = (0,_Core_clone_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(gltfArticulations[i]);\n    articulation.nodes = [];\n    articulation.isDirty = true;\n    articulationsByName[articulation.name] = articulation;\n\n    var numStages = articulation.stages.length;\n    for (var s = 0; s < numStages; ++s) {\n      var stage = articulation.stages[s];\n      stage.currentValue = stage.initialValue;\n\n      var stageKey = articulation.name + " " + stage.name;\n      articulationsByStageKey[stageKey] = articulation;\n      runtimeStagesByKey[stageKey] = stage;\n    }\n  }\n}\n\nfunction imageLoad(model, textureId) {\n  return function (image) {\n    var loadResources = model._loadResources;\n    --loadResources.pendingTextureLoads;\n\n    // Images transcoded from KTX2 can contain multiple mip levels:\n    // https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_basisu\n    var mipLevels;\n    if (Array.isArray(image)) {\n      // highest detail mip should be level 0\n      mipLevels = image.slice(1, image.length).map(function (mipLevel) {\n        return mipLevel.bufferView;\n      });\n      image = image[0];\n    }\n\n    loadResources.texturesToCreate.enqueue({\n      id: textureId,\n      image: image,\n      bufferView: image.bufferView,\n      width: image.width,\n      height: image.height,\n      internalFormat: image.internalFormat,\n      mipLevels: mipLevels,\n    });\n  };\n}\n\nvar ktx2Regex = /(^data:image\\/ktx2)|(\\.ktx2$)/i;\n\nfunction parseTextures(model, context, supportsWebP) {\n  var gltf = model.gltf;\n  var images = gltf.images;\n  var uri;\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].texture */ .Z.texture(gltf, function (texture, id) {\n    var imageId = texture.source;\n\n    if (\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(texture.extensions) &&\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(texture.extensions.EXT_texture_webp) &&\n      supportsWebP\n    ) {\n      imageId = texture.extensions.EXT_texture_webp.source;\n    } else if (\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(texture.extensions) &&\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(texture.extensions.KHR_texture_basisu) &&\n      context.supportsBasis\n    ) {\n      imageId = texture.extensions.KHR_texture_basisu.source;\n    }\n\n    var gltfImage = images[imageId];\n\n    var bufferViewId = gltfImage.bufferView;\n    var mimeType = gltfImage.mimeType;\n    uri = gltfImage.uri;\n\n    // Image references either uri (external or base64-encoded) or bufferView\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(bufferViewId)) {\n      model._loadResources.texturesToCreateFromBufferView.enqueue({\n        id: id,\n        image: undefined,\n        bufferView: bufferViewId,\n        mimeType: mimeType,\n      });\n    } else {\n      ++model._loadResources.pendingTextureLoads;\n\n      var imageResource = model._resource.getDerivedResource({\n        url: uri,\n      });\n\n      var promise;\n      if (ktx2Regex.test(uri)) {\n        promise = (0,_Core_loadKTX2_js__WEBPACK_IMPORTED_MODULE_21__/* ["default"] */ .Z)(imageResource);\n      } else {\n        promise = imageResource.fetchImage({\n          skipColorSpaceConversion: true,\n          preferImageBitmap: true,\n        });\n      }\n      promise\n        .then(imageLoad(model, id, imageId))\n        .otherwise(\n          _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].getFailedLoadFunction */ .Z.getFailedLoadFunction(model, "image", imageResource.url)\n        );\n    }\n  });\n}\n\nvar scratchArticulationStageInitialTransform = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\n\nfunction parseNodes(model) {\n  var runtimeNodes = {};\n  var runtimeNodesByName = {};\n  var skinnedNodes = [];\n\n  var skinnedNodesIds = model._loadResources.skinnedNodesIds;\n  var articulationsByName = model._runtime.articulationsByName;\n\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].node */ .Z.node(model.gltf, function (node, id) {\n    var runtimeNode = {\n      // Animation targets\n      matrix: undefined,\n      translation: undefined,\n      rotation: undefined,\n      scale: undefined,\n\n      // Per-node show inherited from parent\n      computedShow: true,\n\n      // Computed transforms\n      transformToRoot: new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z(),\n      computedMatrix: new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z(),\n      dirtyNumber: 0, // The frame this node was made dirty by an animation; for graph traversal\n\n      // Rendering\n      commands: [], // empty for transform, light, and camera nodes\n\n      // Skinned node\n      inverseBindMatrices: undefined, // undefined when node is not skinned\n      bindShapeMatrix: undefined, // undefined when node is not skinned or identity\n      joints: [], // empty when node is not skinned\n      computedJointMatrices: [], // empty when node is not skinned\n\n      // Joint node\n      jointName: node.jointName, // undefined when node is not a joint\n\n      weights: [],\n\n      // Graph pointers\n      children: [], // empty for leaf nodes\n      parents: [], // empty for root nodes\n\n      // Publicly-accessible ModelNode instance to modify animation targets\n      publicNode: undefined,\n    };\n    runtimeNode.publicNode = new _ModelNode_js__WEBPACK_IMPORTED_MODULE_65__/* ["default"] */ .Z(\n      model,\n      node,\n      runtimeNode,\n      id,\n      _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].getTransform */ .Z.getTransform(node)\n    );\n\n    runtimeNodes[id] = runtimeNode;\n    runtimeNodesByName[node.name] = runtimeNode;\n\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(node.skin)) {\n      skinnedNodesIds.push(id);\n      skinnedNodes.push(runtimeNode);\n    }\n\n    if (\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(node.extensions) &&\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(node.extensions.AGI_articulations)\n    ) {\n      var articulationName = node.extensions.AGI_articulations.articulationName;\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(articulationName)) {\n        var transform = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].clone */ .Z.clone(\n          runtimeNode.publicNode.originalMatrix,\n          scratchArticulationStageInitialTransform\n        );\n        var articulation = articulationsByName[articulationName];\n        articulation.nodes.push(runtimeNode.publicNode);\n\n        var numStages = articulation.stages.length;\n        for (var s = 0; s < numStages; ++s) {\n          var stage = articulation.stages[s];\n          transform = applyArticulationStageMatrix(stage, transform);\n        }\n        runtimeNode.publicNode.matrix = transform;\n      }\n    }\n  });\n\n  model._runtime.nodes = runtimeNodes;\n  model._runtime.nodesByName = runtimeNodesByName;\n  model._runtime.skinnedNodes = skinnedNodes;\n}\n\nfunction parseMaterials(model) {\n  var gltf = model.gltf;\n  var techniques = model._sourceTechniques;\n\n  var runtimeMaterialsByName = {};\n  var runtimeMaterialsById = {};\n  var uniformMaps = model._uniformMaps;\n\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].material */ .Z.material(gltf, function (material, materialId) {\n    // Allocated now so ModelMaterial can keep a reference to it.\n    uniformMaps[materialId] = {\n      uniformMap: undefined,\n      values: undefined,\n      jointMatrixUniformName: undefined,\n      morphWeightsUniformName: undefined,\n    };\n\n    var modelMaterial = new _ModelMaterial_js__WEBPACK_IMPORTED_MODULE_63__/* ["default"] */ .Z(model, material, materialId);\n\n    if (\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(material.extensions) &&\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(material.extensions.KHR_techniques_webgl)\n    ) {\n      var techniqueId = material.extensions.KHR_techniques_webgl.technique;\n      modelMaterial._technique = techniqueId;\n      modelMaterial._program = techniques[techniqueId].program;\n\n      _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].materialValue */ .Z.materialValue(material, function (value, uniformName) {\n        if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(modelMaterial._values)) {\n          modelMaterial._values = {};\n        }\n\n        modelMaterial._values[uniformName] = (0,_Core_clone_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(value);\n      });\n    }\n\n    runtimeMaterialsByName[material.name] = modelMaterial;\n    runtimeMaterialsById[materialId] = modelMaterial;\n  });\n\n  model._runtime.materialsByName = runtimeMaterialsByName;\n  model._runtime.materialsById = runtimeMaterialsById;\n}\n\nfunction parseMeshes(model) {\n  var runtimeMeshesByName = {};\n  var runtimeMaterialsById = model._runtime.materialsById;\n\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].mesh */ .Z.mesh(model.gltf, function (mesh, meshId) {\n    runtimeMeshesByName[mesh.name] = new _ModelMesh_js__WEBPACK_IMPORTED_MODULE_64__/* ["default"] */ .Z(\n      mesh,\n      runtimeMaterialsById,\n      meshId\n    );\n    if (\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model.extensionsUsed.WEB3D_quantized_attributes) ||\n      model._dequantizeInShader\n    ) {\n      // Cache primitives according to their program\n      _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].meshPrimitive */ .Z.meshPrimitive(mesh, function (primitive, primitiveId) {\n        var programId = getProgramForPrimitive(model, primitive);\n        var programPrimitives = model._programPrimitives[programId];\n        if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(programPrimitives)) {\n          programPrimitives = {};\n          model._programPrimitives[programId] = programPrimitives;\n        }\n        programPrimitives[meshId + ".primitive." + primitiveId] = primitive;\n      });\n    }\n  });\n\n  model._runtime.meshesByName = runtimeMeshesByName;\n}\n\n///////////////////////////////////////////////////////////////////////////\n\nvar CreateVertexBufferJob = function () {\n  this.id = undefined;\n  this.model = undefined;\n  this.context = undefined;\n};\n\nCreateVertexBufferJob.prototype.set = function (id, model, context) {\n  this.id = id;\n  this.model = model;\n  this.context = context;\n};\n\nCreateVertexBufferJob.prototype.execute = function () {\n  createVertexBuffer(this.id, this.model, this.context);\n};\n\n///////////////////////////////////////////////////////////////////////////\n\nfunction createVertexBuffer(bufferViewId, model, context) {\n  var loadResources = model._loadResources;\n  var bufferViews = model.gltf.bufferViews;\n  var bufferView = bufferViews[bufferViewId];\n\n  // Use bufferView created at runtime\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(bufferView)) {\n    bufferView = loadResources.createdBufferViews[bufferViewId];\n  }\n\n  var vertexBuffer = _Renderer_Buffer_js__WEBPACK_IMPORTED_MODULE_31__/* ["default"].createVertexBuffer */ .Z.createVertexBuffer({\n    context: context,\n    typedArray: loadResources.getBuffer(bufferView),\n    usage: _Renderer_BufferUsage_js__WEBPACK_IMPORTED_MODULE_32__/* ["default"].STATIC_DRAW */ .Z.STATIC_DRAW,\n  });\n  vertexBuffer.vertexArrayDestroyable = false;\n  model._rendererResources.buffers[bufferViewId] = vertexBuffer;\n  model._geometryByteLength += vertexBuffer.sizeInBytes;\n}\n\n///////////////////////////////////////////////////////////////////////////\n\nvar CreateIndexBufferJob = function () {\n  this.id = undefined;\n  this.componentType = undefined;\n  this.model = undefined;\n  this.context = undefined;\n};\n\nCreateIndexBufferJob.prototype.set = function (\n  id,\n  componentType,\n  model,\n  context\n) {\n  this.id = id;\n  this.componentType = componentType;\n  this.model = model;\n  this.context = context;\n};\n\nCreateIndexBufferJob.prototype.execute = function () {\n  createIndexBuffer(this.id, this.componentType, this.model, this.context);\n};\n\n///////////////////////////////////////////////////////////////////////////\n\nfunction createIndexBuffer(bufferViewId, componentType, model, context) {\n  var loadResources = model._loadResources;\n  var bufferViews = model.gltf.bufferViews;\n  var bufferView = bufferViews[bufferViewId];\n\n  // Use bufferView created at runtime\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(bufferView)) {\n    bufferView = loadResources.createdBufferViews[bufferViewId];\n  }\n\n  var indexBuffer = _Renderer_Buffer_js__WEBPACK_IMPORTED_MODULE_31__/* ["default"].createIndexBuffer */ .Z.createIndexBuffer({\n    context: context,\n    typedArray: loadResources.getBuffer(bufferView),\n    usage: _Renderer_BufferUsage_js__WEBPACK_IMPORTED_MODULE_32__/* ["default"].STATIC_DRAW */ .Z.STATIC_DRAW,\n    indexDatatype: componentType,\n  });\n  indexBuffer.vertexArrayDestroyable = false;\n  model._rendererResources.buffers[bufferViewId] = indexBuffer;\n  model._geometryByteLength += indexBuffer.sizeInBytes;\n}\n\nvar scratchVertexBufferJob = new CreateVertexBufferJob();\nvar scratchIndexBufferJob = new CreateIndexBufferJob();\n\nfunction createBuffers(model, frameState) {\n  var loadResources = model._loadResources;\n\n  if (loadResources.pendingBufferLoads !== 0) {\n    return;\n  }\n\n  var context = frameState.context;\n  var vertexBuffersToCreate = loadResources.vertexBuffersToCreate;\n  var indexBuffersToCreate = loadResources.indexBuffersToCreate;\n  var i;\n\n  if (model.asynchronous) {\n    while (vertexBuffersToCreate.length > 0) {\n      scratchVertexBufferJob.set(vertexBuffersToCreate.peek(), model, context);\n      if (\n        !frameState.jobScheduler.execute(scratchVertexBufferJob, _JobType_js__WEBPACK_IMPORTED_MODULE_59__/* ["default"].BUFFER */ .Z.BUFFER)\n      ) {\n        break;\n      }\n      vertexBuffersToCreate.dequeue();\n    }\n\n    while (indexBuffersToCreate.length > 0) {\n      i = indexBuffersToCreate.peek();\n      scratchIndexBufferJob.set(i.id, i.componentType, model, context);\n      if (\n        !frameState.jobScheduler.execute(scratchIndexBufferJob, _JobType_js__WEBPACK_IMPORTED_MODULE_59__/* ["default"].BUFFER */ .Z.BUFFER)\n      ) {\n        break;\n      }\n      indexBuffersToCreate.dequeue();\n    }\n  } else {\n    while (vertexBuffersToCreate.length > 0) {\n      createVertexBuffer(vertexBuffersToCreate.dequeue(), model, context);\n    }\n\n    while (indexBuffersToCreate.length > 0) {\n      i = indexBuffersToCreate.dequeue();\n      createIndexBuffer(i.id, i.componentType, model, context);\n    }\n  }\n}\n\nfunction getProgramForPrimitive(model, primitive) {\n  var material = model._runtime.materialsById[primitive.material];\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(material)) {\n    return;\n  }\n\n  return material._program;\n}\n\nfunction modifyShaderForQuantizedAttributes(shader, programName, model) {\n  var primitive;\n  var primitives = model._programPrimitives[programName];\n\n  // If no primitives were cached for this program, there\'s no need to modify the shader\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(primitives)) {\n    return shader;\n  }\n\n  var primitiveId;\n  for (primitiveId in primitives) {\n    if (primitives.hasOwnProperty(primitiveId)) {\n      primitive = primitives[primitiveId];\n      if (getProgramForPrimitive(model, primitive) === programName) {\n        break;\n      }\n    }\n  }\n\n  // This is not needed after the program is processed, free the memory\n  model._programPrimitives[programName] = undefined;\n\n  var result;\n  if (model.extensionsUsed.WEB3D_quantized_attributes) {\n    result = _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].modifyShaderForQuantizedAttributes */ .Z.modifyShaderForQuantizedAttributes(\n      model.gltf,\n      primitive,\n      shader\n    );\n    model._quantizedUniforms[programName] = result.uniforms;\n  } else {\n    var decodedData = model._decodedData[primitiveId];\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(decodedData)) {\n      result = _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].modifyShaderForDracoQuantizedAttributes */ .Z.modifyShaderForDracoQuantizedAttributes(\n        model.gltf,\n        primitive,\n        shader,\n        decodedData.attributes\n      );\n    } else {\n      return shader;\n    }\n  }\n\n  return result.shader;\n}\n\nfunction modifyShaderForColor(shader) {\n  shader = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_38__/* ["default"].replaceMain */ .Z.replaceMain(shader, "gltf_blend_main");\n  shader +=\n    "uniform vec4 gltf_color; \\n" +\n    "uniform float gltf_colorBlend; \\n" +\n    "void main() \\n" +\n    "{ \\n" +\n    "    gltf_blend_main(); \\n" +\n    "    gl_FragColor.rgb = mix(gl_FragColor.rgb, gltf_color.rgb, gltf_colorBlend); \\n" +\n    "    float highlight = ceil(gltf_colorBlend); \\n" +\n    "    gl_FragColor.rgb *= mix(gltf_color.rgb, vec3(1.0), highlight); \\n" +\n    "    gl_FragColor.a *= gltf_color.a; \\n" +\n    "} \\n";\n\n  return shader;\n}\n\nfunction modifyShader(shader, programName, callback) {\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(callback)) {\n    shader = callback(shader, programName);\n  }\n  return shader;\n}\n\nvar CreateProgramJob = function () {\n  this.programToCreate = undefined;\n  this.model = undefined;\n  this.context = undefined;\n};\n\nCreateProgramJob.prototype.set = function (programToCreate, model, context) {\n  this.programToCreate = programToCreate;\n  this.model = model;\n  this.context = context;\n};\n\nCreateProgramJob.prototype.execute = function () {\n  createProgram(this.programToCreate, this.model, this.context);\n};\n\n///////////////////////////////////////////////////////////////////////////\n\n// When building programs for the first time, do not include modifiers for clipping planes and color\n// since this is the version of the program that will be cached for use with other Models.\nfunction createProgram(programToCreate, model, context) {\n  var programId = programToCreate.programId;\n  var techniqueId = programToCreate.techniqueId;\n  var program = model._sourcePrograms[programId];\n  var shaders = model._rendererResources.sourceShaders;\n\n  var vs = shaders[program.vertexShader];\n  var fs = shaders[program.fragmentShader];\n\n  var quantizedVertexShaders = model._quantizedVertexShaders;\n\n  if (\n    model.extensionsUsed.WEB3D_quantized_attributes ||\n    model._dequantizeInShader\n  ) {\n    var quantizedVS = quantizedVertexShaders[programId];\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(quantizedVS)) {\n      quantizedVS = modifyShaderForQuantizedAttributes(vs, programId, model);\n      quantizedVertexShaders[programId] = quantizedVS;\n    }\n    vs = quantizedVS;\n  }\n\n  var drawVS = modifyShader(vs, programId, model._vertexShaderLoaded);\n  var drawFS = modifyShader(fs, programId, model._fragmentShaderLoaded);\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._uniformMapLoaded)) {\n    drawFS = "uniform vec4 czm_pickColor;\\n" + drawFS;\n  }\n\n  var useIBL =\n    model._imageBasedLightingFactor.x > 0.0 ||\n    model._imageBasedLightingFactor.y > 0.0;\n  if (useIBL) {\n    drawFS = "#define USE_IBL_LIGHTING \\n\\n" + drawFS;\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._lightColor)) {\n    drawFS = "#define USE_CUSTOM_LIGHT_COLOR \\n\\n" + drawFS;\n  }\n\n  if (model._sourceVersion !== "2.0" || model._sourceKHRTechniquesWebGL) {\n    drawFS = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_38__/* ["default"].replaceMain */ .Z.replaceMain(drawFS, "non_gamma_corrected_main");\n    drawFS =\n      drawFS +\n      "\\n" +\n      "void main() { \\n" +\n      "    non_gamma_corrected_main(); \\n" +\n      "    gl_FragColor = czm_gammaCorrect(gl_FragColor); \\n" +\n      "} \\n";\n  }\n\n  if (_OctahedralProjectedCubeMap_js__WEBPACK_IMPORTED_MODULE_68__/* ["default"].isSupported */ .Z.isSupported(context)) {\n    var usesSH =\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._sphericalHarmonicCoefficients) ||\n      model._useDefaultSphericalHarmonics;\n    var usesSM =\n      ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._specularEnvironmentMapAtlas) &&\n        model._specularEnvironmentMapAtlas.ready) ||\n      model._useDefaultSpecularMaps;\n    var addMatrix = usesSH || usesSM || useIBL;\n    if (addMatrix) {\n      drawFS = "uniform mat3 gltf_iblReferenceFrameMatrix; \\n" + drawFS;\n    }\n\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._sphericalHarmonicCoefficients)) {\n      drawFS =\n        "#define DIFFUSE_IBL \\n" +\n        "#define CUSTOM_SPHERICAL_HARMONICS \\n" +\n        "uniform vec3 gltf_sphericalHarmonicCoefficients[9]; \\n" +\n        drawFS;\n    } else if (model._useDefaultSphericalHarmonics) {\n      drawFS = "#define DIFFUSE_IBL \\n" + drawFS;\n    }\n\n    if (\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._specularEnvironmentMapAtlas) &&\n      model._specularEnvironmentMapAtlas.ready\n    ) {\n      drawFS =\n        "#define SPECULAR_IBL \\n" +\n        "#define CUSTOM_SPECULAR_IBL \\n" +\n        "uniform sampler2D gltf_specularMap; \\n" +\n        "uniform vec2 gltf_specularMapSize; \\n" +\n        "uniform float gltf_maxSpecularLOD; \\n" +\n        drawFS;\n    } else if (model._useDefaultSpecularMaps) {\n      drawFS = "#define SPECULAR_IBL \\n" + drawFS;\n    }\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._luminanceAtZenith)) {\n    drawFS =\n      "#define USE_SUN_LUMINANCE \\n" +\n      "uniform float gltf_luminanceAtZenith;\\n" +\n      drawFS;\n  }\n\n  createAttributesAndProgram(\n    programId,\n    techniqueId,\n    drawFS,\n    drawVS,\n    model,\n    context\n  );\n}\n\nfunction recreateProgram(programToCreate, model, context) {\n  var programId = programToCreate.programId;\n  var techniqueId = programToCreate.techniqueId;\n  var program = model._sourcePrograms[programId];\n  var shaders = model._rendererResources.sourceShaders;\n\n  var quantizedVertexShaders = model._quantizedVertexShaders;\n\n  var clippingPlaneCollection = model.clippingPlanes;\n  var addClippingPlaneCode = isClippingEnabled(model);\n\n  var vs = shaders[program.vertexShader];\n  var fs = shaders[program.fragmentShader];\n\n  if (\n    model.extensionsUsed.WEB3D_quantized_attributes ||\n    model._dequantizeInShader\n  ) {\n    vs = quantizedVertexShaders[programId];\n  }\n\n  var finalFS = fs;\n  if (isColorShadingEnabled(model)) {\n    finalFS = Model._modifyShaderForColor(finalFS);\n  }\n  if (addClippingPlaneCode) {\n    finalFS = modifyShaderForClippingPlanes(\n      finalFS,\n      clippingPlaneCollection,\n      context\n    );\n  }\n\n  var drawVS = modifyShader(vs, programId, model._vertexShaderLoaded);\n  var drawFS = modifyShader(finalFS, programId, model._fragmentShaderLoaded);\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._uniformMapLoaded)) {\n    drawFS = "uniform vec4 czm_pickColor;\\n" + drawFS;\n  }\n\n  var useIBL =\n    model._imageBasedLightingFactor.x > 0.0 ||\n    model._imageBasedLightingFactor.y > 0.0;\n  if (useIBL) {\n    drawFS = "#define USE_IBL_LIGHTING \\n\\n" + drawFS;\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._lightColor)) {\n    drawFS = "#define USE_CUSTOM_LIGHT_COLOR \\n\\n" + drawFS;\n  }\n\n  if (model._sourceVersion !== "2.0" || model._sourceKHRTechniquesWebGL) {\n    drawFS = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_38__/* ["default"].replaceMain */ .Z.replaceMain(drawFS, "non_gamma_corrected_main");\n    drawFS =\n      drawFS +\n      "\\n" +\n      "void main() { \\n" +\n      "    non_gamma_corrected_main(); \\n" +\n      "    gl_FragColor = czm_gammaCorrect(gl_FragColor); \\n" +\n      "} \\n";\n  }\n\n  if (_OctahedralProjectedCubeMap_js__WEBPACK_IMPORTED_MODULE_68__/* ["default"].isSupported */ .Z.isSupported(context)) {\n    var usesSH =\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._sphericalHarmonicCoefficients) ||\n      model._useDefaultSphericalHarmonics;\n    var usesSM =\n      ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._specularEnvironmentMapAtlas) &&\n        model._specularEnvironmentMapAtlas.ready) ||\n      model._useDefaultSpecularMaps;\n    var addMatrix = usesSH || usesSM || useIBL;\n    if (addMatrix) {\n      drawFS = "uniform mat3 gltf_iblReferenceFrameMatrix; \\n" + drawFS;\n    }\n\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._sphericalHarmonicCoefficients)) {\n      drawFS =\n        "#define DIFFUSE_IBL \\n" +\n        "#define CUSTOM_SPHERICAL_HARMONICS \\n" +\n        "uniform vec3 gltf_sphericalHarmonicCoefficients[9]; \\n" +\n        drawFS;\n    } else if (model._useDefaultSphericalHarmonics) {\n      drawFS = "#define DIFFUSE_IBL \\n" + drawFS;\n    }\n\n    if (\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._specularEnvironmentMapAtlas) &&\n      model._specularEnvironmentMapAtlas.ready\n    ) {\n      drawFS =\n        "#define SPECULAR_IBL \\n" +\n        "#define CUSTOM_SPECULAR_IBL \\n" +\n        "uniform sampler2D gltf_specularMap; \\n" +\n        "uniform vec2 gltf_specularMapSize; \\n" +\n        "uniform float gltf_maxSpecularLOD; \\n" +\n        drawFS;\n    } else if (model._useDefaultSpecularMaps) {\n      drawFS = "#define SPECULAR_IBL \\n" + drawFS;\n    }\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._luminanceAtZenith)) {\n    drawFS =\n      "#define USE_SUN_LUMINANCE \\n" +\n      "uniform float gltf_luminanceAtZenith;\\n" +\n      drawFS;\n  }\n\n  createAttributesAndProgram(\n    programId,\n    techniqueId,\n    drawFS,\n    drawVS,\n    model,\n    context\n  );\n}\n\nfunction createAttributesAndProgram(\n  programId,\n  techniqueId,\n  drawFS,\n  drawVS,\n  model,\n  context\n) {\n  var technique = model._sourceTechniques[techniqueId];\n  var attributeLocations = _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].createAttributeLocations */ .Z.createAttributeLocations(\n    technique,\n    model._precreatedAttributes\n  );\n\n  model._rendererResources.programs[programId] = _Renderer_ShaderProgram_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].fromCache */ .Z.fromCache({\n    context: context,\n    vertexShaderSource: drawVS,\n    fragmentShaderSource: drawFS,\n    attributeLocations: attributeLocations,\n  });\n}\n\nvar scratchCreateProgramJob = new CreateProgramJob();\n\nfunction createPrograms(model, frameState) {\n  var loadResources = model._loadResources;\n  var programsToCreate = loadResources.programsToCreate;\n\n  if (loadResources.pendingShaderLoads !== 0) {\n    return;\n  }\n\n  // PERFORMANCE_IDEA: this could be more fine-grained by looking\n  // at the shader\'s bufferView\'s to determine the buffer dependencies.\n  if (loadResources.pendingBufferLoads !== 0) {\n    return;\n  }\n\n  var context = frameState.context;\n\n  if (model.asynchronous) {\n    while (programsToCreate.length > 0) {\n      scratchCreateProgramJob.set(programsToCreate.peek(), model, context);\n      if (\n        !frameState.jobScheduler.execute(\n          scratchCreateProgramJob,\n          _JobType_js__WEBPACK_IMPORTED_MODULE_59__/* ["default"].PROGRAM */ .Z.PROGRAM\n        )\n      ) {\n        break;\n      }\n      programsToCreate.dequeue();\n    }\n  } else {\n    // Create all loaded programs this frame\n    while (programsToCreate.length > 0) {\n      createProgram(programsToCreate.dequeue(), model, context);\n    }\n  }\n}\n\nfunction getOnImageCreatedFromTypedArray(loadResources, gltfTexture) {\n  return function (image) {\n    loadResources.texturesToCreate.enqueue({\n      id: gltfTexture.id,\n      image: image,\n      bufferView: undefined,\n    });\n\n    --loadResources.pendingBufferViewToImage;\n  };\n}\n\nfunction loadTexturesFromBufferViews(model) {\n  var loadResources = model._loadResources;\n\n  if (loadResources.pendingBufferLoads !== 0) {\n    return;\n  }\n\n  while (loadResources.texturesToCreateFromBufferView.length > 0) {\n    var gltfTexture = loadResources.texturesToCreateFromBufferView.dequeue();\n\n    var gltf = model.gltf;\n    var bufferView = gltf.bufferViews[gltfTexture.bufferView];\n    var imageId = gltf.textures[gltfTexture.id].source;\n\n    var onerror = _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].getFailedLoadFunction */ .Z.getFailedLoadFunction(\n      model,\n      "image",\n      "id: " + gltfTexture.id + ", bufferView: " + gltfTexture.bufferView\n    );\n\n    if (gltfTexture.mimeType === "image/ktx2") {\n      // Need to make a copy of the embedded KTX2 buffer otherwise the underlying\n      // ArrayBuffer may be accessed on both the worker and the main thread and\n      // throw an error like "Cannot perform Construct on a detached ArrayBuffer".\n      // Look into SharedArrayBuffer at some point to get around this.\n      var ktxBuffer = new Uint8Array(loadResources.getBuffer(bufferView));\n      (0,_Core_loadKTX2_js__WEBPACK_IMPORTED_MODULE_21__/* ["default"] */ .Z)(ktxBuffer)\n        .then(imageLoad(model, gltfTexture.id, imageId))\n        .otherwise(onerror);\n      ++model._loadResources.pendingTextureLoads;\n    } else {\n      var onload = getOnImageCreatedFromTypedArray(loadResources, gltfTexture);\n      (0,_Core_loadImageFromTypedArray_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"] */ .Z)({\n        uint8Array: loadResources.getBuffer(bufferView),\n        format: gltfTexture.mimeType,\n        flipY: false,\n        skipColorSpaceConversion: true,\n      })\n        .then(onload)\n        .otherwise(onerror);\n      ++loadResources.pendingBufferViewToImage;\n    }\n  }\n}\n\nfunction createSamplers(model) {\n  var loadResources = model._loadResources;\n  if (loadResources.createSamplers) {\n    loadResources.createSamplers = false;\n\n    var rendererSamplers = model._rendererResources.samplers;\n    _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].sampler */ .Z.sampler(model.gltf, function (sampler, samplerId) {\n      rendererSamplers[samplerId] = new _Renderer_Sampler_js__WEBPACK_IMPORTED_MODULE_36__/* ["default"] */ .Z({\n        wrapS: sampler.wrapS,\n        wrapT: sampler.wrapT,\n        minificationFilter: sampler.minFilter,\n        magnificationFilter: sampler.magFilter,\n      });\n    });\n  }\n}\n\n///////////////////////////////////////////////////////////////////////////\n\nvar CreateTextureJob = function () {\n  this.gltfTexture = undefined;\n  this.model = undefined;\n  this.context = undefined;\n};\n\nCreateTextureJob.prototype.set = function (gltfTexture, model, context) {\n  this.gltfTexture = gltfTexture;\n  this.model = model;\n  this.context = context;\n};\n\nCreateTextureJob.prototype.execute = function () {\n  createTexture(this.gltfTexture, this.model, this.context);\n};\n\n///////////////////////////////////////////////////////////////////////////\n\nfunction createTexture(gltfTexture, model, context) {\n  var textures = model.gltf.textures;\n  var texture = textures[gltfTexture.id];\n\n  var rendererSamplers = model._rendererResources.samplers;\n  var sampler = rendererSamplers[texture.sampler];\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(sampler)) {\n    sampler = new _Renderer_Sampler_js__WEBPACK_IMPORTED_MODULE_36__/* ["default"] */ .Z({\n      wrapS: _Renderer_TextureWrap_js__WEBPACK_IMPORTED_MODULE_41__/* ["default"].REPEAT */ .Z.REPEAT,\n      wrapT: _Renderer_TextureWrap_js__WEBPACK_IMPORTED_MODULE_41__/* ["default"].REPEAT */ .Z.REPEAT,\n    });\n  }\n\n  var usesTextureTransform = false;\n  var materials = model.gltf.materials;\n  var materialsLength = materials.length;\n  for (var i = 0; i < materialsLength; ++i) {\n    var material = materials[i];\n    if (\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(material.extensions) &&\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(material.extensions.KHR_techniques_webgl)\n    ) {\n      var values = material.extensions.KHR_techniques_webgl.values;\n      for (var valueName in values) {\n        if (\n          values.hasOwnProperty(valueName) &&\n          valueName.indexOf("Texture") !== -1\n        ) {\n          var value = values[valueName];\n          if (\n            value.index === gltfTexture.id &&\n            (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(value.extensions) &&\n            (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(value.extensions.KHR_texture_transform)\n          ) {\n            usesTextureTransform = true;\n            break;\n          }\n        }\n      }\n    }\n    if (usesTextureTransform) {\n      break;\n    }\n  }\n\n  var wrapS = sampler.wrapS;\n  var wrapT = sampler.wrapT;\n  var minFilter = sampler.minificationFilter;\n\n  if (\n    usesTextureTransform &&\n    minFilter !== _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"].LINEAR */ .Z.LINEAR &&\n    minFilter !== _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"].NEAREST */ .Z.NEAREST\n  ) {\n    if (\n      minFilter === _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"].NEAREST_MIPMAP_NEAREST */ .Z.NEAREST_MIPMAP_NEAREST ||\n      minFilter === _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"].NEAREST_MIPMAP_LINEAR */ .Z.NEAREST_MIPMAP_LINEAR\n    ) {\n      minFilter = _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"].NEAREST */ .Z.NEAREST;\n    } else {\n      minFilter = _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"].LINEAR */ .Z.LINEAR;\n    }\n\n    sampler = new _Renderer_Sampler_js__WEBPACK_IMPORTED_MODULE_36__/* ["default"] */ .Z({\n      wrapS: sampler.wrapS,\n      wrapT: sampler.wrapT,\n      minificationFilter: minFilter,\n      magnificationFilter: sampler.magnificationFilter,\n    });\n  }\n\n  var internalFormat = gltfTexture.internalFormat;\n\n  var mipmap =\n    !(\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(internalFormat) && _Core_PixelFormat_js__WEBPACK_IMPORTED_MODULE_25__/* ["default"].isCompressedFormat */ .Z.isCompressedFormat(internalFormat)\n    ) &&\n    (minFilter === _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"].NEAREST_MIPMAP_NEAREST */ .Z.NEAREST_MIPMAP_NEAREST ||\n      minFilter === _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"].NEAREST_MIPMAP_LINEAR */ .Z.NEAREST_MIPMAP_LINEAR ||\n      minFilter === _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"].LINEAR_MIPMAP_NEAREST */ .Z.LINEAR_MIPMAP_NEAREST ||\n      minFilter === _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"].LINEAR_MIPMAP_LINEAR */ .Z.LINEAR_MIPMAP_LINEAR);\n  var requiresNpot =\n    mipmap ||\n    wrapS === _Renderer_TextureWrap_js__WEBPACK_IMPORTED_MODULE_41__/* ["default"].REPEAT */ .Z.REPEAT ||\n    wrapS === _Renderer_TextureWrap_js__WEBPACK_IMPORTED_MODULE_41__/* ["default"].MIRRORED_REPEAT */ .Z.MIRRORED_REPEAT ||\n    wrapT === _Renderer_TextureWrap_js__WEBPACK_IMPORTED_MODULE_41__/* ["default"].REPEAT */ .Z.REPEAT ||\n    wrapT === _Renderer_TextureWrap_js__WEBPACK_IMPORTED_MODULE_41__/* ["default"].MIRRORED_REPEAT */ .Z.MIRRORED_REPEAT;\n  var npot;\n  var tx;\n  var source = gltfTexture.image;\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(internalFormat)) {\n    npot =\n      !_Core_Math_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].isPowerOfTwo */ .Z.isPowerOfTwo(gltfTexture.width) ||\n      !_Core_Math_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].isPowerOfTwo */ .Z.isPowerOfTwo(gltfTexture.height);\n\n    // Warning to encourage power of 2 texture dimensions with KHR_texture_basisu\n    if (\n      !context.webgl2 &&\n      _Core_PixelFormat_js__WEBPACK_IMPORTED_MODULE_25__/* ["default"].isCompressedFormat */ .Z.isCompressedFormat(internalFormat) &&\n      npot &&\n      requiresNpot\n    ) {\n      console.warn(\n        "Compressed texture uses REPEAT or MIRRORED_REPEAT texture wrap mode and dimensions are not powers of two. The texture may be rendered incorrectly. See the Model.js constructor documentation for more information."\n      );\n    }\n\n    var minificationFilter;\n    if (\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(gltfTexture.mipLevels) &&\n      (minFilter === _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"].NEAREST_MIPMAP_NEAREST */ .Z.NEAREST_MIPMAP_NEAREST ||\n        minFilter === _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"].NEAREST_MIPMAP_LINEAR */ .Z.NEAREST_MIPMAP_LINEAR)\n    ) {\n      minificationFilter = _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"].NEAREST */ .Z.NEAREST;\n    } else if (\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(gltfTexture.mipLevels) &&\n      (minFilter === _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"].LINEAR_MIPMAP_NEAREST */ .Z.LINEAR_MIPMAP_NEAREST ||\n        minFilter === _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"].LINEAR_MIPMAP_LINEAR */ .Z.LINEAR_MIPMAP_LINEAR)\n    ) {\n      minificationFilter = _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_40__/* ["default"].LINEAR */ .Z.LINEAR;\n    }\n    sampler = new _Renderer_Sampler_js__WEBPACK_IMPORTED_MODULE_36__/* ["default"] */ .Z({\n      wrapS: sampler.wrapS,\n      wrapT: sampler.wrapT,\n      minificationFilter: minificationFilter,\n      magnificationFilter: sampler.magnificationFilter,\n    });\n\n    tx = new _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_39__/* ["default"] */ .Z({\n      context: context,\n      source: {\n        arrayBufferView: gltfTexture.bufferView,\n        mipLevels: gltfTexture.mipLevels,\n      },\n      width: gltfTexture.width,\n      height: gltfTexture.height,\n      pixelFormat: internalFormat,\n      sampler: sampler,\n    });\n  } else if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(source)) {\n    npot =\n      !_Core_Math_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].isPowerOfTwo */ .Z.isPowerOfTwo(source.width) ||\n      !_Core_Math_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].isPowerOfTwo */ .Z.isPowerOfTwo(source.height);\n    if (requiresNpot && npot) {\n      // WebGL requires power-of-two texture dimensions for mipmapping and REPEAT/MIRRORED_REPEAT wrap modes.\n      var canvas = document.createElement("canvas");\n      canvas.width = _Core_Math_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].nextPowerOfTwo */ .Z.nextPowerOfTwo(source.width);\n      canvas.height = _Core_Math_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].nextPowerOfTwo */ .Z.nextPowerOfTwo(source.height);\n      var canvasContext = canvas.getContext("2d");\n      canvasContext.drawImage(\n        source,\n        0,\n        0,\n        source.width,\n        source.height,\n        0,\n        0,\n        canvas.width,\n        canvas.height\n      );\n      source = canvas;\n    }\n\n    tx = new _Renderer_Texture_js__WEBPACK_IMPORTED_MODULE_39__/* ["default"] */ .Z({\n      context: context,\n      source: source,\n      pixelFormat: texture.internalFormat,\n      pixelDatatype: texture.type,\n      sampler: sampler,\n      flipY: false,\n      skipColorSpaceConversion: true,\n    });\n    // GLTF_SPEC: Support TEXTURE_CUBE_MAP.  https://github.com/KhronosGroup/glTF/issues/40\n    if (mipmap) {\n      tx.generateMipmap();\n    }\n  }\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(tx)) {\n    model._rendererResources.textures[gltfTexture.id] = tx;\n    model._texturesByteLength += tx.sizeInBytes;\n  }\n}\n\nvar scratchCreateTextureJob = new CreateTextureJob();\n\nfunction createTextures(model, frameState) {\n  var context = frameState.context;\n  var texturesToCreate = model._loadResources.texturesToCreate;\n\n  if (model.asynchronous) {\n    while (texturesToCreate.length > 0) {\n      scratchCreateTextureJob.set(texturesToCreate.peek(), model, context);\n      if (\n        !frameState.jobScheduler.execute(\n          scratchCreateTextureJob,\n          _JobType_js__WEBPACK_IMPORTED_MODULE_59__/* ["default"].TEXTURE */ .Z.TEXTURE\n        )\n      ) {\n        break;\n      }\n      texturesToCreate.dequeue();\n    }\n  } else {\n    // Create all loaded textures this frame\n    while (texturesToCreate.length > 0) {\n      createTexture(texturesToCreate.dequeue(), model, context);\n    }\n  }\n}\n\nfunction getAttributeLocations(model, primitive) {\n  var techniques = model._sourceTechniques;\n\n  // Retrieve the compiled shader program to assign index values to attributes\n  var attributeLocations = {};\n\n  var location;\n  var index;\n  var material = model._runtime.materialsById[primitive.material];\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(material)) {\n    return attributeLocations;\n  }\n\n  var technique = techniques[material._technique];\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(technique)) {\n    return attributeLocations;\n  }\n\n  var attributes = technique.attributes;\n  var program = model._rendererResources.programs[technique.program];\n  var programAttributeLocations = program._attributeLocations;\n\n  for (location in programAttributeLocations) {\n    if (programAttributeLocations.hasOwnProperty(location)) {\n      var attribute = attributes[location];\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(attribute)) {\n        index = programAttributeLocations[location];\n        attributeLocations[attribute.semantic] = index;\n      }\n    }\n  }\n\n  // Add pre-created attributes.\n  var precreatedAttributes = model._precreatedAttributes;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(precreatedAttributes)) {\n    for (location in precreatedAttributes) {\n      if (precreatedAttributes.hasOwnProperty(location)) {\n        index = programAttributeLocations[location];\n        attributeLocations[location] = index;\n      }\n    }\n  }\n\n  return attributeLocations;\n}\n\nfunction createJoints(model, runtimeSkins) {\n  var gltf = model.gltf;\n  var skins = gltf.skins;\n  var nodes = gltf.nodes;\n  var runtimeNodes = model._runtime.nodes;\n\n  var skinnedNodesIds = model._loadResources.skinnedNodesIds;\n  var length = skinnedNodesIds.length;\n  for (var j = 0; j < length; ++j) {\n    var id = skinnedNodesIds[j];\n    var skinnedNode = runtimeNodes[id];\n    var node = nodes[id];\n\n    var runtimeSkin = runtimeSkins[node.skin];\n    skinnedNode.inverseBindMatrices = runtimeSkin.inverseBindMatrices;\n    skinnedNode.bindShapeMatrix = runtimeSkin.bindShapeMatrix;\n\n    var gltfJoints = skins[node.skin].joints;\n    var jointsLength = gltfJoints.length;\n    for (var i = 0; i < jointsLength; ++i) {\n      var nodeId = gltfJoints[i];\n      var jointNode = runtimeNodes[nodeId];\n      skinnedNode.joints.push(jointNode);\n    }\n  }\n}\n\nfunction createSkins(model) {\n  var loadResources = model._loadResources;\n\n  if (loadResources.pendingBufferLoads !== 0) {\n    return;\n  }\n\n  if (!loadResources.createSkins) {\n    return;\n  }\n  loadResources.createSkins = false;\n\n  var gltf = model.gltf;\n  var accessors = gltf.accessors;\n  var runtimeSkins = {};\n\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].skin */ .Z.skin(gltf, function (skin, id) {\n    var accessor = accessors[skin.inverseBindMatrices];\n\n    var bindShapeMatrix;\n    if (!_Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].equals */ .Z.equals(skin.bindShapeMatrix, _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].IDENTITY */ .Z.IDENTITY)) {\n      bindShapeMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].clone */ .Z.clone(skin.bindShapeMatrix);\n    }\n\n    runtimeSkins[id] = {\n      inverseBindMatrices: _ModelAnimationCache_js__WEBPACK_IMPORTED_MODULE_60__/* ["default"].getSkinInverseBindMatrices */ .Z.getSkinInverseBindMatrices(\n        model,\n        accessor\n      ),\n      bindShapeMatrix: bindShapeMatrix, // not used when undefined\n    };\n  });\n\n  createJoints(model, runtimeSkins);\n}\n\nfunction getChannelEvaluator(model, runtimeNode, targetPath, spline) {\n  return function (localAnimationTime) {\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(spline)) {\n      localAnimationTime = model.clampAnimations\n        ? spline.clampTime(localAnimationTime)\n        : spline.wrapTime(localAnimationTime);\n      runtimeNode[targetPath] = spline.evaluate(\n        localAnimationTime,\n        runtimeNode[targetPath]\n      );\n      runtimeNode.dirtyNumber = model._maxDirtyNumber;\n    }\n  };\n}\n\nfunction createRuntimeAnimations(model) {\n  var loadResources = model._loadResources;\n\n  if (!loadResources.finishedPendingBufferLoads()) {\n    return;\n  }\n\n  if (!loadResources.createRuntimeAnimations) {\n    return;\n  }\n  loadResources.createRuntimeAnimations = false;\n\n  model._runtime.animations = [];\n\n  var runtimeNodes = model._runtime.nodes;\n  var accessors = model.gltf.accessors;\n\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].animation */ .Z.animation(model.gltf, function (animation, i) {\n    var channels = animation.channels;\n    var samplers = animation.samplers;\n\n    // Find start and stop time for the entire animation\n    var startTime = Number.MAX_VALUE;\n    var stopTime = -Number.MAX_VALUE;\n\n    var channelsLength = channels.length;\n    var channelEvaluators = new Array(channelsLength);\n\n    for (var j = 0; j < channelsLength; ++j) {\n      var channel = channels[j];\n      var target = channel.target;\n      var path = target.path;\n      var sampler = samplers[channel.sampler];\n      var input = _ModelAnimationCache_js__WEBPACK_IMPORTED_MODULE_60__/* ["default"].getAnimationParameterValues */ .Z.getAnimationParameterValues(\n        model,\n        accessors[sampler.input]\n      );\n      var output = _ModelAnimationCache_js__WEBPACK_IMPORTED_MODULE_60__/* ["default"].getAnimationParameterValues */ .Z.getAnimationParameterValues(\n        model,\n        accessors[sampler.output]\n      );\n\n      startTime = Math.min(startTime, input[0]);\n      stopTime = Math.max(stopTime, input[input.length - 1]);\n\n      var spline = _ModelAnimationCache_js__WEBPACK_IMPORTED_MODULE_60__/* ["default"].getAnimationSpline */ .Z.getAnimationSpline(\n        model,\n        i,\n        animation,\n        channel.sampler,\n        sampler,\n        input,\n        path,\n        output\n      );\n\n      channelEvaluators[j] = getChannelEvaluator(\n        model,\n        runtimeNodes[target.node],\n        target.path,\n        spline\n      );\n    }\n\n    model._runtime.animations[i] = {\n      name: animation.name,\n      startTime: startTime,\n      stopTime: stopTime,\n      channelEvaluators: channelEvaluators,\n    };\n  });\n}\n\nfunction createVertexArrays(model, context) {\n  var loadResources = model._loadResources;\n  if (\n    !loadResources.finishedBuffersCreation() ||\n    !loadResources.finishedProgramCreation() ||\n    !loadResources.createVertexArrays\n  ) {\n    return;\n  }\n  loadResources.createVertexArrays = false;\n\n  var rendererBuffers = model._rendererResources.buffers;\n  var rendererVertexArrays = model._rendererResources.vertexArrays;\n  var gltf = model.gltf;\n  var accessors = gltf.accessors;\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].mesh */ .Z.mesh(gltf, function (mesh, meshId) {\n    _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].meshPrimitive */ .Z.meshPrimitive(mesh, function (primitive, primitiveId) {\n      var attributes = [];\n      var attributeLocation;\n      var attributeLocations = getAttributeLocations(model, primitive);\n      var decodedData =\n        model._decodedData[meshId + ".primitive." + primitiveId];\n      _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].meshPrimitiveAttribute */ .Z.meshPrimitiveAttribute(primitive, function (\n        accessorId,\n        attributeName\n      ) {\n        // Skip if the attribute is not used by the material, e.g., because the asset\n        // was exported with an attribute that wasn\'t used and the asset wasn\'t optimized.\n        attributeLocation = attributeLocations[attributeName];\n        if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(attributeLocation)) {\n          // Use attributes of previously decoded draco geometry\n          if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(decodedData)) {\n            var decodedAttributes = decodedData.attributes;\n            if (decodedAttributes.hasOwnProperty(attributeName)) {\n              var decodedAttribute = decodedAttributes[attributeName];\n              attributes.push({\n                index: attributeLocation,\n                vertexBuffer: rendererBuffers[decodedAttribute.bufferView],\n                componentsPerAttribute: decodedAttribute.componentsPerAttribute,\n                componentDatatype: decodedAttribute.componentDatatype,\n                normalize: decodedAttribute.normalized,\n                offsetInBytes: decodedAttribute.byteOffset,\n                strideInBytes: decodedAttribute.byteStride,\n              });\n\n              return;\n            }\n          }\n\n          var a = accessors[accessorId];\n          var normalize = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(a.normalized) && a.normalized;\n          attributes.push({\n            index: attributeLocation,\n            vertexBuffer: rendererBuffers[a.bufferView],\n            componentsPerAttribute: (0,_GltfPipeline_numberOfComponentsForType_js__WEBPACK_IMPORTED_MODULE_77__/* ["default"] */ .Z)(a.type),\n            componentDatatype: a.componentType,\n            normalize: normalize,\n            offsetInBytes: a.byteOffset,\n            strideInBytes: (0,_GltfPipeline_getAccessorByteStride_js__WEBPACK_IMPORTED_MODULE_46__/* ["default"] */ .Z)(gltf, a),\n          });\n        }\n      });\n\n      // Add pre-created attributes\n      var attribute;\n      var attributeName;\n      var precreatedAttributes = model._precreatedAttributes;\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(precreatedAttributes)) {\n        for (attributeName in precreatedAttributes) {\n          if (precreatedAttributes.hasOwnProperty(attributeName)) {\n            attributeLocation = attributeLocations[attributeName];\n            if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(attributeLocation)) {\n              attribute = precreatedAttributes[attributeName];\n              attribute.index = attributeLocation;\n              attributes.push(attribute);\n            }\n          }\n        }\n      }\n\n      var indexBuffer;\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(primitive.indices)) {\n        var accessor = accessors[primitive.indices];\n        var bufferView = accessor.bufferView;\n\n        // Use buffer of previously decoded draco geometry\n        if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(decodedData)) {\n          bufferView = decodedData.bufferView;\n        }\n\n        indexBuffer = rendererBuffers[bufferView];\n      }\n      rendererVertexArrays[\n        meshId + ".primitive." + primitiveId\n      ] = new _Renderer_VertexArray_js__WEBPACK_IMPORTED_MODULE_42__/* ["default"] */ .Z({\n        context: context,\n        attributes: attributes,\n        indexBuffer: indexBuffer,\n      });\n    });\n  });\n}\n\nfunction createRenderStates(model) {\n  var loadResources = model._loadResources;\n  if (loadResources.createRenderStates) {\n    loadResources.createRenderStates = false;\n\n    _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].material */ .Z.material(model.gltf, function (material, materialId) {\n      createRenderStateForMaterial(model, material, materialId);\n    });\n  }\n}\n\nfunction createRenderStateForMaterial(model, material, materialId) {\n  var rendererRenderStates = model._rendererResources.renderStates;\n\n  var blendEquationSeparate = [\n    _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].FUNC_ADD */ .Z.FUNC_ADD,\n    _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].FUNC_ADD */ .Z.FUNC_ADD,\n  ];\n  var blendFuncSeparate = [\n    _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].ONE */ .Z.ONE,\n    _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].ONE_MINUS_SRC_ALPHA */ .Z.ONE_MINUS_SRC_ALPHA,\n    _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].ONE */ .Z.ONE,\n    _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].ONE_MINUS_SRC_ALPHA */ .Z.ONE_MINUS_SRC_ALPHA,\n  ];\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(material.extensions) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(material.extensions.KHR_blend)) {\n    blendEquationSeparate = material.extensions.KHR_blend.blendEquation;\n    blendFuncSeparate = material.extensions.KHR_blend.blendFactors;\n  }\n\n  var enableCulling = !material.doubleSided;\n  var blendingEnabled = material.alphaMode === "BLEND";\n  rendererRenderStates[materialId] = _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_35__/* ["default"].fromCache */ .Z.fromCache({\n    cull: {\n      enabled: enableCulling,\n    },\n    depthTest: {\n      enabled: true,\n      func: _DepthFunction_js__WEBPACK_IMPORTED_MODULE_54__/* ["default"].LESS_OR_EQUAL */ .Z.LESS_OR_EQUAL,\n    },\n    depthMask: !blendingEnabled,\n    blending: {\n      enabled: blendingEnabled,\n      equationRgb: blendEquationSeparate[0],\n      equationAlpha: blendEquationSeparate[1],\n      functionSourceRgb: blendFuncSeparate[0],\n      functionDestinationRgb: blendFuncSeparate[1],\n      functionSourceAlpha: blendFuncSeparate[2],\n      functionDestinationAlpha: blendFuncSeparate[3],\n    },\n  });\n}\n\n///////////////////////////////////////////////////////////////////////////\n\nvar gltfUniformsFromNode = {\n  MODEL: function (uniformState, model, runtimeNode) {\n    return function () {\n      return runtimeNode.computedMatrix;\n    };\n  },\n  VIEW: function (uniformState, model, runtimeNode) {\n    return function () {\n      return uniformState.view;\n    };\n  },\n  PROJECTION: function (uniformState, model, runtimeNode) {\n    return function () {\n      return uniformState.projection;\n    };\n  },\n  MODELVIEW: function (uniformState, model, runtimeNode) {\n    var mv = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\n    return function () {\n      return _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyTransformation */ .Z.multiplyTransformation(\n        uniformState.view,\n        runtimeNode.computedMatrix,\n        mv\n      );\n    };\n  },\n  CESIUM_RTC_MODELVIEW: function (uniformState, model, runtimeNode) {\n    // CESIUM_RTC extension\n    var mvRtc = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\n    return function () {\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyTransformation */ .Z.multiplyTransformation(\n        uniformState.view,\n        runtimeNode.computedMatrix,\n        mvRtc\n      );\n      return _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].setTranslation */ .Z.setTranslation(mvRtc, model._rtcCenterEye, mvRtc);\n    };\n  },\n  MODELVIEWPROJECTION: function (uniformState, model, runtimeNode) {\n    var mvp = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\n    return function () {\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyTransformation */ .Z.multiplyTransformation(\n        uniformState.view,\n        runtimeNode.computedMatrix,\n        mvp\n      );\n      return _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiply */ .Z.multiply(uniformState._projection, mvp, mvp);\n    };\n  },\n  MODELINVERSE: function (uniformState, model, runtimeNode) {\n    var mInverse = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\n    return function () {\n      return _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].inverse */ .Z.inverse(runtimeNode.computedMatrix, mInverse);\n    };\n  },\n  VIEWINVERSE: function (uniformState, model) {\n    return function () {\n      return uniformState.inverseView;\n    };\n  },\n  PROJECTIONINVERSE: function (uniformState, model, runtimeNode) {\n    return function () {\n      return uniformState.inverseProjection;\n    };\n  },\n  MODELVIEWINVERSE: function (uniformState, model, runtimeNode) {\n    var mv = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\n    var mvInverse = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\n    return function () {\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyTransformation */ .Z.multiplyTransformation(\n        uniformState.view,\n        runtimeNode.computedMatrix,\n        mv\n      );\n      return _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].inverse */ .Z.inverse(mv, mvInverse);\n    };\n  },\n  MODELVIEWPROJECTIONINVERSE: function (uniformState, model, runtimeNode) {\n    var mvp = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\n    var mvpInverse = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\n    return function () {\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyTransformation */ .Z.multiplyTransformation(\n        uniformState.view,\n        runtimeNode.computedMatrix,\n        mvp\n      );\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiply */ .Z.multiply(uniformState._projection, mvp, mvp);\n      return _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].inverse */ .Z.inverse(mvp, mvpInverse);\n    };\n  },\n  MODELINVERSETRANSPOSE: function (uniformState, model, runtimeNode) {\n    var mInverse = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\n    var mInverseTranspose = new _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z();\n    return function () {\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].inverse */ .Z.inverse(runtimeNode.computedMatrix, mInverse);\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].getMatrix3 */ .Z.getMatrix3(mInverse, mInverseTranspose);\n      return _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].transpose */ .Z.transpose(mInverseTranspose, mInverseTranspose);\n    };\n  },\n  MODELVIEWINVERSETRANSPOSE: function (uniformState, model, runtimeNode) {\n    var mv = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\n    var mvInverse = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\n    var mvInverseTranspose = new _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z();\n    return function () {\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyTransformation */ .Z.multiplyTransformation(\n        uniformState.view,\n        runtimeNode.computedMatrix,\n        mv\n      );\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].inverse */ .Z.inverse(mv, mvInverse);\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].getMatrix3 */ .Z.getMatrix3(mvInverse, mvInverseTranspose);\n      return _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].transpose */ .Z.transpose(mvInverseTranspose, mvInverseTranspose);\n    };\n  },\n  VIEWPORT: function (uniformState, model, runtimeNode) {\n    return function () {\n      return uniformState.viewportCartesian4;\n    };\n  },\n};\n\nfunction getUniformFunctionFromSource(source, model, semantic, uniformState) {\n  var runtimeNode = model._runtime.nodes[source];\n  return gltfUniformsFromNode[semantic](uniformState, model, runtimeNode);\n}\n\nfunction createUniformsForMaterial(\n  model,\n  material,\n  technique,\n  instanceValues,\n  context,\n  textures,\n  defaultTexture\n) {\n  var uniformMap = {};\n  var uniformValues = {};\n  var jointMatrixUniformName;\n  var morphWeightsUniformName;\n\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].techniqueUniform */ .Z.techniqueUniform(technique, function (uniform, uniformName) {\n    // GLTF_SPEC: This does not take into account uniform arrays,\n    // indicated by uniforms with a count property.\n    //\n    // https://github.com/KhronosGroup/glTF/issues/258\n\n    // GLTF_SPEC: In this implementation, material parameters with a\n    // semantic or targeted via a source (for animation) are not\n    // targetable for material animations.  Is this too strict?\n    //\n    // https://github.com/KhronosGroup/glTF/issues/142\n\n    var uv;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(instanceValues) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(instanceValues[uniformName])) {\n      // Parameter overrides by the instance technique\n      uv = _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].createUniformFunction */ .Z.createUniformFunction(\n        uniform.type,\n        instanceValues[uniformName],\n        textures,\n        defaultTexture\n      );\n      uniformMap[uniformName] = uv.func;\n      uniformValues[uniformName] = uv;\n    } else if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(uniform.node)) {\n      uniformMap[uniformName] = getUniformFunctionFromSource(\n        uniform.node,\n        model,\n        uniform.semantic,\n        context.uniformState\n      );\n    } else if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(uniform.semantic)) {\n      if (uniform.semantic === "JOINTMATRIX") {\n        jointMatrixUniformName = uniformName;\n      } else if (uniform.semantic === "MORPHWEIGHTS") {\n        morphWeightsUniformName = uniformName;\n      } else if (uniform.semantic === "ALPHACUTOFF") {\n        // The material\'s alphaCutoff value uses a uniform with semantic ALPHACUTOFF.\n        // A uniform with this semantic will ignore the instance or default values.\n        var alphaMode = material.alphaMode;\n        if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(alphaMode) && alphaMode === "MASK") {\n          var alphaCutoffValue = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(material.alphaCutoff, 0.5);\n          uv = _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].createUniformFunction */ .Z.createUniformFunction(\n            uniform.type,\n            alphaCutoffValue,\n            textures,\n            defaultTexture\n          );\n          uniformMap[uniformName] = uv.func;\n          uniformValues[uniformName] = uv;\n        }\n      } else {\n        // Map glTF semantic to Cesium automatic uniform\n        uniformMap[uniformName] = _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].getGltfSemanticUniforms */ .Z.getGltfSemanticUniforms()[\n          uniform.semantic\n        ](context.uniformState, model);\n      }\n    } else if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(uniform.value)) {\n      // Technique value that isn\'t overridden by a material\n      var uv2 = _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].createUniformFunction */ .Z.createUniformFunction(\n        uniform.type,\n        uniform.value,\n        textures,\n        defaultTexture\n      );\n      uniformMap[uniformName] = uv2.func;\n      uniformValues[uniformName] = uv2;\n    }\n  });\n\n  return {\n    map: uniformMap,\n    values: uniformValues,\n    jointMatrixUniformName: jointMatrixUniformName,\n    morphWeightsUniformName: morphWeightsUniformName,\n  };\n}\n\nfunction createUniformMaps(model, context) {\n  var loadResources = model._loadResources;\n\n  if (!loadResources.finishedProgramCreation()) {\n    return;\n  }\n\n  if (!loadResources.createUniformMaps) {\n    return;\n  }\n  loadResources.createUniformMaps = false;\n\n  var gltf = model.gltf;\n  var techniques = model._sourceTechniques;\n  var uniformMaps = model._uniformMaps;\n\n  var textures = model._rendererResources.textures;\n  var defaultTexture = model._defaultTexture;\n\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_45__/* ["default"].material */ .Z.material(gltf, function (material, materialId) {\n    var modelMaterial = model._runtime.materialsById[materialId];\n    var technique = techniques[modelMaterial._technique];\n    var instanceValues = modelMaterial._values;\n\n    var uniforms = createUniformsForMaterial(\n      model,\n      material,\n      technique,\n      instanceValues,\n      context,\n      textures,\n      defaultTexture\n    );\n\n    var u = uniformMaps[materialId];\n    u.uniformMap = uniforms.map; // uniform name -> function for the renderer\n    u.values = uniforms.values; // material parameter name -> ModelMaterial for modifying the parameter at runtime\n    u.jointMatrixUniformName = uniforms.jointMatrixUniformName;\n    u.morphWeightsUniformName = uniforms.morphWeightsUniformName;\n\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(technique.attributes.a_outlineCoordinates)) {\n      var outlineTexture = _ModelOutlineLoader_js__WEBPACK_IMPORTED_MODULE_66__/* ["default"].createTexture */ .Z.createTexture(model, context);\n      u.uniformMap.u_outlineTexture = function () {\n        return outlineTexture;\n      };\n    }\n  });\n}\n\nfunction createUniformsForDracoQuantizedAttributes(decodedData) {\n  return _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].createUniformsForDracoQuantizedAttributes */ .Z.createUniformsForDracoQuantizedAttributes(\n    decodedData.attributes\n  );\n}\n\nfunction createUniformsForQuantizedAttributes(model, primitive) {\n  var programId = getProgramForPrimitive(model, primitive);\n  var quantizedUniforms = model._quantizedUniforms[programId];\n  return _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].createUniformsForQuantizedAttributes */ .Z.createUniformsForQuantizedAttributes(\n    model.gltf,\n    primitive,\n    quantizedUniforms\n  );\n}\n\nfunction createPickColorFunction(color) {\n  return function () {\n    return color;\n  };\n}\n\nfunction createJointMatricesFunction(runtimeNode) {\n  return function () {\n    return runtimeNode.computedJointMatrices;\n  };\n}\n\nfunction createMorphWeightsFunction(runtimeNode) {\n  return function () {\n    return runtimeNode.weights;\n  };\n}\n\nfunction createSilhouetteColorFunction(model) {\n  return function () {\n    return model.silhouetteColor;\n  };\n}\n\nfunction createSilhouetteSizeFunction(model) {\n  return function () {\n    return model.silhouetteSize;\n  };\n}\n\nfunction createColorFunction(model) {\n  return function () {\n    return model.color;\n  };\n}\n\nfunction createClippingPlanesMatrixFunction(model) {\n  return function () {\n    return model._clippingPlanesMatrix;\n  };\n}\n\nfunction createIBLReferenceFrameMatrixFunction(model) {\n  return function () {\n    return model._iblReferenceFrameMatrix;\n  };\n}\n\nfunction createClippingPlanesFunction(model) {\n  return function () {\n    var clippingPlanes = model.clippingPlanes;\n    return !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(clippingPlanes) || !clippingPlanes.enabled\n      ? model._defaultTexture\n      : clippingPlanes.texture;\n  };\n}\n\nfunction createClippingPlanesEdgeStyleFunction(model) {\n  return function () {\n    var clippingPlanes = model.clippingPlanes;\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(clippingPlanes)) {\n      return _Core_Color_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].WHITE.withAlpha */ .Z.WHITE.withAlpha(0.0);\n    }\n\n    var style = _Core_Color_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].clone */ .Z.clone(clippingPlanes.edgeColor);\n    style.alpha = clippingPlanes.edgeWidth;\n    return style;\n  };\n}\n\nfunction createColorBlendFunction(model) {\n  return function () {\n    return _ColorBlendMode_js__WEBPACK_IMPORTED_MODULE_53__/* ["default"].getColorBlend */ .Z.getColorBlend(\n      model.colorBlendMode,\n      model.colorBlendAmount\n    );\n  };\n}\n\nfunction createIBLFactorFunction(model) {\n  return function () {\n    return model._imageBasedLightingFactor;\n  };\n}\n\nfunction createLightColorFunction(model) {\n  return function () {\n    return model._lightColor;\n  };\n}\n\nfunction createLuminanceAtZenithFunction(model) {\n  return function () {\n    return model.luminanceAtZenith;\n  };\n}\n\nfunction createSphericalHarmonicCoefficientsFunction(model) {\n  return function () {\n    return model._sphericalHarmonicCoefficients;\n  };\n}\n\nfunction createSpecularEnvironmentMapFunction(model) {\n  return function () {\n    return model._specularEnvironmentMapAtlas.texture;\n  };\n}\n\nfunction createSpecularEnvironmentMapSizeFunction(model) {\n  return function () {\n    return model._specularEnvironmentMapAtlas.texture.dimensions;\n  };\n}\n\nfunction createSpecularEnvironmentMapLOD(model) {\n  return function () {\n    return model._specularEnvironmentMapAtlas.maximumMipmapLevel;\n  };\n}\n\nfunction triangleCountFromPrimitiveIndices(primitive, indicesCount) {\n  switch (primitive.mode) {\n    case _Core_PrimitiveType_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"].TRIANGLES */ .Z.TRIANGLES:\n      return indicesCount / 3;\n    case _Core_PrimitiveType_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"].TRIANGLE_STRIP */ .Z.TRIANGLE_STRIP:\n    case _Core_PrimitiveType_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"].TRIANGLE_FAN */ .Z.TRIANGLE_FAN:\n      return Math.max(indicesCount - 2, 0);\n    default:\n      return 0;\n  }\n}\n\nfunction createCommand(model, gltfNode, runtimeNode, context, scene3DOnly) {\n  var nodeCommands = model._nodeCommands;\n  var pickIds = model._pickIds;\n  var allowPicking = model.allowPicking;\n  var runtimeMeshesByName = model._runtime.meshesByName;\n\n  var resources = model._rendererResources;\n  var rendererVertexArrays = resources.vertexArrays;\n  var rendererPrograms = resources.programs;\n  var rendererRenderStates = resources.renderStates;\n  var uniformMaps = model._uniformMaps;\n\n  var gltf = model.gltf;\n  var accessors = gltf.accessors;\n  var gltfMeshes = gltf.meshes;\n\n  var id = gltfNode.mesh;\n  var mesh = gltfMeshes[id];\n\n  var primitives = mesh.primitives;\n  var length = primitives.length;\n\n  // The glTF node hierarchy is a DAG so a node can have more than one\n  // parent, so a node may already have commands.  If so, append more\n  // since they will have a different model matrix.\n\n  for (var i = 0; i < length; ++i) {\n    var primitive = primitives[i];\n    var ix = accessors[primitive.indices];\n    var material = model._runtime.materialsById[primitive.material];\n    var programId = material._program;\n    var decodedData = model._decodedData[id + ".primitive." + i];\n\n    var boundingSphere;\n    var positionAccessor = primitive.attributes.POSITION;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(positionAccessor)) {\n      var minMax = _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].getAccessorMinMax */ .Z.getAccessorMinMax(gltf, positionAccessor);\n      boundingSphere = _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].fromCornerPoints */ .Z.fromCornerPoints(\n        _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].fromArray */ .Z.fromArray(minMax.min),\n        _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].fromArray */ .Z.fromArray(minMax.max)\n      );\n    }\n\n    var vertexArray = rendererVertexArrays[id + ".primitive." + i];\n    var offset;\n    var count;\n\n    // Use indices of the previously decoded Draco geometry.\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(decodedData)) {\n      count = decodedData.numberOfIndices;\n      offset = 0;\n    } else if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(ix)) {\n      count = ix.count;\n      offset = ix.byteOffset / _Core_IndexDatatype_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].getSizeInBytes */ .Z.getSizeInBytes(ix.componentType); // glTF has offset in bytes.  Cesium has offsets in indices\n    } else {\n      var positions = accessors[primitive.attributes.POSITION];\n      count = positions.count;\n      offset = 0;\n    }\n\n    // Update model triangle count using number of indices\n    model._trianglesLength += triangleCountFromPrimitiveIndices(\n      primitive,\n      count\n    );\n\n    if (primitive.mode === _Core_PrimitiveType_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"].POINTS */ .Z.POINTS) {\n      model._pointsLength += count;\n    }\n\n    var um = uniformMaps[primitive.material];\n    var uniformMap = um.uniformMap;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(um.jointMatrixUniformName)) {\n      var jointUniformMap = {};\n      jointUniformMap[um.jointMatrixUniformName] = createJointMatricesFunction(\n        runtimeNode\n      );\n\n      uniformMap = (0,_Core_combine_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(uniformMap, jointUniformMap);\n    }\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(um.morphWeightsUniformName)) {\n      var morphWeightsUniformMap = {};\n      morphWeightsUniformMap[\n        um.morphWeightsUniformName\n      ] = createMorphWeightsFunction(runtimeNode);\n\n      uniformMap = (0,_Core_combine_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(uniformMap, morphWeightsUniformMap);\n    }\n\n    uniformMap = (0,_Core_combine_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(uniformMap, {\n      gltf_color: createColorFunction(model),\n      gltf_colorBlend: createColorBlendFunction(model),\n      gltf_clippingPlanes: createClippingPlanesFunction(model),\n      gltf_clippingPlanesEdgeStyle: createClippingPlanesEdgeStyleFunction(\n        model\n      ),\n      gltf_clippingPlanesMatrix: createClippingPlanesMatrixFunction(model),\n      gltf_iblReferenceFrameMatrix: createIBLReferenceFrameMatrixFunction(\n        model\n      ),\n      gltf_iblFactor: createIBLFactorFunction(model),\n      gltf_lightColor: createLightColorFunction(model),\n      gltf_sphericalHarmonicCoefficients: createSphericalHarmonicCoefficientsFunction(\n        model\n      ),\n      gltf_specularMap: createSpecularEnvironmentMapFunction(model),\n      gltf_specularMapSize: createSpecularEnvironmentMapSizeFunction(model),\n      gltf_maxSpecularLOD: createSpecularEnvironmentMapLOD(model),\n      gltf_luminanceAtZenith: createLuminanceAtZenithFunction(model),\n    });\n\n    // Allow callback to modify the uniformMap\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._uniformMapLoaded)) {\n      uniformMap = model._uniformMapLoaded(uniformMap, programId, runtimeNode);\n    }\n\n    // Add uniforms for decoding quantized attributes if used\n    var quantizedUniformMap = {};\n    if (model.extensionsUsed.WEB3D_quantized_attributes) {\n      quantizedUniformMap = createUniformsForQuantizedAttributes(\n        model,\n        primitive\n      );\n    } else if (model._dequantizeInShader && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(decodedData)) {\n      quantizedUniformMap = createUniformsForDracoQuantizedAttributes(\n        decodedData\n      );\n    }\n    uniformMap = (0,_Core_combine_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(uniformMap, quantizedUniformMap);\n\n    var rs = rendererRenderStates[primitive.material];\n    var isTranslucent = rs.blending.enabled;\n\n    var owner = model._pickObject;\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(owner)) {\n      owner = {\n        primitive: model,\n        id: model.id,\n        node: runtimeNode.publicNode,\n        mesh: runtimeMeshesByName[mesh.name],\n      };\n    }\n\n    var castShadows = _ShadowMode_js__WEBPACK_IMPORTED_MODULE_72__/* ["default"].castShadows */ .Z.castShadows(model._shadows);\n    var receiveShadows = _ShadowMode_js__WEBPACK_IMPORTED_MODULE_72__/* ["default"].receiveShadows */ .Z.receiveShadows(model._shadows);\n\n    var pickId;\n    if (allowPicking && !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._uniformMapLoaded)) {\n      pickId = context.createPickId(owner);\n      pickIds.push(pickId);\n      var pickUniforms = {\n        czm_pickColor: createPickColorFunction(pickId.color),\n      };\n      uniformMap = (0,_Core_combine_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(uniformMap, pickUniforms);\n    }\n\n    if (allowPicking) {\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._pickIdLoaded) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._uniformMapLoaded)) {\n        pickId = model._pickIdLoaded();\n      } else {\n        pickId = "czm_pickColor";\n      }\n    }\n\n    var command = new _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_33__/* ["default"] */ .Z({\n      boundingVolume: new _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(), // updated in update()\n      cull: model.cull,\n      modelMatrix: new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z(), // computed in update()\n      primitiveType: primitive.mode,\n      vertexArray: vertexArray,\n      count: count,\n      offset: offset,\n      shaderProgram: rendererPrograms[programId],\n      castShadows: castShadows,\n      receiveShadows: receiveShadows,\n      uniformMap: uniformMap,\n      renderState: rs,\n      owner: owner,\n      pass: isTranslucent ? _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_34__/* ["default"].TRANSLUCENT */ .Z.TRANSLUCENT : model.opaquePass,\n      pickId: pickId,\n    });\n\n    var command2D;\n    if (!scene3DOnly) {\n      command2D = _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_33__/* ["default"].shallowClone */ .Z.shallowClone(command);\n      command2D.boundingVolume = new _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(); // updated in update()\n      command2D.modelMatrix = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z(); // updated in update()\n    }\n\n    var nodeCommand = {\n      show: true,\n      boundingSphere: boundingSphere,\n      command: command,\n      command2D: command2D,\n      // Generated on demand when silhouette size is greater than 0.0 and silhouette alpha is greater than 0.0\n      silhouetteModelCommand: undefined,\n      silhouetteModelCommand2D: undefined,\n      silhouetteColorCommand: undefined,\n      silhouetteColorCommand2D: undefined,\n      // Generated on demand when color alpha is less than 1.0\n      translucentCommand: undefined,\n      translucentCommand2D: undefined,\n      // Generated on demand when back face culling is false\n      disableCullingCommand: undefined,\n      disableCullingCommand2D: undefined,\n      // For updating node commands on shader reconstruction\n      programId: programId,\n    };\n    runtimeNode.commands.push(nodeCommand);\n    nodeCommands.push(nodeCommand);\n  }\n}\n\nfunction createRuntimeNodes(model, context, scene3DOnly) {\n  var loadResources = model._loadResources;\n\n  if (!loadResources.finishedEverythingButTextureCreation()) {\n    return;\n  }\n\n  if (!loadResources.createRuntimeNodes) {\n    return;\n  }\n  loadResources.createRuntimeNodes = false;\n\n  var rootNodes = [];\n  var runtimeNodes = model._runtime.nodes;\n\n  var gltf = model.gltf;\n  var nodes = gltf.nodes;\n\n  var scene = gltf.scenes[gltf.scene];\n  var sceneNodes = scene.nodes;\n  var length = sceneNodes.length;\n\n  var stack = [];\n  var seen = {};\n\n  for (var i = 0; i < length; ++i) {\n    stack.push({\n      parentRuntimeNode: undefined,\n      gltfNode: nodes[sceneNodes[i]],\n      id: sceneNodes[i],\n    });\n\n    while (stack.length > 0) {\n      var n = stack.pop();\n      seen[n.id] = true;\n      var parentRuntimeNode = n.parentRuntimeNode;\n      var gltfNode = n.gltfNode;\n\n      // Node hierarchy is a DAG so a node can have more than one parent so it may already exist\n      var runtimeNode = runtimeNodes[n.id];\n      if (runtimeNode.parents.length === 0) {\n        if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(gltfNode.matrix)) {\n          runtimeNode.matrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].fromColumnMajorArray */ .Z.fromColumnMajorArray(gltfNode.matrix);\n        } else {\n          // TRS converted to Cesium types\n          var rotation = gltfNode.rotation;\n          runtimeNode.translation = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].fromArray */ .Z.fromArray(gltfNode.translation);\n          runtimeNode.rotation = _Core_Quaternion_js__WEBPACK_IMPORTED_MODULE_27__/* ["default"].unpack */ .Z.unpack(rotation);\n          runtimeNode.scale = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].fromArray */ .Z.fromArray(gltfNode.scale);\n        }\n      }\n\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(parentRuntimeNode)) {\n        parentRuntimeNode.children.push(runtimeNode);\n        runtimeNode.parents.push(parentRuntimeNode);\n      } else {\n        rootNodes.push(runtimeNode);\n      }\n\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(gltfNode.mesh)) {\n        createCommand(model, gltfNode, runtimeNode, context, scene3DOnly);\n      }\n\n      var children = gltfNode.children;\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(children)) {\n        var childrenLength = children.length;\n        for (var j = 0; j < childrenLength; j++) {\n          var childId = children[j];\n          if (!seen[childId]) {\n            stack.push({\n              parentRuntimeNode: runtimeNode,\n              gltfNode: nodes[childId],\n              id: children[j],\n            });\n          }\n        }\n      }\n    }\n  }\n\n  model._runtime.rootNodes = rootNodes;\n  model._runtime.nodes = runtimeNodes;\n}\n\nfunction getGeometryByteLength(buffers) {\n  var memory = 0;\n  for (var id in buffers) {\n    if (buffers.hasOwnProperty(id)) {\n      memory += buffers[id].sizeInBytes;\n    }\n  }\n  return memory;\n}\n\nfunction getTexturesByteLength(textures) {\n  var memory = 0;\n  for (var id in textures) {\n    if (textures.hasOwnProperty(id)) {\n      memory += textures[id].sizeInBytes;\n    }\n  }\n  return memory;\n}\n\nfunction createResources(model, frameState) {\n  var context = frameState.context;\n  var scene3DOnly = frameState.scene3DOnly;\n  var quantizedVertexShaders = model._quantizedVertexShaders;\n  var techniques = model._sourceTechniques;\n  var programs = model._sourcePrograms;\n\n  var resources = model._rendererResources;\n  var shaders = resources.sourceShaders;\n  if (model._loadRendererResourcesFromCache) {\n    shaders = resources.sourceShaders =\n      model._cachedRendererResources.sourceShaders;\n  }\n\n  for (var techniqueId in techniques) {\n    if (techniques.hasOwnProperty(techniqueId)) {\n      var programId = techniques[techniqueId].program;\n      var program = programs[programId];\n      var shader = shaders[program.vertexShader];\n\n      _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].checkSupportedGlExtensions */ .Z.checkSupportedGlExtensions(program.glExtensions, context);\n\n      if (\n        model.extensionsUsed.WEB3D_quantized_attributes ||\n        model._dequantizeInShader\n      ) {\n        var quantizedVS = quantizedVertexShaders[programId];\n        if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(quantizedVS)) {\n          quantizedVS = modifyShaderForQuantizedAttributes(\n            shader,\n            programId,\n            model\n          );\n          quantizedVertexShaders[programId] = quantizedVS;\n        }\n        shader = quantizedVS;\n      }\n\n      shader = modifyShader(shader, programId, model._vertexShaderLoaded);\n    }\n  }\n\n  if (model._loadRendererResourcesFromCache) {\n    var cachedResources = model._cachedRendererResources;\n\n    resources.buffers = cachedResources.buffers;\n    resources.vertexArrays = cachedResources.vertexArrays;\n    resources.programs = cachedResources.programs;\n    resources.silhouettePrograms = cachedResources.silhouettePrograms;\n    resources.textures = cachedResources.textures;\n    resources.samplers = cachedResources.samplers;\n    resources.renderStates = cachedResources.renderStates;\n\n    // Vertex arrays are unique to this model, create instead of using the cache.\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._precreatedAttributes)) {\n      createVertexArrays(model, context);\n    }\n\n    model._cachedGeometryByteLength += getGeometryByteLength(\n      cachedResources.buffers\n    );\n    model._cachedTexturesByteLength += getTexturesByteLength(\n      cachedResources.textures\n    );\n  } else {\n    createBuffers(model, frameState); // using glTF bufferViews\n    createPrograms(model, frameState);\n    createSamplers(model, context);\n    loadTexturesFromBufferViews(model);\n    createTextures(model, frameState);\n  }\n\n  createSkins(model);\n  createRuntimeAnimations(model);\n\n  if (!model._loadRendererResourcesFromCache) {\n    createVertexArrays(model, context); // using glTF meshes\n    createRenderStates(model); // using glTF materials/techniques/states\n    // Long-term, we might not cache render states if they could change\n    // due to an animation, e.g., a uniform going from opaque to transparent.\n    // Could use copy-on-write if it is worth it.  Probably overkill.\n  }\n\n  createUniformMaps(model, context); // using glTF materials/techniques\n  createRuntimeNodes(model, context, scene3DOnly); // using glTF scene\n}\n\n///////////////////////////////////////////////////////////////////////////\n\nfunction getNodeMatrix(node, result) {\n  var publicNode = node.publicNode;\n  var publicMatrix = publicNode.matrix;\n\n  if (publicNode.useMatrix && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(publicMatrix)) {\n    // Public matrix overrides original glTF matrix and glTF animations\n    _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].clone */ .Z.clone(publicMatrix, result);\n  } else if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(node.matrix)) {\n    _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].clone */ .Z.clone(node.matrix, result);\n  } else {\n    _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].fromTranslationQuaternionRotationScale */ .Z.fromTranslationQuaternionRotationScale(\n      node.translation,\n      node.rotation,\n      node.scale,\n      result\n    );\n    // Keep matrix returned by the node in-sync if the node is targeted by an animation.  Only TRS nodes can be targeted.\n    publicNode.setMatrix(result);\n  }\n}\n\nvar scratchNodeStack = [];\nvar scratchComputedTranslation = new _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z();\nvar scratchComputedMatrixIn2D = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\n\nfunction updateNodeHierarchyModelMatrix(\n  model,\n  modelTransformChanged,\n  justLoaded,\n  projection\n) {\n  var maxDirtyNumber = model._maxDirtyNumber;\n\n  var rootNodes = model._runtime.rootNodes;\n  var length = rootNodes.length;\n\n  var nodeStack = scratchNodeStack;\n  var computedModelMatrix = model._computedModelMatrix;\n\n  if (model._mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_71__/* ["default"].SCENE3D */ .Z.SCENE3D && !model._ignoreCommands) {\n    var translation = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].getColumn */ .Z.getColumn(\n      computedModelMatrix,\n      3,\n      scratchComputedTranslation\n    );\n    if (!_Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].equals */ .Z.equals(translation, _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].UNIT_W */ .Z.UNIT_W)) {\n      computedModelMatrix = _Core_Transforms_js__WEBPACK_IMPORTED_MODULE_29__/* ["default"].basisTo2D */ .Z.basisTo2D(\n        projection,\n        computedModelMatrix,\n        scratchComputedMatrixIn2D\n      );\n      model._rtcCenter = model._rtcCenter3D;\n    } else {\n      var center = model.boundingSphere.center;\n      var to2D = _Core_Transforms_js__WEBPACK_IMPORTED_MODULE_29__/* ["default"].wgs84To2DModelMatrix */ .Z.wgs84To2DModelMatrix(\n        projection,\n        center,\n        scratchComputedMatrixIn2D\n      );\n      computedModelMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiply */ .Z.multiply(\n        to2D,\n        computedModelMatrix,\n        scratchComputedMatrixIn2D\n      );\n\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._rtcCenter)) {\n        _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].setTranslation */ .Z.setTranslation(\n          computedModelMatrix,\n          _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].UNIT_W */ .Z.UNIT_W,\n          computedModelMatrix\n        );\n        model._rtcCenter = model._rtcCenter2D;\n      }\n    }\n  }\n\n  for (var i = 0; i < length; ++i) {\n    var n = rootNodes[i];\n\n    getNodeMatrix(n, n.transformToRoot);\n    nodeStack.push(n);\n\n    while (nodeStack.length > 0) {\n      n = nodeStack.pop();\n      var transformToRoot = n.transformToRoot;\n      var commands = n.commands;\n\n      if (\n        n.dirtyNumber === maxDirtyNumber ||\n        modelTransformChanged ||\n        justLoaded\n      ) {\n        var nodeMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyTransformation */ .Z.multiplyTransformation(\n          computedModelMatrix,\n          transformToRoot,\n          n.computedMatrix\n        );\n        var commandsLength = commands.length;\n        if (commandsLength > 0) {\n          // Node has meshes, which has primitives.  Update their commands.\n          for (var j = 0; j < commandsLength; ++j) {\n            var primitiveCommand = commands[j];\n            var command = primitiveCommand.command;\n            _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].clone */ .Z.clone(nodeMatrix, command.modelMatrix);\n\n            // PERFORMANCE_IDEA: Can use transformWithoutScale if no node up to the root has scale (including animation)\n            _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].transform */ .Z.transform(\n              primitiveCommand.boundingSphere,\n              command.modelMatrix,\n              command.boundingVolume\n            );\n\n            if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._rtcCenter)) {\n              _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].add */ .Z.add(\n                model._rtcCenter,\n                command.boundingVolume.center,\n                command.boundingVolume.center\n              );\n            }\n\n            // If the model crosses the IDL in 2D, it will be drawn in one viewport, but part of it\n            // will be clipped by the viewport. We create a second command that translates the model\n            // model matrix to the opposite side of the map so the part that was clipped in one viewport\n            // is drawn in the other.\n            command = primitiveCommand.command2D;\n            if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(command) && model._mode === _SceneMode_js__WEBPACK_IMPORTED_MODULE_71__/* ["default"].SCENE2D */ .Z.SCENE2D) {\n              _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].clone */ .Z.clone(nodeMatrix, command.modelMatrix);\n              command.modelMatrix[13] -=\n                _Core_Math_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].sign */ .Z.sign(command.modelMatrix[13]) *\n                2.0 *\n                _Core_Math_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].PI */ .Z.PI *\n                projection.ellipsoid.maximumRadius;\n              _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].transform */ .Z.transform(\n                primitiveCommand.boundingSphere,\n                command.modelMatrix,\n                command.boundingVolume\n              );\n            }\n          }\n        }\n      }\n\n      var children = n.children;\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(children)) {\n        var childrenLength = children.length;\n        for (var k = 0; k < childrenLength; ++k) {\n          var child = children[k];\n\n          // A node\'s transform needs to be updated if\n          // - It was targeted for animation this frame, or\n          // - Any of its ancestors were targeted for animation this frame\n\n          // PERFORMANCE_IDEA: if a child has multiple parents and only one of the parents\n          // is dirty, all the subtrees for each child instance will be dirty; we probably\n          // won\'t see this in the wild often.\n          child.dirtyNumber = Math.max(child.dirtyNumber, n.dirtyNumber);\n\n          if (child.dirtyNumber === maxDirtyNumber || justLoaded) {\n            // Don\'t check for modelTransformChanged since if only the model\'s model matrix changed,\n            // we do not need to rebuild the local transform-to-root, only the final\n            // [model\'s-model-matrix][transform-to-root] above.\n            getNodeMatrix(child, child.transformToRoot);\n            _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyTransformation */ .Z.multiplyTransformation(\n              transformToRoot,\n              child.transformToRoot,\n              child.transformToRoot\n            );\n          }\n\n          nodeStack.push(child);\n        }\n      }\n    }\n  }\n\n  ++model._maxDirtyNumber;\n}\n\nvar scratchObjectSpace = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\n\nfunction applySkins(model) {\n  var skinnedNodes = model._runtime.skinnedNodes;\n  var length = skinnedNodes.length;\n\n  for (var i = 0; i < length; ++i) {\n    var node = skinnedNodes[i];\n\n    scratchObjectSpace = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].inverseTransformation */ .Z.inverseTransformation(\n      node.transformToRoot,\n      scratchObjectSpace\n    );\n\n    var computedJointMatrices = node.computedJointMatrices;\n    var joints = node.joints;\n    var bindShapeMatrix = node.bindShapeMatrix;\n    var inverseBindMatrices = node.inverseBindMatrices;\n    var inverseBindMatricesLength = inverseBindMatrices.length;\n\n    for (var m = 0; m < inverseBindMatricesLength; ++m) {\n      // [joint-matrix] = [node-to-root^-1][joint-to-root][inverse-bind][bind-shape]\n      if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(computedJointMatrices[m])) {\n        computedJointMatrices[m] = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\n      }\n      computedJointMatrices[m] = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyTransformation */ .Z.multiplyTransformation(\n        scratchObjectSpace,\n        joints[m].transformToRoot,\n        computedJointMatrices[m]\n      );\n      computedJointMatrices[m] = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyTransformation */ .Z.multiplyTransformation(\n        computedJointMatrices[m],\n        inverseBindMatrices[m],\n        computedJointMatrices[m]\n      );\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(bindShapeMatrix)) {\n        // NOTE: bindShapeMatrix is glTF 1.0 only, removed in glTF 2.0.\n        computedJointMatrices[m] = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyTransformation */ .Z.multiplyTransformation(\n          computedJointMatrices[m],\n          bindShapeMatrix,\n          computedJointMatrices[m]\n        );\n      }\n    }\n  }\n}\n\nfunction updatePerNodeShow(model) {\n  // Totally not worth it, but we could optimize this:\n  // http://help.agi.com/AGIComponents/html/BlogDeletionInBoundingVolumeHierarchies.htm\n\n  var rootNodes = model._runtime.rootNodes;\n  var length = rootNodes.length;\n\n  var nodeStack = scratchNodeStack;\n\n  for (var i = 0; i < length; ++i) {\n    var n = rootNodes[i];\n    n.computedShow = n.publicNode.show;\n    nodeStack.push(n);\n\n    while (nodeStack.length > 0) {\n      n = nodeStack.pop();\n      var show = n.computedShow;\n\n      var nodeCommands = n.commands;\n      var nodeCommandsLength = nodeCommands.length;\n      for (var j = 0; j < nodeCommandsLength; ++j) {\n        nodeCommands[j].show = show;\n      }\n      // if commandsLength is zero, the node has a light or camera\n\n      var children = n.children;\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(children)) {\n        var childrenLength = children.length;\n        for (var k = 0; k < childrenLength; ++k) {\n          var child = children[k];\n          // Parent needs to be shown for child to be shown.\n          child.computedShow = show && child.publicNode.show;\n          nodeStack.push(child);\n        }\n      }\n    }\n  }\n}\n\nfunction updatePickIds(model, context) {\n  var id = model.id;\n  if (model._id !== id) {\n    model._id = id;\n\n    var pickIds = model._pickIds;\n    var length = pickIds.length;\n    for (var i = 0; i < length; ++i) {\n      pickIds[i].object.id = id;\n    }\n  }\n}\n\nfunction updateWireframe(model) {\n  if (model._debugWireframe !== model.debugWireframe) {\n    model._debugWireframe = model.debugWireframe;\n\n    // This assumes the original primitive was TRIANGLES and that the triangles\n    // are connected for the wireframe to look perfect.\n    var primitiveType = model.debugWireframe\n      ? _Core_PrimitiveType_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"].LINES */ .Z.LINES\n      : _Core_PrimitiveType_js__WEBPACK_IMPORTED_MODULE_26__/* ["default"].TRIANGLES */ .Z.TRIANGLES;\n    var nodeCommands = model._nodeCommands;\n    var length = nodeCommands.length;\n\n    for (var i = 0; i < length; ++i) {\n      nodeCommands[i].command.primitiveType = primitiveType;\n    }\n  }\n}\n\nfunction updateShowBoundingVolume(model) {\n  if (model.debugShowBoundingVolume !== model._debugShowBoundingVolume) {\n    model._debugShowBoundingVolume = model.debugShowBoundingVolume;\n\n    var debugShowBoundingVolume = model.debugShowBoundingVolume;\n    var nodeCommands = model._nodeCommands;\n    var length = nodeCommands.length;\n\n    for (var i = 0; i < length; ++i) {\n      nodeCommands[i].command.debugShowBoundingVolume = debugShowBoundingVolume;\n    }\n  }\n}\n\nfunction updateShadows(model) {\n  if (model.shadows !== model._shadows) {\n    model._shadows = model.shadows;\n\n    var castShadows = _ShadowMode_js__WEBPACK_IMPORTED_MODULE_72__/* ["default"].castShadows */ .Z.castShadows(model.shadows);\n    var receiveShadows = _ShadowMode_js__WEBPACK_IMPORTED_MODULE_72__/* ["default"].receiveShadows */ .Z.receiveShadows(model.shadows);\n    var nodeCommands = model._nodeCommands;\n    var length = nodeCommands.length;\n\n    for (var i = 0; i < length; i++) {\n      var nodeCommand = nodeCommands[i];\n      nodeCommand.command.castShadows = castShadows;\n      nodeCommand.command.receiveShadows = receiveShadows;\n    }\n  }\n}\n\nfunction getTranslucentRenderState(model, renderState) {\n  var rs = (0,_Core_clone_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(renderState, true);\n  rs.cull.enabled = false;\n  rs.depthTest.enabled = true;\n  rs.depthMask = false;\n  rs.blending = _BlendingState_js__WEBPACK_IMPORTED_MODULE_51__/* ["default"].ALPHA_BLEND */ .Z.ALPHA_BLEND;\n\n  if (model.opaquePass === _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_34__/* ["default"].CESIUM_3D_TILE */ .Z.CESIUM_3D_TILE) {\n    rs.stencilTest = _StencilConstants_js__WEBPACK_IMPORTED_MODULE_73__/* ["default"].setCesium3DTileBit */ .Z.setCesium3DTileBit();\n    rs.stencilMask = _StencilConstants_js__WEBPACK_IMPORTED_MODULE_73__/* ["default"].CESIUM_3D_TILE_MASK */ .Z.CESIUM_3D_TILE_MASK;\n  }\n\n  return _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_35__/* ["default"].fromCache */ .Z.fromCache(rs);\n}\n\nfunction deriveTranslucentCommand(model, command) {\n  var translucentCommand = _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_33__/* ["default"].shallowClone */ .Z.shallowClone(command);\n  translucentCommand.pass = _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_34__/* ["default"].TRANSLUCENT */ .Z.TRANSLUCENT;\n  translucentCommand.renderState = getTranslucentRenderState(\n    model,\n    command.renderState\n  );\n  return translucentCommand;\n}\n\nfunction updateColor(model, frameState, forceDerive) {\n  // Generate translucent commands when the blend color has an alpha in the range (0.0, 1.0) exclusive\n  var scene3DOnly = frameState.scene3DOnly;\n  var alpha = model.color.alpha;\n  if (alpha > 0.0 && alpha < 1.0) {\n    var nodeCommands = model._nodeCommands;\n    var length = nodeCommands.length;\n    if (\n      length > 0 &&\n      (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(nodeCommands[0].translucentCommand) || forceDerive)\n    ) {\n      for (var i = 0; i < length; ++i) {\n        var nodeCommand = nodeCommands[i];\n        var command = nodeCommand.command;\n        nodeCommand.translucentCommand = deriveTranslucentCommand(\n          model,\n          command\n        );\n        if (!scene3DOnly) {\n          var command2D = nodeCommand.command2D;\n          nodeCommand.translucentCommand2D = deriveTranslucentCommand(\n            model,\n            command2D\n          );\n        }\n      }\n    }\n  }\n}\n\nfunction getDisableCullingRenderState(renderState) {\n  var rs = (0,_Core_clone_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(renderState, true);\n  rs.cull.enabled = false;\n  return _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_35__/* ["default"].fromCache */ .Z.fromCache(rs);\n}\n\nfunction deriveDisableCullingCommand(command) {\n  var disableCullingCommand = _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_33__/* ["default"].shallowClone */ .Z.shallowClone(command);\n  disableCullingCommand.renderState = getDisableCullingRenderState(\n    command.renderState\n  );\n  return disableCullingCommand;\n}\n\nfunction updateBackFaceCulling(model, frameState, forceDerive) {\n  var scene3DOnly = frameState.scene3DOnly;\n  var backFaceCulling = model.backFaceCulling;\n  if (!backFaceCulling) {\n    var nodeCommands = model._nodeCommands;\n    var length = nodeCommands.length;\n    if (\n      length > 0 &&\n      (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(nodeCommands[0].disableCullingCommand) || forceDerive)\n    ) {\n      for (var i = 0; i < length; ++i) {\n        var nodeCommand = nodeCommands[i];\n        var command = nodeCommand.command;\n        nodeCommand.disableCullingCommand = deriveDisableCullingCommand(\n          command\n        );\n        if (!scene3DOnly) {\n          var command2D = nodeCommand.command2D;\n          nodeCommand.disableCullingCommand2D = deriveDisableCullingCommand(\n            command2D\n          );\n        }\n      }\n    }\n  }\n}\n\nfunction getProgramId(model, program) {\n  var programs = model._rendererResources.programs;\n  for (var id in programs) {\n    if (programs.hasOwnProperty(id)) {\n      if (programs[id] === program) {\n        return id;\n      }\n    }\n  }\n}\n\nfunction createSilhouetteProgram(model, program, frameState) {\n  var vs = program.vertexShaderSource.sources[0];\n  var attributeLocations = program._attributeLocations;\n  var normalAttributeName = model._normalAttributeName;\n\n  // Modified from http://forum.unity3d.com/threads/toon-outline-but-with-diffuse-surface.24668/\n  vs = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_38__/* ["default"].replaceMain */ .Z.replaceMain(vs, "gltf_silhouette_main");\n  vs +=\n    "uniform float gltf_silhouetteSize; \\n" +\n    "void main() \\n" +\n    "{ \\n" +\n    "    gltf_silhouette_main(); \\n" +\n    "    vec3 n = normalize(czm_normal3D * " +\n    normalAttributeName +\n    "); \\n" +\n    "    n.x *= czm_projection[0][0]; \\n" +\n    "    n.y *= czm_projection[1][1]; \\n" +\n    "    vec4 clip = gl_Position; \\n" +\n    "    clip.xy += n.xy * clip.w * gltf_silhouetteSize * czm_pixelRatio / czm_viewport.z; \\n" +\n    "    gl_Position = clip; \\n" +\n    "}";\n\n  var fs =\n    "uniform vec4 gltf_silhouetteColor; \\n" +\n    "void main() \\n" +\n    "{ \\n" +\n    "    gl_FragColor = czm_gammaCorrect(gltf_silhouetteColor); \\n" +\n    "}";\n\n  return _Renderer_ShaderProgram_js__WEBPACK_IMPORTED_MODULE_37__/* ["default"].fromCache */ .Z.fromCache({\n    context: frameState.context,\n    vertexShaderSource: vs,\n    fragmentShaderSource: fs,\n    attributeLocations: attributeLocations,\n  });\n}\n\nfunction hasSilhouette(model, frameState) {\n  return (\n    silhouetteSupported(frameState.context) &&\n    model.silhouetteSize > 0.0 &&\n    model.silhouetteColor.alpha > 0.0 &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._normalAttributeName)\n  );\n}\n\nfunction hasTranslucentCommands(model) {\n  var nodeCommands = model._nodeCommands;\n  var length = nodeCommands.length;\n  for (var i = 0; i < length; ++i) {\n    var nodeCommand = nodeCommands[i];\n    var command = nodeCommand.command;\n    if (command.pass === _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_34__/* ["default"].TRANSLUCENT */ .Z.TRANSLUCENT) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction isTranslucent(model) {\n  return model.color.alpha > 0.0 && model.color.alpha < 1.0;\n}\n\nfunction isInvisible(model) {\n  return model.color.alpha === 0.0;\n}\n\nfunction alphaDirty(currAlpha, prevAlpha) {\n  // Returns whether the alpha state has changed between invisible, translucent, or opaque\n  return (\n    Math.floor(currAlpha) !== Math.floor(prevAlpha) ||\n    Math.ceil(currAlpha) !== Math.ceil(prevAlpha)\n  );\n}\n\nvar silhouettesLength = 0;\n\nfunction createSilhouetteCommands(model, frameState) {\n  // Wrap around after exceeding the 8-bit stencil limit.\n  // The reference is unique to each model until this point.\n  var stencilReference = ++silhouettesLength % 255;\n\n  // If the model is translucent the silhouette needs to be in the translucent pass.\n  // Otherwise the silhouette would be rendered before the model.\n  var silhouetteTranslucent =\n    hasTranslucentCommands(model) ||\n    isTranslucent(model) ||\n    model.silhouetteColor.alpha < 1.0;\n  var silhouettePrograms = model._rendererResources.silhouettePrograms;\n  var scene3DOnly = frameState.scene3DOnly;\n  var nodeCommands = model._nodeCommands;\n  var length = nodeCommands.length;\n  for (var i = 0; i < length; ++i) {\n    var nodeCommand = nodeCommands[i];\n    var command = nodeCommand.command;\n\n    // Create model command\n    var modelCommand = isTranslucent(model)\n      ? nodeCommand.translucentCommand\n      : command;\n    var silhouetteModelCommand = _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_33__/* ["default"].shallowClone */ .Z.shallowClone(modelCommand);\n    var renderState = (0,_Core_clone_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(modelCommand.renderState);\n\n    // Write the reference value into the stencil buffer.\n    renderState.stencilTest = {\n      enabled: true,\n      frontFunction: _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].ALWAYS */ .Z.ALWAYS,\n      backFunction: _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].ALWAYS */ .Z.ALWAYS,\n      reference: stencilReference,\n      mask: ~0,\n      frontOperation: {\n        fail: _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].KEEP */ .Z.KEEP,\n        zFail: _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].KEEP */ .Z.KEEP,\n        zPass: _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].REPLACE */ .Z.REPLACE,\n      },\n      backOperation: {\n        fail: _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].KEEP */ .Z.KEEP,\n        zFail: _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].KEEP */ .Z.KEEP,\n        zPass: _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].REPLACE */ .Z.REPLACE,\n      },\n    };\n\n    if (isInvisible(model)) {\n      // When the model is invisible disable color and depth writes but still write into the stencil buffer\n      renderState.colorMask = {\n        red: false,\n        green: false,\n        blue: false,\n        alpha: false,\n      };\n      renderState.depthMask = false;\n    }\n    renderState = _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_35__/* ["default"].fromCache */ .Z.fromCache(renderState);\n    silhouetteModelCommand.renderState = renderState;\n    nodeCommand.silhouetteModelCommand = silhouetteModelCommand;\n\n    // Create color command\n    var silhouetteColorCommand = _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_33__/* ["default"].shallowClone */ .Z.shallowClone(command);\n    renderState = (0,_Core_clone_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(command.renderState, true);\n    renderState.depthTest.enabled = true;\n    renderState.cull.enabled = false;\n    if (silhouetteTranslucent) {\n      silhouetteColorCommand.pass = _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_34__/* ["default"].TRANSLUCENT */ .Z.TRANSLUCENT;\n      renderState.depthMask = false;\n      renderState.blending = _BlendingState_js__WEBPACK_IMPORTED_MODULE_51__/* ["default"].ALPHA_BLEND */ .Z.ALPHA_BLEND;\n    }\n\n    // Only render silhouette if the value in the stencil buffer equals the reference\n    renderState.stencilTest = {\n      enabled: true,\n      frontFunction: _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].NOTEQUAL */ .Z.NOTEQUAL,\n      backFunction: _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].NOTEQUAL */ .Z.NOTEQUAL,\n      reference: stencilReference,\n      mask: ~0,\n      frontOperation: {\n        fail: _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].KEEP */ .Z.KEEP,\n        zFail: _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].KEEP */ .Z.KEEP,\n        zPass: _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].KEEP */ .Z.KEEP,\n      },\n      backOperation: {\n        fail: _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].KEEP */ .Z.KEEP,\n        zFail: _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].KEEP */ .Z.KEEP,\n        zPass: _Core_WebGLConstants_js__WEBPACK_IMPORTED_MODULE_30__/* ["default"].KEEP */ .Z.KEEP,\n      },\n    };\n    renderState = _Renderer_RenderState_js__WEBPACK_IMPORTED_MODULE_35__/* ["default"].fromCache */ .Z.fromCache(renderState);\n\n    // If the silhouette program has already been cached use it\n    var program = command.shaderProgram;\n    var id = getProgramId(model, program);\n    var silhouetteProgram = silhouettePrograms[id];\n    if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(silhouetteProgram)) {\n      silhouetteProgram = createSilhouetteProgram(model, program, frameState);\n      silhouettePrograms[id] = silhouetteProgram;\n    }\n\n    var silhouetteUniformMap = (0,_Core_combine_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(command.uniformMap, {\n      gltf_silhouetteColor: createSilhouetteColorFunction(model),\n      gltf_silhouetteSize: createSilhouetteSizeFunction(model),\n    });\n\n    silhouetteColorCommand.renderState = renderState;\n    silhouetteColorCommand.shaderProgram = silhouetteProgram;\n    silhouetteColorCommand.uniformMap = silhouetteUniformMap;\n    silhouetteColorCommand.castShadows = false;\n    silhouetteColorCommand.receiveShadows = false;\n    nodeCommand.silhouetteColorCommand = silhouetteColorCommand;\n\n    if (!scene3DOnly) {\n      var command2D = nodeCommand.command2D;\n      var silhouetteModelCommand2D = _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_33__/* ["default"].shallowClone */ .Z.shallowClone(\n        silhouetteModelCommand\n      );\n      silhouetteModelCommand2D.boundingVolume = command2D.boundingVolume;\n      silhouetteModelCommand2D.modelMatrix = command2D.modelMatrix;\n      nodeCommand.silhouetteModelCommand2D = silhouetteModelCommand2D;\n\n      var silhouetteColorCommand2D = _Renderer_DrawCommand_js__WEBPACK_IMPORTED_MODULE_33__/* ["default"].shallowClone */ .Z.shallowClone(\n        silhouetteColorCommand\n      );\n      silhouetteModelCommand2D.boundingVolume = command2D.boundingVolume;\n      silhouetteModelCommand2D.modelMatrix = command2D.modelMatrix;\n      nodeCommand.silhouetteColorCommand2D = silhouetteColorCommand2D;\n    }\n  }\n}\n\nfunction modifyShaderForClippingPlanes(\n  shader,\n  clippingPlaneCollection,\n  context\n) {\n  shader = _Renderer_ShaderSource_js__WEBPACK_IMPORTED_MODULE_38__/* ["default"].replaceMain */ .Z.replaceMain(shader, "gltf_clip_main");\n  shader += Model._getClippingFunction(clippingPlaneCollection, context) + "\\n";\n  shader +=\n    "uniform highp sampler2D gltf_clippingPlanes; \\n" +\n    "uniform mat4 gltf_clippingPlanesMatrix; \\n" +\n    "uniform vec4 gltf_clippingPlanesEdgeStyle; \\n" +\n    "void main() \\n" +\n    "{ \\n" +\n    "    gltf_clip_main(); \\n" +\n    (0,_getClipAndStyleCode_js__WEBPACK_IMPORTED_MODULE_56__/* ["default"] */ .Z)(\n      "gltf_clippingPlanes",\n      "gltf_clippingPlanesMatrix",\n      "gltf_clippingPlanesEdgeStyle"\n    ) +\n    "} \\n";\n  return shader;\n}\n\nfunction updateSilhouette(model, frameState, force) {\n  // Generate silhouette commands when the silhouette size is greater than 0.0 and the alpha is greater than 0.0\n  // There are two silhouette commands:\n  //     1. silhouetteModelCommand : render model normally while enabling stencil mask\n  //     2. silhouetteColorCommand : render enlarged model with a solid color while enabling stencil tests\n  if (!hasSilhouette(model, frameState)) {\n    return;\n  }\n\n  var nodeCommands = model._nodeCommands;\n  var dirty =\n    nodeCommands.length > 0 &&\n    (alphaDirty(model.color.alpha, model._colorPreviousAlpha) ||\n      alphaDirty(\n        model.silhouetteColor.alpha,\n        model._silhouetteColorPreviousAlpha\n      ) ||\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(nodeCommands[0].silhouetteModelCommand));\n\n  model._colorPreviousAlpha = model.color.alpha;\n  model._silhouetteColorPreviousAlpha = model.silhouetteColor.alpha;\n\n  if (dirty || force) {\n    createSilhouetteCommands(model, frameState);\n  }\n}\n\nfunction updateClippingPlanes(model, frameState) {\n  var clippingPlanes = model._clippingPlanes;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(clippingPlanes) && clippingPlanes.owner === model) {\n    if (clippingPlanes.enabled) {\n      clippingPlanes.update(frameState);\n    }\n  }\n}\n\nvar scratchBoundingSphere = new _Core_BoundingSphere_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z();\n\nfunction scaleInPixels(positionWC, radius, frameState) {\n  scratchBoundingSphere.center = positionWC;\n  scratchBoundingSphere.radius = radius;\n  return frameState.camera.getPixelSize(\n    scratchBoundingSphere,\n    frameState.context.drawingBufferWidth,\n    frameState.context.drawingBufferHeight\n  );\n}\n\nvar scratchPosition = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\nvar scratchCartographic = new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\n\nfunction getScale(model, frameState) {\n  var scale = model.scale;\n\n  if (model.minimumPixelSize !== 0.0) {\n    // Compute size of bounding sphere in pixels\n    var context = frameState.context;\n    var maxPixelSize = Math.max(\n      context.drawingBufferWidth,\n      context.drawingBufferHeight\n    );\n    var m = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._clampedModelMatrix)\n      ? model._clampedModelMatrix\n      : model.modelMatrix;\n    scratchPosition.x = m[12];\n    scratchPosition.y = m[13];\n    scratchPosition.z = m[14];\n\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._rtcCenter)) {\n      _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].add */ .Z.add(model._rtcCenter, scratchPosition, scratchPosition);\n    }\n\n    if (model._mode !== _SceneMode_js__WEBPACK_IMPORTED_MODULE_71__/* ["default"].SCENE3D */ .Z.SCENE3D) {\n      var projection = frameState.mapProjection;\n      var cartographic = projection.ellipsoid.cartesianToCartographic(\n        scratchPosition,\n        scratchCartographic\n      );\n      projection.project(cartographic, scratchPosition);\n      _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].fromElements */ .Z.fromElements(\n        scratchPosition.z,\n        scratchPosition.x,\n        scratchPosition.y,\n        scratchPosition\n      );\n    }\n\n    var radius = model.boundingSphere.radius;\n    var metersPerPixel = scaleInPixels(scratchPosition, radius, frameState);\n\n    // metersPerPixel is always > 0.0\n    var pixelsPerMeter = 1.0 / metersPerPixel;\n    var diameterInPixels = Math.min(\n      pixelsPerMeter * (2.0 * radius),\n      maxPixelSize\n    );\n\n    // Maintain model\'s minimum pixel size\n    if (diameterInPixels < model.minimumPixelSize) {\n      scale =\n        (model.minimumPixelSize * metersPerPixel) /\n        (2.0 * model._initialRadius);\n    }\n  }\n\n  return (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model.maximumScale)\n    ? Math.min(model.maximumScale, scale)\n    : scale;\n}\n\nfunction releaseCachedGltf(model) {\n  if (\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._cacheKey) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._cachedGltf) &&\n    --model._cachedGltf.count === 0\n  ) {\n    delete gltfCache[model._cacheKey];\n  }\n  model._cachedGltf = undefined;\n}\n\n///////////////////////////////////////////////////////////////////////////\n\nfunction CachedRendererResources(context, cacheKey) {\n  this.buffers = undefined;\n  this.vertexArrays = undefined;\n  this.programs = undefined;\n  this.sourceShaders = undefined;\n  this.silhouettePrograms = undefined;\n  this.textures = undefined;\n  this.samplers = undefined;\n  this.renderStates = undefined;\n  this.ready = false;\n\n  this.context = context;\n  this.cacheKey = cacheKey;\n  this.count = 0;\n}\n\nfunction destroy(property) {\n  for (var name in property) {\n    if (property.hasOwnProperty(name)) {\n      property[name].destroy();\n    }\n  }\n}\n\nfunction destroyCachedRendererResources(resources) {\n  destroy(resources.buffers);\n  destroy(resources.vertexArrays);\n  destroy(resources.programs);\n  destroy(resources.silhouettePrograms);\n  destroy(resources.textures);\n}\n\nCachedRendererResources.prototype.release = function () {\n  if (--this.count === 0) {\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this.cacheKey)) {\n      // Remove if this was cached\n      delete this.context.cache.modelRendererResourceCache[this.cacheKey];\n    }\n    destroyCachedRendererResources(this);\n    return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z)(this);\n  }\n\n  return undefined;\n};\n\n///////////////////////////////////////////////////////////////////////////\n\nfunction getUpdateHeightCallback(model, ellipsoid, cartoPosition) {\n  return function (clampedPosition) {\n    if (model.heightReference === _HeightReference_js__WEBPACK_IMPORTED_MODULE_58__/* ["default"].RELATIVE_TO_GROUND */ .Z.RELATIVE_TO_GROUND) {\n      var clampedCart = ellipsoid.cartesianToCartographic(\n        clampedPosition,\n        scratchCartographic\n      );\n      clampedCart.height += cartoPosition.height;\n      ellipsoid.cartographicToCartesian(clampedCart, clampedPosition);\n    }\n\n    var clampedModelMatrix = model._clampedModelMatrix;\n\n    // Modify clamped model matrix to use new height\n    _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].clone */ .Z.clone(model.modelMatrix, clampedModelMatrix);\n    clampedModelMatrix[12] = clampedPosition.x;\n    clampedModelMatrix[13] = clampedPosition.y;\n    clampedModelMatrix[14] = clampedPosition.z;\n\n    model._heightChanged = true;\n  };\n}\n\nfunction updateClamping(model) {\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._removeUpdateHeightCallback)) {\n    model._removeUpdateHeightCallback();\n    model._removeUpdateHeightCallback = undefined;\n  }\n\n  var scene = model._scene;\n  if (\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(scene) ||\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(scene.globe) ||\n    model.heightReference === _HeightReference_js__WEBPACK_IMPORTED_MODULE_58__/* ["default"].NONE */ .Z.NONE\n  ) {\n    //>>includeStart(\'debug\', pragmas.debug);\n    if (model.heightReference !== _HeightReference_js__WEBPACK_IMPORTED_MODULE_58__/* ["default"].NONE */ .Z.NONE) {\n      throw new _Core_DeveloperError_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z(\n        "Height reference is not supported without a scene and globe."\n      );\n    }\n    //>>includeEnd(\'debug\');\n    model._clampedModelMatrix = undefined;\n    return;\n  }\n\n  var globe = scene.globe;\n  var ellipsoid = globe.ellipsoid;\n\n  // Compute cartographic position so we don\'t recompute every update\n  var modelMatrix = model.modelMatrix;\n  scratchPosition.x = modelMatrix[12];\n  scratchPosition.y = modelMatrix[13];\n  scratchPosition.z = modelMatrix[14];\n  var cartoPosition = ellipsoid.cartesianToCartographic(scratchPosition);\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(model._clampedModelMatrix)) {\n    model._clampedModelMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].clone */ .Z.clone(modelMatrix, new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z());\n  }\n\n  // Install callback to handle updating of terrain tiles\n  var surface = globe._surface;\n  model._removeUpdateHeightCallback = surface.updateHeight(\n    cartoPosition,\n    getUpdateHeightCallback(model, ellipsoid, cartoPosition)\n  );\n\n  // Set the correct height now\n  var height = globe.getHeight(cartoPosition);\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(height)) {\n    // Get callback with cartoPosition being the non-clamped position\n    var cb = getUpdateHeightCallback(model, ellipsoid, cartoPosition);\n\n    // Compute the clamped cartesian and call updateHeight callback\n    _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].clone */ .Z.clone(cartoPosition, scratchCartographic);\n    scratchCartographic.height = height;\n    ellipsoid.cartographicToCartesian(scratchCartographic, scratchPosition);\n    cb(scratchPosition);\n  }\n}\n\nvar scratchDisplayConditionCartesian = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\nvar scratchDistanceDisplayConditionCartographic = new _Core_Cartographic_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z();\n\nfunction distanceDisplayConditionVisible(model, frameState) {\n  var distance2;\n  var ddc = model.distanceDisplayCondition;\n  var nearSquared = ddc.near * ddc.near;\n  var farSquared = ddc.far * ddc.far;\n\n  if (frameState.mode === _SceneMode_js__WEBPACK_IMPORTED_MODULE_71__/* ["default"].SCENE2D */ .Z.SCENE2D) {\n    var frustum2DWidth =\n      frameState.camera.frustum.right - frameState.camera.frustum.left;\n    distance2 = frustum2DWidth * 0.5;\n    distance2 = distance2 * distance2;\n  } else {\n    // Distance to center of primitive\'s reference frame\n    var position = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].getTranslation */ .Z.getTranslation(\n      model.modelMatrix,\n      scratchDisplayConditionCartesian\n    );\n    if (frameState.mode === _SceneMode_js__WEBPACK_IMPORTED_MODULE_71__/* ["default"].COLUMBUS_VIEW */ .Z.COLUMBUS_VIEW) {\n      var projection = frameState.mapProjection;\n      var ellipsoid = projection.ellipsoid;\n      var cartographic = ellipsoid.cartesianToCartographic(\n        position,\n        scratchDistanceDisplayConditionCartographic\n      );\n      position = projection.project(cartographic, position);\n      _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].fromElements */ .Z.fromElements(position.z, position.x, position.y, position);\n    }\n    distance2 = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].distanceSquared */ .Z.distanceSquared(\n      position,\n      frameState.camera.positionWC\n    );\n  }\n\n  return distance2 >= nearSquared && distance2 <= farSquared;\n}\n\nvar scratchClippingPlanesMatrix = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\nvar scratchIBLReferenceFrameMatrix4 = new _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z();\nvar scratchIBLReferenceFrameMatrix3 = new _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z();\n\n/**\n * Called when {@link Viewer} or {@link CesiumWidget} render the scene to\n * get the draw commands needed to render this primitive.\n * <p>\n * Do not call this function directly.  This is documented just to\n * list the exceptions that may be propagated when the scene is rendered:\n * </p>\n *\n * @exception {RuntimeError} Failed to load external reference.\n */\nModel.prototype.update = function (frameState) {\n  if (frameState.mode === _SceneMode_js__WEBPACK_IMPORTED_MODULE_71__/* ["default"].MORPHING */ .Z.MORPHING) {\n    return;\n  }\n\n  if (!_Core_FeatureDetection_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].supportsWebP.initialized */ .Z.supportsWebP.initialized) {\n    _Core_FeatureDetection_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].supportsWebP.initialize */ .Z.supportsWebP.initialize();\n    return;\n  }\n\n  var context = frameState.context;\n  this._defaultTexture = context.defaultTexture;\n\n  var supportsWebP = _Core_FeatureDetection_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].supportsWebP */ .Z.supportsWebP();\n\n  if (this._state === ModelState.NEEDS_LOAD && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this.gltf)) {\n    // Use renderer resources from cache instead of loading/creating them?\n    var cachedRendererResources;\n    var cacheKey = this.cacheKey;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(cacheKey)) {\n      // cache key given? this model will pull from or contribute to context level cache\n      context.cache.modelRendererResourceCache = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(\n        context.cache.modelRendererResourceCache,\n        {}\n      );\n      var modelCaches = context.cache.modelRendererResourceCache;\n\n      cachedRendererResources = modelCaches[this.cacheKey];\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(cachedRendererResources)) {\n        if (!cachedRendererResources.ready) {\n          // Cached resources for the model are not loaded yet.  We\'ll\n          // try again every frame until they are.\n          return;\n        }\n\n        ++cachedRendererResources.count;\n        this._loadRendererResourcesFromCache = true;\n      } else {\n        cachedRendererResources = new CachedRendererResources(\n          context,\n          cacheKey\n        );\n        cachedRendererResources.count = 1;\n        modelCaches[this.cacheKey] = cachedRendererResources;\n      }\n      this._cachedRendererResources = cachedRendererResources;\n    } else {\n      // cache key not given? this model doesn\'t care about context level cache at all. Cache is here to simplify freeing on destroy.\n      cachedRendererResources = new CachedRendererResources(context);\n      cachedRendererResources.count = 1;\n      this._cachedRendererResources = cachedRendererResources;\n    }\n\n    this._state = ModelState.LOADING;\n    if (this._state !== ModelState.FAILED) {\n      var extensions = this.gltf.extensions;\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(extensions) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(extensions.CESIUM_RTC)) {\n        var center = _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].fromArray */ .Z.fromArray(extensions.CESIUM_RTC.center);\n        if (!_Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].equals */ .Z.equals(center, _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].ZERO */ .Z.ZERO)) {\n          this._rtcCenter3D = center;\n\n          var projection = frameState.mapProjection;\n          var ellipsoid = projection.ellipsoid;\n          var cartographic = ellipsoid.cartesianToCartographic(\n            this._rtcCenter3D\n          );\n          var projectedCart = projection.project(cartographic);\n          _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].fromElements */ .Z.fromElements(\n            projectedCart.z,\n            projectedCart.x,\n            projectedCart.y,\n            projectedCart\n          );\n          this._rtcCenter2D = projectedCart;\n\n          this._rtcCenterEye = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z();\n          this._rtcCenter = this._rtcCenter3D;\n        }\n      }\n\n      (0,_GltfPipeline_addPipelineExtras_js__WEBPACK_IMPORTED_MODULE_44__/* ["default"] */ .Z)(this.gltf);\n\n      this._loadResources = new _ModelLoadResources_js__WEBPACK_IMPORTED_MODULE_62__/* ["default"] */ .Z();\n      if (!this._loadRendererResourcesFromCache) {\n        // Buffers are required to updateVersion\n        _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].parseBuffers */ .Z.parseBuffers(this, bufferLoad);\n      }\n    }\n  }\n\n  var loadResources = this._loadResources;\n  var incrementallyLoadTextures = this._incrementallyLoadTextures;\n  var justLoaded = false;\n\n  if (this._state === ModelState.LOADING) {\n    // Transition from LOADING -> LOADED once resources are downloaded and created.\n    // Textures may continue to stream in while in the LOADED state.\n    if (loadResources.pendingBufferLoads === 0) {\n      if (!loadResources.initialized) {\n        frameState.brdfLutGenerator.update(frameState);\n\n        _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].checkSupportedExtensions */ .Z.checkSupportedExtensions(\n          this.extensionsRequired,\n          supportsWebP\n        );\n        _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].updateForwardAxis */ .Z.updateForwardAxis(this);\n\n        // glTF pipeline updates, not needed if loading from cache\n        if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this.gltf.extras.sourceVersion)) {\n          var gltf = this.gltf;\n          // Add the original version so it remains cached\n          gltf.extras.sourceVersion = _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].getAssetVersion */ .Z.getAssetVersion(gltf);\n          gltf.extras.sourceKHRTechniquesWebGL = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(\n            _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].getUsedExtensions */ .Z.getUsedExtensions(gltf).KHR_techniques_webgl\n          );\n\n          this._sourceVersion = gltf.extras.sourceVersion;\n          this._sourceKHRTechniquesWebGL = gltf.extras.sourceKHRTechniquesWebGL;\n\n          (0,_GltfPipeline_updateVersion_js__WEBPACK_IMPORTED_MODULE_48__/* ["default"] */ .Z)(gltf);\n          (0,_GltfPipeline_addDefaults_js__WEBPACK_IMPORTED_MODULE_43__/* ["default"] */ .Z)(gltf);\n\n          var options = {\n            addBatchIdToGeneratedShaders: this._addBatchIdToGeneratedShaders,\n          };\n\n          (0,_processModelMaterialsCommon_js__WEBPACK_IMPORTED_MODULE_69__/* ["default"] */ .Z)(gltf, options);\n          (0,_processPbrMaterials_js__WEBPACK_IMPORTED_MODULE_70__/* ["default"] */ .Z)(gltf, options);\n        }\n\n        this._sourceVersion = this.gltf.extras.sourceVersion;\n        this._sourceKHRTechniquesWebGL = this.gltf.extras.sourceKHRTechniquesWebGL;\n\n        // Skip dequantizing in the shader if not encoded\n        this._dequantizeInShader =\n          this._dequantizeInShader && _DracoLoader_js__WEBPACK_IMPORTED_MODULE_55__/* ["default"].hasExtension */ .Z.hasExtension(this);\n\n        // We do this after to make sure that the ids don\'t change\n        addBuffersToLoadResources(this);\n        parseArticulations(this);\n        parseTechniques(this);\n        if (!this._loadRendererResourcesFromCache) {\n          parseBufferViews(this);\n          parseShaders(this);\n          parsePrograms(this);\n          parseTextures(this, context, supportsWebP);\n        }\n        parseMaterials(this);\n        parseMeshes(this);\n        parseNodes(this);\n\n        // Start draco decoding\n        _DracoLoader_js__WEBPACK_IMPORTED_MODULE_55__/* ["default"].parse */ .Z.parse(this, context);\n\n        loadResources.initialized = true;\n      }\n\n      if (!loadResources.finishedDecoding()) {\n        _DracoLoader_js__WEBPACK_IMPORTED_MODULE_55__/* ["default"].decodeModel */ .Z.decodeModel(this, context).otherwise(\n          _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].getFailedLoadFunction */ .Z.getFailedLoadFunction(this, "model", this.basePath)\n        );\n      }\n\n      if (loadResources.finishedDecoding() && !loadResources.resourcesParsed) {\n        this._boundingSphere = _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].computeBoundingSphere */ .Z.computeBoundingSphere(this);\n        this._initialRadius = this._boundingSphere.radius;\n\n        _DracoLoader_js__WEBPACK_IMPORTED_MODULE_55__/* ["default"].cacheDataForModel */ .Z.cacheDataForModel(this);\n\n        loadResources.resourcesParsed = true;\n      }\n\n      if (\n        loadResources.resourcesParsed &&\n        loadResources.pendingShaderLoads === 0\n      ) {\n        if (this.showOutline) {\n          _ModelOutlineLoader_js__WEBPACK_IMPORTED_MODULE_66__/* ["default"].outlinePrimitives */ .Z.outlinePrimitives(this);\n        }\n        createResources(this, frameState);\n      }\n    }\n\n    if (\n      loadResources.finished() ||\n      (incrementallyLoadTextures &&\n        loadResources.finishedEverythingButTextureCreation())\n    ) {\n      this._state = ModelState.LOADED;\n      justLoaded = true;\n    }\n  }\n\n  // Incrementally stream textures.\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(loadResources) && this._state === ModelState.LOADED) {\n    if (incrementallyLoadTextures && !justLoaded) {\n      createResources(this, frameState);\n    }\n\n    if (loadResources.finished()) {\n      this._loadResources = undefined; // Clear CPU memory since WebGL resources were created.\n\n      var resources = this._rendererResources;\n      var cachedResources = this._cachedRendererResources;\n\n      cachedResources.buffers = resources.buffers;\n      cachedResources.vertexArrays = resources.vertexArrays;\n      cachedResources.programs = resources.programs;\n      cachedResources.sourceShaders = resources.sourceShaders;\n      cachedResources.silhouettePrograms = resources.silhouettePrograms;\n      cachedResources.textures = resources.textures;\n      cachedResources.samplers = resources.samplers;\n      cachedResources.renderStates = resources.renderStates;\n      cachedResources.ready = true;\n\n      // The normal attribute name is required for silhouettes, so get it before the gltf JSON is released\n      this._normalAttributeName = _ModelUtility_js__WEBPACK_IMPORTED_MODULE_67__/* ["default"].getAttributeOrUniformBySemantic */ .Z.getAttributeOrUniformBySemantic(\n        this.gltf,\n        "NORMAL"\n      );\n\n      // Vertex arrays are unique to this model, do not store in cache.\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._precreatedAttributes)) {\n        cachedResources.vertexArrays = {};\n      }\n\n      if (this.releaseGltfJson) {\n        releaseCachedGltf(this);\n      }\n    }\n  }\n\n  var iblSupported = _OctahedralProjectedCubeMap_js__WEBPACK_IMPORTED_MODULE_68__/* ["default"].isSupported */ .Z.isSupported(context);\n  if (this._shouldUpdateSpecularMapAtlas && iblSupported) {\n    this._shouldUpdateSpecularMapAtlas = false;\n    this._specularEnvironmentMapAtlas =\n      this._specularEnvironmentMapAtlas &&\n      this._specularEnvironmentMapAtlas.destroy();\n    this._specularEnvironmentMapAtlas = undefined;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._specularEnvironmentMaps)) {\n      this._specularEnvironmentMapAtlas = new _OctahedralProjectedCubeMap_js__WEBPACK_IMPORTED_MODULE_68__/* ["default"] */ .Z(\n        this._specularEnvironmentMaps\n      );\n      var that = this;\n      this._specularEnvironmentMapAtlas.readyPromise\n        .then(function () {\n          that._shouldRegenerateShaders = true;\n        })\n        .otherwise(function (error) {\n          console.error("Error loading specularEnvironmentMaps: " + error);\n        });\n    }\n\n    // Regenerate shaders to not use an environment map. Will be set to true again if there was a new environment map and it is ready.\n    this._shouldRegenerateShaders = true;\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._specularEnvironmentMapAtlas)) {\n    this._specularEnvironmentMapAtlas.update(frameState);\n  }\n\n  var recompileWithDefaultAtlas =\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._specularEnvironmentMapAtlas) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(frameState.specularEnvironmentMaps) &&\n    !this._useDefaultSpecularMaps;\n  var recompileWithoutDefaultAtlas =\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(frameState.specularEnvironmentMaps) &&\n    this._useDefaultSpecularMaps;\n\n  var recompileWithDefaultSHCoeffs =\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._sphericalHarmonicCoefficients) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(frameState.sphericalHarmonicCoefficients) &&\n    !this._useDefaultSphericalHarmonics;\n  var recompileWithoutDefaultSHCoeffs =\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(frameState.sphericalHarmonicCoefficients) &&\n    this._useDefaultSphericalHarmonics;\n\n  this._shouldRegenerateShaders =\n    this._shouldRegenerateShaders ||\n    recompileWithDefaultAtlas ||\n    recompileWithoutDefaultAtlas ||\n    recompileWithDefaultSHCoeffs ||\n    recompileWithoutDefaultSHCoeffs;\n\n  this._useDefaultSpecularMaps =\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._specularEnvironmentMapAtlas) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(frameState.specularEnvironmentMaps);\n  this._useDefaultSphericalHarmonics =\n    !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._sphericalHarmonicCoefficients) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(frameState.sphericalHarmonicCoefficients);\n\n  var silhouette = hasSilhouette(this, frameState);\n  var translucent = isTranslucent(this);\n  var invisible = isInvisible(this);\n  var backFaceCulling = this.backFaceCulling;\n  var displayConditionPassed = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this.distanceDisplayCondition)\n    ? distanceDisplayConditionVisible(this, frameState)\n    : true;\n  var show =\n    this.show &&\n    displayConditionPassed &&\n    this.scale !== 0.0 &&\n    (!invisible || silhouette);\n\n  if ((show && this._state === ModelState.LOADED) || justLoaded) {\n    var animated =\n      this.activeAnimations.update(frameState) || this._cesiumAnimationsDirty;\n    this._cesiumAnimationsDirty = false;\n    this._dirty = false;\n    var modelMatrix = this.modelMatrix;\n\n    var modeChanged = frameState.mode !== this._mode;\n    this._mode = frameState.mode;\n\n    // Model\'s model matrix needs to be updated\n    var modelTransformChanged =\n      !_Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].equals */ .Z.equals(this._modelMatrix, modelMatrix) ||\n      this._scale !== this.scale ||\n      this._minimumPixelSize !== this.minimumPixelSize ||\n      this.minimumPixelSize !== 0.0 || // Minimum pixel size changed or is enabled\n      this._maximumScale !== this.maximumScale ||\n      this._heightReference !== this.heightReference ||\n      this._heightChanged ||\n      modeChanged;\n\n    if (modelTransformChanged || justLoaded) {\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].clone */ .Z.clone(modelMatrix, this._modelMatrix);\n\n      updateClamping(this);\n\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._clampedModelMatrix)) {\n        modelMatrix = this._clampedModelMatrix;\n      }\n\n      this._scale = this.scale;\n      this._minimumPixelSize = this.minimumPixelSize;\n      this._maximumScale = this.maximumScale;\n      this._heightReference = this.heightReference;\n      this._heightChanged = false;\n\n      var scale = getScale(this, frameState);\n      var computedModelMatrix = this._computedModelMatrix;\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyByUniformScale */ .Z.multiplyByUniformScale(modelMatrix, scale, computedModelMatrix);\n      if (this._upAxis === _Axis_js__WEBPACK_IMPORTED_MODULE_50__/* ["default"].Y */ .Z.Y) {\n        _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyTransformation */ .Z.multiplyTransformation(\n          computedModelMatrix,\n          _Axis_js__WEBPACK_IMPORTED_MODULE_50__/* ["default"].Y_UP_TO_Z_UP */ .Z.Y_UP_TO_Z_UP,\n          computedModelMatrix\n        );\n      } else if (this._upAxis === _Axis_js__WEBPACK_IMPORTED_MODULE_50__/* ["default"].X */ .Z.X) {\n        _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyTransformation */ .Z.multiplyTransformation(\n          computedModelMatrix,\n          _Axis_js__WEBPACK_IMPORTED_MODULE_50__/* ["default"].X_UP_TO_Z_UP */ .Z.X_UP_TO_Z_UP,\n          computedModelMatrix\n        );\n      }\n      if (this.forwardAxis === _Axis_js__WEBPACK_IMPORTED_MODULE_50__/* ["default"].Z */ .Z.Z) {\n        // glTF 2.0 has a Z-forward convention that must be adapted here to X-forward.\n        _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiplyTransformation */ .Z.multiplyTransformation(\n          computedModelMatrix,\n          _Axis_js__WEBPACK_IMPORTED_MODULE_50__/* ["default"].Z_UP_TO_X_UP */ .Z.Z_UP_TO_X_UP,\n          computedModelMatrix\n        );\n      }\n    }\n\n    // Update modelMatrix throughout the graph as needed\n    if (animated || modelTransformChanged || justLoaded) {\n      updateNodeHierarchyModelMatrix(\n        this,\n        modelTransformChanged,\n        justLoaded,\n        frameState.mapProjection\n      );\n      this._dirty = true;\n\n      if (animated || justLoaded) {\n        // Apply skins if animation changed any node transforms\n        applySkins(this);\n      }\n    }\n\n    if (this._perNodeShowDirty) {\n      this._perNodeShowDirty = false;\n      updatePerNodeShow(this);\n    }\n    updatePickIds(this, context);\n    updateWireframe(this);\n    updateShowBoundingVolume(this);\n    updateShadows(this);\n    updateClippingPlanes(this, frameState);\n\n    // Regenerate shaders if ClippingPlaneCollection state changed or it was removed\n    var clippingPlanes = this._clippingPlanes;\n    var currentClippingPlanesState = 0;\n\n    // If defined, use the reference matrix to transform miscellaneous properties like\n    // clipping planes and IBL instead of the modelMatrix. This is so that when\n    // models are part of a tileset these properties get transformed relative to\n    // a common reference (such as the root).\n    var referenceMatrix = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(this.referenceMatrix, modelMatrix);\n\n    if (isClippingEnabled(this)) {\n      var clippingPlanesMatrix = scratchClippingPlanesMatrix;\n      clippingPlanesMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiply */ .Z.multiply(\n        context.uniformState.view3D,\n        referenceMatrix,\n        clippingPlanesMatrix\n      );\n      clippingPlanesMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiply */ .Z.multiply(\n        clippingPlanesMatrix,\n        clippingPlanes.modelMatrix,\n        clippingPlanesMatrix\n      );\n      this._clippingPlanesMatrix = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].inverseTranspose */ .Z.inverseTranspose(\n        clippingPlanesMatrix,\n        this._clippingPlanesMatrix\n      );\n      currentClippingPlanesState = clippingPlanes.clippingPlanesState;\n    }\n\n    var usesSH =\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._sphericalHarmonicCoefficients) ||\n      this._useDefaultSphericalHarmonics;\n    var usesSM =\n      ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._specularEnvironmentMapAtlas) &&\n        this._specularEnvironmentMapAtlas.ready) ||\n      this._useDefaultSpecularMaps;\n\n    if (usesSH || usesSM) {\n      var iblReferenceFrameMatrix3 = scratchIBLReferenceFrameMatrix3;\n      var iblReferenceFrameMatrix4 = scratchIBLReferenceFrameMatrix4;\n\n      iblReferenceFrameMatrix4 = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].multiply */ .Z.multiply(\n        context.uniformState.view3D,\n        referenceMatrix,\n        iblReferenceFrameMatrix4\n      );\n      iblReferenceFrameMatrix3 = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"].getMatrix3 */ .Z.getMatrix3(\n        iblReferenceFrameMatrix4,\n        iblReferenceFrameMatrix3\n      );\n      iblReferenceFrameMatrix3 = _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].getRotation */ .Z.getRotation(\n        iblReferenceFrameMatrix3,\n        iblReferenceFrameMatrix3\n      );\n      this._iblReferenceFrameMatrix = _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"].transpose */ .Z.transpose(\n        iblReferenceFrameMatrix3,\n        this._iblReferenceFrameMatrix\n      );\n    }\n\n    var shouldRegenerateShaders = this._shouldRegenerateShaders;\n    shouldRegenerateShaders =\n      shouldRegenerateShaders ||\n      this._clippingPlanesState !== currentClippingPlanesState;\n    this._clippingPlanesState = currentClippingPlanesState;\n\n    // Regenerate shaders if color shading changed from last update\n    var currentlyColorShadingEnabled = isColorShadingEnabled(this);\n    if (currentlyColorShadingEnabled !== this._colorShadingEnabled) {\n      this._colorShadingEnabled = currentlyColorShadingEnabled;\n      shouldRegenerateShaders = true;\n    }\n\n    if (shouldRegenerateShaders) {\n      regenerateShaders(this, frameState);\n    } else {\n      updateColor(this, frameState, false);\n      updateBackFaceCulling(this, frameState, false);\n      updateSilhouette(this, frameState, false);\n    }\n  }\n\n  if (justLoaded) {\n    // Called after modelMatrix update.\n    var model = this;\n    frameState.afterRender.push(function () {\n      model._ready = true;\n      model._readyPromise.resolve(model);\n    });\n    return;\n  }\n\n  // We don\'t check show at the top of the function since we\n  // want to be able to progressively load models when they are not shown,\n  // and then have them visible immediately when show is set to true.\n  if (show && !this._ignoreCommands) {\n    // PERFORMANCE_IDEA: This is terrible\n    var commandList = frameState.commandList;\n    var passes = frameState.passes;\n    var nodeCommands = this._nodeCommands;\n    var length = nodeCommands.length;\n    var i;\n    var nc;\n\n    var idl2D =\n      frameState.mapProjection.ellipsoid.maximumRadius * _Core_Math_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].PI */ .Z.PI;\n    var boundingVolume;\n\n    if (passes.render || (passes.pick && this.allowPicking)) {\n      for (i = 0; i < length; ++i) {\n        nc = nodeCommands[i];\n        if (nc.show) {\n          var command = nc.command;\n          if (silhouette) {\n            command = nc.silhouetteModelCommand;\n          } else if (translucent) {\n            command = nc.translucentCommand;\n          } else if (!backFaceCulling) {\n            command = nc.disableCullingCommand;\n          }\n          commandList.push(command);\n          boundingVolume = nc.command.boundingVolume;\n          if (\n            frameState.mode === _SceneMode_js__WEBPACK_IMPORTED_MODULE_71__/* ["default"].SCENE2D */ .Z.SCENE2D &&\n            (boundingVolume.center.y + boundingVolume.radius > idl2D ||\n              boundingVolume.center.y - boundingVolume.radius < idl2D)\n          ) {\n            var command2D = nc.command2D;\n            if (silhouette) {\n              command2D = nc.silhouetteModelCommand2D;\n            } else if (translucent) {\n              command2D = nc.translucentCommand2D;\n            } else if (!backFaceCulling) {\n              command2D = nc.disableCullingCommand2D;\n            }\n            commandList.push(command2D);\n          }\n        }\n      }\n\n      if (silhouette && !passes.pick) {\n        // Render second silhouette pass\n        for (i = 0; i < length; ++i) {\n          nc = nodeCommands[i];\n          if (nc.show) {\n            commandList.push(nc.silhouetteColorCommand);\n            boundingVolume = nc.command.boundingVolume;\n            if (\n              frameState.mode === _SceneMode_js__WEBPACK_IMPORTED_MODULE_71__/* ["default"].SCENE2D */ .Z.SCENE2D &&\n              (boundingVolume.center.y + boundingVolume.radius > idl2D ||\n                boundingVolume.center.y - boundingVolume.radius < idl2D)\n            ) {\n              commandList.push(nc.silhouetteColorCommand2D);\n            }\n          }\n        }\n      }\n    }\n  }\n\n  var credit = this._credit;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(credit)) {\n    frameState.creditDisplay.addCredit(credit);\n  }\n\n  var resourceCredits = this._resourceCredits;\n  var creditCount = resourceCredits.length;\n  for (var c = 0; c < creditCount; c++) {\n    frameState.creditDisplay.addCredit(resourceCredits[c]);\n  }\n};\n\nfunction destroyIfNotCached(rendererResources, cachedRendererResources) {\n  if (rendererResources.programs !== cachedRendererResources.programs) {\n    destroy(rendererResources.programs);\n  }\n  if (\n    rendererResources.silhouettePrograms !==\n    cachedRendererResources.silhouettePrograms\n  ) {\n    destroy(rendererResources.silhouettePrograms);\n  }\n}\n\n// Run from update iff:\n// - everything is loaded\n// - clipping planes state change OR color state set\n// Run this from destructor after removing color state and clipping plane state\nfunction regenerateShaders(model, frameState) {\n  // In regards to _cachedRendererResources:\n  // Fair to assume that this is data that should just never get modified due to clipping planes or model color.\n  // So if clipping planes or model color active:\n  // - delink _rendererResources.*programs and create new dictionaries.\n  // - do NOT destroy any programs - might be used by copies of the model or by might be needed in the future if clipping planes/model color is deactivated\n\n  // If clipping planes and model color inactive:\n  // - destroy _rendererResources.*programs\n  // - relink _rendererResources.*programs to _cachedRendererResources\n\n  // In both cases, need to mark commands as dirty, re-run derived commands (elsewhere)\n\n  var rendererResources = model._rendererResources;\n  var cachedRendererResources = model._cachedRendererResources;\n  destroyIfNotCached(rendererResources, cachedRendererResources);\n\n  var programId;\n  if (\n    isClippingEnabled(model) ||\n    isColorShadingEnabled(model) ||\n    model._shouldRegenerateShaders\n  ) {\n    model._shouldRegenerateShaders = false;\n\n    rendererResources.programs = {};\n    rendererResources.silhouettePrograms = {};\n\n    var visitedPrograms = {};\n    var techniques = model._sourceTechniques;\n    var technique;\n\n    for (var techniqueId in techniques) {\n      if (techniques.hasOwnProperty(techniqueId)) {\n        technique = techniques[techniqueId];\n        programId = technique.program;\n        if (!visitedPrograms[programId]) {\n          visitedPrograms[programId] = true;\n          recreateProgram(\n            {\n              programId: programId,\n              techniqueId: techniqueId,\n            },\n            model,\n            frameState.context\n          );\n        }\n      }\n    }\n  } else {\n    rendererResources.programs = cachedRendererResources.programs;\n    rendererResources.silhouettePrograms =\n      cachedRendererResources.silhouettePrograms;\n  }\n\n  // Fix all the commands, marking them as dirty so everything that derives will re-derive\n  var rendererPrograms = rendererResources.programs;\n\n  var nodeCommands = model._nodeCommands;\n  var commandCount = nodeCommands.length;\n  for (var i = 0; i < commandCount; ++i) {\n    var nodeCommand = nodeCommands[i];\n    programId = nodeCommand.programId;\n\n    var renderProgram = rendererPrograms[programId];\n    nodeCommand.command.shaderProgram = renderProgram;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(nodeCommand.command2D)) {\n      nodeCommand.command2D.shaderProgram = renderProgram;\n    }\n  }\n\n  // Force update silhouette commands/shaders\n  updateColor(model, frameState, true);\n  updateBackFaceCulling(model, frameState, true);\n  updateSilhouette(model, frameState, true);\n}\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <br /><br />\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n *\n * @returns {Boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n *\n * @see Model#destroy\n */\nModel.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the WebGL resources held by this object.  Destroying an object allows for deterministic\n * release of WebGL resources, instead of relying on the garbage collector to destroy this object.\n * <br /><br />\n * Once an object is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n *\n * @example\n * model = model && model.destroy();\n *\n * @see Model#isDestroyed\n */\nModel.prototype.destroy = function () {\n  // Vertex arrays are unique to this model, destroy here.\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._precreatedAttributes)) {\n    destroy(this._rendererResources.vertexArrays);\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._removeUpdateHeightCallback)) {\n    this._removeUpdateHeightCallback();\n    this._removeUpdateHeightCallback = undefined;\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._terrainProviderChangedCallback)) {\n    this._terrainProviderChangedCallback();\n    this._terrainProviderChangedCallback = undefined;\n  }\n\n  // Shaders modified for clipping and for color don\'t get cached, so destroy these manually\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(this._cachedRendererResources)) {\n    destroyIfNotCached(this._rendererResources, this._cachedRendererResources);\n  }\n\n  this._rendererResources = undefined;\n  this._cachedRendererResources =\n    this._cachedRendererResources && this._cachedRendererResources.release();\n  _DracoLoader_js__WEBPACK_IMPORTED_MODULE_55__/* ["default"].destroyCachedDataForModel */ .Z.destroyCachedDataForModel(this);\n\n  var pickIds = this._pickIds;\n  var length = pickIds.length;\n  for (var i = 0; i < length; ++i) {\n    pickIds[i].destroy();\n  }\n\n  releaseCachedGltf(this);\n  this._quantizedVertexShaders = undefined;\n\n  // Only destroy the ClippingPlaneCollection if this is the owner - if this model is part of a Cesium3DTileset,\n  // _clippingPlanes references a ClippingPlaneCollection that this model does not own.\n  var clippingPlaneCollection = this._clippingPlanes;\n  if (\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_74__/* ["default"] */ .Z)(clippingPlaneCollection) &&\n    !clippingPlaneCollection.isDestroyed() &&\n    clippingPlaneCollection.owner === this\n  ) {\n    clippingPlaneCollection.destroy();\n  }\n  this._clippingPlanes = undefined;\n\n  this._specularEnvironmentMapAtlas =\n    this._specularEnvironmentMapAtlas &&\n    this._specularEnvironmentMapAtlas.destroy();\n\n  return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z)(this);\n};\n\n// exposed for testing\nModel._getClippingFunction = _getClippingFunction_js__WEBPACK_IMPORTED_MODULE_57__/* ["default"] */ .Z;\nModel._modifyShaderForColor = modifyShaderForColor;\n/* harmony default export */ __webpack_exports__["Z"] = (Model);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU87QUFDYjtBQUNBO0FBQ0E7O0FBRUEsTUFBTSxzRUFBTztBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLE1BQU0sc0VBQU87QUFDYjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUUscUhBQXFDOztBQUV2QztBQUNBO0FBQ0Esa0JBQWtCLFlBQVk7QUFDOUI7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxzRUFBTztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsU0FBUyw0RUFBYTtBQUN0Qjs7QUFFQTtBQUNBLDZCQUE2Qix5RUFBbUI7QUFDaEQ7QUFDQSx5REFBZSxLQUFLLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92dWUzLXdlYnBhY2s1Ly4vbm9kZV9tb2R1bGVzL2Nlc2l1bS9Tb3VyY2UvU2NlbmUvTW9kZWwuanM/NzI4MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQm91bmRpbmdTcGhlcmUgZnJvbSBcIi4uL0NvcmUvQm91bmRpbmdTcGhlcmUuanNcIjtcbmltcG9ydCBDYXJ0ZXNpYW4yIGZyb20gXCIuLi9Db3JlL0NhcnRlc2lhbjIuanNcIjtcbmltcG9ydCBDYXJ0ZXNpYW4zIGZyb20gXCIuLi9Db3JlL0NhcnRlc2lhbjMuanNcIjtcbmltcG9ydCBDYXJ0ZXNpYW40IGZyb20gXCIuLi9Db3JlL0NhcnRlc2lhbjQuanNcIjtcbmltcG9ydCBDYXJ0b2dyYXBoaWMgZnJvbSBcIi4uL0NvcmUvQ2FydG9ncmFwaGljLmpzXCI7XG5pbXBvcnQgQ2hlY2sgZnJvbSBcIi4uL0NvcmUvQ2hlY2suanNcIjtcbmltcG9ydCBjbG9uZSBmcm9tIFwiLi4vQ29yZS9jbG9uZS5qc1wiO1xuaW1wb3J0IENvbG9yIGZyb20gXCIuLi9Db3JlL0NvbG9yLmpzXCI7XG5pbXBvcnQgY29tYmluZSBmcm9tIFwiLi4vQ29yZS9jb21iaW5lLmpzXCI7XG5pbXBvcnQgY3JlYXRlR3VpZCBmcm9tIFwiLi4vQ29yZS9jcmVhdGVHdWlkLmpzXCI7XG5pbXBvcnQgQ3JlZGl0IGZyb20gXCIuLi9Db3JlL0NyZWRpdC5qc1wiO1xuaW1wb3J0IGRlZmF1bHRWYWx1ZSBmcm9tIFwiLi4vQ29yZS9kZWZhdWx0VmFsdWUuanNcIjtcbmltcG9ydCBkZWZpbmVkIGZyb20gXCIuLi9Db3JlL2RlZmluZWQuanNcIjtcbmltcG9ydCBkZXN0cm95T2JqZWN0IGZyb20gXCIuLi9Db3JlL2Rlc3Ryb3lPYmplY3QuanNcIjtcbmltcG9ydCBEZXZlbG9wZXJFcnJvciBmcm9tIFwiLi4vQ29yZS9EZXZlbG9wZXJFcnJvci5qc1wiO1xuaW1wb3J0IERpc3RhbmNlRGlzcGxheUNvbmRpdGlvbiBmcm9tIFwiLi4vQ29yZS9EaXN0YW5jZURpc3BsYXlDb25kaXRpb24uanNcIjtcbmltcG9ydCBGZWF0dXJlRGV0ZWN0aW9uIGZyb20gXCIuLi9Db3JlL0ZlYXR1cmVEZXRlY3Rpb24uanNcIjtcbmltcG9ydCBnZXRBYnNvbHV0ZVVyaSBmcm9tIFwiLi4vQ29yZS9nZXRBYnNvbHV0ZVVyaS5qc1wiO1xuaW1wb3J0IGdldEpzb25Gcm9tVHlwZWRBcnJheSBmcm9tIFwiLi4vQ29yZS9nZXRKc29uRnJvbVR5cGVkQXJyYXkuanNcIjtcbmltcG9ydCBnZXRNYWdpYyBmcm9tIFwiLi4vQ29yZS9nZXRNYWdpYy5qc1wiO1xuaW1wb3J0IGdldFN0cmluZ0Zyb21UeXBlZEFycmF5IGZyb20gXCIuLi9Db3JlL2dldFN0cmluZ0Zyb21UeXBlZEFycmF5LmpzXCI7XG5pbXBvcnQgSW5kZXhEYXRhdHlwZSBmcm9tIFwiLi4vQ29yZS9JbmRleERhdGF0eXBlLmpzXCI7XG5pbXBvcnQgbG9hZEltYWdlRnJvbVR5cGVkQXJyYXkgZnJvbSBcIi4uL0NvcmUvbG9hZEltYWdlRnJvbVR5cGVkQXJyYXkuanNcIjtcbmltcG9ydCBsb2FkS1RYMiBmcm9tIFwiLi4vQ29yZS9sb2FkS1RYMi5qc1wiO1xuaW1wb3J0IENlc2l1bU1hdGggZnJvbSBcIi4uL0NvcmUvTWF0aC5qc1wiO1xuaW1wb3J0IE1hdHJpeDMgZnJvbSBcIi4uL0NvcmUvTWF0cml4My5qc1wiO1xuaW1wb3J0IE1hdHJpeDQgZnJvbSBcIi4uL0NvcmUvTWF0cml4NC5qc1wiO1xuaW1wb3J0IFBpeGVsRm9ybWF0IGZyb20gXCIuLi9Db3JlL1BpeGVsRm9ybWF0LmpzXCI7XG5pbXBvcnQgUHJpbWl0aXZlVHlwZSBmcm9tIFwiLi4vQ29yZS9QcmltaXRpdmVUeXBlLmpzXCI7XG5pbXBvcnQgUXVhdGVybmlvbiBmcm9tIFwiLi4vQ29yZS9RdWF0ZXJuaW9uLmpzXCI7XG5pbXBvcnQgUmVzb3VyY2UgZnJvbSBcIi4uL0NvcmUvUmVzb3VyY2UuanNcIjtcbmltcG9ydCBUcmFuc2Zvcm1zIGZyb20gXCIuLi9Db3JlL1RyYW5zZm9ybXMuanNcIjtcbmltcG9ydCBXZWJHTENvbnN0YW50cyBmcm9tIFwiLi4vQ29yZS9XZWJHTENvbnN0YW50cy5qc1wiO1xuaW1wb3J0IEJ1ZmZlciBmcm9tIFwiLi4vUmVuZGVyZXIvQnVmZmVyLmpzXCI7XG5pbXBvcnQgQnVmZmVyVXNhZ2UgZnJvbSBcIi4uL1JlbmRlcmVyL0J1ZmZlclVzYWdlLmpzXCI7XG5pbXBvcnQgRHJhd0NvbW1hbmQgZnJvbSBcIi4uL1JlbmRlcmVyL0RyYXdDb21tYW5kLmpzXCI7XG5pbXBvcnQgUGFzcyBmcm9tIFwiLi4vUmVuZGVyZXIvUGFzcy5qc1wiO1xuaW1wb3J0IFJlbmRlclN0YXRlIGZyb20gXCIuLi9SZW5kZXJlci9SZW5kZXJTdGF0ZS5qc1wiO1xuaW1wb3J0IFNhbXBsZXIgZnJvbSBcIi4uL1JlbmRlcmVyL1NhbXBsZXIuanNcIjtcbmltcG9ydCBTaGFkZXJQcm9ncmFtIGZyb20gXCIuLi9SZW5kZXJlci9TaGFkZXJQcm9ncmFtLmpzXCI7XG5pbXBvcnQgU2hhZGVyU291cmNlIGZyb20gXCIuLi9SZW5kZXJlci9TaGFkZXJTb3VyY2UuanNcIjtcbmltcG9ydCBUZXh0dXJlIGZyb20gXCIuLi9SZW5kZXJlci9UZXh0dXJlLmpzXCI7XG5pbXBvcnQgVGV4dHVyZU1pbmlmaWNhdGlvbkZpbHRlciBmcm9tIFwiLi4vUmVuZGVyZXIvVGV4dHVyZU1pbmlmaWNhdGlvbkZpbHRlci5qc1wiO1xuaW1wb3J0IFRleHR1cmVXcmFwIGZyb20gXCIuLi9SZW5kZXJlci9UZXh0dXJlV3JhcC5qc1wiO1xuaW1wb3J0IFZlcnRleEFycmF5IGZyb20gXCIuLi9SZW5kZXJlci9WZXJ0ZXhBcnJheS5qc1wiO1xuaW1wb3J0IGFkZERlZmF1bHRzIGZyb20gXCIuL0dsdGZQaXBlbGluZS9hZGREZWZhdWx0cy5qc1wiO1xuaW1wb3J0IGFkZFBpcGVsaW5lRXh0cmFzIGZyb20gXCIuL0dsdGZQaXBlbGluZS9hZGRQaXBlbGluZUV4dHJhcy5qc1wiO1xuaW1wb3J0IEZvckVhY2ggZnJvbSBcIi4vR2x0ZlBpcGVsaW5lL0ZvckVhY2guanNcIjtcbmltcG9ydCBnZXRBY2Nlc3NvckJ5dGVTdHJpZGUgZnJvbSBcIi4vR2x0ZlBpcGVsaW5lL2dldEFjY2Vzc29yQnl0ZVN0cmlkZS5qc1wiO1xuaW1wb3J0IHVzZXNFeHRlbnNpb24gZnJvbSBcIi4vR2x0ZlBpcGVsaW5lL3VzZXNFeHRlbnNpb24uanNcIjtcbmltcG9ydCBudW1iZXJPZkNvbXBvbmVudHNGb3JUeXBlIGZyb20gXCIuL0dsdGZQaXBlbGluZS9udW1iZXJPZkNvbXBvbmVudHNGb3JUeXBlLmpzXCI7XG5pbXBvcnQgcGFyc2VHbGIgZnJvbSBcIi4vR2x0ZlBpcGVsaW5lL3BhcnNlR2xiLmpzXCI7XG5pbXBvcnQgdXBkYXRlVmVyc2lvbiBmcm9tIFwiLi9HbHRmUGlwZWxpbmUvdXBkYXRlVmVyc2lvbi5qc1wiO1xuaW1wb3J0IHdoZW4gZnJvbSBcIi4uL1RoaXJkUGFydHkvd2hlbi5qc1wiO1xuaW1wb3J0IEF4aXMgZnJvbSBcIi4vQXhpcy5qc1wiO1xuaW1wb3J0IEJsZW5kaW5nU3RhdGUgZnJvbSBcIi4vQmxlbmRpbmdTdGF0ZS5qc1wiO1xuaW1wb3J0IENsaXBwaW5nUGxhbmVDb2xsZWN0aW9uIGZyb20gXCIuL0NsaXBwaW5nUGxhbmVDb2xsZWN0aW9uLmpzXCI7XG5pbXBvcnQgQ29sb3JCbGVuZE1vZGUgZnJvbSBcIi4vQ29sb3JCbGVuZE1vZGUuanNcIjtcbmltcG9ydCBEZXB0aEZ1bmN0aW9uIGZyb20gXCIuL0RlcHRoRnVuY3Rpb24uanNcIjtcbmltcG9ydCBEcmFjb0xvYWRlciBmcm9tIFwiLi9EcmFjb0xvYWRlci5qc1wiO1xuaW1wb3J0IGdldENsaXBBbmRTdHlsZUNvZGUgZnJvbSBcIi4vZ2V0Q2xpcEFuZFN0eWxlQ29kZS5qc1wiO1xuaW1wb3J0IGdldENsaXBwaW5nRnVuY3Rpb24gZnJvbSBcIi4vZ2V0Q2xpcHBpbmdGdW5jdGlvbi5qc1wiO1xuaW1wb3J0IEhlaWdodFJlZmVyZW5jZSBmcm9tIFwiLi9IZWlnaHRSZWZlcmVuY2UuanNcIjtcbmltcG9ydCBKb2JUeXBlIGZyb20gXCIuL0pvYlR5cGUuanNcIjtcbmltcG9ydCBNb2RlbEFuaW1hdGlvbkNhY2hlIGZyb20gXCIuL01vZGVsQW5pbWF0aW9uQ2FjaGUuanNcIjtcbmltcG9ydCBNb2RlbEFuaW1hdGlvbkNvbGxlY3Rpb24gZnJvbSBcIi4vTW9kZWxBbmltYXRpb25Db2xsZWN0aW9uLmpzXCI7XG5pbXBvcnQgTW9kZWxMb2FkUmVzb3VyY2VzIGZyb20gXCIuL01vZGVsTG9hZFJlc291cmNlcy5qc1wiO1xuaW1wb3J0IE1vZGVsTWF0ZXJpYWwgZnJvbSBcIi4vTW9kZWxNYXRlcmlhbC5qc1wiO1xuaW1wb3J0IE1vZGVsTWVzaCBmcm9tIFwiLi9Nb2RlbE1lc2guanNcIjtcbmltcG9ydCBNb2RlbE5vZGUgZnJvbSBcIi4vTW9kZWxOb2RlLmpzXCI7XG5pbXBvcnQgTW9kZWxPdXRsaW5lTG9hZGVyIGZyb20gXCIuL01vZGVsT3V0bGluZUxvYWRlci5qc1wiO1xuaW1wb3J0IE1vZGVsVXRpbGl0eSBmcm9tIFwiLi9Nb2RlbFV0aWxpdHkuanNcIjtcbmltcG9ydCBPY3RhaGVkcmFsUHJvamVjdGVkQ3ViZU1hcCBmcm9tIFwiLi9PY3RhaGVkcmFsUHJvamVjdGVkQ3ViZU1hcC5qc1wiO1xuaW1wb3J0IHByb2Nlc3NNb2RlbE1hdGVyaWFsc0NvbW1vbiBmcm9tIFwiLi9wcm9jZXNzTW9kZWxNYXRlcmlhbHNDb21tb24uanNcIjtcbmltcG9ydCBwcm9jZXNzUGJyTWF0ZXJpYWxzIGZyb20gXCIuL3Byb2Nlc3NQYnJNYXRlcmlhbHMuanNcIjtcbmltcG9ydCBTY2VuZU1vZGUgZnJvbSBcIi4vU2NlbmVNb2RlLmpzXCI7XG5pbXBvcnQgU2hhZG93TW9kZSBmcm9tIFwiLi9TaGFkb3dNb2RlLmpzXCI7XG5pbXBvcnQgU3RlbmNpbENvbnN0YW50cyBmcm9tIFwiLi9TdGVuY2lsQ29uc3RhbnRzLmpzXCI7XG5cbnZhciBib3VuZGluZ1NwaGVyZUNhcnRlc2lhbjNTY3JhdGNoID0gbmV3IENhcnRlc2lhbjMoKTtcblxudmFyIE1vZGVsU3RhdGUgPSBNb2RlbFV0aWxpdHkuTW9kZWxTdGF0ZTtcblxuLy8gZ2xURiBNSU1FIHR5cGVzIGRpc2N1c3NlZCBpbiBodHRwczovL2dpdGh1Yi5jb20vS2hyb25vc0dyb3VwL2dsVEYvaXNzdWVzLzQxMiBhbmQgaHR0cHM6Ly9naXRodWIuY29tL0tocm9ub3NHcm91cC9nbFRGL2lzc3Vlcy85NDNcbnZhciBkZWZhdWx0TW9kZWxBY2NlcHQgPVxuICBcIm1vZGVsL2dsdGYtYmluYXJ5LG1vZGVsL2dsdGYranNvbjtxPTAuOCxhcHBsaWNhdGlvbi9qc29uO3E9MC4yLCovKjtxPTAuMDFcIjtcblxudmFyIGFydGljdWxhdGlvbkVwc2lsb24gPSBDZXNpdW1NYXRoLkVQU0lMT04xNjtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbmZ1bmN0aW9uIHNldENhY2hlZEdsdGYobW9kZWwsIGNhY2hlZEdsdGYpIHtcbiAgbW9kZWwuX2NhY2hlZEdsdGYgPSBjYWNoZWRHbHRmO1xufVxuXG4vLyBnbFRGIEpTT04gY2FuIGJlIGJpZyBnaXZlbiBlbWJlZGRlZCBnZW9tZXRyeSwgdGV4dHVyZXMsIGFuZCBhbmltYXRpb25zLCBzbyB3ZVxuLy8gY2FjaGUgaXQgYWNyb3NzIGFsbCBtb2RlbHMgdXNpbmcgdGhlIHNhbWUgdXJsL2NhY2hlLWtleS4gIFRoaXMgYWxzbyByZWR1Y2VzIHRoZVxuLy8gc2xpZ2h0IG92ZXJoZWFkIGluIGFzc2lnbmluZyBkZWZhdWx0cyB0byBtaXNzaW5nIHZhbHVlcy5cbi8vXG4vLyBOb3RlIHRoYXQgdGhpcyBpcyBhIGdsb2JhbCBjYWNoZSwgY29tcGFyZWQgdG8gcmVuZGVyZXIgcmVzb3VyY2VzLCB3aGljaFxuLy8gYXJlIGNhY2hlZCBwZXIgY29udGV4dC5cbmZ1bmN0aW9uIENhY2hlZEdsdGYob3B0aW9ucykge1xuICB0aGlzLl9nbHRmID0gb3B0aW9ucy5nbHRmO1xuICB0aGlzLnJlYWR5ID0gb3B0aW9ucy5yZWFkeTtcbiAgdGhpcy5tb2RlbHNUb0xvYWQgPSBbXTtcbiAgdGhpcy5jb3VudCA9IDA7XG59XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKENhY2hlZEdsdGYucHJvdG90eXBlLCB7XG4gIGdsdGY6IHtcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgdGhpcy5fZ2x0ZiA9IHZhbHVlO1xuICAgIH0sXG5cbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9nbHRmO1xuICAgIH0sXG4gIH0sXG59KTtcblxuQ2FjaGVkR2x0Zi5wcm90b3R5cGUubWFrZVJlYWR5ID0gZnVuY3Rpb24gKGdsdGZKc29uKSB7XG4gIHRoaXMuZ2x0ZiA9IGdsdGZKc29uO1xuXG4gIHZhciBtb2RlbHMgPSB0aGlzLm1vZGVsc1RvTG9hZDtcbiAgdmFyIGxlbmd0aCA9IG1vZGVscy5sZW5ndGg7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgbSA9IG1vZGVsc1tpXTtcbiAgICBpZiAoIW0uaXNEZXN0cm95ZWQoKSkge1xuICAgICAgc2V0Q2FjaGVkR2x0ZihtLCB0aGlzKTtcbiAgICB9XG4gIH1cbiAgdGhpcy5tb2RlbHNUb0xvYWQgPSB1bmRlZmluZWQ7XG4gIHRoaXMucmVhZHkgPSB0cnVlO1xufTtcblxudmFyIGdsdGZDYWNoZSA9IHt9O1xudmFyIHVyaVRvR3VpZCA9IHt9O1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbi8qKlxuICogQSAzRCBtb2RlbCBiYXNlZCBvbiBnbFRGLCB0aGUgcnVudGltZSBhc3NldCBmb3JtYXQgZm9yIFdlYkdMLCBPcGVuR0wgRVMsIGFuZCBPcGVuR0wuXG4gKiA8cD5cbiAqIENlc2l1bSBpbmNsdWRlcyBzdXBwb3J0IGZvciBnZW9tZXRyeSBhbmQgbWF0ZXJpYWxzLCBnbFRGIGFuaW1hdGlvbnMsIGFuZCBnbFRGIHNraW5uaW5nLlxuICogSW4gYWRkaXRpb24sIGluZGl2aWR1YWwgZ2xURiBub2RlcyBhcmUgcGlja2FibGUgd2l0aCB7QGxpbmsgU2NlbmUjcGlja30gYW5kIGFuaW1hdGFibGVcbiAqIHdpdGgge0BsaW5rIE1vZGVsI2dldE5vZGV9LiAgZ2xURiBjYW1lcmFzIGFuZCBsaWdodHMgYXJlIG5vdCBjdXJyZW50bHkgc3VwcG9ydGVkLlxuICogPC9wPlxuICogPHA+XG4gKiBBbiBleHRlcm5hbCBnbFRGIGFzc2V0IGlzIGNyZWF0ZWQgd2l0aCB7QGxpbmsgTW9kZWwuZnJvbUdsdGZ9LiAgZ2xURiBKU09OIGNhbiBhbHNvIGJlXG4gKiBjcmVhdGVkIGF0IHJ1bnRpbWUgYW5kIHBhc3NlZCB0byB0aGlzIGNvbnN0cnVjdG9yIGZ1bmN0aW9uLiAgSW4gZWl0aGVyIGNhc2UsIHRoZVxuICoge0BsaW5rIE1vZGVsI3JlYWR5UHJvbWlzZX0gaXMgcmVzb2x2ZWQgd2hlbiB0aGUgbW9kZWwgaXMgcmVhZHkgdG8gcmVuZGVyLCBpLmUuLFxuICogd2hlbiB0aGUgZXh0ZXJuYWwgYmluYXJ5LCBpbWFnZSwgYW5kIHNoYWRlciBmaWxlcyBhcmUgZG93bmxvYWRlZCBhbmQgdGhlIFdlYkdMXG4gKiByZXNvdXJjZXMgYXJlIGNyZWF0ZWQuXG4gKiA8L3A+XG4gKiA8cD5cbiAqIENlc2l1bSBzdXBwb3J0cyBnbFRGIGFzc2V0cyB3aXRoIHRoZSBmb2xsb3dpbmcgZXh0ZW5zaW9uczpcbiAqIDx1bD5cbiAqIDxsaT5cbiAqIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vS2hyb25vc0dyb3VwL2dsVEYvYmxvYi9tYXN0ZXIvZXh0ZW5zaW9ucy8xLjAvS2hyb25vcy9LSFJfYmluYXJ5X2dsVEYvUkVBRE1FLm1kfEtIUl9iaW5hcnlfZ2xURiAoZ2xURiAxLjApfVxuICogPC9saT48bGk+XG4gKiB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL0tocm9ub3NHcm91cC9nbFRGL2Jsb2IvbWFzdGVyL2V4dGVuc2lvbnMvMS4wL0tocm9ub3MvS0hSX21hdGVyaWFsc19jb21tb24vUkVBRE1FLm1kfEtIUl9tYXRlcmlhbHNfY29tbW9uIChnbFRGIDEuMCl9XG4gKiA8L2xpPjxsaT5cbiAqIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vS2hyb25vc0dyb3VwL2dsVEYvYmxvYi9tYXN0ZXIvZXh0ZW5zaW9ucy8xLjAvVmVuZG9yL1dFQjNEX3F1YW50aXplZF9hdHRyaWJ1dGVzL1JFQURNRS5tZHxXRUIzRF9xdWFudGl6ZWRfYXR0cmlidXRlcyAoZ2xURiAxLjApfVxuICogPC9saT48bGk+XG4gKiB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL0tocm9ub3NHcm91cC9nbFRGL3RyZWUvbWFzdGVyL2V4dGVuc2lvbnMvMi4wL1ZlbmRvci9BR0lfYXJ0aWN1bGF0aW9ucy9SRUFETUUubWR8QUdJX2FydGljdWxhdGlvbnN9XG4gKiA8L2xpPjxsaT5cbiAqIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vS2hyb25vc0dyb3VwL2dsVEYvcHVsbC8xMzAyfEtIUl9ibGVuZCAoZHJhZnQpfVxuICogPC9saT48bGk+XG4gKiB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL0tocm9ub3NHcm91cC9nbFRGL2Jsb2IvbWFzdGVyL2V4dGVuc2lvbnMvMi4wL0tocm9ub3MvS0hSX2RyYWNvX21lc2hfY29tcHJlc3Npb24vUkVBRE1FLm1kfEtIUl9kcmFjb19tZXNoX2NvbXByZXNzaW9ufVxuICogPC9saT48bGk+XG4gKiB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL0tocm9ub3NHcm91cC9nbFRGL3RyZWUvbWFzdGVyL2V4dGVuc2lvbnMvMi4wL0tocm9ub3MvS0hSX21hdGVyaWFsc19wYnJTcGVjdWxhckdsb3NzaW5lc3MvUkVBRE1FLm1kfEtIUl9tYXRlcmlhbHNfcGJyU3BlY3VsYXJHbG9zc2luZXNzfVxuICogPC9saT48bGk+XG4gKiB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL0tocm9ub3NHcm91cC9nbFRGL3RyZWUvbWFzdGVyL2V4dGVuc2lvbnMvMi4wL0tocm9ub3MvS0hSX21hdGVyaWFsc191bmxpdC9SRUFETUUubWR8S0hSX21hdGVyaWFsc191bmxpdH1cbiAqIDwvbGk+PGxpPlxuICoge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9LaHJvbm9zR3JvdXAvZ2xURi9ibG9iL21hc3Rlci9leHRlbnNpb25zLzIuMC9LaHJvbm9zL0tIUl90ZWNobmlxdWVzX3dlYmdsL1JFQURNRS5tZHxLSFJfdGVjaG5pcXVlc193ZWJnbH1cbiAqIDwvbGk+PGxpPlxuICoge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9LaHJvbm9zR3JvdXAvZ2xURi9ibG9iL21hc3Rlci9leHRlbnNpb25zLzIuMC9LaHJvbm9zL0tIUl90ZXh0dXJlX3RyYW5zZm9ybS9SRUFETUUubWR8S0hSX3RleHR1cmVfdHJhbnNmb3JtfVxuICogPC9saT48bGk+XG4gKiB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL0tocm9ub3NHcm91cC9nbFRGL2Jsb2IvbWFzdGVyL2V4dGVuc2lvbnMvMi4wL0tocm9ub3MvS0hSX3RleHR1cmVfYmFzaXN1fEtIUl90ZXh0dXJlX2Jhc2lzdX1cbiAqIDwvbGk+XG4gKiA8L3VsPlxuICogPC9wPlxuICogPHA+XG4gKiBOb3RlOiBmb3IgbW9kZWxzIHdpdGggY29tcHJlc3NlZCB0ZXh0dXJlcyB1c2luZyB0aGUgS0hSX3RleHR1cmVfYmFzaXN1IGV4dGVuc2lvbiwgd2UgcmVjb21tZW5kIHBvd2VyIG9mIDIgdGV4dHVyZXMgaW4gYm90aCBkaW1lbnNpb25zXG4gKiBmb3IgbWF4aW11bSBjb21wYXRpYmlsaXR5LiBUaGlzIGlzIGJlY2F1c2Ugc29tZSBzYW1wbGVycyByZXF1aXJlIHBvd2VyIG9mIDIgdGV4dHVyZXMgKHtAbGluayBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvV2ViR0xfQVBJL1R1dG9yaWFsL1VzaW5nX3RleHR1cmVzX2luX1dlYkdMfFVzaW5nIHRleHR1cmVzIGluIFdlYkdMfSlcbiAqIGFuZCBLSFJfdGV4dHVyZV9iYXNpc3UgcmVxdWlyZXMgbXVsdGlwbGUgb2YgNCBkaW1lbnNpb25zICh7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL0tocm9ub3NHcm91cC9nbFRGL2Jsb2IvbWFzdGVyL2V4dGVuc2lvbnMvMi4wL0tocm9ub3MvS0hSX3RleHR1cmVfYmFzaXN1L1JFQURNRS5tZCNhZGRpdGlvbmFsLXJlcXVpcmVtZW50c3xLSFJfdGV4dHVyZV9iYXNpc3UgYWRkaXRpb25hbCByZXF1aXJlbWVudHN9KS5cbiAqIDwvcD5cbiAqIDxwPlxuICogRm9yIGhpZ2gtcHJlY2lzaW9uIHJlbmRlcmluZywgQ2VzaXVtIHN1cHBvcnRzIHRoZSB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL0tocm9ub3NHcm91cC9nbFRGL2Jsb2IvbWFzdGVyL2V4dGVuc2lvbnMvMS4wL1ZlbmRvci9DRVNJVU1fUlRDL1JFQURNRS5tZHxDRVNJVU1fUlRDfSBleHRlbnNpb24sIHdoaWNoIGludHJvZHVjZXMgdGhlXG4gKiBDRVNJVU1fUlRDX01PREVMVklFVyBwYXJhbWV0ZXIgc2VtYW50aWMgdGhhdCBzYXlzIHRoZSBub2RlIGlzIGluIFdHUzg0IGNvb3JkaW5hdGVzIHRyYW5zbGF0ZWRcbiAqIHJlbGF0aXZlIHRvIGEgbG9jYWwgb3JpZ2luLlxuICogPC9wPlxuICpcbiAqIEBhbGlhcyBNb2RlbFxuICogQGNvbnN0cnVjdG9yXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXSBPYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gKiBAcGFyYW0ge09iamVjdHxBcnJheUJ1ZmZlcnxVaW50OEFycmF5fSBbb3B0aW9ucy5nbHRmXSBBIGdsVEYgSlNPTiBvYmplY3QsIG9yIGEgYmluYXJ5IGdsVEYgYnVmZmVyLlxuICogQHBhcmFtIHtSZXNvdXJjZXxTdHJpbmd9IFtvcHRpb25zLmJhc2VQYXRoPScnXSBUaGUgYmFzZSBwYXRoIHRoYXQgcGF0aHMgaW4gdGhlIGdsVEYgSlNPTiBhcmUgcmVsYXRpdmUgdG8uXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLnNob3c9dHJ1ZV0gRGV0ZXJtaW5lcyBpZiB0aGUgbW9kZWwgcHJpbWl0aXZlIHdpbGwgYmUgc2hvd24uXG4gKiBAcGFyYW0ge01hdHJpeDR9IFtvcHRpb25zLm1vZGVsTWF0cml4PU1hdHJpeDQuSURFTlRJVFldIFRoZSA0eDQgdHJhbnNmb3JtYXRpb24gbWF0cml4IHRoYXQgdHJhbnNmb3JtcyB0aGUgbW9kZWwgZnJvbSBtb2RlbCB0byB3b3JsZCBjb29yZGluYXRlcy5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5zY2FsZT0xLjBdIEEgdW5pZm9ybSBzY2FsZSBhcHBsaWVkIHRvIHRoaXMgbW9kZWwuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMubWluaW11bVBpeGVsU2l6ZT0wLjBdIFRoZSBhcHByb3hpbWF0ZSBtaW5pbXVtIHBpeGVsIHNpemUgb2YgdGhlIG1vZGVsIHJlZ2FyZGxlc3Mgb2Ygem9vbS5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5tYXhpbXVtU2NhbGVdIFRoZSBtYXhpbXVtIHNjYWxlIHNpemUgb2YgYSBtb2RlbC4gQW4gdXBwZXIgbGltaXQgZm9yIG1pbmltdW1QaXhlbFNpemUuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMuaWRdIEEgdXNlci1kZWZpbmVkIG9iamVjdCB0byByZXR1cm4gd2hlbiB0aGUgbW9kZWwgaXMgcGlja2VkIHdpdGgge0BsaW5rIFNjZW5lI3BpY2t9LlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5hbGxvd1BpY2tpbmc9dHJ1ZV0gV2hlbiA8Y29kZT50cnVlPC9jb2RlPiwgZWFjaCBnbFRGIG1lc2ggYW5kIHByaW1pdGl2ZSBpcyBwaWNrYWJsZSB3aXRoIHtAbGluayBTY2VuZSNwaWNrfS5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuaW5jcmVtZW50YWxseUxvYWRUZXh0dXJlcz10cnVlXSBEZXRlcm1pbmUgaWYgdGV4dHVyZXMgbWF5IGNvbnRpbnVlIHRvIHN0cmVhbSBpbiBhZnRlciB0aGUgbW9kZWwgaXMgbG9hZGVkLlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5hc3luY2hyb25vdXM9dHJ1ZV0gRGV0ZXJtaW5lcyBpZiBtb2RlbCBXZWJHTCByZXNvdXJjZSBjcmVhdGlvbiB3aWxsIGJlIHNwcmVhZCBvdXQgb3ZlciBzZXZlcmFsIGZyYW1lcyBvciBibG9jayB1bnRpbCBjb21wbGV0aW9uIG9uY2UgYWxsIGdsVEYgZmlsZXMgYXJlIGxvYWRlZC5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuY2xhbXBBbmltYXRpb25zPXRydWVdIERldGVybWluZXMgaWYgdGhlIG1vZGVsJ3MgYW5pbWF0aW9ucyBzaG91bGQgaG9sZCBhIHBvc2Ugb3ZlciBmcmFtZXMgd2hlcmUgbm8ga2V5ZnJhbWVzIGFyZSBzcGVjaWZpZWQuXG4gKiBAcGFyYW0ge1NoYWRvd01vZGV9IFtvcHRpb25zLnNoYWRvd3M9U2hhZG93TW9kZS5FTkFCTEVEXSBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIG1vZGVsIGNhc3RzIG9yIHJlY2VpdmVzIHNoYWRvd3MgZnJvbSBsaWdodCBzb3VyY2VzLlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5kZWJ1Z1Nob3dCb3VuZGluZ1ZvbHVtZT1mYWxzZV0gRm9yIGRlYnVnZ2luZyBvbmx5LiBEcmF3cyB0aGUgYm91bmRpbmcgc3BoZXJlIGZvciBlYWNoIGRyYXcgY29tbWFuZCBpbiB0aGUgbW9kZWwuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmRlYnVnV2lyZWZyYW1lPWZhbHNlXSBGb3IgZGVidWdnaW5nIG9ubHkuIERyYXdzIHRoZSBtb2RlbCBpbiB3aXJlZnJhbWUuXG4gKiBAcGFyYW0ge0hlaWdodFJlZmVyZW5jZX0gW29wdGlvbnMuaGVpZ2h0UmVmZXJlbmNlPUhlaWdodFJlZmVyZW5jZS5OT05FXSBEZXRlcm1pbmVzIGhvdyB0aGUgbW9kZWwgaXMgZHJhd24gcmVsYXRpdmUgdG8gdGVycmFpbi5cbiAqIEBwYXJhbSB7U2NlbmV9IFtvcHRpb25zLnNjZW5lXSBNdXN0IGJlIHBhc3NlZCBpbiBmb3IgbW9kZWxzIHRoYXQgdXNlIHRoZSBoZWlnaHQgcmVmZXJlbmNlIHByb3BlcnR5LlxuICogQHBhcmFtIHtEaXN0YW5jZURpc3BsYXlDb25kaXRpb259IFtvcHRpb25zLmRpc3RhbmNlRGlzcGxheUNvbmRpdGlvbl0gVGhlIGNvbmRpdGlvbiBzcGVjaWZ5aW5nIGF0IHdoYXQgZGlzdGFuY2UgZnJvbSB0aGUgY2FtZXJhIHRoYXQgdGhpcyBtb2RlbCB3aWxsIGJlIGRpc3BsYXllZC5cbiAqIEBwYXJhbSB7Q29sb3J9IFtvcHRpb25zLmNvbG9yPUNvbG9yLldISVRFXSBBIGNvbG9yIHRoYXQgYmxlbmRzIHdpdGggdGhlIG1vZGVsJ3MgcmVuZGVyZWQgY29sb3IuXG4gKiBAcGFyYW0ge0NvbG9yQmxlbmRNb2RlfSBbb3B0aW9ucy5jb2xvckJsZW5kTW9kZT1Db2xvckJsZW5kTW9kZS5ISUdITElHSFRdIERlZmluZXMgaG93IHRoZSBjb2xvciBibGVuZHMgd2l0aCB0aGUgbW9kZWwuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMuY29sb3JCbGVuZEFtb3VudD0wLjVdIFZhbHVlIHVzZWQgdG8gZGV0ZXJtaW5lIHRoZSBjb2xvciBzdHJlbmd0aCB3aGVuIHRoZSA8Y29kZT5jb2xvckJsZW5kTW9kZTwvY29kZT4gaXMgPGNvZGU+TUlYPC9jb2RlPi4gQSB2YWx1ZSBvZiAwLjAgcmVzdWx0cyBpbiB0aGUgbW9kZWwncyByZW5kZXJlZCBjb2xvciB3aGlsZSBhIHZhbHVlIG9mIDEuMCByZXN1bHRzIGluIGEgc29saWQgY29sb3IsIHdpdGggYW55IHZhbHVlIGluLWJldHdlZW4gcmVzdWx0aW5nIGluIGEgbWl4IG9mIHRoZSB0d28uXG4gKiBAcGFyYW0ge0NvbG9yfSBbb3B0aW9ucy5zaWxob3VldHRlQ29sb3I9Q29sb3IuUkVEXSBUaGUgc2lsaG91ZXR0ZSBjb2xvci4gSWYgbW9yZSB0aGFuIDI1NiBtb2RlbHMgaGF2ZSBzaWxob3VldHRlcyBlbmFibGVkLCB0aGVyZSBpcyBhIHNtYWxsIGNoYW5jZSB0aGF0IG92ZXJsYXBwaW5nIG1vZGVscyB3aWxsIGhhdmUgbWlub3IgYXJ0aWZhY3RzLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLnNpbGhvdWV0dGVTaXplPTAuMF0gVGhlIHNpemUgb2YgdGhlIHNpbGhvdWV0dGUgaW4gcGl4ZWxzLlxuICogQHBhcmFtIHtDbGlwcGluZ1BsYW5lQ29sbGVjdGlvbn0gW29wdGlvbnMuY2xpcHBpbmdQbGFuZXNdIFRoZSB7QGxpbmsgQ2xpcHBpbmdQbGFuZUNvbGxlY3Rpb259IHVzZWQgdG8gc2VsZWN0aXZlbHkgZGlzYWJsZSByZW5kZXJpbmcgdGhlIG1vZGVsLlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5kZXF1YW50aXplSW5TaGFkZXI9dHJ1ZV0gRGV0ZXJtaW5lcyBpZiBhIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2RyYWNvfERyYWNvfSBlbmNvZGVkIG1vZGVsIGlzIGRlcXVhbnRpemVkIG9uIHRoZSBHUFUuIFRoaXMgZGVjcmVhc2VzIHRvdGFsIG1lbW9yeSB1c2FnZSBmb3IgZW5jb2RlZCBtb2RlbHMuXG4gKiBAcGFyYW0ge0NhcnRlc2lhbjJ9IFtvcHRpb25zLmltYWdlQmFzZWRMaWdodGluZ0ZhY3Rvcj1DYXJ0ZXNpYW4yKDEuMCwgMS4wKV0gU2NhbGVzIGRpZmZ1c2UgYW5kIHNwZWN1bGFyIGltYWdlLWJhc2VkIGxpZ2h0aW5nIGZyb20gdGhlIGVhcnRoLCBza3ksIGF0bW9zcGhlcmUgYW5kIHN0YXIgc2t5Ym94LlxuICogQHBhcmFtIHtDYXJ0ZXNpYW4zfSBbb3B0aW9ucy5saWdodENvbG9yXSBUaGUgbGlnaHQgY29sb3Igd2hlbiBzaGFkaW5nIHRoZSBtb2RlbC4gV2hlbiA8Y29kZT51bmRlZmluZWQ8L2NvZGU+IHRoZSBzY2VuZSdzIGxpZ2h0IGNvbG9yIGlzIHVzZWQgaW5zdGVhZC5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5sdW1pbmFuY2VBdFplbml0aD0wLjJdIFRoZSBzdW4ncyBsdW1pbmFuY2UgYXQgdGhlIHplbml0aCBpbiBraWxvIGNhbmRlbGEgcGVyIG1ldGVyIHNxdWFyZWQgdG8gdXNlIGZvciB0aGlzIG1vZGVsJ3MgcHJvY2VkdXJhbCBlbnZpcm9ubWVudCBtYXAuXG4gKiBAcGFyYW0ge0NhcnRlc2lhbjNbXX0gW29wdGlvbnMuc3BoZXJpY2FsSGFybW9uaWNDb2VmZmljaWVudHNdIFRoZSB0aGlyZCBvcmRlciBzcGhlcmljYWwgaGFybW9uaWMgY29lZmZpY2llbnRzIHVzZWQgZm9yIHRoZSBkaWZmdXNlIGNvbG9yIG9mIGltYWdlLWJhc2VkIGxpZ2h0aW5nLlxuICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLnNwZWN1bGFyRW52aXJvbm1lbnRNYXBzXSBBIFVSTCB0byBhIEtUWDIgZmlsZSB0aGF0IGNvbnRhaW5zIGEgY3ViZSBtYXAgb2YgdGhlIHNwZWN1bGFyIGxpZ2h0aW5nIGFuZCB0aGUgY29udm9sdXRlZCBzcGVjdWxhciBtaXBtYXBzLlxuICogQHBhcmFtIHtDcmVkaXR8U3RyaW5nfSBbb3B0aW9ucy5jcmVkaXRdIEEgY3JlZGl0IGZvciB0aGUgZGF0YSBzb3VyY2UsIHdoaWNoIGlzIGRpc3BsYXllZCBvbiB0aGUgY2FudmFzLlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5iYWNrRmFjZUN1bGxpbmc9dHJ1ZV0gV2hldGhlciB0byBjdWxsIGJhY2stZmFjaW5nIGdlb21ldHJ5LiBXaGVuIHRydWUsIGJhY2sgZmFjZSBjdWxsaW5nIGlzIGRldGVybWluZWQgYnkgdGhlIG1hdGVyaWFsJ3MgZG91YmxlU2lkZWQgcHJvcGVydHk7IHdoZW4gZmFsc2UsIGJhY2sgZmFjZSBjdWxsaW5nIGlzIGRpc2FibGVkLiBCYWNrIGZhY2VzIGFyZSBub3QgY3VsbGVkIGlmIHtAbGluayBNb2RlbCNjb2xvcn0gaXMgdHJhbnNsdWNlbnQgb3Ige0BsaW5rIE1vZGVsI3NpbGhvdWV0dGVTaXplfSBpcyBncmVhdGVyIHRoYW4gMC4wLlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5zaG93T3V0bGluZT10cnVlXSBXaGV0aGVyIHRvIGRpc3BsYXkgdGhlIG91dGxpbmUgZm9yIG1vZGVscyB1c2luZyB0aGUge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9LaHJvbm9zR3JvdXAvZ2xURi90cmVlL21hc3Rlci9leHRlbnNpb25zLzIuMC9WZW5kb3IvQ0VTSVVNX3ByaW1pdGl2ZV9vdXRsaW5lfENFU0lVTV9wcmltaXRpdmVfb3V0bGluZX0gZXh0ZW5zaW9uLiBXaGVuIHRydWUsIG91dGxpbmVzIGFyZSBkaXNwbGF5ZWQuIFdoZW4gZmFsc2UsIG91dGxpbmVzIGFyZSBub3QgZGlzcGxheWVkLlxuICpcbiAqIEBzZWUgTW9kZWwuZnJvbUdsdGZcbiAqXG4gKiBAZGVtbyB7QGxpbmsgaHR0cHM6Ly9zYW5kY2FzdGxlLmNlc2l1bS5jb20vaW5kZXguaHRtbD9zcmM9M0QlMjBNb2RlbHMuaHRtbHxDZXNpdW0gU2FuZGNhc3RsZSBNb2RlbHMgRGVtb31cbiAqL1xuZnVuY3Rpb24gTW9kZWwob3B0aW9ucykge1xuICBvcHRpb25zID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMsIGRlZmF1bHRWYWx1ZS5FTVBUWV9PQkpFQ1QpO1xuXG4gIHZhciBjYWNoZUtleSA9IG9wdGlvbnMuY2FjaGVLZXk7XG4gIHRoaXMuX2NhY2hlS2V5ID0gY2FjaGVLZXk7XG4gIHRoaXMuX2NhY2hlZEdsdGYgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX3JlbGVhc2VHbHRmSnNvbiA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLnJlbGVhc2VHbHRmSnNvbiwgZmFsc2UpO1xuXG4gIHZhciBjYWNoZWRHbHRmO1xuICBpZiAoXG4gICAgZGVmaW5lZChjYWNoZUtleSkgJiZcbiAgICBkZWZpbmVkKGdsdGZDYWNoZVtjYWNoZUtleV0pICYmXG4gICAgZ2x0ZkNhY2hlW2NhY2hlS2V5XS5yZWFkeVxuICApIHtcbiAgICAvLyBnbFRGIEpTT04gaXMgaW4gY2FjaGUgYW5kIHJlYWR5XG4gICAgY2FjaGVkR2x0ZiA9IGdsdGZDYWNoZVtjYWNoZUtleV07XG4gICAgKytjYWNoZWRHbHRmLmNvdW50O1xuICB9IGVsc2Uge1xuICAgIC8vIGdsVEYgd2FzIGV4cGxpY2l0bHkgcHJvdmlkZWQsIGUuZy4sIHdoZW4gYSB1c2VyIHVzZXMgdGhlIE1vZGVsIGNvbnN0cnVjdG9yIGRpcmVjdGx5XG4gICAgdmFyIGdsdGYgPSBvcHRpb25zLmdsdGY7XG5cbiAgICBpZiAoZGVmaW5lZChnbHRmKSkge1xuICAgICAgaWYgKGdsdGYgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuICAgICAgICBnbHRmID0gbmV3IFVpbnQ4QXJyYXkoZ2x0Zik7XG4gICAgICB9XG5cbiAgICAgIGlmIChnbHRmIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgICAgICAvLyBCaW5hcnkgZ2xURlxuICAgICAgICB2YXIgcGFyc2VkR2x0ZiA9IHBhcnNlR2xiKGdsdGYpO1xuXG4gICAgICAgIGNhY2hlZEdsdGYgPSBuZXcgQ2FjaGVkR2x0Zih7XG4gICAgICAgICAgZ2x0ZjogcGFyc2VkR2x0ZixcbiAgICAgICAgICByZWFkeTogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBOb3JtYWwgZ2xURiAoSlNPTilcbiAgICAgICAgY2FjaGVkR2x0ZiA9IG5ldyBDYWNoZWRHbHRmKHtcbiAgICAgICAgICBnbHRmOiBvcHRpb25zLmdsdGYsXG4gICAgICAgICAgcmVhZHk6IHRydWUsXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBjYWNoZWRHbHRmLmNvdW50ID0gMTtcblxuICAgICAgaWYgKGRlZmluZWQoY2FjaGVLZXkpKSB7XG4gICAgICAgIGdsdGZDYWNoZVtjYWNoZUtleV0gPSBjYWNoZWRHbHRmO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBzZXRDYWNoZWRHbHRmKHRoaXMsIGNhY2hlZEdsdGYpO1xuXG4gIHZhciBiYXNlUGF0aCA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmJhc2VQYXRoLCBcIlwiKTtcbiAgdGhpcy5fcmVzb3VyY2UgPSBSZXNvdXJjZS5jcmVhdGVJZk5lZWRlZChiYXNlUGF0aCk7XG5cbiAgLy8gVXNlciBzcGVjaWZpZWQgY3JlZGl0XG4gIHZhciBjcmVkaXQgPSBvcHRpb25zLmNyZWRpdDtcbiAgaWYgKHR5cGVvZiBjcmVkaXQgPT09IFwic3RyaW5nXCIpIHtcbiAgICBjcmVkaXQgPSBuZXcgQ3JlZGl0KGNyZWRpdCk7XG4gIH1cbiAgdGhpcy5fY3JlZGl0ID0gY3JlZGl0O1xuXG4gIC8vIENyZWF0ZSBhIGxpc3Qgb2YgQ3JlZGl0J3Mgc28gdGhleSBjYW4gYmUgYWRkZWQgZnJvbSB0aGUgUmVzb3VyY2UgbGF0ZXJcbiAgdGhpcy5fcmVzb3VyY2VDcmVkaXRzID0gW107XG5cbiAgLyoqXG4gICAqIERldGVybWluZXMgaWYgdGhlIG1vZGVsIHByaW1pdGl2ZSB3aWxsIGJlIHNob3duLlxuICAgKlxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICpcbiAgICogQGRlZmF1bHQgdHJ1ZVxuICAgKi9cbiAgdGhpcy5zaG93ID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuc2hvdywgdHJ1ZSk7XG5cbiAgLyoqXG4gICAqIFRoZSBzaWxob3VldHRlIGNvbG9yLlxuICAgKlxuICAgKiBAdHlwZSB7Q29sb3J9XG4gICAqXG4gICAqIEBkZWZhdWx0IENvbG9yLlJFRFxuICAgKi9cbiAgdGhpcy5zaWxob3VldHRlQ29sb3IgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5zaWxob3VldHRlQ29sb3IsIENvbG9yLlJFRCk7XG4gIHRoaXMuX3NpbGhvdWV0dGVDb2xvciA9IG5ldyBDb2xvcigpO1xuICB0aGlzLl9zaWxob3VldHRlQ29sb3JQcmV2aW91c0FscGhhID0gMS4wO1xuICB0aGlzLl9ub3JtYWxBdHRyaWJ1dGVOYW1lID0gdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKiBUaGUgc2l6ZSBvZiB0aGUgc2lsaG91ZXR0ZSBpbiBwaXhlbHMuXG4gICAqXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqXG4gICAqIEBkZWZhdWx0IDAuMFxuICAgKi9cbiAgdGhpcy5zaWxob3VldHRlU2l6ZSA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLnNpbGhvdWV0dGVTaXplLCAwLjApO1xuXG4gIC8qKlxuICAgKiBUaGUgNHg0IHRyYW5zZm9ybWF0aW9uIG1hdHJpeCB0aGF0IHRyYW5zZm9ybXMgdGhlIG1vZGVsIGZyb20gbW9kZWwgdG8gd29ybGQgY29vcmRpbmF0ZXMuXG4gICAqIFdoZW4gdGhpcyBpcyB0aGUgaWRlbnRpdHkgbWF0cml4LCB0aGUgbW9kZWwgaXMgZHJhd24gaW4gd29ybGQgY29vcmRpbmF0ZXMsIGkuZS4sIEVhcnRoJ3MgV0dTODQgY29vcmRpbmF0ZXMuXG4gICAqIExvY2FsIHJlZmVyZW5jZSBmcmFtZXMgY2FuIGJlIHVzZWQgYnkgcHJvdmlkaW5nIGEgZGlmZmVyZW50IHRyYW5zZm9ybWF0aW9uIG1hdHJpeCwgbGlrZSB0aGF0IHJldHVybmVkXG4gICAqIGJ5IHtAbGluayBUcmFuc2Zvcm1zLmVhc3ROb3J0aFVwVG9GaXhlZEZyYW1lfS5cbiAgICpcbiAgICogQHR5cGUge01hdHJpeDR9XG4gICAqXG4gICAqIEBkZWZhdWx0IHtAbGluayBNYXRyaXg0LklERU5USVRZfVxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2YXIgb3JpZ2luID0gQ2VzaXVtLkNhcnRlc2lhbjMuZnJvbURlZ3JlZXMoLTk1LjAsIDQwLjAsIDIwMDAwMC4wKTtcbiAgICogbS5tb2RlbE1hdHJpeCA9IENlc2l1bS5UcmFuc2Zvcm1zLmVhc3ROb3J0aFVwVG9GaXhlZEZyYW1lKG9yaWdpbik7XG4gICAqL1xuICB0aGlzLm1vZGVsTWF0cml4ID0gTWF0cml4NC5jbG9uZShcbiAgICBkZWZhdWx0VmFsdWUob3B0aW9ucy5tb2RlbE1hdHJpeCwgTWF0cml4NC5JREVOVElUWSlcbiAgKTtcbiAgdGhpcy5fbW9kZWxNYXRyaXggPSBNYXRyaXg0LmNsb25lKHRoaXMubW9kZWxNYXRyaXgpO1xuICB0aGlzLl9jbGFtcGVkTW9kZWxNYXRyaXggPSB1bmRlZmluZWQ7XG5cbiAgLyoqXG4gICAqIEEgdW5pZm9ybSBzY2FsZSBhcHBsaWVkIHRvIHRoaXMgbW9kZWwgYmVmb3JlIHRoZSB7QGxpbmsgTW9kZWwjbW9kZWxNYXRyaXh9LlxuICAgKiBWYWx1ZXMgZ3JlYXRlciB0aGFuIDxjb2RlPjEuMDwvY29kZT4gaW5jcmVhc2UgdGhlIHNpemUgb2YgdGhlIG1vZGVsOyB2YWx1ZXNcbiAgICogbGVzcyB0aGFuIDxjb2RlPjEuMDwvY29kZT4gZGVjcmVhc2UuXG4gICAqXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqXG4gICAqIEBkZWZhdWx0IDEuMFxuICAgKi9cbiAgdGhpcy5zY2FsZSA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLnNjYWxlLCAxLjApO1xuICB0aGlzLl9zY2FsZSA9IHRoaXMuc2NhbGU7XG5cbiAgLyoqXG4gICAqIFRoZSBhcHByb3hpbWF0ZSBtaW5pbXVtIHBpeGVsIHNpemUgb2YgdGhlIG1vZGVsIHJlZ2FyZGxlc3Mgb2Ygem9vbS5cbiAgICogVGhpcyBjYW4gYmUgdXNlZCB0byBlbnN1cmUgdGhhdCBhIG1vZGVsIGlzIHZpc2libGUgZXZlbiB3aGVuIHRoZSB2aWV3ZXJcbiAgICogem9vbXMgb3V0LiAgV2hlbiA8Y29kZT4wLjA8L2NvZGU+LCBubyBtaW5pbXVtIHNpemUgaXMgZW5mb3JjZWQuXG4gICAqXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqXG4gICAqIEBkZWZhdWx0IDAuMFxuICAgKi9cbiAgdGhpcy5taW5pbXVtUGl4ZWxTaXplID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMubWluaW11bVBpeGVsU2l6ZSwgMC4wKTtcbiAgdGhpcy5fbWluaW11bVBpeGVsU2l6ZSA9IHRoaXMubWluaW11bVBpeGVsU2l6ZTtcblxuICAvKipcbiAgICogVGhlIG1heGltdW0gc2NhbGUgc2l6ZSBmb3IgYSBtb2RlbC4gVGhpcyBjYW4gYmUgdXNlZCB0byBnaXZlXG4gICAqIGFuIHVwcGVyIGxpbWl0IHRvIHRoZSB7QGxpbmsgTW9kZWwjbWluaW11bVBpeGVsU2l6ZX0sIGVuc3VyaW5nIHRoYXQgdGhlIG1vZGVsXG4gICAqIGlzIG5ldmVyIGFuIHVucmVhc29uYWJsZSBzY2FsZS5cbiAgICpcbiAgICogQHR5cGUge051bWJlcn1cbiAgICovXG4gIHRoaXMubWF4aW11bVNjYWxlID0gb3B0aW9ucy5tYXhpbXVtU2NhbGU7XG4gIHRoaXMuX21heGltdW1TY2FsZSA9IHRoaXMubWF4aW11bVNjYWxlO1xuXG4gIC8qKlxuICAgKiBVc2VyLWRlZmluZWQgb2JqZWN0IHJldHVybmVkIHdoZW4gdGhlIG1vZGVsIGlzIHBpY2tlZC5cbiAgICpcbiAgICogQHR5cGUgT2JqZWN0XG4gICAqXG4gICAqIEBkZWZhdWx0IHVuZGVmaW5lZFxuICAgKlxuICAgKiBAc2VlIFNjZW5lI3BpY2tcbiAgICovXG4gIHRoaXMuaWQgPSBvcHRpb25zLmlkO1xuICB0aGlzLl9pZCA9IG9wdGlvbnMuaWQ7XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGhlaWdodCByZWZlcmVuY2Ugb2YgdGhlIG1vZGVsXG4gICAqXG4gICAqIEB0eXBlIHtIZWlnaHRSZWZlcmVuY2V9XG4gICAqXG4gICAqIEBkZWZhdWx0IEhlaWdodFJlZmVyZW5jZS5OT05FXG4gICAqL1xuICB0aGlzLmhlaWdodFJlZmVyZW5jZSA9IGRlZmF1bHRWYWx1ZShcbiAgICBvcHRpb25zLmhlaWdodFJlZmVyZW5jZSxcbiAgICBIZWlnaHRSZWZlcmVuY2UuTk9ORVxuICApO1xuICB0aGlzLl9oZWlnaHRSZWZlcmVuY2UgPSB0aGlzLmhlaWdodFJlZmVyZW5jZTtcbiAgdGhpcy5faGVpZ2h0Q2hhbmdlZCA9IGZhbHNlO1xuICB0aGlzLl9yZW1vdmVVcGRhdGVIZWlnaHRDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgdmFyIHNjZW5lID0gb3B0aW9ucy5zY2VuZTtcbiAgdGhpcy5fc2NlbmUgPSBzY2VuZTtcbiAgaWYgKGRlZmluZWQoc2NlbmUpICYmIGRlZmluZWQoc2NlbmUudGVycmFpblByb3ZpZGVyQ2hhbmdlZCkpIHtcbiAgICB0aGlzLl90ZXJyYWluUHJvdmlkZXJDaGFuZ2VkQ2FsbGJhY2sgPSBzY2VuZS50ZXJyYWluUHJvdmlkZXJDaGFuZ2VkLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2hlaWdodENoYW5nZWQgPSB0cnVlO1xuICAgICAgfSxcbiAgICAgIHRoaXNcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZWQgZm9yIHBpY2tpbmcgcHJpbWl0aXZlcyB0aGF0IHdyYXAgYSBtb2RlbC5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHRoaXMuX3BpY2tPYmplY3QgPSBvcHRpb25zLnBpY2tPYmplY3Q7XG4gIHRoaXMuX2FsbG93UGlja2luZyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmFsbG93UGlja2luZywgdHJ1ZSk7XG5cbiAgdGhpcy5fcmVhZHkgPSBmYWxzZTtcbiAgdGhpcy5fcmVhZHlQcm9taXNlID0gd2hlbi5kZWZlcigpO1xuXG4gIC8qKlxuICAgKiBUaGUgY3VycmVudGx5IHBsYXlpbmcgZ2xURiBhbmltYXRpb25zLlxuICAgKlxuICAgKiBAdHlwZSB7TW9kZWxBbmltYXRpb25Db2xsZWN0aW9ufVxuICAgKi9cbiAgdGhpcy5hY3RpdmVBbmltYXRpb25zID0gbmV3IE1vZGVsQW5pbWF0aW9uQ29sbGVjdGlvbih0aGlzKTtcblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiB0aGUgbW9kZWwncyBhbmltYXRpb25zIHNob3VsZCBob2xkIGEgcG9zZSBvdmVyIGZyYW1lcyB3aGVyZSBubyBrZXlmcmFtZXMgYXJlIHNwZWNpZmllZC5cbiAgICpcbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqL1xuICB0aGlzLmNsYW1wQW5pbWF0aW9ucyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmNsYW1wQW5pbWF0aW9ucywgdHJ1ZSk7XG5cbiAgdGhpcy5fZGVmYXVsdFRleHR1cmUgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2luY3JlbWVudGFsbHlMb2FkVGV4dHVyZXMgPSBkZWZhdWx0VmFsdWUoXG4gICAgb3B0aW9ucy5pbmNyZW1lbnRhbGx5TG9hZFRleHR1cmVzLFxuICAgIHRydWVcbiAgKTtcbiAgdGhpcy5fYXN5bmNocm9ub3VzID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuYXN5bmNocm9ub3VzLCB0cnVlKTtcblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBtb2RlbCBjYXN0cyBvciByZWNlaXZlcyBzaGFkb3dzIGZyb20gbGlnaHQgc291cmNlcy5cbiAgICpcbiAgICogQHR5cGUge1NoYWRvd01vZGV9XG4gICAqXG4gICAqIEBkZWZhdWx0IFNoYWRvd01vZGUuRU5BQkxFRFxuICAgKi9cbiAgdGhpcy5zaGFkb3dzID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuc2hhZG93cywgU2hhZG93TW9kZS5FTkFCTEVEKTtcbiAgdGhpcy5fc2hhZG93cyA9IHRoaXMuc2hhZG93cztcblxuICAvKipcbiAgICogQSBjb2xvciB0aGF0IGJsZW5kcyB3aXRoIHRoZSBtb2RlbCdzIHJlbmRlcmVkIGNvbG9yLlxuICAgKlxuICAgKiBAdHlwZSB7Q29sb3J9XG4gICAqXG4gICAqIEBkZWZhdWx0IENvbG9yLldISVRFXG4gICAqL1xuICB0aGlzLmNvbG9yID0gQ29sb3IuY2xvbmUoZGVmYXVsdFZhbHVlKG9wdGlvbnMuY29sb3IsIENvbG9yLldISVRFKSk7XG4gIHRoaXMuX2NvbG9yUHJldmlvdXNBbHBoYSA9IDEuMDtcblxuICAvKipcbiAgICogRGVmaW5lcyBob3cgdGhlIGNvbG9yIGJsZW5kcyB3aXRoIHRoZSBtb2RlbC5cbiAgICpcbiAgICogQHR5cGUge0NvbG9yQmxlbmRNb2RlfVxuICAgKlxuICAgKiBAZGVmYXVsdCBDb2xvckJsZW5kTW9kZS5ISUdITElHSFRcbiAgICovXG4gIHRoaXMuY29sb3JCbGVuZE1vZGUgPSBkZWZhdWx0VmFsdWUoXG4gICAgb3B0aW9ucy5jb2xvckJsZW5kTW9kZSxcbiAgICBDb2xvckJsZW5kTW9kZS5ISUdITElHSFRcbiAgKTtcblxuICAvKipcbiAgICogVmFsdWUgdXNlZCB0byBkZXRlcm1pbmUgdGhlIGNvbG9yIHN0cmVuZ3RoIHdoZW4gdGhlIDxjb2RlPmNvbG9yQmxlbmRNb2RlPC9jb2RlPiBpcyA8Y29kZT5NSVg8L2NvZGU+LlxuICAgKiBBIHZhbHVlIG9mIDAuMCByZXN1bHRzIGluIHRoZSBtb2RlbCdzIHJlbmRlcmVkIGNvbG9yIHdoaWxlIGEgdmFsdWUgb2YgMS4wIHJlc3VsdHMgaW4gYSBzb2xpZCBjb2xvciwgd2l0aFxuICAgKiBhbnkgdmFsdWUgaW4tYmV0d2VlbiByZXN1bHRpbmcgaW4gYSBtaXggb2YgdGhlIHR3by5cbiAgICpcbiAgICogQHR5cGUge051bWJlcn1cbiAgICpcbiAgICogQGRlZmF1bHQgMC41XG4gICAqL1xuICB0aGlzLmNvbG9yQmxlbmRBbW91bnQgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5jb2xvckJsZW5kQW1vdW50LCAwLjUpO1xuXG4gIHRoaXMuX2NvbG9yU2hhZGluZ0VuYWJsZWQgPSBmYWxzZTtcblxuICB0aGlzLl9jbGlwcGluZ1BsYW5lcyA9IHVuZGVmaW5lZDtcbiAgdGhpcy5jbGlwcGluZ1BsYW5lcyA9IG9wdGlvbnMuY2xpcHBpbmdQbGFuZXM7XG4gIC8vIFVzZWQgZm9yIGNoZWNraW5nIGlmIHNoYWRlcnMgbmVlZCB0byBiZSByZWdlbmVyYXRlZCBkdWUgdG8gY2xpcHBpbmcgcGxhbmUgY2hhbmdlcy5cbiAgdGhpcy5fY2xpcHBpbmdQbGFuZXNTdGF0ZSA9IDA7XG5cbiAgLy8gSWYgZGVmaW5lZCwgdXNlIHRoaXMgbWF0cml4IHRvIHRyYW5zZm9ybSBtaXNjZWxsYW5lb3VzIHByb3BlcnRpZXMgbGlrZVxuICAvLyBjbGlwcGluZyBwbGFuZXMgYW5kIElCTCBpbnN0ZWFkIG9mIHRoZSBtb2RlbE1hdHJpeC4gVGhpcyBpcyBzbyB0aGF0IHdoZW5cbiAgLy8gbW9kZWxzIGFyZSBwYXJ0IG9mIGEgdGlsZXNldCB0aGVzZSBwcm9wZXJ0aWVzIGdldCB0cmFuc2Zvcm1lZCByZWxhdGl2ZSB0b1xuICAvLyBhIGNvbW1vbiByZWZlcmVuY2UgKHN1Y2ggYXMgdGhlIHJvb3QpLlxuICB0aGlzLnJlZmVyZW5jZU1hdHJpeCA9IHVuZGVmaW5lZDtcblxuICAvKipcbiAgICogV2hldGhlciB0byBjdWxsIGJhY2stZmFjaW5nIGdlb21ldHJ5LiBXaGVuIHRydWUsIGJhY2sgZmFjZSBjdWxsaW5nIGlzXG4gICAqIGRldGVybWluZWQgYnkgdGhlIG1hdGVyaWFsJ3MgZG91YmxlU2lkZWQgcHJvcGVydHk7IHdoZW4gZmFsc2UsIGJhY2sgZmFjZVxuICAgKiBjdWxsaW5nIGlzIGRpc2FibGVkLiBCYWNrIGZhY2VzIGFyZSBub3QgY3VsbGVkIGlmIHtAbGluayBNb2RlbCNjb2xvcn0gaXNcbiAgICogdHJhbnNsdWNlbnQgb3Ige0BsaW5rIE1vZGVsI3NpbGhvdWV0dGVTaXplfSBpcyBncmVhdGVyIHRoYW4gMC4wLlxuICAgKlxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICpcbiAgICogQGRlZmF1bHQgdHJ1ZVxuICAgKi9cbiAgdGhpcy5iYWNrRmFjZUN1bGxpbmcgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5iYWNrRmFjZUN1bGxpbmcsIHRydWUpO1xuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRvIGRpc3BsYXkgdGhlIG91dGxpbmUgZm9yIG1vZGVscyB1c2luZyB0aGVcbiAgICoge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9LaHJvbm9zR3JvdXAvZ2xURi90cmVlL21hc3Rlci9leHRlbnNpb25zLzIuMC9WZW5kb3IvQ0VTSVVNX3ByaW1pdGl2ZV9vdXRsaW5lfENFU0lVTV9wcmltaXRpdmVfb3V0bGluZX0gZXh0ZW5zaW9uLlxuICAgKiBXaGVuIHRydWUsIG91dGxpbmVzIGFyZSBkaXNwbGF5ZWQuIFdoZW4gZmFsc2UsIG91dGxpbmVzIGFyZSBub3QgZGlzcGxheWVkLlxuICAgKlxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEBkZWZhdWx0IHRydWVcbiAgICovXG4gIHRoaXMuc2hvd091dGxpbmUgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5zaG93T3V0bGluZSwgdHJ1ZSk7XG5cbiAgLyoqXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgZm9yIGRlYnVnZ2luZyBvbmx5OyBpdCBpcyBub3QgZm9yIHByb2R1Y3Rpb24gdXNlIG5vciBpcyBpdCBvcHRpbWl6ZWQuXG4gICAqIDxwPlxuICAgKiBEcmF3cyB0aGUgYm91bmRpbmcgc3BoZXJlIGZvciBlYWNoIGRyYXcgY29tbWFuZCBpbiB0aGUgbW9kZWwuICBBIGdsVEYgcHJpbWl0aXZlIGNvcnJlc3BvbmRzXG4gICAqIHRvIG9uZSBkcmF3IGNvbW1hbmQuICBBIGdsVEYgbWVzaCBoYXMgYW4gYXJyYXkgb2YgcHJpbWl0aXZlcywgb2Z0ZW4gb2YgbGVuZ3RoIG9uZS5cbiAgICogPC9wPlxuICAgKlxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICpcbiAgICogQGRlZmF1bHQgZmFsc2VcbiAgICovXG4gIHRoaXMuZGVidWdTaG93Qm91bmRpbmdWb2x1bWUgPSBkZWZhdWx0VmFsdWUoXG4gICAgb3B0aW9ucy5kZWJ1Z1Nob3dCb3VuZGluZ1ZvbHVtZSxcbiAgICBmYWxzZVxuICApO1xuICB0aGlzLl9kZWJ1Z1Nob3dCb3VuZGluZ1ZvbHVtZSA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGZvciBkZWJ1Z2dpbmcgb25seTsgaXQgaXMgbm90IGZvciBwcm9kdWN0aW9uIHVzZSBub3IgaXMgaXQgb3B0aW1pemVkLlxuICAgKiA8cD5cbiAgICogRHJhd3MgdGhlIG1vZGVsIGluIHdpcmVmcmFtZS5cbiAgICogPC9wPlxuICAgKlxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICpcbiAgICogQGRlZmF1bHQgZmFsc2VcbiAgICovXG4gIHRoaXMuZGVidWdXaXJlZnJhbWUgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5kZWJ1Z1dpcmVmcmFtZSwgZmFsc2UpO1xuICB0aGlzLl9kZWJ1Z1dpcmVmcmFtZSA9IGZhbHNlO1xuXG4gIHRoaXMuX2Rpc3RhbmNlRGlzcGxheUNvbmRpdGlvbiA9IG9wdGlvbnMuZGlzdGFuY2VEaXNwbGF5Q29uZGl0aW9uO1xuXG4gIC8vIFVuZG9jdW1lbnRlZCBvcHRpb25zXG4gIHRoaXMuX2FkZEJhdGNoSWRUb0dlbmVyYXRlZFNoYWRlcnMgPSBvcHRpb25zLmFkZEJhdGNoSWRUb0dlbmVyYXRlZFNoYWRlcnM7XG4gIHRoaXMuX3ByZWNyZWF0ZWRBdHRyaWJ1dGVzID0gb3B0aW9ucy5wcmVjcmVhdGVkQXR0cmlidXRlcztcbiAgdGhpcy5fdmVydGV4U2hhZGVyTG9hZGVkID0gb3B0aW9ucy52ZXJ0ZXhTaGFkZXJMb2FkZWQ7XG4gIHRoaXMuX2ZyYWdtZW50U2hhZGVyTG9hZGVkID0gb3B0aW9ucy5mcmFnbWVudFNoYWRlckxvYWRlZDtcbiAgdGhpcy5fdW5pZm9ybU1hcExvYWRlZCA9IG9wdGlvbnMudW5pZm9ybU1hcExvYWRlZDtcbiAgdGhpcy5fcGlja0lkTG9hZGVkID0gb3B0aW9ucy5waWNrSWRMb2FkZWQ7XG4gIHRoaXMuX2lnbm9yZUNvbW1hbmRzID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuaWdub3JlQ29tbWFuZHMsIGZhbHNlKTtcbiAgdGhpcy5fcmVxdWVzdFR5cGUgPSBvcHRpb25zLnJlcXVlc3RUeXBlO1xuICB0aGlzLl91cEF4aXMgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy51cEF4aXMsIEF4aXMuWSk7XG4gIHRoaXMuX2dsdGZGb3J3YXJkQXhpcyA9IEF4aXMuWjtcbiAgdGhpcy5fZm9yd2FyZEF4aXMgPSBvcHRpb25zLmZvcndhcmRBeGlzO1xuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIHRoaXMuY3VsbCA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmN1bGwsIHRydWUpO1xuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIHRoaXMub3BhcXVlUGFzcyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLm9wYXF1ZVBhc3MsIFBhc3MuT1BBUVVFKTtcblxuICB0aGlzLl9jb21wdXRlZE1vZGVsTWF0cml4ID0gbmV3IE1hdHJpeDQoKTsgLy8gRGVyaXZlZCBmcm9tIG1vZGVsTWF0cml4IGFuZCBzY2FsZVxuICB0aGlzLl9jbGlwcGluZ1BsYW5lc01hdHJpeCA9IE1hdHJpeDQuY2xvbmUoTWF0cml4NC5JREVOVElUWSk7IC8vIERlcml2ZWQgZnJvbSByZWZlcmVuY2UgbWF0cml4IGFuZCB0aGUgY3VycmVudCB2aWV3IG1hdHJpeFxuICB0aGlzLl9pYmxSZWZlcmVuY2VGcmFtZU1hdHJpeCA9IE1hdHJpeDMuY2xvbmUoTWF0cml4My5JREVOVElUWSk7IC8vIERlcml2ZWQgZnJvbSByZWZlcmVuY2UgbWF0cml4IGFuZCB0aGUgY3VycmVudCB2aWV3IG1hdHJpeFxuICB0aGlzLl9pbml0aWFsUmFkaXVzID0gdW5kZWZpbmVkOyAvLyBSYWRpdXMgd2l0aG91dCBtb2RlbCdzIHNjYWxlIHByb3BlcnR5LCBtb2RlbC1tYXRyaXggc2NhbGUsIGFuaW1hdGlvbnMsIG9yIHNraW5zXG4gIHRoaXMuX2JvdW5kaW5nU3BoZXJlID0gdW5kZWZpbmVkO1xuICB0aGlzLl9zY2FsZWRCb3VuZGluZ1NwaGVyZSA9IG5ldyBCb3VuZGluZ1NwaGVyZSgpO1xuICB0aGlzLl9zdGF0ZSA9IE1vZGVsU3RhdGUuTkVFRFNfTE9BRDtcbiAgdGhpcy5fbG9hZFJlc291cmNlcyA9IHVuZGVmaW5lZDtcblxuICB0aGlzLl9tb2RlID0gdW5kZWZpbmVkO1xuXG4gIHRoaXMuX3Blck5vZGVTaG93RGlydHkgPSBmYWxzZTsgLy8gdHJ1ZSB3aGVuIHRoZSBDZXNpdW0gQVBJIHdhcyB1c2VkIHRvIGNoYW5nZSBhIG5vZGUncyBzaG93IHByb3BlcnR5XG4gIHRoaXMuX2Nlc2l1bUFuaW1hdGlvbnNEaXJ0eSA9IGZhbHNlOyAvLyB0cnVlIHdoZW4gdGhlIENlc2l1bSBBUEksIG5vdCBhIGdsVEYgYW5pbWF0aW9uLCBjaGFuZ2VkIGEgbm9kZSB0cmFuc2Zvcm1cbiAgdGhpcy5fZGlydHkgPSBmYWxzZTsgLy8gdHJ1ZSB3aGVuIHRoZSBtb2RlbCB3YXMgdHJhbnNmb3JtZWQgdGhpcyBmcmFtZVxuICB0aGlzLl9tYXhEaXJ0eU51bWJlciA9IDA7IC8vIFVzZWQgaW4gcGxhY2Ugb2YgYSBkaXJ0eSBib29sZWFuIGZsYWcgdG8gYXZvaWQgYW4gZXh0cmEgZ3JhcGggdHJhdmVyc2FsXG5cbiAgdGhpcy5fcnVudGltZSA9IHtcbiAgICBhbmltYXRpb25zOiB1bmRlZmluZWQsXG4gICAgYXJ0aWN1bGF0aW9uc0J5TmFtZTogdW5kZWZpbmVkLFxuICAgIGFydGljdWxhdGlvbnNCeVN0YWdlS2V5OiB1bmRlZmluZWQsXG4gICAgc3RhZ2VzQnlLZXk6IHVuZGVmaW5lZCxcbiAgICByb290Tm9kZXM6IHVuZGVmaW5lZCxcbiAgICBub2RlczogdW5kZWZpbmVkLCAvLyBJbmRleGVkIHdpdGggdGhlIG5vZGUncyBpbmRleFxuICAgIG5vZGVzQnlOYW1lOiB1bmRlZmluZWQsIC8vIEluZGV4ZWQgd2l0aCBuYW1lIHByb3BlcnR5IGluIHRoZSBub2RlXG4gICAgc2tpbm5lZE5vZGVzOiB1bmRlZmluZWQsXG4gICAgbWVzaGVzQnlOYW1lOiB1bmRlZmluZWQsIC8vIEluZGV4ZWQgd2l0aCB0aGUgbmFtZSBwcm9wZXJ0eSBpbiB0aGUgbWVzaFxuICAgIG1hdGVyaWFsc0J5TmFtZTogdW5kZWZpbmVkLCAvLyBJbmRleGVkIHdpdGggdGhlIG5hbWUgcHJvcGVydHkgaW4gdGhlIG1hdGVyaWFsXG4gICAgbWF0ZXJpYWxzQnlJZDogdW5kZWZpbmVkLCAvLyBJbmRleGVkIHdpdGggdGhlIG1hdGVyaWFsJ3MgaW5kZXhcbiAgfTtcblxuICB0aGlzLl91bmlmb3JtTWFwcyA9IHt9OyAvLyBOb3QgY2FjaGVkIHNpbmNlIGl0IGNhbiBiZSB0YXJnZXRlZCBieSBnbFRGIGFuaW1hdGlvblxuICB0aGlzLl9leHRlbnNpb25zVXNlZCA9IHVuZGVmaW5lZDsgLy8gQ2FjaGVkIHVzZWQgZ2xURiBleHRlbnNpb25zXG4gIHRoaXMuX2V4dGVuc2lvbnNSZXF1aXJlZCA9IHVuZGVmaW5lZDsgLy8gQ2FjaGVkIHJlcXVpcmVkIGdsVEYgZXh0ZW5zaW9uc1xuICB0aGlzLl9xdWFudGl6ZWRVbmlmb3JtcyA9IHt9OyAvLyBRdWFudGl6ZWQgdW5pZm9ybXMgZm9yIGVhY2ggcHJvZ3JhbSBmb3IgV0VCM0RfcXVhbnRpemVkX2F0dHJpYnV0ZXNcbiAgdGhpcy5fcHJvZ3JhbVByaW1pdGl2ZXMgPSB7fTtcbiAgdGhpcy5fcmVuZGVyZXJSZXNvdXJjZXMgPSB7XG4gICAgLy8gQ2FjaGVkIGJldHdlZW4gbW9kZWxzIHdpdGggdGhlIHNhbWUgdXJsL2NhY2hlLWtleVxuICAgIGJ1ZmZlcnM6IHt9LFxuICAgIHZlcnRleEFycmF5czoge30sXG4gICAgcHJvZ3JhbXM6IHt9LFxuICAgIHNvdXJjZVNoYWRlcnM6IHt9LFxuICAgIHNpbGhvdWV0dGVQcm9ncmFtczoge30sXG4gICAgdGV4dHVyZXM6IHt9LFxuICAgIHNhbXBsZXJzOiB7fSxcbiAgICByZW5kZXJTdGF0ZXM6IHt9LFxuICB9O1xuICB0aGlzLl9jYWNoZWRSZW5kZXJlclJlc291cmNlcyA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fbG9hZFJlbmRlcmVyUmVzb3VyY2VzRnJvbUNhY2hlID0gZmFsc2U7XG5cbiAgdGhpcy5fZGVxdWFudGl6ZUluU2hhZGVyID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuZGVxdWFudGl6ZUluU2hhZGVyLCB0cnVlKTtcbiAgdGhpcy5fZGVjb2RlZERhdGEgPSB7fTtcblxuICB0aGlzLl9jYWNoZWRHZW9tZXRyeUJ5dGVMZW5ndGggPSAwO1xuICB0aGlzLl9jYWNoZWRUZXh0dXJlc0J5dGVMZW5ndGggPSAwO1xuICB0aGlzLl9nZW9tZXRyeUJ5dGVMZW5ndGggPSAwO1xuICB0aGlzLl90ZXh0dXJlc0J5dGVMZW5ndGggPSAwO1xuICB0aGlzLl90cmlhbmdsZXNMZW5ndGggPSAwO1xuICB0aGlzLl9wb2ludHNMZW5ndGggPSAwO1xuXG4gIC8vIEhvbGQgcmVmZXJlbmNlcyBmb3Igc2hhZGVyIHJlY29uc3RydWN0aW9uLlxuICAvLyBIb2xkIHRoZXNlIHNlcGFyYXRlbHkgYmVjYXVzZSBfY2FjaGVkR2x0ZiBtYXkgZ2V0IHJlbGVhc2VkICh0aGlzLnJlbGVhc2VHbHRmSnNvbilcbiAgdGhpcy5fc291cmNlVGVjaG5pcXVlcyA9IHt9O1xuICB0aGlzLl9zb3VyY2VQcm9ncmFtcyA9IHt9O1xuICB0aGlzLl9xdWFudGl6ZWRWZXJ0ZXhTaGFkZXJzID0ge307XG5cbiAgdGhpcy5fbm9kZUNvbW1hbmRzID0gW107XG4gIHRoaXMuX3BpY2tJZHMgPSBbXTtcblxuICAvLyBDRVNJVU1fUlRDIGV4dGVuc2lvblxuICB0aGlzLl9ydGNDZW50ZXIgPSB1bmRlZmluZWQ7IC8vIHJlZmVyZW5jZSB0byBlaXRoZXIgM0Qgb3IgMkRcbiAgdGhpcy5fcnRjQ2VudGVyRXllID0gdW5kZWZpbmVkOyAvLyBpbiBleWUgY29vcmRpbmF0ZXNcbiAgdGhpcy5fcnRjQ2VudGVyM0QgPSB1bmRlZmluZWQ7IC8vIGluIHdvcmxkIGNvb3JkaW5hdGVzXG4gIHRoaXMuX3J0Y0NlbnRlcjJEID0gdW5kZWZpbmVkOyAvLyBpbiBwcm9qZWN0ZWQgd29ybGQgY29vcmRpbmF0ZXNcblxuICB0aGlzLl9zb3VyY2VWZXJzaW9uID0gdW5kZWZpbmVkO1xuICB0aGlzLl9zb3VyY2VLSFJUZWNobmlxdWVzV2ViR0wgPSB1bmRlZmluZWQ7XG5cbiAgdGhpcy5faW1hZ2VCYXNlZExpZ2h0aW5nRmFjdG9yID0gbmV3IENhcnRlc2lhbjIoMS4wLCAxLjApO1xuICBDYXJ0ZXNpYW4yLmNsb25lKFxuICAgIG9wdGlvbnMuaW1hZ2VCYXNlZExpZ2h0aW5nRmFjdG9yLFxuICAgIHRoaXMuX2ltYWdlQmFzZWRMaWdodGluZ0ZhY3RvclxuICApO1xuICB0aGlzLl9saWdodENvbG9yID0gQ2FydGVzaWFuMy5jbG9uZShvcHRpb25zLmxpZ2h0Q29sb3IpO1xuXG4gIHRoaXMuX2x1bWluYW5jZUF0WmVuaXRoID0gdW5kZWZpbmVkO1xuICB0aGlzLmx1bWluYW5jZUF0WmVuaXRoID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMubHVtaW5hbmNlQXRaZW5pdGgsIDAuMik7XG5cbiAgdGhpcy5fc3BoZXJpY2FsSGFybW9uaWNDb2VmZmljaWVudHMgPSBvcHRpb25zLnNwaGVyaWNhbEhhcm1vbmljQ29lZmZpY2llbnRzO1xuICB0aGlzLl9zcGVjdWxhckVudmlyb25tZW50TWFwcyA9IG9wdGlvbnMuc3BlY3VsYXJFbnZpcm9ubWVudE1hcHM7XG4gIHRoaXMuX3Nob3VsZFVwZGF0ZVNwZWN1bGFyTWFwQXRsYXMgPSB0cnVlO1xuICB0aGlzLl9zcGVjdWxhckVudmlyb25tZW50TWFwQXRsYXMgPSB1bmRlZmluZWQ7XG5cbiAgdGhpcy5fdXNlRGVmYXVsdFNwaGVyaWNhbEhhcm1vbmljcyA9IGZhbHNlO1xuICB0aGlzLl91c2VEZWZhdWx0U3BlY3VsYXJNYXBzID0gZmFsc2U7XG5cbiAgdGhpcy5fc2hvdWxkUmVnZW5lcmF0ZVNoYWRlcnMgPSBmYWxzZTtcbn1cblxuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoTW9kZWwucHJvdG90eXBlLCB7XG4gIC8qKlxuICAgKiBUaGUgb2JqZWN0IGZvciB0aGUgZ2xURiBKU09OLCBpbmNsdWRpbmcgcHJvcGVydGllcyB3aXRoIGRlZmF1bHQgdmFsdWVzIG9taXR0ZWRcbiAgICogZnJvbSB0aGUgSlNPTiBwcm92aWRlZCB0byB0aGlzIG1vZGVsLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgTW9kZWwucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtPYmplY3R9XG4gICAqIEByZWFkb25seVxuICAgKlxuICAgKiBAZGVmYXVsdCB1bmRlZmluZWRcbiAgICovXG4gIGdsdGY6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBkZWZpbmVkKHRoaXMuX2NhY2hlZEdsdGYpID8gdGhpcy5fY2FjaGVkR2x0Zi5nbHRmIDogdW5kZWZpbmVkO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFdoZW4gPGNvZGU+dHJ1ZTwvY29kZT4sIHRoZSBnbFRGIEpTT04gaXMgbm90IHN0b3JlZCB3aXRoIHRoZSBtb2RlbCBvbmNlIHRoZSBtb2RlbCBpc1xuICAgKiBsb2FkZWQgKHdoZW4ge0BsaW5rIE1vZGVsI3JlYWR5fSBpcyA8Y29kZT50cnVlPC9jb2RlPikuICBUaGlzIHNhdmVzIG1lbW9yeSB3aGVuXG4gICAqIGdlb21ldHJ5LCB0ZXh0dXJlcywgYW5kIGFuaW1hdGlvbnMgYXJlIGVtYmVkZGVkIGluIHRoZSAuZ2x0ZiBmaWxlLlxuICAgKiBUaGlzIGlzIGVzcGVjaWFsbHkgdXNlZnVsIGZvciBjYXNlcyBsaWtlIDNEIGJ1aWxkaW5ncywgd2hlcmUgZWFjaCAuZ2x0ZiBtb2RlbCBpcyB1bmlxdWVcbiAgICogYW5kIGNhY2hpbmcgdGhlIGdsVEYgSlNPTiBpcyBub3QgZWZmZWN0aXZlLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgTW9kZWwucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKiBAcmVhZG9ubHlcbiAgICpcbiAgICogQGRlZmF1bHQgZmFsc2VcbiAgICpcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHJlbGVhc2VHbHRmSnNvbjoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3JlbGVhc2VHbHRmSnNvbjtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBUaGUga2V5IGlkZW50aWZ5aW5nIHRoaXMgbW9kZWwgaW4gdGhlIG1vZGVsIGNhY2hlIGZvciBnbFRGIEpTT04sIHJlbmRlcmVyIHJlc291cmNlcywgYW5kIGFuaW1hdGlvbnMuXG4gICAqIENhY2hpbmcgc2F2ZXMgbWVtb3J5IGFuZCBpbXByb3ZlcyBsb2FkaW5nIHNwZWVkIHdoZW4gc2V2ZXJhbCBtb2RlbHMgd2l0aCB0aGUgc2FtZSB1cmwgYXJlIGNyZWF0ZWQuXG4gICAqIDxwPlxuICAgKiBUaGlzIGtleSBpcyBhdXRvbWF0aWNhbGx5IGdlbmVyYXRlZCB3aGVuIHRoZSBtb2RlbCBpcyBjcmVhdGVkIHdpdGgge0BsaW5rIE1vZGVsLmZyb21HbHRmfS4gIElmIHRoZSBtb2RlbFxuICAgKiBpcyBjcmVhdGVkIGRpcmVjdGx5IGZyb20gZ2xURiBKU09OIHVzaW5nIHRoZSB7QGxpbmsgTW9kZWx9IGNvbnN0cnVjdG9yLCB0aGlzIGtleSBjYW4gYmUgbWFudWFsbHlcbiAgICogcHJvdmlkZWQ7IG90aGVyd2lzZSwgdGhlIG1vZGVsIHdpbGwgbm90IGJlIGNoYW5nZWQuXG4gICAqIDwvcD5cbiAgICpcbiAgICogQG1lbWJlcm9mIE1vZGVsLnByb3RvdHlwZVxuICAgKlxuICAgKiBAdHlwZSB7U3RyaW5nfVxuICAgKiBAcmVhZG9ubHlcbiAgICpcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGNhY2hlS2V5OiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fY2FjaGVLZXk7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogVGhlIGJhc2UgcGF0aCB0aGF0IHBhdGhzIGluIHRoZSBnbFRGIEpTT04gYXJlIHJlbGF0aXZlIHRvLiAgVGhlIGJhc2VcbiAgICogcGF0aCBpcyB0aGUgc2FtZSBwYXRoIGFzIHRoZSBwYXRoIGNvbnRhaW5pbmcgdGhlIC5nbHRmIGZpbGVcbiAgICogbWludXMgdGhlIC5nbHRmIGZpbGUsIHdoZW4gYmluYXJ5LCBpbWFnZSwgYW5kIHNoYWRlciBmaWxlcyBhcmVcbiAgICogaW4gdGhlIHNhbWUgZGlyZWN0b3J5IGFzIHRoZSAuZ2x0Zi4gIFdoZW4gdGhpcyBpcyA8Y29kZT4nJzwvY29kZT4sXG4gICAqIHRoZSBhcHAncyBiYXNlIHBhdGggaXMgdXNlZC5cbiAgICpcbiAgICogQG1lbWJlcm9mIE1vZGVsLnByb3RvdHlwZVxuICAgKlxuICAgKiBAdHlwZSB7U3RyaW5nfVxuICAgKiBAcmVhZG9ubHlcbiAgICpcbiAgICogQGRlZmF1bHQgJydcbiAgICovXG4gIGJhc2VQYXRoOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcmVzb3VyY2UudXJsO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFRoZSBtb2RlbCdzIGJvdW5kaW5nIHNwaGVyZSBpbiBpdHMgbG9jYWwgY29vcmRpbmF0ZSBzeXN0ZW0uICBUaGlzIGRvZXMgbm90IHRha2UgaW50b1xuICAgKiBhY2NvdW50IGdsVEYgYW5pbWF0aW9ucyBhbmQgc2tpbnMgbm9yIGRvZXMgaXQgdGFrZSBpbnRvIGFjY291bnQge0BsaW5rIE1vZGVsI21pbmltdW1QaXhlbFNpemV9LlxuICAgKlxuICAgKiBAbWVtYmVyb2YgTW9kZWwucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtCb3VuZGluZ1NwaGVyZX1cbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEBkZWZhdWx0IHVuZGVmaW5lZFxuICAgKlxuICAgKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gVGhlIG1vZGVsIGlzIG5vdCBsb2FkZWQuICBVc2UgTW9kZWwucmVhZHlQcm9taXNlIG9yIHdhaXQgZm9yIE1vZGVsLnJlYWR5IHRvIGJlIHRydWUuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIC8vIENlbnRlciBpbiBXR1M4NCBjb29yZGluYXRlc1xuICAgKiB2YXIgY2VudGVyID0gQ2VzaXVtLk1hdHJpeDQubXVsdGlwbHlCeVBvaW50KG1vZGVsLm1vZGVsTWF0cml4LCBtb2RlbC5ib3VuZGluZ1NwaGVyZS5jZW50ZXIsIG5ldyBDZXNpdW0uQ2FydGVzaWFuMygpKTtcbiAgICovXG4gIGJvdW5kaW5nU3BoZXJlOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICAgICAgaWYgKHRoaXMuX3N0YXRlICE9PSBNb2RlbFN0YXRlLkxPQURFRCkge1xuICAgICAgICB0aHJvdyBuZXcgRGV2ZWxvcGVyRXJyb3IoXG4gICAgICAgICAgXCJUaGUgbW9kZWwgaXMgbm90IGxvYWRlZC4gIFVzZSBNb2RlbC5yZWFkeVByb21pc2Ugb3Igd2FpdCBmb3IgTW9kZWwucmVhZHkgdG8gYmUgdHJ1ZS5cIlxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgICAgIHZhciBtb2RlbE1hdHJpeCA9IHRoaXMubW9kZWxNYXRyaXg7XG4gICAgICBpZiAoXG4gICAgICAgIHRoaXMuaGVpZ2h0UmVmZXJlbmNlICE9PSBIZWlnaHRSZWZlcmVuY2UuTk9ORSAmJlxuICAgICAgICB0aGlzLl9jbGFtcGVkTW9kZWxNYXRyaXhcbiAgICAgICkge1xuICAgICAgICBtb2RlbE1hdHJpeCA9IHRoaXMuX2NsYW1wZWRNb2RlbE1hdHJpeDtcbiAgICAgIH1cblxuICAgICAgdmFyIG5vblVuaWZvcm1TY2FsZSA9IE1hdHJpeDQuZ2V0U2NhbGUoXG4gICAgICAgIG1vZGVsTWF0cml4LFxuICAgICAgICBib3VuZGluZ1NwaGVyZUNhcnRlc2lhbjNTY3JhdGNoXG4gICAgICApO1xuICAgICAgdmFyIHNjYWxlID0gZGVmaW5lZCh0aGlzLm1heGltdW1TY2FsZSlcbiAgICAgICAgPyBNYXRoLm1pbih0aGlzLm1heGltdW1TY2FsZSwgdGhpcy5zY2FsZSlcbiAgICAgICAgOiB0aGlzLnNjYWxlO1xuICAgICAgQ2FydGVzaWFuMy5tdWx0aXBseUJ5U2NhbGFyKG5vblVuaWZvcm1TY2FsZSwgc2NhbGUsIG5vblVuaWZvcm1TY2FsZSk7XG5cbiAgICAgIHZhciBzY2FsZWRCb3VuZGluZ1NwaGVyZSA9IHRoaXMuX3NjYWxlZEJvdW5kaW5nU3BoZXJlO1xuICAgICAgc2NhbGVkQm91bmRpbmdTcGhlcmUuY2VudGVyID0gQ2FydGVzaWFuMy5tdWx0aXBseUNvbXBvbmVudHMoXG4gICAgICAgIHRoaXMuX2JvdW5kaW5nU3BoZXJlLmNlbnRlcixcbiAgICAgICAgbm9uVW5pZm9ybVNjYWxlLFxuICAgICAgICBzY2FsZWRCb3VuZGluZ1NwaGVyZS5jZW50ZXJcbiAgICAgICk7XG4gICAgICBzY2FsZWRCb3VuZGluZ1NwaGVyZS5yYWRpdXMgPVxuICAgICAgICBDYXJ0ZXNpYW4zLm1heGltdW1Db21wb25lbnQobm9uVW5pZm9ybVNjYWxlKSAqIHRoaXMuX2luaXRpYWxSYWRpdXM7XG5cbiAgICAgIGlmIChkZWZpbmVkKHRoaXMuX3J0Y0NlbnRlcikpIHtcbiAgICAgICAgQ2FydGVzaWFuMy5hZGQoXG4gICAgICAgICAgdGhpcy5fcnRjQ2VudGVyLFxuICAgICAgICAgIHNjYWxlZEJvdW5kaW5nU3BoZXJlLmNlbnRlcixcbiAgICAgICAgICBzY2FsZWRCb3VuZGluZ1NwaGVyZS5jZW50ZXJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHNjYWxlZEJvdW5kaW5nU3BoZXJlO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFdoZW4gPGNvZGU+dHJ1ZTwvY29kZT4sIHRoaXMgbW9kZWwgaXMgcmVhZHkgdG8gcmVuZGVyLCBpLmUuLCB0aGUgZXh0ZXJuYWwgYmluYXJ5LCBpbWFnZSxcbiAgICogYW5kIHNoYWRlciBmaWxlcyB3ZXJlIGRvd25sb2FkZWQgYW5kIHRoZSBXZWJHTCByZXNvdXJjZXMgd2VyZSBjcmVhdGVkLiAgVGhpcyBpcyBzZXQgdG9cbiAgICogPGNvZGU+dHJ1ZTwvY29kZT4gcmlnaHQgYmVmb3JlIHtAbGluayBNb2RlbCNyZWFkeVByb21pc2V9IGlzIHJlc29sdmVkLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgTW9kZWwucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKiBAcmVhZG9ubHlcbiAgICpcbiAgICogQGRlZmF1bHQgZmFsc2VcbiAgICovXG4gIHJlYWR5OiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcmVhZHk7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogR2V0cyB0aGUgcHJvbWlzZSB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgd2hlbiB0aGlzIG1vZGVsIGlzIHJlYWR5IHRvIHJlbmRlciwgaS5lLiwgd2hlbiB0aGUgZXh0ZXJuYWwgYmluYXJ5LCBpbWFnZSxcbiAgICogYW5kIHNoYWRlciBmaWxlcyB3ZXJlIGRvd25sb2FkZWQgYW5kIHRoZSBXZWJHTCByZXNvdXJjZXMgd2VyZSBjcmVhdGVkLlxuICAgKiA8cD5cbiAgICogVGhpcyBwcm9taXNlIGlzIHJlc29sdmVkIGF0IHRoZSBlbmQgb2YgdGhlIGZyYW1lIGJlZm9yZSB0aGUgZmlyc3QgZnJhbWUgdGhlIG1vZGVsIGlzIHJlbmRlcmVkIGluLlxuICAgKiA8L3A+XG4gICAqXG4gICAqIEBtZW1iZXJvZiBNb2RlbC5wcm90b3R5cGVcbiAgICogQHR5cGUge1Byb21pc2UuPE1vZGVsPn1cbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIC8vIFBsYXkgYWxsIGFuaW1hdGlvbnMgYXQgaGFsZi1zcGVlZCB3aGVuIHRoZSBtb2RlbCBpcyByZWFkeSB0byByZW5kZXJcbiAgICogQ2VzaXVtLndoZW4obW9kZWwucmVhZHlQcm9taXNlKS50aGVuKGZ1bmN0aW9uKG1vZGVsKSB7XG4gICAqICAgbW9kZWwuYWN0aXZlQW5pbWF0aW9ucy5hZGRBbGwoe1xuICAgKiAgICAgbXVsdGlwbGllciA6IDAuNVxuICAgKiAgIH0pO1xuICAgKiB9KS5vdGhlcndpc2UoZnVuY3Rpb24oZXJyb3Ipe1xuICAgKiAgIHdpbmRvdy5hbGVydChlcnJvcik7XG4gICAqIH0pO1xuICAgKlxuICAgKiBAc2VlIE1vZGVsI3JlYWR5XG4gICAqL1xuICByZWFkeVByb21pc2U6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9yZWFkeVByb21pc2UucHJvbWlzZTtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIGlmIG1vZGVsIFdlYkdMIHJlc291cmNlIGNyZWF0aW9uIHdpbGwgYmUgc3ByZWFkIG91dCBvdmVyIHNldmVyYWwgZnJhbWVzIG9yXG4gICAqIGJsb2NrIHVudGlsIGNvbXBsZXRpb24gb25jZSBhbGwgZ2xURiBmaWxlcyBhcmUgbG9hZGVkLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgTW9kZWwucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKiBAcmVhZG9ubHlcbiAgICpcbiAgICogQGRlZmF1bHQgdHJ1ZVxuICAgKi9cbiAgYXN5bmNocm9ub3VzOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fYXN5bmNocm9ub3VzO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFdoZW4gPGNvZGU+dHJ1ZTwvY29kZT4sIGVhY2ggZ2xURiBtZXNoIGFuZCBwcmltaXRpdmUgaXMgcGlja2FibGUgd2l0aCB7QGxpbmsgU2NlbmUjcGlja30uICBXaGVuIDxjb2RlPmZhbHNlPC9jb2RlPiwgR1BVIG1lbW9yeSBpcyBzYXZlZC5cbiAgICpcbiAgICogQG1lbWJlcm9mIE1vZGVsLnByb3RvdHlwZVxuICAgKlxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEBkZWZhdWx0IHRydWVcbiAgICovXG4gIGFsbG93UGlja2luZzoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2FsbG93UGlja2luZztcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmUgaWYgdGV4dHVyZXMgbWF5IGNvbnRpbnVlIHRvIHN0cmVhbSBpbiBhZnRlciB0aGUgbW9kZWwgaXMgbG9hZGVkLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgTW9kZWwucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtCb29sZWFufVxuICAgKiBAcmVhZG9ubHlcbiAgICpcbiAgICogQGRlZmF1bHQgdHJ1ZVxuICAgKi9cbiAgaW5jcmVtZW50YWxseUxvYWRUZXh0dXJlczoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2luY3JlbWVudGFsbHlMb2FkVGV4dHVyZXM7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBudW1iZXIgb2YgcGVuZGluZyB0ZXh0dXJlIGxvYWRzLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgTW9kZWwucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAqIEByZWFkb25seVxuICAgKi9cbiAgcGVuZGluZ1RleHR1cmVMb2Fkczoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGRlZmluZWQodGhpcy5fbG9hZFJlc291cmNlcylcbiAgICAgICAgPyB0aGlzLl9sb2FkUmVzb3VyY2VzLnBlbmRpbmdUZXh0dXJlTG9hZHNcbiAgICAgICAgOiAwO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgbW9kZWwgd2FzIHRyYW5zZm9ybWVkIHRoaXMgZnJhbWVcbiAgICpcbiAgICogQG1lbWJlcm9mIE1vZGVsLnByb3RvdHlwZVxuICAgKlxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBkaXJ0eToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2RpcnR5O1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldHMgb3Igc2V0cyB0aGUgY29uZGl0aW9uIHNwZWNpZnlpbmcgYXQgd2hhdCBkaXN0YW5jZSBmcm9tIHRoZSBjYW1lcmEgdGhhdCB0aGlzIG1vZGVsIHdpbGwgYmUgZGlzcGxheWVkLlxuICAgKiBAbWVtYmVyb2YgTW9kZWwucHJvdG90eXBlXG4gICAqIEB0eXBlIHtEaXN0YW5jZURpc3BsYXlDb25kaXRpb259XG4gICAqIEBkZWZhdWx0IHVuZGVmaW5lZFxuICAgKi9cbiAgZGlzdGFuY2VEaXNwbGF5Q29uZGl0aW9uOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZGlzdGFuY2VEaXNwbGF5Q29uZGl0aW9uO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gICAgICBpZiAoZGVmaW5lZCh2YWx1ZSkgJiYgdmFsdWUuZmFyIDw9IHZhbHVlLm5lYXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFwiZmFyIG11c3QgYmUgZ3JlYXRlciB0aGFuIG5lYXJcIik7XG4gICAgICB9XG4gICAgICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcbiAgICAgIHRoaXMuX2Rpc3RhbmNlRGlzcGxheUNvbmRpdGlvbiA9IERpc3RhbmNlRGlzcGxheUNvbmRpdGlvbi5jbG9uZShcbiAgICAgICAgdmFsdWUsXG4gICAgICAgIHRoaXMuX2Rpc3RhbmNlRGlzcGxheUNvbmRpdGlvblxuICAgICAgKTtcbiAgICB9LFxuICB9LFxuXG4gIGV4dGVuc2lvbnNVc2VkOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIWRlZmluZWQodGhpcy5fZXh0ZW5zaW9uc1VzZWQpKSB7XG4gICAgICAgIHRoaXMuX2V4dGVuc2lvbnNVc2VkID0gTW9kZWxVdGlsaXR5LmdldFVzZWRFeHRlbnNpb25zKHRoaXMuZ2x0Zik7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5fZXh0ZW5zaW9uc1VzZWQ7XG4gICAgfSxcbiAgfSxcblxuICBleHRlbnNpb25zUmVxdWlyZWQ6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghZGVmaW5lZCh0aGlzLl9leHRlbnNpb25zUmVxdWlyZWQpKSB7XG4gICAgICAgIHRoaXMuX2V4dGVuc2lvbnNSZXF1aXJlZCA9IE1vZGVsVXRpbGl0eS5nZXRSZXF1aXJlZEV4dGVuc2lvbnMoXG4gICAgICAgICAgdGhpcy5nbHRmXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5fZXh0ZW5zaW9uc1JlcXVpcmVkO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIG1vZGVsJ3MgdXAtYXhpcy5cbiAgICogQnkgZGVmYXVsdCBtb2RlbHMgYXJlIHktdXAgYWNjb3JkaW5nIHRvIHRoZSBnbFRGIHNwZWMsIGhvd2V2ZXIgZ2VvLXJlZmVyZW5jZWQgbW9kZWxzIHdpbGwgdHlwaWNhbGx5IGJlIHotdXAuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBNb2RlbC5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge051bWJlcn1cbiAgICogQGRlZmF1bHQgQXhpcy5ZXG4gICAqIEByZWFkb25seVxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdXBBeGlzOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdXBBeGlzO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIG1vZGVsJ3MgZm9yd2FyZCBheGlzLlxuICAgKiBCeSBkZWZhdWx0LCBnbFRGIDIuMCBtb2RlbHMgYXJlIHotZm9yd2FyZCBhY2NvcmRpbmcgdG8gdGhlIGdsVEYgc3BlYywgaG93ZXZlciBvbGRlclxuICAgKiBnbFRGICgxLjAsIDAuOCkgbW9kZWxzIHVzZWQgeC1mb3J3YXJkLiAgTm90ZSB0aGF0IG9ubHkgQXhpcy5YIGFuZCBBeGlzLlogYXJlIHN1cHBvcnRlZC5cbiAgICpcbiAgICogQG1lbWJlcm9mIE1vZGVsLnByb3RvdHlwZVxuICAgKlxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKiBAZGVmYXVsdCBBeGlzLlpcbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBmb3J3YXJkQXhpczoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKGRlZmluZWQodGhpcy5fZm9yd2FyZEF4aXMpKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mb3J3YXJkQXhpcztcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLl9nbHRmRm9yd2FyZEF4aXM7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogR2V0cyB0aGUgbW9kZWwncyB0cmlhbmdsZSBjb3VudC5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHRyaWFuZ2xlc0xlbmd0aDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3RyaWFuZ2xlc0xlbmd0aDtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBtb2RlbCdzIHBvaW50IGNvdW50LlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcG9pbnRzTGVuZ3RoOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcG9pbnRzTGVuZ3RoO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIG1vZGVsJ3MgZ2VvbWV0cnkgbWVtb3J5IGluIGJ5dGVzLiBUaGlzIGluY2x1ZGVzIGFsbCB2ZXJ0ZXggYW5kIGluZGV4IGJ1ZmZlcnMuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBnZW9tZXRyeUJ5dGVMZW5ndGg6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9nZW9tZXRyeUJ5dGVMZW5ndGg7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogR2V0cyB0aGUgbW9kZWwncyB0ZXh0dXJlIG1lbW9yeSBpbiBieXRlcy5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHRleHR1cmVzQnl0ZUxlbmd0aDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3RleHR1cmVzQnl0ZUxlbmd0aDtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBtb2RlbCdzIGNhY2hlZCBnZW9tZXRyeSBtZW1vcnkgaW4gYnl0ZXMuIFRoaXMgaW5jbHVkZXMgYWxsIHZlcnRleCBhbmQgaW5kZXggYnVmZmVycy5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGNhY2hlZEdlb21ldHJ5Qnl0ZUxlbmd0aDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlZEdlb21ldHJ5Qnl0ZUxlbmd0aDtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBtb2RlbCdzIGNhY2hlZCB0ZXh0dXJlIG1lbW9yeSBpbiBieXRlcy5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGNhY2hlZFRleHR1cmVzQnl0ZUxlbmd0aDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlZFRleHR1cmVzQnl0ZUxlbmd0aDtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBUaGUge0BsaW5rIENsaXBwaW5nUGxhbmVDb2xsZWN0aW9ufSB1c2VkIHRvIHNlbGVjdGl2ZWx5IGRpc2FibGUgcmVuZGVyaW5nIHRoZSBtb2RlbC5cbiAgICpcbiAgICogQG1lbWJlcm9mIE1vZGVsLnByb3RvdHlwZVxuICAgKlxuICAgKiBAdHlwZSB7Q2xpcHBpbmdQbGFuZUNvbGxlY3Rpb259XG4gICAqL1xuICBjbGlwcGluZ1BsYW5lczoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NsaXBwaW5nUGxhbmVzO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIGlmICh2YWx1ZSA9PT0gdGhpcy5fY2xpcHBpbmdQbGFuZXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgLy8gSGFuZGxlIGRlc3Ryb3lpbmcsIGNoZWNraW5nIG9mIHVua25vd24sIGNoZWNraW5nIGZvciBleGlzdGluZyBvd25lcnNoaXBcbiAgICAgIENsaXBwaW5nUGxhbmVDb2xsZWN0aW9uLnNldE93bmVyKHZhbHVlLCB0aGlzLCBcIl9jbGlwcGluZ1BsYW5lc1wiKTtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcGlja0lkczoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3BpY2tJZHM7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogQ2VzaXVtIGFkZHMgbGlnaHRpbmcgZnJvbSB0aGUgZWFydGgsIHNreSwgYXRtb3NwaGVyZSwgYW5kIHN0YXIgc2t5Ym94LiBUaGlzIGNhcnRlc2lhbiBpcyB1c2VkIHRvIHNjYWxlIHRoZSBmaW5hbFxuICAgKiBkaWZmdXNlIGFuZCBzcGVjdWxhciBsaWdodGluZyBjb250cmlidXRpb24gZnJvbSB0aG9zZSBzb3VyY2VzIHRvIHRoZSBmaW5hbCBjb2xvci4gQSB2YWx1ZSBvZiAwLjAgd2lsbCBkaXNhYmxlIHRob3NlIGxpZ2h0IHNvdXJjZXMuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBNb2RlbC5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge0NhcnRlc2lhbjJ9XG4gICAqIEBkZWZhdWx0IENhcnRlc2lhbjIoMS4wLCAxLjApXG4gICAqL1xuICBpbWFnZUJhc2VkTGlnaHRpbmdGYWN0b3I6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9pbWFnZUJhc2VkTGlnaHRpbmdGYWN0b3I7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgICAgIENoZWNrLnR5cGVPZi5vYmplY3QoXCJpbWFnZUJhc2VkTGlnaHRpbmdGYWN0b3JcIiwgdmFsdWUpO1xuICAgICAgQ2hlY2sudHlwZU9mLm51bWJlci5ncmVhdGVyVGhhbk9yRXF1YWxzKFxuICAgICAgICBcImltYWdlQmFzZWRMaWdodGluZ0ZhY3Rvci54XCIsXG4gICAgICAgIHZhbHVlLngsXG4gICAgICAgIDAuMFxuICAgICAgKTtcbiAgICAgIENoZWNrLnR5cGVPZi5udW1iZXIubGVzc1RoYW5PckVxdWFscyhcbiAgICAgICAgXCJpbWFnZUJhc2VkTGlnaHRpbmdGYWN0b3IueFwiLFxuICAgICAgICB2YWx1ZS54LFxuICAgICAgICAxLjBcbiAgICAgICk7XG4gICAgICBDaGVjay50eXBlT2YubnVtYmVyLmdyZWF0ZXJUaGFuT3JFcXVhbHMoXG4gICAgICAgIFwiaW1hZ2VCYXNlZExpZ2h0aW5nRmFjdG9yLnlcIixcbiAgICAgICAgdmFsdWUueSxcbiAgICAgICAgMC4wXG4gICAgICApO1xuICAgICAgQ2hlY2sudHlwZU9mLm51bWJlci5sZXNzVGhhbk9yRXF1YWxzKFxuICAgICAgICBcImltYWdlQmFzZWRMaWdodGluZ0ZhY3Rvci55XCIsXG4gICAgICAgIHZhbHVlLnksXG4gICAgICAgIDEuMFxuICAgICAgKTtcbiAgICAgIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuICAgICAgdmFyIGltYWdlQmFzZWRMaWdodGluZ0ZhY3RvciA9IHRoaXMuX2ltYWdlQmFzZWRMaWdodGluZ0ZhY3RvcjtcbiAgICAgIGlmIChcbiAgICAgICAgdmFsdWUgPT09IGltYWdlQmFzZWRMaWdodGluZ0ZhY3RvciB8fFxuICAgICAgICBDYXJ0ZXNpYW4yLmVxdWFscyh2YWx1ZSwgaW1hZ2VCYXNlZExpZ2h0aW5nRmFjdG9yKVxuICAgICAgKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3Nob3VsZFJlZ2VuZXJhdGVTaGFkZXJzID1cbiAgICAgICAgdGhpcy5fc2hvdWxkUmVnZW5lcmF0ZVNoYWRlcnMgfHxcbiAgICAgICAgKHRoaXMuX2ltYWdlQmFzZWRMaWdodGluZ0ZhY3Rvci54ID4gMC4wICYmIHZhbHVlLnggPT09IDAuMCkgfHxcbiAgICAgICAgKHRoaXMuX2ltYWdlQmFzZWRMaWdodGluZ0ZhY3Rvci54ID09PSAwLjAgJiYgdmFsdWUueCA+IDAuMCk7XG4gICAgICB0aGlzLl9zaG91bGRSZWdlbmVyYXRlU2hhZGVycyA9XG4gICAgICAgIHRoaXMuX3Nob3VsZFJlZ2VuZXJhdGVTaGFkZXJzIHx8XG4gICAgICAgICh0aGlzLl9pbWFnZUJhc2VkTGlnaHRpbmdGYWN0b3IueSA+IDAuMCAmJiB2YWx1ZS55ID09PSAwLjApIHx8XG4gICAgICAgICh0aGlzLl9pbWFnZUJhc2VkTGlnaHRpbmdGYWN0b3IueSA9PT0gMC4wICYmIHZhbHVlLnkgPiAwLjApO1xuICAgICAgQ2FydGVzaWFuMi5jbG9uZSh2YWx1ZSwgdGhpcy5faW1hZ2VCYXNlZExpZ2h0aW5nRmFjdG9yKTtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBUaGUgbGlnaHQgY29sb3Igd2hlbiBzaGFkaW5nIHRoZSBtb2RlbC4gV2hlbiA8Y29kZT51bmRlZmluZWQ8L2NvZGU+IHRoZSBzY2VuZSdzIGxpZ2h0IGNvbG9yIGlzIHVzZWQgaW5zdGVhZC5cbiAgICogPHA+XG4gICAqIEZvciBleGFtcGxlLCBkaXNhYmxpbmcgYWRkaXRpb25hbCBsaWdodCBzb3VyY2VzIGJ5IHNldHRpbmcgPGNvZGU+bW9kZWwuaW1hZ2VCYXNlZExpZ2h0aW5nRmFjdG9yID0gbmV3IENlc2l1bS5DYXJ0ZXNpYW4yKDAuMCwgMC4wKTwvY29kZT4gd2lsbCBtYWtlIHRoZVxuICAgKiBtb2RlbCBtdWNoIGRhcmtlci4gSGVyZSwgaW5jcmVhc2luZyB0aGUgaW50ZW5zaXR5IG9mIHRoZSBsaWdodCBzb3VyY2Ugd2lsbCBtYWtlIHRoZSBtb2RlbCBicmlnaHRlci5cbiAgICogPC9wPlxuICAgKlxuICAgKiBAbWVtYmVyb2YgTW9kZWwucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtDYXJ0ZXNpYW4zfVxuICAgKiBAZGVmYXVsdCB1bmRlZmluZWRcbiAgICovXG4gIGxpZ2h0Q29sb3I6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9saWdodENvbG9yO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHZhciBsaWdodENvbG9yID0gdGhpcy5fbGlnaHRDb2xvcjtcbiAgICAgIGlmICh2YWx1ZSA9PT0gbGlnaHRDb2xvciB8fCBDYXJ0ZXNpYW4zLmVxdWFscyh2YWx1ZSwgbGlnaHRDb2xvcikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5fc2hvdWxkUmVnZW5lcmF0ZVNoYWRlcnMgPVxuICAgICAgICB0aGlzLl9zaG91bGRSZWdlbmVyYXRlU2hhZGVycyB8fFxuICAgICAgICAoZGVmaW5lZChsaWdodENvbG9yKSAmJiAhZGVmaW5lZCh2YWx1ZSkpIHx8XG4gICAgICAgIChkZWZpbmVkKHZhbHVlKSAmJiAhZGVmaW5lZChsaWdodENvbG9yKSk7XG4gICAgICB0aGlzLl9saWdodENvbG9yID0gQ2FydGVzaWFuMy5jbG9uZSh2YWx1ZSwgbGlnaHRDb2xvcik7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogVGhlIHN1bidzIGx1bWluYW5jZSBhdCB0aGUgemVuaXRoIGluIGtpbG8gY2FuZGVsYSBwZXIgbWV0ZXIgc3F1YXJlZCB0byB1c2UgZm9yIHRoaXMgbW9kZWwncyBwcm9jZWR1cmFsIGVudmlyb25tZW50IG1hcC5cbiAgICogVGhpcyBpcyB1c2VkIHdoZW4ge0BsaW5rIE1vZGVsI3NwZWN1bGFyRW52aXJvbm1lbnRNYXBzfSBhbmQge0BsaW5rIE1vZGVsI3NwaGVyaWNhbEhhcm1vbmljQ29lZmZpY2llbnRzfSBhcmUgbm90IGRlZmluZWQuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBNb2RlbC5wcm90b3R5cGVcbiAgICpcbiAgICogQGRlbW8ge0BsaW5rIGh0dHBzOi8vc2FuZGNhc3RsZS5jZXNpdW0uY29tL2luZGV4Lmh0bWw/c3JjPUltYWdlLUJhc2VkIExpZ2h0aW5nLmh0bWx8U2FuZGNhc3RsZSBJbWFnZSBCYXNlZCBMaWdodGluZyBEZW1vfVxuICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgKiBAZGVmYXVsdCAwLjJcbiAgICovXG4gIGx1bWluYW5jZUF0WmVuaXRoOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbHVtaW5hbmNlQXRaZW5pdGg7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgdmFyIGx1bSA9IHRoaXMuX2x1bWluYW5jZUF0WmVuaXRoO1xuICAgICAgaWYgKHZhbHVlID09PSBsdW0pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5fc2hvdWxkUmVnZW5lcmF0ZVNoYWRlcnMgPVxuICAgICAgICB0aGlzLl9zaG91bGRSZWdlbmVyYXRlU2hhZGVycyB8fFxuICAgICAgICAoZGVmaW5lZChsdW0pICYmICFkZWZpbmVkKHZhbHVlKSkgfHxcbiAgICAgICAgKGRlZmluZWQodmFsdWUpICYmICFkZWZpbmVkKGx1bSkpO1xuICAgICAgdGhpcy5fbHVtaW5hbmNlQXRaZW5pdGggPSB2YWx1ZTtcbiAgICB9LFxuICB9LFxuXG4gIC8qKlxuICAgKiBUaGUgdGhpcmQgb3JkZXIgc3BoZXJpY2FsIGhhcm1vbmljIGNvZWZmaWNpZW50cyB1c2VkIGZvciB0aGUgZGlmZnVzZSBjb2xvciBvZiBpbWFnZS1iYXNlZCBsaWdodGluZy4gV2hlbiA8Y29kZT51bmRlZmluZWQ8L2NvZGU+LCBhIGRpZmZ1c2UgaXJyYWRpYW5jZVxuICAgKiBjb21wdXRlZCBmcm9tIHRoZSBhdG1vc3BoZXJlIGNvbG9yIGlzIHVzZWQuXG4gICAqIDxwPlxuICAgKiBUaGVyZSBhcmUgbmluZSA8Y29kZT5DYXJ0ZXNpYW4zPC9jb2RlPiBjb2VmZmljaWVudHMuXG4gICAqIFRoZSBvcmRlciBvZiB0aGUgY29lZmZpY2llbnRzIGlzOiBMPHN1Yj4wMDwvc3ViPiwgTDxzdWI+MS0xPC9zdWI+LCBMPHN1Yj4xMDwvc3ViPiwgTDxzdWI+MTE8L3N1Yj4sIEw8c3ViPjItMjwvc3ViPiwgTDxzdWI+Mi0xPC9zdWI+LCBMPHN1Yj4yMDwvc3ViPiwgTDxzdWI+MjE8L3N1Yj4sIEw8c3ViPjIyPC9zdWI+XG4gICAqIDwvcD5cbiAgICpcbiAgICogVGhlc2UgdmFsdWVzIGNhbiBiZSBvYnRhaW5lZCBieSBwcmVwcm9jZXNzaW5nIHRoZSBlbnZpcm9ubWVudCBtYXAgdXNpbmcgdGhlIDxjb2RlPmNtZ2VuPC9jb2RlPiB0b29sIG9mXG4gICAqIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2ZpbGFtZW50L3JlbGVhc2VzfEdvb2dsZSdzIEZpbGFtZW50IHByb2plY3R9LiBUaGlzIHdpbGwgYWxzbyBnZW5lcmF0ZSBhIEtUWCBmaWxlIHRoYXQgY2FuIGJlXG4gICAqIHN1cHBsaWVkIHRvIHtAbGluayBNb2RlbCNzcGVjdWxhckVudmlyb25tZW50TWFwc30uXG4gICAqXG4gICAqIEBtZW1iZXJvZiBNb2RlbC5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge0NhcnRlc2lhbjNbXX1cbiAgICogQGRlbW8ge0BsaW5rIGh0dHBzOi8vc2FuZGNhc3RsZS5jZXNpdW0uY29tL2luZGV4Lmh0bWw/c3JjPUltYWdlLUJhc2VkIExpZ2h0aW5nLmh0bWx8U2FuZGNhc3RsZSBJbWFnZSBCYXNlZCBMaWdodGluZyBEZW1vfVxuICAgKiBAc2VlIHtAbGluayBodHRwczovL2dyYXBoaWNzLnN0YW5mb3JkLmVkdS9wYXBlcnMvZW52bWFwL2Vudm1hcC5wZGZ8QW4gRWZmaWNpZW50IFJlcHJlc2VudGF0aW9uIGZvciBJcnJhZGlhbmNlIEVudmlyb25tZW50IE1hcHN9XG4gICAqL1xuICBzcGhlcmljYWxIYXJtb25pY0NvZWZmaWNpZW50czoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3NwaGVyaWNhbEhhcm1vbmljQ29lZmZpY2llbnRzO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gICAgICBpZiAoZGVmaW5lZCh2YWx1ZSkgJiYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSB8fCB2YWx1ZS5sZW5ndGggIT09IDkpKSB7XG4gICAgICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcbiAgICAgICAgICBcInNwaGVyaWNhbEhhcm1vbmljQ29lZmZpY2llbnRzIG11c3QgYmUgYW4gYXJyYXkgb2YgOSBDYXJ0ZXNpYW4zIHZhbHVlcy5cIlxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG4gICAgICBpZiAodmFsdWUgPT09IHRoaXMuX3NwaGVyaWNhbEhhcm1vbmljQ29lZmZpY2llbnRzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3NwaGVyaWNhbEhhcm1vbmljQ29lZmZpY2llbnRzID0gdmFsdWU7XG4gICAgICB0aGlzLl9zaG91bGRSZWdlbmVyYXRlU2hhZGVycyA9IHRydWU7XG4gICAgfSxcbiAgfSxcblxuICAvKipcbiAgICogQSBVUkwgdG8gYSBLVFgyIGZpbGUgdGhhdCBjb250YWlucyBhIGN1YmUgbWFwIG9mIHRoZSBzcGVjdWxhciBsaWdodGluZyBhbmQgdGhlIGNvbnZvbHV0ZWQgc3BlY3VsYXIgbWlwbWFwcy5cbiAgICpcbiAgICogQG1lbWJlcm9mIE1vZGVsLnByb3RvdHlwZVxuICAgKiBAZGVtbyB7QGxpbmsgaHR0cHM6Ly9zYW5kY2FzdGxlLmNlc2l1bS5jb20vaW5kZXguaHRtbD9zcmM9SW1hZ2UtQmFzZWQgTGlnaHRpbmcuaHRtbHxTYW5kY2FzdGxlIEltYWdlIEJhc2VkIExpZ2h0aW5nIERlbW99XG4gICAqIEB0eXBlIHtTdHJpbmd9XG4gICAqIEBzZWUgTW9kZWwjc3BoZXJpY2FsSGFybW9uaWNDb2VmZmljaWVudHNcbiAgICovXG4gIHNwZWN1bGFyRW52aXJvbm1lbnRNYXBzOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3BlY3VsYXJFbnZpcm9ubWVudE1hcHM7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgdGhpcy5fc2hvdWxkVXBkYXRlU3BlY3VsYXJNYXBBdGxhcyA9XG4gICAgICAgIHRoaXMuX3Nob3VsZFVwZGF0ZVNwZWN1bGFyTWFwQXRsYXMgfHxcbiAgICAgICAgdmFsdWUgIT09IHRoaXMuX3NwZWN1bGFyRW52aXJvbm1lbnRNYXBzO1xuICAgICAgdGhpcy5fc3BlY3VsYXJFbnZpcm9ubWVudE1hcHMgPSB2YWx1ZTtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogR2V0cyB0aGUgY3JlZGl0IHRoYXQgd2lsbCBiZSBkaXNwbGF5ZWQgZm9yIHRoZSBtb2RlbFxuICAgKiBAbWVtYmVyb2YgTW9kZWwucHJvdG90eXBlXG4gICAqIEB0eXBlIHtDcmVkaXR9XG4gICAqL1xuICBjcmVkaXQ6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jcmVkaXQ7XG4gICAgfSxcbiAgfSxcbn0pO1xuXG5mdW5jdGlvbiBzaWxob3VldHRlU3VwcG9ydGVkKGNvbnRleHQpIHtcbiAgcmV0dXJuIGNvbnRleHQuc3RlbmNpbEJ1ZmZlcjtcbn1cblxuZnVuY3Rpb24gaXNDb2xvclNoYWRpbmdFbmFibGVkKG1vZGVsKSB7XG4gIHJldHVybiAoXG4gICAgIUNvbG9yLmVxdWFscyhtb2RlbC5jb2xvciwgQ29sb3IuV0hJVEUpIHx8XG4gICAgbW9kZWwuY29sb3JCbGVuZE1vZGUgIT09IENvbG9yQmxlbmRNb2RlLkhJR0hMSUdIVFxuICApO1xufVxuXG5mdW5jdGlvbiBpc0NsaXBwaW5nRW5hYmxlZChtb2RlbCkge1xuICB2YXIgY2xpcHBpbmdQbGFuZXMgPSBtb2RlbC5fY2xpcHBpbmdQbGFuZXM7XG4gIHJldHVybiAoXG4gICAgZGVmaW5lZChjbGlwcGluZ1BsYW5lcykgJiZcbiAgICBjbGlwcGluZ1BsYW5lcy5lbmFibGVkICYmXG4gICAgY2xpcHBpbmdQbGFuZXMubGVuZ3RoICE9PSAwXG4gICk7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lcyBpZiBzaWxob3VldHRlcyBhcmUgc3VwcG9ydGVkLlxuICpcbiAqIEBwYXJhbSB7U2NlbmV9IHNjZW5lIFRoZSBzY2VuZS5cbiAqIEByZXR1cm5zIHtCb29sZWFufSA8Y29kZT50cnVlPC9jb2RlPiBpZiBzaWxob3VldHRlcyBhcmUgc3VwcG9ydGVkOyBvdGhlcndpc2UsIHJldHVybnMgPGNvZGU+ZmFsc2U8L2NvZGU+XG4gKi9cbk1vZGVsLnNpbGhvdWV0dGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoc2NlbmUpIHtcbiAgcmV0dXJuIHNpbGhvdWV0dGVTdXBwb3J0ZWQoc2NlbmUuY29udGV4dCk7XG59O1xuXG5mdW5jdGlvbiBjb250YWluc0dsdGZNYWdpYyh1aW50OEFycmF5KSB7XG4gIHZhciBtYWdpYyA9IGdldE1hZ2ljKHVpbnQ4QXJyYXkpO1xuICByZXR1cm4gbWFnaWMgPT09IFwiZ2xURlwiO1xufVxuXG4vKipcbiAqIDxwPlxuICogQ3JlYXRlcyBhIG1vZGVsIGZyb20gYSBnbFRGIGFzc2V0LiAgV2hlbiB0aGUgbW9kZWwgaXMgcmVhZHkgdG8gcmVuZGVyLCBpLmUuLCB3aGVuIHRoZSBleHRlcm5hbCBiaW5hcnksIGltYWdlLFxuICogYW5kIHNoYWRlciBmaWxlcyBhcmUgZG93bmxvYWRlZCBhbmQgdGhlIFdlYkdMIHJlc291cmNlcyBhcmUgY3JlYXRlZCwgdGhlIHtAbGluayBNb2RlbCNyZWFkeVByb21pc2V9IGlzIHJlc29sdmVkLlxuICogPC9wPlxuICogPHA+XG4gKiBUaGUgbW9kZWwgY2FuIGJlIGEgdHJhZGl0aW9uYWwgZ2xURiBhc3NldCB3aXRoIGEgLmdsdGYgZXh0ZW5zaW9uIG9yIGEgQmluYXJ5IGdsVEYgdXNpbmcgdGhlIC5nbGIgZXh0ZW5zaW9uLlxuICogPC9wPlxuICogPHA+XG4gKiBDZXNpdW0gc3VwcG9ydHMgZ2xURiBhc3NldHMgd2l0aCB0aGUgZm9sbG93aW5nIGV4dGVuc2lvbnM6XG4gKiA8dWw+XG4gKiA8bGk+XG4gKiB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL0tocm9ub3NHcm91cC9nbFRGL2Jsb2IvbWFzdGVyL2V4dGVuc2lvbnMvMS4wL0tocm9ub3MvS0hSX2JpbmFyeV9nbFRGL1JFQURNRS5tZHxLSFJfYmluYXJ5X2dsVEYgKGdsVEYgMS4wKX1cbiAqIDwvbGk+PGxpPlxuICoge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9LaHJvbm9zR3JvdXAvZ2xURi9ibG9iL21hc3Rlci9leHRlbnNpb25zLzEuMC9LaHJvbm9zL0tIUl9tYXRlcmlhbHNfY29tbW9uL1JFQURNRS5tZHxLSFJfbWF0ZXJpYWxzX2NvbW1vbiAoZ2xURiAxLjApfVxuICogPC9saT48bGk+XG4gKiB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL0tocm9ub3NHcm91cC9nbFRGL2Jsb2IvbWFzdGVyL2V4dGVuc2lvbnMvMS4wL1ZlbmRvci9XRUIzRF9xdWFudGl6ZWRfYXR0cmlidXRlcy9SRUFETUUubWR8V0VCM0RfcXVhbnRpemVkX2F0dHJpYnV0ZXMgKGdsVEYgMS4wKX1cbiAqIDwvbGk+PGxpPlxuICoge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9LaHJvbm9zR3JvdXAvZ2xURi90cmVlL21hc3Rlci9leHRlbnNpb25zLzIuMC9WZW5kb3IvQUdJX2FydGljdWxhdGlvbnMvUkVBRE1FLm1kfEFHSV9hcnRpY3VsYXRpb25zfVxuICogPC9saT48bGk+XG4gKiB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL0tocm9ub3NHcm91cC9nbFRGL3B1bGwvMTMwMnxLSFJfYmxlbmQgKGRyYWZ0KX1cbiAqIDwvbGk+PGxpPlxuICoge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9LaHJvbm9zR3JvdXAvZ2xURi9ibG9iL21hc3Rlci9leHRlbnNpb25zLzIuMC9LaHJvbm9zL0tIUl9kcmFjb19tZXNoX2NvbXByZXNzaW9uL1JFQURNRS5tZHxLSFJfZHJhY29fbWVzaF9jb21wcmVzc2lvbn1cbiAqIDwvbGk+PGxpPlxuICoge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9LaHJvbm9zR3JvdXAvZ2xURi90cmVlL21hc3Rlci9leHRlbnNpb25zLzIuMC9LaHJvbm9zL0tIUl9tYXRlcmlhbHNfcGJyU3BlY3VsYXJHbG9zc2luZXNzL1JFQURNRS5tZHxLSFJfbWF0ZXJpYWxzX3BiclNwZWN1bGFyR2xvc3NpbmVzc31cbiAqIDwvbGk+PGxpPlxuICoge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9LaHJvbm9zR3JvdXAvZ2xURi90cmVlL21hc3Rlci9leHRlbnNpb25zLzIuMC9LaHJvbm9zL0tIUl9tYXRlcmlhbHNfdW5saXQvUkVBRE1FLm1kfEtIUl9tYXRlcmlhbHNfdW5saXR9XG4gKiA8L2xpPjxsaT5cbiAqIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vS2hyb25vc0dyb3VwL2dsVEYvYmxvYi9tYXN0ZXIvZXh0ZW5zaW9ucy8yLjAvS2hyb25vcy9LSFJfdGVjaG5pcXVlc193ZWJnbC9SRUFETUUubWR8S0hSX3RlY2huaXF1ZXNfd2ViZ2x9XG4gKiA8L2xpPjxsaT5cbiAqIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vS2hyb25vc0dyb3VwL2dsVEYvYmxvYi9tYXN0ZXIvZXh0ZW5zaW9ucy8yLjAvS2hyb25vcy9LSFJfdGV4dHVyZV90cmFuc2Zvcm0vUkVBRE1FLm1kfEtIUl90ZXh0dXJlX3RyYW5zZm9ybX1cbiAqIDwvbGk+PGxpPlxuICoge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9LaHJvbm9zR3JvdXAvZ2xURi9ibG9iL21hc3Rlci9leHRlbnNpb25zLzIuMC9LaHJvbm9zL0tIUl90ZXh0dXJlX2Jhc2lzdS9SRUFETUUubWR8S0hSX3RleHR1cmVfYmFzaXN1fVxuICogPC9saT5cbiAqIDwvdWw+XG4gKiA8L3A+XG4gKiA8cD5cbiAqIEZvciBoaWdoLXByZWNpc2lvbiByZW5kZXJpbmcsIENlc2l1bSBzdXBwb3J0cyB0aGUge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9LaHJvbm9zR3JvdXAvZ2xURi9ibG9iL21hc3Rlci9leHRlbnNpb25zLzEuMC9WZW5kb3IvQ0VTSVVNX1JUQy9SRUFETUUubWR8Q0VTSVVNX1JUQ30gZXh0ZW5zaW9uLCB3aGljaCBpbnRyb2R1Y2VzIHRoZVxuICogQ0VTSVVNX1JUQ19NT0RFTFZJRVcgcGFyYW1ldGVyIHNlbWFudGljIHRoYXQgc2F5cyB0aGUgbm9kZSBpcyBpbiBXR1M4NCBjb29yZGluYXRlcyB0cmFuc2xhdGVkXG4gKiByZWxhdGl2ZSB0byBhIGxvY2FsIG9yaWdpbi5cbiAqIDwvcD5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBPYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gKiBAcGFyYW0ge1Jlc291cmNlfFN0cmluZ30gb3B0aW9ucy51cmwgVGhlIHVybCB0byB0aGUgLmdsdGYgZmlsZS5cbiAqIEBwYXJhbSB7UmVzb3VyY2V8U3RyaW5nfSBbb3B0aW9ucy5iYXNlUGF0aF0gVGhlIGJhc2UgcGF0aCB0aGF0IHBhdGhzIGluIHRoZSBnbFRGIEpTT04gYXJlIHJlbGF0aXZlIHRvLlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5zaG93PXRydWVdIERldGVybWluZXMgaWYgdGhlIG1vZGVsIHByaW1pdGl2ZSB3aWxsIGJlIHNob3duLlxuICogQHBhcmFtIHtNYXRyaXg0fSBbb3B0aW9ucy5tb2RlbE1hdHJpeD1NYXRyaXg0LklERU5USVRZXSBUaGUgNHg0IHRyYW5zZm9ybWF0aW9uIG1hdHJpeCB0aGF0IHRyYW5zZm9ybXMgdGhlIG1vZGVsIGZyb20gbW9kZWwgdG8gd29ybGQgY29vcmRpbmF0ZXMuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMuc2NhbGU9MS4wXSBBIHVuaWZvcm0gc2NhbGUgYXBwbGllZCB0byB0aGlzIG1vZGVsLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLm1pbmltdW1QaXhlbFNpemU9MC4wXSBUaGUgYXBwcm94aW1hdGUgbWluaW11bSBwaXhlbCBzaXplIG9mIHRoZSBtb2RlbCByZWdhcmRsZXNzIG9mIHpvb20uXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMubWF4aW11bVNjYWxlXSBUaGUgbWF4aW11bSBzY2FsZSBmb3IgdGhlIG1vZGVsLlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLmlkXSBBIHVzZXItZGVmaW5lZCBvYmplY3QgdG8gcmV0dXJuIHdoZW4gdGhlIG1vZGVsIGlzIHBpY2tlZCB3aXRoIHtAbGluayBTY2VuZSNwaWNrfS5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuYWxsb3dQaWNraW5nPXRydWVdIFdoZW4gPGNvZGU+dHJ1ZTwvY29kZT4sIGVhY2ggZ2xURiBtZXNoIGFuZCBwcmltaXRpdmUgaXMgcGlja2FibGUgd2l0aCB7QGxpbmsgU2NlbmUjcGlja30uXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmluY3JlbWVudGFsbHlMb2FkVGV4dHVyZXM9dHJ1ZV0gRGV0ZXJtaW5lIGlmIHRleHR1cmVzIG1heSBjb250aW51ZSB0byBzdHJlYW0gaW4gYWZ0ZXIgdGhlIG1vZGVsIGlzIGxvYWRlZC5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuYXN5bmNocm9ub3VzPXRydWVdIERldGVybWluZXMgaWYgbW9kZWwgV2ViR0wgcmVzb3VyY2UgY3JlYXRpb24gd2lsbCBiZSBzcHJlYWQgb3V0IG92ZXIgc2V2ZXJhbCBmcmFtZXMgb3IgYmxvY2sgdW50aWwgY29tcGxldGlvbiBvbmNlIGFsbCBnbFRGIGZpbGVzIGFyZSBsb2FkZWQuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmNsYW1wQW5pbWF0aW9ucz10cnVlXSBEZXRlcm1pbmVzIGlmIHRoZSBtb2RlbCdzIGFuaW1hdGlvbnMgc2hvdWxkIGhvbGQgYSBwb3NlIG92ZXIgZnJhbWVzIHdoZXJlIG5vIGtleWZyYW1lcyBhcmUgc3BlY2lmaWVkLlxuICogQHBhcmFtIHtTaGFkb3dNb2RlfSBbb3B0aW9ucy5zaGFkb3dzPVNoYWRvd01vZGUuRU5BQkxFRF0gRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBtb2RlbCBjYXN0cyBvciByZWNlaXZlcyBzaGFkb3dzIGZyb20gbGlnaHQgc291cmNlcy5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuZGVidWdTaG93Qm91bmRpbmdWb2x1bWU9ZmFsc2VdIEZvciBkZWJ1Z2dpbmcgb25seS4gRHJhd3MgdGhlIGJvdW5kaW5nIHNwaGVyZSBmb3IgZWFjaCBkcmF3IGNvbW1hbmQgaW4gdGhlIG1vZGVsLlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5kZWJ1Z1dpcmVmcmFtZT1mYWxzZV0gRm9yIGRlYnVnZ2luZyBvbmx5LiBEcmF3cyB0aGUgbW9kZWwgaW4gd2lyZWZyYW1lLlxuICogQHBhcmFtIHtIZWlnaHRSZWZlcmVuY2V9IFtvcHRpb25zLmhlaWdodFJlZmVyZW5jZT1IZWlnaHRSZWZlcmVuY2UuTk9ORV0gRGV0ZXJtaW5lcyBob3cgdGhlIG1vZGVsIGlzIGRyYXduIHJlbGF0aXZlIHRvIHRlcnJhaW4uXG4gKiBAcGFyYW0ge1NjZW5lfSBbb3B0aW9ucy5zY2VuZV0gTXVzdCBiZSBwYXNzZWQgaW4gZm9yIG1vZGVscyB0aGF0IHVzZSB0aGUgaGVpZ2h0IHJlZmVyZW5jZSBwcm9wZXJ0eS5cbiAqIEBwYXJhbSB7RGlzdGFuY2VEaXNwbGF5Q29uZGl0aW9ufSBbb3B0aW9ucy5kaXN0YW5jZURpc3BsYXlDb25kaXRpb25dIFRoZSBjb25kaXRpb24gc3BlY2lmeWluZyBhdCB3aGF0IGRpc3RhbmNlIGZyb20gdGhlIGNhbWVyYSB0aGF0IHRoaXMgbW9kZWwgd2lsbCBiZSBkaXNwbGF5ZWQuXG4gKiBAcGFyYW0ge0NvbG9yfSBbb3B0aW9ucy5jb2xvcj1Db2xvci5XSElURV0gQSBjb2xvciB0aGF0IGJsZW5kcyB3aXRoIHRoZSBtb2RlbCdzIHJlbmRlcmVkIGNvbG9yLlxuICogQHBhcmFtIHtDb2xvckJsZW5kTW9kZX0gW29wdGlvbnMuY29sb3JCbGVuZE1vZGU9Q29sb3JCbGVuZE1vZGUuSElHSExJR0hUXSBEZWZpbmVzIGhvdyB0aGUgY29sb3IgYmxlbmRzIHdpdGggdGhlIG1vZGVsLlxuICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLmNvbG9yQmxlbmRBbW91bnQ9MC41XSBWYWx1ZSB1c2VkIHRvIGRldGVybWluZSB0aGUgY29sb3Igc3RyZW5ndGggd2hlbiB0aGUgPGNvZGU+Y29sb3JCbGVuZE1vZGU8L2NvZGU+IGlzIDxjb2RlPk1JWDwvY29kZT4uIEEgdmFsdWUgb2YgMC4wIHJlc3VsdHMgaW4gdGhlIG1vZGVsJ3MgcmVuZGVyZWQgY29sb3Igd2hpbGUgYSB2YWx1ZSBvZiAxLjAgcmVzdWx0cyBpbiBhIHNvbGlkIGNvbG9yLCB3aXRoIGFueSB2YWx1ZSBpbi1iZXR3ZWVuIHJlc3VsdGluZyBpbiBhIG1peCBvZiB0aGUgdHdvLlxuICogQHBhcmFtIHtDb2xvcn0gW29wdGlvbnMuc2lsaG91ZXR0ZUNvbG9yPUNvbG9yLlJFRF0gVGhlIHNpbGhvdWV0dGUgY29sb3IuIElmIG1vcmUgdGhhbiAyNTYgbW9kZWxzIGhhdmUgc2lsaG91ZXR0ZXMgZW5hYmxlZCwgdGhlcmUgaXMgYSBzbWFsbCBjaGFuY2UgdGhhdCBvdmVybGFwcGluZyBtb2RlbHMgd2lsbCBoYXZlIG1pbm9yIGFydGlmYWN0cy5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5zaWxob3VldHRlU2l6ZT0wLjBdIFRoZSBzaXplIG9mIHRoZSBzaWxob3VldHRlIGluIHBpeGVscy5cbiAqIEBwYXJhbSB7Q2xpcHBpbmdQbGFuZUNvbGxlY3Rpb259IFtvcHRpb25zLmNsaXBwaW5nUGxhbmVzXSBUaGUge0BsaW5rIENsaXBwaW5nUGxhbmVDb2xsZWN0aW9ufSB1c2VkIHRvIHNlbGVjdGl2ZWx5IGRpc2FibGUgcmVuZGVyaW5nIHRoZSBtb2RlbC5cbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuZGVxdWFudGl6ZUluU2hhZGVyPXRydWVdIERldGVybWluZXMgaWYgYSB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9kcmFjb3xEcmFjb30gZW5jb2RlZCBtb2RlbCBpcyBkZXF1YW50aXplZCBvbiB0aGUgR1BVLiBUaGlzIGRlY3JlYXNlcyB0b3RhbCBtZW1vcnkgdXNhZ2UgZm9yIGVuY29kZWQgbW9kZWxzLlxuICogQHBhcmFtIHtDcmVkaXR8U3RyaW5nfSBbb3B0aW9ucy5jcmVkaXRdIEEgY3JlZGl0IGZvciB0aGUgbW9kZWwsIHdoaWNoIGlzIGRpc3BsYXllZCBvbiB0aGUgY2FudmFzLlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5iYWNrRmFjZUN1bGxpbmc9dHJ1ZV0gV2hldGhlciB0byBjdWxsIGJhY2stZmFjaW5nIGdlb21ldHJ5LiBXaGVuIHRydWUsIGJhY2sgZmFjZSBjdWxsaW5nIGlzIGRldGVybWluZWQgYnkgdGhlIG1hdGVyaWFsJ3MgZG91YmxlU2lkZWQgcHJvcGVydHk7IHdoZW4gZmFsc2UsIGJhY2sgZmFjZSBjdWxsaW5nIGlzIGRpc2FibGVkLiBCYWNrIGZhY2VzIGFyZSBub3QgY3VsbGVkIGlmIHtAbGluayBNb2RlbCNjb2xvcn0gaXMgdHJhbnNsdWNlbnQgb3Ige0BsaW5rIE1vZGVsI3NpbGhvdWV0dGVTaXplfSBpcyBncmVhdGVyIHRoYW4gMC4wLlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5zaG93T3V0bGluZT10cnVlXSBXaGV0aGVyIHRvIGRpc3BsYXkgdGhlIG91dGxpbmUgZm9yIG1vZGVscyB1c2luZyB0aGUge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9LaHJvbm9zR3JvdXAvZ2xURi90cmVlL21hc3Rlci9leHRlbnNpb25zLzIuMC9WZW5kb3IvQ0VTSVVNX3ByaW1pdGl2ZV9vdXRsaW5lfENFU0lVTV9wcmltaXRpdmVfb3V0bGluZX0gZXh0ZW5zaW9uLiBXaGVuIHRydWUsIG91dGxpbmVzIGFyZSBkaXNwbGF5ZWQuIFdoZW4gZmFsc2UsIG91dGxpbmVzIGFyZSBub3QgZGlzcGxheWVkLlxuICogQHJldHVybnMge01vZGVsfSBUaGUgbmV3bHkgY3JlYXRlZCBtb2RlbC5cbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gRXhhbXBsZSAxLiBDcmVhdGUgYSBtb2RlbCBmcm9tIGEgZ2xURiBhc3NldFxuICogdmFyIG1vZGVsID0gc2NlbmUucHJpbWl0aXZlcy5hZGQoQ2VzaXVtLk1vZGVsLmZyb21HbHRmKHtcbiAqICAgdXJsIDogJy4vZHVjay9kdWNrLmdsdGYnXG4gKiB9KSk7XG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIEV4YW1wbGUgMi4gQ3JlYXRlIG1vZGVsIGFuZCBwcm92aWRlIGFsbCBwcm9wZXJ0aWVzIGFuZCBldmVudHNcbiAqIHZhciBvcmlnaW4gPSBDZXNpdW0uQ2FydGVzaWFuMy5mcm9tRGVncmVlcygtOTUuMCwgNDAuMCwgMjAwMDAwLjApO1xuICogdmFyIG1vZGVsTWF0cml4ID0gQ2VzaXVtLlRyYW5zZm9ybXMuZWFzdE5vcnRoVXBUb0ZpeGVkRnJhbWUob3JpZ2luKTtcbiAqXG4gKiB2YXIgbW9kZWwgPSBzY2VuZS5wcmltaXRpdmVzLmFkZChDZXNpdW0uTW9kZWwuZnJvbUdsdGYoe1xuICogICB1cmwgOiAnLi9kdWNrL2R1Y2suZ2x0ZicsXG4gKiAgIHNob3cgOiB0cnVlLCAgICAgICAgICAgICAgICAgICAgIC8vIGRlZmF1bHRcbiAqICAgbW9kZWxNYXRyaXggOiBtb2RlbE1hdHJpeCxcbiAqICAgc2NhbGUgOiAyLjAsICAgICAgICAgICAgICAgICAgICAgLy8gZG91YmxlIHNpemVcbiAqICAgbWluaW11bVBpeGVsU2l6ZSA6IDEyOCwgICAgICAgICAgLy8gbmV2ZXIgc21hbGxlciB0aGFuIDEyOCBwaXhlbHNcbiAqICAgbWF4aW11bVNjYWxlOiAyMDAwMCwgICAgICAgICAgICAgLy8gbmV2ZXIgbGFyZ2VyIHRoYW4gMjAwMDAgKiBtb2RlbCBzaXplIChvdmVycmlkZXMgbWluaW11bVBpeGVsU2l6ZSlcbiAqICAgYWxsb3dQaWNraW5nIDogZmFsc2UsICAgICAgICAgICAgLy8gbm90IHBpY2thYmxlXG4gKiAgIGRlYnVnU2hvd0JvdW5kaW5nVm9sdW1lIDogZmFsc2UsIC8vIGRlZmF1bHRcbiAqICAgZGVidWdXaXJlZnJhbWUgOiBmYWxzZVxuICogfSkpO1xuICpcbiAqIG1vZGVsLnJlYWR5UHJvbWlzZS50aGVuKGZ1bmN0aW9uKG1vZGVsKSB7XG4gKiAgIC8vIFBsYXkgYWxsIGFuaW1hdGlvbnMgd2hlbiB0aGUgbW9kZWwgaXMgcmVhZHkgdG8gcmVuZGVyXG4gKiAgIG1vZGVsLmFjdGl2ZUFuaW1hdGlvbnMuYWRkQWxsKCk7XG4gKiB9KTtcbiAqL1xuTW9kZWwuZnJvbUdsdGYgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBpZiAoIWRlZmluZWQob3B0aW9ucykgfHwgIWRlZmluZWQob3B0aW9ucy51cmwpKSB7XG4gICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFwib3B0aW9ucy51cmwgaXMgcmVxdWlyZWRcIik7XG4gIH1cbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgdmFyIHVybCA9IG9wdGlvbnMudXJsO1xuICBvcHRpb25zID0gY2xvbmUob3B0aW9ucyk7XG5cbiAgLy8gQ3JlYXRlIHJlc291cmNlIGZvciB0aGUgbW9kZWwgZmlsZVxuICB2YXIgbW9kZWxSZXNvdXJjZSA9IFJlc291cmNlLmNyZWF0ZUlmTmVlZGVkKHVybCk7XG5cbiAgLy8gU2V0dXAgYmFzZVBhdGggdG8gZ2V0IGRlcGVuZGVudCBmaWxlc1xuICB2YXIgYmFzZVBhdGggPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5iYXNlUGF0aCwgbW9kZWxSZXNvdXJjZS5jbG9uZSgpKTtcbiAgdmFyIHJlc291cmNlID0gUmVzb3VyY2UuY3JlYXRlSWZOZWVkZWQoYmFzZVBhdGgpO1xuXG4gIC8vIElmIG5vIGNhY2hlIGtleSBpcyBwcm92aWRlZCwgdXNlIGEgR1VJRC5cbiAgLy8gQ2hlY2sgdXNpbmcgYSBVUkkgdG8gR1VJRCBkaWN0aW9uYXJ5IHRoYXQgd2UgaGF2ZSBub3QgYWxyZWFkeSBhZGRlZCB0aGlzIG1vZGVsLlxuICB2YXIgY2FjaGVLZXkgPSBkZWZhdWx0VmFsdWUoXG4gICAgb3B0aW9ucy5jYWNoZUtleSxcbiAgICB1cmlUb0d1aWRbZ2V0QWJzb2x1dGVVcmkobW9kZWxSZXNvdXJjZS51cmwpXVxuICApO1xuICBpZiAoIWRlZmluZWQoY2FjaGVLZXkpKSB7XG4gICAgY2FjaGVLZXkgPSBjcmVhdGVHdWlkKCk7XG4gICAgdXJpVG9HdWlkW2dldEFic29sdXRlVXJpKG1vZGVsUmVzb3VyY2UudXJsKV0gPSBjYWNoZUtleTtcbiAgfVxuXG4gIGlmIChkZWZpbmVkKG9wdGlvbnMuYmFzZVBhdGgpICYmICFkZWZpbmVkKG9wdGlvbnMuY2FjaGVLZXkpKSB7XG4gICAgY2FjaGVLZXkgKz0gcmVzb3VyY2UudXJsO1xuICB9XG4gIG9wdGlvbnMuY2FjaGVLZXkgPSBjYWNoZUtleTtcbiAgb3B0aW9ucy5iYXNlUGF0aCA9IHJlc291cmNlO1xuXG4gIHZhciBtb2RlbCA9IG5ldyBNb2RlbChvcHRpb25zKTtcblxuICB2YXIgY2FjaGVkR2x0ZiA9IGdsdGZDYWNoZVtjYWNoZUtleV07XG4gIGlmICghZGVmaW5lZChjYWNoZWRHbHRmKSkge1xuICAgIGNhY2hlZEdsdGYgPSBuZXcgQ2FjaGVkR2x0Zih7XG4gICAgICByZWFkeTogZmFsc2UsXG4gICAgfSk7XG4gICAgY2FjaGVkR2x0Zi5jb3VudCA9IDE7XG4gICAgY2FjaGVkR2x0Zi5tb2RlbHNUb0xvYWQucHVzaChtb2RlbCk7XG4gICAgc2V0Q2FjaGVkR2x0Zihtb2RlbCwgY2FjaGVkR2x0Zik7XG4gICAgZ2x0ZkNhY2hlW2NhY2hlS2V5XSA9IGNhY2hlZEdsdGY7XG5cbiAgICAvLyBBZGQgQWNjZXB0IGhlYWRlciBpZiB3ZSBuZWVkIGl0XG4gICAgaWYgKCFkZWZpbmVkKG1vZGVsUmVzb3VyY2UuaGVhZGVycy5BY2NlcHQpKSB7XG4gICAgICBtb2RlbFJlc291cmNlLmhlYWRlcnMuQWNjZXB0ID0gZGVmYXVsdE1vZGVsQWNjZXB0O1xuICAgIH1cblxuICAgIG1vZGVsUmVzb3VyY2VcbiAgICAgIC5mZXRjaEFycmF5QnVmZmVyKClcbiAgICAgIC50aGVuKGZ1bmN0aW9uIChhcnJheUJ1ZmZlcikge1xuICAgICAgICB2YXIgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheUJ1ZmZlcik7XG4gICAgICAgIGlmIChjb250YWluc0dsdGZNYWdpYyhhcnJheSkpIHtcbiAgICAgICAgICAvLyBMb2FkIGJpbmFyeSBnbFRGXG4gICAgICAgICAgdmFyIHBhcnNlZEdsdGYgPSBwYXJzZUdsYihhcnJheSk7XG4gICAgICAgICAgY2FjaGVkR2x0Zi5tYWtlUmVhZHkocGFyc2VkR2x0Zik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gTG9hZCB0ZXh0IChKU09OKSBnbFRGXG4gICAgICAgICAgdmFyIGpzb24gPSBnZXRKc29uRnJvbVR5cGVkQXJyYXkoYXJyYXkpO1xuICAgICAgICAgIGNhY2hlZEdsdGYubWFrZVJlYWR5KGpzb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHJlc291cmNlQ3JlZGl0cyA9IG1vZGVsLl9yZXNvdXJjZUNyZWRpdHM7XG4gICAgICAgIHZhciBjcmVkaXRzID0gbW9kZWxSZXNvdXJjZS5jcmVkaXRzO1xuICAgICAgICBpZiAoZGVmaW5lZChjcmVkaXRzKSkge1xuICAgICAgICAgIHZhciBsZW5ndGggPSBjcmVkaXRzLmxlbmd0aDtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICByZXNvdXJjZUNyZWRpdHMucHVzaChjcmVkaXRzW2ldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAub3RoZXJ3aXNlKFxuICAgICAgICBNb2RlbFV0aWxpdHkuZ2V0RmFpbGVkTG9hZEZ1bmN0aW9uKG1vZGVsLCBcIm1vZGVsXCIsIG1vZGVsUmVzb3VyY2UudXJsKVxuICAgICAgKTtcbiAgfSBlbHNlIGlmICghY2FjaGVkR2x0Zi5yZWFkeSkge1xuICAgIC8vIENhY2hlIGhpdCBidXQgdGhlIGZldGNoQXJyYXlCdWZmZXIoKSBvciBmZXRjaFRleHQoKSByZXF1ZXN0IGlzIHN0aWxsIHBlbmRpbmdcbiAgICArK2NhY2hlZEdsdGYuY291bnQ7XG4gICAgY2FjaGVkR2x0Zi5tb2RlbHNUb0xvYWQucHVzaChtb2RlbCk7XG4gIH1cbiAgLy8gZWxzZSBpZiB0aGUgY2FjaGVkIGdsVEYgaXMgZGVmaW5lZCBhbmQgcmVhZHksIHRoZVxuICAvLyBtb2RlbCBjb25zdHJ1Y3RvciB3aWxsIHBpY2sgaXQgdXAgdXNpbmcgdGhlIGNhY2hlIGtleS5cblxuICByZXR1cm4gbW9kZWw7XG59O1xuXG4vKipcbiAqIEZvciB0aGUgdW5pdCB0ZXN0cyB0byB2ZXJpZnkgbW9kZWwgY2FjaGluZy5cbiAqXG4gKiBAcHJpdmF0ZVxuICovXG5Nb2RlbC5fZ2x0ZkNhY2hlID0gZ2x0ZkNhY2hlO1xuXG5mdW5jdGlvbiBnZXRSdW50aW1lKG1vZGVsLCBydW50aW1lTmFtZSwgbmFtZSkge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBpZiAobW9kZWwuX3N0YXRlICE9PSBNb2RlbFN0YXRlLkxPQURFRCkge1xuICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcbiAgICAgIFwiVGhlIG1vZGVsIGlzIG5vdCBsb2FkZWQuICBVc2UgTW9kZWwucmVhZHlQcm9taXNlIG9yIHdhaXQgZm9yIE1vZGVsLnJlYWR5IHRvIGJlIHRydWUuXCJcbiAgICApO1xuICB9XG5cbiAgaWYgKCFkZWZpbmVkKG5hbWUpKSB7XG4gICAgdGhyb3cgbmV3IERldmVsb3BlckVycm9yKFwibmFtZSBpcyByZXF1aXJlZC5cIik7XG4gIH1cbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgcmV0dXJuIG1vZGVsLl9ydW50aW1lW3J1bnRpbWVOYW1lXVtuYW1lXTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBnbFRGIG5vZGUgd2l0aCB0aGUgZ2l2ZW4gPGNvZGU+bmFtZTwvY29kZT4gcHJvcGVydHkuICBUaGlzIGlzIHVzZWQgdG9cbiAqIG1vZGlmeSBhIG5vZGUncyB0cmFuc2Zvcm0gZm9yIGFuaW1hdGlvbiBvdXRzaWRlIG9mIGdsVEYgYW5pbWF0aW9ucy5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBUaGUgZ2xURiBuYW1lIG9mIHRoZSBub2RlLlxuICogQHJldHVybnMge01vZGVsTm9kZX0gVGhlIG5vZGUgb3IgPGNvZGU+dW5kZWZpbmVkPC9jb2RlPiBpZiBubyBub2RlIHdpdGggPGNvZGU+bmFtZTwvY29kZT4gZXhpc3RzLlxuICpcbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSBUaGUgbW9kZWwgaXMgbm90IGxvYWRlZC4gIFVzZSBNb2RlbC5yZWFkeVByb21pc2Ugb3Igd2FpdCBmb3IgTW9kZWwucmVhZHkgdG8gYmUgdHJ1ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gQXBwbHkgbm9uLXVuaWZvcm0gc2NhbGUgdG8gbm9kZSBMT0Qzc3BcbiAqIHZhciBub2RlID0gbW9kZWwuZ2V0Tm9kZSgnTE9EM3NwJyk7XG4gKiBub2RlLm1hdHJpeCA9IENlc2l1bS5NYXRyaXg0LmZyb21TY2FsZShuZXcgQ2VzaXVtLkNhcnRlc2lhbjMoNS4wLCAxLjAsIDEuMCksIG5vZGUubWF0cml4KTtcbiAqL1xuTW9kZWwucHJvdG90eXBlLmdldE5vZGUgPSBmdW5jdGlvbiAobmFtZSkge1xuICB2YXIgbm9kZSA9IGdldFJ1bnRpbWUodGhpcywgXCJub2Rlc0J5TmFtZVwiLCBuYW1lKTtcbiAgcmV0dXJuIGRlZmluZWQobm9kZSkgPyBub2RlLnB1YmxpY05vZGUgOiB1bmRlZmluZWQ7XG59O1xuXG4vKipcbiAqIFJldHVybnMgdGhlIGdsVEYgbWVzaCB3aXRoIHRoZSBnaXZlbiA8Y29kZT5uYW1lPC9jb2RlPiBwcm9wZXJ0eS5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBUaGUgZ2xURiBuYW1lIG9mIHRoZSBtZXNoLlxuICpcbiAqIEByZXR1cm5zIHtNb2RlbE1lc2h9IFRoZSBtZXNoIG9yIDxjb2RlPnVuZGVmaW5lZDwvY29kZT4gaWYgbm8gbWVzaCB3aXRoIDxjb2RlPm5hbWU8L2NvZGU+IGV4aXN0cy5cbiAqXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gVGhlIG1vZGVsIGlzIG5vdCBsb2FkZWQuICBVc2UgTW9kZWwucmVhZHlQcm9taXNlIG9yIHdhaXQgZm9yIE1vZGVsLnJlYWR5IHRvIGJlIHRydWUuXG4gKi9cbk1vZGVsLnByb3RvdHlwZS5nZXRNZXNoID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgcmV0dXJuIGdldFJ1bnRpbWUodGhpcywgXCJtZXNoZXNCeU5hbWVcIiwgbmFtZSk7XG59O1xuXG4vKipcbiAqIFJldHVybnMgdGhlIGdsVEYgbWF0ZXJpYWwgd2l0aCB0aGUgZ2l2ZW4gPGNvZGU+bmFtZTwvY29kZT4gcHJvcGVydHkuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgVGhlIGdsVEYgbmFtZSBvZiB0aGUgbWF0ZXJpYWwuXG4gKiBAcmV0dXJucyB7TW9kZWxNYXRlcmlhbH0gVGhlIG1hdGVyaWFsIG9yIDxjb2RlPnVuZGVmaW5lZDwvY29kZT4gaWYgbm8gbWF0ZXJpYWwgd2l0aCA8Y29kZT5uYW1lPC9jb2RlPiBleGlzdHMuXG4gKlxuICogQGV4Y2VwdGlvbiB7RGV2ZWxvcGVyRXJyb3J9IFRoZSBtb2RlbCBpcyBub3QgbG9hZGVkLiAgVXNlIE1vZGVsLnJlYWR5UHJvbWlzZSBvciB3YWl0IGZvciBNb2RlbC5yZWFkeSB0byBiZSB0cnVlLlxuICovXG5Nb2RlbC5wcm90b3R5cGUuZ2V0TWF0ZXJpYWwgPSBmdW5jdGlvbiAobmFtZSkge1xuICByZXR1cm4gZ2V0UnVudGltZSh0aGlzLCBcIm1hdGVyaWFsc0J5TmFtZVwiLCBuYW1lKTtcbn07XG5cbi8qKlxuICogU2V0cyB0aGUgY3VycmVudCB2YWx1ZSBvZiBhbiBhcnRpY3VsYXRpb24gc3RhZ2UuICBBZnRlciBzZXR0aW5nIG9uZSBvciBtdWx0aXBsZSBzdGFnZSB2YWx1ZXMsIGNhbGxcbiAqIE1vZGVsLmFwcGx5QXJ0aWN1bGF0aW9ucygpIHRvIGNhdXNlIHRoZSBub2RlIG1hdHJpY2VzIHRvIGJlIHJlY2FsY3VsYXRlZC5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gYXJ0aWN1bGF0aW9uU3RhZ2VLZXkgVGhlIG5hbWUgb2YgdGhlIGFydGljdWxhdGlvbiwgYSBzcGFjZSwgYW5kIHRoZSBuYW1lIG9mIHRoZSBzdGFnZS5cbiAqIEBwYXJhbSB7TnVtYmVyfSB2YWx1ZSBUaGUgbnVtZXJpYyB2YWx1ZSBvZiB0aGlzIHN0YWdlIG9mIHRoZSBhcnRpY3VsYXRpb24uXG4gKlxuICogQGV4Y2VwdGlvbiB7RGV2ZWxvcGVyRXJyb3J9IFRoZSBtb2RlbCBpcyBub3QgbG9hZGVkLiAgVXNlIE1vZGVsLnJlYWR5UHJvbWlzZSBvciB3YWl0IGZvciBNb2RlbC5yZWFkeSB0byBiZSB0cnVlLlxuICpcbiAqIEBzZWUgTW9kZWwjYXBwbHlBcnRpY3VsYXRpb25zXG4gKi9cbk1vZGVsLnByb3RvdHlwZS5zZXRBcnRpY3VsYXRpb25TdGFnZSA9IGZ1bmN0aW9uIChhcnRpY3VsYXRpb25TdGFnZUtleSwgdmFsdWUpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLm51bWJlcihcInZhbHVlXCIsIHZhbHVlKTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgdmFyIHN0YWdlID0gZ2V0UnVudGltZSh0aGlzLCBcInN0YWdlc0J5S2V5XCIsIGFydGljdWxhdGlvblN0YWdlS2V5KTtcbiAgdmFyIGFydGljdWxhdGlvbiA9IGdldFJ1bnRpbWUoXG4gICAgdGhpcyxcbiAgICBcImFydGljdWxhdGlvbnNCeVN0YWdlS2V5XCIsXG4gICAgYXJ0aWN1bGF0aW9uU3RhZ2VLZXlcbiAgKTtcbiAgaWYgKGRlZmluZWQoc3RhZ2UpICYmIGRlZmluZWQoYXJ0aWN1bGF0aW9uKSkge1xuICAgIHZhbHVlID0gQ2VzaXVtTWF0aC5jbGFtcCh2YWx1ZSwgc3RhZ2UubWluaW11bVZhbHVlLCBzdGFnZS5tYXhpbXVtVmFsdWUpO1xuICAgIGlmIChcbiAgICAgICFDZXNpdW1NYXRoLmVxdWFsc0Vwc2lsb24oc3RhZ2UuY3VycmVudFZhbHVlLCB2YWx1ZSwgYXJ0aWN1bGF0aW9uRXBzaWxvbilcbiAgICApIHtcbiAgICAgIHN0YWdlLmN1cnJlbnRWYWx1ZSA9IHZhbHVlO1xuICAgICAgYXJ0aWN1bGF0aW9uLmlzRGlydHkgPSB0cnVlO1xuICAgIH1cbiAgfVxufTtcblxudmFyIHNjcmF0Y2hBcnRpY3VsYXRpb25DYXJ0ZXNpYW4gPSBuZXcgQ2FydGVzaWFuMygpO1xudmFyIHNjcmF0Y2hBcnRpY3VsYXRpb25Sb3RhdGlvbiA9IG5ldyBNYXRyaXgzKCk7XG5cbi8qKlxuICogTW9kaWZpZXMgYSBNYXRyaXg0IGJ5IGFwcGx5aW5nIGEgdHJhbnNmb3JtYXRpb24gZm9yIGEgZ2l2ZW4gdmFsdWUgb2YgYSBzdGFnZS4gIE5vdGUgdGhpcyBpcyBkaWZmZXJlbnQgdXNhZ2VcbiAqIGZyb20gdGhlIHR5cGljYWwgPGNvZGU+cmVzdWx0PC9jb2RlPiBwYXJhbWV0ZXIsIGluIHRoYXQgdGhlIGluY29taW5nIHZhbHVlIG9mIDxjb2RlPnJlc3VsdDwvY29kZT4gaXNcbiAqIG1lYW5pbmdmdWwuICBWYXJpb3VzIHN0YWdlcyBvZiBhbiBhcnRpY3VsYXRpb24gY2FuIGJlIG11bHRpcGxpZWQgdG9nZXRoZXIsIHNvIHRoZWlyXG4gKiB0cmFuc2Zvcm1hdGlvbnMgYXJlIGFsbCBtZXJnZWQgaW50byBhIGNvbXBvc2l0ZSBNYXRyaXg0IHJlcHJlc2VudGluZyB0aGVtIGFsbC5cbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gc3RhZ2UgVGhlIHN0YWdlIG9mIGFuIGFydGljdWxhdGlvbiB0aGF0IGlzIGJlaW5nIGV2YWx1YXRlZC5cbiAqIEBwYXJhbSB7TWF0cml4NH0gcmVzdWx0IFRoZSBtYXRyaXggdG8gYmUgbW9kaWZpZWQuXG4gKiBAcmV0dXJucyB7TWF0cml4NH0gQSBtYXRyaXggdHJhbnNmb3JtZWQgYXMgcmVxdWVzdGVkIGJ5IHRoZSBhcnRpY3VsYXRpb24gc3RhZ2UuXG4gKlxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gYXBwbHlBcnRpY3VsYXRpb25TdGFnZU1hdHJpeChzdGFnZSwgcmVzdWx0KSB7XG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJzdGFnZVwiLCBzdGFnZSk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJyZXN1bHRcIiwgcmVzdWx0KTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgdmFyIHZhbHVlID0gc3RhZ2UuY3VycmVudFZhbHVlO1xuICB2YXIgY2FydGVzaWFuID0gc2NyYXRjaEFydGljdWxhdGlvbkNhcnRlc2lhbjtcbiAgdmFyIHJvdGF0aW9uO1xuICBzd2l0Y2ggKHN0YWdlLnR5cGUpIHtcbiAgICBjYXNlIFwieFJvdGF0ZVwiOlxuICAgICAgcm90YXRpb24gPSBNYXRyaXgzLmZyb21Sb3RhdGlvblgoXG4gICAgICAgIENlc2l1bU1hdGgudG9SYWRpYW5zKHZhbHVlKSxcbiAgICAgICAgc2NyYXRjaEFydGljdWxhdGlvblJvdGF0aW9uXG4gICAgICApO1xuICAgICAgTWF0cml4NC5tdWx0aXBseUJ5TWF0cml4MyhyZXN1bHQsIHJvdGF0aW9uLCByZXN1bHQpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcInlSb3RhdGVcIjpcbiAgICAgIHJvdGF0aW9uID0gTWF0cml4My5mcm9tUm90YXRpb25ZKFxuICAgICAgICBDZXNpdW1NYXRoLnRvUmFkaWFucyh2YWx1ZSksXG4gICAgICAgIHNjcmF0Y2hBcnRpY3VsYXRpb25Sb3RhdGlvblxuICAgICAgKTtcbiAgICAgIE1hdHJpeDQubXVsdGlwbHlCeU1hdHJpeDMocmVzdWx0LCByb3RhdGlvbiwgcmVzdWx0KTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJ6Um90YXRlXCI6XG4gICAgICByb3RhdGlvbiA9IE1hdHJpeDMuZnJvbVJvdGF0aW9uWihcbiAgICAgICAgQ2VzaXVtTWF0aC50b1JhZGlhbnModmFsdWUpLFxuICAgICAgICBzY3JhdGNoQXJ0aWN1bGF0aW9uUm90YXRpb25cbiAgICAgICk7XG4gICAgICBNYXRyaXg0Lm11bHRpcGx5QnlNYXRyaXgzKHJlc3VsdCwgcm90YXRpb24sIHJlc3VsdCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwieFRyYW5zbGF0ZVwiOlxuICAgICAgY2FydGVzaWFuLnggPSB2YWx1ZTtcbiAgICAgIGNhcnRlc2lhbi55ID0gMC4wO1xuICAgICAgY2FydGVzaWFuLnogPSAwLjA7XG4gICAgICBNYXRyaXg0Lm11bHRpcGx5QnlUcmFuc2xhdGlvbihyZXN1bHQsIGNhcnRlc2lhbiwgcmVzdWx0KTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJ5VHJhbnNsYXRlXCI6XG4gICAgICBjYXJ0ZXNpYW4ueCA9IDAuMDtcbiAgICAgIGNhcnRlc2lhbi55ID0gdmFsdWU7XG4gICAgICBjYXJ0ZXNpYW4ueiA9IDAuMDtcbiAgICAgIE1hdHJpeDQubXVsdGlwbHlCeVRyYW5zbGF0aW9uKHJlc3VsdCwgY2FydGVzaWFuLCByZXN1bHQpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcInpUcmFuc2xhdGVcIjpcbiAgICAgIGNhcnRlc2lhbi54ID0gMC4wO1xuICAgICAgY2FydGVzaWFuLnkgPSAwLjA7XG4gICAgICBjYXJ0ZXNpYW4ueiA9IHZhbHVlO1xuICAgICAgTWF0cml4NC5tdWx0aXBseUJ5VHJhbnNsYXRpb24ocmVzdWx0LCBjYXJ0ZXNpYW4sIHJlc3VsdCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwieFNjYWxlXCI6XG4gICAgICBjYXJ0ZXNpYW4ueCA9IHZhbHVlO1xuICAgICAgY2FydGVzaWFuLnkgPSAxLjA7XG4gICAgICBjYXJ0ZXNpYW4ueiA9IDEuMDtcbiAgICAgIE1hdHJpeDQubXVsdGlwbHlCeVNjYWxlKHJlc3VsdCwgY2FydGVzaWFuLCByZXN1bHQpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcInlTY2FsZVwiOlxuICAgICAgY2FydGVzaWFuLnggPSAxLjA7XG4gICAgICBjYXJ0ZXNpYW4ueSA9IHZhbHVlO1xuICAgICAgY2FydGVzaWFuLnogPSAxLjA7XG4gICAgICBNYXRyaXg0Lm11bHRpcGx5QnlTY2FsZShyZXN1bHQsIGNhcnRlc2lhbiwgcmVzdWx0KTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJ6U2NhbGVcIjpcbiAgICAgIGNhcnRlc2lhbi54ID0gMS4wO1xuICAgICAgY2FydGVzaWFuLnkgPSAxLjA7XG4gICAgICBjYXJ0ZXNpYW4ueiA9IHZhbHVlO1xuICAgICAgTWF0cml4NC5tdWx0aXBseUJ5U2NhbGUocmVzdWx0LCBjYXJ0ZXNpYW4sIHJlc3VsdCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwidW5pZm9ybVNjYWxlXCI6XG4gICAgICBNYXRyaXg0Lm11bHRpcGx5QnlVbmlmb3JtU2NhbGUocmVzdWx0LCB2YWx1ZSwgcmVzdWx0KTtcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICBicmVhaztcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG52YXIgc2NyYXRjaEFwcGx5QXJ0aWN1bGF0aW9uVHJhbnNmb3JtID0gbmV3IE1hdHJpeDQoKTtcblxuLyoqXG4gKiBBcHBsaWVzIGFueSBtb2RpZmllZCBhcnRpY3VsYXRpb24gc3RhZ2VzIHRvIHRoZSBtYXRyaXggb2YgZWFjaCBub2RlIHRoYXQgcGFydGljaXBhdGVzXG4gKiBpbiBhbnkgYXJ0aWN1bGF0aW9uLiAgTm90ZSB0aGF0IHRoaXMgd2lsbCBvdmVyd3JpdGUgYW55IG5vZGVUcmFuc2Zvcm1hdGlvbnMgb24gcGFydGljaXBhdGluZyBub2Rlcy5cbiAqXG4gKiBAZXhjZXB0aW9uIHtEZXZlbG9wZXJFcnJvcn0gVGhlIG1vZGVsIGlzIG5vdCBsb2FkZWQuICBVc2UgTW9kZWwucmVhZHlQcm9taXNlIG9yIHdhaXQgZm9yIE1vZGVsLnJlYWR5IHRvIGJlIHRydWUuXG4gKi9cbk1vZGVsLnByb3RvdHlwZS5hcHBseUFydGljdWxhdGlvbnMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBhcnRpY3VsYXRpb25zQnlOYW1lID0gdGhpcy5fcnVudGltZS5hcnRpY3VsYXRpb25zQnlOYW1lO1xuICBmb3IgKHZhciBhcnRpY3VsYXRpb25OYW1lIGluIGFydGljdWxhdGlvbnNCeU5hbWUpIHtcbiAgICBpZiAoYXJ0aWN1bGF0aW9uc0J5TmFtZS5oYXNPd25Qcm9wZXJ0eShhcnRpY3VsYXRpb25OYW1lKSkge1xuICAgICAgdmFyIGFydGljdWxhdGlvbiA9IGFydGljdWxhdGlvbnNCeU5hbWVbYXJ0aWN1bGF0aW9uTmFtZV07XG4gICAgICBpZiAoYXJ0aWN1bGF0aW9uLmlzRGlydHkpIHtcbiAgICAgICAgYXJ0aWN1bGF0aW9uLmlzRGlydHkgPSBmYWxzZTtcbiAgICAgICAgdmFyIG51bU5vZGVzID0gYXJ0aWN1bGF0aW9uLm5vZGVzLmxlbmd0aDtcbiAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBudW1Ob2RlczsgKytuKSB7XG4gICAgICAgICAgdmFyIG5vZGUgPSBhcnRpY3VsYXRpb24ubm9kZXNbbl07XG4gICAgICAgICAgdmFyIHRyYW5zZm9ybSA9IE1hdHJpeDQuY2xvbmUoXG4gICAgICAgICAgICBub2RlLm9yaWdpbmFsTWF0cml4LFxuICAgICAgICAgICAgc2NyYXRjaEFwcGx5QXJ0aWN1bGF0aW9uVHJhbnNmb3JtXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIHZhciBudW1TdGFnZXMgPSBhcnRpY3VsYXRpb24uc3RhZ2VzLmxlbmd0aDtcbiAgICAgICAgICBmb3IgKHZhciBzID0gMDsgcyA8IG51bVN0YWdlczsgKytzKSB7XG4gICAgICAgICAgICB2YXIgc3RhZ2UgPSBhcnRpY3VsYXRpb24uc3RhZ2VzW3NdO1xuICAgICAgICAgICAgdHJhbnNmb3JtID0gYXBwbHlBcnRpY3VsYXRpb25TdGFnZU1hdHJpeChzdGFnZSwgdHJhbnNmb3JtKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbm9kZS5tYXRyaXggPSB0cmFuc2Zvcm07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5mdW5jdGlvbiBhZGRCdWZmZXJzVG9Mb2FkUmVzb3VyY2VzKG1vZGVsKSB7XG4gIHZhciBnbHRmID0gbW9kZWwuZ2x0ZjtcbiAgdmFyIGxvYWRSZXNvdXJjZXMgPSBtb2RlbC5fbG9hZFJlc291cmNlcztcbiAgRm9yRWFjaC5idWZmZXIoZ2x0ZiwgZnVuY3Rpb24gKGJ1ZmZlciwgaWQpIHtcbiAgICBsb2FkUmVzb3VyY2VzLmJ1ZmZlcnNbaWRdID0gYnVmZmVyLmV4dHJhcy5fcGlwZWxpbmUuc291cmNlO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gYnVmZmVyTG9hZChtb2RlbCwgaWQpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChhcnJheUJ1ZmZlcikge1xuICAgIHZhciBsb2FkUmVzb3VyY2VzID0gbW9kZWwuX2xvYWRSZXNvdXJjZXM7XG4gICAgdmFyIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyKTtcbiAgICAtLWxvYWRSZXNvdXJjZXMucGVuZGluZ0J1ZmZlckxvYWRzO1xuICAgIG1vZGVsLmdsdGYuYnVmZmVyc1tpZF0uZXh0cmFzLl9waXBlbGluZS5zb3VyY2UgPSBidWZmZXI7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHBhcnNlQnVmZmVyVmlld3MobW9kZWwpIHtcbiAgdmFyIGJ1ZmZlclZpZXdzID0gbW9kZWwuZ2x0Zi5idWZmZXJWaWV3cztcbiAgdmFyIHZlcnRleEJ1ZmZlcnNUb0NyZWF0ZSA9IG1vZGVsLl9sb2FkUmVzb3VyY2VzLnZlcnRleEJ1ZmZlcnNUb0NyZWF0ZTtcblxuICAvLyBPbmx5IEFSUkFZX0JVRkZFUiBoZXJlLiAgRUxFTUVOVF9BUlJBWV9CVUZGRVIgY3JlYXRlZCBiZWxvdy5cbiAgRm9yRWFjaC5idWZmZXJWaWV3KG1vZGVsLmdsdGYsIGZ1bmN0aW9uIChidWZmZXJWaWV3LCBpZCkge1xuICAgIGlmIChidWZmZXJWaWV3LnRhcmdldCA9PT0gV2ViR0xDb25zdGFudHMuQVJSQVlfQlVGRkVSKSB7XG4gICAgICB2ZXJ0ZXhCdWZmZXJzVG9DcmVhdGUuZW5xdWV1ZShpZCk7XG4gICAgfVxuICB9KTtcblxuICB2YXIgaW5kZXhCdWZmZXJzVG9DcmVhdGUgPSBtb2RlbC5fbG9hZFJlc291cmNlcy5pbmRleEJ1ZmZlcnNUb0NyZWF0ZTtcbiAgdmFyIGluZGV4QnVmZmVySWRzID0ge307XG5cbiAgLy8gVGhlIENlc2l1bSBSZW5kZXJlciByZXF1aXJlcyBrbm93aW5nIHRoZSBkYXRhdHlwZSBmb3IgYW4gaW5kZXggYnVmZmVyXG4gIC8vIGF0IGNyZWF0aW9uIHR5cGUsIHdoaWNoIGlzIG5vdCBwYXJ0IG9mIHRoZSBnbFRGIGJ1ZmZlcnZpZXcgc28gbG9vcFxuICAvLyB0aHJvdWdoIGdsVEYgYWNjZXNzb3JzIHRvIGNyZWF0ZSB0aGUgYnVmZmVydmlldydzIGluZGV4IGJ1ZmZlci5cbiAgRm9yRWFjaC5hY2Nlc3Nvcihtb2RlbC5nbHRmLCBmdW5jdGlvbiAoYWNjZXNzb3IpIHtcbiAgICB2YXIgYnVmZmVyVmlld0lkID0gYWNjZXNzb3IuYnVmZmVyVmlldztcbiAgICBpZiAoIWRlZmluZWQoYnVmZmVyVmlld0lkKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBidWZmZXJWaWV3ID0gYnVmZmVyVmlld3NbYnVmZmVyVmlld0lkXTtcbiAgICBpZiAoXG4gICAgICBidWZmZXJWaWV3LnRhcmdldCA9PT0gV2ViR0xDb25zdGFudHMuRUxFTUVOVF9BUlJBWV9CVUZGRVIgJiZcbiAgICAgICFkZWZpbmVkKGluZGV4QnVmZmVySWRzW2J1ZmZlclZpZXdJZF0pXG4gICAgKSB7XG4gICAgICBpbmRleEJ1ZmZlcklkc1tidWZmZXJWaWV3SWRdID0gdHJ1ZTtcbiAgICAgIGluZGV4QnVmZmVyc1RvQ3JlYXRlLmVucXVldWUoe1xuICAgICAgICBpZDogYnVmZmVyVmlld0lkLFxuICAgICAgICBjb21wb25lbnRUeXBlOiBhY2Nlc3Nvci5jb21wb25lbnRUeXBlLFxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gcGFyc2VUZWNobmlxdWVzKG1vZGVsKSB7XG4gIC8vIHJldGFpbiByZWZlcmVuY2VzIHRvIGdsdGYgdGVjaG5pcXVlc1xuICB2YXIgZ2x0ZiA9IG1vZGVsLmdsdGY7XG4gIGlmICghdXNlc0V4dGVuc2lvbihnbHRmLCBcIktIUl90ZWNobmlxdWVzX3dlYmdsXCIpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIHNvdXJjZVByb2dyYW1zID0gbW9kZWwuX3NvdXJjZVByb2dyYW1zO1xuICB2YXIgc291cmNlVGVjaG5pcXVlcyA9IG1vZGVsLl9zb3VyY2VUZWNobmlxdWVzO1xuICB2YXIgcHJvZ3JhbXMgPSBnbHRmLmV4dGVuc2lvbnMuS0hSX3RlY2huaXF1ZXNfd2ViZ2wucHJvZ3JhbXM7XG5cbiAgRm9yRWFjaC50ZWNobmlxdWUoZ2x0ZiwgZnVuY3Rpb24gKHRlY2huaXF1ZSwgdGVjaG5pcXVlSWQpIHtcbiAgICBzb3VyY2VUZWNobmlxdWVzW3RlY2huaXF1ZUlkXSA9IGNsb25lKHRlY2huaXF1ZSk7XG5cbiAgICB2YXIgcHJvZ3JhbUlkID0gdGVjaG5pcXVlLnByb2dyYW07XG4gICAgaWYgKCFkZWZpbmVkKHNvdXJjZVByb2dyYW1zW3Byb2dyYW1JZF0pKSB7XG4gICAgICBzb3VyY2VQcm9ncmFtc1twcm9ncmFtSWRdID0gY2xvbmUocHJvZ3JhbXNbcHJvZ3JhbUlkXSk7XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gc2hhZGVyTG9hZChtb2RlbCwgdHlwZSwgaWQpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICB2YXIgbG9hZFJlc291cmNlcyA9IG1vZGVsLl9sb2FkUmVzb3VyY2VzO1xuICAgIGxvYWRSZXNvdXJjZXMuc2hhZGVyc1tpZF0gPSB7XG4gICAgICBzb3VyY2U6IHNvdXJjZSxcbiAgICAgIHR5cGU6IHR5cGUsXG4gICAgICBidWZmZXJWaWV3OiB1bmRlZmluZWQsXG4gICAgfTtcbiAgICAtLWxvYWRSZXNvdXJjZXMucGVuZGluZ1NoYWRlckxvYWRzO1xuICAgIG1vZGVsLl9yZW5kZXJlclJlc291cmNlcy5zb3VyY2VTaGFkZXJzW2lkXSA9IHNvdXJjZTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gcGFyc2VTaGFkZXJzKG1vZGVsKSB7XG4gIHZhciBnbHRmID0gbW9kZWwuZ2x0ZjtcbiAgdmFyIGJ1ZmZlcnMgPSBnbHRmLmJ1ZmZlcnM7XG4gIHZhciBidWZmZXJWaWV3cyA9IGdsdGYuYnVmZmVyVmlld3M7XG4gIHZhciBzb3VyY2VTaGFkZXJzID0gbW9kZWwuX3JlbmRlcmVyUmVzb3VyY2VzLnNvdXJjZVNoYWRlcnM7XG4gIEZvckVhY2guc2hhZGVyKGdsdGYsIGZ1bmN0aW9uIChzaGFkZXIsIGlkKSB7XG4gICAgLy8gU2hhZGVyIHJlZmVyZW5jZXMgZWl0aGVyIHVyaSAoZXh0ZXJuYWwgb3IgYmFzZTY0LWVuY29kZWQpIG9yIGJ1ZmZlclZpZXdcbiAgICBpZiAoZGVmaW5lZChzaGFkZXIuYnVmZmVyVmlldykpIHtcbiAgICAgIHZhciBidWZmZXJWaWV3SWQgPSBzaGFkZXIuYnVmZmVyVmlldztcbiAgICAgIHZhciBidWZmZXJWaWV3ID0gYnVmZmVyVmlld3NbYnVmZmVyVmlld0lkXTtcbiAgICAgIHZhciBidWZmZXJJZCA9IGJ1ZmZlclZpZXcuYnVmZmVyO1xuICAgICAgdmFyIGJ1ZmZlciA9IGJ1ZmZlcnNbYnVmZmVySWRdO1xuICAgICAgdmFyIHNvdXJjZSA9IGdldFN0cmluZ0Zyb21UeXBlZEFycmF5KFxuICAgICAgICBidWZmZXIuZXh0cmFzLl9waXBlbGluZS5zb3VyY2UsXG4gICAgICAgIGJ1ZmZlclZpZXcuYnl0ZU9mZnNldCxcbiAgICAgICAgYnVmZmVyVmlldy5ieXRlTGVuZ3RoXG4gICAgICApO1xuICAgICAgc291cmNlU2hhZGVyc1tpZF0gPSBzb3VyY2U7XG4gICAgfSBlbHNlIGlmIChkZWZpbmVkKHNoYWRlci5leHRyYXMuX3BpcGVsaW5lLnNvdXJjZSkpIHtcbiAgICAgIHNvdXJjZVNoYWRlcnNbaWRdID0gc2hhZGVyLmV4dHJhcy5fcGlwZWxpbmUuc291cmNlO1xuICAgIH0gZWxzZSB7XG4gICAgICArK21vZGVsLl9sb2FkUmVzb3VyY2VzLnBlbmRpbmdTaGFkZXJMb2FkcztcblxuICAgICAgdmFyIHNoYWRlclJlc291cmNlID0gbW9kZWwuX3Jlc291cmNlLmdldERlcml2ZWRSZXNvdXJjZSh7XG4gICAgICAgIHVybDogc2hhZGVyLnVyaSxcbiAgICAgIH0pO1xuXG4gICAgICBzaGFkZXJSZXNvdXJjZVxuICAgICAgICAuZmV0Y2hUZXh0KClcbiAgICAgICAgLnRoZW4oc2hhZGVyTG9hZChtb2RlbCwgc2hhZGVyLnR5cGUsIGlkKSlcbiAgICAgICAgLm90aGVyd2lzZShcbiAgICAgICAgICBNb2RlbFV0aWxpdHkuZ2V0RmFpbGVkTG9hZEZ1bmN0aW9uKFxuICAgICAgICAgICAgbW9kZWwsXG4gICAgICAgICAgICBcInNoYWRlclwiLFxuICAgICAgICAgICAgc2hhZGVyUmVzb3VyY2UudXJsXG4gICAgICAgICAgKVxuICAgICAgICApO1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHBhcnNlUHJvZ3JhbXMobW9kZWwpIHtcbiAgdmFyIHNvdXJjZVRlY2huaXF1ZXMgPSBtb2RlbC5fc291cmNlVGVjaG5pcXVlcztcbiAgZm9yICh2YXIgdGVjaG5pcXVlSWQgaW4gc291cmNlVGVjaG5pcXVlcykge1xuICAgIGlmIChzb3VyY2VUZWNobmlxdWVzLmhhc093blByb3BlcnR5KHRlY2huaXF1ZUlkKSkge1xuICAgICAgdmFyIHRlY2huaXF1ZSA9IHNvdXJjZVRlY2huaXF1ZXNbdGVjaG5pcXVlSWRdO1xuICAgICAgbW9kZWwuX2xvYWRSZXNvdXJjZXMucHJvZ3JhbXNUb0NyZWF0ZS5lbnF1ZXVlKHtcbiAgICAgICAgcHJvZ3JhbUlkOiB0ZWNobmlxdWUucHJvZ3JhbSxcbiAgICAgICAgdGVjaG5pcXVlSWQ6IHRlY2huaXF1ZUlkLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHBhcnNlQXJ0aWN1bGF0aW9ucyhtb2RlbCkge1xuICB2YXIgYXJ0aWN1bGF0aW9uc0J5TmFtZSA9IHt9O1xuICB2YXIgYXJ0aWN1bGF0aW9uc0J5U3RhZ2VLZXkgPSB7fTtcbiAgdmFyIHJ1bnRpbWVTdGFnZXNCeUtleSA9IHt9O1xuXG4gIG1vZGVsLl9ydW50aW1lLmFydGljdWxhdGlvbnNCeU5hbWUgPSBhcnRpY3VsYXRpb25zQnlOYW1lO1xuICBtb2RlbC5fcnVudGltZS5hcnRpY3VsYXRpb25zQnlTdGFnZUtleSA9IGFydGljdWxhdGlvbnNCeVN0YWdlS2V5O1xuICBtb2RlbC5fcnVudGltZS5zdGFnZXNCeUtleSA9IHJ1bnRpbWVTdGFnZXNCeUtleTtcblxuICB2YXIgZ2x0ZiA9IG1vZGVsLmdsdGY7XG4gIGlmIChcbiAgICAhdXNlc0V4dGVuc2lvbihnbHRmLCBcIkFHSV9hcnRpY3VsYXRpb25zXCIpIHx8XG4gICAgIWRlZmluZWQoZ2x0Zi5leHRlbnNpb25zKSB8fFxuICAgICFkZWZpbmVkKGdsdGYuZXh0ZW5zaW9ucy5BR0lfYXJ0aWN1bGF0aW9ucylcbiAgKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGdsdGZBcnRpY3VsYXRpb25zID0gZ2x0Zi5leHRlbnNpb25zLkFHSV9hcnRpY3VsYXRpb25zLmFydGljdWxhdGlvbnM7XG4gIGlmICghZGVmaW5lZChnbHRmQXJ0aWN1bGF0aW9ucykpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgbnVtQXJ0aWN1bGF0aW9ucyA9IGdsdGZBcnRpY3VsYXRpb25zLmxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1BcnRpY3VsYXRpb25zOyArK2kpIHtcbiAgICB2YXIgYXJ0aWN1bGF0aW9uID0gY2xvbmUoZ2x0ZkFydGljdWxhdGlvbnNbaV0pO1xuICAgIGFydGljdWxhdGlvbi5ub2RlcyA9IFtdO1xuICAgIGFydGljdWxhdGlvbi5pc0RpcnR5ID0gdHJ1ZTtcbiAgICBhcnRpY3VsYXRpb25zQnlOYW1lW2FydGljdWxhdGlvbi5uYW1lXSA9IGFydGljdWxhdGlvbjtcblxuICAgIHZhciBudW1TdGFnZXMgPSBhcnRpY3VsYXRpb24uc3RhZ2VzLmxlbmd0aDtcbiAgICBmb3IgKHZhciBzID0gMDsgcyA8IG51bVN0YWdlczsgKytzKSB7XG4gICAgICB2YXIgc3RhZ2UgPSBhcnRpY3VsYXRpb24uc3RhZ2VzW3NdO1xuICAgICAgc3RhZ2UuY3VycmVudFZhbHVlID0gc3RhZ2UuaW5pdGlhbFZhbHVlO1xuXG4gICAgICB2YXIgc3RhZ2VLZXkgPSBhcnRpY3VsYXRpb24ubmFtZSArIFwiIFwiICsgc3RhZ2UubmFtZTtcbiAgICAgIGFydGljdWxhdGlvbnNCeVN0YWdlS2V5W3N0YWdlS2V5XSA9IGFydGljdWxhdGlvbjtcbiAgICAgIHJ1bnRpbWVTdGFnZXNCeUtleVtzdGFnZUtleV0gPSBzdGFnZTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gaW1hZ2VMb2FkKG1vZGVsLCB0ZXh0dXJlSWQpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChpbWFnZSkge1xuICAgIHZhciBsb2FkUmVzb3VyY2VzID0gbW9kZWwuX2xvYWRSZXNvdXJjZXM7XG4gICAgLS1sb2FkUmVzb3VyY2VzLnBlbmRpbmdUZXh0dXJlTG9hZHM7XG5cbiAgICAvLyBJbWFnZXMgdHJhbnNjb2RlZCBmcm9tIEtUWDIgY2FuIGNvbnRhaW4gbXVsdGlwbGUgbWlwIGxldmVsczpcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vS2hyb25vc0dyb3VwL2dsVEYvdHJlZS9tYXN0ZXIvZXh0ZW5zaW9ucy8yLjAvS2hyb25vcy9LSFJfdGV4dHVyZV9iYXNpc3VcbiAgICB2YXIgbWlwTGV2ZWxzO1xuICAgIGlmIChBcnJheS5pc0FycmF5KGltYWdlKSkge1xuICAgICAgLy8gaGlnaGVzdCBkZXRhaWwgbWlwIHNob3VsZCBiZSBsZXZlbCAwXG4gICAgICBtaXBMZXZlbHMgPSBpbWFnZS5zbGljZSgxLCBpbWFnZS5sZW5ndGgpLm1hcChmdW5jdGlvbiAobWlwTGV2ZWwpIHtcbiAgICAgICAgcmV0dXJuIG1pcExldmVsLmJ1ZmZlclZpZXc7XG4gICAgICB9KTtcbiAgICAgIGltYWdlID0gaW1hZ2VbMF07XG4gICAgfVxuXG4gICAgbG9hZFJlc291cmNlcy50ZXh0dXJlc1RvQ3JlYXRlLmVucXVldWUoe1xuICAgICAgaWQ6IHRleHR1cmVJZCxcbiAgICAgIGltYWdlOiBpbWFnZSxcbiAgICAgIGJ1ZmZlclZpZXc6IGltYWdlLmJ1ZmZlclZpZXcsXG4gICAgICB3aWR0aDogaW1hZ2Uud2lkdGgsXG4gICAgICBoZWlnaHQ6IGltYWdlLmhlaWdodCxcbiAgICAgIGludGVybmFsRm9ybWF0OiBpbWFnZS5pbnRlcm5hbEZvcm1hdCxcbiAgICAgIG1pcExldmVsczogbWlwTGV2ZWxzLFxuICAgIH0pO1xuICB9O1xufVxuXG52YXIga3R4MlJlZ2V4ID0gLyheZGF0YTppbWFnZVxcL2t0eDIpfChcXC5rdHgyJCkvaTtcblxuZnVuY3Rpb24gcGFyc2VUZXh0dXJlcyhtb2RlbCwgY29udGV4dCwgc3VwcG9ydHNXZWJQKSB7XG4gIHZhciBnbHRmID0gbW9kZWwuZ2x0ZjtcbiAgdmFyIGltYWdlcyA9IGdsdGYuaW1hZ2VzO1xuICB2YXIgdXJpO1xuICBGb3JFYWNoLnRleHR1cmUoZ2x0ZiwgZnVuY3Rpb24gKHRleHR1cmUsIGlkKSB7XG4gICAgdmFyIGltYWdlSWQgPSB0ZXh0dXJlLnNvdXJjZTtcblxuICAgIGlmIChcbiAgICAgIGRlZmluZWQodGV4dHVyZS5leHRlbnNpb25zKSAmJlxuICAgICAgZGVmaW5lZCh0ZXh0dXJlLmV4dGVuc2lvbnMuRVhUX3RleHR1cmVfd2VicCkgJiZcbiAgICAgIHN1cHBvcnRzV2ViUFxuICAgICkge1xuICAgICAgaW1hZ2VJZCA9IHRleHR1cmUuZXh0ZW5zaW9ucy5FWFRfdGV4dHVyZV93ZWJwLnNvdXJjZTtcbiAgICB9IGVsc2UgaWYgKFxuICAgICAgZGVmaW5lZCh0ZXh0dXJlLmV4dGVuc2lvbnMpICYmXG4gICAgICBkZWZpbmVkKHRleHR1cmUuZXh0ZW5zaW9ucy5LSFJfdGV4dHVyZV9iYXNpc3UpICYmXG4gICAgICBjb250ZXh0LnN1cHBvcnRzQmFzaXNcbiAgICApIHtcbiAgICAgIGltYWdlSWQgPSB0ZXh0dXJlLmV4dGVuc2lvbnMuS0hSX3RleHR1cmVfYmFzaXN1LnNvdXJjZTtcbiAgICB9XG5cbiAgICB2YXIgZ2x0ZkltYWdlID0gaW1hZ2VzW2ltYWdlSWRdO1xuXG4gICAgdmFyIGJ1ZmZlclZpZXdJZCA9IGdsdGZJbWFnZS5idWZmZXJWaWV3O1xuICAgIHZhciBtaW1lVHlwZSA9IGdsdGZJbWFnZS5taW1lVHlwZTtcbiAgICB1cmkgPSBnbHRmSW1hZ2UudXJpO1xuXG4gICAgLy8gSW1hZ2UgcmVmZXJlbmNlcyBlaXRoZXIgdXJpIChleHRlcm5hbCBvciBiYXNlNjQtZW5jb2RlZCkgb3IgYnVmZmVyVmlld1xuICAgIGlmIChkZWZpbmVkKGJ1ZmZlclZpZXdJZCkpIHtcbiAgICAgIG1vZGVsLl9sb2FkUmVzb3VyY2VzLnRleHR1cmVzVG9DcmVhdGVGcm9tQnVmZmVyVmlldy5lbnF1ZXVlKHtcbiAgICAgICAgaWQ6IGlkLFxuICAgICAgICBpbWFnZTogdW5kZWZpbmVkLFxuICAgICAgICBidWZmZXJWaWV3OiBidWZmZXJWaWV3SWQsXG4gICAgICAgIG1pbWVUeXBlOiBtaW1lVHlwZSxcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICArK21vZGVsLl9sb2FkUmVzb3VyY2VzLnBlbmRpbmdUZXh0dXJlTG9hZHM7XG5cbiAgICAgIHZhciBpbWFnZVJlc291cmNlID0gbW9kZWwuX3Jlc291cmNlLmdldERlcml2ZWRSZXNvdXJjZSh7XG4gICAgICAgIHVybDogdXJpLFxuICAgICAgfSk7XG5cbiAgICAgIHZhciBwcm9taXNlO1xuICAgICAgaWYgKGt0eDJSZWdleC50ZXN0KHVyaSkpIHtcbiAgICAgICAgcHJvbWlzZSA9IGxvYWRLVFgyKGltYWdlUmVzb3VyY2UpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcHJvbWlzZSA9IGltYWdlUmVzb3VyY2UuZmV0Y2hJbWFnZSh7XG4gICAgICAgICAgc2tpcENvbG9yU3BhY2VDb252ZXJzaW9uOiB0cnVlLFxuICAgICAgICAgIHByZWZlckltYWdlQml0bWFwOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHByb21pc2VcbiAgICAgICAgLnRoZW4oaW1hZ2VMb2FkKG1vZGVsLCBpZCwgaW1hZ2VJZCkpXG4gICAgICAgIC5vdGhlcndpc2UoXG4gICAgICAgICAgTW9kZWxVdGlsaXR5LmdldEZhaWxlZExvYWRGdW5jdGlvbihtb2RlbCwgXCJpbWFnZVwiLCBpbWFnZVJlc291cmNlLnVybClcbiAgICAgICAgKTtcbiAgICB9XG4gIH0pO1xufVxuXG52YXIgc2NyYXRjaEFydGljdWxhdGlvblN0YWdlSW5pdGlhbFRyYW5zZm9ybSA9IG5ldyBNYXRyaXg0KCk7XG5cbmZ1bmN0aW9uIHBhcnNlTm9kZXMobW9kZWwpIHtcbiAgdmFyIHJ1bnRpbWVOb2RlcyA9IHt9O1xuICB2YXIgcnVudGltZU5vZGVzQnlOYW1lID0ge307XG4gIHZhciBza2lubmVkTm9kZXMgPSBbXTtcblxuICB2YXIgc2tpbm5lZE5vZGVzSWRzID0gbW9kZWwuX2xvYWRSZXNvdXJjZXMuc2tpbm5lZE5vZGVzSWRzO1xuICB2YXIgYXJ0aWN1bGF0aW9uc0J5TmFtZSA9IG1vZGVsLl9ydW50aW1lLmFydGljdWxhdGlvbnNCeU5hbWU7XG5cbiAgRm9yRWFjaC5ub2RlKG1vZGVsLmdsdGYsIGZ1bmN0aW9uIChub2RlLCBpZCkge1xuICAgIHZhciBydW50aW1lTm9kZSA9IHtcbiAgICAgIC8vIEFuaW1hdGlvbiB0YXJnZXRzXG4gICAgICBtYXRyaXg6IHVuZGVmaW5lZCxcbiAgICAgIHRyYW5zbGF0aW9uOiB1bmRlZmluZWQsXG4gICAgICByb3RhdGlvbjogdW5kZWZpbmVkLFxuICAgICAgc2NhbGU6IHVuZGVmaW5lZCxcblxuICAgICAgLy8gUGVyLW5vZGUgc2hvdyBpbmhlcml0ZWQgZnJvbSBwYXJlbnRcbiAgICAgIGNvbXB1dGVkU2hvdzogdHJ1ZSxcblxuICAgICAgLy8gQ29tcHV0ZWQgdHJhbnNmb3Jtc1xuICAgICAgdHJhbnNmb3JtVG9Sb290OiBuZXcgTWF0cml4NCgpLFxuICAgICAgY29tcHV0ZWRNYXRyaXg6IG5ldyBNYXRyaXg0KCksXG4gICAgICBkaXJ0eU51bWJlcjogMCwgLy8gVGhlIGZyYW1lIHRoaXMgbm9kZSB3YXMgbWFkZSBkaXJ0eSBieSBhbiBhbmltYXRpb247IGZvciBncmFwaCB0cmF2ZXJzYWxcblxuICAgICAgLy8gUmVuZGVyaW5nXG4gICAgICBjb21tYW5kczogW10sIC8vIGVtcHR5IGZvciB0cmFuc2Zvcm0sIGxpZ2h0LCBhbmQgY2FtZXJhIG5vZGVzXG5cbiAgICAgIC8vIFNraW5uZWQgbm9kZVxuICAgICAgaW52ZXJzZUJpbmRNYXRyaWNlczogdW5kZWZpbmVkLCAvLyB1bmRlZmluZWQgd2hlbiBub2RlIGlzIG5vdCBza2lubmVkXG4gICAgICBiaW5kU2hhcGVNYXRyaXg6IHVuZGVmaW5lZCwgLy8gdW5kZWZpbmVkIHdoZW4gbm9kZSBpcyBub3Qgc2tpbm5lZCBvciBpZGVudGl0eVxuICAgICAgam9pbnRzOiBbXSwgLy8gZW1wdHkgd2hlbiBub2RlIGlzIG5vdCBza2lubmVkXG4gICAgICBjb21wdXRlZEpvaW50TWF0cmljZXM6IFtdLCAvLyBlbXB0eSB3aGVuIG5vZGUgaXMgbm90IHNraW5uZWRcblxuICAgICAgLy8gSm9pbnQgbm9kZVxuICAgICAgam9pbnROYW1lOiBub2RlLmpvaW50TmFtZSwgLy8gdW5kZWZpbmVkIHdoZW4gbm9kZSBpcyBub3QgYSBqb2ludFxuXG4gICAgICB3ZWlnaHRzOiBbXSxcblxuICAgICAgLy8gR3JhcGggcG9pbnRlcnNcbiAgICAgIGNoaWxkcmVuOiBbXSwgLy8gZW1wdHkgZm9yIGxlYWYgbm9kZXNcbiAgICAgIHBhcmVudHM6IFtdLCAvLyBlbXB0eSBmb3Igcm9vdCBub2Rlc1xuXG4gICAgICAvLyBQdWJsaWNseS1hY2Nlc3NpYmxlIE1vZGVsTm9kZSBpbnN0YW5jZSB0byBtb2RpZnkgYW5pbWF0aW9uIHRhcmdldHNcbiAgICAgIHB1YmxpY05vZGU6IHVuZGVmaW5lZCxcbiAgICB9O1xuICAgIHJ1bnRpbWVOb2RlLnB1YmxpY05vZGUgPSBuZXcgTW9kZWxOb2RlKFxuICAgICAgbW9kZWwsXG4gICAgICBub2RlLFxuICAgICAgcnVudGltZU5vZGUsXG4gICAgICBpZCxcbiAgICAgIE1vZGVsVXRpbGl0eS5nZXRUcmFuc2Zvcm0obm9kZSlcbiAgICApO1xuXG4gICAgcnVudGltZU5vZGVzW2lkXSA9IHJ1bnRpbWVOb2RlO1xuICAgIHJ1bnRpbWVOb2Rlc0J5TmFtZVtub2RlLm5hbWVdID0gcnVudGltZU5vZGU7XG5cbiAgICBpZiAoZGVmaW5lZChub2RlLnNraW4pKSB7XG4gICAgICBza2lubmVkTm9kZXNJZHMucHVzaChpZCk7XG4gICAgICBza2lubmVkTm9kZXMucHVzaChydW50aW1lTm9kZSk7XG4gICAgfVxuXG4gICAgaWYgKFxuICAgICAgZGVmaW5lZChub2RlLmV4dGVuc2lvbnMpICYmXG4gICAgICBkZWZpbmVkKG5vZGUuZXh0ZW5zaW9ucy5BR0lfYXJ0aWN1bGF0aW9ucylcbiAgICApIHtcbiAgICAgIHZhciBhcnRpY3VsYXRpb25OYW1lID0gbm9kZS5leHRlbnNpb25zLkFHSV9hcnRpY3VsYXRpb25zLmFydGljdWxhdGlvbk5hbWU7XG4gICAgICBpZiAoZGVmaW5lZChhcnRpY3VsYXRpb25OYW1lKSkge1xuICAgICAgICB2YXIgdHJhbnNmb3JtID0gTWF0cml4NC5jbG9uZShcbiAgICAgICAgICBydW50aW1lTm9kZS5wdWJsaWNOb2RlLm9yaWdpbmFsTWF0cml4LFxuICAgICAgICAgIHNjcmF0Y2hBcnRpY3VsYXRpb25TdGFnZUluaXRpYWxUcmFuc2Zvcm1cbiAgICAgICAgKTtcbiAgICAgICAgdmFyIGFydGljdWxhdGlvbiA9IGFydGljdWxhdGlvbnNCeU5hbWVbYXJ0aWN1bGF0aW9uTmFtZV07XG4gICAgICAgIGFydGljdWxhdGlvbi5ub2Rlcy5wdXNoKHJ1bnRpbWVOb2RlLnB1YmxpY05vZGUpO1xuXG4gICAgICAgIHZhciBudW1TdGFnZXMgPSBhcnRpY3VsYXRpb24uc3RhZ2VzLmxlbmd0aDtcbiAgICAgICAgZm9yICh2YXIgcyA9IDA7IHMgPCBudW1TdGFnZXM7ICsrcykge1xuICAgICAgICAgIHZhciBzdGFnZSA9IGFydGljdWxhdGlvbi5zdGFnZXNbc107XG4gICAgICAgICAgdHJhbnNmb3JtID0gYXBwbHlBcnRpY3VsYXRpb25TdGFnZU1hdHJpeChzdGFnZSwgdHJhbnNmb3JtKTtcbiAgICAgICAgfVxuICAgICAgICBydW50aW1lTm9kZS5wdWJsaWNOb2RlLm1hdHJpeCA9IHRyYW5zZm9ybTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIG1vZGVsLl9ydW50aW1lLm5vZGVzID0gcnVudGltZU5vZGVzO1xuICBtb2RlbC5fcnVudGltZS5ub2Rlc0J5TmFtZSA9IHJ1bnRpbWVOb2Rlc0J5TmFtZTtcbiAgbW9kZWwuX3J1bnRpbWUuc2tpbm5lZE5vZGVzID0gc2tpbm5lZE5vZGVzO1xufVxuXG5mdW5jdGlvbiBwYXJzZU1hdGVyaWFscyhtb2RlbCkge1xuICB2YXIgZ2x0ZiA9IG1vZGVsLmdsdGY7XG4gIHZhciB0ZWNobmlxdWVzID0gbW9kZWwuX3NvdXJjZVRlY2huaXF1ZXM7XG5cbiAgdmFyIHJ1bnRpbWVNYXRlcmlhbHNCeU5hbWUgPSB7fTtcbiAgdmFyIHJ1bnRpbWVNYXRlcmlhbHNCeUlkID0ge307XG4gIHZhciB1bmlmb3JtTWFwcyA9IG1vZGVsLl91bmlmb3JtTWFwcztcblxuICBGb3JFYWNoLm1hdGVyaWFsKGdsdGYsIGZ1bmN0aW9uIChtYXRlcmlhbCwgbWF0ZXJpYWxJZCkge1xuICAgIC8vIEFsbG9jYXRlZCBub3cgc28gTW9kZWxNYXRlcmlhbCBjYW4ga2VlcCBhIHJlZmVyZW5jZSB0byBpdC5cbiAgICB1bmlmb3JtTWFwc1ttYXRlcmlhbElkXSA9IHtcbiAgICAgIHVuaWZvcm1NYXA6IHVuZGVmaW5lZCxcbiAgICAgIHZhbHVlczogdW5kZWZpbmVkLFxuICAgICAgam9pbnRNYXRyaXhVbmlmb3JtTmFtZTogdW5kZWZpbmVkLFxuICAgICAgbW9ycGhXZWlnaHRzVW5pZm9ybU5hbWU6IHVuZGVmaW5lZCxcbiAgICB9O1xuXG4gICAgdmFyIG1vZGVsTWF0ZXJpYWwgPSBuZXcgTW9kZWxNYXRlcmlhbChtb2RlbCwgbWF0ZXJpYWwsIG1hdGVyaWFsSWQpO1xuXG4gICAgaWYgKFxuICAgICAgZGVmaW5lZChtYXRlcmlhbC5leHRlbnNpb25zKSAmJlxuICAgICAgZGVmaW5lZChtYXRlcmlhbC5leHRlbnNpb25zLktIUl90ZWNobmlxdWVzX3dlYmdsKVxuICAgICkge1xuICAgICAgdmFyIHRlY2huaXF1ZUlkID0gbWF0ZXJpYWwuZXh0ZW5zaW9ucy5LSFJfdGVjaG5pcXVlc193ZWJnbC50ZWNobmlxdWU7XG4gICAgICBtb2RlbE1hdGVyaWFsLl90ZWNobmlxdWUgPSB0ZWNobmlxdWVJZDtcbiAgICAgIG1vZGVsTWF0ZXJpYWwuX3Byb2dyYW0gPSB0ZWNobmlxdWVzW3RlY2huaXF1ZUlkXS5wcm9ncmFtO1xuXG4gICAgICBGb3JFYWNoLm1hdGVyaWFsVmFsdWUobWF0ZXJpYWwsIGZ1bmN0aW9uICh2YWx1ZSwgdW5pZm9ybU5hbWUpIHtcbiAgICAgICAgaWYgKCFkZWZpbmVkKG1vZGVsTWF0ZXJpYWwuX3ZhbHVlcykpIHtcbiAgICAgICAgICBtb2RlbE1hdGVyaWFsLl92YWx1ZXMgPSB7fTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1vZGVsTWF0ZXJpYWwuX3ZhbHVlc1t1bmlmb3JtTmFtZV0gPSBjbG9uZSh2YWx1ZSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBydW50aW1lTWF0ZXJpYWxzQnlOYW1lW21hdGVyaWFsLm5hbWVdID0gbW9kZWxNYXRlcmlhbDtcbiAgICBydW50aW1lTWF0ZXJpYWxzQnlJZFttYXRlcmlhbElkXSA9IG1vZGVsTWF0ZXJpYWw7XG4gIH0pO1xuXG4gIG1vZGVsLl9ydW50aW1lLm1hdGVyaWFsc0J5TmFtZSA9IHJ1bnRpbWVNYXRlcmlhbHNCeU5hbWU7XG4gIG1vZGVsLl9ydW50aW1lLm1hdGVyaWFsc0J5SWQgPSBydW50aW1lTWF0ZXJpYWxzQnlJZDtcbn1cblxuZnVuY3Rpb24gcGFyc2VNZXNoZXMobW9kZWwpIHtcbiAgdmFyIHJ1bnRpbWVNZXNoZXNCeU5hbWUgPSB7fTtcbiAgdmFyIHJ1bnRpbWVNYXRlcmlhbHNCeUlkID0gbW9kZWwuX3J1bnRpbWUubWF0ZXJpYWxzQnlJZDtcblxuICBGb3JFYWNoLm1lc2gobW9kZWwuZ2x0ZiwgZnVuY3Rpb24gKG1lc2gsIG1lc2hJZCkge1xuICAgIHJ1bnRpbWVNZXNoZXNCeU5hbWVbbWVzaC5uYW1lXSA9IG5ldyBNb2RlbE1lc2goXG4gICAgICBtZXNoLFxuICAgICAgcnVudGltZU1hdGVyaWFsc0J5SWQsXG4gICAgICBtZXNoSWRcbiAgICApO1xuICAgIGlmIChcbiAgICAgIGRlZmluZWQobW9kZWwuZXh0ZW5zaW9uc1VzZWQuV0VCM0RfcXVhbnRpemVkX2F0dHJpYnV0ZXMpIHx8XG4gICAgICBtb2RlbC5fZGVxdWFudGl6ZUluU2hhZGVyXG4gICAgKSB7XG4gICAgICAvLyBDYWNoZSBwcmltaXRpdmVzIGFjY29yZGluZyB0byB0aGVpciBwcm9ncmFtXG4gICAgICBGb3JFYWNoLm1lc2hQcmltaXRpdmUobWVzaCwgZnVuY3Rpb24gKHByaW1pdGl2ZSwgcHJpbWl0aXZlSWQpIHtcbiAgICAgICAgdmFyIHByb2dyYW1JZCA9IGdldFByb2dyYW1Gb3JQcmltaXRpdmUobW9kZWwsIHByaW1pdGl2ZSk7XG4gICAgICAgIHZhciBwcm9ncmFtUHJpbWl0aXZlcyA9IG1vZGVsLl9wcm9ncmFtUHJpbWl0aXZlc1twcm9ncmFtSWRdO1xuICAgICAgICBpZiAoIWRlZmluZWQocHJvZ3JhbVByaW1pdGl2ZXMpKSB7XG4gICAgICAgICAgcHJvZ3JhbVByaW1pdGl2ZXMgPSB7fTtcbiAgICAgICAgICBtb2RlbC5fcHJvZ3JhbVByaW1pdGl2ZXNbcHJvZ3JhbUlkXSA9IHByb2dyYW1QcmltaXRpdmVzO1xuICAgICAgICB9XG4gICAgICAgIHByb2dyYW1QcmltaXRpdmVzW21lc2hJZCArIFwiLnByaW1pdGl2ZS5cIiArIHByaW1pdGl2ZUlkXSA9IHByaW1pdGl2ZTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgbW9kZWwuX3J1bnRpbWUubWVzaGVzQnlOYW1lID0gcnVudGltZU1lc2hlc0J5TmFtZTtcbn1cblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbnZhciBDcmVhdGVWZXJ0ZXhCdWZmZXJKb2IgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuaWQgPSB1bmRlZmluZWQ7XG4gIHRoaXMubW9kZWwgPSB1bmRlZmluZWQ7XG4gIHRoaXMuY29udGV4dCA9IHVuZGVmaW5lZDtcbn07XG5cbkNyZWF0ZVZlcnRleEJ1ZmZlckpvYi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKGlkLCBtb2RlbCwgY29udGV4dCkge1xuICB0aGlzLmlkID0gaWQ7XG4gIHRoaXMubW9kZWwgPSBtb2RlbDtcbiAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbn07XG5cbkNyZWF0ZVZlcnRleEJ1ZmZlckpvYi5wcm90b3R5cGUuZXhlY3V0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgY3JlYXRlVmVydGV4QnVmZmVyKHRoaXMuaWQsIHRoaXMubW9kZWwsIHRoaXMuY29udGV4dCk7XG59O1xuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuZnVuY3Rpb24gY3JlYXRlVmVydGV4QnVmZmVyKGJ1ZmZlclZpZXdJZCwgbW9kZWwsIGNvbnRleHQpIHtcbiAgdmFyIGxvYWRSZXNvdXJjZXMgPSBtb2RlbC5fbG9hZFJlc291cmNlcztcbiAgdmFyIGJ1ZmZlclZpZXdzID0gbW9kZWwuZ2x0Zi5idWZmZXJWaWV3cztcbiAgdmFyIGJ1ZmZlclZpZXcgPSBidWZmZXJWaWV3c1tidWZmZXJWaWV3SWRdO1xuXG4gIC8vIFVzZSBidWZmZXJWaWV3IGNyZWF0ZWQgYXQgcnVudGltZVxuICBpZiAoIWRlZmluZWQoYnVmZmVyVmlldykpIHtcbiAgICBidWZmZXJWaWV3ID0gbG9hZFJlc291cmNlcy5jcmVhdGVkQnVmZmVyVmlld3NbYnVmZmVyVmlld0lkXTtcbiAgfVxuXG4gIHZhciB2ZXJ0ZXhCdWZmZXIgPSBCdWZmZXIuY3JlYXRlVmVydGV4QnVmZmVyKHtcbiAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgIHR5cGVkQXJyYXk6IGxvYWRSZXNvdXJjZXMuZ2V0QnVmZmVyKGJ1ZmZlclZpZXcpLFxuICAgIHVzYWdlOiBCdWZmZXJVc2FnZS5TVEFUSUNfRFJBVyxcbiAgfSk7XG4gIHZlcnRleEJ1ZmZlci52ZXJ0ZXhBcnJheURlc3Ryb3lhYmxlID0gZmFsc2U7XG4gIG1vZGVsLl9yZW5kZXJlclJlc291cmNlcy5idWZmZXJzW2J1ZmZlclZpZXdJZF0gPSB2ZXJ0ZXhCdWZmZXI7XG4gIG1vZGVsLl9nZW9tZXRyeUJ5dGVMZW5ndGggKz0gdmVydGV4QnVmZmVyLnNpemVJbkJ5dGVzO1xufVxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxudmFyIENyZWF0ZUluZGV4QnVmZmVySm9iID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLmlkID0gdW5kZWZpbmVkO1xuICB0aGlzLmNvbXBvbmVudFR5cGUgPSB1bmRlZmluZWQ7XG4gIHRoaXMubW9kZWwgPSB1bmRlZmluZWQ7XG4gIHRoaXMuY29udGV4dCA9IHVuZGVmaW5lZDtcbn07XG5cbkNyZWF0ZUluZGV4QnVmZmVySm9iLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoXG4gIGlkLFxuICBjb21wb25lbnRUeXBlLFxuICBtb2RlbCxcbiAgY29udGV4dFxuKSB7XG4gIHRoaXMuaWQgPSBpZDtcbiAgdGhpcy5jb21wb25lbnRUeXBlID0gY29tcG9uZW50VHlwZTtcbiAgdGhpcy5tb2RlbCA9IG1vZGVsO1xuICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xufTtcblxuQ3JlYXRlSW5kZXhCdWZmZXJKb2IucHJvdG90eXBlLmV4ZWN1dGUgPSBmdW5jdGlvbiAoKSB7XG4gIGNyZWF0ZUluZGV4QnVmZmVyKHRoaXMuaWQsIHRoaXMuY29tcG9uZW50VHlwZSwgdGhpcy5tb2RlbCwgdGhpcy5jb250ZXh0KTtcbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5mdW5jdGlvbiBjcmVhdGVJbmRleEJ1ZmZlcihidWZmZXJWaWV3SWQsIGNvbXBvbmVudFR5cGUsIG1vZGVsLCBjb250ZXh0KSB7XG4gIHZhciBsb2FkUmVzb3VyY2VzID0gbW9kZWwuX2xvYWRSZXNvdXJjZXM7XG4gIHZhciBidWZmZXJWaWV3cyA9IG1vZGVsLmdsdGYuYnVmZmVyVmlld3M7XG4gIHZhciBidWZmZXJWaWV3ID0gYnVmZmVyVmlld3NbYnVmZmVyVmlld0lkXTtcblxuICAvLyBVc2UgYnVmZmVyVmlldyBjcmVhdGVkIGF0IHJ1bnRpbWVcbiAgaWYgKCFkZWZpbmVkKGJ1ZmZlclZpZXcpKSB7XG4gICAgYnVmZmVyVmlldyA9IGxvYWRSZXNvdXJjZXMuY3JlYXRlZEJ1ZmZlclZpZXdzW2J1ZmZlclZpZXdJZF07XG4gIH1cblxuICB2YXIgaW5kZXhCdWZmZXIgPSBCdWZmZXIuY3JlYXRlSW5kZXhCdWZmZXIoe1xuICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgdHlwZWRBcnJheTogbG9hZFJlc291cmNlcy5nZXRCdWZmZXIoYnVmZmVyVmlldyksXG4gICAgdXNhZ2U6IEJ1ZmZlclVzYWdlLlNUQVRJQ19EUkFXLFxuICAgIGluZGV4RGF0YXR5cGU6IGNvbXBvbmVudFR5cGUsXG4gIH0pO1xuICBpbmRleEJ1ZmZlci52ZXJ0ZXhBcnJheURlc3Ryb3lhYmxlID0gZmFsc2U7XG4gIG1vZGVsLl9yZW5kZXJlclJlc291cmNlcy5idWZmZXJzW2J1ZmZlclZpZXdJZF0gPSBpbmRleEJ1ZmZlcjtcbiAgbW9kZWwuX2dlb21ldHJ5Qnl0ZUxlbmd0aCArPSBpbmRleEJ1ZmZlci5zaXplSW5CeXRlcztcbn1cblxudmFyIHNjcmF0Y2hWZXJ0ZXhCdWZmZXJKb2IgPSBuZXcgQ3JlYXRlVmVydGV4QnVmZmVySm9iKCk7XG52YXIgc2NyYXRjaEluZGV4QnVmZmVySm9iID0gbmV3IENyZWF0ZUluZGV4QnVmZmVySm9iKCk7XG5cbmZ1bmN0aW9uIGNyZWF0ZUJ1ZmZlcnMobW9kZWwsIGZyYW1lU3RhdGUpIHtcbiAgdmFyIGxvYWRSZXNvdXJjZXMgPSBtb2RlbC5fbG9hZFJlc291cmNlcztcblxuICBpZiAobG9hZFJlc291cmNlcy5wZW5kaW5nQnVmZmVyTG9hZHMgIT09IDApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgY29udGV4dCA9IGZyYW1lU3RhdGUuY29udGV4dDtcbiAgdmFyIHZlcnRleEJ1ZmZlcnNUb0NyZWF0ZSA9IGxvYWRSZXNvdXJjZXMudmVydGV4QnVmZmVyc1RvQ3JlYXRlO1xuICB2YXIgaW5kZXhCdWZmZXJzVG9DcmVhdGUgPSBsb2FkUmVzb3VyY2VzLmluZGV4QnVmZmVyc1RvQ3JlYXRlO1xuICB2YXIgaTtcblxuICBpZiAobW9kZWwuYXN5bmNocm9ub3VzKSB7XG4gICAgd2hpbGUgKHZlcnRleEJ1ZmZlcnNUb0NyZWF0ZS5sZW5ndGggPiAwKSB7XG4gICAgICBzY3JhdGNoVmVydGV4QnVmZmVySm9iLnNldCh2ZXJ0ZXhCdWZmZXJzVG9DcmVhdGUucGVlaygpLCBtb2RlbCwgY29udGV4dCk7XG4gICAgICBpZiAoXG4gICAgICAgICFmcmFtZVN0YXRlLmpvYlNjaGVkdWxlci5leGVjdXRlKHNjcmF0Y2hWZXJ0ZXhCdWZmZXJKb2IsIEpvYlR5cGUuQlVGRkVSKVxuICAgICAgKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgdmVydGV4QnVmZmVyc1RvQ3JlYXRlLmRlcXVldWUoKTtcbiAgICB9XG5cbiAgICB3aGlsZSAoaW5kZXhCdWZmZXJzVG9DcmVhdGUubGVuZ3RoID4gMCkge1xuICAgICAgaSA9IGluZGV4QnVmZmVyc1RvQ3JlYXRlLnBlZWsoKTtcbiAgICAgIHNjcmF0Y2hJbmRleEJ1ZmZlckpvYi5zZXQoaS5pZCwgaS5jb21wb25lbnRUeXBlLCBtb2RlbCwgY29udGV4dCk7XG4gICAgICBpZiAoXG4gICAgICAgICFmcmFtZVN0YXRlLmpvYlNjaGVkdWxlci5leGVjdXRlKHNjcmF0Y2hJbmRleEJ1ZmZlckpvYiwgSm9iVHlwZS5CVUZGRVIpXG4gICAgICApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBpbmRleEJ1ZmZlcnNUb0NyZWF0ZS5kZXF1ZXVlKCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHdoaWxlICh2ZXJ0ZXhCdWZmZXJzVG9DcmVhdGUubGVuZ3RoID4gMCkge1xuICAgICAgY3JlYXRlVmVydGV4QnVmZmVyKHZlcnRleEJ1ZmZlcnNUb0NyZWF0ZS5kZXF1ZXVlKCksIG1vZGVsLCBjb250ZXh0KTtcbiAgICB9XG5cbiAgICB3aGlsZSAoaW5kZXhCdWZmZXJzVG9DcmVhdGUubGVuZ3RoID4gMCkge1xuICAgICAgaSA9IGluZGV4QnVmZmVyc1RvQ3JlYXRlLmRlcXVldWUoKTtcbiAgICAgIGNyZWF0ZUluZGV4QnVmZmVyKGkuaWQsIGkuY29tcG9uZW50VHlwZSwgbW9kZWwsIGNvbnRleHQpO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBnZXRQcm9ncmFtRm9yUHJpbWl0aXZlKG1vZGVsLCBwcmltaXRpdmUpIHtcbiAgdmFyIG1hdGVyaWFsID0gbW9kZWwuX3J1bnRpbWUubWF0ZXJpYWxzQnlJZFtwcmltaXRpdmUubWF0ZXJpYWxdO1xuICBpZiAoIWRlZmluZWQobWF0ZXJpYWwpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcmV0dXJuIG1hdGVyaWFsLl9wcm9ncmFtO1xufVxuXG5mdW5jdGlvbiBtb2RpZnlTaGFkZXJGb3JRdWFudGl6ZWRBdHRyaWJ1dGVzKHNoYWRlciwgcHJvZ3JhbU5hbWUsIG1vZGVsKSB7XG4gIHZhciBwcmltaXRpdmU7XG4gIHZhciBwcmltaXRpdmVzID0gbW9kZWwuX3Byb2dyYW1QcmltaXRpdmVzW3Byb2dyYW1OYW1lXTtcblxuICAvLyBJZiBubyBwcmltaXRpdmVzIHdlcmUgY2FjaGVkIGZvciB0aGlzIHByb2dyYW0sIHRoZXJlJ3Mgbm8gbmVlZCB0byBtb2RpZnkgdGhlIHNoYWRlclxuICBpZiAoIWRlZmluZWQocHJpbWl0aXZlcykpIHtcbiAgICByZXR1cm4gc2hhZGVyO1xuICB9XG5cbiAgdmFyIHByaW1pdGl2ZUlkO1xuICBmb3IgKHByaW1pdGl2ZUlkIGluIHByaW1pdGl2ZXMpIHtcbiAgICBpZiAocHJpbWl0aXZlcy5oYXNPd25Qcm9wZXJ0eShwcmltaXRpdmVJZCkpIHtcbiAgICAgIHByaW1pdGl2ZSA9IHByaW1pdGl2ZXNbcHJpbWl0aXZlSWRdO1xuICAgICAgaWYgKGdldFByb2dyYW1Gb3JQcmltaXRpdmUobW9kZWwsIHByaW1pdGl2ZSkgPT09IHByb2dyYW1OYW1lKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIFRoaXMgaXMgbm90IG5lZWRlZCBhZnRlciB0aGUgcHJvZ3JhbSBpcyBwcm9jZXNzZWQsIGZyZWUgdGhlIG1lbW9yeVxuICBtb2RlbC5fcHJvZ3JhbVByaW1pdGl2ZXNbcHJvZ3JhbU5hbWVdID0gdW5kZWZpbmVkO1xuXG4gIHZhciByZXN1bHQ7XG4gIGlmIChtb2RlbC5leHRlbnNpb25zVXNlZC5XRUIzRF9xdWFudGl6ZWRfYXR0cmlidXRlcykge1xuICAgIHJlc3VsdCA9IE1vZGVsVXRpbGl0eS5tb2RpZnlTaGFkZXJGb3JRdWFudGl6ZWRBdHRyaWJ1dGVzKFxuICAgICAgbW9kZWwuZ2x0ZixcbiAgICAgIHByaW1pdGl2ZSxcbiAgICAgIHNoYWRlclxuICAgICk7XG4gICAgbW9kZWwuX3F1YW50aXplZFVuaWZvcm1zW3Byb2dyYW1OYW1lXSA9IHJlc3VsdC51bmlmb3JtcztcbiAgfSBlbHNlIHtcbiAgICB2YXIgZGVjb2RlZERhdGEgPSBtb2RlbC5fZGVjb2RlZERhdGFbcHJpbWl0aXZlSWRdO1xuICAgIGlmIChkZWZpbmVkKGRlY29kZWREYXRhKSkge1xuICAgICAgcmVzdWx0ID0gTW9kZWxVdGlsaXR5Lm1vZGlmeVNoYWRlckZvckRyYWNvUXVhbnRpemVkQXR0cmlidXRlcyhcbiAgICAgICAgbW9kZWwuZ2x0ZixcbiAgICAgICAgcHJpbWl0aXZlLFxuICAgICAgICBzaGFkZXIsXG4gICAgICAgIGRlY29kZWREYXRhLmF0dHJpYnV0ZXNcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBzaGFkZXI7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdC5zaGFkZXI7XG59XG5cbmZ1bmN0aW9uIG1vZGlmeVNoYWRlckZvckNvbG9yKHNoYWRlcikge1xuICBzaGFkZXIgPSBTaGFkZXJTb3VyY2UucmVwbGFjZU1haW4oc2hhZGVyLCBcImdsdGZfYmxlbmRfbWFpblwiKTtcbiAgc2hhZGVyICs9XG4gICAgXCJ1bmlmb3JtIHZlYzQgZ2x0Zl9jb2xvcjsgXFxuXCIgK1xuICAgIFwidW5pZm9ybSBmbG9hdCBnbHRmX2NvbG9yQmxlbmQ7IFxcblwiICtcbiAgICBcInZvaWQgbWFpbigpIFxcblwiICtcbiAgICBcInsgXFxuXCIgK1xuICAgIFwiICAgIGdsdGZfYmxlbmRfbWFpbigpOyBcXG5cIiArXG4gICAgXCIgICAgZ2xfRnJhZ0NvbG9yLnJnYiA9IG1peChnbF9GcmFnQ29sb3IucmdiLCBnbHRmX2NvbG9yLnJnYiwgZ2x0Zl9jb2xvckJsZW5kKTsgXFxuXCIgK1xuICAgIFwiICAgIGZsb2F0IGhpZ2hsaWdodCA9IGNlaWwoZ2x0Zl9jb2xvckJsZW5kKTsgXFxuXCIgK1xuICAgIFwiICAgIGdsX0ZyYWdDb2xvci5yZ2IgKj0gbWl4KGdsdGZfY29sb3IucmdiLCB2ZWMzKDEuMCksIGhpZ2hsaWdodCk7IFxcblwiICtcbiAgICBcIiAgICBnbF9GcmFnQ29sb3IuYSAqPSBnbHRmX2NvbG9yLmE7IFxcblwiICtcbiAgICBcIn0gXFxuXCI7XG5cbiAgcmV0dXJuIHNoYWRlcjtcbn1cblxuZnVuY3Rpb24gbW9kaWZ5U2hhZGVyKHNoYWRlciwgcHJvZ3JhbU5hbWUsIGNhbGxiYWNrKSB7XG4gIGlmIChkZWZpbmVkKGNhbGxiYWNrKSkge1xuICAgIHNoYWRlciA9IGNhbGxiYWNrKHNoYWRlciwgcHJvZ3JhbU5hbWUpO1xuICB9XG4gIHJldHVybiBzaGFkZXI7XG59XG5cbnZhciBDcmVhdGVQcm9ncmFtSm9iID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLnByb2dyYW1Ub0NyZWF0ZSA9IHVuZGVmaW5lZDtcbiAgdGhpcy5tb2RlbCA9IHVuZGVmaW5lZDtcbiAgdGhpcy5jb250ZXh0ID0gdW5kZWZpbmVkO1xufTtcblxuQ3JlYXRlUHJvZ3JhbUpvYi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKHByb2dyYW1Ub0NyZWF0ZSwgbW9kZWwsIGNvbnRleHQpIHtcbiAgdGhpcy5wcm9ncmFtVG9DcmVhdGUgPSBwcm9ncmFtVG9DcmVhdGU7XG4gIHRoaXMubW9kZWwgPSBtb2RlbDtcbiAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbn07XG5cbkNyZWF0ZVByb2dyYW1Kb2IucHJvdG90eXBlLmV4ZWN1dGUgPSBmdW5jdGlvbiAoKSB7XG4gIGNyZWF0ZVByb2dyYW0odGhpcy5wcm9ncmFtVG9DcmVhdGUsIHRoaXMubW9kZWwsIHRoaXMuY29udGV4dCk7XG59O1xuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuLy8gV2hlbiBidWlsZGluZyBwcm9ncmFtcyBmb3IgdGhlIGZpcnN0IHRpbWUsIGRvIG5vdCBpbmNsdWRlIG1vZGlmaWVycyBmb3IgY2xpcHBpbmcgcGxhbmVzIGFuZCBjb2xvclxuLy8gc2luY2UgdGhpcyBpcyB0aGUgdmVyc2lvbiBvZiB0aGUgcHJvZ3JhbSB0aGF0IHdpbGwgYmUgY2FjaGVkIGZvciB1c2Ugd2l0aCBvdGhlciBNb2RlbHMuXG5mdW5jdGlvbiBjcmVhdGVQcm9ncmFtKHByb2dyYW1Ub0NyZWF0ZSwgbW9kZWwsIGNvbnRleHQpIHtcbiAgdmFyIHByb2dyYW1JZCA9IHByb2dyYW1Ub0NyZWF0ZS5wcm9ncmFtSWQ7XG4gIHZhciB0ZWNobmlxdWVJZCA9IHByb2dyYW1Ub0NyZWF0ZS50ZWNobmlxdWVJZDtcbiAgdmFyIHByb2dyYW0gPSBtb2RlbC5fc291cmNlUHJvZ3JhbXNbcHJvZ3JhbUlkXTtcbiAgdmFyIHNoYWRlcnMgPSBtb2RlbC5fcmVuZGVyZXJSZXNvdXJjZXMuc291cmNlU2hhZGVycztcblxuICB2YXIgdnMgPSBzaGFkZXJzW3Byb2dyYW0udmVydGV4U2hhZGVyXTtcbiAgdmFyIGZzID0gc2hhZGVyc1twcm9ncmFtLmZyYWdtZW50U2hhZGVyXTtcblxuICB2YXIgcXVhbnRpemVkVmVydGV4U2hhZGVycyA9IG1vZGVsLl9xdWFudGl6ZWRWZXJ0ZXhTaGFkZXJzO1xuXG4gIGlmIChcbiAgICBtb2RlbC5leHRlbnNpb25zVXNlZC5XRUIzRF9xdWFudGl6ZWRfYXR0cmlidXRlcyB8fFxuICAgIG1vZGVsLl9kZXF1YW50aXplSW5TaGFkZXJcbiAgKSB7XG4gICAgdmFyIHF1YW50aXplZFZTID0gcXVhbnRpemVkVmVydGV4U2hhZGVyc1twcm9ncmFtSWRdO1xuICAgIGlmICghZGVmaW5lZChxdWFudGl6ZWRWUykpIHtcbiAgICAgIHF1YW50aXplZFZTID0gbW9kaWZ5U2hhZGVyRm9yUXVhbnRpemVkQXR0cmlidXRlcyh2cywgcHJvZ3JhbUlkLCBtb2RlbCk7XG4gICAgICBxdWFudGl6ZWRWZXJ0ZXhTaGFkZXJzW3Byb2dyYW1JZF0gPSBxdWFudGl6ZWRWUztcbiAgICB9XG4gICAgdnMgPSBxdWFudGl6ZWRWUztcbiAgfVxuXG4gIHZhciBkcmF3VlMgPSBtb2RpZnlTaGFkZXIodnMsIHByb2dyYW1JZCwgbW9kZWwuX3ZlcnRleFNoYWRlckxvYWRlZCk7XG4gIHZhciBkcmF3RlMgPSBtb2RpZnlTaGFkZXIoZnMsIHByb2dyYW1JZCwgbW9kZWwuX2ZyYWdtZW50U2hhZGVyTG9hZGVkKTtcblxuICBpZiAoIWRlZmluZWQobW9kZWwuX3VuaWZvcm1NYXBMb2FkZWQpKSB7XG4gICAgZHJhd0ZTID0gXCJ1bmlmb3JtIHZlYzQgY3ptX3BpY2tDb2xvcjtcXG5cIiArIGRyYXdGUztcbiAgfVxuXG4gIHZhciB1c2VJQkwgPVxuICAgIG1vZGVsLl9pbWFnZUJhc2VkTGlnaHRpbmdGYWN0b3IueCA+IDAuMCB8fFxuICAgIG1vZGVsLl9pbWFnZUJhc2VkTGlnaHRpbmdGYWN0b3IueSA+IDAuMDtcbiAgaWYgKHVzZUlCTCkge1xuICAgIGRyYXdGUyA9IFwiI2RlZmluZSBVU0VfSUJMX0xJR0hUSU5HIFxcblxcblwiICsgZHJhd0ZTO1xuICB9XG5cbiAgaWYgKGRlZmluZWQobW9kZWwuX2xpZ2h0Q29sb3IpKSB7XG4gICAgZHJhd0ZTID0gXCIjZGVmaW5lIFVTRV9DVVNUT01fTElHSFRfQ09MT1IgXFxuXFxuXCIgKyBkcmF3RlM7XG4gIH1cblxuICBpZiAobW9kZWwuX3NvdXJjZVZlcnNpb24gIT09IFwiMi4wXCIgfHwgbW9kZWwuX3NvdXJjZUtIUlRlY2huaXF1ZXNXZWJHTCkge1xuICAgIGRyYXdGUyA9IFNoYWRlclNvdXJjZS5yZXBsYWNlTWFpbihkcmF3RlMsIFwibm9uX2dhbW1hX2NvcnJlY3RlZF9tYWluXCIpO1xuICAgIGRyYXdGUyA9XG4gICAgICBkcmF3RlMgK1xuICAgICAgXCJcXG5cIiArXG4gICAgICBcInZvaWQgbWFpbigpIHsgXFxuXCIgK1xuICAgICAgXCIgICAgbm9uX2dhbW1hX2NvcnJlY3RlZF9tYWluKCk7IFxcblwiICtcbiAgICAgIFwiICAgIGdsX0ZyYWdDb2xvciA9IGN6bV9nYW1tYUNvcnJlY3QoZ2xfRnJhZ0NvbG9yKTsgXFxuXCIgK1xuICAgICAgXCJ9IFxcblwiO1xuICB9XG5cbiAgaWYgKE9jdGFoZWRyYWxQcm9qZWN0ZWRDdWJlTWFwLmlzU3VwcG9ydGVkKGNvbnRleHQpKSB7XG4gICAgdmFyIHVzZXNTSCA9XG4gICAgICBkZWZpbmVkKG1vZGVsLl9zcGhlcmljYWxIYXJtb25pY0NvZWZmaWNpZW50cykgfHxcbiAgICAgIG1vZGVsLl91c2VEZWZhdWx0U3BoZXJpY2FsSGFybW9uaWNzO1xuICAgIHZhciB1c2VzU00gPVxuICAgICAgKGRlZmluZWQobW9kZWwuX3NwZWN1bGFyRW52aXJvbm1lbnRNYXBBdGxhcykgJiZcbiAgICAgICAgbW9kZWwuX3NwZWN1bGFyRW52aXJvbm1lbnRNYXBBdGxhcy5yZWFkeSkgfHxcbiAgICAgIG1vZGVsLl91c2VEZWZhdWx0U3BlY3VsYXJNYXBzO1xuICAgIHZhciBhZGRNYXRyaXggPSB1c2VzU0ggfHwgdXNlc1NNIHx8IHVzZUlCTDtcbiAgICBpZiAoYWRkTWF0cml4KSB7XG4gICAgICBkcmF3RlMgPSBcInVuaWZvcm0gbWF0MyBnbHRmX2libFJlZmVyZW5jZUZyYW1lTWF0cml4OyBcXG5cIiArIGRyYXdGUztcbiAgICB9XG5cbiAgICBpZiAoZGVmaW5lZChtb2RlbC5fc3BoZXJpY2FsSGFybW9uaWNDb2VmZmljaWVudHMpKSB7XG4gICAgICBkcmF3RlMgPVxuICAgICAgICBcIiNkZWZpbmUgRElGRlVTRV9JQkwgXFxuXCIgK1xuICAgICAgICBcIiNkZWZpbmUgQ1VTVE9NX1NQSEVSSUNBTF9IQVJNT05JQ1MgXFxuXCIgK1xuICAgICAgICBcInVuaWZvcm0gdmVjMyBnbHRmX3NwaGVyaWNhbEhhcm1vbmljQ29lZmZpY2llbnRzWzldOyBcXG5cIiArXG4gICAgICAgIGRyYXdGUztcbiAgICB9IGVsc2UgaWYgKG1vZGVsLl91c2VEZWZhdWx0U3BoZXJpY2FsSGFybW9uaWNzKSB7XG4gICAgICBkcmF3RlMgPSBcIiNkZWZpbmUgRElGRlVTRV9JQkwgXFxuXCIgKyBkcmF3RlM7XG4gICAgfVxuXG4gICAgaWYgKFxuICAgICAgZGVmaW5lZChtb2RlbC5fc3BlY3VsYXJFbnZpcm9ubWVudE1hcEF0bGFzKSAmJlxuICAgICAgbW9kZWwuX3NwZWN1bGFyRW52aXJvbm1lbnRNYXBBdGxhcy5yZWFkeVxuICAgICkge1xuICAgICAgZHJhd0ZTID1cbiAgICAgICAgXCIjZGVmaW5lIFNQRUNVTEFSX0lCTCBcXG5cIiArXG4gICAgICAgIFwiI2RlZmluZSBDVVNUT01fU1BFQ1VMQVJfSUJMIFxcblwiICtcbiAgICAgICAgXCJ1bmlmb3JtIHNhbXBsZXIyRCBnbHRmX3NwZWN1bGFyTWFwOyBcXG5cIiArXG4gICAgICAgIFwidW5pZm9ybSB2ZWMyIGdsdGZfc3BlY3VsYXJNYXBTaXplOyBcXG5cIiArXG4gICAgICAgIFwidW5pZm9ybSBmbG9hdCBnbHRmX21heFNwZWN1bGFyTE9EOyBcXG5cIiArXG4gICAgICAgIGRyYXdGUztcbiAgICB9IGVsc2UgaWYgKG1vZGVsLl91c2VEZWZhdWx0U3BlY3VsYXJNYXBzKSB7XG4gICAgICBkcmF3RlMgPSBcIiNkZWZpbmUgU1BFQ1VMQVJfSUJMIFxcblwiICsgZHJhd0ZTO1xuICAgIH1cbiAgfVxuXG4gIGlmIChkZWZpbmVkKG1vZGVsLl9sdW1pbmFuY2VBdFplbml0aCkpIHtcbiAgICBkcmF3RlMgPVxuICAgICAgXCIjZGVmaW5lIFVTRV9TVU5fTFVNSU5BTkNFIFxcblwiICtcbiAgICAgIFwidW5pZm9ybSBmbG9hdCBnbHRmX2x1bWluYW5jZUF0WmVuaXRoO1xcblwiICtcbiAgICAgIGRyYXdGUztcbiAgfVxuXG4gIGNyZWF0ZUF0dHJpYnV0ZXNBbmRQcm9ncmFtKFxuICAgIHByb2dyYW1JZCxcbiAgICB0ZWNobmlxdWVJZCxcbiAgICBkcmF3RlMsXG4gICAgZHJhd1ZTLFxuICAgIG1vZGVsLFxuICAgIGNvbnRleHRcbiAgKTtcbn1cblxuZnVuY3Rpb24gcmVjcmVhdGVQcm9ncmFtKHByb2dyYW1Ub0NyZWF0ZSwgbW9kZWwsIGNvbnRleHQpIHtcbiAgdmFyIHByb2dyYW1JZCA9IHByb2dyYW1Ub0NyZWF0ZS5wcm9ncmFtSWQ7XG4gIHZhciB0ZWNobmlxdWVJZCA9IHByb2dyYW1Ub0NyZWF0ZS50ZWNobmlxdWVJZDtcbiAgdmFyIHByb2dyYW0gPSBtb2RlbC5fc291cmNlUHJvZ3JhbXNbcHJvZ3JhbUlkXTtcbiAgdmFyIHNoYWRlcnMgPSBtb2RlbC5fcmVuZGVyZXJSZXNvdXJjZXMuc291cmNlU2hhZGVycztcblxuICB2YXIgcXVhbnRpemVkVmVydGV4U2hhZGVycyA9IG1vZGVsLl9xdWFudGl6ZWRWZXJ0ZXhTaGFkZXJzO1xuXG4gIHZhciBjbGlwcGluZ1BsYW5lQ29sbGVjdGlvbiA9IG1vZGVsLmNsaXBwaW5nUGxhbmVzO1xuICB2YXIgYWRkQ2xpcHBpbmdQbGFuZUNvZGUgPSBpc0NsaXBwaW5nRW5hYmxlZChtb2RlbCk7XG5cbiAgdmFyIHZzID0gc2hhZGVyc1twcm9ncmFtLnZlcnRleFNoYWRlcl07XG4gIHZhciBmcyA9IHNoYWRlcnNbcHJvZ3JhbS5mcmFnbWVudFNoYWRlcl07XG5cbiAgaWYgKFxuICAgIG1vZGVsLmV4dGVuc2lvbnNVc2VkLldFQjNEX3F1YW50aXplZF9hdHRyaWJ1dGVzIHx8XG4gICAgbW9kZWwuX2RlcXVhbnRpemVJblNoYWRlclxuICApIHtcbiAgICB2cyA9IHF1YW50aXplZFZlcnRleFNoYWRlcnNbcHJvZ3JhbUlkXTtcbiAgfVxuXG4gIHZhciBmaW5hbEZTID0gZnM7XG4gIGlmIChpc0NvbG9yU2hhZGluZ0VuYWJsZWQobW9kZWwpKSB7XG4gICAgZmluYWxGUyA9IE1vZGVsLl9tb2RpZnlTaGFkZXJGb3JDb2xvcihmaW5hbEZTKTtcbiAgfVxuICBpZiAoYWRkQ2xpcHBpbmdQbGFuZUNvZGUpIHtcbiAgICBmaW5hbEZTID0gbW9kaWZ5U2hhZGVyRm9yQ2xpcHBpbmdQbGFuZXMoXG4gICAgICBmaW5hbEZTLFxuICAgICAgY2xpcHBpbmdQbGFuZUNvbGxlY3Rpb24sXG4gICAgICBjb250ZXh0XG4gICAgKTtcbiAgfVxuXG4gIHZhciBkcmF3VlMgPSBtb2RpZnlTaGFkZXIodnMsIHByb2dyYW1JZCwgbW9kZWwuX3ZlcnRleFNoYWRlckxvYWRlZCk7XG4gIHZhciBkcmF3RlMgPSBtb2RpZnlTaGFkZXIoZmluYWxGUywgcHJvZ3JhbUlkLCBtb2RlbC5fZnJhZ21lbnRTaGFkZXJMb2FkZWQpO1xuXG4gIGlmICghZGVmaW5lZChtb2RlbC5fdW5pZm9ybU1hcExvYWRlZCkpIHtcbiAgICBkcmF3RlMgPSBcInVuaWZvcm0gdmVjNCBjem1fcGlja0NvbG9yO1xcblwiICsgZHJhd0ZTO1xuICB9XG5cbiAgdmFyIHVzZUlCTCA9XG4gICAgbW9kZWwuX2ltYWdlQmFzZWRMaWdodGluZ0ZhY3Rvci54ID4gMC4wIHx8XG4gICAgbW9kZWwuX2ltYWdlQmFzZWRMaWdodGluZ0ZhY3Rvci55ID4gMC4wO1xuICBpZiAodXNlSUJMKSB7XG4gICAgZHJhd0ZTID0gXCIjZGVmaW5lIFVTRV9JQkxfTElHSFRJTkcgXFxuXFxuXCIgKyBkcmF3RlM7XG4gIH1cblxuICBpZiAoZGVmaW5lZChtb2RlbC5fbGlnaHRDb2xvcikpIHtcbiAgICBkcmF3RlMgPSBcIiNkZWZpbmUgVVNFX0NVU1RPTV9MSUdIVF9DT0xPUiBcXG5cXG5cIiArIGRyYXdGUztcbiAgfVxuXG4gIGlmIChtb2RlbC5fc291cmNlVmVyc2lvbiAhPT0gXCIyLjBcIiB8fCBtb2RlbC5fc291cmNlS0hSVGVjaG5pcXVlc1dlYkdMKSB7XG4gICAgZHJhd0ZTID0gU2hhZGVyU291cmNlLnJlcGxhY2VNYWluKGRyYXdGUywgXCJub25fZ2FtbWFfY29ycmVjdGVkX21haW5cIik7XG4gICAgZHJhd0ZTID1cbiAgICAgIGRyYXdGUyArXG4gICAgICBcIlxcblwiICtcbiAgICAgIFwidm9pZCBtYWluKCkgeyBcXG5cIiArXG4gICAgICBcIiAgICBub25fZ2FtbWFfY29ycmVjdGVkX21haW4oKTsgXFxuXCIgK1xuICAgICAgXCIgICAgZ2xfRnJhZ0NvbG9yID0gY3ptX2dhbW1hQ29ycmVjdChnbF9GcmFnQ29sb3IpOyBcXG5cIiArXG4gICAgICBcIn0gXFxuXCI7XG4gIH1cblxuICBpZiAoT2N0YWhlZHJhbFByb2plY3RlZEN1YmVNYXAuaXNTdXBwb3J0ZWQoY29udGV4dCkpIHtcbiAgICB2YXIgdXNlc1NIID1cbiAgICAgIGRlZmluZWQobW9kZWwuX3NwaGVyaWNhbEhhcm1vbmljQ29lZmZpY2llbnRzKSB8fFxuICAgICAgbW9kZWwuX3VzZURlZmF1bHRTcGhlcmljYWxIYXJtb25pY3M7XG4gICAgdmFyIHVzZXNTTSA9XG4gICAgICAoZGVmaW5lZChtb2RlbC5fc3BlY3VsYXJFbnZpcm9ubWVudE1hcEF0bGFzKSAmJlxuICAgICAgICBtb2RlbC5fc3BlY3VsYXJFbnZpcm9ubWVudE1hcEF0bGFzLnJlYWR5KSB8fFxuICAgICAgbW9kZWwuX3VzZURlZmF1bHRTcGVjdWxhck1hcHM7XG4gICAgdmFyIGFkZE1hdHJpeCA9IHVzZXNTSCB8fCB1c2VzU00gfHwgdXNlSUJMO1xuICAgIGlmIChhZGRNYXRyaXgpIHtcbiAgICAgIGRyYXdGUyA9IFwidW5pZm9ybSBtYXQzIGdsdGZfaWJsUmVmZXJlbmNlRnJhbWVNYXRyaXg7IFxcblwiICsgZHJhd0ZTO1xuICAgIH1cblxuICAgIGlmIChkZWZpbmVkKG1vZGVsLl9zcGhlcmljYWxIYXJtb25pY0NvZWZmaWNpZW50cykpIHtcbiAgICAgIGRyYXdGUyA9XG4gICAgICAgIFwiI2RlZmluZSBESUZGVVNFX0lCTCBcXG5cIiArXG4gICAgICAgIFwiI2RlZmluZSBDVVNUT01fU1BIRVJJQ0FMX0hBUk1PTklDUyBcXG5cIiArXG4gICAgICAgIFwidW5pZm9ybSB2ZWMzIGdsdGZfc3BoZXJpY2FsSGFybW9uaWNDb2VmZmljaWVudHNbOV07IFxcblwiICtcbiAgICAgICAgZHJhd0ZTO1xuICAgIH0gZWxzZSBpZiAobW9kZWwuX3VzZURlZmF1bHRTcGhlcmljYWxIYXJtb25pY3MpIHtcbiAgICAgIGRyYXdGUyA9IFwiI2RlZmluZSBESUZGVVNFX0lCTCBcXG5cIiArIGRyYXdGUztcbiAgICB9XG5cbiAgICBpZiAoXG4gICAgICBkZWZpbmVkKG1vZGVsLl9zcGVjdWxhckVudmlyb25tZW50TWFwQXRsYXMpICYmXG4gICAgICBtb2RlbC5fc3BlY3VsYXJFbnZpcm9ubWVudE1hcEF0bGFzLnJlYWR5XG4gICAgKSB7XG4gICAgICBkcmF3RlMgPVxuICAgICAgICBcIiNkZWZpbmUgU1BFQ1VMQVJfSUJMIFxcblwiICtcbiAgICAgICAgXCIjZGVmaW5lIENVU1RPTV9TUEVDVUxBUl9JQkwgXFxuXCIgK1xuICAgICAgICBcInVuaWZvcm0gc2FtcGxlcjJEIGdsdGZfc3BlY3VsYXJNYXA7IFxcblwiICtcbiAgICAgICAgXCJ1bmlmb3JtIHZlYzIgZ2x0Zl9zcGVjdWxhck1hcFNpemU7IFxcblwiICtcbiAgICAgICAgXCJ1bmlmb3JtIGZsb2F0IGdsdGZfbWF4U3BlY3VsYXJMT0Q7IFxcblwiICtcbiAgICAgICAgZHJhd0ZTO1xuICAgIH0gZWxzZSBpZiAobW9kZWwuX3VzZURlZmF1bHRTcGVjdWxhck1hcHMpIHtcbiAgICAgIGRyYXdGUyA9IFwiI2RlZmluZSBTUEVDVUxBUl9JQkwgXFxuXCIgKyBkcmF3RlM7XG4gICAgfVxuICB9XG5cbiAgaWYgKGRlZmluZWQobW9kZWwuX2x1bWluYW5jZUF0WmVuaXRoKSkge1xuICAgIGRyYXdGUyA9XG4gICAgICBcIiNkZWZpbmUgVVNFX1NVTl9MVU1JTkFOQ0UgXFxuXCIgK1xuICAgICAgXCJ1bmlmb3JtIGZsb2F0IGdsdGZfbHVtaW5hbmNlQXRaZW5pdGg7XFxuXCIgK1xuICAgICAgZHJhd0ZTO1xuICB9XG5cbiAgY3JlYXRlQXR0cmlidXRlc0FuZFByb2dyYW0oXG4gICAgcHJvZ3JhbUlkLFxuICAgIHRlY2huaXF1ZUlkLFxuICAgIGRyYXdGUyxcbiAgICBkcmF3VlMsXG4gICAgbW9kZWwsXG4gICAgY29udGV4dFxuICApO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVBdHRyaWJ1dGVzQW5kUHJvZ3JhbShcbiAgcHJvZ3JhbUlkLFxuICB0ZWNobmlxdWVJZCxcbiAgZHJhd0ZTLFxuICBkcmF3VlMsXG4gIG1vZGVsLFxuICBjb250ZXh0XG4pIHtcbiAgdmFyIHRlY2huaXF1ZSA9IG1vZGVsLl9zb3VyY2VUZWNobmlxdWVzW3RlY2huaXF1ZUlkXTtcbiAgdmFyIGF0dHJpYnV0ZUxvY2F0aW9ucyA9IE1vZGVsVXRpbGl0eS5jcmVhdGVBdHRyaWJ1dGVMb2NhdGlvbnMoXG4gICAgdGVjaG5pcXVlLFxuICAgIG1vZGVsLl9wcmVjcmVhdGVkQXR0cmlidXRlc1xuICApO1xuXG4gIG1vZGVsLl9yZW5kZXJlclJlc291cmNlcy5wcm9ncmFtc1twcm9ncmFtSWRdID0gU2hhZGVyUHJvZ3JhbS5mcm9tQ2FjaGUoe1xuICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgdmVydGV4U2hhZGVyU291cmNlOiBkcmF3VlMsXG4gICAgZnJhZ21lbnRTaGFkZXJTb3VyY2U6IGRyYXdGUyxcbiAgICBhdHRyaWJ1dGVMb2NhdGlvbnM6IGF0dHJpYnV0ZUxvY2F0aW9ucyxcbiAgfSk7XG59XG5cbnZhciBzY3JhdGNoQ3JlYXRlUHJvZ3JhbUpvYiA9IG5ldyBDcmVhdGVQcm9ncmFtSm9iKCk7XG5cbmZ1bmN0aW9uIGNyZWF0ZVByb2dyYW1zKG1vZGVsLCBmcmFtZVN0YXRlKSB7XG4gIHZhciBsb2FkUmVzb3VyY2VzID0gbW9kZWwuX2xvYWRSZXNvdXJjZXM7XG4gIHZhciBwcm9ncmFtc1RvQ3JlYXRlID0gbG9hZFJlc291cmNlcy5wcm9ncmFtc1RvQ3JlYXRlO1xuXG4gIGlmIChsb2FkUmVzb3VyY2VzLnBlbmRpbmdTaGFkZXJMb2FkcyAhPT0gMCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIFBFUkZPUk1BTkNFX0lERUE6IHRoaXMgY291bGQgYmUgbW9yZSBmaW5lLWdyYWluZWQgYnkgbG9va2luZ1xuICAvLyBhdCB0aGUgc2hhZGVyJ3MgYnVmZmVyVmlldydzIHRvIGRldGVybWluZSB0aGUgYnVmZmVyIGRlcGVuZGVuY2llcy5cbiAgaWYgKGxvYWRSZXNvdXJjZXMucGVuZGluZ0J1ZmZlckxvYWRzICE9PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGNvbnRleHQgPSBmcmFtZVN0YXRlLmNvbnRleHQ7XG5cbiAgaWYgKG1vZGVsLmFzeW5jaHJvbm91cykge1xuICAgIHdoaWxlIChwcm9ncmFtc1RvQ3JlYXRlLmxlbmd0aCA+IDApIHtcbiAgICAgIHNjcmF0Y2hDcmVhdGVQcm9ncmFtSm9iLnNldChwcm9ncmFtc1RvQ3JlYXRlLnBlZWsoKSwgbW9kZWwsIGNvbnRleHQpO1xuICAgICAgaWYgKFxuICAgICAgICAhZnJhbWVTdGF0ZS5qb2JTY2hlZHVsZXIuZXhlY3V0ZShcbiAgICAgICAgICBzY3JhdGNoQ3JlYXRlUHJvZ3JhbUpvYixcbiAgICAgICAgICBKb2JUeXBlLlBST0dSQU1cbiAgICAgICAgKVxuICAgICAgKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcHJvZ3JhbXNUb0NyZWF0ZS5kZXF1ZXVlKCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIC8vIENyZWF0ZSBhbGwgbG9hZGVkIHByb2dyYW1zIHRoaXMgZnJhbWVcbiAgICB3aGlsZSAocHJvZ3JhbXNUb0NyZWF0ZS5sZW5ndGggPiAwKSB7XG4gICAgICBjcmVhdGVQcm9ncmFtKHByb2dyYW1zVG9DcmVhdGUuZGVxdWV1ZSgpLCBtb2RlbCwgY29udGV4dCk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGdldE9uSW1hZ2VDcmVhdGVkRnJvbVR5cGVkQXJyYXkobG9hZFJlc291cmNlcywgZ2x0ZlRleHR1cmUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChpbWFnZSkge1xuICAgIGxvYWRSZXNvdXJjZXMudGV4dHVyZXNUb0NyZWF0ZS5lbnF1ZXVlKHtcbiAgICAgIGlkOiBnbHRmVGV4dHVyZS5pZCxcbiAgICAgIGltYWdlOiBpbWFnZSxcbiAgICAgIGJ1ZmZlclZpZXc6IHVuZGVmaW5lZCxcbiAgICB9KTtcblxuICAgIC0tbG9hZFJlc291cmNlcy5wZW5kaW5nQnVmZmVyVmlld1RvSW1hZ2U7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGxvYWRUZXh0dXJlc0Zyb21CdWZmZXJWaWV3cyhtb2RlbCkge1xuICB2YXIgbG9hZFJlc291cmNlcyA9IG1vZGVsLl9sb2FkUmVzb3VyY2VzO1xuXG4gIGlmIChsb2FkUmVzb3VyY2VzLnBlbmRpbmdCdWZmZXJMb2FkcyAhPT0gMCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHdoaWxlIChsb2FkUmVzb3VyY2VzLnRleHR1cmVzVG9DcmVhdGVGcm9tQnVmZmVyVmlldy5sZW5ndGggPiAwKSB7XG4gICAgdmFyIGdsdGZUZXh0dXJlID0gbG9hZFJlc291cmNlcy50ZXh0dXJlc1RvQ3JlYXRlRnJvbUJ1ZmZlclZpZXcuZGVxdWV1ZSgpO1xuXG4gICAgdmFyIGdsdGYgPSBtb2RlbC5nbHRmO1xuICAgIHZhciBidWZmZXJWaWV3ID0gZ2x0Zi5idWZmZXJWaWV3c1tnbHRmVGV4dHVyZS5idWZmZXJWaWV3XTtcbiAgICB2YXIgaW1hZ2VJZCA9IGdsdGYudGV4dHVyZXNbZ2x0ZlRleHR1cmUuaWRdLnNvdXJjZTtcblxuICAgIHZhciBvbmVycm9yID0gTW9kZWxVdGlsaXR5LmdldEZhaWxlZExvYWRGdW5jdGlvbihcbiAgICAgIG1vZGVsLFxuICAgICAgXCJpbWFnZVwiLFxuICAgICAgXCJpZDogXCIgKyBnbHRmVGV4dHVyZS5pZCArIFwiLCBidWZmZXJWaWV3OiBcIiArIGdsdGZUZXh0dXJlLmJ1ZmZlclZpZXdcbiAgICApO1xuXG4gICAgaWYgKGdsdGZUZXh0dXJlLm1pbWVUeXBlID09PSBcImltYWdlL2t0eDJcIikge1xuICAgICAgLy8gTmVlZCB0byBtYWtlIGEgY29weSBvZiB0aGUgZW1iZWRkZWQgS1RYMiBidWZmZXIgb3RoZXJ3aXNlIHRoZSB1bmRlcmx5aW5nXG4gICAgICAvLyBBcnJheUJ1ZmZlciBtYXkgYmUgYWNjZXNzZWQgb24gYm90aCB0aGUgd29ya2VyIGFuZCB0aGUgbWFpbiB0aHJlYWQgYW5kXG4gICAgICAvLyB0aHJvdyBhbiBlcnJvciBsaWtlIFwiQ2Fubm90IHBlcmZvcm0gQ29uc3RydWN0IG9uIGEgZGV0YWNoZWQgQXJyYXlCdWZmZXJcIi5cbiAgICAgIC8vIExvb2sgaW50byBTaGFyZWRBcnJheUJ1ZmZlciBhdCBzb21lIHBvaW50IHRvIGdldCBhcm91bmQgdGhpcy5cbiAgICAgIHZhciBrdHhCdWZmZXIgPSBuZXcgVWludDhBcnJheShsb2FkUmVzb3VyY2VzLmdldEJ1ZmZlcihidWZmZXJWaWV3KSk7XG4gICAgICBsb2FkS1RYMihrdHhCdWZmZXIpXG4gICAgICAgIC50aGVuKGltYWdlTG9hZChtb2RlbCwgZ2x0ZlRleHR1cmUuaWQsIGltYWdlSWQpKVxuICAgICAgICAub3RoZXJ3aXNlKG9uZXJyb3IpO1xuICAgICAgKyttb2RlbC5fbG9hZFJlc291cmNlcy5wZW5kaW5nVGV4dHVyZUxvYWRzO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgb25sb2FkID0gZ2V0T25JbWFnZUNyZWF0ZWRGcm9tVHlwZWRBcnJheShsb2FkUmVzb3VyY2VzLCBnbHRmVGV4dHVyZSk7XG4gICAgICBsb2FkSW1hZ2VGcm9tVHlwZWRBcnJheSh7XG4gICAgICAgIHVpbnQ4QXJyYXk6IGxvYWRSZXNvdXJjZXMuZ2V0QnVmZmVyKGJ1ZmZlclZpZXcpLFxuICAgICAgICBmb3JtYXQ6IGdsdGZUZXh0dXJlLm1pbWVUeXBlLFxuICAgICAgICBmbGlwWTogZmFsc2UsXG4gICAgICAgIHNraXBDb2xvclNwYWNlQ29udmVyc2lvbjogdHJ1ZSxcbiAgICAgIH0pXG4gICAgICAgIC50aGVuKG9ubG9hZClcbiAgICAgICAgLm90aGVyd2lzZShvbmVycm9yKTtcbiAgICAgICsrbG9hZFJlc291cmNlcy5wZW5kaW5nQnVmZmVyVmlld1RvSW1hZ2U7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVNhbXBsZXJzKG1vZGVsKSB7XG4gIHZhciBsb2FkUmVzb3VyY2VzID0gbW9kZWwuX2xvYWRSZXNvdXJjZXM7XG4gIGlmIChsb2FkUmVzb3VyY2VzLmNyZWF0ZVNhbXBsZXJzKSB7XG4gICAgbG9hZFJlc291cmNlcy5jcmVhdGVTYW1wbGVycyA9IGZhbHNlO1xuXG4gICAgdmFyIHJlbmRlcmVyU2FtcGxlcnMgPSBtb2RlbC5fcmVuZGVyZXJSZXNvdXJjZXMuc2FtcGxlcnM7XG4gICAgRm9yRWFjaC5zYW1wbGVyKG1vZGVsLmdsdGYsIGZ1bmN0aW9uIChzYW1wbGVyLCBzYW1wbGVySWQpIHtcbiAgICAgIHJlbmRlcmVyU2FtcGxlcnNbc2FtcGxlcklkXSA9IG5ldyBTYW1wbGVyKHtcbiAgICAgICAgd3JhcFM6IHNhbXBsZXIud3JhcFMsXG4gICAgICAgIHdyYXBUOiBzYW1wbGVyLndyYXBULFxuICAgICAgICBtaW5pZmljYXRpb25GaWx0ZXI6IHNhbXBsZXIubWluRmlsdGVyLFxuICAgICAgICBtYWduaWZpY2F0aW9uRmlsdGVyOiBzYW1wbGVyLm1hZ0ZpbHRlcixcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG52YXIgQ3JlYXRlVGV4dHVyZUpvYiA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5nbHRmVGV4dHVyZSA9IHVuZGVmaW5lZDtcbiAgdGhpcy5tb2RlbCA9IHVuZGVmaW5lZDtcbiAgdGhpcy5jb250ZXh0ID0gdW5kZWZpbmVkO1xufTtcblxuQ3JlYXRlVGV4dHVyZUpvYi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKGdsdGZUZXh0dXJlLCBtb2RlbCwgY29udGV4dCkge1xuICB0aGlzLmdsdGZUZXh0dXJlID0gZ2x0ZlRleHR1cmU7XG4gIHRoaXMubW9kZWwgPSBtb2RlbDtcbiAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbn07XG5cbkNyZWF0ZVRleHR1cmVKb2IucHJvdG90eXBlLmV4ZWN1dGUgPSBmdW5jdGlvbiAoKSB7XG4gIGNyZWF0ZVRleHR1cmUodGhpcy5nbHRmVGV4dHVyZSwgdGhpcy5tb2RlbCwgdGhpcy5jb250ZXh0KTtcbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5mdW5jdGlvbiBjcmVhdGVUZXh0dXJlKGdsdGZUZXh0dXJlLCBtb2RlbCwgY29udGV4dCkge1xuICB2YXIgdGV4dHVyZXMgPSBtb2RlbC5nbHRmLnRleHR1cmVzO1xuICB2YXIgdGV4dHVyZSA9IHRleHR1cmVzW2dsdGZUZXh0dXJlLmlkXTtcblxuICB2YXIgcmVuZGVyZXJTYW1wbGVycyA9IG1vZGVsLl9yZW5kZXJlclJlc291cmNlcy5zYW1wbGVycztcbiAgdmFyIHNhbXBsZXIgPSByZW5kZXJlclNhbXBsZXJzW3RleHR1cmUuc2FtcGxlcl07XG4gIGlmICghZGVmaW5lZChzYW1wbGVyKSkge1xuICAgIHNhbXBsZXIgPSBuZXcgU2FtcGxlcih7XG4gICAgICB3cmFwUzogVGV4dHVyZVdyYXAuUkVQRUFULFxuICAgICAgd3JhcFQ6IFRleHR1cmVXcmFwLlJFUEVBVCxcbiAgICB9KTtcbiAgfVxuXG4gIHZhciB1c2VzVGV4dHVyZVRyYW5zZm9ybSA9IGZhbHNlO1xuICB2YXIgbWF0ZXJpYWxzID0gbW9kZWwuZ2x0Zi5tYXRlcmlhbHM7XG4gIHZhciBtYXRlcmlhbHNMZW5ndGggPSBtYXRlcmlhbHMubGVuZ3RoO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IG1hdGVyaWFsc0xlbmd0aDsgKytpKSB7XG4gICAgdmFyIG1hdGVyaWFsID0gbWF0ZXJpYWxzW2ldO1xuICAgIGlmIChcbiAgICAgIGRlZmluZWQobWF0ZXJpYWwuZXh0ZW5zaW9ucykgJiZcbiAgICAgIGRlZmluZWQobWF0ZXJpYWwuZXh0ZW5zaW9ucy5LSFJfdGVjaG5pcXVlc193ZWJnbClcbiAgICApIHtcbiAgICAgIHZhciB2YWx1ZXMgPSBtYXRlcmlhbC5leHRlbnNpb25zLktIUl90ZWNobmlxdWVzX3dlYmdsLnZhbHVlcztcbiAgICAgIGZvciAodmFyIHZhbHVlTmFtZSBpbiB2YWx1ZXMpIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIHZhbHVlcy5oYXNPd25Qcm9wZXJ0eSh2YWx1ZU5hbWUpICYmXG4gICAgICAgICAgdmFsdWVOYW1lLmluZGV4T2YoXCJUZXh0dXJlXCIpICE9PSAtMVxuICAgICAgICApIHtcbiAgICAgICAgICB2YXIgdmFsdWUgPSB2YWx1ZXNbdmFsdWVOYW1lXTtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICB2YWx1ZS5pbmRleCA9PT0gZ2x0ZlRleHR1cmUuaWQgJiZcbiAgICAgICAgICAgIGRlZmluZWQodmFsdWUuZXh0ZW5zaW9ucykgJiZcbiAgICAgICAgICAgIGRlZmluZWQodmFsdWUuZXh0ZW5zaW9ucy5LSFJfdGV4dHVyZV90cmFuc2Zvcm0pXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICB1c2VzVGV4dHVyZVRyYW5zZm9ybSA9IHRydWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHVzZXNUZXh0dXJlVHJhbnNmb3JtKSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICB2YXIgd3JhcFMgPSBzYW1wbGVyLndyYXBTO1xuICB2YXIgd3JhcFQgPSBzYW1wbGVyLndyYXBUO1xuICB2YXIgbWluRmlsdGVyID0gc2FtcGxlci5taW5pZmljYXRpb25GaWx0ZXI7XG5cbiAgaWYgKFxuICAgIHVzZXNUZXh0dXJlVHJhbnNmb3JtICYmXG4gICAgbWluRmlsdGVyICE9PSBUZXh0dXJlTWluaWZpY2F0aW9uRmlsdGVyLkxJTkVBUiAmJlxuICAgIG1pbkZpbHRlciAhPT0gVGV4dHVyZU1pbmlmaWNhdGlvbkZpbHRlci5ORUFSRVNUXG4gICkge1xuICAgIGlmIChcbiAgICAgIG1pbkZpbHRlciA9PT0gVGV4dHVyZU1pbmlmaWNhdGlvbkZpbHRlci5ORUFSRVNUX01JUE1BUF9ORUFSRVNUIHx8XG4gICAgICBtaW5GaWx0ZXIgPT09IFRleHR1cmVNaW5pZmljYXRpb25GaWx0ZXIuTkVBUkVTVF9NSVBNQVBfTElORUFSXG4gICAgKSB7XG4gICAgICBtaW5GaWx0ZXIgPSBUZXh0dXJlTWluaWZpY2F0aW9uRmlsdGVyLk5FQVJFU1Q7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1pbkZpbHRlciA9IFRleHR1cmVNaW5pZmljYXRpb25GaWx0ZXIuTElORUFSO1xuICAgIH1cblxuICAgIHNhbXBsZXIgPSBuZXcgU2FtcGxlcih7XG4gICAgICB3cmFwUzogc2FtcGxlci53cmFwUyxcbiAgICAgIHdyYXBUOiBzYW1wbGVyLndyYXBULFxuICAgICAgbWluaWZpY2F0aW9uRmlsdGVyOiBtaW5GaWx0ZXIsXG4gICAgICBtYWduaWZpY2F0aW9uRmlsdGVyOiBzYW1wbGVyLm1hZ25pZmljYXRpb25GaWx0ZXIsXG4gICAgfSk7XG4gIH1cblxuICB2YXIgaW50ZXJuYWxGb3JtYXQgPSBnbHRmVGV4dHVyZS5pbnRlcm5hbEZvcm1hdDtcblxuICB2YXIgbWlwbWFwID1cbiAgICAhKFxuICAgICAgZGVmaW5lZChpbnRlcm5hbEZvcm1hdCkgJiYgUGl4ZWxGb3JtYXQuaXNDb21wcmVzc2VkRm9ybWF0KGludGVybmFsRm9ybWF0KVxuICAgICkgJiZcbiAgICAobWluRmlsdGVyID09PSBUZXh0dXJlTWluaWZpY2F0aW9uRmlsdGVyLk5FQVJFU1RfTUlQTUFQX05FQVJFU1QgfHxcbiAgICAgIG1pbkZpbHRlciA9PT0gVGV4dHVyZU1pbmlmaWNhdGlvbkZpbHRlci5ORUFSRVNUX01JUE1BUF9MSU5FQVIgfHxcbiAgICAgIG1pbkZpbHRlciA9PT0gVGV4dHVyZU1pbmlmaWNhdGlvbkZpbHRlci5MSU5FQVJfTUlQTUFQX05FQVJFU1QgfHxcbiAgICAgIG1pbkZpbHRlciA9PT0gVGV4dHVyZU1pbmlmaWNhdGlvbkZpbHRlci5MSU5FQVJfTUlQTUFQX0xJTkVBUik7XG4gIHZhciByZXF1aXJlc05wb3QgPVxuICAgIG1pcG1hcCB8fFxuICAgIHdyYXBTID09PSBUZXh0dXJlV3JhcC5SRVBFQVQgfHxcbiAgICB3cmFwUyA9PT0gVGV4dHVyZVdyYXAuTUlSUk9SRURfUkVQRUFUIHx8XG4gICAgd3JhcFQgPT09IFRleHR1cmVXcmFwLlJFUEVBVCB8fFxuICAgIHdyYXBUID09PSBUZXh0dXJlV3JhcC5NSVJST1JFRF9SRVBFQVQ7XG4gIHZhciBucG90O1xuICB2YXIgdHg7XG4gIHZhciBzb3VyY2UgPSBnbHRmVGV4dHVyZS5pbWFnZTtcblxuICBpZiAoZGVmaW5lZChpbnRlcm5hbEZvcm1hdCkpIHtcbiAgICBucG90ID1cbiAgICAgICFDZXNpdW1NYXRoLmlzUG93ZXJPZlR3byhnbHRmVGV4dHVyZS53aWR0aCkgfHxcbiAgICAgICFDZXNpdW1NYXRoLmlzUG93ZXJPZlR3byhnbHRmVGV4dHVyZS5oZWlnaHQpO1xuXG4gICAgLy8gV2FybmluZyB0byBlbmNvdXJhZ2UgcG93ZXIgb2YgMiB0ZXh0dXJlIGRpbWVuc2lvbnMgd2l0aCBLSFJfdGV4dHVyZV9iYXNpc3VcbiAgICBpZiAoXG4gICAgICAhY29udGV4dC53ZWJnbDIgJiZcbiAgICAgIFBpeGVsRm9ybWF0LmlzQ29tcHJlc3NlZEZvcm1hdChpbnRlcm5hbEZvcm1hdCkgJiZcbiAgICAgIG5wb3QgJiZcbiAgICAgIHJlcXVpcmVzTnBvdFxuICAgICkge1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICBcIkNvbXByZXNzZWQgdGV4dHVyZSB1c2VzIFJFUEVBVCBvciBNSVJST1JFRF9SRVBFQVQgdGV4dHVyZSB3cmFwIG1vZGUgYW5kIGRpbWVuc2lvbnMgYXJlIG5vdCBwb3dlcnMgb2YgdHdvLiBUaGUgdGV4dHVyZSBtYXkgYmUgcmVuZGVyZWQgaW5jb3JyZWN0bHkuIFNlZSB0aGUgTW9kZWwuanMgY29uc3RydWN0b3IgZG9jdW1lbnRhdGlvbiBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cIlxuICAgICAgKTtcbiAgICB9XG5cbiAgICB2YXIgbWluaWZpY2F0aW9uRmlsdGVyO1xuICAgIGlmIChcbiAgICAgICFkZWZpbmVkKGdsdGZUZXh0dXJlLm1pcExldmVscykgJiZcbiAgICAgIChtaW5GaWx0ZXIgPT09IFRleHR1cmVNaW5pZmljYXRpb25GaWx0ZXIuTkVBUkVTVF9NSVBNQVBfTkVBUkVTVCB8fFxuICAgICAgICBtaW5GaWx0ZXIgPT09IFRleHR1cmVNaW5pZmljYXRpb25GaWx0ZXIuTkVBUkVTVF9NSVBNQVBfTElORUFSKVxuICAgICkge1xuICAgICAgbWluaWZpY2F0aW9uRmlsdGVyID0gVGV4dHVyZU1pbmlmaWNhdGlvbkZpbHRlci5ORUFSRVNUO1xuICAgIH0gZWxzZSBpZiAoXG4gICAgICAhZGVmaW5lZChnbHRmVGV4dHVyZS5taXBMZXZlbHMpICYmXG4gICAgICAobWluRmlsdGVyID09PSBUZXh0dXJlTWluaWZpY2F0aW9uRmlsdGVyLkxJTkVBUl9NSVBNQVBfTkVBUkVTVCB8fFxuICAgICAgICBtaW5GaWx0ZXIgPT09IFRleHR1cmVNaW5pZmljYXRpb25GaWx0ZXIuTElORUFSX01JUE1BUF9MSU5FQVIpXG4gICAgKSB7XG4gICAgICBtaW5pZmljYXRpb25GaWx0ZXIgPSBUZXh0dXJlTWluaWZpY2F0aW9uRmlsdGVyLkxJTkVBUjtcbiAgICB9XG4gICAgc2FtcGxlciA9IG5ldyBTYW1wbGVyKHtcbiAgICAgIHdyYXBTOiBzYW1wbGVyLndyYXBTLFxuICAgICAgd3JhcFQ6IHNhbXBsZXIud3JhcFQsXG4gICAgICBtaW5pZmljYXRpb25GaWx0ZXI6IG1pbmlmaWNhdGlvbkZpbHRlcixcbiAgICAgIG1hZ25pZmljYXRpb25GaWx0ZXI6IHNhbXBsZXIubWFnbmlmaWNhdGlvbkZpbHRlcixcbiAgICB9KTtcblxuICAgIHR4ID0gbmV3IFRleHR1cmUoe1xuICAgICAgY29udGV4dDogY29udGV4dCxcbiAgICAgIHNvdXJjZToge1xuICAgICAgICBhcnJheUJ1ZmZlclZpZXc6IGdsdGZUZXh0dXJlLmJ1ZmZlclZpZXcsXG4gICAgICAgIG1pcExldmVsczogZ2x0ZlRleHR1cmUubWlwTGV2ZWxzLFxuICAgICAgfSxcbiAgICAgIHdpZHRoOiBnbHRmVGV4dHVyZS53aWR0aCxcbiAgICAgIGhlaWdodDogZ2x0ZlRleHR1cmUuaGVpZ2h0LFxuICAgICAgcGl4ZWxGb3JtYXQ6IGludGVybmFsRm9ybWF0LFxuICAgICAgc2FtcGxlcjogc2FtcGxlcixcbiAgICB9KTtcbiAgfSBlbHNlIGlmIChkZWZpbmVkKHNvdXJjZSkpIHtcbiAgICBucG90ID1cbiAgICAgICFDZXNpdW1NYXRoLmlzUG93ZXJPZlR3byhzb3VyY2Uud2lkdGgpIHx8XG4gICAgICAhQ2VzaXVtTWF0aC5pc1Bvd2VyT2ZUd28oc291cmNlLmhlaWdodCk7XG4gICAgaWYgKHJlcXVpcmVzTnBvdCAmJiBucG90KSB7XG4gICAgICAvLyBXZWJHTCByZXF1aXJlcyBwb3dlci1vZi10d28gdGV4dHVyZSBkaW1lbnNpb25zIGZvciBtaXBtYXBwaW5nIGFuZCBSRVBFQVQvTUlSUk9SRURfUkVQRUFUIHdyYXAgbW9kZXMuXG4gICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcbiAgICAgIGNhbnZhcy53aWR0aCA9IENlc2l1bU1hdGgubmV4dFBvd2VyT2ZUd28oc291cmNlLndpZHRoKTtcbiAgICAgIGNhbnZhcy5oZWlnaHQgPSBDZXNpdW1NYXRoLm5leHRQb3dlck9mVHdvKHNvdXJjZS5oZWlnaHQpO1xuICAgICAgdmFyIGNhbnZhc0NvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xuICAgICAgY2FudmFzQ29udGV4dC5kcmF3SW1hZ2UoXG4gICAgICAgIHNvdXJjZSxcbiAgICAgICAgMCxcbiAgICAgICAgMCxcbiAgICAgICAgc291cmNlLndpZHRoLFxuICAgICAgICBzb3VyY2UuaGVpZ2h0LFxuICAgICAgICAwLFxuICAgICAgICAwLFxuICAgICAgICBjYW52YXMud2lkdGgsXG4gICAgICAgIGNhbnZhcy5oZWlnaHRcbiAgICAgICk7XG4gICAgICBzb3VyY2UgPSBjYW52YXM7XG4gICAgfVxuXG4gICAgdHggPSBuZXcgVGV4dHVyZSh7XG4gICAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgICAgc291cmNlOiBzb3VyY2UsXG4gICAgICBwaXhlbEZvcm1hdDogdGV4dHVyZS5pbnRlcm5hbEZvcm1hdCxcbiAgICAgIHBpeGVsRGF0YXR5cGU6IHRleHR1cmUudHlwZSxcbiAgICAgIHNhbXBsZXI6IHNhbXBsZXIsXG4gICAgICBmbGlwWTogZmFsc2UsXG4gICAgICBza2lwQ29sb3JTcGFjZUNvbnZlcnNpb246IHRydWUsXG4gICAgfSk7XG4gICAgLy8gR0xURl9TUEVDOiBTdXBwb3J0IFRFWFRVUkVfQ1VCRV9NQVAuICBodHRwczovL2dpdGh1Yi5jb20vS2hyb25vc0dyb3VwL2dsVEYvaXNzdWVzLzQwXG4gICAgaWYgKG1pcG1hcCkge1xuICAgICAgdHguZ2VuZXJhdGVNaXBtYXAoKTtcbiAgICB9XG4gIH1cbiAgaWYgKGRlZmluZWQodHgpKSB7XG4gICAgbW9kZWwuX3JlbmRlcmVyUmVzb3VyY2VzLnRleHR1cmVzW2dsdGZUZXh0dXJlLmlkXSA9IHR4O1xuICAgIG1vZGVsLl90ZXh0dXJlc0J5dGVMZW5ndGggKz0gdHguc2l6ZUluQnl0ZXM7XG4gIH1cbn1cblxudmFyIHNjcmF0Y2hDcmVhdGVUZXh0dXJlSm9iID0gbmV3IENyZWF0ZVRleHR1cmVKb2IoKTtcblxuZnVuY3Rpb24gY3JlYXRlVGV4dHVyZXMobW9kZWwsIGZyYW1lU3RhdGUpIHtcbiAgdmFyIGNvbnRleHQgPSBmcmFtZVN0YXRlLmNvbnRleHQ7XG4gIHZhciB0ZXh0dXJlc1RvQ3JlYXRlID0gbW9kZWwuX2xvYWRSZXNvdXJjZXMudGV4dHVyZXNUb0NyZWF0ZTtcblxuICBpZiAobW9kZWwuYXN5bmNocm9ub3VzKSB7XG4gICAgd2hpbGUgKHRleHR1cmVzVG9DcmVhdGUubGVuZ3RoID4gMCkge1xuICAgICAgc2NyYXRjaENyZWF0ZVRleHR1cmVKb2Iuc2V0KHRleHR1cmVzVG9DcmVhdGUucGVlaygpLCBtb2RlbCwgY29udGV4dCk7XG4gICAgICBpZiAoXG4gICAgICAgICFmcmFtZVN0YXRlLmpvYlNjaGVkdWxlci5leGVjdXRlKFxuICAgICAgICAgIHNjcmF0Y2hDcmVhdGVUZXh0dXJlSm9iLFxuICAgICAgICAgIEpvYlR5cGUuVEVYVFVSRVxuICAgICAgICApXG4gICAgICApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICB0ZXh0dXJlc1RvQ3JlYXRlLmRlcXVldWUoKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8gQ3JlYXRlIGFsbCBsb2FkZWQgdGV4dHVyZXMgdGhpcyBmcmFtZVxuICAgIHdoaWxlICh0ZXh0dXJlc1RvQ3JlYXRlLmxlbmd0aCA+IDApIHtcbiAgICAgIGNyZWF0ZVRleHR1cmUodGV4dHVyZXNUb0NyZWF0ZS5kZXF1ZXVlKCksIG1vZGVsLCBjb250ZXh0KTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0QXR0cmlidXRlTG9jYXRpb25zKG1vZGVsLCBwcmltaXRpdmUpIHtcbiAgdmFyIHRlY2huaXF1ZXMgPSBtb2RlbC5fc291cmNlVGVjaG5pcXVlcztcblxuICAvLyBSZXRyaWV2ZSB0aGUgY29tcGlsZWQgc2hhZGVyIHByb2dyYW0gdG8gYXNzaWduIGluZGV4IHZhbHVlcyB0byBhdHRyaWJ1dGVzXG4gIHZhciBhdHRyaWJ1dGVMb2NhdGlvbnMgPSB7fTtcblxuICB2YXIgbG9jYXRpb247XG4gIHZhciBpbmRleDtcbiAgdmFyIG1hdGVyaWFsID0gbW9kZWwuX3J1bnRpbWUubWF0ZXJpYWxzQnlJZFtwcmltaXRpdmUubWF0ZXJpYWxdO1xuICBpZiAoIWRlZmluZWQobWF0ZXJpYWwpKSB7XG4gICAgcmV0dXJuIGF0dHJpYnV0ZUxvY2F0aW9ucztcbiAgfVxuXG4gIHZhciB0ZWNobmlxdWUgPSB0ZWNobmlxdWVzW21hdGVyaWFsLl90ZWNobmlxdWVdO1xuICBpZiAoIWRlZmluZWQodGVjaG5pcXVlKSkge1xuICAgIHJldHVybiBhdHRyaWJ1dGVMb2NhdGlvbnM7XG4gIH1cblxuICB2YXIgYXR0cmlidXRlcyA9IHRlY2huaXF1ZS5hdHRyaWJ1dGVzO1xuICB2YXIgcHJvZ3JhbSA9IG1vZGVsLl9yZW5kZXJlclJlc291cmNlcy5wcm9ncmFtc1t0ZWNobmlxdWUucHJvZ3JhbV07XG4gIHZhciBwcm9ncmFtQXR0cmlidXRlTG9jYXRpb25zID0gcHJvZ3JhbS5fYXR0cmlidXRlTG9jYXRpb25zO1xuXG4gIGZvciAobG9jYXRpb24gaW4gcHJvZ3JhbUF0dHJpYnV0ZUxvY2F0aW9ucykge1xuICAgIGlmIChwcm9ncmFtQXR0cmlidXRlTG9jYXRpb25zLmhhc093blByb3BlcnR5KGxvY2F0aW9uKSkge1xuICAgICAgdmFyIGF0dHJpYnV0ZSA9IGF0dHJpYnV0ZXNbbG9jYXRpb25dO1xuICAgICAgaWYgKGRlZmluZWQoYXR0cmlidXRlKSkge1xuICAgICAgICBpbmRleCA9IHByb2dyYW1BdHRyaWJ1dGVMb2NhdGlvbnNbbG9jYXRpb25dO1xuICAgICAgICBhdHRyaWJ1dGVMb2NhdGlvbnNbYXR0cmlidXRlLnNlbWFudGljXSA9IGluZGV4O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIEFkZCBwcmUtY3JlYXRlZCBhdHRyaWJ1dGVzLlxuICB2YXIgcHJlY3JlYXRlZEF0dHJpYnV0ZXMgPSBtb2RlbC5fcHJlY3JlYXRlZEF0dHJpYnV0ZXM7XG4gIGlmIChkZWZpbmVkKHByZWNyZWF0ZWRBdHRyaWJ1dGVzKSkge1xuICAgIGZvciAobG9jYXRpb24gaW4gcHJlY3JlYXRlZEF0dHJpYnV0ZXMpIHtcbiAgICAgIGlmIChwcmVjcmVhdGVkQXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eShsb2NhdGlvbikpIHtcbiAgICAgICAgaW5kZXggPSBwcm9ncmFtQXR0cmlidXRlTG9jYXRpb25zW2xvY2F0aW9uXTtcbiAgICAgICAgYXR0cmlidXRlTG9jYXRpb25zW2xvY2F0aW9uXSA9IGluZGV4O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBhdHRyaWJ1dGVMb2NhdGlvbnM7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUpvaW50cyhtb2RlbCwgcnVudGltZVNraW5zKSB7XG4gIHZhciBnbHRmID0gbW9kZWwuZ2x0ZjtcbiAgdmFyIHNraW5zID0gZ2x0Zi5za2lucztcbiAgdmFyIG5vZGVzID0gZ2x0Zi5ub2RlcztcbiAgdmFyIHJ1bnRpbWVOb2RlcyA9IG1vZGVsLl9ydW50aW1lLm5vZGVzO1xuXG4gIHZhciBza2lubmVkTm9kZXNJZHMgPSBtb2RlbC5fbG9hZFJlc291cmNlcy5za2lubmVkTm9kZXNJZHM7XG4gIHZhciBsZW5ndGggPSBza2lubmVkTm9kZXNJZHMubGVuZ3RoO1xuICBmb3IgKHZhciBqID0gMDsgaiA8IGxlbmd0aDsgKytqKSB7XG4gICAgdmFyIGlkID0gc2tpbm5lZE5vZGVzSWRzW2pdO1xuICAgIHZhciBza2lubmVkTm9kZSA9IHJ1bnRpbWVOb2Rlc1tpZF07XG4gICAgdmFyIG5vZGUgPSBub2Rlc1tpZF07XG5cbiAgICB2YXIgcnVudGltZVNraW4gPSBydW50aW1lU2tpbnNbbm9kZS5za2luXTtcbiAgICBza2lubmVkTm9kZS5pbnZlcnNlQmluZE1hdHJpY2VzID0gcnVudGltZVNraW4uaW52ZXJzZUJpbmRNYXRyaWNlcztcbiAgICBza2lubmVkTm9kZS5iaW5kU2hhcGVNYXRyaXggPSBydW50aW1lU2tpbi5iaW5kU2hhcGVNYXRyaXg7XG5cbiAgICB2YXIgZ2x0ZkpvaW50cyA9IHNraW5zW25vZGUuc2tpbl0uam9pbnRzO1xuICAgIHZhciBqb2ludHNMZW5ndGggPSBnbHRmSm9pbnRzLmxlbmd0aDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGpvaW50c0xlbmd0aDsgKytpKSB7XG4gICAgICB2YXIgbm9kZUlkID0gZ2x0ZkpvaW50c1tpXTtcbiAgICAgIHZhciBqb2ludE5vZGUgPSBydW50aW1lTm9kZXNbbm9kZUlkXTtcbiAgICAgIHNraW5uZWROb2RlLmpvaW50cy5wdXNoKGpvaW50Tm9kZSk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVNraW5zKG1vZGVsKSB7XG4gIHZhciBsb2FkUmVzb3VyY2VzID0gbW9kZWwuX2xvYWRSZXNvdXJjZXM7XG5cbiAgaWYgKGxvYWRSZXNvdXJjZXMucGVuZGluZ0J1ZmZlckxvYWRzICE9PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKCFsb2FkUmVzb3VyY2VzLmNyZWF0ZVNraW5zKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGxvYWRSZXNvdXJjZXMuY3JlYXRlU2tpbnMgPSBmYWxzZTtcblxuICB2YXIgZ2x0ZiA9IG1vZGVsLmdsdGY7XG4gIHZhciBhY2Nlc3NvcnMgPSBnbHRmLmFjY2Vzc29ycztcbiAgdmFyIHJ1bnRpbWVTa2lucyA9IHt9O1xuXG4gIEZvckVhY2guc2tpbihnbHRmLCBmdW5jdGlvbiAoc2tpbiwgaWQpIHtcbiAgICB2YXIgYWNjZXNzb3IgPSBhY2Nlc3NvcnNbc2tpbi5pbnZlcnNlQmluZE1hdHJpY2VzXTtcblxuICAgIHZhciBiaW5kU2hhcGVNYXRyaXg7XG4gICAgaWYgKCFNYXRyaXg0LmVxdWFscyhza2luLmJpbmRTaGFwZU1hdHJpeCwgTWF0cml4NC5JREVOVElUWSkpIHtcbiAgICAgIGJpbmRTaGFwZU1hdHJpeCA9IE1hdHJpeDQuY2xvbmUoc2tpbi5iaW5kU2hhcGVNYXRyaXgpO1xuICAgIH1cblxuICAgIHJ1bnRpbWVTa2luc1tpZF0gPSB7XG4gICAgICBpbnZlcnNlQmluZE1hdHJpY2VzOiBNb2RlbEFuaW1hdGlvbkNhY2hlLmdldFNraW5JbnZlcnNlQmluZE1hdHJpY2VzKFxuICAgICAgICBtb2RlbCxcbiAgICAgICAgYWNjZXNzb3JcbiAgICAgICksXG4gICAgICBiaW5kU2hhcGVNYXRyaXg6IGJpbmRTaGFwZU1hdHJpeCwgLy8gbm90IHVzZWQgd2hlbiB1bmRlZmluZWRcbiAgICB9O1xuICB9KTtcblxuICBjcmVhdGVKb2ludHMobW9kZWwsIHJ1bnRpbWVTa2lucyk7XG59XG5cbmZ1bmN0aW9uIGdldENoYW5uZWxFdmFsdWF0b3IobW9kZWwsIHJ1bnRpbWVOb2RlLCB0YXJnZXRQYXRoLCBzcGxpbmUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChsb2NhbEFuaW1hdGlvblRpbWUpIHtcbiAgICBpZiAoZGVmaW5lZChzcGxpbmUpKSB7XG4gICAgICBsb2NhbEFuaW1hdGlvblRpbWUgPSBtb2RlbC5jbGFtcEFuaW1hdGlvbnNcbiAgICAgICAgPyBzcGxpbmUuY2xhbXBUaW1lKGxvY2FsQW5pbWF0aW9uVGltZSlcbiAgICAgICAgOiBzcGxpbmUud3JhcFRpbWUobG9jYWxBbmltYXRpb25UaW1lKTtcbiAgICAgIHJ1bnRpbWVOb2RlW3RhcmdldFBhdGhdID0gc3BsaW5lLmV2YWx1YXRlKFxuICAgICAgICBsb2NhbEFuaW1hdGlvblRpbWUsXG4gICAgICAgIHJ1bnRpbWVOb2RlW3RhcmdldFBhdGhdXG4gICAgICApO1xuICAgICAgcnVudGltZU5vZGUuZGlydHlOdW1iZXIgPSBtb2RlbC5fbWF4RGlydHlOdW1iZXI7XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVSdW50aW1lQW5pbWF0aW9ucyhtb2RlbCkge1xuICB2YXIgbG9hZFJlc291cmNlcyA9IG1vZGVsLl9sb2FkUmVzb3VyY2VzO1xuXG4gIGlmICghbG9hZFJlc291cmNlcy5maW5pc2hlZFBlbmRpbmdCdWZmZXJMb2FkcygpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKCFsb2FkUmVzb3VyY2VzLmNyZWF0ZVJ1bnRpbWVBbmltYXRpb25zKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGxvYWRSZXNvdXJjZXMuY3JlYXRlUnVudGltZUFuaW1hdGlvbnMgPSBmYWxzZTtcblxuICBtb2RlbC5fcnVudGltZS5hbmltYXRpb25zID0gW107XG5cbiAgdmFyIHJ1bnRpbWVOb2RlcyA9IG1vZGVsLl9ydW50aW1lLm5vZGVzO1xuICB2YXIgYWNjZXNzb3JzID0gbW9kZWwuZ2x0Zi5hY2Nlc3NvcnM7XG5cbiAgRm9yRWFjaC5hbmltYXRpb24obW9kZWwuZ2x0ZiwgZnVuY3Rpb24gKGFuaW1hdGlvbiwgaSkge1xuICAgIHZhciBjaGFubmVscyA9IGFuaW1hdGlvbi5jaGFubmVscztcbiAgICB2YXIgc2FtcGxlcnMgPSBhbmltYXRpb24uc2FtcGxlcnM7XG5cbiAgICAvLyBGaW5kIHN0YXJ0IGFuZCBzdG9wIHRpbWUgZm9yIHRoZSBlbnRpcmUgYW5pbWF0aW9uXG4gICAgdmFyIHN0YXJ0VGltZSA9IE51bWJlci5NQVhfVkFMVUU7XG4gICAgdmFyIHN0b3BUaW1lID0gLU51bWJlci5NQVhfVkFMVUU7XG5cbiAgICB2YXIgY2hhbm5lbHNMZW5ndGggPSBjaGFubmVscy5sZW5ndGg7XG4gICAgdmFyIGNoYW5uZWxFdmFsdWF0b3JzID0gbmV3IEFycmF5KGNoYW5uZWxzTGVuZ3RoKTtcblxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgY2hhbm5lbHNMZW5ndGg7ICsraikge1xuICAgICAgdmFyIGNoYW5uZWwgPSBjaGFubmVsc1tqXTtcbiAgICAgIHZhciB0YXJnZXQgPSBjaGFubmVsLnRhcmdldDtcbiAgICAgIHZhciBwYXRoID0gdGFyZ2V0LnBhdGg7XG4gICAgICB2YXIgc2FtcGxlciA9IHNhbXBsZXJzW2NoYW5uZWwuc2FtcGxlcl07XG4gICAgICB2YXIgaW5wdXQgPSBNb2RlbEFuaW1hdGlvbkNhY2hlLmdldEFuaW1hdGlvblBhcmFtZXRlclZhbHVlcyhcbiAgICAgICAgbW9kZWwsXG4gICAgICAgIGFjY2Vzc29yc1tzYW1wbGVyLmlucHV0XVxuICAgICAgKTtcbiAgICAgIHZhciBvdXRwdXQgPSBNb2RlbEFuaW1hdGlvbkNhY2hlLmdldEFuaW1hdGlvblBhcmFtZXRlclZhbHVlcyhcbiAgICAgICAgbW9kZWwsXG4gICAgICAgIGFjY2Vzc29yc1tzYW1wbGVyLm91dHB1dF1cbiAgICAgICk7XG5cbiAgICAgIHN0YXJ0VGltZSA9IE1hdGgubWluKHN0YXJ0VGltZSwgaW5wdXRbMF0pO1xuICAgICAgc3RvcFRpbWUgPSBNYXRoLm1heChzdG9wVGltZSwgaW5wdXRbaW5wdXQubGVuZ3RoIC0gMV0pO1xuXG4gICAgICB2YXIgc3BsaW5lID0gTW9kZWxBbmltYXRpb25DYWNoZS5nZXRBbmltYXRpb25TcGxpbmUoXG4gICAgICAgIG1vZGVsLFxuICAgICAgICBpLFxuICAgICAgICBhbmltYXRpb24sXG4gICAgICAgIGNoYW5uZWwuc2FtcGxlcixcbiAgICAgICAgc2FtcGxlcixcbiAgICAgICAgaW5wdXQsXG4gICAgICAgIHBhdGgsXG4gICAgICAgIG91dHB1dFxuICAgICAgKTtcblxuICAgICAgY2hhbm5lbEV2YWx1YXRvcnNbal0gPSBnZXRDaGFubmVsRXZhbHVhdG9yKFxuICAgICAgICBtb2RlbCxcbiAgICAgICAgcnVudGltZU5vZGVzW3RhcmdldC5ub2RlXSxcbiAgICAgICAgdGFyZ2V0LnBhdGgsXG4gICAgICAgIHNwbGluZVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBtb2RlbC5fcnVudGltZS5hbmltYXRpb25zW2ldID0ge1xuICAgICAgbmFtZTogYW5pbWF0aW9uLm5hbWUsXG4gICAgICBzdGFydFRpbWU6IHN0YXJ0VGltZSxcbiAgICAgIHN0b3BUaW1lOiBzdG9wVGltZSxcbiAgICAgIGNoYW5uZWxFdmFsdWF0b3JzOiBjaGFubmVsRXZhbHVhdG9ycyxcbiAgICB9O1xuICB9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlVmVydGV4QXJyYXlzKG1vZGVsLCBjb250ZXh0KSB7XG4gIHZhciBsb2FkUmVzb3VyY2VzID0gbW9kZWwuX2xvYWRSZXNvdXJjZXM7XG4gIGlmIChcbiAgICAhbG9hZFJlc291cmNlcy5maW5pc2hlZEJ1ZmZlcnNDcmVhdGlvbigpIHx8XG4gICAgIWxvYWRSZXNvdXJjZXMuZmluaXNoZWRQcm9ncmFtQ3JlYXRpb24oKSB8fFxuICAgICFsb2FkUmVzb3VyY2VzLmNyZWF0ZVZlcnRleEFycmF5c1xuICApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgbG9hZFJlc291cmNlcy5jcmVhdGVWZXJ0ZXhBcnJheXMgPSBmYWxzZTtcblxuICB2YXIgcmVuZGVyZXJCdWZmZXJzID0gbW9kZWwuX3JlbmRlcmVyUmVzb3VyY2VzLmJ1ZmZlcnM7XG4gIHZhciByZW5kZXJlclZlcnRleEFycmF5cyA9IG1vZGVsLl9yZW5kZXJlclJlc291cmNlcy52ZXJ0ZXhBcnJheXM7XG4gIHZhciBnbHRmID0gbW9kZWwuZ2x0ZjtcbiAgdmFyIGFjY2Vzc29ycyA9IGdsdGYuYWNjZXNzb3JzO1xuICBGb3JFYWNoLm1lc2goZ2x0ZiwgZnVuY3Rpb24gKG1lc2gsIG1lc2hJZCkge1xuICAgIEZvckVhY2gubWVzaFByaW1pdGl2ZShtZXNoLCBmdW5jdGlvbiAocHJpbWl0aXZlLCBwcmltaXRpdmVJZCkge1xuICAgICAgdmFyIGF0dHJpYnV0ZXMgPSBbXTtcbiAgICAgIHZhciBhdHRyaWJ1dGVMb2NhdGlvbjtcbiAgICAgIHZhciBhdHRyaWJ1dGVMb2NhdGlvbnMgPSBnZXRBdHRyaWJ1dGVMb2NhdGlvbnMobW9kZWwsIHByaW1pdGl2ZSk7XG4gICAgICB2YXIgZGVjb2RlZERhdGEgPVxuICAgICAgICBtb2RlbC5fZGVjb2RlZERhdGFbbWVzaElkICsgXCIucHJpbWl0aXZlLlwiICsgcHJpbWl0aXZlSWRdO1xuICAgICAgRm9yRWFjaC5tZXNoUHJpbWl0aXZlQXR0cmlidXRlKHByaW1pdGl2ZSwgZnVuY3Rpb24gKFxuICAgICAgICBhY2Nlc3NvcklkLFxuICAgICAgICBhdHRyaWJ1dGVOYW1lXG4gICAgICApIHtcbiAgICAgICAgLy8gU2tpcCBpZiB0aGUgYXR0cmlidXRlIGlzIG5vdCB1c2VkIGJ5IHRoZSBtYXRlcmlhbCwgZS5nLiwgYmVjYXVzZSB0aGUgYXNzZXRcbiAgICAgICAgLy8gd2FzIGV4cG9ydGVkIHdpdGggYW4gYXR0cmlidXRlIHRoYXQgd2Fzbid0IHVzZWQgYW5kIHRoZSBhc3NldCB3YXNuJ3Qgb3B0aW1pemVkLlxuICAgICAgICBhdHRyaWJ1dGVMb2NhdGlvbiA9IGF0dHJpYnV0ZUxvY2F0aW9uc1thdHRyaWJ1dGVOYW1lXTtcbiAgICAgICAgaWYgKGRlZmluZWQoYXR0cmlidXRlTG9jYXRpb24pKSB7XG4gICAgICAgICAgLy8gVXNlIGF0dHJpYnV0ZXMgb2YgcHJldmlvdXNseSBkZWNvZGVkIGRyYWNvIGdlb21ldHJ5XG4gICAgICAgICAgaWYgKGRlZmluZWQoZGVjb2RlZERhdGEpKSB7XG4gICAgICAgICAgICB2YXIgZGVjb2RlZEF0dHJpYnV0ZXMgPSBkZWNvZGVkRGF0YS5hdHRyaWJ1dGVzO1xuICAgICAgICAgICAgaWYgKGRlY29kZWRBdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KGF0dHJpYnV0ZU5hbWUpKSB7XG4gICAgICAgICAgICAgIHZhciBkZWNvZGVkQXR0cmlidXRlID0gZGVjb2RlZEF0dHJpYnV0ZXNbYXR0cmlidXRlTmFtZV07XG4gICAgICAgICAgICAgIGF0dHJpYnV0ZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgaW5kZXg6IGF0dHJpYnV0ZUxvY2F0aW9uLFxuICAgICAgICAgICAgICAgIHZlcnRleEJ1ZmZlcjogcmVuZGVyZXJCdWZmZXJzW2RlY29kZWRBdHRyaWJ1dGUuYnVmZmVyVmlld10sXG4gICAgICAgICAgICAgICAgY29tcG9uZW50c1BlckF0dHJpYnV0ZTogZGVjb2RlZEF0dHJpYnV0ZS5jb21wb25lbnRzUGVyQXR0cmlidXRlLFxuICAgICAgICAgICAgICAgIGNvbXBvbmVudERhdGF0eXBlOiBkZWNvZGVkQXR0cmlidXRlLmNvbXBvbmVudERhdGF0eXBlLFxuICAgICAgICAgICAgICAgIG5vcm1hbGl6ZTogZGVjb2RlZEF0dHJpYnV0ZS5ub3JtYWxpemVkLFxuICAgICAgICAgICAgICAgIG9mZnNldEluQnl0ZXM6IGRlY29kZWRBdHRyaWJ1dGUuYnl0ZU9mZnNldCxcbiAgICAgICAgICAgICAgICBzdHJpZGVJbkJ5dGVzOiBkZWNvZGVkQXR0cmlidXRlLmJ5dGVTdHJpZGUsXG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgYSA9IGFjY2Vzc29yc1thY2Nlc3NvcklkXTtcbiAgICAgICAgICB2YXIgbm9ybWFsaXplID0gZGVmaW5lZChhLm5vcm1hbGl6ZWQpICYmIGEubm9ybWFsaXplZDtcbiAgICAgICAgICBhdHRyaWJ1dGVzLnB1c2goe1xuICAgICAgICAgICAgaW5kZXg6IGF0dHJpYnV0ZUxvY2F0aW9uLFxuICAgICAgICAgICAgdmVydGV4QnVmZmVyOiByZW5kZXJlckJ1ZmZlcnNbYS5idWZmZXJWaWV3XSxcbiAgICAgICAgICAgIGNvbXBvbmVudHNQZXJBdHRyaWJ1dGU6IG51bWJlck9mQ29tcG9uZW50c0ZvclR5cGUoYS50eXBlKSxcbiAgICAgICAgICAgIGNvbXBvbmVudERhdGF0eXBlOiBhLmNvbXBvbmVudFR5cGUsXG4gICAgICAgICAgICBub3JtYWxpemU6IG5vcm1hbGl6ZSxcbiAgICAgICAgICAgIG9mZnNldEluQnl0ZXM6IGEuYnl0ZU9mZnNldCxcbiAgICAgICAgICAgIHN0cmlkZUluQnl0ZXM6IGdldEFjY2Vzc29yQnl0ZVN0cmlkZShnbHRmLCBhKSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIEFkZCBwcmUtY3JlYXRlZCBhdHRyaWJ1dGVzXG4gICAgICB2YXIgYXR0cmlidXRlO1xuICAgICAgdmFyIGF0dHJpYnV0ZU5hbWU7XG4gICAgICB2YXIgcHJlY3JlYXRlZEF0dHJpYnV0ZXMgPSBtb2RlbC5fcHJlY3JlYXRlZEF0dHJpYnV0ZXM7XG4gICAgICBpZiAoZGVmaW5lZChwcmVjcmVhdGVkQXR0cmlidXRlcykpIHtcbiAgICAgICAgZm9yIChhdHRyaWJ1dGVOYW1lIGluIHByZWNyZWF0ZWRBdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgaWYgKHByZWNyZWF0ZWRBdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KGF0dHJpYnV0ZU5hbWUpKSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVMb2NhdGlvbiA9IGF0dHJpYnV0ZUxvY2F0aW9uc1thdHRyaWJ1dGVOYW1lXTtcbiAgICAgICAgICAgIGlmIChkZWZpbmVkKGF0dHJpYnV0ZUxvY2F0aW9uKSkge1xuICAgICAgICAgICAgICBhdHRyaWJ1dGUgPSBwcmVjcmVhdGVkQXR0cmlidXRlc1thdHRyaWJ1dGVOYW1lXTtcbiAgICAgICAgICAgICAgYXR0cmlidXRlLmluZGV4ID0gYXR0cmlidXRlTG9jYXRpb247XG4gICAgICAgICAgICAgIGF0dHJpYnV0ZXMucHVzaChhdHRyaWJ1dGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB2YXIgaW5kZXhCdWZmZXI7XG4gICAgICBpZiAoZGVmaW5lZChwcmltaXRpdmUuaW5kaWNlcykpIHtcbiAgICAgICAgdmFyIGFjY2Vzc29yID0gYWNjZXNzb3JzW3ByaW1pdGl2ZS5pbmRpY2VzXTtcbiAgICAgICAgdmFyIGJ1ZmZlclZpZXcgPSBhY2Nlc3Nvci5idWZmZXJWaWV3O1xuXG4gICAgICAgIC8vIFVzZSBidWZmZXIgb2YgcHJldmlvdXNseSBkZWNvZGVkIGRyYWNvIGdlb21ldHJ5XG4gICAgICAgIGlmIChkZWZpbmVkKGRlY29kZWREYXRhKSkge1xuICAgICAgICAgIGJ1ZmZlclZpZXcgPSBkZWNvZGVkRGF0YS5idWZmZXJWaWV3O1xuICAgICAgICB9XG5cbiAgICAgICAgaW5kZXhCdWZmZXIgPSByZW5kZXJlckJ1ZmZlcnNbYnVmZmVyVmlld107XG4gICAgICB9XG4gICAgICByZW5kZXJlclZlcnRleEFycmF5c1tcbiAgICAgICAgbWVzaElkICsgXCIucHJpbWl0aXZlLlwiICsgcHJpbWl0aXZlSWRcbiAgICAgIF0gPSBuZXcgVmVydGV4QXJyYXkoe1xuICAgICAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgICAgICBhdHRyaWJ1dGVzOiBhdHRyaWJ1dGVzLFxuICAgICAgICBpbmRleEJ1ZmZlcjogaW5kZXhCdWZmZXIsXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVJlbmRlclN0YXRlcyhtb2RlbCkge1xuICB2YXIgbG9hZFJlc291cmNlcyA9IG1vZGVsLl9sb2FkUmVzb3VyY2VzO1xuICBpZiAobG9hZFJlc291cmNlcy5jcmVhdGVSZW5kZXJTdGF0ZXMpIHtcbiAgICBsb2FkUmVzb3VyY2VzLmNyZWF0ZVJlbmRlclN0YXRlcyA9IGZhbHNlO1xuXG4gICAgRm9yRWFjaC5tYXRlcmlhbChtb2RlbC5nbHRmLCBmdW5jdGlvbiAobWF0ZXJpYWwsIG1hdGVyaWFsSWQpIHtcbiAgICAgIGNyZWF0ZVJlbmRlclN0YXRlRm9yTWF0ZXJpYWwobW9kZWwsIG1hdGVyaWFsLCBtYXRlcmlhbElkKTtcbiAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVSZW5kZXJTdGF0ZUZvck1hdGVyaWFsKG1vZGVsLCBtYXRlcmlhbCwgbWF0ZXJpYWxJZCkge1xuICB2YXIgcmVuZGVyZXJSZW5kZXJTdGF0ZXMgPSBtb2RlbC5fcmVuZGVyZXJSZXNvdXJjZXMucmVuZGVyU3RhdGVzO1xuXG4gIHZhciBibGVuZEVxdWF0aW9uU2VwYXJhdGUgPSBbXG4gICAgV2ViR0xDb25zdGFudHMuRlVOQ19BREQsXG4gICAgV2ViR0xDb25zdGFudHMuRlVOQ19BREQsXG4gIF07XG4gIHZhciBibGVuZEZ1bmNTZXBhcmF0ZSA9IFtcbiAgICBXZWJHTENvbnN0YW50cy5PTkUsXG4gICAgV2ViR0xDb25zdGFudHMuT05FX01JTlVTX1NSQ19BTFBIQSxcbiAgICBXZWJHTENvbnN0YW50cy5PTkUsXG4gICAgV2ViR0xDb25zdGFudHMuT05FX01JTlVTX1NSQ19BTFBIQSxcbiAgXTtcblxuICBpZiAoZGVmaW5lZChtYXRlcmlhbC5leHRlbnNpb25zKSAmJiBkZWZpbmVkKG1hdGVyaWFsLmV4dGVuc2lvbnMuS0hSX2JsZW5kKSkge1xuICAgIGJsZW5kRXF1YXRpb25TZXBhcmF0ZSA9IG1hdGVyaWFsLmV4dGVuc2lvbnMuS0hSX2JsZW5kLmJsZW5kRXF1YXRpb247XG4gICAgYmxlbmRGdW5jU2VwYXJhdGUgPSBtYXRlcmlhbC5leHRlbnNpb25zLktIUl9ibGVuZC5ibGVuZEZhY3RvcnM7XG4gIH1cblxuICB2YXIgZW5hYmxlQ3VsbGluZyA9ICFtYXRlcmlhbC5kb3VibGVTaWRlZDtcbiAgdmFyIGJsZW5kaW5nRW5hYmxlZCA9IG1hdGVyaWFsLmFscGhhTW9kZSA9PT0gXCJCTEVORFwiO1xuICByZW5kZXJlclJlbmRlclN0YXRlc1ttYXRlcmlhbElkXSA9IFJlbmRlclN0YXRlLmZyb21DYWNoZSh7XG4gICAgY3VsbDoge1xuICAgICAgZW5hYmxlZDogZW5hYmxlQ3VsbGluZyxcbiAgICB9LFxuICAgIGRlcHRoVGVzdDoge1xuICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgIGZ1bmM6IERlcHRoRnVuY3Rpb24uTEVTU19PUl9FUVVBTCxcbiAgICB9LFxuICAgIGRlcHRoTWFzazogIWJsZW5kaW5nRW5hYmxlZCxcbiAgICBibGVuZGluZzoge1xuICAgICAgZW5hYmxlZDogYmxlbmRpbmdFbmFibGVkLFxuICAgICAgZXF1YXRpb25SZ2I6IGJsZW5kRXF1YXRpb25TZXBhcmF0ZVswXSxcbiAgICAgIGVxdWF0aW9uQWxwaGE6IGJsZW5kRXF1YXRpb25TZXBhcmF0ZVsxXSxcbiAgICAgIGZ1bmN0aW9uU291cmNlUmdiOiBibGVuZEZ1bmNTZXBhcmF0ZVswXSxcbiAgICAgIGZ1bmN0aW9uRGVzdGluYXRpb25SZ2I6IGJsZW5kRnVuY1NlcGFyYXRlWzFdLFxuICAgICAgZnVuY3Rpb25Tb3VyY2VBbHBoYTogYmxlbmRGdW5jU2VwYXJhdGVbMl0sXG4gICAgICBmdW5jdGlvbkRlc3RpbmF0aW9uQWxwaGE6IGJsZW5kRnVuY1NlcGFyYXRlWzNdLFxuICAgIH0sXG4gIH0pO1xufVxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxudmFyIGdsdGZVbmlmb3Jtc0Zyb21Ob2RlID0ge1xuICBNT0RFTDogZnVuY3Rpb24gKHVuaWZvcm1TdGF0ZSwgbW9kZWwsIHJ1bnRpbWVOb2RlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBydW50aW1lTm9kZS5jb21wdXRlZE1hdHJpeDtcbiAgICB9O1xuICB9LFxuICBWSUVXOiBmdW5jdGlvbiAodW5pZm9ybVN0YXRlLCBtb2RlbCwgcnVudGltZU5vZGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHVuaWZvcm1TdGF0ZS52aWV3O1xuICAgIH07XG4gIH0sXG4gIFBST0pFQ1RJT046IGZ1bmN0aW9uICh1bmlmb3JtU3RhdGUsIG1vZGVsLCBydW50aW1lTm9kZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdW5pZm9ybVN0YXRlLnByb2plY3Rpb247XG4gICAgfTtcbiAgfSxcbiAgTU9ERUxWSUVXOiBmdW5jdGlvbiAodW5pZm9ybVN0YXRlLCBtb2RlbCwgcnVudGltZU5vZGUpIHtcbiAgICB2YXIgbXYgPSBuZXcgTWF0cml4NCgpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gTWF0cml4NC5tdWx0aXBseVRyYW5zZm9ybWF0aW9uKFxuICAgICAgICB1bmlmb3JtU3RhdGUudmlldyxcbiAgICAgICAgcnVudGltZU5vZGUuY29tcHV0ZWRNYXRyaXgsXG4gICAgICAgIG12XG4gICAgICApO1xuICAgIH07XG4gIH0sXG4gIENFU0lVTV9SVENfTU9ERUxWSUVXOiBmdW5jdGlvbiAodW5pZm9ybVN0YXRlLCBtb2RlbCwgcnVudGltZU5vZGUpIHtcbiAgICAvLyBDRVNJVU1fUlRDIGV4dGVuc2lvblxuICAgIHZhciBtdlJ0YyA9IG5ldyBNYXRyaXg0KCk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIE1hdHJpeDQubXVsdGlwbHlUcmFuc2Zvcm1hdGlvbihcbiAgICAgICAgdW5pZm9ybVN0YXRlLnZpZXcsXG4gICAgICAgIHJ1bnRpbWVOb2RlLmNvbXB1dGVkTWF0cml4LFxuICAgICAgICBtdlJ0Y1xuICAgICAgKTtcbiAgICAgIHJldHVybiBNYXRyaXg0LnNldFRyYW5zbGF0aW9uKG12UnRjLCBtb2RlbC5fcnRjQ2VudGVyRXllLCBtdlJ0Yyk7XG4gICAgfTtcbiAgfSxcbiAgTU9ERUxWSUVXUFJPSkVDVElPTjogZnVuY3Rpb24gKHVuaWZvcm1TdGF0ZSwgbW9kZWwsIHJ1bnRpbWVOb2RlKSB7XG4gICAgdmFyIG12cCA9IG5ldyBNYXRyaXg0KCk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIE1hdHJpeDQubXVsdGlwbHlUcmFuc2Zvcm1hdGlvbihcbiAgICAgICAgdW5pZm9ybVN0YXRlLnZpZXcsXG4gICAgICAgIHJ1bnRpbWVOb2RlLmNvbXB1dGVkTWF0cml4LFxuICAgICAgICBtdnBcbiAgICAgICk7XG4gICAgICByZXR1cm4gTWF0cml4NC5tdWx0aXBseSh1bmlmb3JtU3RhdGUuX3Byb2plY3Rpb24sIG12cCwgbXZwKTtcbiAgICB9O1xuICB9LFxuICBNT0RFTElOVkVSU0U6IGZ1bmN0aW9uICh1bmlmb3JtU3RhdGUsIG1vZGVsLCBydW50aW1lTm9kZSkge1xuICAgIHZhciBtSW52ZXJzZSA9IG5ldyBNYXRyaXg0KCk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBNYXRyaXg0LmludmVyc2UocnVudGltZU5vZGUuY29tcHV0ZWRNYXRyaXgsIG1JbnZlcnNlKTtcbiAgICB9O1xuICB9LFxuICBWSUVXSU5WRVJTRTogZnVuY3Rpb24gKHVuaWZvcm1TdGF0ZSwgbW9kZWwpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHVuaWZvcm1TdGF0ZS5pbnZlcnNlVmlldztcbiAgICB9O1xuICB9LFxuICBQUk9KRUNUSU9OSU5WRVJTRTogZnVuY3Rpb24gKHVuaWZvcm1TdGF0ZSwgbW9kZWwsIHJ1bnRpbWVOb2RlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB1bmlmb3JtU3RhdGUuaW52ZXJzZVByb2plY3Rpb247XG4gICAgfTtcbiAgfSxcbiAgTU9ERUxWSUVXSU5WRVJTRTogZnVuY3Rpb24gKHVuaWZvcm1TdGF0ZSwgbW9kZWwsIHJ1bnRpbWVOb2RlKSB7XG4gICAgdmFyIG12ID0gbmV3IE1hdHJpeDQoKTtcbiAgICB2YXIgbXZJbnZlcnNlID0gbmV3IE1hdHJpeDQoKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgTWF0cml4NC5tdWx0aXBseVRyYW5zZm9ybWF0aW9uKFxuICAgICAgICB1bmlmb3JtU3RhdGUudmlldyxcbiAgICAgICAgcnVudGltZU5vZGUuY29tcHV0ZWRNYXRyaXgsXG4gICAgICAgIG12XG4gICAgICApO1xuICAgICAgcmV0dXJuIE1hdHJpeDQuaW52ZXJzZShtdiwgbXZJbnZlcnNlKTtcbiAgICB9O1xuICB9LFxuICBNT0RFTFZJRVdQUk9KRUNUSU9OSU5WRVJTRTogZnVuY3Rpb24gKHVuaWZvcm1TdGF0ZSwgbW9kZWwsIHJ1bnRpbWVOb2RlKSB7XG4gICAgdmFyIG12cCA9IG5ldyBNYXRyaXg0KCk7XG4gICAgdmFyIG12cEludmVyc2UgPSBuZXcgTWF0cml4NCgpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICBNYXRyaXg0Lm11bHRpcGx5VHJhbnNmb3JtYXRpb24oXG4gICAgICAgIHVuaWZvcm1TdGF0ZS52aWV3LFxuICAgICAgICBydW50aW1lTm9kZS5jb21wdXRlZE1hdHJpeCxcbiAgICAgICAgbXZwXG4gICAgICApO1xuICAgICAgTWF0cml4NC5tdWx0aXBseSh1bmlmb3JtU3RhdGUuX3Byb2plY3Rpb24sIG12cCwgbXZwKTtcbiAgICAgIHJldHVybiBNYXRyaXg0LmludmVyc2UobXZwLCBtdnBJbnZlcnNlKTtcbiAgICB9O1xuICB9LFxuICBNT0RFTElOVkVSU0VUUkFOU1BPU0U6IGZ1bmN0aW9uICh1bmlmb3JtU3RhdGUsIG1vZGVsLCBydW50aW1lTm9kZSkge1xuICAgIHZhciBtSW52ZXJzZSA9IG5ldyBNYXRyaXg0KCk7XG4gICAgdmFyIG1JbnZlcnNlVHJhbnNwb3NlID0gbmV3IE1hdHJpeDMoKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgTWF0cml4NC5pbnZlcnNlKHJ1bnRpbWVOb2RlLmNvbXB1dGVkTWF0cml4LCBtSW52ZXJzZSk7XG4gICAgICBNYXRyaXg0LmdldE1hdHJpeDMobUludmVyc2UsIG1JbnZlcnNlVHJhbnNwb3NlKTtcbiAgICAgIHJldHVybiBNYXRyaXgzLnRyYW5zcG9zZShtSW52ZXJzZVRyYW5zcG9zZSwgbUludmVyc2VUcmFuc3Bvc2UpO1xuICAgIH07XG4gIH0sXG4gIE1PREVMVklFV0lOVkVSU0VUUkFOU1BPU0U6IGZ1bmN0aW9uICh1bmlmb3JtU3RhdGUsIG1vZGVsLCBydW50aW1lTm9kZSkge1xuICAgIHZhciBtdiA9IG5ldyBNYXRyaXg0KCk7XG4gICAgdmFyIG12SW52ZXJzZSA9IG5ldyBNYXRyaXg0KCk7XG4gICAgdmFyIG12SW52ZXJzZVRyYW5zcG9zZSA9IG5ldyBNYXRyaXgzKCk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIE1hdHJpeDQubXVsdGlwbHlUcmFuc2Zvcm1hdGlvbihcbiAgICAgICAgdW5pZm9ybVN0YXRlLnZpZXcsXG4gICAgICAgIHJ1bnRpbWVOb2RlLmNvbXB1dGVkTWF0cml4LFxuICAgICAgICBtdlxuICAgICAgKTtcbiAgICAgIE1hdHJpeDQuaW52ZXJzZShtdiwgbXZJbnZlcnNlKTtcbiAgICAgIE1hdHJpeDQuZ2V0TWF0cml4MyhtdkludmVyc2UsIG12SW52ZXJzZVRyYW5zcG9zZSk7XG4gICAgICByZXR1cm4gTWF0cml4My50cmFuc3Bvc2UobXZJbnZlcnNlVHJhbnNwb3NlLCBtdkludmVyc2VUcmFuc3Bvc2UpO1xuICAgIH07XG4gIH0sXG4gIFZJRVdQT1JUOiBmdW5jdGlvbiAodW5pZm9ybVN0YXRlLCBtb2RlbCwgcnVudGltZU5vZGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHVuaWZvcm1TdGF0ZS52aWV3cG9ydENhcnRlc2lhbjQ7XG4gICAgfTtcbiAgfSxcbn07XG5cbmZ1bmN0aW9uIGdldFVuaWZvcm1GdW5jdGlvbkZyb21Tb3VyY2Uoc291cmNlLCBtb2RlbCwgc2VtYW50aWMsIHVuaWZvcm1TdGF0ZSkge1xuICB2YXIgcnVudGltZU5vZGUgPSBtb2RlbC5fcnVudGltZS5ub2Rlc1tzb3VyY2VdO1xuICByZXR1cm4gZ2x0ZlVuaWZvcm1zRnJvbU5vZGVbc2VtYW50aWNdKHVuaWZvcm1TdGF0ZSwgbW9kZWwsIHJ1bnRpbWVOb2RlKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlVW5pZm9ybXNGb3JNYXRlcmlhbChcbiAgbW9kZWwsXG4gIG1hdGVyaWFsLFxuICB0ZWNobmlxdWUsXG4gIGluc3RhbmNlVmFsdWVzLFxuICBjb250ZXh0LFxuICB0ZXh0dXJlcyxcbiAgZGVmYXVsdFRleHR1cmVcbikge1xuICB2YXIgdW5pZm9ybU1hcCA9IHt9O1xuICB2YXIgdW5pZm9ybVZhbHVlcyA9IHt9O1xuICB2YXIgam9pbnRNYXRyaXhVbmlmb3JtTmFtZTtcbiAgdmFyIG1vcnBoV2VpZ2h0c1VuaWZvcm1OYW1lO1xuXG4gIEZvckVhY2gudGVjaG5pcXVlVW5pZm9ybSh0ZWNobmlxdWUsIGZ1bmN0aW9uICh1bmlmb3JtLCB1bmlmb3JtTmFtZSkge1xuICAgIC8vIEdMVEZfU1BFQzogVGhpcyBkb2VzIG5vdCB0YWtlIGludG8gYWNjb3VudCB1bmlmb3JtIGFycmF5cyxcbiAgICAvLyBpbmRpY2F0ZWQgYnkgdW5pZm9ybXMgd2l0aCBhIGNvdW50IHByb3BlcnR5LlxuICAgIC8vXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL0tocm9ub3NHcm91cC9nbFRGL2lzc3Vlcy8yNThcblxuICAgIC8vIEdMVEZfU1BFQzogSW4gdGhpcyBpbXBsZW1lbnRhdGlvbiwgbWF0ZXJpYWwgcGFyYW1ldGVycyB3aXRoIGFcbiAgICAvLyBzZW1hbnRpYyBvciB0YXJnZXRlZCB2aWEgYSBzb3VyY2UgKGZvciBhbmltYXRpb24pIGFyZSBub3RcbiAgICAvLyB0YXJnZXRhYmxlIGZvciBtYXRlcmlhbCBhbmltYXRpb25zLiAgSXMgdGhpcyB0b28gc3RyaWN0P1xuICAgIC8vXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL0tocm9ub3NHcm91cC9nbFRGL2lzc3Vlcy8xNDJcblxuICAgIHZhciB1djtcbiAgICBpZiAoZGVmaW5lZChpbnN0YW5jZVZhbHVlcykgJiYgZGVmaW5lZChpbnN0YW5jZVZhbHVlc1t1bmlmb3JtTmFtZV0pKSB7XG4gICAgICAvLyBQYXJhbWV0ZXIgb3ZlcnJpZGVzIGJ5IHRoZSBpbnN0YW5jZSB0ZWNobmlxdWVcbiAgICAgIHV2ID0gTW9kZWxVdGlsaXR5LmNyZWF0ZVVuaWZvcm1GdW5jdGlvbihcbiAgICAgICAgdW5pZm9ybS50eXBlLFxuICAgICAgICBpbnN0YW5jZVZhbHVlc1t1bmlmb3JtTmFtZV0sXG4gICAgICAgIHRleHR1cmVzLFxuICAgICAgICBkZWZhdWx0VGV4dHVyZVxuICAgICAgKTtcbiAgICAgIHVuaWZvcm1NYXBbdW5pZm9ybU5hbWVdID0gdXYuZnVuYztcbiAgICAgIHVuaWZvcm1WYWx1ZXNbdW5pZm9ybU5hbWVdID0gdXY7XG4gICAgfSBlbHNlIGlmIChkZWZpbmVkKHVuaWZvcm0ubm9kZSkpIHtcbiAgICAgIHVuaWZvcm1NYXBbdW5pZm9ybU5hbWVdID0gZ2V0VW5pZm9ybUZ1bmN0aW9uRnJvbVNvdXJjZShcbiAgICAgICAgdW5pZm9ybS5ub2RlLFxuICAgICAgICBtb2RlbCxcbiAgICAgICAgdW5pZm9ybS5zZW1hbnRpYyxcbiAgICAgICAgY29udGV4dC51bmlmb3JtU3RhdGVcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmIChkZWZpbmVkKHVuaWZvcm0uc2VtYW50aWMpKSB7XG4gICAgICBpZiAodW5pZm9ybS5zZW1hbnRpYyA9PT0gXCJKT0lOVE1BVFJJWFwiKSB7XG4gICAgICAgIGpvaW50TWF0cml4VW5pZm9ybU5hbWUgPSB1bmlmb3JtTmFtZTtcbiAgICAgIH0gZWxzZSBpZiAodW5pZm9ybS5zZW1hbnRpYyA9PT0gXCJNT1JQSFdFSUdIVFNcIikge1xuICAgICAgICBtb3JwaFdlaWdodHNVbmlmb3JtTmFtZSA9IHVuaWZvcm1OYW1lO1xuICAgICAgfSBlbHNlIGlmICh1bmlmb3JtLnNlbWFudGljID09PSBcIkFMUEhBQ1VUT0ZGXCIpIHtcbiAgICAgICAgLy8gVGhlIG1hdGVyaWFsJ3MgYWxwaGFDdXRvZmYgdmFsdWUgdXNlcyBhIHVuaWZvcm0gd2l0aCBzZW1hbnRpYyBBTFBIQUNVVE9GRi5cbiAgICAgICAgLy8gQSB1bmlmb3JtIHdpdGggdGhpcyBzZW1hbnRpYyB3aWxsIGlnbm9yZSB0aGUgaW5zdGFuY2Ugb3IgZGVmYXVsdCB2YWx1ZXMuXG4gICAgICAgIHZhciBhbHBoYU1vZGUgPSBtYXRlcmlhbC5hbHBoYU1vZGU7XG4gICAgICAgIGlmIChkZWZpbmVkKGFscGhhTW9kZSkgJiYgYWxwaGFNb2RlID09PSBcIk1BU0tcIikge1xuICAgICAgICAgIHZhciBhbHBoYUN1dG9mZlZhbHVlID0gZGVmYXVsdFZhbHVlKG1hdGVyaWFsLmFscGhhQ3V0b2ZmLCAwLjUpO1xuICAgICAgICAgIHV2ID0gTW9kZWxVdGlsaXR5LmNyZWF0ZVVuaWZvcm1GdW5jdGlvbihcbiAgICAgICAgICAgIHVuaWZvcm0udHlwZSxcbiAgICAgICAgICAgIGFscGhhQ3V0b2ZmVmFsdWUsXG4gICAgICAgICAgICB0ZXh0dXJlcyxcbiAgICAgICAgICAgIGRlZmF1bHRUZXh0dXJlXG4gICAgICAgICAgKTtcbiAgICAgICAgICB1bmlmb3JtTWFwW3VuaWZvcm1OYW1lXSA9IHV2LmZ1bmM7XG4gICAgICAgICAgdW5pZm9ybVZhbHVlc1t1bmlmb3JtTmFtZV0gPSB1djtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gTWFwIGdsVEYgc2VtYW50aWMgdG8gQ2VzaXVtIGF1dG9tYXRpYyB1bmlmb3JtXG4gICAgICAgIHVuaWZvcm1NYXBbdW5pZm9ybU5hbWVdID0gTW9kZWxVdGlsaXR5LmdldEdsdGZTZW1hbnRpY1VuaWZvcm1zKClbXG4gICAgICAgICAgdW5pZm9ybS5zZW1hbnRpY1xuICAgICAgICBdKGNvbnRleHQudW5pZm9ybVN0YXRlLCBtb2RlbCk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChkZWZpbmVkKHVuaWZvcm0udmFsdWUpKSB7XG4gICAgICAvLyBUZWNobmlxdWUgdmFsdWUgdGhhdCBpc24ndCBvdmVycmlkZGVuIGJ5IGEgbWF0ZXJpYWxcbiAgICAgIHZhciB1djIgPSBNb2RlbFV0aWxpdHkuY3JlYXRlVW5pZm9ybUZ1bmN0aW9uKFxuICAgICAgICB1bmlmb3JtLnR5cGUsXG4gICAgICAgIHVuaWZvcm0udmFsdWUsXG4gICAgICAgIHRleHR1cmVzLFxuICAgICAgICBkZWZhdWx0VGV4dHVyZVxuICAgICAgKTtcbiAgICAgIHVuaWZvcm1NYXBbdW5pZm9ybU5hbWVdID0gdXYyLmZ1bmM7XG4gICAgICB1bmlmb3JtVmFsdWVzW3VuaWZvcm1OYW1lXSA9IHV2MjtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgbWFwOiB1bmlmb3JtTWFwLFxuICAgIHZhbHVlczogdW5pZm9ybVZhbHVlcyxcbiAgICBqb2ludE1hdHJpeFVuaWZvcm1OYW1lOiBqb2ludE1hdHJpeFVuaWZvcm1OYW1lLFxuICAgIG1vcnBoV2VpZ2h0c1VuaWZvcm1OYW1lOiBtb3JwaFdlaWdodHNVbmlmb3JtTmFtZSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlVW5pZm9ybU1hcHMobW9kZWwsIGNvbnRleHQpIHtcbiAgdmFyIGxvYWRSZXNvdXJjZXMgPSBtb2RlbC5fbG9hZFJlc291cmNlcztcblxuICBpZiAoIWxvYWRSZXNvdXJjZXMuZmluaXNoZWRQcm9ncmFtQ3JlYXRpb24oKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICghbG9hZFJlc291cmNlcy5jcmVhdGVVbmlmb3JtTWFwcykge1xuICAgIHJldHVybjtcbiAgfVxuICBsb2FkUmVzb3VyY2VzLmNyZWF0ZVVuaWZvcm1NYXBzID0gZmFsc2U7XG5cbiAgdmFyIGdsdGYgPSBtb2RlbC5nbHRmO1xuICB2YXIgdGVjaG5pcXVlcyA9IG1vZGVsLl9zb3VyY2VUZWNobmlxdWVzO1xuICB2YXIgdW5pZm9ybU1hcHMgPSBtb2RlbC5fdW5pZm9ybU1hcHM7XG5cbiAgdmFyIHRleHR1cmVzID0gbW9kZWwuX3JlbmRlcmVyUmVzb3VyY2VzLnRleHR1cmVzO1xuICB2YXIgZGVmYXVsdFRleHR1cmUgPSBtb2RlbC5fZGVmYXVsdFRleHR1cmU7XG5cbiAgRm9yRWFjaC5tYXRlcmlhbChnbHRmLCBmdW5jdGlvbiAobWF0ZXJpYWwsIG1hdGVyaWFsSWQpIHtcbiAgICB2YXIgbW9kZWxNYXRlcmlhbCA9IG1vZGVsLl9ydW50aW1lLm1hdGVyaWFsc0J5SWRbbWF0ZXJpYWxJZF07XG4gICAgdmFyIHRlY2huaXF1ZSA9IHRlY2huaXF1ZXNbbW9kZWxNYXRlcmlhbC5fdGVjaG5pcXVlXTtcbiAgICB2YXIgaW5zdGFuY2VWYWx1ZXMgPSBtb2RlbE1hdGVyaWFsLl92YWx1ZXM7XG5cbiAgICB2YXIgdW5pZm9ybXMgPSBjcmVhdGVVbmlmb3Jtc0Zvck1hdGVyaWFsKFxuICAgICAgbW9kZWwsXG4gICAgICBtYXRlcmlhbCxcbiAgICAgIHRlY2huaXF1ZSxcbiAgICAgIGluc3RhbmNlVmFsdWVzLFxuICAgICAgY29udGV4dCxcbiAgICAgIHRleHR1cmVzLFxuICAgICAgZGVmYXVsdFRleHR1cmVcbiAgICApO1xuXG4gICAgdmFyIHUgPSB1bmlmb3JtTWFwc1ttYXRlcmlhbElkXTtcbiAgICB1LnVuaWZvcm1NYXAgPSB1bmlmb3Jtcy5tYXA7IC8vIHVuaWZvcm0gbmFtZSAtPiBmdW5jdGlvbiBmb3IgdGhlIHJlbmRlcmVyXG4gICAgdS52YWx1ZXMgPSB1bmlmb3Jtcy52YWx1ZXM7IC8vIG1hdGVyaWFsIHBhcmFtZXRlciBuYW1lIC0+IE1vZGVsTWF0ZXJpYWwgZm9yIG1vZGlmeWluZyB0aGUgcGFyYW1ldGVyIGF0IHJ1bnRpbWVcbiAgICB1LmpvaW50TWF0cml4VW5pZm9ybU5hbWUgPSB1bmlmb3Jtcy5qb2ludE1hdHJpeFVuaWZvcm1OYW1lO1xuICAgIHUubW9ycGhXZWlnaHRzVW5pZm9ybU5hbWUgPSB1bmlmb3Jtcy5tb3JwaFdlaWdodHNVbmlmb3JtTmFtZTtcblxuICAgIGlmIChkZWZpbmVkKHRlY2huaXF1ZS5hdHRyaWJ1dGVzLmFfb3V0bGluZUNvb3JkaW5hdGVzKSkge1xuICAgICAgdmFyIG91dGxpbmVUZXh0dXJlID0gTW9kZWxPdXRsaW5lTG9hZGVyLmNyZWF0ZVRleHR1cmUobW9kZWwsIGNvbnRleHQpO1xuICAgICAgdS51bmlmb3JtTWFwLnVfb3V0bGluZVRleHR1cmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBvdXRsaW5lVGV4dHVyZTtcbiAgICAgIH07XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlVW5pZm9ybXNGb3JEcmFjb1F1YW50aXplZEF0dHJpYnV0ZXMoZGVjb2RlZERhdGEpIHtcbiAgcmV0dXJuIE1vZGVsVXRpbGl0eS5jcmVhdGVVbmlmb3Jtc0ZvckRyYWNvUXVhbnRpemVkQXR0cmlidXRlcyhcbiAgICBkZWNvZGVkRGF0YS5hdHRyaWJ1dGVzXG4gICk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVVuaWZvcm1zRm9yUXVhbnRpemVkQXR0cmlidXRlcyhtb2RlbCwgcHJpbWl0aXZlKSB7XG4gIHZhciBwcm9ncmFtSWQgPSBnZXRQcm9ncmFtRm9yUHJpbWl0aXZlKG1vZGVsLCBwcmltaXRpdmUpO1xuICB2YXIgcXVhbnRpemVkVW5pZm9ybXMgPSBtb2RlbC5fcXVhbnRpemVkVW5pZm9ybXNbcHJvZ3JhbUlkXTtcbiAgcmV0dXJuIE1vZGVsVXRpbGl0eS5jcmVhdGVVbmlmb3Jtc0ZvclF1YW50aXplZEF0dHJpYnV0ZXMoXG4gICAgbW9kZWwuZ2x0ZixcbiAgICBwcmltaXRpdmUsXG4gICAgcXVhbnRpemVkVW5pZm9ybXNcbiAgKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlUGlja0NvbG9yRnVuY3Rpb24oY29sb3IpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gY29sb3I7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUpvaW50TWF0cmljZXNGdW5jdGlvbihydW50aW1lTm9kZSkge1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBydW50aW1lTm9kZS5jb21wdXRlZEpvaW50TWF0cmljZXM7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZU1vcnBoV2VpZ2h0c0Z1bmN0aW9uKHJ1bnRpbWVOb2RlKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHJ1bnRpbWVOb2RlLndlaWdodHM7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVNpbGhvdWV0dGVDb2xvckZ1bmN0aW9uKG1vZGVsKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG1vZGVsLnNpbGhvdWV0dGVDb2xvcjtcbiAgfTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlU2lsaG91ZXR0ZVNpemVGdW5jdGlvbihtb2RlbCkge1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBtb2RlbC5zaWxob3VldHRlU2l6ZTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ29sb3JGdW5jdGlvbihtb2RlbCkge1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBtb2RlbC5jb2xvcjtcbiAgfTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ2xpcHBpbmdQbGFuZXNNYXRyaXhGdW5jdGlvbihtb2RlbCkge1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBtb2RlbC5fY2xpcHBpbmdQbGFuZXNNYXRyaXg7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUlCTFJlZmVyZW5jZUZyYW1lTWF0cml4RnVuY3Rpb24obW9kZWwpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbW9kZWwuX2libFJlZmVyZW5jZUZyYW1lTWF0cml4O1xuICB9O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVDbGlwcGluZ1BsYW5lc0Z1bmN0aW9uKG1vZGVsKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGNsaXBwaW5nUGxhbmVzID0gbW9kZWwuY2xpcHBpbmdQbGFuZXM7XG4gICAgcmV0dXJuICFkZWZpbmVkKGNsaXBwaW5nUGxhbmVzKSB8fCAhY2xpcHBpbmdQbGFuZXMuZW5hYmxlZFxuICAgICAgPyBtb2RlbC5fZGVmYXVsdFRleHR1cmVcbiAgICAgIDogY2xpcHBpbmdQbGFuZXMudGV4dHVyZTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ2xpcHBpbmdQbGFuZXNFZGdlU3R5bGVGdW5jdGlvbihtb2RlbCkge1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHZhciBjbGlwcGluZ1BsYW5lcyA9IG1vZGVsLmNsaXBwaW5nUGxhbmVzO1xuICAgIGlmICghZGVmaW5lZChjbGlwcGluZ1BsYW5lcykpIHtcbiAgICAgIHJldHVybiBDb2xvci5XSElURS53aXRoQWxwaGEoMC4wKTtcbiAgICB9XG5cbiAgICB2YXIgc3R5bGUgPSBDb2xvci5jbG9uZShjbGlwcGluZ1BsYW5lcy5lZGdlQ29sb3IpO1xuICAgIHN0eWxlLmFscGhhID0gY2xpcHBpbmdQbGFuZXMuZWRnZVdpZHRoO1xuICAgIHJldHVybiBzdHlsZTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ29sb3JCbGVuZEZ1bmN0aW9uKG1vZGVsKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIENvbG9yQmxlbmRNb2RlLmdldENvbG9yQmxlbmQoXG4gICAgICBtb2RlbC5jb2xvckJsZW5kTW9kZSxcbiAgICAgIG1vZGVsLmNvbG9yQmxlbmRBbW91bnRcbiAgICApO1xuICB9O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVJQkxGYWN0b3JGdW5jdGlvbihtb2RlbCkge1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBtb2RlbC5faW1hZ2VCYXNlZExpZ2h0aW5nRmFjdG9yO1xuICB9O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVMaWdodENvbG9yRnVuY3Rpb24obW9kZWwpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbW9kZWwuX2xpZ2h0Q29sb3I7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUx1bWluYW5jZUF0WmVuaXRoRnVuY3Rpb24obW9kZWwpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbW9kZWwubHVtaW5hbmNlQXRaZW5pdGg7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVNwaGVyaWNhbEhhcm1vbmljQ29lZmZpY2llbnRzRnVuY3Rpb24obW9kZWwpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbW9kZWwuX3NwaGVyaWNhbEhhcm1vbmljQ29lZmZpY2llbnRzO1xuICB9O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVTcGVjdWxhckVudmlyb25tZW50TWFwRnVuY3Rpb24obW9kZWwpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbW9kZWwuX3NwZWN1bGFyRW52aXJvbm1lbnRNYXBBdGxhcy50ZXh0dXJlO1xuICB9O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVTcGVjdWxhckVudmlyb25tZW50TWFwU2l6ZUZ1bmN0aW9uKG1vZGVsKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG1vZGVsLl9zcGVjdWxhckVudmlyb25tZW50TWFwQXRsYXMudGV4dHVyZS5kaW1lbnNpb25zO1xuICB9O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVTcGVjdWxhckVudmlyb25tZW50TWFwTE9EKG1vZGVsKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG1vZGVsLl9zcGVjdWxhckVudmlyb25tZW50TWFwQXRsYXMubWF4aW11bU1pcG1hcExldmVsO1xuICB9O1xufVxuXG5mdW5jdGlvbiB0cmlhbmdsZUNvdW50RnJvbVByaW1pdGl2ZUluZGljZXMocHJpbWl0aXZlLCBpbmRpY2VzQ291bnQpIHtcbiAgc3dpdGNoIChwcmltaXRpdmUubW9kZSkge1xuICAgIGNhc2UgUHJpbWl0aXZlVHlwZS5UUklBTkdMRVM6XG4gICAgICByZXR1cm4gaW5kaWNlc0NvdW50IC8gMztcbiAgICBjYXNlIFByaW1pdGl2ZVR5cGUuVFJJQU5HTEVfU1RSSVA6XG4gICAgY2FzZSBQcmltaXRpdmVUeXBlLlRSSUFOR0xFX0ZBTjpcbiAgICAgIHJldHVybiBNYXRoLm1heChpbmRpY2VzQ291bnQgLSAyLCAwKTtcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIDA7XG4gIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlQ29tbWFuZChtb2RlbCwgZ2x0Zk5vZGUsIHJ1bnRpbWVOb2RlLCBjb250ZXh0LCBzY2VuZTNET25seSkge1xuICB2YXIgbm9kZUNvbW1hbmRzID0gbW9kZWwuX25vZGVDb21tYW5kcztcbiAgdmFyIHBpY2tJZHMgPSBtb2RlbC5fcGlja0lkcztcbiAgdmFyIGFsbG93UGlja2luZyA9IG1vZGVsLmFsbG93UGlja2luZztcbiAgdmFyIHJ1bnRpbWVNZXNoZXNCeU5hbWUgPSBtb2RlbC5fcnVudGltZS5tZXNoZXNCeU5hbWU7XG5cbiAgdmFyIHJlc291cmNlcyA9IG1vZGVsLl9yZW5kZXJlclJlc291cmNlcztcbiAgdmFyIHJlbmRlcmVyVmVydGV4QXJyYXlzID0gcmVzb3VyY2VzLnZlcnRleEFycmF5cztcbiAgdmFyIHJlbmRlcmVyUHJvZ3JhbXMgPSByZXNvdXJjZXMucHJvZ3JhbXM7XG4gIHZhciByZW5kZXJlclJlbmRlclN0YXRlcyA9IHJlc291cmNlcy5yZW5kZXJTdGF0ZXM7XG4gIHZhciB1bmlmb3JtTWFwcyA9IG1vZGVsLl91bmlmb3JtTWFwcztcblxuICB2YXIgZ2x0ZiA9IG1vZGVsLmdsdGY7XG4gIHZhciBhY2Nlc3NvcnMgPSBnbHRmLmFjY2Vzc29ycztcbiAgdmFyIGdsdGZNZXNoZXMgPSBnbHRmLm1lc2hlcztcblxuICB2YXIgaWQgPSBnbHRmTm9kZS5tZXNoO1xuICB2YXIgbWVzaCA9IGdsdGZNZXNoZXNbaWRdO1xuXG4gIHZhciBwcmltaXRpdmVzID0gbWVzaC5wcmltaXRpdmVzO1xuICB2YXIgbGVuZ3RoID0gcHJpbWl0aXZlcy5sZW5ndGg7XG5cbiAgLy8gVGhlIGdsVEYgbm9kZSBoaWVyYXJjaHkgaXMgYSBEQUcgc28gYSBub2RlIGNhbiBoYXZlIG1vcmUgdGhhbiBvbmVcbiAgLy8gcGFyZW50LCBzbyBhIG5vZGUgbWF5IGFscmVhZHkgaGF2ZSBjb21tYW5kcy4gIElmIHNvLCBhcHBlbmQgbW9yZVxuICAvLyBzaW5jZSB0aGV5IHdpbGwgaGF2ZSBhIGRpZmZlcmVudCBtb2RlbCBtYXRyaXguXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIHZhciBwcmltaXRpdmUgPSBwcmltaXRpdmVzW2ldO1xuICAgIHZhciBpeCA9IGFjY2Vzc29yc1twcmltaXRpdmUuaW5kaWNlc107XG4gICAgdmFyIG1hdGVyaWFsID0gbW9kZWwuX3J1bnRpbWUubWF0ZXJpYWxzQnlJZFtwcmltaXRpdmUubWF0ZXJpYWxdO1xuICAgIHZhciBwcm9ncmFtSWQgPSBtYXRlcmlhbC5fcHJvZ3JhbTtcbiAgICB2YXIgZGVjb2RlZERhdGEgPSBtb2RlbC5fZGVjb2RlZERhdGFbaWQgKyBcIi5wcmltaXRpdmUuXCIgKyBpXTtcblxuICAgIHZhciBib3VuZGluZ1NwaGVyZTtcbiAgICB2YXIgcG9zaXRpb25BY2Nlc3NvciA9IHByaW1pdGl2ZS5hdHRyaWJ1dGVzLlBPU0lUSU9OO1xuICAgIGlmIChkZWZpbmVkKHBvc2l0aW9uQWNjZXNzb3IpKSB7XG4gICAgICB2YXIgbWluTWF4ID0gTW9kZWxVdGlsaXR5LmdldEFjY2Vzc29yTWluTWF4KGdsdGYsIHBvc2l0aW9uQWNjZXNzb3IpO1xuICAgICAgYm91bmRpbmdTcGhlcmUgPSBCb3VuZGluZ1NwaGVyZS5mcm9tQ29ybmVyUG9pbnRzKFxuICAgICAgICBDYXJ0ZXNpYW4zLmZyb21BcnJheShtaW5NYXgubWluKSxcbiAgICAgICAgQ2FydGVzaWFuMy5mcm9tQXJyYXkobWluTWF4Lm1heClcbiAgICAgICk7XG4gICAgfVxuXG4gICAgdmFyIHZlcnRleEFycmF5ID0gcmVuZGVyZXJWZXJ0ZXhBcnJheXNbaWQgKyBcIi5wcmltaXRpdmUuXCIgKyBpXTtcbiAgICB2YXIgb2Zmc2V0O1xuICAgIHZhciBjb3VudDtcblxuICAgIC8vIFVzZSBpbmRpY2VzIG9mIHRoZSBwcmV2aW91c2x5IGRlY29kZWQgRHJhY28gZ2VvbWV0cnkuXG4gICAgaWYgKGRlZmluZWQoZGVjb2RlZERhdGEpKSB7XG4gICAgICBjb3VudCA9IGRlY29kZWREYXRhLm51bWJlck9mSW5kaWNlcztcbiAgICAgIG9mZnNldCA9IDA7XG4gICAgfSBlbHNlIGlmIChkZWZpbmVkKGl4KSkge1xuICAgICAgY291bnQgPSBpeC5jb3VudDtcbiAgICAgIG9mZnNldCA9IGl4LmJ5dGVPZmZzZXQgLyBJbmRleERhdGF0eXBlLmdldFNpemVJbkJ5dGVzKGl4LmNvbXBvbmVudFR5cGUpOyAvLyBnbFRGIGhhcyBvZmZzZXQgaW4gYnl0ZXMuICBDZXNpdW0gaGFzIG9mZnNldHMgaW4gaW5kaWNlc1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgcG9zaXRpb25zID0gYWNjZXNzb3JzW3ByaW1pdGl2ZS5hdHRyaWJ1dGVzLlBPU0lUSU9OXTtcbiAgICAgIGNvdW50ID0gcG9zaXRpb25zLmNvdW50O1xuICAgICAgb2Zmc2V0ID0gMDtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgbW9kZWwgdHJpYW5nbGUgY291bnQgdXNpbmcgbnVtYmVyIG9mIGluZGljZXNcbiAgICBtb2RlbC5fdHJpYW5nbGVzTGVuZ3RoICs9IHRyaWFuZ2xlQ291bnRGcm9tUHJpbWl0aXZlSW5kaWNlcyhcbiAgICAgIHByaW1pdGl2ZSxcbiAgICAgIGNvdW50XG4gICAgKTtcblxuICAgIGlmIChwcmltaXRpdmUubW9kZSA9PT0gUHJpbWl0aXZlVHlwZS5QT0lOVFMpIHtcbiAgICAgIG1vZGVsLl9wb2ludHNMZW5ndGggKz0gY291bnQ7XG4gICAgfVxuXG4gICAgdmFyIHVtID0gdW5pZm9ybU1hcHNbcHJpbWl0aXZlLm1hdGVyaWFsXTtcbiAgICB2YXIgdW5pZm9ybU1hcCA9IHVtLnVuaWZvcm1NYXA7XG4gICAgaWYgKGRlZmluZWQodW0uam9pbnRNYXRyaXhVbmlmb3JtTmFtZSkpIHtcbiAgICAgIHZhciBqb2ludFVuaWZvcm1NYXAgPSB7fTtcbiAgICAgIGpvaW50VW5pZm9ybU1hcFt1bS5qb2ludE1hdHJpeFVuaWZvcm1OYW1lXSA9IGNyZWF0ZUpvaW50TWF0cmljZXNGdW5jdGlvbihcbiAgICAgICAgcnVudGltZU5vZGVcbiAgICAgICk7XG5cbiAgICAgIHVuaWZvcm1NYXAgPSBjb21iaW5lKHVuaWZvcm1NYXAsIGpvaW50VW5pZm9ybU1hcCk7XG4gICAgfVxuICAgIGlmIChkZWZpbmVkKHVtLm1vcnBoV2VpZ2h0c1VuaWZvcm1OYW1lKSkge1xuICAgICAgdmFyIG1vcnBoV2VpZ2h0c1VuaWZvcm1NYXAgPSB7fTtcbiAgICAgIG1vcnBoV2VpZ2h0c1VuaWZvcm1NYXBbXG4gICAgICAgIHVtLm1vcnBoV2VpZ2h0c1VuaWZvcm1OYW1lXG4gICAgICBdID0gY3JlYXRlTW9ycGhXZWlnaHRzRnVuY3Rpb24ocnVudGltZU5vZGUpO1xuXG4gICAgICB1bmlmb3JtTWFwID0gY29tYmluZSh1bmlmb3JtTWFwLCBtb3JwaFdlaWdodHNVbmlmb3JtTWFwKTtcbiAgICB9XG5cbiAgICB1bmlmb3JtTWFwID0gY29tYmluZSh1bmlmb3JtTWFwLCB7XG4gICAgICBnbHRmX2NvbG9yOiBjcmVhdGVDb2xvckZ1bmN0aW9uKG1vZGVsKSxcbiAgICAgIGdsdGZfY29sb3JCbGVuZDogY3JlYXRlQ29sb3JCbGVuZEZ1bmN0aW9uKG1vZGVsKSxcbiAgICAgIGdsdGZfY2xpcHBpbmdQbGFuZXM6IGNyZWF0ZUNsaXBwaW5nUGxhbmVzRnVuY3Rpb24obW9kZWwpLFxuICAgICAgZ2x0Zl9jbGlwcGluZ1BsYW5lc0VkZ2VTdHlsZTogY3JlYXRlQ2xpcHBpbmdQbGFuZXNFZGdlU3R5bGVGdW5jdGlvbihcbiAgICAgICAgbW9kZWxcbiAgICAgICksXG4gICAgICBnbHRmX2NsaXBwaW5nUGxhbmVzTWF0cml4OiBjcmVhdGVDbGlwcGluZ1BsYW5lc01hdHJpeEZ1bmN0aW9uKG1vZGVsKSxcbiAgICAgIGdsdGZfaWJsUmVmZXJlbmNlRnJhbWVNYXRyaXg6IGNyZWF0ZUlCTFJlZmVyZW5jZUZyYW1lTWF0cml4RnVuY3Rpb24oXG4gICAgICAgIG1vZGVsXG4gICAgICApLFxuICAgICAgZ2x0Zl9pYmxGYWN0b3I6IGNyZWF0ZUlCTEZhY3RvckZ1bmN0aW9uKG1vZGVsKSxcbiAgICAgIGdsdGZfbGlnaHRDb2xvcjogY3JlYXRlTGlnaHRDb2xvckZ1bmN0aW9uKG1vZGVsKSxcbiAgICAgIGdsdGZfc3BoZXJpY2FsSGFybW9uaWNDb2VmZmljaWVudHM6IGNyZWF0ZVNwaGVyaWNhbEhhcm1vbmljQ29lZmZpY2llbnRzRnVuY3Rpb24oXG4gICAgICAgIG1vZGVsXG4gICAgICApLFxuICAgICAgZ2x0Zl9zcGVjdWxhck1hcDogY3JlYXRlU3BlY3VsYXJFbnZpcm9ubWVudE1hcEZ1bmN0aW9uKG1vZGVsKSxcbiAgICAgIGdsdGZfc3BlY3VsYXJNYXBTaXplOiBjcmVhdGVTcGVjdWxhckVudmlyb25tZW50TWFwU2l6ZUZ1bmN0aW9uKG1vZGVsKSxcbiAgICAgIGdsdGZfbWF4U3BlY3VsYXJMT0Q6IGNyZWF0ZVNwZWN1bGFyRW52aXJvbm1lbnRNYXBMT0QobW9kZWwpLFxuICAgICAgZ2x0Zl9sdW1pbmFuY2VBdFplbml0aDogY3JlYXRlTHVtaW5hbmNlQXRaZW5pdGhGdW5jdGlvbihtb2RlbCksXG4gICAgfSk7XG5cbiAgICAvLyBBbGxvdyBjYWxsYmFjayB0byBtb2RpZnkgdGhlIHVuaWZvcm1NYXBcbiAgICBpZiAoZGVmaW5lZChtb2RlbC5fdW5pZm9ybU1hcExvYWRlZCkpIHtcbiAgICAgIHVuaWZvcm1NYXAgPSBtb2RlbC5fdW5pZm9ybU1hcExvYWRlZCh1bmlmb3JtTWFwLCBwcm9ncmFtSWQsIHJ1bnRpbWVOb2RlKTtcbiAgICB9XG5cbiAgICAvLyBBZGQgdW5pZm9ybXMgZm9yIGRlY29kaW5nIHF1YW50aXplZCBhdHRyaWJ1dGVzIGlmIHVzZWRcbiAgICB2YXIgcXVhbnRpemVkVW5pZm9ybU1hcCA9IHt9O1xuICAgIGlmIChtb2RlbC5leHRlbnNpb25zVXNlZC5XRUIzRF9xdWFudGl6ZWRfYXR0cmlidXRlcykge1xuICAgICAgcXVhbnRpemVkVW5pZm9ybU1hcCA9IGNyZWF0ZVVuaWZvcm1zRm9yUXVhbnRpemVkQXR0cmlidXRlcyhcbiAgICAgICAgbW9kZWwsXG4gICAgICAgIHByaW1pdGl2ZVxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKG1vZGVsLl9kZXF1YW50aXplSW5TaGFkZXIgJiYgZGVmaW5lZChkZWNvZGVkRGF0YSkpIHtcbiAgICAgIHF1YW50aXplZFVuaWZvcm1NYXAgPSBjcmVhdGVVbmlmb3Jtc0ZvckRyYWNvUXVhbnRpemVkQXR0cmlidXRlcyhcbiAgICAgICAgZGVjb2RlZERhdGFcbiAgICAgICk7XG4gICAgfVxuICAgIHVuaWZvcm1NYXAgPSBjb21iaW5lKHVuaWZvcm1NYXAsIHF1YW50aXplZFVuaWZvcm1NYXApO1xuXG4gICAgdmFyIHJzID0gcmVuZGVyZXJSZW5kZXJTdGF0ZXNbcHJpbWl0aXZlLm1hdGVyaWFsXTtcbiAgICB2YXIgaXNUcmFuc2x1Y2VudCA9IHJzLmJsZW5kaW5nLmVuYWJsZWQ7XG5cbiAgICB2YXIgb3duZXIgPSBtb2RlbC5fcGlja09iamVjdDtcbiAgICBpZiAoIWRlZmluZWQob3duZXIpKSB7XG4gICAgICBvd25lciA9IHtcbiAgICAgICAgcHJpbWl0aXZlOiBtb2RlbCxcbiAgICAgICAgaWQ6IG1vZGVsLmlkLFxuICAgICAgICBub2RlOiBydW50aW1lTm9kZS5wdWJsaWNOb2RlLFxuICAgICAgICBtZXNoOiBydW50aW1lTWVzaGVzQnlOYW1lW21lc2gubmFtZV0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIHZhciBjYXN0U2hhZG93cyA9IFNoYWRvd01vZGUuY2FzdFNoYWRvd3MobW9kZWwuX3NoYWRvd3MpO1xuICAgIHZhciByZWNlaXZlU2hhZG93cyA9IFNoYWRvd01vZGUucmVjZWl2ZVNoYWRvd3MobW9kZWwuX3NoYWRvd3MpO1xuXG4gICAgdmFyIHBpY2tJZDtcbiAgICBpZiAoYWxsb3dQaWNraW5nICYmICFkZWZpbmVkKG1vZGVsLl91bmlmb3JtTWFwTG9hZGVkKSkge1xuICAgICAgcGlja0lkID0gY29udGV4dC5jcmVhdGVQaWNrSWQob3duZXIpO1xuICAgICAgcGlja0lkcy5wdXNoKHBpY2tJZCk7XG4gICAgICB2YXIgcGlja1VuaWZvcm1zID0ge1xuICAgICAgICBjem1fcGlja0NvbG9yOiBjcmVhdGVQaWNrQ29sb3JGdW5jdGlvbihwaWNrSWQuY29sb3IpLFxuICAgICAgfTtcbiAgICAgIHVuaWZvcm1NYXAgPSBjb21iaW5lKHVuaWZvcm1NYXAsIHBpY2tVbmlmb3Jtcyk7XG4gICAgfVxuXG4gICAgaWYgKGFsbG93UGlja2luZykge1xuICAgICAgaWYgKGRlZmluZWQobW9kZWwuX3BpY2tJZExvYWRlZCkgJiYgZGVmaW5lZChtb2RlbC5fdW5pZm9ybU1hcExvYWRlZCkpIHtcbiAgICAgICAgcGlja0lkID0gbW9kZWwuX3BpY2tJZExvYWRlZCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGlja0lkID0gXCJjem1fcGlja0NvbG9yXCI7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIGNvbW1hbmQgPSBuZXcgRHJhd0NvbW1hbmQoe1xuICAgICAgYm91bmRpbmdWb2x1bWU6IG5ldyBCb3VuZGluZ1NwaGVyZSgpLCAvLyB1cGRhdGVkIGluIHVwZGF0ZSgpXG4gICAgICBjdWxsOiBtb2RlbC5jdWxsLFxuICAgICAgbW9kZWxNYXRyaXg6IG5ldyBNYXRyaXg0KCksIC8vIGNvbXB1dGVkIGluIHVwZGF0ZSgpXG4gICAgICBwcmltaXRpdmVUeXBlOiBwcmltaXRpdmUubW9kZSxcbiAgICAgIHZlcnRleEFycmF5OiB2ZXJ0ZXhBcnJheSxcbiAgICAgIGNvdW50OiBjb3VudCxcbiAgICAgIG9mZnNldDogb2Zmc2V0LFxuICAgICAgc2hhZGVyUHJvZ3JhbTogcmVuZGVyZXJQcm9ncmFtc1twcm9ncmFtSWRdLFxuICAgICAgY2FzdFNoYWRvd3M6IGNhc3RTaGFkb3dzLFxuICAgICAgcmVjZWl2ZVNoYWRvd3M6IHJlY2VpdmVTaGFkb3dzLFxuICAgICAgdW5pZm9ybU1hcDogdW5pZm9ybU1hcCxcbiAgICAgIHJlbmRlclN0YXRlOiBycyxcbiAgICAgIG93bmVyOiBvd25lcixcbiAgICAgIHBhc3M6IGlzVHJhbnNsdWNlbnQgPyBQYXNzLlRSQU5TTFVDRU5UIDogbW9kZWwub3BhcXVlUGFzcyxcbiAgICAgIHBpY2tJZDogcGlja0lkLFxuICAgIH0pO1xuXG4gICAgdmFyIGNvbW1hbmQyRDtcbiAgICBpZiAoIXNjZW5lM0RPbmx5KSB7XG4gICAgICBjb21tYW5kMkQgPSBEcmF3Q29tbWFuZC5zaGFsbG93Q2xvbmUoY29tbWFuZCk7XG4gICAgICBjb21tYW5kMkQuYm91bmRpbmdWb2x1bWUgPSBuZXcgQm91bmRpbmdTcGhlcmUoKTsgLy8gdXBkYXRlZCBpbiB1cGRhdGUoKVxuICAgICAgY29tbWFuZDJELm1vZGVsTWF0cml4ID0gbmV3IE1hdHJpeDQoKTsgLy8gdXBkYXRlZCBpbiB1cGRhdGUoKVxuICAgIH1cblxuICAgIHZhciBub2RlQ29tbWFuZCA9IHtcbiAgICAgIHNob3c6IHRydWUsXG4gICAgICBib3VuZGluZ1NwaGVyZTogYm91bmRpbmdTcGhlcmUsXG4gICAgICBjb21tYW5kOiBjb21tYW5kLFxuICAgICAgY29tbWFuZDJEOiBjb21tYW5kMkQsXG4gICAgICAvLyBHZW5lcmF0ZWQgb24gZGVtYW5kIHdoZW4gc2lsaG91ZXR0ZSBzaXplIGlzIGdyZWF0ZXIgdGhhbiAwLjAgYW5kIHNpbGhvdWV0dGUgYWxwaGEgaXMgZ3JlYXRlciB0aGFuIDAuMFxuICAgICAgc2lsaG91ZXR0ZU1vZGVsQ29tbWFuZDogdW5kZWZpbmVkLFxuICAgICAgc2lsaG91ZXR0ZU1vZGVsQ29tbWFuZDJEOiB1bmRlZmluZWQsXG4gICAgICBzaWxob3VldHRlQ29sb3JDb21tYW5kOiB1bmRlZmluZWQsXG4gICAgICBzaWxob3VldHRlQ29sb3JDb21tYW5kMkQ6IHVuZGVmaW5lZCxcbiAgICAgIC8vIEdlbmVyYXRlZCBvbiBkZW1hbmQgd2hlbiBjb2xvciBhbHBoYSBpcyBsZXNzIHRoYW4gMS4wXG4gICAgICB0cmFuc2x1Y2VudENvbW1hbmQ6IHVuZGVmaW5lZCxcbiAgICAgIHRyYW5zbHVjZW50Q29tbWFuZDJEOiB1bmRlZmluZWQsXG4gICAgICAvLyBHZW5lcmF0ZWQgb24gZGVtYW5kIHdoZW4gYmFjayBmYWNlIGN1bGxpbmcgaXMgZmFsc2VcbiAgICAgIGRpc2FibGVDdWxsaW5nQ29tbWFuZDogdW5kZWZpbmVkLFxuICAgICAgZGlzYWJsZUN1bGxpbmdDb21tYW5kMkQ6IHVuZGVmaW5lZCxcbiAgICAgIC8vIEZvciB1cGRhdGluZyBub2RlIGNvbW1hbmRzIG9uIHNoYWRlciByZWNvbnN0cnVjdGlvblxuICAgICAgcHJvZ3JhbUlkOiBwcm9ncmFtSWQsXG4gICAgfTtcbiAgICBydW50aW1lTm9kZS5jb21tYW5kcy5wdXNoKG5vZGVDb21tYW5kKTtcbiAgICBub2RlQ29tbWFuZHMucHVzaChub2RlQ29tbWFuZCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlUnVudGltZU5vZGVzKG1vZGVsLCBjb250ZXh0LCBzY2VuZTNET25seSkge1xuICB2YXIgbG9hZFJlc291cmNlcyA9IG1vZGVsLl9sb2FkUmVzb3VyY2VzO1xuXG4gIGlmICghbG9hZFJlc291cmNlcy5maW5pc2hlZEV2ZXJ5dGhpbmdCdXRUZXh0dXJlQ3JlYXRpb24oKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICghbG9hZFJlc291cmNlcy5jcmVhdGVSdW50aW1lTm9kZXMpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgbG9hZFJlc291cmNlcy5jcmVhdGVSdW50aW1lTm9kZXMgPSBmYWxzZTtcblxuICB2YXIgcm9vdE5vZGVzID0gW107XG4gIHZhciBydW50aW1lTm9kZXMgPSBtb2RlbC5fcnVudGltZS5ub2RlcztcblxuICB2YXIgZ2x0ZiA9IG1vZGVsLmdsdGY7XG4gIHZhciBub2RlcyA9IGdsdGYubm9kZXM7XG5cbiAgdmFyIHNjZW5lID0gZ2x0Zi5zY2VuZXNbZ2x0Zi5zY2VuZV07XG4gIHZhciBzY2VuZU5vZGVzID0gc2NlbmUubm9kZXM7XG4gIHZhciBsZW5ndGggPSBzY2VuZU5vZGVzLmxlbmd0aDtcblxuICB2YXIgc3RhY2sgPSBbXTtcbiAgdmFyIHNlZW4gPSB7fTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgc3RhY2sucHVzaCh7XG4gICAgICBwYXJlbnRSdW50aW1lTm9kZTogdW5kZWZpbmVkLFxuICAgICAgZ2x0Zk5vZGU6IG5vZGVzW3NjZW5lTm9kZXNbaV1dLFxuICAgICAgaWQ6IHNjZW5lTm9kZXNbaV0sXG4gICAgfSk7XG5cbiAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMCkge1xuICAgICAgdmFyIG4gPSBzdGFjay5wb3AoKTtcbiAgICAgIHNlZW5bbi5pZF0gPSB0cnVlO1xuICAgICAgdmFyIHBhcmVudFJ1bnRpbWVOb2RlID0gbi5wYXJlbnRSdW50aW1lTm9kZTtcbiAgICAgIHZhciBnbHRmTm9kZSA9IG4uZ2x0Zk5vZGU7XG5cbiAgICAgIC8vIE5vZGUgaGllcmFyY2h5IGlzIGEgREFHIHNvIGEgbm9kZSBjYW4gaGF2ZSBtb3JlIHRoYW4gb25lIHBhcmVudCBzbyBpdCBtYXkgYWxyZWFkeSBleGlzdFxuICAgICAgdmFyIHJ1bnRpbWVOb2RlID0gcnVudGltZU5vZGVzW24uaWRdO1xuICAgICAgaWYgKHJ1bnRpbWVOb2RlLnBhcmVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGlmIChkZWZpbmVkKGdsdGZOb2RlLm1hdHJpeCkpIHtcbiAgICAgICAgICBydW50aW1lTm9kZS5tYXRyaXggPSBNYXRyaXg0LmZyb21Db2x1bW5NYWpvckFycmF5KGdsdGZOb2RlLm1hdHJpeCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gVFJTIGNvbnZlcnRlZCB0byBDZXNpdW0gdHlwZXNcbiAgICAgICAgICB2YXIgcm90YXRpb24gPSBnbHRmTm9kZS5yb3RhdGlvbjtcbiAgICAgICAgICBydW50aW1lTm9kZS50cmFuc2xhdGlvbiA9IENhcnRlc2lhbjMuZnJvbUFycmF5KGdsdGZOb2RlLnRyYW5zbGF0aW9uKTtcbiAgICAgICAgICBydW50aW1lTm9kZS5yb3RhdGlvbiA9IFF1YXRlcm5pb24udW5wYWNrKHJvdGF0aW9uKTtcbiAgICAgICAgICBydW50aW1lTm9kZS5zY2FsZSA9IENhcnRlc2lhbjMuZnJvbUFycmF5KGdsdGZOb2RlLnNjYWxlKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoZGVmaW5lZChwYXJlbnRSdW50aW1lTm9kZSkpIHtcbiAgICAgICAgcGFyZW50UnVudGltZU5vZGUuY2hpbGRyZW4ucHVzaChydW50aW1lTm9kZSk7XG4gICAgICAgIHJ1bnRpbWVOb2RlLnBhcmVudHMucHVzaChwYXJlbnRSdW50aW1lTm9kZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByb290Tm9kZXMucHVzaChydW50aW1lTm9kZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChkZWZpbmVkKGdsdGZOb2RlLm1lc2gpKSB7XG4gICAgICAgIGNyZWF0ZUNvbW1hbmQobW9kZWwsIGdsdGZOb2RlLCBydW50aW1lTm9kZSwgY29udGV4dCwgc2NlbmUzRE9ubHkpO1xuICAgICAgfVxuXG4gICAgICB2YXIgY2hpbGRyZW4gPSBnbHRmTm9kZS5jaGlsZHJlbjtcbiAgICAgIGlmIChkZWZpbmVkKGNoaWxkcmVuKSkge1xuICAgICAgICB2YXIgY2hpbGRyZW5MZW5ndGggPSBjaGlsZHJlbi5sZW5ndGg7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgY2hpbGRyZW5MZW5ndGg7IGorKykge1xuICAgICAgICAgIHZhciBjaGlsZElkID0gY2hpbGRyZW5bal07XG4gICAgICAgICAgaWYgKCFzZWVuW2NoaWxkSWRdKSB7XG4gICAgICAgICAgICBzdGFjay5wdXNoKHtcbiAgICAgICAgICAgICAgcGFyZW50UnVudGltZU5vZGU6IHJ1bnRpbWVOb2RlLFxuICAgICAgICAgICAgICBnbHRmTm9kZTogbm9kZXNbY2hpbGRJZF0sXG4gICAgICAgICAgICAgIGlkOiBjaGlsZHJlbltqXSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIG1vZGVsLl9ydW50aW1lLnJvb3ROb2RlcyA9IHJvb3ROb2RlcztcbiAgbW9kZWwuX3J1bnRpbWUubm9kZXMgPSBydW50aW1lTm9kZXM7XG59XG5cbmZ1bmN0aW9uIGdldEdlb21ldHJ5Qnl0ZUxlbmd0aChidWZmZXJzKSB7XG4gIHZhciBtZW1vcnkgPSAwO1xuICBmb3IgKHZhciBpZCBpbiBidWZmZXJzKSB7XG4gICAgaWYgKGJ1ZmZlcnMuaGFzT3duUHJvcGVydHkoaWQpKSB7XG4gICAgICBtZW1vcnkgKz0gYnVmZmVyc1tpZF0uc2l6ZUluQnl0ZXM7XG4gICAgfVxuICB9XG4gIHJldHVybiBtZW1vcnk7XG59XG5cbmZ1bmN0aW9uIGdldFRleHR1cmVzQnl0ZUxlbmd0aCh0ZXh0dXJlcykge1xuICB2YXIgbWVtb3J5ID0gMDtcbiAgZm9yICh2YXIgaWQgaW4gdGV4dHVyZXMpIHtcbiAgICBpZiAodGV4dHVyZXMuaGFzT3duUHJvcGVydHkoaWQpKSB7XG4gICAgICBtZW1vcnkgKz0gdGV4dHVyZXNbaWRdLnNpemVJbkJ5dGVzO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbWVtb3J5O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVSZXNvdXJjZXMobW9kZWwsIGZyYW1lU3RhdGUpIHtcbiAgdmFyIGNvbnRleHQgPSBmcmFtZVN0YXRlLmNvbnRleHQ7XG4gIHZhciBzY2VuZTNET25seSA9IGZyYW1lU3RhdGUuc2NlbmUzRE9ubHk7XG4gIHZhciBxdWFudGl6ZWRWZXJ0ZXhTaGFkZXJzID0gbW9kZWwuX3F1YW50aXplZFZlcnRleFNoYWRlcnM7XG4gIHZhciB0ZWNobmlxdWVzID0gbW9kZWwuX3NvdXJjZVRlY2huaXF1ZXM7XG4gIHZhciBwcm9ncmFtcyA9IG1vZGVsLl9zb3VyY2VQcm9ncmFtcztcblxuICB2YXIgcmVzb3VyY2VzID0gbW9kZWwuX3JlbmRlcmVyUmVzb3VyY2VzO1xuICB2YXIgc2hhZGVycyA9IHJlc291cmNlcy5zb3VyY2VTaGFkZXJzO1xuICBpZiAobW9kZWwuX2xvYWRSZW5kZXJlclJlc291cmNlc0Zyb21DYWNoZSkge1xuICAgIHNoYWRlcnMgPSByZXNvdXJjZXMuc291cmNlU2hhZGVycyA9XG4gICAgICBtb2RlbC5fY2FjaGVkUmVuZGVyZXJSZXNvdXJjZXMuc291cmNlU2hhZGVycztcbiAgfVxuXG4gIGZvciAodmFyIHRlY2huaXF1ZUlkIGluIHRlY2huaXF1ZXMpIHtcbiAgICBpZiAodGVjaG5pcXVlcy5oYXNPd25Qcm9wZXJ0eSh0ZWNobmlxdWVJZCkpIHtcbiAgICAgIHZhciBwcm9ncmFtSWQgPSB0ZWNobmlxdWVzW3RlY2huaXF1ZUlkXS5wcm9ncmFtO1xuICAgICAgdmFyIHByb2dyYW0gPSBwcm9ncmFtc1twcm9ncmFtSWRdO1xuICAgICAgdmFyIHNoYWRlciA9IHNoYWRlcnNbcHJvZ3JhbS52ZXJ0ZXhTaGFkZXJdO1xuXG4gICAgICBNb2RlbFV0aWxpdHkuY2hlY2tTdXBwb3J0ZWRHbEV4dGVuc2lvbnMocHJvZ3JhbS5nbEV4dGVuc2lvbnMsIGNvbnRleHQpO1xuXG4gICAgICBpZiAoXG4gICAgICAgIG1vZGVsLmV4dGVuc2lvbnNVc2VkLldFQjNEX3F1YW50aXplZF9hdHRyaWJ1dGVzIHx8XG4gICAgICAgIG1vZGVsLl9kZXF1YW50aXplSW5TaGFkZXJcbiAgICAgICkge1xuICAgICAgICB2YXIgcXVhbnRpemVkVlMgPSBxdWFudGl6ZWRWZXJ0ZXhTaGFkZXJzW3Byb2dyYW1JZF07XG4gICAgICAgIGlmICghZGVmaW5lZChxdWFudGl6ZWRWUykpIHtcbiAgICAgICAgICBxdWFudGl6ZWRWUyA9IG1vZGlmeVNoYWRlckZvclF1YW50aXplZEF0dHJpYnV0ZXMoXG4gICAgICAgICAgICBzaGFkZXIsXG4gICAgICAgICAgICBwcm9ncmFtSWQsXG4gICAgICAgICAgICBtb2RlbFxuICAgICAgICAgICk7XG4gICAgICAgICAgcXVhbnRpemVkVmVydGV4U2hhZGVyc1twcm9ncmFtSWRdID0gcXVhbnRpemVkVlM7XG4gICAgICAgIH1cbiAgICAgICAgc2hhZGVyID0gcXVhbnRpemVkVlM7XG4gICAgICB9XG5cbiAgICAgIHNoYWRlciA9IG1vZGlmeVNoYWRlcihzaGFkZXIsIHByb2dyYW1JZCwgbW9kZWwuX3ZlcnRleFNoYWRlckxvYWRlZCk7XG4gICAgfVxuICB9XG5cbiAgaWYgKG1vZGVsLl9sb2FkUmVuZGVyZXJSZXNvdXJjZXNGcm9tQ2FjaGUpIHtcbiAgICB2YXIgY2FjaGVkUmVzb3VyY2VzID0gbW9kZWwuX2NhY2hlZFJlbmRlcmVyUmVzb3VyY2VzO1xuXG4gICAgcmVzb3VyY2VzLmJ1ZmZlcnMgPSBjYWNoZWRSZXNvdXJjZXMuYnVmZmVycztcbiAgICByZXNvdXJjZXMudmVydGV4QXJyYXlzID0gY2FjaGVkUmVzb3VyY2VzLnZlcnRleEFycmF5cztcbiAgICByZXNvdXJjZXMucHJvZ3JhbXMgPSBjYWNoZWRSZXNvdXJjZXMucHJvZ3JhbXM7XG4gICAgcmVzb3VyY2VzLnNpbGhvdWV0dGVQcm9ncmFtcyA9IGNhY2hlZFJlc291cmNlcy5zaWxob3VldHRlUHJvZ3JhbXM7XG4gICAgcmVzb3VyY2VzLnRleHR1cmVzID0gY2FjaGVkUmVzb3VyY2VzLnRleHR1cmVzO1xuICAgIHJlc291cmNlcy5zYW1wbGVycyA9IGNhY2hlZFJlc291cmNlcy5zYW1wbGVycztcbiAgICByZXNvdXJjZXMucmVuZGVyU3RhdGVzID0gY2FjaGVkUmVzb3VyY2VzLnJlbmRlclN0YXRlcztcblxuICAgIC8vIFZlcnRleCBhcnJheXMgYXJlIHVuaXF1ZSB0byB0aGlzIG1vZGVsLCBjcmVhdGUgaW5zdGVhZCBvZiB1c2luZyB0aGUgY2FjaGUuXG4gICAgaWYgKGRlZmluZWQobW9kZWwuX3ByZWNyZWF0ZWRBdHRyaWJ1dGVzKSkge1xuICAgICAgY3JlYXRlVmVydGV4QXJyYXlzKG1vZGVsLCBjb250ZXh0KTtcbiAgICB9XG5cbiAgICBtb2RlbC5fY2FjaGVkR2VvbWV0cnlCeXRlTGVuZ3RoICs9IGdldEdlb21ldHJ5Qnl0ZUxlbmd0aChcbiAgICAgIGNhY2hlZFJlc291cmNlcy5idWZmZXJzXG4gICAgKTtcbiAgICBtb2RlbC5fY2FjaGVkVGV4dHVyZXNCeXRlTGVuZ3RoICs9IGdldFRleHR1cmVzQnl0ZUxlbmd0aChcbiAgICAgIGNhY2hlZFJlc291cmNlcy50ZXh0dXJlc1xuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgY3JlYXRlQnVmZmVycyhtb2RlbCwgZnJhbWVTdGF0ZSk7IC8vIHVzaW5nIGdsVEYgYnVmZmVyVmlld3NcbiAgICBjcmVhdGVQcm9ncmFtcyhtb2RlbCwgZnJhbWVTdGF0ZSk7XG4gICAgY3JlYXRlU2FtcGxlcnMobW9kZWwsIGNvbnRleHQpO1xuICAgIGxvYWRUZXh0dXJlc0Zyb21CdWZmZXJWaWV3cyhtb2RlbCk7XG4gICAgY3JlYXRlVGV4dHVyZXMobW9kZWwsIGZyYW1lU3RhdGUpO1xuICB9XG5cbiAgY3JlYXRlU2tpbnMobW9kZWwpO1xuICBjcmVhdGVSdW50aW1lQW5pbWF0aW9ucyhtb2RlbCk7XG5cbiAgaWYgKCFtb2RlbC5fbG9hZFJlbmRlcmVyUmVzb3VyY2VzRnJvbUNhY2hlKSB7XG4gICAgY3JlYXRlVmVydGV4QXJyYXlzKG1vZGVsLCBjb250ZXh0KTsgLy8gdXNpbmcgZ2xURiBtZXNoZXNcbiAgICBjcmVhdGVSZW5kZXJTdGF0ZXMobW9kZWwpOyAvLyB1c2luZyBnbFRGIG1hdGVyaWFscy90ZWNobmlxdWVzL3N0YXRlc1xuICAgIC8vIExvbmctdGVybSwgd2UgbWlnaHQgbm90IGNhY2hlIHJlbmRlciBzdGF0ZXMgaWYgdGhleSBjb3VsZCBjaGFuZ2VcbiAgICAvLyBkdWUgdG8gYW4gYW5pbWF0aW9uLCBlLmcuLCBhIHVuaWZvcm0gZ29pbmcgZnJvbSBvcGFxdWUgdG8gdHJhbnNwYXJlbnQuXG4gICAgLy8gQ291bGQgdXNlIGNvcHktb24td3JpdGUgaWYgaXQgaXMgd29ydGggaXQuICBQcm9iYWJseSBvdmVya2lsbC5cbiAgfVxuXG4gIGNyZWF0ZVVuaWZvcm1NYXBzKG1vZGVsLCBjb250ZXh0KTsgLy8gdXNpbmcgZ2xURiBtYXRlcmlhbHMvdGVjaG5pcXVlc1xuICBjcmVhdGVSdW50aW1lTm9kZXMobW9kZWwsIGNvbnRleHQsIHNjZW5lM0RPbmx5KTsgLy8gdXNpbmcgZ2xURiBzY2VuZVxufVxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuZnVuY3Rpb24gZ2V0Tm9kZU1hdHJpeChub2RlLCByZXN1bHQpIHtcbiAgdmFyIHB1YmxpY05vZGUgPSBub2RlLnB1YmxpY05vZGU7XG4gIHZhciBwdWJsaWNNYXRyaXggPSBwdWJsaWNOb2RlLm1hdHJpeDtcblxuICBpZiAocHVibGljTm9kZS51c2VNYXRyaXggJiYgZGVmaW5lZChwdWJsaWNNYXRyaXgpKSB7XG4gICAgLy8gUHVibGljIG1hdHJpeCBvdmVycmlkZXMgb3JpZ2luYWwgZ2xURiBtYXRyaXggYW5kIGdsVEYgYW5pbWF0aW9uc1xuICAgIE1hdHJpeDQuY2xvbmUocHVibGljTWF0cml4LCByZXN1bHQpO1xuICB9IGVsc2UgaWYgKGRlZmluZWQobm9kZS5tYXRyaXgpKSB7XG4gICAgTWF0cml4NC5jbG9uZShub2RlLm1hdHJpeCwgcmVzdWx0KTtcbiAgfSBlbHNlIHtcbiAgICBNYXRyaXg0LmZyb21UcmFuc2xhdGlvblF1YXRlcm5pb25Sb3RhdGlvblNjYWxlKFxuICAgICAgbm9kZS50cmFuc2xhdGlvbixcbiAgICAgIG5vZGUucm90YXRpb24sXG4gICAgICBub2RlLnNjYWxlLFxuICAgICAgcmVzdWx0XG4gICAgKTtcbiAgICAvLyBLZWVwIG1hdHJpeCByZXR1cm5lZCBieSB0aGUgbm9kZSBpbi1zeW5jIGlmIHRoZSBub2RlIGlzIHRhcmdldGVkIGJ5IGFuIGFuaW1hdGlvbi4gIE9ubHkgVFJTIG5vZGVzIGNhbiBiZSB0YXJnZXRlZC5cbiAgICBwdWJsaWNOb2RlLnNldE1hdHJpeChyZXN1bHQpO1xuICB9XG59XG5cbnZhciBzY3JhdGNoTm9kZVN0YWNrID0gW107XG52YXIgc2NyYXRjaENvbXB1dGVkVHJhbnNsYXRpb24gPSBuZXcgQ2FydGVzaWFuNCgpO1xudmFyIHNjcmF0Y2hDb21wdXRlZE1hdHJpeEluMkQgPSBuZXcgTWF0cml4NCgpO1xuXG5mdW5jdGlvbiB1cGRhdGVOb2RlSGllcmFyY2h5TW9kZWxNYXRyaXgoXG4gIG1vZGVsLFxuICBtb2RlbFRyYW5zZm9ybUNoYW5nZWQsXG4gIGp1c3RMb2FkZWQsXG4gIHByb2plY3Rpb25cbikge1xuICB2YXIgbWF4RGlydHlOdW1iZXIgPSBtb2RlbC5fbWF4RGlydHlOdW1iZXI7XG5cbiAgdmFyIHJvb3ROb2RlcyA9IG1vZGVsLl9ydW50aW1lLnJvb3ROb2RlcztcbiAgdmFyIGxlbmd0aCA9IHJvb3ROb2Rlcy5sZW5ndGg7XG5cbiAgdmFyIG5vZGVTdGFjayA9IHNjcmF0Y2hOb2RlU3RhY2s7XG4gIHZhciBjb21wdXRlZE1vZGVsTWF0cml4ID0gbW9kZWwuX2NvbXB1dGVkTW9kZWxNYXRyaXg7XG5cbiAgaWYgKG1vZGVsLl9tb2RlICE9PSBTY2VuZU1vZGUuU0NFTkUzRCAmJiAhbW9kZWwuX2lnbm9yZUNvbW1hbmRzKSB7XG4gICAgdmFyIHRyYW5zbGF0aW9uID0gTWF0cml4NC5nZXRDb2x1bW4oXG4gICAgICBjb21wdXRlZE1vZGVsTWF0cml4LFxuICAgICAgMyxcbiAgICAgIHNjcmF0Y2hDb21wdXRlZFRyYW5zbGF0aW9uXG4gICAgKTtcbiAgICBpZiAoIUNhcnRlc2lhbjQuZXF1YWxzKHRyYW5zbGF0aW9uLCBDYXJ0ZXNpYW40LlVOSVRfVykpIHtcbiAgICAgIGNvbXB1dGVkTW9kZWxNYXRyaXggPSBUcmFuc2Zvcm1zLmJhc2lzVG8yRChcbiAgICAgICAgcHJvamVjdGlvbixcbiAgICAgICAgY29tcHV0ZWRNb2RlbE1hdHJpeCxcbiAgICAgICAgc2NyYXRjaENvbXB1dGVkTWF0cml4SW4yRFxuICAgICAgKTtcbiAgICAgIG1vZGVsLl9ydGNDZW50ZXIgPSBtb2RlbC5fcnRjQ2VudGVyM0Q7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBjZW50ZXIgPSBtb2RlbC5ib3VuZGluZ1NwaGVyZS5jZW50ZXI7XG4gICAgICB2YXIgdG8yRCA9IFRyYW5zZm9ybXMud2dzODRUbzJETW9kZWxNYXRyaXgoXG4gICAgICAgIHByb2plY3Rpb24sXG4gICAgICAgIGNlbnRlcixcbiAgICAgICAgc2NyYXRjaENvbXB1dGVkTWF0cml4SW4yRFxuICAgICAgKTtcbiAgICAgIGNvbXB1dGVkTW9kZWxNYXRyaXggPSBNYXRyaXg0Lm11bHRpcGx5KFxuICAgICAgICB0bzJELFxuICAgICAgICBjb21wdXRlZE1vZGVsTWF0cml4LFxuICAgICAgICBzY3JhdGNoQ29tcHV0ZWRNYXRyaXhJbjJEXG4gICAgICApO1xuXG4gICAgICBpZiAoZGVmaW5lZChtb2RlbC5fcnRjQ2VudGVyKSkge1xuICAgICAgICBNYXRyaXg0LnNldFRyYW5zbGF0aW9uKFxuICAgICAgICAgIGNvbXB1dGVkTW9kZWxNYXRyaXgsXG4gICAgICAgICAgQ2FydGVzaWFuNC5VTklUX1csXG4gICAgICAgICAgY29tcHV0ZWRNb2RlbE1hdHJpeFxuICAgICAgICApO1xuICAgICAgICBtb2RlbC5fcnRjQ2VudGVyID0gbW9kZWwuX3J0Y0NlbnRlcjJEO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgbiA9IHJvb3ROb2Rlc1tpXTtcblxuICAgIGdldE5vZGVNYXRyaXgobiwgbi50cmFuc2Zvcm1Ub1Jvb3QpO1xuICAgIG5vZGVTdGFjay5wdXNoKG4pO1xuXG4gICAgd2hpbGUgKG5vZGVTdGFjay5sZW5ndGggPiAwKSB7XG4gICAgICBuID0gbm9kZVN0YWNrLnBvcCgpO1xuICAgICAgdmFyIHRyYW5zZm9ybVRvUm9vdCA9IG4udHJhbnNmb3JtVG9Sb290O1xuICAgICAgdmFyIGNvbW1hbmRzID0gbi5jb21tYW5kcztcblxuICAgICAgaWYgKFxuICAgICAgICBuLmRpcnR5TnVtYmVyID09PSBtYXhEaXJ0eU51bWJlciB8fFxuICAgICAgICBtb2RlbFRyYW5zZm9ybUNoYW5nZWQgfHxcbiAgICAgICAganVzdExvYWRlZFxuICAgICAgKSB7XG4gICAgICAgIHZhciBub2RlTWF0cml4ID0gTWF0cml4NC5tdWx0aXBseVRyYW5zZm9ybWF0aW9uKFxuICAgICAgICAgIGNvbXB1dGVkTW9kZWxNYXRyaXgsXG4gICAgICAgICAgdHJhbnNmb3JtVG9Sb290LFxuICAgICAgICAgIG4uY29tcHV0ZWRNYXRyaXhcbiAgICAgICAgKTtcbiAgICAgICAgdmFyIGNvbW1hbmRzTGVuZ3RoID0gY29tbWFuZHMubGVuZ3RoO1xuICAgICAgICBpZiAoY29tbWFuZHNMZW5ndGggPiAwKSB7XG4gICAgICAgICAgLy8gTm9kZSBoYXMgbWVzaGVzLCB3aGljaCBoYXMgcHJpbWl0aXZlcy4gIFVwZGF0ZSB0aGVpciBjb21tYW5kcy5cbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNvbW1hbmRzTGVuZ3RoOyArK2opIHtcbiAgICAgICAgICAgIHZhciBwcmltaXRpdmVDb21tYW5kID0gY29tbWFuZHNbal07XG4gICAgICAgICAgICB2YXIgY29tbWFuZCA9IHByaW1pdGl2ZUNvbW1hbmQuY29tbWFuZDtcbiAgICAgICAgICAgIE1hdHJpeDQuY2xvbmUobm9kZU1hdHJpeCwgY29tbWFuZC5tb2RlbE1hdHJpeCk7XG5cbiAgICAgICAgICAgIC8vIFBFUkZPUk1BTkNFX0lERUE6IENhbiB1c2UgdHJhbnNmb3JtV2l0aG91dFNjYWxlIGlmIG5vIG5vZGUgdXAgdG8gdGhlIHJvb3QgaGFzIHNjYWxlIChpbmNsdWRpbmcgYW5pbWF0aW9uKVxuICAgICAgICAgICAgQm91bmRpbmdTcGhlcmUudHJhbnNmb3JtKFxuICAgICAgICAgICAgICBwcmltaXRpdmVDb21tYW5kLmJvdW5kaW5nU3BoZXJlLFxuICAgICAgICAgICAgICBjb21tYW5kLm1vZGVsTWF0cml4LFxuICAgICAgICAgICAgICBjb21tYW5kLmJvdW5kaW5nVm9sdW1lXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBpZiAoZGVmaW5lZChtb2RlbC5fcnRjQ2VudGVyKSkge1xuICAgICAgICAgICAgICBDYXJ0ZXNpYW4zLmFkZChcbiAgICAgICAgICAgICAgICBtb2RlbC5fcnRjQ2VudGVyLFxuICAgICAgICAgICAgICAgIGNvbW1hbmQuYm91bmRpbmdWb2x1bWUuY2VudGVyLFxuICAgICAgICAgICAgICAgIGNvbW1hbmQuYm91bmRpbmdWb2x1bWUuY2VudGVyXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIElmIHRoZSBtb2RlbCBjcm9zc2VzIHRoZSBJREwgaW4gMkQsIGl0IHdpbGwgYmUgZHJhd24gaW4gb25lIHZpZXdwb3J0LCBidXQgcGFydCBvZiBpdFxuICAgICAgICAgICAgLy8gd2lsbCBiZSBjbGlwcGVkIGJ5IHRoZSB2aWV3cG9ydC4gV2UgY3JlYXRlIGEgc2Vjb25kIGNvbW1hbmQgdGhhdCB0cmFuc2xhdGVzIHRoZSBtb2RlbFxuICAgICAgICAgICAgLy8gbW9kZWwgbWF0cml4IHRvIHRoZSBvcHBvc2l0ZSBzaWRlIG9mIHRoZSBtYXAgc28gdGhlIHBhcnQgdGhhdCB3YXMgY2xpcHBlZCBpbiBvbmUgdmlld3BvcnRcbiAgICAgICAgICAgIC8vIGlzIGRyYXduIGluIHRoZSBvdGhlci5cbiAgICAgICAgICAgIGNvbW1hbmQgPSBwcmltaXRpdmVDb21tYW5kLmNvbW1hbmQyRDtcbiAgICAgICAgICAgIGlmIChkZWZpbmVkKGNvbW1hbmQpICYmIG1vZGVsLl9tb2RlID09PSBTY2VuZU1vZGUuU0NFTkUyRCkge1xuICAgICAgICAgICAgICBNYXRyaXg0LmNsb25lKG5vZGVNYXRyaXgsIGNvbW1hbmQubW9kZWxNYXRyaXgpO1xuICAgICAgICAgICAgICBjb21tYW5kLm1vZGVsTWF0cml4WzEzXSAtPVxuICAgICAgICAgICAgICAgIENlc2l1bU1hdGguc2lnbihjb21tYW5kLm1vZGVsTWF0cml4WzEzXSkgKlxuICAgICAgICAgICAgICAgIDIuMCAqXG4gICAgICAgICAgICAgICAgQ2VzaXVtTWF0aC5QSSAqXG4gICAgICAgICAgICAgICAgcHJvamVjdGlvbi5lbGxpcHNvaWQubWF4aW11bVJhZGl1cztcbiAgICAgICAgICAgICAgQm91bmRpbmdTcGhlcmUudHJhbnNmb3JtKFxuICAgICAgICAgICAgICAgIHByaW1pdGl2ZUNvbW1hbmQuYm91bmRpbmdTcGhlcmUsXG4gICAgICAgICAgICAgICAgY29tbWFuZC5tb2RlbE1hdHJpeCxcbiAgICAgICAgICAgICAgICBjb21tYW5kLmJvdW5kaW5nVm9sdW1lXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHZhciBjaGlsZHJlbiA9IG4uY2hpbGRyZW47XG4gICAgICBpZiAoZGVmaW5lZChjaGlsZHJlbikpIHtcbiAgICAgICAgdmFyIGNoaWxkcmVuTGVuZ3RoID0gY2hpbGRyZW4ubGVuZ3RoO1xuICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGNoaWxkcmVuTGVuZ3RoOyArK2spIHtcbiAgICAgICAgICB2YXIgY2hpbGQgPSBjaGlsZHJlbltrXTtcblxuICAgICAgICAgIC8vIEEgbm9kZSdzIHRyYW5zZm9ybSBuZWVkcyB0byBiZSB1cGRhdGVkIGlmXG4gICAgICAgICAgLy8gLSBJdCB3YXMgdGFyZ2V0ZWQgZm9yIGFuaW1hdGlvbiB0aGlzIGZyYW1lLCBvclxuICAgICAgICAgIC8vIC0gQW55IG9mIGl0cyBhbmNlc3RvcnMgd2VyZSB0YXJnZXRlZCBmb3IgYW5pbWF0aW9uIHRoaXMgZnJhbWVcblxuICAgICAgICAgIC8vIFBFUkZPUk1BTkNFX0lERUE6IGlmIGEgY2hpbGQgaGFzIG11bHRpcGxlIHBhcmVudHMgYW5kIG9ubHkgb25lIG9mIHRoZSBwYXJlbnRzXG4gICAgICAgICAgLy8gaXMgZGlydHksIGFsbCB0aGUgc3VidHJlZXMgZm9yIGVhY2ggY2hpbGQgaW5zdGFuY2Ugd2lsbCBiZSBkaXJ0eTsgd2UgcHJvYmFibHlcbiAgICAgICAgICAvLyB3b24ndCBzZWUgdGhpcyBpbiB0aGUgd2lsZCBvZnRlbi5cbiAgICAgICAgICBjaGlsZC5kaXJ0eU51bWJlciA9IE1hdGgubWF4KGNoaWxkLmRpcnR5TnVtYmVyLCBuLmRpcnR5TnVtYmVyKTtcblxuICAgICAgICAgIGlmIChjaGlsZC5kaXJ0eU51bWJlciA9PT0gbWF4RGlydHlOdW1iZXIgfHwganVzdExvYWRlZCkge1xuICAgICAgICAgICAgLy8gRG9uJ3QgY2hlY2sgZm9yIG1vZGVsVHJhbnNmb3JtQ2hhbmdlZCBzaW5jZSBpZiBvbmx5IHRoZSBtb2RlbCdzIG1vZGVsIG1hdHJpeCBjaGFuZ2VkLFxuICAgICAgICAgICAgLy8gd2UgZG8gbm90IG5lZWQgdG8gcmVidWlsZCB0aGUgbG9jYWwgdHJhbnNmb3JtLXRvLXJvb3QsIG9ubHkgdGhlIGZpbmFsXG4gICAgICAgICAgICAvLyBbbW9kZWwncy1tb2RlbC1tYXRyaXhdW3RyYW5zZm9ybS10by1yb290XSBhYm92ZS5cbiAgICAgICAgICAgIGdldE5vZGVNYXRyaXgoY2hpbGQsIGNoaWxkLnRyYW5zZm9ybVRvUm9vdCk7XG4gICAgICAgICAgICBNYXRyaXg0Lm11bHRpcGx5VHJhbnNmb3JtYXRpb24oXG4gICAgICAgICAgICAgIHRyYW5zZm9ybVRvUm9vdCxcbiAgICAgICAgICAgICAgY2hpbGQudHJhbnNmb3JtVG9Sb290LFxuICAgICAgICAgICAgICBjaGlsZC50cmFuc2Zvcm1Ub1Jvb3RcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbm9kZVN0YWNrLnB1c2goY2hpbGQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgKyttb2RlbC5fbWF4RGlydHlOdW1iZXI7XG59XG5cbnZhciBzY3JhdGNoT2JqZWN0U3BhY2UgPSBuZXcgTWF0cml4NCgpO1xuXG5mdW5jdGlvbiBhcHBseVNraW5zKG1vZGVsKSB7XG4gIHZhciBza2lubmVkTm9kZXMgPSBtb2RlbC5fcnVudGltZS5za2lubmVkTm9kZXM7XG4gIHZhciBsZW5ndGggPSBza2lubmVkTm9kZXMubGVuZ3RoO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgbm9kZSA9IHNraW5uZWROb2Rlc1tpXTtcblxuICAgIHNjcmF0Y2hPYmplY3RTcGFjZSA9IE1hdHJpeDQuaW52ZXJzZVRyYW5zZm9ybWF0aW9uKFxuICAgICAgbm9kZS50cmFuc2Zvcm1Ub1Jvb3QsXG4gICAgICBzY3JhdGNoT2JqZWN0U3BhY2VcbiAgICApO1xuXG4gICAgdmFyIGNvbXB1dGVkSm9pbnRNYXRyaWNlcyA9IG5vZGUuY29tcHV0ZWRKb2ludE1hdHJpY2VzO1xuICAgIHZhciBqb2ludHMgPSBub2RlLmpvaW50cztcbiAgICB2YXIgYmluZFNoYXBlTWF0cml4ID0gbm9kZS5iaW5kU2hhcGVNYXRyaXg7XG4gICAgdmFyIGludmVyc2VCaW5kTWF0cmljZXMgPSBub2RlLmludmVyc2VCaW5kTWF0cmljZXM7XG4gICAgdmFyIGludmVyc2VCaW5kTWF0cmljZXNMZW5ndGggPSBpbnZlcnNlQmluZE1hdHJpY2VzLmxlbmd0aDtcblxuICAgIGZvciAodmFyIG0gPSAwOyBtIDwgaW52ZXJzZUJpbmRNYXRyaWNlc0xlbmd0aDsgKyttKSB7XG4gICAgICAvLyBbam9pbnQtbWF0cml4XSA9IFtub2RlLXRvLXJvb3ReLTFdW2pvaW50LXRvLXJvb3RdW2ludmVyc2UtYmluZF1bYmluZC1zaGFwZV1cbiAgICAgIGlmICghZGVmaW5lZChjb21wdXRlZEpvaW50TWF0cmljZXNbbV0pKSB7XG4gICAgICAgIGNvbXB1dGVkSm9pbnRNYXRyaWNlc1ttXSA9IG5ldyBNYXRyaXg0KCk7XG4gICAgICB9XG4gICAgICBjb21wdXRlZEpvaW50TWF0cmljZXNbbV0gPSBNYXRyaXg0Lm11bHRpcGx5VHJhbnNmb3JtYXRpb24oXG4gICAgICAgIHNjcmF0Y2hPYmplY3RTcGFjZSxcbiAgICAgICAgam9pbnRzW21dLnRyYW5zZm9ybVRvUm9vdCxcbiAgICAgICAgY29tcHV0ZWRKb2ludE1hdHJpY2VzW21dXG4gICAgICApO1xuICAgICAgY29tcHV0ZWRKb2ludE1hdHJpY2VzW21dID0gTWF0cml4NC5tdWx0aXBseVRyYW5zZm9ybWF0aW9uKFxuICAgICAgICBjb21wdXRlZEpvaW50TWF0cmljZXNbbV0sXG4gICAgICAgIGludmVyc2VCaW5kTWF0cmljZXNbbV0sXG4gICAgICAgIGNvbXB1dGVkSm9pbnRNYXRyaWNlc1ttXVxuICAgICAgKTtcbiAgICAgIGlmIChkZWZpbmVkKGJpbmRTaGFwZU1hdHJpeCkpIHtcbiAgICAgICAgLy8gTk9URTogYmluZFNoYXBlTWF0cml4IGlzIGdsVEYgMS4wIG9ubHksIHJlbW92ZWQgaW4gZ2xURiAyLjAuXG4gICAgICAgIGNvbXB1dGVkSm9pbnRNYXRyaWNlc1ttXSA9IE1hdHJpeDQubXVsdGlwbHlUcmFuc2Zvcm1hdGlvbihcbiAgICAgICAgICBjb21wdXRlZEpvaW50TWF0cmljZXNbbV0sXG4gICAgICAgICAgYmluZFNoYXBlTWF0cml4LFxuICAgICAgICAgIGNvbXB1dGVkSm9pbnRNYXRyaWNlc1ttXVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiB1cGRhdGVQZXJOb2RlU2hvdyhtb2RlbCkge1xuICAvLyBUb3RhbGx5IG5vdCB3b3J0aCBpdCwgYnV0IHdlIGNvdWxkIG9wdGltaXplIHRoaXM6XG4gIC8vIGh0dHA6Ly9oZWxwLmFnaS5jb20vQUdJQ29tcG9uZW50cy9odG1sL0Jsb2dEZWxldGlvbkluQm91bmRpbmdWb2x1bWVIaWVyYXJjaGllcy5odG1cblxuICB2YXIgcm9vdE5vZGVzID0gbW9kZWwuX3J1bnRpbWUucm9vdE5vZGVzO1xuICB2YXIgbGVuZ3RoID0gcm9vdE5vZGVzLmxlbmd0aDtcblxuICB2YXIgbm9kZVN0YWNrID0gc2NyYXRjaE5vZGVTdGFjaztcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgdmFyIG4gPSByb290Tm9kZXNbaV07XG4gICAgbi5jb21wdXRlZFNob3cgPSBuLnB1YmxpY05vZGUuc2hvdztcbiAgICBub2RlU3RhY2sucHVzaChuKTtcblxuICAgIHdoaWxlIChub2RlU3RhY2subGVuZ3RoID4gMCkge1xuICAgICAgbiA9IG5vZGVTdGFjay5wb3AoKTtcbiAgICAgIHZhciBzaG93ID0gbi5jb21wdXRlZFNob3c7XG5cbiAgICAgIHZhciBub2RlQ29tbWFuZHMgPSBuLmNvbW1hbmRzO1xuICAgICAgdmFyIG5vZGVDb21tYW5kc0xlbmd0aCA9IG5vZGVDb21tYW5kcy5sZW5ndGg7XG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG5vZGVDb21tYW5kc0xlbmd0aDsgKytqKSB7XG4gICAgICAgIG5vZGVDb21tYW5kc1tqXS5zaG93ID0gc2hvdztcbiAgICAgIH1cbiAgICAgIC8vIGlmIGNvbW1hbmRzTGVuZ3RoIGlzIHplcm8sIHRoZSBub2RlIGhhcyBhIGxpZ2h0IG9yIGNhbWVyYVxuXG4gICAgICB2YXIgY2hpbGRyZW4gPSBuLmNoaWxkcmVuO1xuICAgICAgaWYgKGRlZmluZWQoY2hpbGRyZW4pKSB7XG4gICAgICAgIHZhciBjaGlsZHJlbkxlbmd0aCA9IGNoaWxkcmVuLmxlbmd0aDtcbiAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBjaGlsZHJlbkxlbmd0aDsgKytrKSB7XG4gICAgICAgICAgdmFyIGNoaWxkID0gY2hpbGRyZW5ba107XG4gICAgICAgICAgLy8gUGFyZW50IG5lZWRzIHRvIGJlIHNob3duIGZvciBjaGlsZCB0byBiZSBzaG93bi5cbiAgICAgICAgICBjaGlsZC5jb21wdXRlZFNob3cgPSBzaG93ICYmIGNoaWxkLnB1YmxpY05vZGUuc2hvdztcbiAgICAgICAgICBub2RlU3RhY2sucHVzaChjaGlsZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gdXBkYXRlUGlja0lkcyhtb2RlbCwgY29udGV4dCkge1xuICB2YXIgaWQgPSBtb2RlbC5pZDtcbiAgaWYgKG1vZGVsLl9pZCAhPT0gaWQpIHtcbiAgICBtb2RlbC5faWQgPSBpZDtcblxuICAgIHZhciBwaWNrSWRzID0gbW9kZWwuX3BpY2tJZHM7XG4gICAgdmFyIGxlbmd0aCA9IHBpY2tJZHMubGVuZ3RoO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICAgIHBpY2tJZHNbaV0ub2JqZWN0LmlkID0gaWQ7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVdpcmVmcmFtZShtb2RlbCkge1xuICBpZiAobW9kZWwuX2RlYnVnV2lyZWZyYW1lICE9PSBtb2RlbC5kZWJ1Z1dpcmVmcmFtZSkge1xuICAgIG1vZGVsLl9kZWJ1Z1dpcmVmcmFtZSA9IG1vZGVsLmRlYnVnV2lyZWZyYW1lO1xuXG4gICAgLy8gVGhpcyBhc3N1bWVzIHRoZSBvcmlnaW5hbCBwcmltaXRpdmUgd2FzIFRSSUFOR0xFUyBhbmQgdGhhdCB0aGUgdHJpYW5nbGVzXG4gICAgLy8gYXJlIGNvbm5lY3RlZCBmb3IgdGhlIHdpcmVmcmFtZSB0byBsb29rIHBlcmZlY3QuXG4gICAgdmFyIHByaW1pdGl2ZVR5cGUgPSBtb2RlbC5kZWJ1Z1dpcmVmcmFtZVxuICAgICAgPyBQcmltaXRpdmVUeXBlLkxJTkVTXG4gICAgICA6IFByaW1pdGl2ZVR5cGUuVFJJQU5HTEVTO1xuICAgIHZhciBub2RlQ29tbWFuZHMgPSBtb2RlbC5fbm9kZUNvbW1hbmRzO1xuICAgIHZhciBsZW5ndGggPSBub2RlQ29tbWFuZHMubGVuZ3RoO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgICAgbm9kZUNvbW1hbmRzW2ldLmNvbW1hbmQucHJpbWl0aXZlVHlwZSA9IHByaW1pdGl2ZVR5cGU7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVNob3dCb3VuZGluZ1ZvbHVtZShtb2RlbCkge1xuICBpZiAobW9kZWwuZGVidWdTaG93Qm91bmRpbmdWb2x1bWUgIT09IG1vZGVsLl9kZWJ1Z1Nob3dCb3VuZGluZ1ZvbHVtZSkge1xuICAgIG1vZGVsLl9kZWJ1Z1Nob3dCb3VuZGluZ1ZvbHVtZSA9IG1vZGVsLmRlYnVnU2hvd0JvdW5kaW5nVm9sdW1lO1xuXG4gICAgdmFyIGRlYnVnU2hvd0JvdW5kaW5nVm9sdW1lID0gbW9kZWwuZGVidWdTaG93Qm91bmRpbmdWb2x1bWU7XG4gICAgdmFyIG5vZGVDb21tYW5kcyA9IG1vZGVsLl9ub2RlQ29tbWFuZHM7XG4gICAgdmFyIGxlbmd0aCA9IG5vZGVDb21tYW5kcy5sZW5ndGg7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgICBub2RlQ29tbWFuZHNbaV0uY29tbWFuZC5kZWJ1Z1Nob3dCb3VuZGluZ1ZvbHVtZSA9IGRlYnVnU2hvd0JvdW5kaW5nVm9sdW1lO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiB1cGRhdGVTaGFkb3dzKG1vZGVsKSB7XG4gIGlmIChtb2RlbC5zaGFkb3dzICE9PSBtb2RlbC5fc2hhZG93cykge1xuICAgIG1vZGVsLl9zaGFkb3dzID0gbW9kZWwuc2hhZG93cztcblxuICAgIHZhciBjYXN0U2hhZG93cyA9IFNoYWRvd01vZGUuY2FzdFNoYWRvd3MobW9kZWwuc2hhZG93cyk7XG4gICAgdmFyIHJlY2VpdmVTaGFkb3dzID0gU2hhZG93TW9kZS5yZWNlaXZlU2hhZG93cyhtb2RlbC5zaGFkb3dzKTtcbiAgICB2YXIgbm9kZUNvbW1hbmRzID0gbW9kZWwuX25vZGVDb21tYW5kcztcbiAgICB2YXIgbGVuZ3RoID0gbm9kZUNvbW1hbmRzLmxlbmd0aDtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBub2RlQ29tbWFuZCA9IG5vZGVDb21tYW5kc1tpXTtcbiAgICAgIG5vZGVDb21tYW5kLmNvbW1hbmQuY2FzdFNoYWRvd3MgPSBjYXN0U2hhZG93cztcbiAgICAgIG5vZGVDb21tYW5kLmNvbW1hbmQucmVjZWl2ZVNoYWRvd3MgPSByZWNlaXZlU2hhZG93cztcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0VHJhbnNsdWNlbnRSZW5kZXJTdGF0ZShtb2RlbCwgcmVuZGVyU3RhdGUpIHtcbiAgdmFyIHJzID0gY2xvbmUocmVuZGVyU3RhdGUsIHRydWUpO1xuICBycy5jdWxsLmVuYWJsZWQgPSBmYWxzZTtcbiAgcnMuZGVwdGhUZXN0LmVuYWJsZWQgPSB0cnVlO1xuICBycy5kZXB0aE1hc2sgPSBmYWxzZTtcbiAgcnMuYmxlbmRpbmcgPSBCbGVuZGluZ1N0YXRlLkFMUEhBX0JMRU5EO1xuXG4gIGlmIChtb2RlbC5vcGFxdWVQYXNzID09PSBQYXNzLkNFU0lVTV8zRF9USUxFKSB7XG4gICAgcnMuc3RlbmNpbFRlc3QgPSBTdGVuY2lsQ29uc3RhbnRzLnNldENlc2l1bTNEVGlsZUJpdCgpO1xuICAgIHJzLnN0ZW5jaWxNYXNrID0gU3RlbmNpbENvbnN0YW50cy5DRVNJVU1fM0RfVElMRV9NQVNLO1xuICB9XG5cbiAgcmV0dXJuIFJlbmRlclN0YXRlLmZyb21DYWNoZShycyk7XG59XG5cbmZ1bmN0aW9uIGRlcml2ZVRyYW5zbHVjZW50Q29tbWFuZChtb2RlbCwgY29tbWFuZCkge1xuICB2YXIgdHJhbnNsdWNlbnRDb21tYW5kID0gRHJhd0NvbW1hbmQuc2hhbGxvd0Nsb25lKGNvbW1hbmQpO1xuICB0cmFuc2x1Y2VudENvbW1hbmQucGFzcyA9IFBhc3MuVFJBTlNMVUNFTlQ7XG4gIHRyYW5zbHVjZW50Q29tbWFuZC5yZW5kZXJTdGF0ZSA9IGdldFRyYW5zbHVjZW50UmVuZGVyU3RhdGUoXG4gICAgbW9kZWwsXG4gICAgY29tbWFuZC5yZW5kZXJTdGF0ZVxuICApO1xuICByZXR1cm4gdHJhbnNsdWNlbnRDb21tYW5kO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVDb2xvcihtb2RlbCwgZnJhbWVTdGF0ZSwgZm9yY2VEZXJpdmUpIHtcbiAgLy8gR2VuZXJhdGUgdHJhbnNsdWNlbnQgY29tbWFuZHMgd2hlbiB0aGUgYmxlbmQgY29sb3IgaGFzIGFuIGFscGhhIGluIHRoZSByYW5nZSAoMC4wLCAxLjApIGV4Y2x1c2l2ZVxuICB2YXIgc2NlbmUzRE9ubHkgPSBmcmFtZVN0YXRlLnNjZW5lM0RPbmx5O1xuICB2YXIgYWxwaGEgPSBtb2RlbC5jb2xvci5hbHBoYTtcbiAgaWYgKGFscGhhID4gMC4wICYmIGFscGhhIDwgMS4wKSB7XG4gICAgdmFyIG5vZGVDb21tYW5kcyA9IG1vZGVsLl9ub2RlQ29tbWFuZHM7XG4gICAgdmFyIGxlbmd0aCA9IG5vZGVDb21tYW5kcy5sZW5ndGg7XG4gICAgaWYgKFxuICAgICAgbGVuZ3RoID4gMCAmJlxuICAgICAgKCFkZWZpbmVkKG5vZGVDb21tYW5kc1swXS50cmFuc2x1Y2VudENvbW1hbmQpIHx8IGZvcmNlRGVyaXZlKVxuICAgICkge1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgICAgICB2YXIgbm9kZUNvbW1hbmQgPSBub2RlQ29tbWFuZHNbaV07XG4gICAgICAgIHZhciBjb21tYW5kID0gbm9kZUNvbW1hbmQuY29tbWFuZDtcbiAgICAgICAgbm9kZUNvbW1hbmQudHJhbnNsdWNlbnRDb21tYW5kID0gZGVyaXZlVHJhbnNsdWNlbnRDb21tYW5kKFxuICAgICAgICAgIG1vZGVsLFxuICAgICAgICAgIGNvbW1hbmRcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCFzY2VuZTNET25seSkge1xuICAgICAgICAgIHZhciBjb21tYW5kMkQgPSBub2RlQ29tbWFuZC5jb21tYW5kMkQ7XG4gICAgICAgICAgbm9kZUNvbW1hbmQudHJhbnNsdWNlbnRDb21tYW5kMkQgPSBkZXJpdmVUcmFuc2x1Y2VudENvbW1hbmQoXG4gICAgICAgICAgICBtb2RlbCxcbiAgICAgICAgICAgIGNvbW1hbmQyRFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0RGlzYWJsZUN1bGxpbmdSZW5kZXJTdGF0ZShyZW5kZXJTdGF0ZSkge1xuICB2YXIgcnMgPSBjbG9uZShyZW5kZXJTdGF0ZSwgdHJ1ZSk7XG4gIHJzLmN1bGwuZW5hYmxlZCA9IGZhbHNlO1xuICByZXR1cm4gUmVuZGVyU3RhdGUuZnJvbUNhY2hlKHJzKTtcbn1cblxuZnVuY3Rpb24gZGVyaXZlRGlzYWJsZUN1bGxpbmdDb21tYW5kKGNvbW1hbmQpIHtcbiAgdmFyIGRpc2FibGVDdWxsaW5nQ29tbWFuZCA9IERyYXdDb21tYW5kLnNoYWxsb3dDbG9uZShjb21tYW5kKTtcbiAgZGlzYWJsZUN1bGxpbmdDb21tYW5kLnJlbmRlclN0YXRlID0gZ2V0RGlzYWJsZUN1bGxpbmdSZW5kZXJTdGF0ZShcbiAgICBjb21tYW5kLnJlbmRlclN0YXRlXG4gICk7XG4gIHJldHVybiBkaXNhYmxlQ3VsbGluZ0NvbW1hbmQ7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUJhY2tGYWNlQ3VsbGluZyhtb2RlbCwgZnJhbWVTdGF0ZSwgZm9yY2VEZXJpdmUpIHtcbiAgdmFyIHNjZW5lM0RPbmx5ID0gZnJhbWVTdGF0ZS5zY2VuZTNET25seTtcbiAgdmFyIGJhY2tGYWNlQ3VsbGluZyA9IG1vZGVsLmJhY2tGYWNlQ3VsbGluZztcbiAgaWYgKCFiYWNrRmFjZUN1bGxpbmcpIHtcbiAgICB2YXIgbm9kZUNvbW1hbmRzID0gbW9kZWwuX25vZGVDb21tYW5kcztcbiAgICB2YXIgbGVuZ3RoID0gbm9kZUNvbW1hbmRzLmxlbmd0aDtcbiAgICBpZiAoXG4gICAgICBsZW5ndGggPiAwICYmXG4gICAgICAoIWRlZmluZWQobm9kZUNvbW1hbmRzWzBdLmRpc2FibGVDdWxsaW5nQ29tbWFuZCkgfHwgZm9yY2VEZXJpdmUpXG4gICAgKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgICAgIHZhciBub2RlQ29tbWFuZCA9IG5vZGVDb21tYW5kc1tpXTtcbiAgICAgICAgdmFyIGNvbW1hbmQgPSBub2RlQ29tbWFuZC5jb21tYW5kO1xuICAgICAgICBub2RlQ29tbWFuZC5kaXNhYmxlQ3VsbGluZ0NvbW1hbmQgPSBkZXJpdmVEaXNhYmxlQ3VsbGluZ0NvbW1hbmQoXG4gICAgICAgICAgY29tbWFuZFxuICAgICAgICApO1xuICAgICAgICBpZiAoIXNjZW5lM0RPbmx5KSB7XG4gICAgICAgICAgdmFyIGNvbW1hbmQyRCA9IG5vZGVDb21tYW5kLmNvbW1hbmQyRDtcbiAgICAgICAgICBub2RlQ29tbWFuZC5kaXNhYmxlQ3VsbGluZ0NvbW1hbmQyRCA9IGRlcml2ZURpc2FibGVDdWxsaW5nQ29tbWFuZChcbiAgICAgICAgICAgIGNvbW1hbmQyRFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0UHJvZ3JhbUlkKG1vZGVsLCBwcm9ncmFtKSB7XG4gIHZhciBwcm9ncmFtcyA9IG1vZGVsLl9yZW5kZXJlclJlc291cmNlcy5wcm9ncmFtcztcbiAgZm9yICh2YXIgaWQgaW4gcHJvZ3JhbXMpIHtcbiAgICBpZiAocHJvZ3JhbXMuaGFzT3duUHJvcGVydHkoaWQpKSB7XG4gICAgICBpZiAocHJvZ3JhbXNbaWRdID09PSBwcm9ncmFtKSB7XG4gICAgICAgIHJldHVybiBpZDtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlU2lsaG91ZXR0ZVByb2dyYW0obW9kZWwsIHByb2dyYW0sIGZyYW1lU3RhdGUpIHtcbiAgdmFyIHZzID0gcHJvZ3JhbS52ZXJ0ZXhTaGFkZXJTb3VyY2Uuc291cmNlc1swXTtcbiAgdmFyIGF0dHJpYnV0ZUxvY2F0aW9ucyA9IHByb2dyYW0uX2F0dHJpYnV0ZUxvY2F0aW9ucztcbiAgdmFyIG5vcm1hbEF0dHJpYnV0ZU5hbWUgPSBtb2RlbC5fbm9ybWFsQXR0cmlidXRlTmFtZTtcblxuICAvLyBNb2RpZmllZCBmcm9tIGh0dHA6Ly9mb3J1bS51bml0eTNkLmNvbS90aHJlYWRzL3Rvb24tb3V0bGluZS1idXQtd2l0aC1kaWZmdXNlLXN1cmZhY2UuMjQ2NjgvXG4gIHZzID0gU2hhZGVyU291cmNlLnJlcGxhY2VNYWluKHZzLCBcImdsdGZfc2lsaG91ZXR0ZV9tYWluXCIpO1xuICB2cyArPVxuICAgIFwidW5pZm9ybSBmbG9hdCBnbHRmX3NpbGhvdWV0dGVTaXplOyBcXG5cIiArXG4gICAgXCJ2b2lkIG1haW4oKSBcXG5cIiArXG4gICAgXCJ7IFxcblwiICtcbiAgICBcIiAgICBnbHRmX3NpbGhvdWV0dGVfbWFpbigpOyBcXG5cIiArXG4gICAgXCIgICAgdmVjMyBuID0gbm9ybWFsaXplKGN6bV9ub3JtYWwzRCAqIFwiICtcbiAgICBub3JtYWxBdHRyaWJ1dGVOYW1lICtcbiAgICBcIik7IFxcblwiICtcbiAgICBcIiAgICBuLnggKj0gY3ptX3Byb2plY3Rpb25bMF1bMF07IFxcblwiICtcbiAgICBcIiAgICBuLnkgKj0gY3ptX3Byb2plY3Rpb25bMV1bMV07IFxcblwiICtcbiAgICBcIiAgICB2ZWM0IGNsaXAgPSBnbF9Qb3NpdGlvbjsgXFxuXCIgK1xuICAgIFwiICAgIGNsaXAueHkgKz0gbi54eSAqIGNsaXAudyAqIGdsdGZfc2lsaG91ZXR0ZVNpemUgKiBjem1fcGl4ZWxSYXRpbyAvIGN6bV92aWV3cG9ydC56OyBcXG5cIiArXG4gICAgXCIgICAgZ2xfUG9zaXRpb24gPSBjbGlwOyBcXG5cIiArXG4gICAgXCJ9XCI7XG5cbiAgdmFyIGZzID1cbiAgICBcInVuaWZvcm0gdmVjNCBnbHRmX3NpbGhvdWV0dGVDb2xvcjsgXFxuXCIgK1xuICAgIFwidm9pZCBtYWluKCkgXFxuXCIgK1xuICAgIFwieyBcXG5cIiArXG4gICAgXCIgICAgZ2xfRnJhZ0NvbG9yID0gY3ptX2dhbW1hQ29ycmVjdChnbHRmX3NpbGhvdWV0dGVDb2xvcik7IFxcblwiICtcbiAgICBcIn1cIjtcblxuICByZXR1cm4gU2hhZGVyUHJvZ3JhbS5mcm9tQ2FjaGUoe1xuICAgIGNvbnRleHQ6IGZyYW1lU3RhdGUuY29udGV4dCxcbiAgICB2ZXJ0ZXhTaGFkZXJTb3VyY2U6IHZzLFxuICAgIGZyYWdtZW50U2hhZGVyU291cmNlOiBmcyxcbiAgICBhdHRyaWJ1dGVMb2NhdGlvbnM6IGF0dHJpYnV0ZUxvY2F0aW9ucyxcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhc1NpbGhvdWV0dGUobW9kZWwsIGZyYW1lU3RhdGUpIHtcbiAgcmV0dXJuIChcbiAgICBzaWxob3VldHRlU3VwcG9ydGVkKGZyYW1lU3RhdGUuY29udGV4dCkgJiZcbiAgICBtb2RlbC5zaWxob3VldHRlU2l6ZSA+IDAuMCAmJlxuICAgIG1vZGVsLnNpbGhvdWV0dGVDb2xvci5hbHBoYSA+IDAuMCAmJlxuICAgIGRlZmluZWQobW9kZWwuX25vcm1hbEF0dHJpYnV0ZU5hbWUpXG4gICk7XG59XG5cbmZ1bmN0aW9uIGhhc1RyYW5zbHVjZW50Q29tbWFuZHMobW9kZWwpIHtcbiAgdmFyIG5vZGVDb21tYW5kcyA9IG1vZGVsLl9ub2RlQ29tbWFuZHM7XG4gIHZhciBsZW5ndGggPSBub2RlQ29tbWFuZHMubGVuZ3RoO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgdmFyIG5vZGVDb21tYW5kID0gbm9kZUNvbW1hbmRzW2ldO1xuICAgIHZhciBjb21tYW5kID0gbm9kZUNvbW1hbmQuY29tbWFuZDtcbiAgICBpZiAoY29tbWFuZC5wYXNzID09PSBQYXNzLlRSQU5TTFVDRU5UKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiBpc1RyYW5zbHVjZW50KG1vZGVsKSB7XG4gIHJldHVybiBtb2RlbC5jb2xvci5hbHBoYSA+IDAuMCAmJiBtb2RlbC5jb2xvci5hbHBoYSA8IDEuMDtcbn1cblxuZnVuY3Rpb24gaXNJbnZpc2libGUobW9kZWwpIHtcbiAgcmV0dXJuIG1vZGVsLmNvbG9yLmFscGhhID09PSAwLjA7XG59XG5cbmZ1bmN0aW9uIGFscGhhRGlydHkoY3VyckFscGhhLCBwcmV2QWxwaGEpIHtcbiAgLy8gUmV0dXJucyB3aGV0aGVyIHRoZSBhbHBoYSBzdGF0ZSBoYXMgY2hhbmdlZCBiZXR3ZWVuIGludmlzaWJsZSwgdHJhbnNsdWNlbnQsIG9yIG9wYXF1ZVxuICByZXR1cm4gKFxuICAgIE1hdGguZmxvb3IoY3VyckFscGhhKSAhPT0gTWF0aC5mbG9vcihwcmV2QWxwaGEpIHx8XG4gICAgTWF0aC5jZWlsKGN1cnJBbHBoYSkgIT09IE1hdGguY2VpbChwcmV2QWxwaGEpXG4gICk7XG59XG5cbnZhciBzaWxob3VldHRlc0xlbmd0aCA9IDA7XG5cbmZ1bmN0aW9uIGNyZWF0ZVNpbGhvdWV0dGVDb21tYW5kcyhtb2RlbCwgZnJhbWVTdGF0ZSkge1xuICAvLyBXcmFwIGFyb3VuZCBhZnRlciBleGNlZWRpbmcgdGhlIDgtYml0IHN0ZW5jaWwgbGltaXQuXG4gIC8vIFRoZSByZWZlcmVuY2UgaXMgdW5pcXVlIHRvIGVhY2ggbW9kZWwgdW50aWwgdGhpcyBwb2ludC5cbiAgdmFyIHN0ZW5jaWxSZWZlcmVuY2UgPSArK3NpbGhvdWV0dGVzTGVuZ3RoICUgMjU1O1xuXG4gIC8vIElmIHRoZSBtb2RlbCBpcyB0cmFuc2x1Y2VudCB0aGUgc2lsaG91ZXR0ZSBuZWVkcyB0byBiZSBpbiB0aGUgdHJhbnNsdWNlbnQgcGFzcy5cbiAgLy8gT3RoZXJ3aXNlIHRoZSBzaWxob3VldHRlIHdvdWxkIGJlIHJlbmRlcmVkIGJlZm9yZSB0aGUgbW9kZWwuXG4gIHZhciBzaWxob3VldHRlVHJhbnNsdWNlbnQgPVxuICAgIGhhc1RyYW5zbHVjZW50Q29tbWFuZHMobW9kZWwpIHx8XG4gICAgaXNUcmFuc2x1Y2VudChtb2RlbCkgfHxcbiAgICBtb2RlbC5zaWxob3VldHRlQ29sb3IuYWxwaGEgPCAxLjA7XG4gIHZhciBzaWxob3VldHRlUHJvZ3JhbXMgPSBtb2RlbC5fcmVuZGVyZXJSZXNvdXJjZXMuc2lsaG91ZXR0ZVByb2dyYW1zO1xuICB2YXIgc2NlbmUzRE9ubHkgPSBmcmFtZVN0YXRlLnNjZW5lM0RPbmx5O1xuICB2YXIgbm9kZUNvbW1hbmRzID0gbW9kZWwuX25vZGVDb21tYW5kcztcbiAgdmFyIGxlbmd0aCA9IG5vZGVDb21tYW5kcy5sZW5ndGg7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgbm9kZUNvbW1hbmQgPSBub2RlQ29tbWFuZHNbaV07XG4gICAgdmFyIGNvbW1hbmQgPSBub2RlQ29tbWFuZC5jb21tYW5kO1xuXG4gICAgLy8gQ3JlYXRlIG1vZGVsIGNvbW1hbmRcbiAgICB2YXIgbW9kZWxDb21tYW5kID0gaXNUcmFuc2x1Y2VudChtb2RlbClcbiAgICAgID8gbm9kZUNvbW1hbmQudHJhbnNsdWNlbnRDb21tYW5kXG4gICAgICA6IGNvbW1hbmQ7XG4gICAgdmFyIHNpbGhvdWV0dGVNb2RlbENvbW1hbmQgPSBEcmF3Q29tbWFuZC5zaGFsbG93Q2xvbmUobW9kZWxDb21tYW5kKTtcbiAgICB2YXIgcmVuZGVyU3RhdGUgPSBjbG9uZShtb2RlbENvbW1hbmQucmVuZGVyU3RhdGUpO1xuXG4gICAgLy8gV3JpdGUgdGhlIHJlZmVyZW5jZSB2YWx1ZSBpbnRvIHRoZSBzdGVuY2lsIGJ1ZmZlci5cbiAgICByZW5kZXJTdGF0ZS5zdGVuY2lsVGVzdCA9IHtcbiAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICBmcm9udEZ1bmN0aW9uOiBXZWJHTENvbnN0YW50cy5BTFdBWVMsXG4gICAgICBiYWNrRnVuY3Rpb246IFdlYkdMQ29uc3RhbnRzLkFMV0FZUyxcbiAgICAgIHJlZmVyZW5jZTogc3RlbmNpbFJlZmVyZW5jZSxcbiAgICAgIG1hc2s6IH4wLFxuICAgICAgZnJvbnRPcGVyYXRpb246IHtcbiAgICAgICAgZmFpbDogV2ViR0xDb25zdGFudHMuS0VFUCxcbiAgICAgICAgekZhaWw6IFdlYkdMQ29uc3RhbnRzLktFRVAsXG4gICAgICAgIHpQYXNzOiBXZWJHTENvbnN0YW50cy5SRVBMQUNFLFxuICAgICAgfSxcbiAgICAgIGJhY2tPcGVyYXRpb246IHtcbiAgICAgICAgZmFpbDogV2ViR0xDb25zdGFudHMuS0VFUCxcbiAgICAgICAgekZhaWw6IFdlYkdMQ29uc3RhbnRzLktFRVAsXG4gICAgICAgIHpQYXNzOiBXZWJHTENvbnN0YW50cy5SRVBMQUNFLFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgaWYgKGlzSW52aXNpYmxlKG1vZGVsKSkge1xuICAgICAgLy8gV2hlbiB0aGUgbW9kZWwgaXMgaW52aXNpYmxlIGRpc2FibGUgY29sb3IgYW5kIGRlcHRoIHdyaXRlcyBidXQgc3RpbGwgd3JpdGUgaW50byB0aGUgc3RlbmNpbCBidWZmZXJcbiAgICAgIHJlbmRlclN0YXRlLmNvbG9yTWFzayA9IHtcbiAgICAgICAgcmVkOiBmYWxzZSxcbiAgICAgICAgZ3JlZW46IGZhbHNlLFxuICAgICAgICBibHVlOiBmYWxzZSxcbiAgICAgICAgYWxwaGE6IGZhbHNlLFxuICAgICAgfTtcbiAgICAgIHJlbmRlclN0YXRlLmRlcHRoTWFzayA9IGZhbHNlO1xuICAgIH1cbiAgICByZW5kZXJTdGF0ZSA9IFJlbmRlclN0YXRlLmZyb21DYWNoZShyZW5kZXJTdGF0ZSk7XG4gICAgc2lsaG91ZXR0ZU1vZGVsQ29tbWFuZC5yZW5kZXJTdGF0ZSA9IHJlbmRlclN0YXRlO1xuICAgIG5vZGVDb21tYW5kLnNpbGhvdWV0dGVNb2RlbENvbW1hbmQgPSBzaWxob3VldHRlTW9kZWxDb21tYW5kO1xuXG4gICAgLy8gQ3JlYXRlIGNvbG9yIGNvbW1hbmRcbiAgICB2YXIgc2lsaG91ZXR0ZUNvbG9yQ29tbWFuZCA9IERyYXdDb21tYW5kLnNoYWxsb3dDbG9uZShjb21tYW5kKTtcbiAgICByZW5kZXJTdGF0ZSA9IGNsb25lKGNvbW1hbmQucmVuZGVyU3RhdGUsIHRydWUpO1xuICAgIHJlbmRlclN0YXRlLmRlcHRoVGVzdC5lbmFibGVkID0gdHJ1ZTtcbiAgICByZW5kZXJTdGF0ZS5jdWxsLmVuYWJsZWQgPSBmYWxzZTtcbiAgICBpZiAoc2lsaG91ZXR0ZVRyYW5zbHVjZW50KSB7XG4gICAgICBzaWxob3VldHRlQ29sb3JDb21tYW5kLnBhc3MgPSBQYXNzLlRSQU5TTFVDRU5UO1xuICAgICAgcmVuZGVyU3RhdGUuZGVwdGhNYXNrID0gZmFsc2U7XG4gICAgICByZW5kZXJTdGF0ZS5ibGVuZGluZyA9IEJsZW5kaW5nU3RhdGUuQUxQSEFfQkxFTkQ7XG4gICAgfVxuXG4gICAgLy8gT25seSByZW5kZXIgc2lsaG91ZXR0ZSBpZiB0aGUgdmFsdWUgaW4gdGhlIHN0ZW5jaWwgYnVmZmVyIGVxdWFscyB0aGUgcmVmZXJlbmNlXG4gICAgcmVuZGVyU3RhdGUuc3RlbmNpbFRlc3QgPSB7XG4gICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgZnJvbnRGdW5jdGlvbjogV2ViR0xDb25zdGFudHMuTk9URVFVQUwsXG4gICAgICBiYWNrRnVuY3Rpb246IFdlYkdMQ29uc3RhbnRzLk5PVEVRVUFMLFxuICAgICAgcmVmZXJlbmNlOiBzdGVuY2lsUmVmZXJlbmNlLFxuICAgICAgbWFzazogfjAsXG4gICAgICBmcm9udE9wZXJhdGlvbjoge1xuICAgICAgICBmYWlsOiBXZWJHTENvbnN0YW50cy5LRUVQLFxuICAgICAgICB6RmFpbDogV2ViR0xDb25zdGFudHMuS0VFUCxcbiAgICAgICAgelBhc3M6IFdlYkdMQ29uc3RhbnRzLktFRVAsXG4gICAgICB9LFxuICAgICAgYmFja09wZXJhdGlvbjoge1xuICAgICAgICBmYWlsOiBXZWJHTENvbnN0YW50cy5LRUVQLFxuICAgICAgICB6RmFpbDogV2ViR0xDb25zdGFudHMuS0VFUCxcbiAgICAgICAgelBhc3M6IFdlYkdMQ29uc3RhbnRzLktFRVAsXG4gICAgICB9LFxuICAgIH07XG4gICAgcmVuZGVyU3RhdGUgPSBSZW5kZXJTdGF0ZS5mcm9tQ2FjaGUocmVuZGVyU3RhdGUpO1xuXG4gICAgLy8gSWYgdGhlIHNpbGhvdWV0dGUgcHJvZ3JhbSBoYXMgYWxyZWFkeSBiZWVuIGNhY2hlZCB1c2UgaXRcbiAgICB2YXIgcHJvZ3JhbSA9IGNvbW1hbmQuc2hhZGVyUHJvZ3JhbTtcbiAgICB2YXIgaWQgPSBnZXRQcm9ncmFtSWQobW9kZWwsIHByb2dyYW0pO1xuICAgIHZhciBzaWxob3VldHRlUHJvZ3JhbSA9IHNpbGhvdWV0dGVQcm9ncmFtc1tpZF07XG4gICAgaWYgKCFkZWZpbmVkKHNpbGhvdWV0dGVQcm9ncmFtKSkge1xuICAgICAgc2lsaG91ZXR0ZVByb2dyYW0gPSBjcmVhdGVTaWxob3VldHRlUHJvZ3JhbShtb2RlbCwgcHJvZ3JhbSwgZnJhbWVTdGF0ZSk7XG4gICAgICBzaWxob3VldHRlUHJvZ3JhbXNbaWRdID0gc2lsaG91ZXR0ZVByb2dyYW07XG4gICAgfVxuXG4gICAgdmFyIHNpbGhvdWV0dGVVbmlmb3JtTWFwID0gY29tYmluZShjb21tYW5kLnVuaWZvcm1NYXAsIHtcbiAgICAgIGdsdGZfc2lsaG91ZXR0ZUNvbG9yOiBjcmVhdGVTaWxob3VldHRlQ29sb3JGdW5jdGlvbihtb2RlbCksXG4gICAgICBnbHRmX3NpbGhvdWV0dGVTaXplOiBjcmVhdGVTaWxob3VldHRlU2l6ZUZ1bmN0aW9uKG1vZGVsKSxcbiAgICB9KTtcblxuICAgIHNpbGhvdWV0dGVDb2xvckNvbW1hbmQucmVuZGVyU3RhdGUgPSByZW5kZXJTdGF0ZTtcbiAgICBzaWxob3VldHRlQ29sb3JDb21tYW5kLnNoYWRlclByb2dyYW0gPSBzaWxob3VldHRlUHJvZ3JhbTtcbiAgICBzaWxob3VldHRlQ29sb3JDb21tYW5kLnVuaWZvcm1NYXAgPSBzaWxob3VldHRlVW5pZm9ybU1hcDtcbiAgICBzaWxob3VldHRlQ29sb3JDb21tYW5kLmNhc3RTaGFkb3dzID0gZmFsc2U7XG4gICAgc2lsaG91ZXR0ZUNvbG9yQ29tbWFuZC5yZWNlaXZlU2hhZG93cyA9IGZhbHNlO1xuICAgIG5vZGVDb21tYW5kLnNpbGhvdWV0dGVDb2xvckNvbW1hbmQgPSBzaWxob3VldHRlQ29sb3JDb21tYW5kO1xuXG4gICAgaWYgKCFzY2VuZTNET25seSkge1xuICAgICAgdmFyIGNvbW1hbmQyRCA9IG5vZGVDb21tYW5kLmNvbW1hbmQyRDtcbiAgICAgIHZhciBzaWxob3VldHRlTW9kZWxDb21tYW5kMkQgPSBEcmF3Q29tbWFuZC5zaGFsbG93Q2xvbmUoXG4gICAgICAgIHNpbGhvdWV0dGVNb2RlbENvbW1hbmRcbiAgICAgICk7XG4gICAgICBzaWxob3VldHRlTW9kZWxDb21tYW5kMkQuYm91bmRpbmdWb2x1bWUgPSBjb21tYW5kMkQuYm91bmRpbmdWb2x1bWU7XG4gICAgICBzaWxob3VldHRlTW9kZWxDb21tYW5kMkQubW9kZWxNYXRyaXggPSBjb21tYW5kMkQubW9kZWxNYXRyaXg7XG4gICAgICBub2RlQ29tbWFuZC5zaWxob3VldHRlTW9kZWxDb21tYW5kMkQgPSBzaWxob3VldHRlTW9kZWxDb21tYW5kMkQ7XG5cbiAgICAgIHZhciBzaWxob3VldHRlQ29sb3JDb21tYW5kMkQgPSBEcmF3Q29tbWFuZC5zaGFsbG93Q2xvbmUoXG4gICAgICAgIHNpbGhvdWV0dGVDb2xvckNvbW1hbmRcbiAgICAgICk7XG4gICAgICBzaWxob3VldHRlTW9kZWxDb21tYW5kMkQuYm91bmRpbmdWb2x1bWUgPSBjb21tYW5kMkQuYm91bmRpbmdWb2x1bWU7XG4gICAgICBzaWxob3VldHRlTW9kZWxDb21tYW5kMkQubW9kZWxNYXRyaXggPSBjb21tYW5kMkQubW9kZWxNYXRyaXg7XG4gICAgICBub2RlQ29tbWFuZC5zaWxob3VldHRlQ29sb3JDb21tYW5kMkQgPSBzaWxob3VldHRlQ29sb3JDb21tYW5kMkQ7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIG1vZGlmeVNoYWRlckZvckNsaXBwaW5nUGxhbmVzKFxuICBzaGFkZXIsXG4gIGNsaXBwaW5nUGxhbmVDb2xsZWN0aW9uLFxuICBjb250ZXh0XG4pIHtcbiAgc2hhZGVyID0gU2hhZGVyU291cmNlLnJlcGxhY2VNYWluKHNoYWRlciwgXCJnbHRmX2NsaXBfbWFpblwiKTtcbiAgc2hhZGVyICs9IE1vZGVsLl9nZXRDbGlwcGluZ0Z1bmN0aW9uKGNsaXBwaW5nUGxhbmVDb2xsZWN0aW9uLCBjb250ZXh0KSArIFwiXFxuXCI7XG4gIHNoYWRlciArPVxuICAgIFwidW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgZ2x0Zl9jbGlwcGluZ1BsYW5lczsgXFxuXCIgK1xuICAgIFwidW5pZm9ybSBtYXQ0IGdsdGZfY2xpcHBpbmdQbGFuZXNNYXRyaXg7IFxcblwiICtcbiAgICBcInVuaWZvcm0gdmVjNCBnbHRmX2NsaXBwaW5nUGxhbmVzRWRnZVN0eWxlOyBcXG5cIiArXG4gICAgXCJ2b2lkIG1haW4oKSBcXG5cIiArXG4gICAgXCJ7IFxcblwiICtcbiAgICBcIiAgICBnbHRmX2NsaXBfbWFpbigpOyBcXG5cIiArXG4gICAgZ2V0Q2xpcEFuZFN0eWxlQ29kZShcbiAgICAgIFwiZ2x0Zl9jbGlwcGluZ1BsYW5lc1wiLFxuICAgICAgXCJnbHRmX2NsaXBwaW5nUGxhbmVzTWF0cml4XCIsXG4gICAgICBcImdsdGZfY2xpcHBpbmdQbGFuZXNFZGdlU3R5bGVcIlxuICAgICkgK1xuICAgIFwifSBcXG5cIjtcbiAgcmV0dXJuIHNoYWRlcjtcbn1cblxuZnVuY3Rpb24gdXBkYXRlU2lsaG91ZXR0ZShtb2RlbCwgZnJhbWVTdGF0ZSwgZm9yY2UpIHtcbiAgLy8gR2VuZXJhdGUgc2lsaG91ZXR0ZSBjb21tYW5kcyB3aGVuIHRoZSBzaWxob3VldHRlIHNpemUgaXMgZ3JlYXRlciB0aGFuIDAuMCBhbmQgdGhlIGFscGhhIGlzIGdyZWF0ZXIgdGhhbiAwLjBcbiAgLy8gVGhlcmUgYXJlIHR3byBzaWxob3VldHRlIGNvbW1hbmRzOlxuICAvLyAgICAgMS4gc2lsaG91ZXR0ZU1vZGVsQ29tbWFuZCA6IHJlbmRlciBtb2RlbCBub3JtYWxseSB3aGlsZSBlbmFibGluZyBzdGVuY2lsIG1hc2tcbiAgLy8gICAgIDIuIHNpbGhvdWV0dGVDb2xvckNvbW1hbmQgOiByZW5kZXIgZW5sYXJnZWQgbW9kZWwgd2l0aCBhIHNvbGlkIGNvbG9yIHdoaWxlIGVuYWJsaW5nIHN0ZW5jaWwgdGVzdHNcbiAgaWYgKCFoYXNTaWxob3VldHRlKG1vZGVsLCBmcmFtZVN0YXRlKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBub2RlQ29tbWFuZHMgPSBtb2RlbC5fbm9kZUNvbW1hbmRzO1xuICB2YXIgZGlydHkgPVxuICAgIG5vZGVDb21tYW5kcy5sZW5ndGggPiAwICYmXG4gICAgKGFscGhhRGlydHkobW9kZWwuY29sb3IuYWxwaGEsIG1vZGVsLl9jb2xvclByZXZpb3VzQWxwaGEpIHx8XG4gICAgICBhbHBoYURpcnR5KFxuICAgICAgICBtb2RlbC5zaWxob3VldHRlQ29sb3IuYWxwaGEsXG4gICAgICAgIG1vZGVsLl9zaWxob3VldHRlQ29sb3JQcmV2aW91c0FscGhhXG4gICAgICApIHx8XG4gICAgICAhZGVmaW5lZChub2RlQ29tbWFuZHNbMF0uc2lsaG91ZXR0ZU1vZGVsQ29tbWFuZCkpO1xuXG4gIG1vZGVsLl9jb2xvclByZXZpb3VzQWxwaGEgPSBtb2RlbC5jb2xvci5hbHBoYTtcbiAgbW9kZWwuX3NpbGhvdWV0dGVDb2xvclByZXZpb3VzQWxwaGEgPSBtb2RlbC5zaWxob3VldHRlQ29sb3IuYWxwaGE7XG5cbiAgaWYgKGRpcnR5IHx8IGZvcmNlKSB7XG4gICAgY3JlYXRlU2lsaG91ZXR0ZUNvbW1hbmRzKG1vZGVsLCBmcmFtZVN0YXRlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiB1cGRhdGVDbGlwcGluZ1BsYW5lcyhtb2RlbCwgZnJhbWVTdGF0ZSkge1xuICB2YXIgY2xpcHBpbmdQbGFuZXMgPSBtb2RlbC5fY2xpcHBpbmdQbGFuZXM7XG4gIGlmIChkZWZpbmVkKGNsaXBwaW5nUGxhbmVzKSAmJiBjbGlwcGluZ1BsYW5lcy5vd25lciA9PT0gbW9kZWwpIHtcbiAgICBpZiAoY2xpcHBpbmdQbGFuZXMuZW5hYmxlZCkge1xuICAgICAgY2xpcHBpbmdQbGFuZXMudXBkYXRlKGZyYW1lU3RhdGUpO1xuICAgIH1cbiAgfVxufVxuXG52YXIgc2NyYXRjaEJvdW5kaW5nU3BoZXJlID0gbmV3IEJvdW5kaW5nU3BoZXJlKCk7XG5cbmZ1bmN0aW9uIHNjYWxlSW5QaXhlbHMocG9zaXRpb25XQywgcmFkaXVzLCBmcmFtZVN0YXRlKSB7XG4gIHNjcmF0Y2hCb3VuZGluZ1NwaGVyZS5jZW50ZXIgPSBwb3NpdGlvbldDO1xuICBzY3JhdGNoQm91bmRpbmdTcGhlcmUucmFkaXVzID0gcmFkaXVzO1xuICByZXR1cm4gZnJhbWVTdGF0ZS5jYW1lcmEuZ2V0UGl4ZWxTaXplKFxuICAgIHNjcmF0Y2hCb3VuZGluZ1NwaGVyZSxcbiAgICBmcmFtZVN0YXRlLmNvbnRleHQuZHJhd2luZ0J1ZmZlcldpZHRoLFxuICAgIGZyYW1lU3RhdGUuY29udGV4dC5kcmF3aW5nQnVmZmVySGVpZ2h0XG4gICk7XG59XG5cbnZhciBzY3JhdGNoUG9zaXRpb24gPSBuZXcgQ2FydGVzaWFuMygpO1xudmFyIHNjcmF0Y2hDYXJ0b2dyYXBoaWMgPSBuZXcgQ2FydG9ncmFwaGljKCk7XG5cbmZ1bmN0aW9uIGdldFNjYWxlKG1vZGVsLCBmcmFtZVN0YXRlKSB7XG4gIHZhciBzY2FsZSA9IG1vZGVsLnNjYWxlO1xuXG4gIGlmIChtb2RlbC5taW5pbXVtUGl4ZWxTaXplICE9PSAwLjApIHtcbiAgICAvLyBDb21wdXRlIHNpemUgb2YgYm91bmRpbmcgc3BoZXJlIGluIHBpeGVsc1xuICAgIHZhciBjb250ZXh0ID0gZnJhbWVTdGF0ZS5jb250ZXh0O1xuICAgIHZhciBtYXhQaXhlbFNpemUgPSBNYXRoLm1heChcbiAgICAgIGNvbnRleHQuZHJhd2luZ0J1ZmZlcldpZHRoLFxuICAgICAgY29udGV4dC5kcmF3aW5nQnVmZmVySGVpZ2h0XG4gICAgKTtcbiAgICB2YXIgbSA9IGRlZmluZWQobW9kZWwuX2NsYW1wZWRNb2RlbE1hdHJpeClcbiAgICAgID8gbW9kZWwuX2NsYW1wZWRNb2RlbE1hdHJpeFxuICAgICAgOiBtb2RlbC5tb2RlbE1hdHJpeDtcbiAgICBzY3JhdGNoUG9zaXRpb24ueCA9IG1bMTJdO1xuICAgIHNjcmF0Y2hQb3NpdGlvbi55ID0gbVsxM107XG4gICAgc2NyYXRjaFBvc2l0aW9uLnogPSBtWzE0XTtcblxuICAgIGlmIChkZWZpbmVkKG1vZGVsLl9ydGNDZW50ZXIpKSB7XG4gICAgICBDYXJ0ZXNpYW4zLmFkZChtb2RlbC5fcnRjQ2VudGVyLCBzY3JhdGNoUG9zaXRpb24sIHNjcmF0Y2hQb3NpdGlvbik7XG4gICAgfVxuXG4gICAgaWYgKG1vZGVsLl9tb2RlICE9PSBTY2VuZU1vZGUuU0NFTkUzRCkge1xuICAgICAgdmFyIHByb2plY3Rpb24gPSBmcmFtZVN0YXRlLm1hcFByb2plY3Rpb247XG4gICAgICB2YXIgY2FydG9ncmFwaGljID0gcHJvamVjdGlvbi5lbGxpcHNvaWQuY2FydGVzaWFuVG9DYXJ0b2dyYXBoaWMoXG4gICAgICAgIHNjcmF0Y2hQb3NpdGlvbixcbiAgICAgICAgc2NyYXRjaENhcnRvZ3JhcGhpY1xuICAgICAgKTtcbiAgICAgIHByb2plY3Rpb24ucHJvamVjdChjYXJ0b2dyYXBoaWMsIHNjcmF0Y2hQb3NpdGlvbik7XG4gICAgICBDYXJ0ZXNpYW4zLmZyb21FbGVtZW50cyhcbiAgICAgICAgc2NyYXRjaFBvc2l0aW9uLnosXG4gICAgICAgIHNjcmF0Y2hQb3NpdGlvbi54LFxuICAgICAgICBzY3JhdGNoUG9zaXRpb24ueSxcbiAgICAgICAgc2NyYXRjaFBvc2l0aW9uXG4gICAgICApO1xuICAgIH1cblxuICAgIHZhciByYWRpdXMgPSBtb2RlbC5ib3VuZGluZ1NwaGVyZS5yYWRpdXM7XG4gICAgdmFyIG1ldGVyc1BlclBpeGVsID0gc2NhbGVJblBpeGVscyhzY3JhdGNoUG9zaXRpb24sIHJhZGl1cywgZnJhbWVTdGF0ZSk7XG5cbiAgICAvLyBtZXRlcnNQZXJQaXhlbCBpcyBhbHdheXMgPiAwLjBcbiAgICB2YXIgcGl4ZWxzUGVyTWV0ZXIgPSAxLjAgLyBtZXRlcnNQZXJQaXhlbDtcbiAgICB2YXIgZGlhbWV0ZXJJblBpeGVscyA9IE1hdGgubWluKFxuICAgICAgcGl4ZWxzUGVyTWV0ZXIgKiAoMi4wICogcmFkaXVzKSxcbiAgICAgIG1heFBpeGVsU2l6ZVxuICAgICk7XG5cbiAgICAvLyBNYWludGFpbiBtb2RlbCdzIG1pbmltdW0gcGl4ZWwgc2l6ZVxuICAgIGlmIChkaWFtZXRlckluUGl4ZWxzIDwgbW9kZWwubWluaW11bVBpeGVsU2l6ZSkge1xuICAgICAgc2NhbGUgPVxuICAgICAgICAobW9kZWwubWluaW11bVBpeGVsU2l6ZSAqIG1ldGVyc1BlclBpeGVsKSAvXG4gICAgICAgICgyLjAgKiBtb2RlbC5faW5pdGlhbFJhZGl1cyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGRlZmluZWQobW9kZWwubWF4aW11bVNjYWxlKVxuICAgID8gTWF0aC5taW4obW9kZWwubWF4aW11bVNjYWxlLCBzY2FsZSlcbiAgICA6IHNjYWxlO1xufVxuXG5mdW5jdGlvbiByZWxlYXNlQ2FjaGVkR2x0Zihtb2RlbCkge1xuICBpZiAoXG4gICAgZGVmaW5lZChtb2RlbC5fY2FjaGVLZXkpICYmXG4gICAgZGVmaW5lZChtb2RlbC5fY2FjaGVkR2x0ZikgJiZcbiAgICAtLW1vZGVsLl9jYWNoZWRHbHRmLmNvdW50ID09PSAwXG4gICkge1xuICAgIGRlbGV0ZSBnbHRmQ2FjaGVbbW9kZWwuX2NhY2hlS2V5XTtcbiAgfVxuICBtb2RlbC5fY2FjaGVkR2x0ZiA9IHVuZGVmaW5lZDtcbn1cblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbmZ1bmN0aW9uIENhY2hlZFJlbmRlcmVyUmVzb3VyY2VzKGNvbnRleHQsIGNhY2hlS2V5KSB7XG4gIHRoaXMuYnVmZmVycyA9IHVuZGVmaW5lZDtcbiAgdGhpcy52ZXJ0ZXhBcnJheXMgPSB1bmRlZmluZWQ7XG4gIHRoaXMucHJvZ3JhbXMgPSB1bmRlZmluZWQ7XG4gIHRoaXMuc291cmNlU2hhZGVycyA9IHVuZGVmaW5lZDtcbiAgdGhpcy5zaWxob3VldHRlUHJvZ3JhbXMgPSB1bmRlZmluZWQ7XG4gIHRoaXMudGV4dHVyZXMgPSB1bmRlZmluZWQ7XG4gIHRoaXMuc2FtcGxlcnMgPSB1bmRlZmluZWQ7XG4gIHRoaXMucmVuZGVyU3RhdGVzID0gdW5kZWZpbmVkO1xuICB0aGlzLnJlYWR5ID0gZmFsc2U7XG5cbiAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgdGhpcy5jYWNoZUtleSA9IGNhY2hlS2V5O1xuICB0aGlzLmNvdW50ID0gMDtcbn1cblxuZnVuY3Rpb24gZGVzdHJveShwcm9wZXJ0eSkge1xuICBmb3IgKHZhciBuYW1lIGluIHByb3BlcnR5KSB7XG4gICAgaWYgKHByb3BlcnR5Lmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICBwcm9wZXJ0eVtuYW1lXS5kZXN0cm95KCk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGRlc3Ryb3lDYWNoZWRSZW5kZXJlclJlc291cmNlcyhyZXNvdXJjZXMpIHtcbiAgZGVzdHJveShyZXNvdXJjZXMuYnVmZmVycyk7XG4gIGRlc3Ryb3kocmVzb3VyY2VzLnZlcnRleEFycmF5cyk7XG4gIGRlc3Ryb3kocmVzb3VyY2VzLnByb2dyYW1zKTtcbiAgZGVzdHJveShyZXNvdXJjZXMuc2lsaG91ZXR0ZVByb2dyYW1zKTtcbiAgZGVzdHJveShyZXNvdXJjZXMudGV4dHVyZXMpO1xufVxuXG5DYWNoZWRSZW5kZXJlclJlc291cmNlcy5wcm90b3R5cGUucmVsZWFzZSA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKC0tdGhpcy5jb3VudCA9PT0gMCkge1xuICAgIGlmIChkZWZpbmVkKHRoaXMuY2FjaGVLZXkpKSB7XG4gICAgICAvLyBSZW1vdmUgaWYgdGhpcyB3YXMgY2FjaGVkXG4gICAgICBkZWxldGUgdGhpcy5jb250ZXh0LmNhY2hlLm1vZGVsUmVuZGVyZXJSZXNvdXJjZUNhY2hlW3RoaXMuY2FjaGVLZXldO1xuICAgIH1cbiAgICBkZXN0cm95Q2FjaGVkUmVuZGVyZXJSZXNvdXJjZXModGhpcyk7XG4gICAgcmV0dXJuIGRlc3Ryb3lPYmplY3QodGhpcyk7XG4gIH1cblxuICByZXR1cm4gdW5kZWZpbmVkO1xufTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbmZ1bmN0aW9uIGdldFVwZGF0ZUhlaWdodENhbGxiYWNrKG1vZGVsLCBlbGxpcHNvaWQsIGNhcnRvUG9zaXRpb24pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChjbGFtcGVkUG9zaXRpb24pIHtcbiAgICBpZiAobW9kZWwuaGVpZ2h0UmVmZXJlbmNlID09PSBIZWlnaHRSZWZlcmVuY2UuUkVMQVRJVkVfVE9fR1JPVU5EKSB7XG4gICAgICB2YXIgY2xhbXBlZENhcnQgPSBlbGxpcHNvaWQuY2FydGVzaWFuVG9DYXJ0b2dyYXBoaWMoXG4gICAgICAgIGNsYW1wZWRQb3NpdGlvbixcbiAgICAgICAgc2NyYXRjaENhcnRvZ3JhcGhpY1xuICAgICAgKTtcbiAgICAgIGNsYW1wZWRDYXJ0LmhlaWdodCArPSBjYXJ0b1Bvc2l0aW9uLmhlaWdodDtcbiAgICAgIGVsbGlwc29pZC5jYXJ0b2dyYXBoaWNUb0NhcnRlc2lhbihjbGFtcGVkQ2FydCwgY2xhbXBlZFBvc2l0aW9uKTtcbiAgICB9XG5cbiAgICB2YXIgY2xhbXBlZE1vZGVsTWF0cml4ID0gbW9kZWwuX2NsYW1wZWRNb2RlbE1hdHJpeDtcblxuICAgIC8vIE1vZGlmeSBjbGFtcGVkIG1vZGVsIG1hdHJpeCB0byB1c2UgbmV3IGhlaWdodFxuICAgIE1hdHJpeDQuY2xvbmUobW9kZWwubW9kZWxNYXRyaXgsIGNsYW1wZWRNb2RlbE1hdHJpeCk7XG4gICAgY2xhbXBlZE1vZGVsTWF0cml4WzEyXSA9IGNsYW1wZWRQb3NpdGlvbi54O1xuICAgIGNsYW1wZWRNb2RlbE1hdHJpeFsxM10gPSBjbGFtcGVkUG9zaXRpb24ueTtcbiAgICBjbGFtcGVkTW9kZWxNYXRyaXhbMTRdID0gY2xhbXBlZFBvc2l0aW9uLno7XG5cbiAgICBtb2RlbC5faGVpZ2h0Q2hhbmdlZCA9IHRydWU7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUNsYW1waW5nKG1vZGVsKSB7XG4gIGlmIChkZWZpbmVkKG1vZGVsLl9yZW1vdmVVcGRhdGVIZWlnaHRDYWxsYmFjaykpIHtcbiAgICBtb2RlbC5fcmVtb3ZlVXBkYXRlSGVpZ2h0Q2FsbGJhY2soKTtcbiAgICBtb2RlbC5fcmVtb3ZlVXBkYXRlSGVpZ2h0Q2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gIH1cblxuICB2YXIgc2NlbmUgPSBtb2RlbC5fc2NlbmU7XG4gIGlmIChcbiAgICAhZGVmaW5lZChzY2VuZSkgfHxcbiAgICAhZGVmaW5lZChzY2VuZS5nbG9iZSkgfHxcbiAgICBtb2RlbC5oZWlnaHRSZWZlcmVuY2UgPT09IEhlaWdodFJlZmVyZW5jZS5OT05FXG4gICkge1xuICAgIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gICAgaWYgKG1vZGVsLmhlaWdodFJlZmVyZW5jZSAhPT0gSGVpZ2h0UmVmZXJlbmNlLk5PTkUpIHtcbiAgICAgIHRocm93IG5ldyBEZXZlbG9wZXJFcnJvcihcbiAgICAgICAgXCJIZWlnaHQgcmVmZXJlbmNlIGlzIG5vdCBzdXBwb3J0ZWQgd2l0aG91dCBhIHNjZW5lIGFuZCBnbG9iZS5cIlxuICAgICAgKTtcbiAgICB9XG4gICAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG4gICAgbW9kZWwuX2NsYW1wZWRNb2RlbE1hdHJpeCA9IHVuZGVmaW5lZDtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgZ2xvYmUgPSBzY2VuZS5nbG9iZTtcbiAgdmFyIGVsbGlwc29pZCA9IGdsb2JlLmVsbGlwc29pZDtcblxuICAvLyBDb21wdXRlIGNhcnRvZ3JhcGhpYyBwb3NpdGlvbiBzbyB3ZSBkb24ndCByZWNvbXB1dGUgZXZlcnkgdXBkYXRlXG4gIHZhciBtb2RlbE1hdHJpeCA9IG1vZGVsLm1vZGVsTWF0cml4O1xuICBzY3JhdGNoUG9zaXRpb24ueCA9IG1vZGVsTWF0cml4WzEyXTtcbiAgc2NyYXRjaFBvc2l0aW9uLnkgPSBtb2RlbE1hdHJpeFsxM107XG4gIHNjcmF0Y2hQb3NpdGlvbi56ID0gbW9kZWxNYXRyaXhbMTRdO1xuICB2YXIgY2FydG9Qb3NpdGlvbiA9IGVsbGlwc29pZC5jYXJ0ZXNpYW5Ub0NhcnRvZ3JhcGhpYyhzY3JhdGNoUG9zaXRpb24pO1xuXG4gIGlmICghZGVmaW5lZChtb2RlbC5fY2xhbXBlZE1vZGVsTWF0cml4KSkge1xuICAgIG1vZGVsLl9jbGFtcGVkTW9kZWxNYXRyaXggPSBNYXRyaXg0LmNsb25lKG1vZGVsTWF0cml4LCBuZXcgTWF0cml4NCgpKTtcbiAgfVxuXG4gIC8vIEluc3RhbGwgY2FsbGJhY2sgdG8gaGFuZGxlIHVwZGF0aW5nIG9mIHRlcnJhaW4gdGlsZXNcbiAgdmFyIHN1cmZhY2UgPSBnbG9iZS5fc3VyZmFjZTtcbiAgbW9kZWwuX3JlbW92ZVVwZGF0ZUhlaWdodENhbGxiYWNrID0gc3VyZmFjZS51cGRhdGVIZWlnaHQoXG4gICAgY2FydG9Qb3NpdGlvbixcbiAgICBnZXRVcGRhdGVIZWlnaHRDYWxsYmFjayhtb2RlbCwgZWxsaXBzb2lkLCBjYXJ0b1Bvc2l0aW9uKVxuICApO1xuXG4gIC8vIFNldCB0aGUgY29ycmVjdCBoZWlnaHQgbm93XG4gIHZhciBoZWlnaHQgPSBnbG9iZS5nZXRIZWlnaHQoY2FydG9Qb3NpdGlvbik7XG4gIGlmIChkZWZpbmVkKGhlaWdodCkpIHtcbiAgICAvLyBHZXQgY2FsbGJhY2sgd2l0aCBjYXJ0b1Bvc2l0aW9uIGJlaW5nIHRoZSBub24tY2xhbXBlZCBwb3NpdGlvblxuICAgIHZhciBjYiA9IGdldFVwZGF0ZUhlaWdodENhbGxiYWNrKG1vZGVsLCBlbGxpcHNvaWQsIGNhcnRvUG9zaXRpb24pO1xuXG4gICAgLy8gQ29tcHV0ZSB0aGUgY2xhbXBlZCBjYXJ0ZXNpYW4gYW5kIGNhbGwgdXBkYXRlSGVpZ2h0IGNhbGxiYWNrXG4gICAgQ2FydG9ncmFwaGljLmNsb25lKGNhcnRvUG9zaXRpb24sIHNjcmF0Y2hDYXJ0b2dyYXBoaWMpO1xuICAgIHNjcmF0Y2hDYXJ0b2dyYXBoaWMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIGVsbGlwc29pZC5jYXJ0b2dyYXBoaWNUb0NhcnRlc2lhbihzY3JhdGNoQ2FydG9ncmFwaGljLCBzY3JhdGNoUG9zaXRpb24pO1xuICAgIGNiKHNjcmF0Y2hQb3NpdGlvbik7XG4gIH1cbn1cblxudmFyIHNjcmF0Y2hEaXNwbGF5Q29uZGl0aW9uQ2FydGVzaWFuID0gbmV3IENhcnRlc2lhbjMoKTtcbnZhciBzY3JhdGNoRGlzdGFuY2VEaXNwbGF5Q29uZGl0aW9uQ2FydG9ncmFwaGljID0gbmV3IENhcnRvZ3JhcGhpYygpO1xuXG5mdW5jdGlvbiBkaXN0YW5jZURpc3BsYXlDb25kaXRpb25WaXNpYmxlKG1vZGVsLCBmcmFtZVN0YXRlKSB7XG4gIHZhciBkaXN0YW5jZTI7XG4gIHZhciBkZGMgPSBtb2RlbC5kaXN0YW5jZURpc3BsYXlDb25kaXRpb247XG4gIHZhciBuZWFyU3F1YXJlZCA9IGRkYy5uZWFyICogZGRjLm5lYXI7XG4gIHZhciBmYXJTcXVhcmVkID0gZGRjLmZhciAqIGRkYy5mYXI7XG5cbiAgaWYgKGZyYW1lU3RhdGUubW9kZSA9PT0gU2NlbmVNb2RlLlNDRU5FMkQpIHtcbiAgICB2YXIgZnJ1c3R1bTJEV2lkdGggPVxuICAgICAgZnJhbWVTdGF0ZS5jYW1lcmEuZnJ1c3R1bS5yaWdodCAtIGZyYW1lU3RhdGUuY2FtZXJhLmZydXN0dW0ubGVmdDtcbiAgICBkaXN0YW5jZTIgPSBmcnVzdHVtMkRXaWR0aCAqIDAuNTtcbiAgICBkaXN0YW5jZTIgPSBkaXN0YW5jZTIgKiBkaXN0YW5jZTI7XG4gIH0gZWxzZSB7XG4gICAgLy8gRGlzdGFuY2UgdG8gY2VudGVyIG9mIHByaW1pdGl2ZSdzIHJlZmVyZW5jZSBmcmFtZVxuICAgIHZhciBwb3NpdGlvbiA9IE1hdHJpeDQuZ2V0VHJhbnNsYXRpb24oXG4gICAgICBtb2RlbC5tb2RlbE1hdHJpeCxcbiAgICAgIHNjcmF0Y2hEaXNwbGF5Q29uZGl0aW9uQ2FydGVzaWFuXG4gICAgKTtcbiAgICBpZiAoZnJhbWVTdGF0ZS5tb2RlID09PSBTY2VuZU1vZGUuQ09MVU1CVVNfVklFVykge1xuICAgICAgdmFyIHByb2plY3Rpb24gPSBmcmFtZVN0YXRlLm1hcFByb2plY3Rpb247XG4gICAgICB2YXIgZWxsaXBzb2lkID0gcHJvamVjdGlvbi5lbGxpcHNvaWQ7XG4gICAgICB2YXIgY2FydG9ncmFwaGljID0gZWxsaXBzb2lkLmNhcnRlc2lhblRvQ2FydG9ncmFwaGljKFxuICAgICAgICBwb3NpdGlvbixcbiAgICAgICAgc2NyYXRjaERpc3RhbmNlRGlzcGxheUNvbmRpdGlvbkNhcnRvZ3JhcGhpY1xuICAgICAgKTtcbiAgICAgIHBvc2l0aW9uID0gcHJvamVjdGlvbi5wcm9qZWN0KGNhcnRvZ3JhcGhpYywgcG9zaXRpb24pO1xuICAgICAgQ2FydGVzaWFuMy5mcm9tRWxlbWVudHMocG9zaXRpb24ueiwgcG9zaXRpb24ueCwgcG9zaXRpb24ueSwgcG9zaXRpb24pO1xuICAgIH1cbiAgICBkaXN0YW5jZTIgPSBDYXJ0ZXNpYW4zLmRpc3RhbmNlU3F1YXJlZChcbiAgICAgIHBvc2l0aW9uLFxuICAgICAgZnJhbWVTdGF0ZS5jYW1lcmEucG9zaXRpb25XQ1xuICAgICk7XG4gIH1cblxuICByZXR1cm4gZGlzdGFuY2UyID49IG5lYXJTcXVhcmVkICYmIGRpc3RhbmNlMiA8PSBmYXJTcXVhcmVkO1xufVxuXG52YXIgc2NyYXRjaENsaXBwaW5nUGxhbmVzTWF0cml4ID0gbmV3IE1hdHJpeDQoKTtcbnZhciBzY3JhdGNoSUJMUmVmZXJlbmNlRnJhbWVNYXRyaXg0ID0gbmV3IE1hdHJpeDQoKTtcbnZhciBzY3JhdGNoSUJMUmVmZXJlbmNlRnJhbWVNYXRyaXgzID0gbmV3IE1hdHJpeDMoKTtcblxuLyoqXG4gKiBDYWxsZWQgd2hlbiB7QGxpbmsgVmlld2VyfSBvciB7QGxpbmsgQ2VzaXVtV2lkZ2V0fSByZW5kZXIgdGhlIHNjZW5lIHRvXG4gKiBnZXQgdGhlIGRyYXcgY29tbWFuZHMgbmVlZGVkIHRvIHJlbmRlciB0aGlzIHByaW1pdGl2ZS5cbiAqIDxwPlxuICogRG8gbm90IGNhbGwgdGhpcyBmdW5jdGlvbiBkaXJlY3RseS4gIFRoaXMgaXMgZG9jdW1lbnRlZCBqdXN0IHRvXG4gKiBsaXN0IHRoZSBleGNlcHRpb25zIHRoYXQgbWF5IGJlIHByb3BhZ2F0ZWQgd2hlbiB0aGUgc2NlbmUgaXMgcmVuZGVyZWQ6XG4gKiA8L3A+XG4gKlxuICogQGV4Y2VwdGlvbiB7UnVudGltZUVycm9yfSBGYWlsZWQgdG8gbG9hZCBleHRlcm5hbCByZWZlcmVuY2UuXG4gKi9cbk1vZGVsLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoZnJhbWVTdGF0ZSkge1xuICBpZiAoZnJhbWVTdGF0ZS5tb2RlID09PSBTY2VuZU1vZGUuTU9SUEhJTkcpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoIUZlYXR1cmVEZXRlY3Rpb24uc3VwcG9ydHNXZWJQLmluaXRpYWxpemVkKSB7XG4gICAgRmVhdHVyZURldGVjdGlvbi5zdXBwb3J0c1dlYlAuaW5pdGlhbGl6ZSgpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBjb250ZXh0ID0gZnJhbWVTdGF0ZS5jb250ZXh0O1xuICB0aGlzLl9kZWZhdWx0VGV4dHVyZSA9IGNvbnRleHQuZGVmYXVsdFRleHR1cmU7XG5cbiAgdmFyIHN1cHBvcnRzV2ViUCA9IEZlYXR1cmVEZXRlY3Rpb24uc3VwcG9ydHNXZWJQKCk7XG5cbiAgaWYgKHRoaXMuX3N0YXRlID09PSBNb2RlbFN0YXRlLk5FRURTX0xPQUQgJiYgZGVmaW5lZCh0aGlzLmdsdGYpKSB7XG4gICAgLy8gVXNlIHJlbmRlcmVyIHJlc291cmNlcyBmcm9tIGNhY2hlIGluc3RlYWQgb2YgbG9hZGluZy9jcmVhdGluZyB0aGVtP1xuICAgIHZhciBjYWNoZWRSZW5kZXJlclJlc291cmNlcztcbiAgICB2YXIgY2FjaGVLZXkgPSB0aGlzLmNhY2hlS2V5O1xuICAgIGlmIChkZWZpbmVkKGNhY2hlS2V5KSkge1xuICAgICAgLy8gY2FjaGUga2V5IGdpdmVuPyB0aGlzIG1vZGVsIHdpbGwgcHVsbCBmcm9tIG9yIGNvbnRyaWJ1dGUgdG8gY29udGV4dCBsZXZlbCBjYWNoZVxuICAgICAgY29udGV4dC5jYWNoZS5tb2RlbFJlbmRlcmVyUmVzb3VyY2VDYWNoZSA9IGRlZmF1bHRWYWx1ZShcbiAgICAgICAgY29udGV4dC5jYWNoZS5tb2RlbFJlbmRlcmVyUmVzb3VyY2VDYWNoZSxcbiAgICAgICAge31cbiAgICAgICk7XG4gICAgICB2YXIgbW9kZWxDYWNoZXMgPSBjb250ZXh0LmNhY2hlLm1vZGVsUmVuZGVyZXJSZXNvdXJjZUNhY2hlO1xuXG4gICAgICBjYWNoZWRSZW5kZXJlclJlc291cmNlcyA9IG1vZGVsQ2FjaGVzW3RoaXMuY2FjaGVLZXldO1xuICAgICAgaWYgKGRlZmluZWQoY2FjaGVkUmVuZGVyZXJSZXNvdXJjZXMpKSB7XG4gICAgICAgIGlmICghY2FjaGVkUmVuZGVyZXJSZXNvdXJjZXMucmVhZHkpIHtcbiAgICAgICAgICAvLyBDYWNoZWQgcmVzb3VyY2VzIGZvciB0aGUgbW9kZWwgYXJlIG5vdCBsb2FkZWQgeWV0LiAgV2UnbGxcbiAgICAgICAgICAvLyB0cnkgYWdhaW4gZXZlcnkgZnJhbWUgdW50aWwgdGhleSBhcmUuXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgKytjYWNoZWRSZW5kZXJlclJlc291cmNlcy5jb3VudDtcbiAgICAgICAgdGhpcy5fbG9hZFJlbmRlcmVyUmVzb3VyY2VzRnJvbUNhY2hlID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNhY2hlZFJlbmRlcmVyUmVzb3VyY2VzID0gbmV3IENhY2hlZFJlbmRlcmVyUmVzb3VyY2VzKFxuICAgICAgICAgIGNvbnRleHQsXG4gICAgICAgICAgY2FjaGVLZXlcbiAgICAgICAgKTtcbiAgICAgICAgY2FjaGVkUmVuZGVyZXJSZXNvdXJjZXMuY291bnQgPSAxO1xuICAgICAgICBtb2RlbENhY2hlc1t0aGlzLmNhY2hlS2V5XSA9IGNhY2hlZFJlbmRlcmVyUmVzb3VyY2VzO1xuICAgICAgfVxuICAgICAgdGhpcy5fY2FjaGVkUmVuZGVyZXJSZXNvdXJjZXMgPSBjYWNoZWRSZW5kZXJlclJlc291cmNlcztcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gY2FjaGUga2V5IG5vdCBnaXZlbj8gdGhpcyBtb2RlbCBkb2Vzbid0IGNhcmUgYWJvdXQgY29udGV4dCBsZXZlbCBjYWNoZSBhdCBhbGwuIENhY2hlIGlzIGhlcmUgdG8gc2ltcGxpZnkgZnJlZWluZyBvbiBkZXN0cm95LlxuICAgICAgY2FjaGVkUmVuZGVyZXJSZXNvdXJjZXMgPSBuZXcgQ2FjaGVkUmVuZGVyZXJSZXNvdXJjZXMoY29udGV4dCk7XG4gICAgICBjYWNoZWRSZW5kZXJlclJlc291cmNlcy5jb3VudCA9IDE7XG4gICAgICB0aGlzLl9jYWNoZWRSZW5kZXJlclJlc291cmNlcyA9IGNhY2hlZFJlbmRlcmVyUmVzb3VyY2VzO1xuICAgIH1cblxuICAgIHRoaXMuX3N0YXRlID0gTW9kZWxTdGF0ZS5MT0FESU5HO1xuICAgIGlmICh0aGlzLl9zdGF0ZSAhPT0gTW9kZWxTdGF0ZS5GQUlMRUQpIHtcbiAgICAgIHZhciBleHRlbnNpb25zID0gdGhpcy5nbHRmLmV4dGVuc2lvbnM7XG4gICAgICBpZiAoZGVmaW5lZChleHRlbnNpb25zKSAmJiBkZWZpbmVkKGV4dGVuc2lvbnMuQ0VTSVVNX1JUQykpIHtcbiAgICAgICAgdmFyIGNlbnRlciA9IENhcnRlc2lhbjMuZnJvbUFycmF5KGV4dGVuc2lvbnMuQ0VTSVVNX1JUQy5jZW50ZXIpO1xuICAgICAgICBpZiAoIUNhcnRlc2lhbjMuZXF1YWxzKGNlbnRlciwgQ2FydGVzaWFuMy5aRVJPKSkge1xuICAgICAgICAgIHRoaXMuX3J0Y0NlbnRlcjNEID0gY2VudGVyO1xuXG4gICAgICAgICAgdmFyIHByb2plY3Rpb24gPSBmcmFtZVN0YXRlLm1hcFByb2plY3Rpb247XG4gICAgICAgICAgdmFyIGVsbGlwc29pZCA9IHByb2plY3Rpb24uZWxsaXBzb2lkO1xuICAgICAgICAgIHZhciBjYXJ0b2dyYXBoaWMgPSBlbGxpcHNvaWQuY2FydGVzaWFuVG9DYXJ0b2dyYXBoaWMoXG4gICAgICAgICAgICB0aGlzLl9ydGNDZW50ZXIzRFxuICAgICAgICAgICk7XG4gICAgICAgICAgdmFyIHByb2plY3RlZENhcnQgPSBwcm9qZWN0aW9uLnByb2plY3QoY2FydG9ncmFwaGljKTtcbiAgICAgICAgICBDYXJ0ZXNpYW4zLmZyb21FbGVtZW50cyhcbiAgICAgICAgICAgIHByb2plY3RlZENhcnQueixcbiAgICAgICAgICAgIHByb2plY3RlZENhcnQueCxcbiAgICAgICAgICAgIHByb2plY3RlZENhcnQueSxcbiAgICAgICAgICAgIHByb2plY3RlZENhcnRcbiAgICAgICAgICApO1xuICAgICAgICAgIHRoaXMuX3J0Y0NlbnRlcjJEID0gcHJvamVjdGVkQ2FydDtcblxuICAgICAgICAgIHRoaXMuX3J0Y0NlbnRlckV5ZSA9IG5ldyBDYXJ0ZXNpYW4zKCk7XG4gICAgICAgICAgdGhpcy5fcnRjQ2VudGVyID0gdGhpcy5fcnRjQ2VudGVyM0Q7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgYWRkUGlwZWxpbmVFeHRyYXModGhpcy5nbHRmKTtcblxuICAgICAgdGhpcy5fbG9hZFJlc291cmNlcyA9IG5ldyBNb2RlbExvYWRSZXNvdXJjZXMoKTtcbiAgICAgIGlmICghdGhpcy5fbG9hZFJlbmRlcmVyUmVzb3VyY2VzRnJvbUNhY2hlKSB7XG4gICAgICAgIC8vIEJ1ZmZlcnMgYXJlIHJlcXVpcmVkIHRvIHVwZGF0ZVZlcnNpb25cbiAgICAgICAgTW9kZWxVdGlsaXR5LnBhcnNlQnVmZmVycyh0aGlzLCBidWZmZXJMb2FkKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2YXIgbG9hZFJlc291cmNlcyA9IHRoaXMuX2xvYWRSZXNvdXJjZXM7XG4gIHZhciBpbmNyZW1lbnRhbGx5TG9hZFRleHR1cmVzID0gdGhpcy5faW5jcmVtZW50YWxseUxvYWRUZXh0dXJlcztcbiAgdmFyIGp1c3RMb2FkZWQgPSBmYWxzZTtcblxuICBpZiAodGhpcy5fc3RhdGUgPT09IE1vZGVsU3RhdGUuTE9BRElORykge1xuICAgIC8vIFRyYW5zaXRpb24gZnJvbSBMT0FESU5HIC0+IExPQURFRCBvbmNlIHJlc291cmNlcyBhcmUgZG93bmxvYWRlZCBhbmQgY3JlYXRlZC5cbiAgICAvLyBUZXh0dXJlcyBtYXkgY29udGludWUgdG8gc3RyZWFtIGluIHdoaWxlIGluIHRoZSBMT0FERUQgc3RhdGUuXG4gICAgaWYgKGxvYWRSZXNvdXJjZXMucGVuZGluZ0J1ZmZlckxvYWRzID09PSAwKSB7XG4gICAgICBpZiAoIWxvYWRSZXNvdXJjZXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgZnJhbWVTdGF0ZS5icmRmTHV0R2VuZXJhdG9yLnVwZGF0ZShmcmFtZVN0YXRlKTtcblxuICAgICAgICBNb2RlbFV0aWxpdHkuY2hlY2tTdXBwb3J0ZWRFeHRlbnNpb25zKFxuICAgICAgICAgIHRoaXMuZXh0ZW5zaW9uc1JlcXVpcmVkLFxuICAgICAgICAgIHN1cHBvcnRzV2ViUFxuICAgICAgICApO1xuICAgICAgICBNb2RlbFV0aWxpdHkudXBkYXRlRm9yd2FyZEF4aXModGhpcyk7XG5cbiAgICAgICAgLy8gZ2xURiBwaXBlbGluZSB1cGRhdGVzLCBub3QgbmVlZGVkIGlmIGxvYWRpbmcgZnJvbSBjYWNoZVxuICAgICAgICBpZiAoIWRlZmluZWQodGhpcy5nbHRmLmV4dHJhcy5zb3VyY2VWZXJzaW9uKSkge1xuICAgICAgICAgIHZhciBnbHRmID0gdGhpcy5nbHRmO1xuICAgICAgICAgIC8vIEFkZCB0aGUgb3JpZ2luYWwgdmVyc2lvbiBzbyBpdCByZW1haW5zIGNhY2hlZFxuICAgICAgICAgIGdsdGYuZXh0cmFzLnNvdXJjZVZlcnNpb24gPSBNb2RlbFV0aWxpdHkuZ2V0QXNzZXRWZXJzaW9uKGdsdGYpO1xuICAgICAgICAgIGdsdGYuZXh0cmFzLnNvdXJjZUtIUlRlY2huaXF1ZXNXZWJHTCA9IGRlZmluZWQoXG4gICAgICAgICAgICBNb2RlbFV0aWxpdHkuZ2V0VXNlZEV4dGVuc2lvbnMoZ2x0ZikuS0hSX3RlY2huaXF1ZXNfd2ViZ2xcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgdGhpcy5fc291cmNlVmVyc2lvbiA9IGdsdGYuZXh0cmFzLnNvdXJjZVZlcnNpb247XG4gICAgICAgICAgdGhpcy5fc291cmNlS0hSVGVjaG5pcXVlc1dlYkdMID0gZ2x0Zi5leHRyYXMuc291cmNlS0hSVGVjaG5pcXVlc1dlYkdMO1xuXG4gICAgICAgICAgdXBkYXRlVmVyc2lvbihnbHRmKTtcbiAgICAgICAgICBhZGREZWZhdWx0cyhnbHRmKTtcblxuICAgICAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICAgICAgYWRkQmF0Y2hJZFRvR2VuZXJhdGVkU2hhZGVyczogdGhpcy5fYWRkQmF0Y2hJZFRvR2VuZXJhdGVkU2hhZGVycyxcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgcHJvY2Vzc01vZGVsTWF0ZXJpYWxzQ29tbW9uKGdsdGYsIG9wdGlvbnMpO1xuICAgICAgICAgIHByb2Nlc3NQYnJNYXRlcmlhbHMoZ2x0Ziwgb3B0aW9ucyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9zb3VyY2VWZXJzaW9uID0gdGhpcy5nbHRmLmV4dHJhcy5zb3VyY2VWZXJzaW9uO1xuICAgICAgICB0aGlzLl9zb3VyY2VLSFJUZWNobmlxdWVzV2ViR0wgPSB0aGlzLmdsdGYuZXh0cmFzLnNvdXJjZUtIUlRlY2huaXF1ZXNXZWJHTDtcblxuICAgICAgICAvLyBTa2lwIGRlcXVhbnRpemluZyBpbiB0aGUgc2hhZGVyIGlmIG5vdCBlbmNvZGVkXG4gICAgICAgIHRoaXMuX2RlcXVhbnRpemVJblNoYWRlciA9XG4gICAgICAgICAgdGhpcy5fZGVxdWFudGl6ZUluU2hhZGVyICYmIERyYWNvTG9hZGVyLmhhc0V4dGVuc2lvbih0aGlzKTtcblxuICAgICAgICAvLyBXZSBkbyB0aGlzIGFmdGVyIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBpZHMgZG9uJ3QgY2hhbmdlXG4gICAgICAgIGFkZEJ1ZmZlcnNUb0xvYWRSZXNvdXJjZXModGhpcyk7XG4gICAgICAgIHBhcnNlQXJ0aWN1bGF0aW9ucyh0aGlzKTtcbiAgICAgICAgcGFyc2VUZWNobmlxdWVzKHRoaXMpO1xuICAgICAgICBpZiAoIXRoaXMuX2xvYWRSZW5kZXJlclJlc291cmNlc0Zyb21DYWNoZSkge1xuICAgICAgICAgIHBhcnNlQnVmZmVyVmlld3ModGhpcyk7XG4gICAgICAgICAgcGFyc2VTaGFkZXJzKHRoaXMpO1xuICAgICAgICAgIHBhcnNlUHJvZ3JhbXModGhpcyk7XG4gICAgICAgICAgcGFyc2VUZXh0dXJlcyh0aGlzLCBjb250ZXh0LCBzdXBwb3J0c1dlYlApO1xuICAgICAgICB9XG4gICAgICAgIHBhcnNlTWF0ZXJpYWxzKHRoaXMpO1xuICAgICAgICBwYXJzZU1lc2hlcyh0aGlzKTtcbiAgICAgICAgcGFyc2VOb2Rlcyh0aGlzKTtcblxuICAgICAgICAvLyBTdGFydCBkcmFjbyBkZWNvZGluZ1xuICAgICAgICBEcmFjb0xvYWRlci5wYXJzZSh0aGlzLCBjb250ZXh0KTtcblxuICAgICAgICBsb2FkUmVzb3VyY2VzLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFsb2FkUmVzb3VyY2VzLmZpbmlzaGVkRGVjb2RpbmcoKSkge1xuICAgICAgICBEcmFjb0xvYWRlci5kZWNvZGVNb2RlbCh0aGlzLCBjb250ZXh0KS5vdGhlcndpc2UoXG4gICAgICAgICAgTW9kZWxVdGlsaXR5LmdldEZhaWxlZExvYWRGdW5jdGlvbih0aGlzLCBcIm1vZGVsXCIsIHRoaXMuYmFzZVBhdGgpXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGlmIChsb2FkUmVzb3VyY2VzLmZpbmlzaGVkRGVjb2RpbmcoKSAmJiAhbG9hZFJlc291cmNlcy5yZXNvdXJjZXNQYXJzZWQpIHtcbiAgICAgICAgdGhpcy5fYm91bmRpbmdTcGhlcmUgPSBNb2RlbFV0aWxpdHkuY29tcHV0ZUJvdW5kaW5nU3BoZXJlKHRoaXMpO1xuICAgICAgICB0aGlzLl9pbml0aWFsUmFkaXVzID0gdGhpcy5fYm91bmRpbmdTcGhlcmUucmFkaXVzO1xuXG4gICAgICAgIERyYWNvTG9hZGVyLmNhY2hlRGF0YUZvck1vZGVsKHRoaXMpO1xuXG4gICAgICAgIGxvYWRSZXNvdXJjZXMucmVzb3VyY2VzUGFyc2VkID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKFxuICAgICAgICBsb2FkUmVzb3VyY2VzLnJlc291cmNlc1BhcnNlZCAmJlxuICAgICAgICBsb2FkUmVzb3VyY2VzLnBlbmRpbmdTaGFkZXJMb2FkcyA9PT0gMFxuICAgICAgKSB7XG4gICAgICAgIGlmICh0aGlzLnNob3dPdXRsaW5lKSB7XG4gICAgICAgICAgTW9kZWxPdXRsaW5lTG9hZGVyLm91dGxpbmVQcmltaXRpdmVzKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIGNyZWF0ZVJlc291cmNlcyh0aGlzLCBmcmFtZVN0YXRlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoXG4gICAgICBsb2FkUmVzb3VyY2VzLmZpbmlzaGVkKCkgfHxcbiAgICAgIChpbmNyZW1lbnRhbGx5TG9hZFRleHR1cmVzICYmXG4gICAgICAgIGxvYWRSZXNvdXJjZXMuZmluaXNoZWRFdmVyeXRoaW5nQnV0VGV4dHVyZUNyZWF0aW9uKCkpXG4gICAgKSB7XG4gICAgICB0aGlzLl9zdGF0ZSA9IE1vZGVsU3RhdGUuTE9BREVEO1xuICAgICAganVzdExvYWRlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgLy8gSW5jcmVtZW50YWxseSBzdHJlYW0gdGV4dHVyZXMuXG4gIGlmIChkZWZpbmVkKGxvYWRSZXNvdXJjZXMpICYmIHRoaXMuX3N0YXRlID09PSBNb2RlbFN0YXRlLkxPQURFRCkge1xuICAgIGlmIChpbmNyZW1lbnRhbGx5TG9hZFRleHR1cmVzICYmICFqdXN0TG9hZGVkKSB7XG4gICAgICBjcmVhdGVSZXNvdXJjZXModGhpcywgZnJhbWVTdGF0ZSk7XG4gICAgfVxuXG4gICAgaWYgKGxvYWRSZXNvdXJjZXMuZmluaXNoZWQoKSkge1xuICAgICAgdGhpcy5fbG9hZFJlc291cmNlcyA9IHVuZGVmaW5lZDsgLy8gQ2xlYXIgQ1BVIG1lbW9yeSBzaW5jZSBXZWJHTCByZXNvdXJjZXMgd2VyZSBjcmVhdGVkLlxuXG4gICAgICB2YXIgcmVzb3VyY2VzID0gdGhpcy5fcmVuZGVyZXJSZXNvdXJjZXM7XG4gICAgICB2YXIgY2FjaGVkUmVzb3VyY2VzID0gdGhpcy5fY2FjaGVkUmVuZGVyZXJSZXNvdXJjZXM7XG5cbiAgICAgIGNhY2hlZFJlc291cmNlcy5idWZmZXJzID0gcmVzb3VyY2VzLmJ1ZmZlcnM7XG4gICAgICBjYWNoZWRSZXNvdXJjZXMudmVydGV4QXJyYXlzID0gcmVzb3VyY2VzLnZlcnRleEFycmF5cztcbiAgICAgIGNhY2hlZFJlc291cmNlcy5wcm9ncmFtcyA9IHJlc291cmNlcy5wcm9ncmFtcztcbiAgICAgIGNhY2hlZFJlc291cmNlcy5zb3VyY2VTaGFkZXJzID0gcmVzb3VyY2VzLnNvdXJjZVNoYWRlcnM7XG4gICAgICBjYWNoZWRSZXNvdXJjZXMuc2lsaG91ZXR0ZVByb2dyYW1zID0gcmVzb3VyY2VzLnNpbGhvdWV0dGVQcm9ncmFtcztcbiAgICAgIGNhY2hlZFJlc291cmNlcy50ZXh0dXJlcyA9IHJlc291cmNlcy50ZXh0dXJlcztcbiAgICAgIGNhY2hlZFJlc291cmNlcy5zYW1wbGVycyA9IHJlc291cmNlcy5zYW1wbGVycztcbiAgICAgIGNhY2hlZFJlc291cmNlcy5yZW5kZXJTdGF0ZXMgPSByZXNvdXJjZXMucmVuZGVyU3RhdGVzO1xuICAgICAgY2FjaGVkUmVzb3VyY2VzLnJlYWR5ID0gdHJ1ZTtcblxuICAgICAgLy8gVGhlIG5vcm1hbCBhdHRyaWJ1dGUgbmFtZSBpcyByZXF1aXJlZCBmb3Igc2lsaG91ZXR0ZXMsIHNvIGdldCBpdCBiZWZvcmUgdGhlIGdsdGYgSlNPTiBpcyByZWxlYXNlZFxuICAgICAgdGhpcy5fbm9ybWFsQXR0cmlidXRlTmFtZSA9IE1vZGVsVXRpbGl0eS5nZXRBdHRyaWJ1dGVPclVuaWZvcm1CeVNlbWFudGljKFxuICAgICAgICB0aGlzLmdsdGYsXG4gICAgICAgIFwiTk9STUFMXCJcbiAgICAgICk7XG5cbiAgICAgIC8vIFZlcnRleCBhcnJheXMgYXJlIHVuaXF1ZSB0byB0aGlzIG1vZGVsLCBkbyBub3Qgc3RvcmUgaW4gY2FjaGUuXG4gICAgICBpZiAoZGVmaW5lZCh0aGlzLl9wcmVjcmVhdGVkQXR0cmlidXRlcykpIHtcbiAgICAgICAgY2FjaGVkUmVzb3VyY2VzLnZlcnRleEFycmF5cyA9IHt9O1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5yZWxlYXNlR2x0Zkpzb24pIHtcbiAgICAgICAgcmVsZWFzZUNhY2hlZEdsdGYodGhpcyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdmFyIGlibFN1cHBvcnRlZCA9IE9jdGFoZWRyYWxQcm9qZWN0ZWRDdWJlTWFwLmlzU3VwcG9ydGVkKGNvbnRleHQpO1xuICBpZiAodGhpcy5fc2hvdWxkVXBkYXRlU3BlY3VsYXJNYXBBdGxhcyAmJiBpYmxTdXBwb3J0ZWQpIHtcbiAgICB0aGlzLl9zaG91bGRVcGRhdGVTcGVjdWxhck1hcEF0bGFzID0gZmFsc2U7XG4gICAgdGhpcy5fc3BlY3VsYXJFbnZpcm9ubWVudE1hcEF0bGFzID1cbiAgICAgIHRoaXMuX3NwZWN1bGFyRW52aXJvbm1lbnRNYXBBdGxhcyAmJlxuICAgICAgdGhpcy5fc3BlY3VsYXJFbnZpcm9ubWVudE1hcEF0bGFzLmRlc3Ryb3koKTtcbiAgICB0aGlzLl9zcGVjdWxhckVudmlyb25tZW50TWFwQXRsYXMgPSB1bmRlZmluZWQ7XG4gICAgaWYgKGRlZmluZWQodGhpcy5fc3BlY3VsYXJFbnZpcm9ubWVudE1hcHMpKSB7XG4gICAgICB0aGlzLl9zcGVjdWxhckVudmlyb25tZW50TWFwQXRsYXMgPSBuZXcgT2N0YWhlZHJhbFByb2plY3RlZEN1YmVNYXAoXG4gICAgICAgIHRoaXMuX3NwZWN1bGFyRW52aXJvbm1lbnRNYXBzXG4gICAgICApO1xuICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgdGhpcy5fc3BlY3VsYXJFbnZpcm9ubWVudE1hcEF0bGFzLnJlYWR5UHJvbWlzZVxuICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGhhdC5fc2hvdWxkUmVnZW5lcmF0ZVNoYWRlcnMgPSB0cnVlO1xuICAgICAgICB9KVxuICAgICAgICAub3RoZXJ3aXNlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBsb2FkaW5nIHNwZWN1bGFyRW52aXJvbm1lbnRNYXBzOiBcIiArIGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gUmVnZW5lcmF0ZSBzaGFkZXJzIHRvIG5vdCB1c2UgYW4gZW52aXJvbm1lbnQgbWFwLiBXaWxsIGJlIHNldCB0byB0cnVlIGFnYWluIGlmIHRoZXJlIHdhcyBhIG5ldyBlbnZpcm9ubWVudCBtYXAgYW5kIGl0IGlzIHJlYWR5LlxuICAgIHRoaXMuX3Nob3VsZFJlZ2VuZXJhdGVTaGFkZXJzID0gdHJ1ZTtcbiAgfVxuXG4gIGlmIChkZWZpbmVkKHRoaXMuX3NwZWN1bGFyRW52aXJvbm1lbnRNYXBBdGxhcykpIHtcbiAgICB0aGlzLl9zcGVjdWxhckVudmlyb25tZW50TWFwQXRsYXMudXBkYXRlKGZyYW1lU3RhdGUpO1xuICB9XG5cbiAgdmFyIHJlY29tcGlsZVdpdGhEZWZhdWx0QXRsYXMgPVxuICAgICFkZWZpbmVkKHRoaXMuX3NwZWN1bGFyRW52aXJvbm1lbnRNYXBBdGxhcykgJiZcbiAgICBkZWZpbmVkKGZyYW1lU3RhdGUuc3BlY3VsYXJFbnZpcm9ubWVudE1hcHMpICYmXG4gICAgIXRoaXMuX3VzZURlZmF1bHRTcGVjdWxhck1hcHM7XG4gIHZhciByZWNvbXBpbGVXaXRob3V0RGVmYXVsdEF0bGFzID1cbiAgICAhZGVmaW5lZChmcmFtZVN0YXRlLnNwZWN1bGFyRW52aXJvbm1lbnRNYXBzKSAmJlxuICAgIHRoaXMuX3VzZURlZmF1bHRTcGVjdWxhck1hcHM7XG5cbiAgdmFyIHJlY29tcGlsZVdpdGhEZWZhdWx0U0hDb2VmZnMgPVxuICAgICFkZWZpbmVkKHRoaXMuX3NwaGVyaWNhbEhhcm1vbmljQ29lZmZpY2llbnRzKSAmJlxuICAgIGRlZmluZWQoZnJhbWVTdGF0ZS5zcGhlcmljYWxIYXJtb25pY0NvZWZmaWNpZW50cykgJiZcbiAgICAhdGhpcy5fdXNlRGVmYXVsdFNwaGVyaWNhbEhhcm1vbmljcztcbiAgdmFyIHJlY29tcGlsZVdpdGhvdXREZWZhdWx0U0hDb2VmZnMgPVxuICAgICFkZWZpbmVkKGZyYW1lU3RhdGUuc3BoZXJpY2FsSGFybW9uaWNDb2VmZmljaWVudHMpICYmXG4gICAgdGhpcy5fdXNlRGVmYXVsdFNwaGVyaWNhbEhhcm1vbmljcztcblxuICB0aGlzLl9zaG91bGRSZWdlbmVyYXRlU2hhZGVycyA9XG4gICAgdGhpcy5fc2hvdWxkUmVnZW5lcmF0ZVNoYWRlcnMgfHxcbiAgICByZWNvbXBpbGVXaXRoRGVmYXVsdEF0bGFzIHx8XG4gICAgcmVjb21waWxlV2l0aG91dERlZmF1bHRBdGxhcyB8fFxuICAgIHJlY29tcGlsZVdpdGhEZWZhdWx0U0hDb2VmZnMgfHxcbiAgICByZWNvbXBpbGVXaXRob3V0RGVmYXVsdFNIQ29lZmZzO1xuXG4gIHRoaXMuX3VzZURlZmF1bHRTcGVjdWxhck1hcHMgPVxuICAgICFkZWZpbmVkKHRoaXMuX3NwZWN1bGFyRW52aXJvbm1lbnRNYXBBdGxhcykgJiZcbiAgICBkZWZpbmVkKGZyYW1lU3RhdGUuc3BlY3VsYXJFbnZpcm9ubWVudE1hcHMpO1xuICB0aGlzLl91c2VEZWZhdWx0U3BoZXJpY2FsSGFybW9uaWNzID1cbiAgICAhZGVmaW5lZCh0aGlzLl9zcGhlcmljYWxIYXJtb25pY0NvZWZmaWNpZW50cykgJiZcbiAgICBkZWZpbmVkKGZyYW1lU3RhdGUuc3BoZXJpY2FsSGFybW9uaWNDb2VmZmljaWVudHMpO1xuXG4gIHZhciBzaWxob3VldHRlID0gaGFzU2lsaG91ZXR0ZSh0aGlzLCBmcmFtZVN0YXRlKTtcbiAgdmFyIHRyYW5zbHVjZW50ID0gaXNUcmFuc2x1Y2VudCh0aGlzKTtcbiAgdmFyIGludmlzaWJsZSA9IGlzSW52aXNpYmxlKHRoaXMpO1xuICB2YXIgYmFja0ZhY2VDdWxsaW5nID0gdGhpcy5iYWNrRmFjZUN1bGxpbmc7XG4gIHZhciBkaXNwbGF5Q29uZGl0aW9uUGFzc2VkID0gZGVmaW5lZCh0aGlzLmRpc3RhbmNlRGlzcGxheUNvbmRpdGlvbilcbiAgICA/IGRpc3RhbmNlRGlzcGxheUNvbmRpdGlvblZpc2libGUodGhpcywgZnJhbWVTdGF0ZSlcbiAgICA6IHRydWU7XG4gIHZhciBzaG93ID1cbiAgICB0aGlzLnNob3cgJiZcbiAgICBkaXNwbGF5Q29uZGl0aW9uUGFzc2VkICYmXG4gICAgdGhpcy5zY2FsZSAhPT0gMC4wICYmXG4gICAgKCFpbnZpc2libGUgfHwgc2lsaG91ZXR0ZSk7XG5cbiAgaWYgKChzaG93ICYmIHRoaXMuX3N0YXRlID09PSBNb2RlbFN0YXRlLkxPQURFRCkgfHwganVzdExvYWRlZCkge1xuICAgIHZhciBhbmltYXRlZCA9XG4gICAgICB0aGlzLmFjdGl2ZUFuaW1hdGlvbnMudXBkYXRlKGZyYW1lU3RhdGUpIHx8IHRoaXMuX2Nlc2l1bUFuaW1hdGlvbnNEaXJ0eTtcbiAgICB0aGlzLl9jZXNpdW1BbmltYXRpb25zRGlydHkgPSBmYWxzZTtcbiAgICB0aGlzLl9kaXJ0eSA9IGZhbHNlO1xuICAgIHZhciBtb2RlbE1hdHJpeCA9IHRoaXMubW9kZWxNYXRyaXg7XG5cbiAgICB2YXIgbW9kZUNoYW5nZWQgPSBmcmFtZVN0YXRlLm1vZGUgIT09IHRoaXMuX21vZGU7XG4gICAgdGhpcy5fbW9kZSA9IGZyYW1lU3RhdGUubW9kZTtcblxuICAgIC8vIE1vZGVsJ3MgbW9kZWwgbWF0cml4IG5lZWRzIHRvIGJlIHVwZGF0ZWRcbiAgICB2YXIgbW9kZWxUcmFuc2Zvcm1DaGFuZ2VkID1cbiAgICAgICFNYXRyaXg0LmVxdWFscyh0aGlzLl9tb2RlbE1hdHJpeCwgbW9kZWxNYXRyaXgpIHx8XG4gICAgICB0aGlzLl9zY2FsZSAhPT0gdGhpcy5zY2FsZSB8fFxuICAgICAgdGhpcy5fbWluaW11bVBpeGVsU2l6ZSAhPT0gdGhpcy5taW5pbXVtUGl4ZWxTaXplIHx8XG4gICAgICB0aGlzLm1pbmltdW1QaXhlbFNpemUgIT09IDAuMCB8fCAvLyBNaW5pbXVtIHBpeGVsIHNpemUgY2hhbmdlZCBvciBpcyBlbmFibGVkXG4gICAgICB0aGlzLl9tYXhpbXVtU2NhbGUgIT09IHRoaXMubWF4aW11bVNjYWxlIHx8XG4gICAgICB0aGlzLl9oZWlnaHRSZWZlcmVuY2UgIT09IHRoaXMuaGVpZ2h0UmVmZXJlbmNlIHx8XG4gICAgICB0aGlzLl9oZWlnaHRDaGFuZ2VkIHx8XG4gICAgICBtb2RlQ2hhbmdlZDtcblxuICAgIGlmIChtb2RlbFRyYW5zZm9ybUNoYW5nZWQgfHwganVzdExvYWRlZCkge1xuICAgICAgTWF0cml4NC5jbG9uZShtb2RlbE1hdHJpeCwgdGhpcy5fbW9kZWxNYXRyaXgpO1xuXG4gICAgICB1cGRhdGVDbGFtcGluZyh0aGlzKTtcblxuICAgICAgaWYgKGRlZmluZWQodGhpcy5fY2xhbXBlZE1vZGVsTWF0cml4KSkge1xuICAgICAgICBtb2RlbE1hdHJpeCA9IHRoaXMuX2NsYW1wZWRNb2RlbE1hdHJpeDtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fc2NhbGUgPSB0aGlzLnNjYWxlO1xuICAgICAgdGhpcy5fbWluaW11bVBpeGVsU2l6ZSA9IHRoaXMubWluaW11bVBpeGVsU2l6ZTtcbiAgICAgIHRoaXMuX21heGltdW1TY2FsZSA9IHRoaXMubWF4aW11bVNjYWxlO1xuICAgICAgdGhpcy5faGVpZ2h0UmVmZXJlbmNlID0gdGhpcy5oZWlnaHRSZWZlcmVuY2U7XG4gICAgICB0aGlzLl9oZWlnaHRDaGFuZ2VkID0gZmFsc2U7XG5cbiAgICAgIHZhciBzY2FsZSA9IGdldFNjYWxlKHRoaXMsIGZyYW1lU3RhdGUpO1xuICAgICAgdmFyIGNvbXB1dGVkTW9kZWxNYXRyaXggPSB0aGlzLl9jb21wdXRlZE1vZGVsTWF0cml4O1xuICAgICAgTWF0cml4NC5tdWx0aXBseUJ5VW5pZm9ybVNjYWxlKG1vZGVsTWF0cml4LCBzY2FsZSwgY29tcHV0ZWRNb2RlbE1hdHJpeCk7XG4gICAgICBpZiAodGhpcy5fdXBBeGlzID09PSBBeGlzLlkpIHtcbiAgICAgICAgTWF0cml4NC5tdWx0aXBseVRyYW5zZm9ybWF0aW9uKFxuICAgICAgICAgIGNvbXB1dGVkTW9kZWxNYXRyaXgsXG4gICAgICAgICAgQXhpcy5ZX1VQX1RPX1pfVVAsXG4gICAgICAgICAgY29tcHV0ZWRNb2RlbE1hdHJpeFxuICAgICAgICApO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLl91cEF4aXMgPT09IEF4aXMuWCkge1xuICAgICAgICBNYXRyaXg0Lm11bHRpcGx5VHJhbnNmb3JtYXRpb24oXG4gICAgICAgICAgY29tcHV0ZWRNb2RlbE1hdHJpeCxcbiAgICAgICAgICBBeGlzLlhfVVBfVE9fWl9VUCxcbiAgICAgICAgICBjb21wdXRlZE1vZGVsTWF0cml4XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5mb3J3YXJkQXhpcyA9PT0gQXhpcy5aKSB7XG4gICAgICAgIC8vIGdsVEYgMi4wIGhhcyBhIFotZm9yd2FyZCBjb252ZW50aW9uIHRoYXQgbXVzdCBiZSBhZGFwdGVkIGhlcmUgdG8gWC1mb3J3YXJkLlxuICAgICAgICBNYXRyaXg0Lm11bHRpcGx5VHJhbnNmb3JtYXRpb24oXG4gICAgICAgICAgY29tcHV0ZWRNb2RlbE1hdHJpeCxcbiAgICAgICAgICBBeGlzLlpfVVBfVE9fWF9VUCxcbiAgICAgICAgICBjb21wdXRlZE1vZGVsTWF0cml4XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIG1vZGVsTWF0cml4IHRocm91Z2hvdXQgdGhlIGdyYXBoIGFzIG5lZWRlZFxuICAgIGlmIChhbmltYXRlZCB8fCBtb2RlbFRyYW5zZm9ybUNoYW5nZWQgfHwganVzdExvYWRlZCkge1xuICAgICAgdXBkYXRlTm9kZUhpZXJhcmNoeU1vZGVsTWF0cml4KFxuICAgICAgICB0aGlzLFxuICAgICAgICBtb2RlbFRyYW5zZm9ybUNoYW5nZWQsXG4gICAgICAgIGp1c3RMb2FkZWQsXG4gICAgICAgIGZyYW1lU3RhdGUubWFwUHJvamVjdGlvblxuICAgICAgKTtcbiAgICAgIHRoaXMuX2RpcnR5ID0gdHJ1ZTtcblxuICAgICAgaWYgKGFuaW1hdGVkIHx8IGp1c3RMb2FkZWQpIHtcbiAgICAgICAgLy8gQXBwbHkgc2tpbnMgaWYgYW5pbWF0aW9uIGNoYW5nZWQgYW55IG5vZGUgdHJhbnNmb3Jtc1xuICAgICAgICBhcHBseVNraW5zKHRoaXMpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLl9wZXJOb2RlU2hvd0RpcnR5KSB7XG4gICAgICB0aGlzLl9wZXJOb2RlU2hvd0RpcnR5ID0gZmFsc2U7XG4gICAgICB1cGRhdGVQZXJOb2RlU2hvdyh0aGlzKTtcbiAgICB9XG4gICAgdXBkYXRlUGlja0lkcyh0aGlzLCBjb250ZXh0KTtcbiAgICB1cGRhdGVXaXJlZnJhbWUodGhpcyk7XG4gICAgdXBkYXRlU2hvd0JvdW5kaW5nVm9sdW1lKHRoaXMpO1xuICAgIHVwZGF0ZVNoYWRvd3ModGhpcyk7XG4gICAgdXBkYXRlQ2xpcHBpbmdQbGFuZXModGhpcywgZnJhbWVTdGF0ZSk7XG5cbiAgICAvLyBSZWdlbmVyYXRlIHNoYWRlcnMgaWYgQ2xpcHBpbmdQbGFuZUNvbGxlY3Rpb24gc3RhdGUgY2hhbmdlZCBvciBpdCB3YXMgcmVtb3ZlZFxuICAgIHZhciBjbGlwcGluZ1BsYW5lcyA9IHRoaXMuX2NsaXBwaW5nUGxhbmVzO1xuICAgIHZhciBjdXJyZW50Q2xpcHBpbmdQbGFuZXNTdGF0ZSA9IDA7XG5cbiAgICAvLyBJZiBkZWZpbmVkLCB1c2UgdGhlIHJlZmVyZW5jZSBtYXRyaXggdG8gdHJhbnNmb3JtIG1pc2NlbGxhbmVvdXMgcHJvcGVydGllcyBsaWtlXG4gICAgLy8gY2xpcHBpbmcgcGxhbmVzIGFuZCBJQkwgaW5zdGVhZCBvZiB0aGUgbW9kZWxNYXRyaXguIFRoaXMgaXMgc28gdGhhdCB3aGVuXG4gICAgLy8gbW9kZWxzIGFyZSBwYXJ0IG9mIGEgdGlsZXNldCB0aGVzZSBwcm9wZXJ0aWVzIGdldCB0cmFuc2Zvcm1lZCByZWxhdGl2ZSB0b1xuICAgIC8vIGEgY29tbW9uIHJlZmVyZW5jZSAoc3VjaCBhcyB0aGUgcm9vdCkuXG4gICAgdmFyIHJlZmVyZW5jZU1hdHJpeCA9IGRlZmF1bHRWYWx1ZSh0aGlzLnJlZmVyZW5jZU1hdHJpeCwgbW9kZWxNYXRyaXgpO1xuXG4gICAgaWYgKGlzQ2xpcHBpbmdFbmFibGVkKHRoaXMpKSB7XG4gICAgICB2YXIgY2xpcHBpbmdQbGFuZXNNYXRyaXggPSBzY3JhdGNoQ2xpcHBpbmdQbGFuZXNNYXRyaXg7XG4gICAgICBjbGlwcGluZ1BsYW5lc01hdHJpeCA9IE1hdHJpeDQubXVsdGlwbHkoXG4gICAgICAgIGNvbnRleHQudW5pZm9ybVN0YXRlLnZpZXczRCxcbiAgICAgICAgcmVmZXJlbmNlTWF0cml4LFxuICAgICAgICBjbGlwcGluZ1BsYW5lc01hdHJpeFxuICAgICAgKTtcbiAgICAgIGNsaXBwaW5nUGxhbmVzTWF0cml4ID0gTWF0cml4NC5tdWx0aXBseShcbiAgICAgICAgY2xpcHBpbmdQbGFuZXNNYXRyaXgsXG4gICAgICAgIGNsaXBwaW5nUGxhbmVzLm1vZGVsTWF0cml4LFxuICAgICAgICBjbGlwcGluZ1BsYW5lc01hdHJpeFxuICAgICAgKTtcbiAgICAgIHRoaXMuX2NsaXBwaW5nUGxhbmVzTWF0cml4ID0gTWF0cml4NC5pbnZlcnNlVHJhbnNwb3NlKFxuICAgICAgICBjbGlwcGluZ1BsYW5lc01hdHJpeCxcbiAgICAgICAgdGhpcy5fY2xpcHBpbmdQbGFuZXNNYXRyaXhcbiAgICAgICk7XG4gICAgICBjdXJyZW50Q2xpcHBpbmdQbGFuZXNTdGF0ZSA9IGNsaXBwaW5nUGxhbmVzLmNsaXBwaW5nUGxhbmVzU3RhdGU7XG4gICAgfVxuXG4gICAgdmFyIHVzZXNTSCA9XG4gICAgICBkZWZpbmVkKHRoaXMuX3NwaGVyaWNhbEhhcm1vbmljQ29lZmZpY2llbnRzKSB8fFxuICAgICAgdGhpcy5fdXNlRGVmYXVsdFNwaGVyaWNhbEhhcm1vbmljcztcbiAgICB2YXIgdXNlc1NNID1cbiAgICAgIChkZWZpbmVkKHRoaXMuX3NwZWN1bGFyRW52aXJvbm1lbnRNYXBBdGxhcykgJiZcbiAgICAgICAgdGhpcy5fc3BlY3VsYXJFbnZpcm9ubWVudE1hcEF0bGFzLnJlYWR5KSB8fFxuICAgICAgdGhpcy5fdXNlRGVmYXVsdFNwZWN1bGFyTWFwcztcblxuICAgIGlmICh1c2VzU0ggfHwgdXNlc1NNKSB7XG4gICAgICB2YXIgaWJsUmVmZXJlbmNlRnJhbWVNYXRyaXgzID0gc2NyYXRjaElCTFJlZmVyZW5jZUZyYW1lTWF0cml4MztcbiAgICAgIHZhciBpYmxSZWZlcmVuY2VGcmFtZU1hdHJpeDQgPSBzY3JhdGNoSUJMUmVmZXJlbmNlRnJhbWVNYXRyaXg0O1xuXG4gICAgICBpYmxSZWZlcmVuY2VGcmFtZU1hdHJpeDQgPSBNYXRyaXg0Lm11bHRpcGx5KFxuICAgICAgICBjb250ZXh0LnVuaWZvcm1TdGF0ZS52aWV3M0QsXG4gICAgICAgIHJlZmVyZW5jZU1hdHJpeCxcbiAgICAgICAgaWJsUmVmZXJlbmNlRnJhbWVNYXRyaXg0XG4gICAgICApO1xuICAgICAgaWJsUmVmZXJlbmNlRnJhbWVNYXRyaXgzID0gTWF0cml4NC5nZXRNYXRyaXgzKFxuICAgICAgICBpYmxSZWZlcmVuY2VGcmFtZU1hdHJpeDQsXG4gICAgICAgIGlibFJlZmVyZW5jZUZyYW1lTWF0cml4M1xuICAgICAgKTtcbiAgICAgIGlibFJlZmVyZW5jZUZyYW1lTWF0cml4MyA9IE1hdHJpeDMuZ2V0Um90YXRpb24oXG4gICAgICAgIGlibFJlZmVyZW5jZUZyYW1lTWF0cml4MyxcbiAgICAgICAgaWJsUmVmZXJlbmNlRnJhbWVNYXRyaXgzXG4gICAgICApO1xuICAgICAgdGhpcy5faWJsUmVmZXJlbmNlRnJhbWVNYXRyaXggPSBNYXRyaXgzLnRyYW5zcG9zZShcbiAgICAgICAgaWJsUmVmZXJlbmNlRnJhbWVNYXRyaXgzLFxuICAgICAgICB0aGlzLl9pYmxSZWZlcmVuY2VGcmFtZU1hdHJpeFxuICAgICAgKTtcbiAgICB9XG5cbiAgICB2YXIgc2hvdWxkUmVnZW5lcmF0ZVNoYWRlcnMgPSB0aGlzLl9zaG91bGRSZWdlbmVyYXRlU2hhZGVycztcbiAgICBzaG91bGRSZWdlbmVyYXRlU2hhZGVycyA9XG4gICAgICBzaG91bGRSZWdlbmVyYXRlU2hhZGVycyB8fFxuICAgICAgdGhpcy5fY2xpcHBpbmdQbGFuZXNTdGF0ZSAhPT0gY3VycmVudENsaXBwaW5nUGxhbmVzU3RhdGU7XG4gICAgdGhpcy5fY2xpcHBpbmdQbGFuZXNTdGF0ZSA9IGN1cnJlbnRDbGlwcGluZ1BsYW5lc1N0YXRlO1xuXG4gICAgLy8gUmVnZW5lcmF0ZSBzaGFkZXJzIGlmIGNvbG9yIHNoYWRpbmcgY2hhbmdlZCBmcm9tIGxhc3QgdXBkYXRlXG4gICAgdmFyIGN1cnJlbnRseUNvbG9yU2hhZGluZ0VuYWJsZWQgPSBpc0NvbG9yU2hhZGluZ0VuYWJsZWQodGhpcyk7XG4gICAgaWYgKGN1cnJlbnRseUNvbG9yU2hhZGluZ0VuYWJsZWQgIT09IHRoaXMuX2NvbG9yU2hhZGluZ0VuYWJsZWQpIHtcbiAgICAgIHRoaXMuX2NvbG9yU2hhZGluZ0VuYWJsZWQgPSBjdXJyZW50bHlDb2xvclNoYWRpbmdFbmFibGVkO1xuICAgICAgc2hvdWxkUmVnZW5lcmF0ZVNoYWRlcnMgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmIChzaG91bGRSZWdlbmVyYXRlU2hhZGVycykge1xuICAgICAgcmVnZW5lcmF0ZVNoYWRlcnModGhpcywgZnJhbWVTdGF0ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHVwZGF0ZUNvbG9yKHRoaXMsIGZyYW1lU3RhdGUsIGZhbHNlKTtcbiAgICAgIHVwZGF0ZUJhY2tGYWNlQ3VsbGluZyh0aGlzLCBmcmFtZVN0YXRlLCBmYWxzZSk7XG4gICAgICB1cGRhdGVTaWxob3VldHRlKHRoaXMsIGZyYW1lU3RhdGUsIGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICBpZiAoanVzdExvYWRlZCkge1xuICAgIC8vIENhbGxlZCBhZnRlciBtb2RlbE1hdHJpeCB1cGRhdGUuXG4gICAgdmFyIG1vZGVsID0gdGhpcztcbiAgICBmcmFtZVN0YXRlLmFmdGVyUmVuZGVyLnB1c2goZnVuY3Rpb24gKCkge1xuICAgICAgbW9kZWwuX3JlYWR5ID0gdHJ1ZTtcbiAgICAgIG1vZGVsLl9yZWFkeVByb21pc2UucmVzb2x2ZShtb2RlbCk7XG4gICAgfSk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gV2UgZG9uJ3QgY2hlY2sgc2hvdyBhdCB0aGUgdG9wIG9mIHRoZSBmdW5jdGlvbiBzaW5jZSB3ZVxuICAvLyB3YW50IHRvIGJlIGFibGUgdG8gcHJvZ3Jlc3NpdmVseSBsb2FkIG1vZGVscyB3aGVuIHRoZXkgYXJlIG5vdCBzaG93bixcbiAgLy8gYW5kIHRoZW4gaGF2ZSB0aGVtIHZpc2libGUgaW1tZWRpYXRlbHkgd2hlbiBzaG93IGlzIHNldCB0byB0cnVlLlxuICBpZiAoc2hvdyAmJiAhdGhpcy5faWdub3JlQ29tbWFuZHMpIHtcbiAgICAvLyBQRVJGT1JNQU5DRV9JREVBOiBUaGlzIGlzIHRlcnJpYmxlXG4gICAgdmFyIGNvbW1hbmRMaXN0ID0gZnJhbWVTdGF0ZS5jb21tYW5kTGlzdDtcbiAgICB2YXIgcGFzc2VzID0gZnJhbWVTdGF0ZS5wYXNzZXM7XG4gICAgdmFyIG5vZGVDb21tYW5kcyA9IHRoaXMuX25vZGVDb21tYW5kcztcbiAgICB2YXIgbGVuZ3RoID0gbm9kZUNvbW1hbmRzLmxlbmd0aDtcbiAgICB2YXIgaTtcbiAgICB2YXIgbmM7XG5cbiAgICB2YXIgaWRsMkQgPVxuICAgICAgZnJhbWVTdGF0ZS5tYXBQcm9qZWN0aW9uLmVsbGlwc29pZC5tYXhpbXVtUmFkaXVzICogQ2VzaXVtTWF0aC5QSTtcbiAgICB2YXIgYm91bmRpbmdWb2x1bWU7XG5cbiAgICBpZiAocGFzc2VzLnJlbmRlciB8fCAocGFzc2VzLnBpY2sgJiYgdGhpcy5hbGxvd1BpY2tpbmcpKSB7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICAgICAgbmMgPSBub2RlQ29tbWFuZHNbaV07XG4gICAgICAgIGlmIChuYy5zaG93KSB7XG4gICAgICAgICAgdmFyIGNvbW1hbmQgPSBuYy5jb21tYW5kO1xuICAgICAgICAgIGlmIChzaWxob3VldHRlKSB7XG4gICAgICAgICAgICBjb21tYW5kID0gbmMuc2lsaG91ZXR0ZU1vZGVsQ29tbWFuZDtcbiAgICAgICAgICB9IGVsc2UgaWYgKHRyYW5zbHVjZW50KSB7XG4gICAgICAgICAgICBjb21tYW5kID0gbmMudHJhbnNsdWNlbnRDb21tYW5kO1xuICAgICAgICAgIH0gZWxzZSBpZiAoIWJhY2tGYWNlQ3VsbGluZykge1xuICAgICAgICAgICAgY29tbWFuZCA9IG5jLmRpc2FibGVDdWxsaW5nQ29tbWFuZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29tbWFuZExpc3QucHVzaChjb21tYW5kKTtcbiAgICAgICAgICBib3VuZGluZ1ZvbHVtZSA9IG5jLmNvbW1hbmQuYm91bmRpbmdWb2x1bWU7XG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgZnJhbWVTdGF0ZS5tb2RlID09PSBTY2VuZU1vZGUuU0NFTkUyRCAmJlxuICAgICAgICAgICAgKGJvdW5kaW5nVm9sdW1lLmNlbnRlci55ICsgYm91bmRpbmdWb2x1bWUucmFkaXVzID4gaWRsMkQgfHxcbiAgICAgICAgICAgICAgYm91bmRpbmdWb2x1bWUuY2VudGVyLnkgLSBib3VuZGluZ1ZvbHVtZS5yYWRpdXMgPCBpZGwyRClcbiAgICAgICAgICApIHtcbiAgICAgICAgICAgIHZhciBjb21tYW5kMkQgPSBuYy5jb21tYW5kMkQ7XG4gICAgICAgICAgICBpZiAoc2lsaG91ZXR0ZSkge1xuICAgICAgICAgICAgICBjb21tYW5kMkQgPSBuYy5zaWxob3VldHRlTW9kZWxDb21tYW5kMkQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRyYW5zbHVjZW50KSB7XG4gICAgICAgICAgICAgIGNvbW1hbmQyRCA9IG5jLnRyYW5zbHVjZW50Q29tbWFuZDJEO1xuICAgICAgICAgICAgfSBlbHNlIGlmICghYmFja0ZhY2VDdWxsaW5nKSB7XG4gICAgICAgICAgICAgIGNvbW1hbmQyRCA9IG5jLmRpc2FibGVDdWxsaW5nQ29tbWFuZDJEO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29tbWFuZExpc3QucHVzaChjb21tYW5kMkQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoc2lsaG91ZXR0ZSAmJiAhcGFzc2VzLnBpY2spIHtcbiAgICAgICAgLy8gUmVuZGVyIHNlY29uZCBzaWxob3VldHRlIHBhc3NcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgbmMgPSBub2RlQ29tbWFuZHNbaV07XG4gICAgICAgICAgaWYgKG5jLnNob3cpIHtcbiAgICAgICAgICAgIGNvbW1hbmRMaXN0LnB1c2gobmMuc2lsaG91ZXR0ZUNvbG9yQ29tbWFuZCk7XG4gICAgICAgICAgICBib3VuZGluZ1ZvbHVtZSA9IG5jLmNvbW1hbmQuYm91bmRpbmdWb2x1bWU7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgIGZyYW1lU3RhdGUubW9kZSA9PT0gU2NlbmVNb2RlLlNDRU5FMkQgJiZcbiAgICAgICAgICAgICAgKGJvdW5kaW5nVm9sdW1lLmNlbnRlci55ICsgYm91bmRpbmdWb2x1bWUucmFkaXVzID4gaWRsMkQgfHxcbiAgICAgICAgICAgICAgICBib3VuZGluZ1ZvbHVtZS5jZW50ZXIueSAtIGJvdW5kaW5nVm9sdW1lLnJhZGl1cyA8IGlkbDJEKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgIGNvbW1hbmRMaXN0LnB1c2gobmMuc2lsaG91ZXR0ZUNvbG9yQ29tbWFuZDJEKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2YXIgY3JlZGl0ID0gdGhpcy5fY3JlZGl0O1xuICBpZiAoZGVmaW5lZChjcmVkaXQpKSB7XG4gICAgZnJhbWVTdGF0ZS5jcmVkaXREaXNwbGF5LmFkZENyZWRpdChjcmVkaXQpO1xuICB9XG5cbiAgdmFyIHJlc291cmNlQ3JlZGl0cyA9IHRoaXMuX3Jlc291cmNlQ3JlZGl0cztcbiAgdmFyIGNyZWRpdENvdW50ID0gcmVzb3VyY2VDcmVkaXRzLmxlbmd0aDtcbiAgZm9yICh2YXIgYyA9IDA7IGMgPCBjcmVkaXRDb3VudDsgYysrKSB7XG4gICAgZnJhbWVTdGF0ZS5jcmVkaXREaXNwbGF5LmFkZENyZWRpdChyZXNvdXJjZUNyZWRpdHNbY10pO1xuICB9XG59O1xuXG5mdW5jdGlvbiBkZXN0cm95SWZOb3RDYWNoZWQocmVuZGVyZXJSZXNvdXJjZXMsIGNhY2hlZFJlbmRlcmVyUmVzb3VyY2VzKSB7XG4gIGlmIChyZW5kZXJlclJlc291cmNlcy5wcm9ncmFtcyAhPT0gY2FjaGVkUmVuZGVyZXJSZXNvdXJjZXMucHJvZ3JhbXMpIHtcbiAgICBkZXN0cm95KHJlbmRlcmVyUmVzb3VyY2VzLnByb2dyYW1zKTtcbiAgfVxuICBpZiAoXG4gICAgcmVuZGVyZXJSZXNvdXJjZXMuc2lsaG91ZXR0ZVByb2dyYW1zICE9PVxuICAgIGNhY2hlZFJlbmRlcmVyUmVzb3VyY2VzLnNpbGhvdWV0dGVQcm9ncmFtc1xuICApIHtcbiAgICBkZXN0cm95KHJlbmRlcmVyUmVzb3VyY2VzLnNpbGhvdWV0dGVQcm9ncmFtcyk7XG4gIH1cbn1cblxuLy8gUnVuIGZyb20gdXBkYXRlIGlmZjpcbi8vIC0gZXZlcnl0aGluZyBpcyBsb2FkZWRcbi8vIC0gY2xpcHBpbmcgcGxhbmVzIHN0YXRlIGNoYW5nZSBPUiBjb2xvciBzdGF0ZSBzZXRcbi8vIFJ1biB0aGlzIGZyb20gZGVzdHJ1Y3RvciBhZnRlciByZW1vdmluZyBjb2xvciBzdGF0ZSBhbmQgY2xpcHBpbmcgcGxhbmUgc3RhdGVcbmZ1bmN0aW9uIHJlZ2VuZXJhdGVTaGFkZXJzKG1vZGVsLCBmcmFtZVN0YXRlKSB7XG4gIC8vIEluIHJlZ2FyZHMgdG8gX2NhY2hlZFJlbmRlcmVyUmVzb3VyY2VzOlxuICAvLyBGYWlyIHRvIGFzc3VtZSB0aGF0IHRoaXMgaXMgZGF0YSB0aGF0IHNob3VsZCBqdXN0IG5ldmVyIGdldCBtb2RpZmllZCBkdWUgdG8gY2xpcHBpbmcgcGxhbmVzIG9yIG1vZGVsIGNvbG9yLlxuICAvLyBTbyBpZiBjbGlwcGluZyBwbGFuZXMgb3IgbW9kZWwgY29sb3IgYWN0aXZlOlxuICAvLyAtIGRlbGluayBfcmVuZGVyZXJSZXNvdXJjZXMuKnByb2dyYW1zIGFuZCBjcmVhdGUgbmV3IGRpY3Rpb25hcmllcy5cbiAgLy8gLSBkbyBOT1QgZGVzdHJveSBhbnkgcHJvZ3JhbXMgLSBtaWdodCBiZSB1c2VkIGJ5IGNvcGllcyBvZiB0aGUgbW9kZWwgb3IgYnkgbWlnaHQgYmUgbmVlZGVkIGluIHRoZSBmdXR1cmUgaWYgY2xpcHBpbmcgcGxhbmVzL21vZGVsIGNvbG9yIGlzIGRlYWN0aXZhdGVkXG5cbiAgLy8gSWYgY2xpcHBpbmcgcGxhbmVzIGFuZCBtb2RlbCBjb2xvciBpbmFjdGl2ZTpcbiAgLy8gLSBkZXN0cm95IF9yZW5kZXJlclJlc291cmNlcy4qcHJvZ3JhbXNcbiAgLy8gLSByZWxpbmsgX3JlbmRlcmVyUmVzb3VyY2VzLipwcm9ncmFtcyB0byBfY2FjaGVkUmVuZGVyZXJSZXNvdXJjZXNcblxuICAvLyBJbiBib3RoIGNhc2VzLCBuZWVkIHRvIG1hcmsgY29tbWFuZHMgYXMgZGlydHksIHJlLXJ1biBkZXJpdmVkIGNvbW1hbmRzIChlbHNld2hlcmUpXG5cbiAgdmFyIHJlbmRlcmVyUmVzb3VyY2VzID0gbW9kZWwuX3JlbmRlcmVyUmVzb3VyY2VzO1xuICB2YXIgY2FjaGVkUmVuZGVyZXJSZXNvdXJjZXMgPSBtb2RlbC5fY2FjaGVkUmVuZGVyZXJSZXNvdXJjZXM7XG4gIGRlc3Ryb3lJZk5vdENhY2hlZChyZW5kZXJlclJlc291cmNlcywgY2FjaGVkUmVuZGVyZXJSZXNvdXJjZXMpO1xuXG4gIHZhciBwcm9ncmFtSWQ7XG4gIGlmIChcbiAgICBpc0NsaXBwaW5nRW5hYmxlZChtb2RlbCkgfHxcbiAgICBpc0NvbG9yU2hhZGluZ0VuYWJsZWQobW9kZWwpIHx8XG4gICAgbW9kZWwuX3Nob3VsZFJlZ2VuZXJhdGVTaGFkZXJzXG4gICkge1xuICAgIG1vZGVsLl9zaG91bGRSZWdlbmVyYXRlU2hhZGVycyA9IGZhbHNlO1xuXG4gICAgcmVuZGVyZXJSZXNvdXJjZXMucHJvZ3JhbXMgPSB7fTtcbiAgICByZW5kZXJlclJlc291cmNlcy5zaWxob3VldHRlUHJvZ3JhbXMgPSB7fTtcblxuICAgIHZhciB2aXNpdGVkUHJvZ3JhbXMgPSB7fTtcbiAgICB2YXIgdGVjaG5pcXVlcyA9IG1vZGVsLl9zb3VyY2VUZWNobmlxdWVzO1xuICAgIHZhciB0ZWNobmlxdWU7XG5cbiAgICBmb3IgKHZhciB0ZWNobmlxdWVJZCBpbiB0ZWNobmlxdWVzKSB7XG4gICAgICBpZiAodGVjaG5pcXVlcy5oYXNPd25Qcm9wZXJ0eSh0ZWNobmlxdWVJZCkpIHtcbiAgICAgICAgdGVjaG5pcXVlID0gdGVjaG5pcXVlc1t0ZWNobmlxdWVJZF07XG4gICAgICAgIHByb2dyYW1JZCA9IHRlY2huaXF1ZS5wcm9ncmFtO1xuICAgICAgICBpZiAoIXZpc2l0ZWRQcm9ncmFtc1twcm9ncmFtSWRdKSB7XG4gICAgICAgICAgdmlzaXRlZFByb2dyYW1zW3Byb2dyYW1JZF0gPSB0cnVlO1xuICAgICAgICAgIHJlY3JlYXRlUHJvZ3JhbShcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgcHJvZ3JhbUlkOiBwcm9ncmFtSWQsXG4gICAgICAgICAgICAgIHRlY2huaXF1ZUlkOiB0ZWNobmlxdWVJZCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtb2RlbCxcbiAgICAgICAgICAgIGZyYW1lU3RhdGUuY29udGV4dFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmVuZGVyZXJSZXNvdXJjZXMucHJvZ3JhbXMgPSBjYWNoZWRSZW5kZXJlclJlc291cmNlcy5wcm9ncmFtcztcbiAgICByZW5kZXJlclJlc291cmNlcy5zaWxob3VldHRlUHJvZ3JhbXMgPVxuICAgICAgY2FjaGVkUmVuZGVyZXJSZXNvdXJjZXMuc2lsaG91ZXR0ZVByb2dyYW1zO1xuICB9XG5cbiAgLy8gRml4IGFsbCB0aGUgY29tbWFuZHMsIG1hcmtpbmcgdGhlbSBhcyBkaXJ0eSBzbyBldmVyeXRoaW5nIHRoYXQgZGVyaXZlcyB3aWxsIHJlLWRlcml2ZVxuICB2YXIgcmVuZGVyZXJQcm9ncmFtcyA9IHJlbmRlcmVyUmVzb3VyY2VzLnByb2dyYW1zO1xuXG4gIHZhciBub2RlQ29tbWFuZHMgPSBtb2RlbC5fbm9kZUNvbW1hbmRzO1xuICB2YXIgY29tbWFuZENvdW50ID0gbm9kZUNvbW1hbmRzLmxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb21tYW5kQ291bnQ7ICsraSkge1xuICAgIHZhciBub2RlQ29tbWFuZCA9IG5vZGVDb21tYW5kc1tpXTtcbiAgICBwcm9ncmFtSWQgPSBub2RlQ29tbWFuZC5wcm9ncmFtSWQ7XG5cbiAgICB2YXIgcmVuZGVyUHJvZ3JhbSA9IHJlbmRlcmVyUHJvZ3JhbXNbcHJvZ3JhbUlkXTtcbiAgICBub2RlQ29tbWFuZC5jb21tYW5kLnNoYWRlclByb2dyYW0gPSByZW5kZXJQcm9ncmFtO1xuICAgIGlmIChkZWZpbmVkKG5vZGVDb21tYW5kLmNvbW1hbmQyRCkpIHtcbiAgICAgIG5vZGVDb21tYW5kLmNvbW1hbmQyRC5zaGFkZXJQcm9ncmFtID0gcmVuZGVyUHJvZ3JhbTtcbiAgICB9XG4gIH1cblxuICAvLyBGb3JjZSB1cGRhdGUgc2lsaG91ZXR0ZSBjb21tYW5kcy9zaGFkZXJzXG4gIHVwZGF0ZUNvbG9yKG1vZGVsLCBmcmFtZVN0YXRlLCB0cnVlKTtcbiAgdXBkYXRlQmFja0ZhY2VDdWxsaW5nKG1vZGVsLCBmcmFtZVN0YXRlLCB0cnVlKTtcbiAgdXBkYXRlU2lsaG91ZXR0ZShtb2RlbCwgZnJhbWVTdGF0ZSwgdHJ1ZSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQ7IG90aGVyd2lzZSwgZmFsc2UuXG4gKiA8YnIgLz48YnIgLz5cbiAqIElmIHRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQsIGl0IHNob3VsZCBub3QgYmUgdXNlZDsgY2FsbGluZyBhbnkgZnVuY3Rpb24gb3RoZXIgdGhhblxuICogPGNvZGU+aXNEZXN0cm95ZWQ8L2NvZGU+IHdpbGwgcmVzdWx0IGluIGEge0BsaW5rIERldmVsb3BlckVycm9yfSBleGNlcHRpb24uXG4gKlxuICogQHJldHVybnMge0Jvb2xlYW59IDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQ7IG90aGVyd2lzZSwgPGNvZGU+ZmFsc2U8L2NvZGU+LlxuICpcbiAqIEBzZWUgTW9kZWwjZGVzdHJveVxuICovXG5Nb2RlbC5wcm90b3R5cGUuaXNEZXN0cm95ZWQgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBmYWxzZTtcbn07XG5cbi8qKlxuICogRGVzdHJveXMgdGhlIFdlYkdMIHJlc291cmNlcyBoZWxkIGJ5IHRoaXMgb2JqZWN0LiAgRGVzdHJveWluZyBhbiBvYmplY3QgYWxsb3dzIGZvciBkZXRlcm1pbmlzdGljXG4gKiByZWxlYXNlIG9mIFdlYkdMIHJlc291cmNlcywgaW5zdGVhZCBvZiByZWx5aW5nIG9uIHRoZSBnYXJiYWdlIGNvbGxlY3RvciB0byBkZXN0cm95IHRoaXMgb2JqZWN0LlxuICogPGJyIC8+PGJyIC8+XG4gKiBPbmNlIGFuIG9iamVjdCBpcyBkZXN0cm95ZWQsIGl0IHNob3VsZCBub3QgYmUgdXNlZDsgY2FsbGluZyBhbnkgZnVuY3Rpb24gb3RoZXIgdGhhblxuICogPGNvZGU+aXNEZXN0cm95ZWQ8L2NvZGU+IHdpbGwgcmVzdWx0IGluIGEge0BsaW5rIERldmVsb3BlckVycm9yfSBleGNlcHRpb24uICBUaGVyZWZvcmUsXG4gKiBhc3NpZ24gdGhlIHJldHVybiB2YWx1ZSAoPGNvZGU+dW5kZWZpbmVkPC9jb2RlPikgdG8gdGhlIG9iamVjdCBhcyBkb25lIGluIHRoZSBleGFtcGxlLlxuICpcbiAqIEBleGNlcHRpb24ge0RldmVsb3BlckVycm9yfSBUaGlzIG9iamVjdCB3YXMgZGVzdHJveWVkLCBpLmUuLCBkZXN0cm95KCkgd2FzIGNhbGxlZC5cbiAqXG4gKlxuICogQGV4YW1wbGVcbiAqIG1vZGVsID0gbW9kZWwgJiYgbW9kZWwuZGVzdHJveSgpO1xuICpcbiAqIEBzZWUgTW9kZWwjaXNEZXN0cm95ZWRcbiAqL1xuTW9kZWwucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gIC8vIFZlcnRleCBhcnJheXMgYXJlIHVuaXF1ZSB0byB0aGlzIG1vZGVsLCBkZXN0cm95IGhlcmUuXG4gIGlmIChkZWZpbmVkKHRoaXMuX3ByZWNyZWF0ZWRBdHRyaWJ1dGVzKSkge1xuICAgIGRlc3Ryb3kodGhpcy5fcmVuZGVyZXJSZXNvdXJjZXMudmVydGV4QXJyYXlzKTtcbiAgfVxuXG4gIGlmIChkZWZpbmVkKHRoaXMuX3JlbW92ZVVwZGF0ZUhlaWdodENhbGxiYWNrKSkge1xuICAgIHRoaXMuX3JlbW92ZVVwZGF0ZUhlaWdodENhbGxiYWNrKCk7XG4gICAgdGhpcy5fcmVtb3ZlVXBkYXRlSGVpZ2h0Q2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gIH1cblxuICBpZiAoZGVmaW5lZCh0aGlzLl90ZXJyYWluUHJvdmlkZXJDaGFuZ2VkQ2FsbGJhY2spKSB7XG4gICAgdGhpcy5fdGVycmFpblByb3ZpZGVyQ2hhbmdlZENhbGxiYWNrKCk7XG4gICAgdGhpcy5fdGVycmFpblByb3ZpZGVyQ2hhbmdlZENhbGxiYWNrID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgLy8gU2hhZGVycyBtb2RpZmllZCBmb3IgY2xpcHBpbmcgYW5kIGZvciBjb2xvciBkb24ndCBnZXQgY2FjaGVkLCBzbyBkZXN0cm95IHRoZXNlIG1hbnVhbGx5XG4gIGlmIChkZWZpbmVkKHRoaXMuX2NhY2hlZFJlbmRlcmVyUmVzb3VyY2VzKSkge1xuICAgIGRlc3Ryb3lJZk5vdENhY2hlZCh0aGlzLl9yZW5kZXJlclJlc291cmNlcywgdGhpcy5fY2FjaGVkUmVuZGVyZXJSZXNvdXJjZXMpO1xuICB9XG5cbiAgdGhpcy5fcmVuZGVyZXJSZXNvdXJjZXMgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2NhY2hlZFJlbmRlcmVyUmVzb3VyY2VzID1cbiAgICB0aGlzLl9jYWNoZWRSZW5kZXJlclJlc291cmNlcyAmJiB0aGlzLl9jYWNoZWRSZW5kZXJlclJlc291cmNlcy5yZWxlYXNlKCk7XG4gIERyYWNvTG9hZGVyLmRlc3Ryb3lDYWNoZWREYXRhRm9yTW9kZWwodGhpcyk7XG5cbiAgdmFyIHBpY2tJZHMgPSB0aGlzLl9waWNrSWRzO1xuICB2YXIgbGVuZ3RoID0gcGlja0lkcy5sZW5ndGg7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICBwaWNrSWRzW2ldLmRlc3Ryb3koKTtcbiAgfVxuXG4gIHJlbGVhc2VDYWNoZWRHbHRmKHRoaXMpO1xuICB0aGlzLl9xdWFudGl6ZWRWZXJ0ZXhTaGFkZXJzID0gdW5kZWZpbmVkO1xuXG4gIC8vIE9ubHkgZGVzdHJveSB0aGUgQ2xpcHBpbmdQbGFuZUNvbGxlY3Rpb24gaWYgdGhpcyBpcyB0aGUgb3duZXIgLSBpZiB0aGlzIG1vZGVsIGlzIHBhcnQgb2YgYSBDZXNpdW0zRFRpbGVzZXQsXG4gIC8vIF9jbGlwcGluZ1BsYW5lcyByZWZlcmVuY2VzIGEgQ2xpcHBpbmdQbGFuZUNvbGxlY3Rpb24gdGhhdCB0aGlzIG1vZGVsIGRvZXMgbm90IG93bi5cbiAgdmFyIGNsaXBwaW5nUGxhbmVDb2xsZWN0aW9uID0gdGhpcy5fY2xpcHBpbmdQbGFuZXM7XG4gIGlmIChcbiAgICBkZWZpbmVkKGNsaXBwaW5nUGxhbmVDb2xsZWN0aW9uKSAmJlxuICAgICFjbGlwcGluZ1BsYW5lQ29sbGVjdGlvbi5pc0Rlc3Ryb3llZCgpICYmXG4gICAgY2xpcHBpbmdQbGFuZUNvbGxlY3Rpb24ub3duZXIgPT09IHRoaXNcbiAgKSB7XG4gICAgY2xpcHBpbmdQbGFuZUNvbGxlY3Rpb24uZGVzdHJveSgpO1xuICB9XG4gIHRoaXMuX2NsaXBwaW5nUGxhbmVzID0gdW5kZWZpbmVkO1xuXG4gIHRoaXMuX3NwZWN1bGFyRW52aXJvbm1lbnRNYXBBdGxhcyA9XG4gICAgdGhpcy5fc3BlY3VsYXJFbnZpcm9ubWVudE1hcEF0bGFzICYmXG4gICAgdGhpcy5fc3BlY3VsYXJFbnZpcm9ubWVudE1hcEF0bGFzLmRlc3Ryb3koKTtcblxuICByZXR1cm4gZGVzdHJveU9iamVjdCh0aGlzKTtcbn07XG5cbi8vIGV4cG9zZWQgZm9yIHRlc3Rpbmdcbk1vZGVsLl9nZXRDbGlwcGluZ0Z1bmN0aW9uID0gZ2V0Q2xpcHBpbmdGdW5jdGlvbjtcbk1vZGVsLl9tb2RpZnlTaGFkZXJGb3JDb2xvciA9IG1vZGlmeVNoYWRlckZvckNvbG9yO1xuZXhwb3J0IGRlZmF1bHQgTW9kZWw7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///16626\n')},39982:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_buildModuleUrl_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(72000);\n/* harmony import */ var _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(60216);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(82982);\n/* harmony import */ var _Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(86511);\n/* harmony import */ var _Core_Ellipsoid_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(50491);\n/* harmony import */ var _Core_IauOrientationAxes_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(23628);\n/* harmony import */ var _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(68201);\n/* harmony import */ var _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(72248);\n/* harmony import */ var _Core_Simon1994PlanetaryPositions_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(83156);\n/* harmony import */ var _Core_Transforms_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(95555);\n/* harmony import */ var _EllipsoidPrimitive_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(64336);\n/* harmony import */ var _Material_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(69592);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Draws the Moon in 3D.\n * @alias Moon\n * @constructor\n *\n * @param {Object} [options] Object with the following properties:\n * @param {Boolean} [options.show=true] Determines whether the moon will be rendered.\n * @param {String} [options.textureUrl=buildModuleUrl(\'Assets/Textures/moonSmall.jpg\')] The moon texture.\n * @param {Ellipsoid} [options.ellipsoid=Ellipsoid.MOON] The moon ellipsoid.\n * @param {Boolean} [options.onlySunLighting=true] Use the sun as the only light source.\n *\n *\n * @example\n * scene.moon = new Cesium.Moon();\n *\n * @see Scene#moon\n */\nfunction Moon(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n\n  var url = options.textureUrl;\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(url)) {\n    url = (0,_Core_buildModuleUrl_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)("Assets/Textures/moonSmall.jpg");\n  }\n\n  /**\n   * Determines if the moon will be shown.\n   *\n   * @type {Boolean}\n   * @default true\n   */\n  this.show = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(options.show, true);\n\n  /**\n   * The moon texture.\n   * @type {String}\n   * @default buildModuleUrl(\'Assets/Textures/moonSmall.jpg\')\n   */\n  this.textureUrl = url;\n\n  this._ellipsoid = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(options.ellipsoid, _Core_Ellipsoid_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].MOON */ .Z.MOON);\n\n  /**\n   * Use the sun as the only light source.\n   * @type {Boolean}\n   * @default true\n   */\n  this.onlySunLighting = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(options.onlySunLighting, true);\n\n  this._ellipsoidPrimitive = new _EllipsoidPrimitive_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z({\n    radii: this.ellipsoid.radii,\n    material: _Material_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"].fromType */ .Z.fromType(_Material_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"].ImageType */ .Z.ImageType),\n    depthTestEnabled: false,\n    _owner: this,\n  });\n  this._ellipsoidPrimitive.material.translucent = false;\n\n  this._axes = new _Core_IauOrientationAxes_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z();\n}\n\nObject.defineProperties(Moon.prototype, {\n  /**\n   * Get the ellipsoid that defines the shape of the moon.\n   *\n   * @memberof Moon.prototype\n   *\n   * @type {Ellipsoid}\n   * @readonly\n   *\n   * @default {@link Ellipsoid.MOON}\n   */\n  ellipsoid: {\n    get: function () {\n      return this._ellipsoid;\n    },\n  },\n});\n\nvar icrfToFixed = new _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z();\nvar rotationScratch = new _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z();\nvar translationScratch = new _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z();\nvar scratchCommandList = [];\n\n/**\n * @private\n */\nMoon.prototype.update = function (frameState) {\n  if (!this.show) {\n    return;\n  }\n\n  var ellipsoidPrimitive = this._ellipsoidPrimitive;\n  ellipsoidPrimitive.material.uniforms.image = this.textureUrl;\n  ellipsoidPrimitive.onlySunLighting = this.onlySunLighting;\n\n  var date = frameState.time;\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(_Core_Transforms_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].computeIcrfToFixedMatrix */ .Z.computeIcrfToFixedMatrix(date, icrfToFixed))) {\n    _Core_Transforms_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].computeTemeToPseudoFixedMatrix */ .Z.computeTemeToPseudoFixedMatrix(date, icrfToFixed);\n  }\n\n  var rotation = this._axes.evaluate(date, rotationScratch);\n  _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].transpose */ .Z.transpose(rotation, rotation);\n  _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].multiply */ .Z.multiply(icrfToFixed, rotation, rotation);\n\n  var translation = _Core_Simon1994PlanetaryPositions_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].computeMoonPositionInEarthInertialFrame */ .Z.computeMoonPositionInEarthInertialFrame(\n    date,\n    translationScratch\n  );\n  _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].multiplyByVector */ .Z.multiplyByVector(icrfToFixed, translation, translation);\n\n  _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].fromRotationTranslation */ .Z.fromRotationTranslation(\n    rotation,\n    translation,\n    ellipsoidPrimitive.modelMatrix\n  );\n\n  var savedCommandList = frameState.commandList;\n  frameState.commandList = scratchCommandList;\n  scratchCommandList.length = 0;\n  ellipsoidPrimitive.update(frameState);\n  frameState.commandList = savedCommandList;\n  return scratchCommandList.length === 1 ? scratchCommandList[0] : undefined;\n};\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <br /><br />\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n *\n * @returns {Boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n *\n * @see Moon#destroy\n */\nMoon.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the WebGL resources held by this object.  Destroying an object allows for deterministic\n * release of WebGL resources, instead of relying on the garbage collector to destroy this object.\n * <br /><br />\n * Once an object is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n *\n * @example\n * moon = moon && moon.destroy();\n *\n * @see Moon#isDestroyed\n */\nMoon.prototype.destroy = function () {\n  this._ellipsoidPrimitive =\n    this._ellipsoidPrimitive && this._ellipsoidPrimitive.destroy();\n  return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(this);\n};\n/* harmony default export */ __webpack_exports__["Z"] = (Moon);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzk5ODIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUF1RDtBQUNSO0FBQ0k7QUFDVjtBQUNZO0FBQ1I7QUFDa0I7QUFDdEI7QUFDQTtBQUN3QztBQUNsQztBQUNVO0FBQ3BCOztBQUVyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLFdBQVcsU0FBUztBQUNwQixXQUFXLFFBQVE7QUFDbkIsV0FBVyxXQUFXO0FBQ3RCLFdBQVcsU0FBUztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSwwRUFBWSxVQUFVLGdHQUF5Qjs7QUFFM0Q7QUFDQSxPQUFPLHNFQUFPO0FBQ2QsVUFBVSw0RUFBYztBQUN4Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBLGNBQWMsMEVBQVk7O0FBRTFCO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBOztBQUVBLG9CQUFvQiwwRUFBWSxvQkFBb0IsNkVBQWM7O0FBRWxFO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBLHlCQUF5QiwwRUFBWTs7QUFFckMsaUNBQWlDLHdFQUFrQjtBQUNuRDtBQUNBLGNBQWMsZ0ZBQWlCLENBQUMsa0ZBQWtCO0FBQ2xEO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUEsbUJBQW1CLDRFQUFrQjtBQUNyQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0gsQ0FBQzs7QUFFRCxzQkFBc0IsaUVBQU87QUFDN0IsMEJBQTBCLGlFQUFPO0FBQ2pDLDZCQUE2QixvRUFBVTtBQUN2Qzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxPQUFPLHNFQUFPLENBQUMsc0hBQW1DO0FBQ2xELElBQUksa0lBQXlDO0FBQzdDOztBQUVBO0FBQ0EsRUFBRSxxRkFBaUI7QUFDbkIsRUFBRSxtRkFBZ0I7O0FBRWxCLG9CQUFvQixxS0FBbUU7QUFDdkY7QUFDQTtBQUNBO0FBQ0EsRUFBRSxtR0FBd0I7O0FBRTFCLEVBQUUsaUhBQStCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsOENBQThDO0FBQzlDO0FBQ0Esd0RBQXdEO0FBQ3hELDhDQUE4QyxzQkFBc0I7QUFDcEU7QUFDQSxhQUFhLFNBQVMsZ0RBQWdEO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RDtBQUN2RCw4Q0FBOEMsc0JBQXNCO0FBQ3BFO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsMkVBQWE7QUFDdEI7QUFDQSx5REFBZSxJQUFJLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92dWUzLXdlYnBhY2s1Ly4vbm9kZV9tb2R1bGVzL2Nlc2l1bS9Tb3VyY2UvU2NlbmUvTW9vbi5qcz9hYWJjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBidWlsZE1vZHVsZVVybCBmcm9tIFwiLi4vQ29yZS9idWlsZE1vZHVsZVVybC5qc1wiO1xuaW1wb3J0IENhcnRlc2lhbjMgZnJvbSBcIi4uL0NvcmUvQ2FydGVzaWFuMy5qc1wiO1xuaW1wb3J0IGRlZmF1bHRWYWx1ZSBmcm9tIFwiLi4vQ29yZS9kZWZhdWx0VmFsdWUuanNcIjtcbmltcG9ydCBkZWZpbmVkIGZyb20gXCIuLi9Db3JlL2RlZmluZWQuanNcIjtcbmltcG9ydCBkZXN0cm95T2JqZWN0IGZyb20gXCIuLi9Db3JlL2Rlc3Ryb3lPYmplY3QuanNcIjtcbmltcG9ydCBFbGxpcHNvaWQgZnJvbSBcIi4uL0NvcmUvRWxsaXBzb2lkLmpzXCI7XG5pbXBvcnQgSWF1T3JpZW50YXRpb25BeGVzIGZyb20gXCIuLi9Db3JlL0lhdU9yaWVudGF0aW9uQXhlcy5qc1wiO1xuaW1wb3J0IE1hdHJpeDMgZnJvbSBcIi4uL0NvcmUvTWF0cml4My5qc1wiO1xuaW1wb3J0IE1hdHJpeDQgZnJvbSBcIi4uL0NvcmUvTWF0cml4NC5qc1wiO1xuaW1wb3J0IFNpbW9uMTk5NFBsYW5ldGFyeVBvc2l0aW9ucyBmcm9tIFwiLi4vQ29yZS9TaW1vbjE5OTRQbGFuZXRhcnlQb3NpdGlvbnMuanNcIjtcbmltcG9ydCBUcmFuc2Zvcm1zIGZyb20gXCIuLi9Db3JlL1RyYW5zZm9ybXMuanNcIjtcbmltcG9ydCBFbGxpcHNvaWRQcmltaXRpdmUgZnJvbSBcIi4vRWxsaXBzb2lkUHJpbWl0aXZlLmpzXCI7XG5pbXBvcnQgTWF0ZXJpYWwgZnJvbSBcIi4vTWF0ZXJpYWwuanNcIjtcblxuLyoqXG4gKiBEcmF3cyB0aGUgTW9vbiBpbiAzRC5cbiAqIEBhbGlhcyBNb29uXG4gKiBAY29uc3RydWN0b3JcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIE9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuc2hvdz10cnVlXSBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIG1vb24gd2lsbCBiZSByZW5kZXJlZC5cbiAqIEBwYXJhbSB7U3RyaW5nfSBbb3B0aW9ucy50ZXh0dXJlVXJsPWJ1aWxkTW9kdWxlVXJsKCdBc3NldHMvVGV4dHVyZXMvbW9vblNtYWxsLmpwZycpXSBUaGUgbW9vbiB0ZXh0dXJlLlxuICogQHBhcmFtIHtFbGxpcHNvaWR9IFtvcHRpb25zLmVsbGlwc29pZD1FbGxpcHNvaWQuTU9PTl0gVGhlIG1vb24gZWxsaXBzb2lkLlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5vbmx5U3VuTGlnaHRpbmc9dHJ1ZV0gVXNlIHRoZSBzdW4gYXMgdGhlIG9ubHkgbGlnaHQgc291cmNlLlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogc2NlbmUubW9vbiA9IG5ldyBDZXNpdW0uTW9vbigpO1xuICpcbiAqIEBzZWUgU2NlbmUjbW9vblxuICovXG5mdW5jdGlvbiBNb29uKG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLCBkZWZhdWx0VmFsdWUuRU1QVFlfT0JKRUNUKTtcblxuICB2YXIgdXJsID0gb3B0aW9ucy50ZXh0dXJlVXJsO1xuICBpZiAoIWRlZmluZWQodXJsKSkge1xuICAgIHVybCA9IGJ1aWxkTW9kdWxlVXJsKFwiQXNzZXRzL1RleHR1cmVzL21vb25TbWFsbC5qcGdcIik7XG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiB0aGUgbW9vbiB3aWxsIGJlIHNob3duLlxuICAgKlxuICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICogQGRlZmF1bHQgdHJ1ZVxuICAgKi9cbiAgdGhpcy5zaG93ID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuc2hvdywgdHJ1ZSk7XG5cbiAgLyoqXG4gICAqIFRoZSBtb29uIHRleHR1cmUuXG4gICAqIEB0eXBlIHtTdHJpbmd9XG4gICAqIEBkZWZhdWx0IGJ1aWxkTW9kdWxlVXJsKCdBc3NldHMvVGV4dHVyZXMvbW9vblNtYWxsLmpwZycpXG4gICAqL1xuICB0aGlzLnRleHR1cmVVcmwgPSB1cmw7XG5cbiAgdGhpcy5fZWxsaXBzb2lkID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuZWxsaXBzb2lkLCBFbGxpcHNvaWQuTU9PTik7XG5cbiAgLyoqXG4gICAqIFVzZSB0aGUgc3VuIGFzIHRoZSBvbmx5IGxpZ2h0IHNvdXJjZS5cbiAgICogQHR5cGUge0Jvb2xlYW59XG4gICAqIEBkZWZhdWx0IHRydWVcbiAgICovXG4gIHRoaXMub25seVN1bkxpZ2h0aW5nID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMub25seVN1bkxpZ2h0aW5nLCB0cnVlKTtcblxuICB0aGlzLl9lbGxpcHNvaWRQcmltaXRpdmUgPSBuZXcgRWxsaXBzb2lkUHJpbWl0aXZlKHtcbiAgICByYWRpaTogdGhpcy5lbGxpcHNvaWQucmFkaWksXG4gICAgbWF0ZXJpYWw6IE1hdGVyaWFsLmZyb21UeXBlKE1hdGVyaWFsLkltYWdlVHlwZSksXG4gICAgZGVwdGhUZXN0RW5hYmxlZDogZmFsc2UsXG4gICAgX293bmVyOiB0aGlzLFxuICB9KTtcbiAgdGhpcy5fZWxsaXBzb2lkUHJpbWl0aXZlLm1hdGVyaWFsLnRyYW5zbHVjZW50ID0gZmFsc2U7XG5cbiAgdGhpcy5fYXhlcyA9IG5ldyBJYXVPcmllbnRhdGlvbkF4ZXMoKTtcbn1cblxuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoTW9vbi5wcm90b3R5cGUsIHtcbiAgLyoqXG4gICAqIEdldCB0aGUgZWxsaXBzb2lkIHRoYXQgZGVmaW5lcyB0aGUgc2hhcGUgb2YgdGhlIG1vb24uXG4gICAqXG4gICAqIEBtZW1iZXJvZiBNb29uLnByb3RvdHlwZVxuICAgKlxuICAgKiBAdHlwZSB7RWxsaXBzb2lkfVxuICAgKiBAcmVhZG9ubHlcbiAgICpcbiAgICogQGRlZmF1bHQge0BsaW5rIEVsbGlwc29pZC5NT09OfVxuICAgKi9cbiAgZWxsaXBzb2lkOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZWxsaXBzb2lkO1xuICAgIH0sXG4gIH0sXG59KTtcblxudmFyIGljcmZUb0ZpeGVkID0gbmV3IE1hdHJpeDMoKTtcbnZhciByb3RhdGlvblNjcmF0Y2ggPSBuZXcgTWF0cml4MygpO1xudmFyIHRyYW5zbGF0aW9uU2NyYXRjaCA9IG5ldyBDYXJ0ZXNpYW4zKCk7XG52YXIgc2NyYXRjaENvbW1hbmRMaXN0ID0gW107XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuTW9vbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGZyYW1lU3RhdGUpIHtcbiAgaWYgKCF0aGlzLnNob3cpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgZWxsaXBzb2lkUHJpbWl0aXZlID0gdGhpcy5fZWxsaXBzb2lkUHJpbWl0aXZlO1xuICBlbGxpcHNvaWRQcmltaXRpdmUubWF0ZXJpYWwudW5pZm9ybXMuaW1hZ2UgPSB0aGlzLnRleHR1cmVVcmw7XG4gIGVsbGlwc29pZFByaW1pdGl2ZS5vbmx5U3VuTGlnaHRpbmcgPSB0aGlzLm9ubHlTdW5MaWdodGluZztcblxuICB2YXIgZGF0ZSA9IGZyYW1lU3RhdGUudGltZTtcbiAgaWYgKCFkZWZpbmVkKFRyYW5zZm9ybXMuY29tcHV0ZUljcmZUb0ZpeGVkTWF0cml4KGRhdGUsIGljcmZUb0ZpeGVkKSkpIHtcbiAgICBUcmFuc2Zvcm1zLmNvbXB1dGVUZW1lVG9Qc2V1ZG9GaXhlZE1hdHJpeChkYXRlLCBpY3JmVG9GaXhlZCk7XG4gIH1cblxuICB2YXIgcm90YXRpb24gPSB0aGlzLl9heGVzLmV2YWx1YXRlKGRhdGUsIHJvdGF0aW9uU2NyYXRjaCk7XG4gIE1hdHJpeDMudHJhbnNwb3NlKHJvdGF0aW9uLCByb3RhdGlvbik7XG4gIE1hdHJpeDMubXVsdGlwbHkoaWNyZlRvRml4ZWQsIHJvdGF0aW9uLCByb3RhdGlvbik7XG5cbiAgdmFyIHRyYW5zbGF0aW9uID0gU2ltb24xOTk0UGxhbmV0YXJ5UG9zaXRpb25zLmNvbXB1dGVNb29uUG9zaXRpb25JbkVhcnRoSW5lcnRpYWxGcmFtZShcbiAgICBkYXRlLFxuICAgIHRyYW5zbGF0aW9uU2NyYXRjaFxuICApO1xuICBNYXRyaXgzLm11bHRpcGx5QnlWZWN0b3IoaWNyZlRvRml4ZWQsIHRyYW5zbGF0aW9uLCB0cmFuc2xhdGlvbik7XG5cbiAgTWF0cml4NC5mcm9tUm90YXRpb25UcmFuc2xhdGlvbihcbiAgICByb3RhdGlvbixcbiAgICB0cmFuc2xhdGlvbixcbiAgICBlbGxpcHNvaWRQcmltaXRpdmUubW9kZWxNYXRyaXhcbiAgKTtcblxuICB2YXIgc2F2ZWRDb21tYW5kTGlzdCA9IGZyYW1lU3RhdGUuY29tbWFuZExpc3Q7XG4gIGZyYW1lU3RhdGUuY29tbWFuZExpc3QgPSBzY3JhdGNoQ29tbWFuZExpc3Q7XG4gIHNjcmF0Y2hDb21tYW5kTGlzdC5sZW5ndGggPSAwO1xuICBlbGxpcHNvaWRQcmltaXRpdmUudXBkYXRlKGZyYW1lU3RhdGUpO1xuICBmcmFtZVN0YXRlLmNvbW1hbmRMaXN0ID0gc2F2ZWRDb21tYW5kTGlzdDtcbiAgcmV0dXJuIHNjcmF0Y2hDb21tYW5kTGlzdC5sZW5ndGggPT09IDEgPyBzY3JhdGNoQ29tbWFuZExpc3RbMF0gOiB1bmRlZmluZWQ7XG59O1xuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIG9iamVjdCB3YXMgZGVzdHJveWVkOyBvdGhlcndpc2UsIGZhbHNlLlxuICogPGJyIC8+PGJyIC8+XG4gKiBJZiB0aGlzIG9iamVjdCB3YXMgZGVzdHJveWVkLCBpdCBzaG91bGQgbm90IGJlIHVzZWQ7IGNhbGxpbmcgYW55IGZ1bmN0aW9uIG90aGVyIHRoYW5cbiAqIDxjb2RlPmlzRGVzdHJveWVkPC9jb2RlPiB3aWxsIHJlc3VsdCBpbiBhIHtAbGluayBEZXZlbG9wZXJFcnJvcn0gZXhjZXB0aW9uLlxuICpcbiAqIEByZXR1cm5zIHtCb29sZWFufSA8Y29kZT50cnVlPC9jb2RlPiBpZiB0aGlzIG9iamVjdCB3YXMgZGVzdHJveWVkOyBvdGhlcndpc2UsIDxjb2RlPmZhbHNlPC9jb2RlPi5cbiAqXG4gKiBAc2VlIE1vb24jZGVzdHJveVxuICovXG5Nb29uLnByb3RvdHlwZS5pc0Rlc3Ryb3llZCA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuLyoqXG4gKiBEZXN0cm95cyB0aGUgV2ViR0wgcmVzb3VyY2VzIGhlbGQgYnkgdGhpcyBvYmplY3QuICBEZXN0cm95aW5nIGFuIG9iamVjdCBhbGxvd3MgZm9yIGRldGVybWluaXN0aWNcbiAqIHJlbGVhc2Ugb2YgV2ViR0wgcmVzb3VyY2VzLCBpbnN0ZWFkIG9mIHJlbHlpbmcgb24gdGhlIGdhcmJhZ2UgY29sbGVjdG9yIHRvIGRlc3Ryb3kgdGhpcyBvYmplY3QuXG4gKiA8YnIgLz48YnIgLz5cbiAqIE9uY2UgYW4gb2JqZWN0IGlzIGRlc3Ryb3llZCwgaXQgc2hvdWxkIG5vdCBiZSB1c2VkOyBjYWxsaW5nIGFueSBmdW5jdGlvbiBvdGhlciB0aGFuXG4gKiA8Y29kZT5pc0Rlc3Ryb3llZDwvY29kZT4gd2lsbCByZXN1bHQgaW4gYSB7QGxpbmsgRGV2ZWxvcGVyRXJyb3J9IGV4Y2VwdGlvbi4gIFRoZXJlZm9yZSxcbiAqIGFzc2lnbiB0aGUgcmV0dXJuIHZhbHVlICg8Y29kZT51bmRlZmluZWQ8L2NvZGU+KSB0byB0aGUgb2JqZWN0IGFzIGRvbmUgaW4gdGhlIGV4YW1wbGUuXG4gKlxuICogQGV4Y2VwdGlvbiB7RGV2ZWxvcGVyRXJyb3J9IFRoaXMgb2JqZWN0IHdhcyBkZXN0cm95ZWQsIGkuZS4sIGRlc3Ryb3koKSB3YXMgY2FsbGVkLlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogbW9vbiA9IG1vb24gJiYgbW9vbi5kZXN0cm95KCk7XG4gKlxuICogQHNlZSBNb29uI2lzRGVzdHJveWVkXG4gKi9cbk1vb24ucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuX2VsbGlwc29pZFByaW1pdGl2ZSA9XG4gICAgdGhpcy5fZWxsaXBzb2lkUHJpbWl0aXZlICYmIHRoaXMuX2VsbGlwc29pZFByaW1pdGl2ZS5kZXN0cm95KCk7XG4gIHJldHVybiBkZXN0cm95T2JqZWN0KHRoaXMpO1xufTtcbmV4cG9ydCBkZWZhdWx0IE1vb247XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///39982\n')}}]);