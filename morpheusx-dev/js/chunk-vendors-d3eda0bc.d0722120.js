"use strict";(self["webpackChunkvue3_webpack5"]=self["webpackChunkvue3_webpack5"]||[]).push([[8850],{87717:function(e,t,r){var i=r(48243),a=r(72e3),n=r(60216),o=r(51688),s=r(59947),d=r(62200),u=r(82982),l=r(86511),c=r(12572),h=r(50491),m=r(81176),p=r(14459),g=r(67627),f=r(15720),_=r(68457),y=r(96190),v=r(68985),Z=r(53642),T=r(8743),C=r(20909),x=r(15314),S=r(62868),A=r(13222),D=r(55188),E=r(32110),b=r(90538),w=r(59848),F=r(9733),N=r(89917),L=r(34125);function R(e){e=(0,d.Z)(e,h.Z.WGS84);var t=new m.Z({ellipsoid:e}),r=new w.Z;this._ellipsoid=e,this._imageryLayerCollection=r,this._surfaceShaderSet=new D.Z,this._material=void 0,this._surface=new F.Z({tileProvider:new E.Z({terrainProvider:t,imageryLayers:r,surfaceShaderSet:this._surfaceShaderSet})}),this._terrainProvider=t,this._terrainProviderChanged=new p.Z,this._undergroundColor=s.Z.clone(s.Z.BLACK),this._undergroundColorAlphaByDistance=new f.Z(e.maximumRadius/1e3,0,e.maximumRadius/5,1),this._translucency=new b.Z,P(this),this.show=!0,this._oceanNormalMapResourceDirty=!0,this._oceanNormalMapResource=new v.Z({url:(0,a.Z)("Assets/Textures/waterNormalsSmall.jpg")}),this.maximumScreenSpaceError=2,this.tileCacheSize=100,this.loadingDescendantLimit=20,this.preloadAncestors=!0,this.preloadSiblings=!1,this.fillHighlightColor=void 0,this.enableLighting=!1,this.dynamicAtmosphereLighting=!0,this.dynamicAtmosphereLightingFromSun=!1,this.showGroundAtmosphere=!0,this.lightingFadeOutDistance=1e7,this.lightingFadeInDistance=2e7,this.nightFadeOutDistance=1e7,this.nightFadeInDistance=5e7,this.showWaterEffect=!0,this.depthTestAgainstTerrain=!1,this.shadows=L.Z.RECEIVE_ONLY,this.atmosphereHueShift=0,this.atmosphereSaturationShift=0,this.atmosphereBrightnessShift=0,this.terrainExaggeration=1,this.terrainExaggerationRelativeHeight=0,this.showSkirts=!0,this.backFaceCulling=!0,this._oceanNormalMap=void 0,this._zoomedOutOceanSpecularIntensity=void 0}function P(e){var t=[],r=(0,u.Z)(e._material)&&(e._material.shaderSource.match(/slope/)||e._material.shaderSource.match("normalEC")),i=[S.Z];!(0,u.Z)(e._material)||r&&!e._terrainProvider.requestVertexNormals?e._surface._tileProvider.materialUniformMap=void 0:(i.push(e._material.shaderSource),t.push("APPLY_MATERIAL"),e._surface._tileProvider.materialUniformMap=e._material._uniforms),i.push(C.Z),e._surfaceShaderSet.baseVertexShaderSource=new Z.Z({sources:[S.Z,x.Z],defines:t}),e._surfaceShaderSet.baseFragmentShaderSource=new Z.Z({sources:i,defines:t}),e._surfaceShaderSet.material=e._material}function O(e){return function(t,r){var a=i.Z.distanceSquaredTo(t.pickBoundingSphere,e),n=i.Z.distanceSquaredTo(r.pickBoundingSphere,e);return a-n}}Object.defineProperties(R.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},imageryLayers:{get:function(){return this._imageryLayerCollection}},imageryLayersUpdatedEvent:{get:function(){return this._surface.tileProvider.imageryLayersUpdatedEvent}},tilesLoaded:{get:function(){return!(0,u.Z)(this._surface)||this._surface.tileProvider.ready&&0===this._surface._tileLoadQueueHigh.length&&0===this._surface._tileLoadQueueMedium.length&&0===this._surface._tileLoadQueueLow.length}},baseColor:{get:function(){return this._surface.tileProvider.baseColor},set:function(e){this._surface.tileProvider.baseColor=e}},clippingPlanes:{get:function(){return this._surface.tileProvider.clippingPlanes},set:function(e){this._surface.tileProvider.clippingPlanes=e}},cartographicLimitRectangle:{get:function(){return this._surface.tileProvider.cartographicLimitRectangle},set:function(e){(0,u.Z)(e)||(e=y.Z.clone(y.Z.MAX_VALUE)),this._surface.tileProvider.cartographicLimitRectangle=e}},oceanNormalMapUrl:{get:function(){return this._oceanNormalMapResource.url},set:function(e){this._oceanNormalMapResource.url=e,this._oceanNormalMapResourceDirty=!0}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){e!==this._terrainProvider&&(this._terrainProvider=e,this._terrainProviderChanged.raiseEvent(e),(0,u.Z)(this._material)&&P(this))}},terrainProviderChanged:{get:function(){return this._terrainProviderChanged}},tileLoadProgressEvent:{get:function(){return this._surface.tileLoadProgressEvent}},material:{get:function(){return this._material},set:function(e){this._material!==e&&(this._material=e,P(this))}},undergroundColor:{get:function(){return this._undergroundColor},set:function(e){this._undergroundColor=s.Z.clone(e,this._undergroundColor)}},undergroundColorAlphaByDistance:{get:function(){return this._undergroundColorAlphaByDistance},set:function(e){if((0,u.Z)(e)&&e.far<e.near)throw new c.Z("far distance must be greater than near distance.");this._undergroundColorAlphaByDistance=f.Z.clone(e,this._undergroundColorAlphaByDistance)}},translucency:{get:function(){return this._translucency}}});var M=[],I={start:0,stop:0};R.prototype.pickWorldCoordinates=function(e,t,r,a){if(!(0,u.Z)(e))throw new c.Z("ray is required");if(!(0,u.Z)(t))throw new c.Z("scene is required");r=(0,d.Z)(r,!0);var o=t.mode,s=t.mapProjection,l=M;l.length=0;var h,m,p,f=this._surface._tilesToRender,_=f.length;for(m=0;m<_;++m){h=f[m];var y=h.data;if((0,u.Z)(y)){var v=y.pickBoundingSphere;if(o!==N.Z.SCENE3D)y.pickBoundingSphere=v=i.Z.fromRectangleWithHeights2D(h.rectangle,s,y.tileBoundingRegion.minimumHeight,y.tileBoundingRegion.maximumHeight,v),n.Z.fromElements(v.center.z,v.center.x,v.center.y,v.center);else{if(!(0,u.Z)(y.renderedMesh))continue;i.Z.clone(y.tileBoundingRegion.boundingSphere,v)}var Z=g.Z.raySphere(e,v,I);(0,u.Z)(Z)&&l.push(y)}}for(l.sort(O(e.origin)),_=l.length,m=0;m<_;++m)if(p=l[m].pick(e,t.mode,t.mapProjection,r,a),(0,u.Z)(p))break;return p};var B=new o.Z;R.prototype.pick=function(e,t,r){if(r=this.pickWorldCoordinates(e,t,!0,r),(0,u.Z)(r)&&t.mode!==N.Z.SCENE3D){r=n.Z.fromElements(r.y,r.z,r.x,r);var i=t.mapProjection.unproject(r,B);r=t.globe.ellipsoid.cartographicToCartesian(i,r)}return r};var H=new n.Z,k=new n.Z,U=new o.Z,G=new _.Z;function V(e,t){return(0,u.Z)(e)&&y.Z.contains(e.rectangle,t)?e:void 0}R.prototype.getHeight=function(e){if(!(0,u.Z)(e))throw new c.Z("cartographic is required");var t=this._surface._levelZeroTiles;if((0,u.Z)(t)){var r,i,a=t.length;for(i=0;i<a;++i)if(r=t[i],y.Z.contains(r.rectangle,e))break;if(!(i>=a)){var o=r;while((0,u.Z)(r))r=V(r._southwestChild,e)||V(r._southeastChild,e)||V(r._northwestChild,e)||r._northeastChild,(0,u.Z)(r)&&(0,u.Z)(r.data)&&(0,u.Z)(r.data.renderedMesh)&&(o=r);if(r=o,(0,u.Z)(r)&&(0,u.Z)(r.data)&&(0,u.Z)(r.data.renderedMesh)){var s=this._surface._tileProvider.tilingScheme.projection,l=this._surface._tileProvider.tilingScheme.ellipsoid,h=n.Z.fromRadians(e.longitude,e.latitude,0,l,H),m=G,p=l.geodeticSurfaceNormal(h,m.direction),g=l.getSurfaceNormalIntersectionWithZAxis(h,11500,m.origin);if(!(0,u.Z)(g)){var f;(0,u.Z)(r.data.tileBoundingRegion)&&(f=r.data.tileBoundingRegion.minimumHeight);var _=Math.min((0,d.Z)(f,0),-11500),v=n.Z.multiplyByScalar(p,Math.abs(_)+1,k);n.Z.subtract(h,v,m.origin)}var Z=r.data.pick(m,void 0,s,!1,k);if((0,u.Z)(Z))return l.cartesianToCartographic(Z,U).height}}}},R.prototype.update=function(e){this.show&&e.passes.render&&this._surface.update(e)},R.prototype.beginFrame=function(e){var t=this._surface,r=t.tileProvider,i=this.terrainProvider,a=this.showWaterEffect&&i.ready&&i.hasWaterMask;if(a&&this._oceanNormalMapResourceDirty){this._oceanNormalMapResourceDirty=!1;var n=this._oceanNormalMapResource,o=n.url;if((0,u.Z)(o)){var s=this;(0,A.Z)(n.fetchImage(),(function(t){o===s._oceanNormalMapResource.url&&(s._oceanNormalMap=s._oceanNormalMap&&s._oceanNormalMap.destroy(),s._oceanNormalMap=new T.Z({context:e.context,source:t}))}))}else this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy()}var d=e.passes,l=e.mode;d.render&&(this.showGroundAtmosphere?this._zoomedOutOceanSpecularIntensity=.4:this._zoomedOutOceanSpecularIntensity=.5,t.maximumScreenSpaceError=this.maximumScreenSpaceError,t.tileCacheSize=this.tileCacheSize,t.loadingDescendantLimit=this.loadingDescendantLimit,t.preloadAncestors=this.preloadAncestors,t.preloadSiblings=this.preloadSiblings,r.terrainProvider=this.terrainProvider,r.lightingFadeOutDistance=this.lightingFadeOutDistance,r.lightingFadeInDistance=this.lightingFadeInDistance,r.nightFadeOutDistance=this.nightFadeOutDistance,r.nightFadeInDistance=this.nightFadeInDistance,r.zoomedOutOceanSpecularIntensity=l===N.Z.SCENE3D?this._zoomedOutOceanSpecularIntensity:0,r.hasWaterMask=a,r.oceanNormalMap=this._oceanNormalMap,r.enableLighting=this.enableLighting,r.dynamicAtmosphereLighting=this.dynamicAtmosphereLighting,r.dynamicAtmosphereLightingFromSun=this.dynamicAtmosphereLightingFromSun,r.showGroundAtmosphere=this.showGroundAtmosphere,r.shadows=this.shadows,r.hueShift=this.atmosphereHueShift,r.saturationShift=this.atmosphereSaturationShift,r.brightnessShift=this.atmosphereBrightnessShift,r.fillHighlightColor=this.fillHighlightColor,r.showSkirts=this.showSkirts,r.backFaceCulling=this.backFaceCulling,r.undergroundColor=this._undergroundColor,r.undergroundColorAlphaByDistance=this._undergroundColorAlphaByDistance,t.beginFrame(e))},R.prototype.render=function(e){this.show&&((0,u.Z)(this._material)&&this._material.update(e.context),this._surface.render(e))},R.prototype.endFrame=function(e){this.show&&e.passes.render&&this._surface.endFrame(e)},R.prototype.isDestroyed=function(){return!1},R.prototype.destroy=function(){return this._surfaceShaderSet=this._surfaceShaderSet&&this._surfaceShaderSet.destroy(),this._surface=this._surface&&this._surface.destroy(),this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy(),(0,l.Z)(this)},t["Z"]=R},55977:function(e,t,r){var i=r(88108),a=r(59947),n=r(82982),o=r(86511),s=r(38443),d=r(39899),u=r(2932),l=r(21572),c=r(10667),h=r(87721),m=r(53642),p=r(8743),g=r(7571),f=r(82239),_=r(13633),y=r(87233),v=r(77053),Z=r(81255);function T(){this._globeColorTexture=void 0,this._primitiveColorTexture=void 0,this._depthStencilTexture=void 0,this._globeDepthTexture=void 0,this._tempGlobeDepthTexture=void 0,this._tempCopyDepthTexture=void 0,this._globeColorFramebuffer=void 0,this._primitiveColorFramebuffer=void 0,this._copyDepthFramebuffer=void 0,this._tempCopyDepthFramebuffer=void 0,this._updateDepthFramebuffer=void 0,this._clearGlobeColorCommand=void 0,this._clearPrimitiveColorCommand=void 0,this._copyColorCommand=void 0,this._copyDepthCommand=void 0,this._tempCopyDepthCommand=void 0,this._updateDepthCommand=void 0,this._mergeColorCommand=void 0,this._viewport=new i.Z,this._rs=void 0,this._rsBlend=void 0,this._rsUpdate=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useLogDepth=void 0,this._useHdr=void 0,this._clearGlobeDepth=void 0,this._debugGlobeDepthViewportCommand=void 0}function C(e,t,r,i){if(!(0,n.Z)(e._debugGlobeDepthViewportCommand)||i!==e._useLogDepth){var a="uniform highp sampler2D u_depthTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    float z_window = czm_unpackDepth(texture2D(u_depthTexture, v_textureCoordinates));\n    z_window = czm_reverseLogDepth(z_window); \n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n",o=new m.Z({defines:[i?"LOG_DEPTH":""],sources:[a]});e._debugGlobeDepthViewportCommand=t.createViewportQuadCommand(o,{uniformMap:{u_depthTexture:function(){return e._globeDepthTexture}},owner:e}),e._useLogDepth=i}e._debugGlobeDepthViewportCommand.execute(t,r)}function x(e){e._globeColorTexture=e._globeColorTexture&&!e._globeColorTexture.isDestroyed()&&e._globeColorTexture.destroy(),e._depthStencilTexture=e._depthStencilTexture&&!e._depthStencilTexture.isDestroyed()&&e._depthStencilTexture.destroy(),e._globeDepthTexture=e._globeDepthTexture&&!e._globeDepthTexture.isDestroyed()&&e._globeDepthTexture.destroy()}function S(e){e._globeColorFramebuffer=e._globeColorFramebuffer&&!e._globeColorFramebuffer.isDestroyed()&&e._globeColorFramebuffer.destroy(),e._copyDepthFramebuffer=e._copyDepthFramebuffer&&!e._copyDepthFramebuffer.isDestroyed()&&e._copyDepthFramebuffer.destroy()}function A(e){e._tempCopyDepthFramebuffer=e._tempCopyDepthFramebuffer&&!e._tempCopyDepthFramebuffer.isDestroyed()&&e._tempCopyDepthFramebuffer.destroy(),e._updateDepthFramebuffer=e._updateDepthFramebuffer&&!e._updateDepthFramebuffer.isDestroyed()&&e._updateDepthFramebuffer.destroy(),e._tempGlobeDepthTexture=e._tempGlobeDepthTexture&&!e._tempGlobeDepthTexture.isDestroyed()&&e._tempGlobeDepthTexture.destroy()}function D(e,t,r,i,a){e._tempGlobeDepthTexture=new p.Z({context:t,width:r,height:i,pixelFormat:s.Z.RGBA,pixelDatatype:l.Z.UNSIGNED_BYTE,sampler:h.Z.NEAREST}),e._tempCopyDepthFramebuffer=new u.Z({context:t,colorTextures:[e._tempGlobeDepthTexture],destroyAttachments:!1}),e._updateDepthFramebuffer=new u.Z({context:t,colorTextures:[e._globeDepthTexture],depthStencilTexture:a.framebuffer.depthStencilTexture,destroyAttachments:!1})}function E(e,t,r,i,a){var n=a?t.halfFloatingPointTexture?l.Z.HALF_FLOAT:l.Z.FLOAT:l.Z.UNSIGNED_BYTE;e._globeColorTexture=new p.Z({context:t,width:r,height:i,pixelFormat:s.Z.RGBA,pixelDatatype:n,sampler:h.Z.NEAREST}),e._depthStencilTexture=new p.Z({context:t,width:r,height:i,pixelFormat:s.Z.DEPTH_STENCIL,pixelDatatype:l.Z.UNSIGNED_INT_24_8}),e._globeDepthTexture=new p.Z({context:t,width:r,height:i,pixelFormat:s.Z.RGBA,pixelDatatype:l.Z.UNSIGNED_BYTE,sampler:h.Z.NEAREST})}function b(e,t){e._globeColorFramebuffer=new u.Z({context:t,colorTextures:[e._globeColorTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._copyDepthFramebuffer=new u.Z({context:t,colorTextures:[e._globeDepthTexture],destroyAttachments:!1})}function w(e,t,r,i,a){var n=a?t.halfFloatingPointTexture?l.Z.HALF_FLOAT:l.Z.FLOAT:l.Z.UNSIGNED_BYTE;e._primitiveColorTexture=new p.Z({context:t,width:r,height:i,pixelFormat:s.Z.RGBA,pixelDatatype:n,sampler:h.Z.NEAREST}),e._primitiveColorFramebuffer=new u.Z({context:t,colorTextures:[e._primitiveColorTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1})}function F(e){e._primitiveColorTexture=e._primitiveColorTexture&&!e._primitiveColorTexture.isDestroyed()&&e._primitiveColorTexture.destroy(),e._primitiveColorFramebuffer=e._primitiveColorFramebuffer&&!e._primitiveColorFramebuffer.isDestroyed()&&e._primitiveColorFramebuffer.destroy()}function N(e,t,r,i,a,o){var s=e._globeColorTexture,d=!(0,n.Z)(s)||s.width!==r||s.height!==i||a!==e._useHdr;d&&(x(e),S(e),E(e,t,r,i,a,o),b(e,t,o)),(d||o!==e._clearGlobeDepth)&&(F(e),o&&w(e,t,r,i,a))}function L(e,t,r,o,s){e._viewport.width=r,e._viewport.height=o;var u=!i.Z.equals(e._viewport,s.viewport),l=u!==e._useScissorTest;e._useScissorTest=u,i.Z.equals(e._scissorRectangle,s.viewport)||(e._scissorRectangle=i.Z.clone(s.viewport,e._scissorRectangle),l=!0),(0,n.Z)(e._rs)&&i.Z.equals(e._viewport,e._rs.viewport)&&!l||(e._rs=c.Z.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}}),e._rsBlend=c.Z.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},blending:_.Z.ALPHA_BLEND}),e._rsUpdate=c.Z.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},stencilTest:{enabled:!0,frontFunction:v.Z.EQUAL,frontOperation:{fail:Z.Z.KEEP,zFail:Z.Z.KEEP,zPass:Z.Z.KEEP},backFunction:v.Z.NEVER,reference:y.Z.CESIUM_3D_TILE_MASK,mask:y.Z.CESIUM_3D_TILE_MASK}})),(0,n.Z)(e._copyDepthCommand)||(e._copyDepthCommand=t.createViewportQuadCommand(f.Z,{uniformMap:{u_depthTexture:function(){return e._depthStencilTexture}},owner:e})),e._copyDepthCommand.framebuffer=e._copyDepthFramebuffer,e._copyDepthCommand.renderState=e._rs,(0,n.Z)(e._copyColorCommand)||(e._copyColorCommand=t.createViewportQuadCommand(g.Z,{uniformMap:{colorTexture:function(){return e._globeColorTexture}},owner:e})),e._copyColorCommand.renderState=e._rs,(0,n.Z)(e._tempCopyDepthCommand)||(e._tempCopyDepthCommand=t.createViewportQuadCommand(f.Z,{uniformMap:{u_depthTexture:function(){return e._tempCopyDepthTexture}},owner:e})),e._tempCopyDepthCommand.framebuffer=e._tempCopyDepthFramebuffer,e._tempCopyDepthCommand.renderState=e._rs,(0,n.Z)(e._updateDepthCommand)||(e._updateDepthCommand=t.createViewportQuadCommand(g.Z,{uniformMap:{colorTexture:function(){return e._tempGlobeDepthTexture}},owner:e})),e._updateDepthCommand.framebuffer=e._updateDepthFramebuffer,e._updateDepthCommand.renderState=e._rsUpdate,(0,n.Z)(e._clearGlobeColorCommand)||(e._clearGlobeColorCommand=new d.Z({color:new a.Z(0,0,0,0),stencil:0,owner:e})),e._clearGlobeColorCommand.framebuffer=e._globeColorFramebuffer,(0,n.Z)(e._clearPrimitiveColorCommand)||(e._clearPrimitiveColorCommand=new d.Z({color:new a.Z(0,0,0,0),stencil:0,owner:e})),e._clearPrimitiveColorCommand.framebuffer=e._primitiveColorFramebuffer,(0,n.Z)(e._mergeColorCommand)||(e._mergeColorCommand=t.createViewportQuadCommand(g.Z,{uniformMap:{colorTexture:function(){return e._primitiveColorTexture}},owner:e})),e._mergeColorCommand.framebuffer=e._globeColorFramebuffer,e._mergeColorCommand.renderState=e._rsBlend}Object.defineProperties(T.prototype,{framebuffer:{get:function(){return this._globeColorFramebuffer}},primitiveFramebuffer:{get:function(){return this._primitiveColorFramebuffer}}}),T.prototype.executeDebugGlobeDepth=function(e,t,r){C(this,e,t,r)},T.prototype.update=function(e,t,r,i,a){var n=r.width,o=r.height;N(this,e,n,o,i,a),L(this,e,n,o,t),e.uniformState.globeDepthTexture=void 0,this._useHdr=i,this._clearGlobeDepth=a},T.prototype.executeCopyDepth=function(e,t){(0,n.Z)(this._copyDepthCommand)&&(this._copyDepthCommand.execute(e,t),e.uniformState.globeDepthTexture=this._globeDepthTexture)},T.prototype.executeUpdateDepth=function(e,t,r){var i=t.framebuffer.depthStencilTexture;if(r||i!==this._depthStencilTexture){if((0,n.Z)(this._updateDepthCommand)){if(!(0,n.Z)(this._updateDepthFramebuffer)||this._updateDepthFramebuffer.depthStencilTexture!==i||this._updateDepthFramebuffer.getColorTexture(0)!==this._globeDepthTexture){var a=this._globeDepthTexture.width,o=this._globeDepthTexture.height;A(this),D(this,e,a,o,t),L(this,e,a,o,t)}this._tempCopyDepthTexture=i,this._tempCopyDepthCommand.execute(e,t),this._updateDepthCommand.execute(e,t)}}else(0,n.Z)(this._copyDepthCommand)&&this._copyDepthCommand.execute(e,t)},T.prototype.executeCopyColor=function(e,t){(0,n.Z)(this._copyColorCommand)&&this._copyColorCommand.execute(e,t)},T.prototype.executeMergeColor=function(e,t){(0,n.Z)(this._mergeColorCommand)&&this._mergeColorCommand.execute(e,t)},T.prototype.clear=function(e,t,r){var i=this._clearGlobeColorCommand;(0,n.Z)(i)&&(a.Z.clone(r,i.color),i.execute(e,t)),i=this._clearPrimitiveColorCommand,(0,n.Z)(i)&&(0,n.Z)(this._primitiveColorFramebuffer)&&i.execute(e,t)},T.prototype.isDestroyed=function(){return!1},T.prototype.destroy=function(){return x(this),S(this),F(this),A(this),(0,n.Z)(this._copyColorCommand)&&(this._copyColorCommand.shaderProgram=this._copyColorCommand.shaderProgram.destroy()),(0,n.Z)(this._copyDepthCommand)&&(this._copyDepthCommand.shaderProgram=this._copyDepthCommand.shaderProgram.destroy()),(0,n.Z)(this._tempCopyDepthCommand)&&(this._tempCopyDepthCommand.shaderProgram=this._tempCopyDepthCommand.shaderProgram.destroy()),(0,n.Z)(this._updateDepthCommand)&&(this._updateDepthCommand.shaderProgram=this._updateDepthCommand.shaderProgram.destroy()),(0,n.Z)(this._mergeColorCommand)&&(this._mergeColorCommand.shaderProgram=this._mergeColorCommand.shaderProgram.destroy()),(0,n.Z)(this._debugGlobeDepthViewportCommand)&&(this._debugGlobeDepthViewportCommand.shaderProgram=this._debugGlobeDepthViewportCommand.shaderProgram.destroy()),(0,o.Z)(this)},t["Z"]=T},55188:function(e,t,r){var i=r(82982),a=r(86511),n=r(735),o=r(46588),s=r(84167),d=r(89917);function u(e,t,r,i,a){this.numberOfDayTextures=e,this.flags=t,this.material=r,this.shaderProgram=i,this.clippingShaderState=a}function l(){this.baseVertexShaderSource=void 0,this.baseFragmentShaderSource=void 0,this._shadersByTexturesFlags=[],this.material=void 0}function c(e){var t,r="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPosition3DMode(position, height, textureCoordinates); }",i="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionColumbusViewMode(position, height, textureCoordinates); }",a="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionMorphingMode(position, height, textureCoordinates); }";switch(e){case d.Z.SCENE3D:t=r;break;case d.Z.SCENE2D:case d.Z.COLUMBUS_VIEW:t=i;break;case d.Z.MORPHING:t=a;break}return t}function h(e){var t="float get2DYPositionFraction(vec2 textureCoordinates) { return get2DGeographicYPositionFraction(textureCoordinates); }",r="float get2DYPositionFraction(vec2 textureCoordinates) { return get2DMercatorYPositionFraction(textureCoordinates); }";return e?r:t}l.prototype.getShaderProgram=function(e){var t=e.frameState,r=e.surfaceTile,a=e.numberOfDayTextures,d=e.applyBrightness,l=e.applyContrast,m=e.applyHue,p=e.applySaturation,g=e.applyGamma,f=e.applyAlpha,_=e.applyDayNightAlpha,y=e.applySplit,v=e.showReflectiveOcean,Z=e.showOceanWaves,T=e.enableLighting,C=e.dynamicAtmosphereLighting,x=e.dynamicAtmosphereLightingFromSun,S=e.showGroundAtmosphere,A=e.perFragmentGroundAtmosphere,D=e.hasVertexNormals,E=e.useWebMercatorProjection,b=e.enableFog,w=e.enableClippingPlanes,F=e.clippingPlanes,N=e.clippedByBoundaries,L=e.hasImageryLayerCutout,R=e.colorCorrect,P=e.highlightFillTile,O=e.colorToAlpha,M=e.hasGeodeticSurfaceNormals,I=e.hasExaggeration,B=e.showUndergroundColor,H=e.translucent,k=0,U="",G=r.renderedMesh,V=G.encoding,z=V.quantization;z===n.Z.BITS12&&(k=1,U="QUANTIZATION_BITS12");var q=0,W="";N&&(q=1,W="TILE_LIMIT_RECTANGLE");var Y=0,K="";L&&(Y=1,K="APPLY_IMAGERY_CUTOUT");var j=t.mode,Q=j|d<<2|l<<3|m<<4|p<<5|g<<6|f<<7|v<<8|Z<<9|T<<10|C<<11|x<<12|S<<13|A<<14|D<<15|E<<16|b<<17|k<<18|y<<19|w<<20|q<<21|Y<<22|R<<23|P<<24|O<<25|M<<26|I<<27|B<<28|H<<29|_<<30,X=0;(0,i.Z)(F)&&F.length>0&&(X=w?F.clippingPlanesState:0);var J=r.surfaceShader;if((0,i.Z)(J)&&J.numberOfDayTextures===a&&J.flags===Q&&J.material===this.material&&J.clippingShaderState===X)return J.shaderProgram;var $=this._shadersByTexturesFlags[a];if((0,i.Z)($)||($=this._shadersByTexturesFlags[a]=[]),J=$[Q],!(0,i.Z)(J)||J.material!==this.material||J.clippingShaderState!==X){var ee=this.baseVertexShaderSource.clone(),te=this.baseFragmentShaderSource.clone();0!==X&&te.sources.unshift((0,s.Z)(F,t.context)),ee.defines.push(U),te.defines.push("TEXTURE_UNITS "+a,W,K),d&&te.defines.push("APPLY_BRIGHTNESS"),l&&te.defines.push("APPLY_CONTRAST"),m&&te.defines.push("APPLY_HUE"),p&&te.defines.push("APPLY_SATURATION"),g&&te.defines.push("APPLY_GAMMA"),f&&te.defines.push("APPLY_ALPHA"),_&&te.defines.push("APPLY_DAY_NIGHT_ALPHA"),v&&(te.defines.push("SHOW_REFLECTIVE_OCEAN"),ee.defines.push("SHOW_REFLECTIVE_OCEAN")),Z&&te.defines.push("SHOW_OCEAN_WAVES"),O&&te.defines.push("APPLY_COLOR_TO_ALPHA"),B&&(ee.defines.push("UNDERGROUND_COLOR"),te.defines.push("UNDERGROUND_COLOR")),H&&(ee.defines.push("TRANSLUCENT"),te.defines.push("TRANSLUCENT")),T&&(D?(ee.defines.push("ENABLE_VERTEX_LIGHTING"),te.defines.push("ENABLE_VERTEX_LIGHTING")):(ee.defines.push("ENABLE_DAYNIGHT_SHADING"),te.defines.push("ENABLE_DAYNIGHT_SHADING"))),C&&(te.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING"),x&&te.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN")),S&&(ee.defines.push("GROUND_ATMOSPHERE"),te.defines.push("GROUND_ATMOSPHERE"),A&&te.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE")),ee.defines.push("INCLUDE_WEB_MERCATOR_Y"),te.defines.push("INCLUDE_WEB_MERCATOR_Y"),b&&(ee.defines.push("FOG"),te.defines.push("FOG")),y&&te.defines.push("APPLY_SPLIT"),w&&te.defines.push("ENABLE_CLIPPING_PLANES"),R&&te.defines.push("COLOR_CORRECT"),P&&te.defines.push("HIGHLIGHT_FILL_TILE"),M&&ee.defines.push("GEODETIC_SURFACE_NORMALS"),I&&ee.defines.push("EXAGGERATION");var re="    vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates, float nightBlend)\n    {\n        vec4 color = initialColor;\n";L&&(re+="        vec4 cutoutAndColorResult;\n        bool texelUnclipped;\n");for(var ie=0;ie<a;++ie)re+=L?"        cutoutAndColorResult = u_dayTextureCutoutRectangles["+ie+"];\n        texelUnclipped = v_textureCoordinates.x < cutoutAndColorResult.x || cutoutAndColorResult.z < v_textureCoordinates.x || v_textureCoordinates.y < cutoutAndColorResult.y || cutoutAndColorResult.w < v_textureCoordinates.y;\n        cutoutAndColorResult = sampleAndBlend(\n":"        color = sampleAndBlend(\n",re+="            color,\n            u_dayTextures["+ie+"],\n            u_dayTextureUseWebMercatorT["+ie+"] ? textureCoordinates.xz : textureCoordinates.xy,\n            u_dayTextureTexCoordsRectangle["+ie+"],\n            u_dayTextureTranslationAndScale["+ie+"],\n            "+(f?"u_dayTextureAlpha["+ie+"]":"1.0")+",\n            "+(_?"u_dayTextureNightAlpha["+ie+"]":"1.0")+",\n"+(_?"u_dayTextureDayAlpha["+ie+"]":"1.0")+",\n"+(d?"u_dayTextureBrightness["+ie+"]":"0.0")+",\n            "+(l?"u_dayTextureContrast["+ie+"]":"0.0")+",\n            "+(m?"u_dayTextureHue["+ie+"]":"0.0")+",\n            "+(p?"u_dayTextureSaturation["+ie+"]":"0.0")+",\n            "+(g?"u_dayTextureOneOverGamma["+ie+"]":"0.0")+",\n            "+(y?"u_dayTextureSplit["+ie+"]":"0.0")+",\n            "+(O?"u_colorsToAlpha["+ie+"]":"vec4(0.0)")+",\n        nightBlend        );\n",L&&(re+="        color = czm_branchFreeTernary(texelUnclipped, cutoutAndColorResult, color);\n");re+="        return color;\n    }",te.sources.push(re),ee.sources.push(c(j)),ee.sources.push(h(E));var ae=o.Z.fromCache({context:t.context,vertexShaderSource:ee,fragmentShaderSource:te,attributeLocations:V.getAttributeLocations()});J=$[Q]=new u(a,Q,this.material,ae,X)}return r.surfaceShader=J,J.shaderProgram},l.prototype.destroy=function(){var e,t,r=this._shadersByTexturesFlags;for(var n in r)if(r.hasOwnProperty(n)){var o=r[n];if(!(0,i.Z)(o))continue;for(e in o)o.hasOwnProperty(e)&&(t=o[e],(0,i.Z)(t)&&t.shaderProgram.destroy())}return(0,a.Z)(this)},t["Z"]=l},14648:function(e,t,r){var i=r(48243),a=r(60216),n=r(63367),o=r(51688),s=r(82982),d=r(22832),u=r(67627),l=r(38443),c=r(68457),h=r(22426),m=r(6224),p=r(82968),g=r(41782),f=r(9121),_=r(99095),y=r(58597),v=r(21572),Z=r(87721),T=r(8743),C=r(42246),x=r(80188),S=r(88453),A=r(18192),D=r(13222),E=r(73919),b=r(85828),w=r(89917),F=r(46547);function N(){this.imagery=[],this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new n.Z(0,0,1,1),this.terrainData=void 0,this.vertexArray=void 0,this.tileBoundingRegion=void 0,this.occludeePointInScaledSpace=new a.Z,this.boundingVolumeSourceTile=void 0,this.boundingVolumeIsFromMesh=!1,this.terrainState=F.Z.UNLOADED,this.mesh=void 0,this.fill=void 0,this.pickBoundingSphere=new i.Z,this.surfaceShader=void 0,this.isClipped=!0,this.clippedByBoundaries=!1}Object.defineProperties(N.prototype,{eligibleForUnloading:{get:function(){for(var e=this.terrainState,t=e===F.Z.RECEIVING||e===F.Z.TRANSFORMING,r=!t,i=this.imagery,a=0,n=i.length;r&&a<n;++a){var o=i[a];r=!(0,s.Z)(o.loadingImagery)||o.loadingImagery.state!==E.Z.TRANSITIONING}return r}},renderedMesh:{get:function(){return(0,s.Z)(this.vertexArray)?this.mesh:(0,s.Z)(this.fill)?this.fill.mesh:void 0}}});var L=new o.Z;function R(e,t,r,i,n,o){var d=e.getExaggeratedPosition(i,n,o);if((0,s.Z)(t)&&t!==w.Z.SCENE3D){var u=r.ellipsoid,l=u.cartesianToCartographic(d,L);d=r.project(l,o),d=a.Z.fromElements(d.z,d.x,d.y,o)}return d}var P=new a.Z,O=new a.Z,M=new a.Z;function I(e,t,r,i){var a=e.renderedMesh,n=a.vertices,o=a.encoding,s=n.length/o.stride,d=g.Z.clone(o);d.hasGeodeticSurfaceNormals=t,d=g.Z.clone(d);var u=d.stride,l=new Float32Array(s*u);t?o.addGeodeticSurfaceNormals(n,l,r):o.removeGeodeticSurfaceNormals(n,l),a.vertices=l,a.stride=u;var c=a!==e.mesh;c?(N._freeVertexArray(e.fill.vertexArray),e.fill.vertexArray=N._createVertexArrayForMesh(i.context,a)):(N._freeVertexArray(e.vertexArray),e.vertexArray=N._createVertexArrayForMesh(i.context,a)),N._freeVertexArray(e.wireframeVertexArray),e.wireframeVertexArray=void 0}function B(e,t,r){var i=t.getTileDataAvailable(e.x,e.y,e.level);if(!(0,s.Z)(i)&&(0,s.Z)(e.parent)){var a=e.parent,n=a.data;(0,s.Z)(n)&&(0,s.Z)(n.terrainData)&&(i=n.terrainData.isChildAvailable(a.x,a.y,e.x,e.y))}!1===i&&(e.data.terrainState=F.Z.FAILED);for(var o=0,d=r.length;o<d;++o){var u=r.get(o);u.show&&u._createTileImagerySkeletons(e,t)}}function H(e,t,r,i,a,n){var o=e.data,d=e.parent;if(o.terrainState===F.Z.FAILED&&void 0!==d){var u=void 0!==d.data&&void 0!==d.data.terrainData&&!1!==d.data.terrainData.canUpsample;u||N.processStateMachine(d,t,r,i,a,n,!0)}if(o.terrainState===F.Z.FAILED&&k(o,e,t,r,e.x,e.y,e.level),o.terrainState===F.Z.UNLOADED&&U(o,r,e.x,e.y,e.level),o.terrainState===F.Z.RECEIVED&&V(o,t,r,e.x,e.y,e.level),o.terrainState===F.Z.TRANSFORMED&&(z(o,t.context,r,e.x,e.y,e.level,n),o.updateExaggeration(e,t,a)),o.terrainState>=F.Z.RECEIVED&&void 0===o.waterMaskTexture&&r.hasWaterMask){var l=o.terrainData;if(void 0!==l.waterMask)W(t.context,o);else{var c=o._findAncestorTileWithTerrainData(e);(0,s.Z)(c)&&(0,s.Z)(c.data.waterMaskTexture)&&(o.waterMaskTexture=c.data.waterMaskTexture,++o.waterMaskTexture.referenceCount,o._computeWaterMaskTranslationAndScale(e,c,o.waterMaskTranslationAndScale))}}}function k(e,t,r,i,a,n,o){var d=t.parent;if(d){var u=d.data.terrainData,l=d.x,c=d.y,h=d.level;if((0,s.Z)(u)){var m=u.upsample(i.tilingScheme,l,c,h,a,n,o);(0,s.Z)(m)&&(e.terrainState=F.Z.RECEIVING,(0,D.Z)(m,(function(t){e.terrainData=t,e.terrainState=F.Z.RECEIVED}),(function(){e.terrainState=F.Z.FAILED})))}}else t.state=b.Z.FAILED}function U(e,t,r,i,a){function n(t){e.terrainData=t,e.terrainState=F.Z.RECEIVED,e.request=void 0}function o(n){if(e.request.state===m.Z.CANCELLED)return e.terrainData=void 0,e.terrainState=F.Z.UNLOADED,void(e.request=void 0);e.terrainState=F.Z.FAILED,e.request=void 0;var o="Failed to obtain terrain tile X: "+r+" Y: "+i+" Level: "+a+'. Error message: "'+n+'"';t._requestError=f.Z.handleError(t._requestError,t,t.errorEvent,o,r,i,a,d)}function d(){var d=new h.Z({throttle:!1,throttleByServer:!0,type:p.Z.TERRAIN});e.request=d;var u=t.requestTileGeometry(r,i,a,d);(0,s.Z)(u)?(e.terrainState=F.Z.RECEIVING,(0,D.Z)(u,n,o)):(e.terrainState=F.Z.UNLOADED,e.request=void 0)}d()}N.prototype.pick=function(e,t,r,i,a){var n=this.renderedMesh;if((0,s.Z)(n)){for(var o=n.vertices,d=n.indices,l=n.encoding,h=d.length,m=Number.MAX_VALUE,p=0;p<h;p+=3){var g=d[p],f=d[p+1],_=d[p+2],y=R(l,t,r,o,g,P),v=R(l,t,r,o,f,O),Z=R(l,t,r,o,_,M),T=u.Z.rayTriangleParametric(e,y,v,Z,i);(0,s.Z)(T)&&T<m&&T>=0&&(m=T)}return m!==Number.MAX_VALUE?c.Z.getPoint(e,m,a):void 0}},N.prototype.freeResources=function(){(0,s.Z)(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0),this.terrainData=void 0,this.terrainState=F.Z.UNLOADED,this.mesh=void 0,this.fill=this.fill&&this.fill.destroy();for(var e=this.imagery,t=0,r=e.length;t<r;++t)e[t].freeResources();this.imagery.length=0,this.freeVertexArray()},N.prototype.freeVertexArray=function(){N._freeVertexArray(this.vertexArray),this.vertexArray=void 0,N._freeVertexArray(this.wireframeVertexArray),this.wireframeVertexArray=void 0},N.initialize=function(e,t,r){var i=e.data;(0,s.Z)(i)||(i=e.data=new N),e.state===b.Z.START&&(B(e,t,r),e.state=b.Z.LOADING)},N.processStateMachine=function(e,t,r,i,a,n,o){N.initialize(e,r,i);var d=e.data;if(e.state===b.Z.LOADING&&H(e,t,r,i,a,n),!o){var u=e.renderable;e.renderable=(0,s.Z)(d.vertexArray);var l=d.terrainState===F.Z.READY;e.upsampledFromParent=(0,s.Z)(d.terrainData)&&d.terrainData.wasCreatedByUpsampling();var c=d.processImagery(e,r,t);if(l&&c){var h=e._loadedCallbacks,m={};for(var p in h)h.hasOwnProperty(p)&&(h[p](e)||(m[p]=h[p]));e._loadedCallbacks=m,e.state=b.Z.DONE}u&&(e.renderable=!0)}},N.prototype.processImagery=function(e,t,r,i){var a,n,o=e.data,d=e.upsampledFromParent,u=!1,l=!0,c=o.imagery;for(a=0,n=c.length;a<n;++a){var h=c[a];if((0,s.Z)(h.loadingImagery)){if(h.loadingImagery.state===E.Z.PLACEHOLDER){var m=h.loadingImagery.imageryLayer;if(m.imageryProvider.ready){h.freeResources(),c.splice(a,1),m._createTileImagerySkeletons(e,t,a),--a,n=c.length;continue}d=!1}var p=h.processStateMachine(e,r,i);l=l&&p,u=u||p||(0,s.Z)(h.readyImagery),d=d&&(0,s.Z)(h.loadingImagery)&&(h.loadingImagery.state===E.Z.FAILED||h.loadingImagery.state===E.Z.INVALID)}else d=!1}return e.upsampledFromParent=d,e.renderable=e.renderable&&(u||l),l},N.prototype.addGeodeticSurfaceNormals=function(e,t){I(this,!0,e,t)},N.prototype.removeGeodeticSurfaceNormals=function(e){I(this,!1,void 0,e)},N.prototype.updateExaggeration=function(e,t,r){var i=this,a=i.renderedMesh;if(void 0!==a){var n=t.terrainExaggeration,o=t.terrainExaggerationRelativeHeight,s=1!==n,d=a.encoding,u=d.exaggeration!==n,l=d.exaggerationRelativeHeight!==o;if(u||l){if(u)if(s&&!d.hasGeodeticSurfaceNormals){var c=e.tilingScheme.ellipsoid;i.addGeodeticSurfaceNormals(c,t)}else!s&&d.hasGeodeticSurfaceNormals&&i.removeGeodeticSurfaceNormals(t);if(d.exaggeration=n,d.exaggerationRelativeHeight=o,void 0!==r){r._tileToUpdateHeights.push(e);for(var h=e.customData,m=h.length,p=0;p<m;p++){var g=h[p];g.level=-1}}}}};var G={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,exaggerationRelativeHeight:0,throttle:!0};function V(e,t,r,i,a,n){var o=r.tilingScheme,d=G;d.tilingScheme=o,d.x=i,d.y=a,d.level=n,d.exaggeration=t.terrainExaggeration,d.exaggerationRelativeHeight=t.terrainExaggerationRelativeHeight,d.throttle=!0;var u=e.terrainData,l=u.createMesh(d);(0,s.Z)(l)&&(e.terrainState=F.Z.TRANSFORMING,(0,D.Z)(l,(function(t){e.mesh=t,e.terrainState=F.Z.TRANSFORMED}),(function(){e.terrainState=F.Z.FAILED})))}function z(e,t,r,i,a,n,o){e.vertexArray=N._createVertexArrayForMesh(t,e.mesh),e.terrainState=F.Z.READY,e.fill=e.fill&&e.fill.destroy(o)}function q(e){var t=e.cache.tile_waterMaskData;if(!(0,s.Z)(t)){var r=T.Z.create({context:e,pixelFormat:l.Z.LUMINANCE,pixelDatatype:v.Z.UNSIGNED_BYTE,source:{arrayBufferView:new Uint8Array([255]),width:1,height:1}});r.referenceCount=1;var i=new Z.Z({wrapS:S.Z.CLAMP_TO_EDGE,wrapT:S.Z.CLAMP_TO_EDGE,minificationFilter:x.Z.LINEAR,magnificationFilter:C.Z.LINEAR});t={allWaterTexture:r,sampler:i,destroy:function(){this.allWaterTexture.destroy()}},e.cache.tile_waterMaskData=t}return t}function W(e,t){var r,i=t.terrainData.waterMask,a=q(e),o=i.length;if(1===o){if(0===i[0])return;r=a.allWaterTexture}else{var s=Math.sqrt(o);r=T.Z.create({context:e,pixelFormat:l.Z.LUMINANCE,pixelDatatype:v.Z.UNSIGNED_BYTE,source:{width:s,height:s,arrayBufferView:i},sampler:a.sampler,flipY:!1}),r.referenceCount=0}++r.referenceCount,t.waterMaskTexture=r,n.Z.fromElements(0,0,1,1,t.waterMaskTranslationAndScale)}N._createVertexArrayForMesh=function(e,t){var r=t.vertices,i=_.Z.createVertexBuffer({context:e,typedArray:r,usage:y.Z.STATIC_DRAW}),a=t.encoding.getAttributes(i),n=t.indices.indexBuffers||{},o=n[e.id];if(!(0,s.Z)(o)||o.isDestroyed()){var u=t.indices;o=_.Z.createIndexBuffer({context:e,typedArray:u,usage:y.Z.STATIC_DRAW,indexDatatype:d.Z.fromSizeInBytes(u.BYTES_PER_ELEMENT)}),o.vertexArrayDestroyable=!1,o.referenceCount=1,n[e.id]=o,t.indices.indexBuffers=n}else++o.referenceCount;return new A.Z({context:e,attributes:a,indexBuffer:o})},N._freeVertexArray=function(e){if((0,s.Z)(e)){var t=e.indexBuffer;e.isDestroyed()||e.destroy(),(0,s.Z)(t)&&!t.isDestroyed()&&(0,s.Z)(t.referenceCount)&&(--t.referenceCount,0===t.referenceCount&&t.destroy())}},N.prototype._findAncestorTileWithTerrainData=function(e){var t=e.parent;while((0,s.Z)(t)&&(!(0,s.Z)(t.data)||!(0,s.Z)(t.data.terrainData)||t.data.terrainData.wasCreatedByUpsampling()))t=t.parent;return t},N.prototype._computeWaterMaskTranslationAndScale=function(e,t,r){var i=t.rectangle,a=e.rectangle,n=a.width,o=a.height,s=n/i.width,d=o/i.height;return r.x=s*(a.west-i.west)/n,r.y=d*(a.south-i.south)/o,r.z=s,r.w=d,r},t["Z"]=N},32110:function(e,t,r){var i=r(48243),a=r(27495),n=r(60838),o=r(60216),s=r(63367),d=r(51688),u=r(83856),l=r(59947),c=r(92062),h=r(8182),m=r(62200),p=r(82982),g=r(86511),f=r(12572),_=r(14459),y=r(26865),v=r(57552),Z=r(22832),T=r(84935),C=r(99417),x=r(72248),S=r(15720),A=r(25405),D=r(91473),E=r(97264),b=r(96190),w=r(38779),F=r(78257),N=r(735),L=r(54933),R=r(79962),P=r(99095),O=r(58597),M=r(20521),I=r(60072),B=r(8379),H=r(10667),k=r(18192),U=r(13633),G=r(21809),V=r(7976),z=r(14648),q=r(59379),W=r(73919),Y=r(64060),K=r(34380),j=r(85828),Q=r(89917),X=r(34125),J=r(11590),$=r(46547),ee=r(17106),te=r(37728);function re(e){if(!(0,p.Z)(e))throw new f.Z("options is required.");if(!(0,p.Z)(e.terrainProvider))throw new f.Z("options.terrainProvider is required.");if(!(0,p.Z)(e.imageryLayers))throw new f.Z("options.imageryLayers is required.");if(!(0,p.Z)(e.surfaceShaderSet))throw new f.Z("options.surfaceShaderSet is required.");this.lightingFadeOutDistance=65e5,this.lightingFadeInDistance=9e6,this.hasWaterMask=!1,this.oceanNormalMap=void 0,this.zoomedOutOceanSpecularIntensity=.5,this.enableLighting=!1,this.dynamicAtmosphereLighting=!1,this.dynamicAtmosphereLightingFromSun=!1,this.showGroundAtmosphere=!1,this.shadows=X.Z.RECEIVE_ONLY,this.fillHighlightColor=void 0,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this.showSkirts=!0,this.backFaceCulling=!0,this.undergroundColor=void 0,this.undergroundColorAlphaByDistance=void 0,this.materialUniformMap=void 0,this._materialUniformMap=void 0,this._quadtree=void 0,this._terrainProvider=e.terrainProvider,this._imageryLayers=e.imageryLayers,this._surfaceShaderSet=e.surfaceShaderSet,this._renderState=void 0,this._blendRenderState=void 0,this._disableCullingRenderState=void 0,this._disableCullingBlendRenderState=void 0,this._errorEvent=new _.Z,this._imageryLayers.layerAdded.addEventListener(re.prototype._onLayerAdded,this),this._imageryLayers.layerRemoved.addEventListener(re.prototype._onLayerRemoved,this),this._imageryLayers.layerMoved.addEventListener(re.prototype._onLayerMoved,this),this._imageryLayers.layerShownOrHidden.addEventListener(re.prototype._onLayerShownOrHidden,this),this._imageryLayersUpdatedEvent=new _.Z,this._layerOrderChanged=!1,this._tilesToRenderByTextureCount=[],this._drawCommands=[],this._uniformMaps=[],this._usedDrawCommands=0,this._vertexArraysToDestroy=[],this._debug={wireframe:!1,boundingSphereTile:void 0},this._baseColor=void 0,this._firstPassInitialColor=void 0,this.baseColor=new l.Z(0,0,.5,1),this._clippingPlanes=void 0,this.cartographicLimitRectangle=b.Z.clone(b.Z.MAX_VALUE),this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1,this._oldTerrainExaggeration=void 0,this._oldTerrainExaggerationRelativeHeight=void 0}function ie(e,t){var r=e.loadingImagery;(0,p.Z)(r)||(r=e.readyImagery);var i=t.loadingImagery;return(0,p.Z)(i)||(i=t.readyImagery),r.imageryLayer._layerIndex-i.imageryLayer._layerIndex}function ae(e,t){var r=t.creditDisplay;e._terrainProvider.ready&&(0,p.Z)(e._terrainProvider.credit)&&r.addCredit(e._terrainProvider.credit);for(var i=e._imageryLayers,a=0,n=i.length;a<n;++a){var o=i.get(a).imageryProvider;o.ready&&(0,p.Z)(o.credit)&&r.addCredit(o.credit)}}function ne(e,t){var r=t.globeTranslucencyState;if(r.translucent){var i=e.renderState.blending.enabled;r.pushDerivedCommands(e,i,t)}else t.commandList.push(e)}Object.defineProperties(re.prototype,{baseColor:{get:function(){return this._baseColor},set:function(e){if(!(0,p.Z)(e))throw new f.Z("value is required.");this._baseColor=e,this._firstPassInitialColor=s.Z.fromColor(e,this._firstPassInitialColor)}},quadtree:{get:function(){return this._quadtree},set:function(e){if(!(0,p.Z)(e))throw new f.Z("value is required.");this._quadtree=e}},ready:{get:function(){return this._terrainProvider.ready&&(0===this._imageryLayers.length||this._imageryLayers.get(0).imageryProvider.ready)}},tilingScheme:{get:function(){return this._terrainProvider.tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},imageryLayersUpdatedEvent:{get:function(){return this._imageryLayersUpdatedEvent}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){if(this._terrainProvider!==e){if(!(0,p.Z)(e))throw new f.Z("terrainProvider is required.");this._terrainProvider=e,(0,p.Z)(this._quadtree)&&this._quadtree.invalidateAllTiles()}}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){G.Z.setOwner(e,this,"_clippingPlanes")}}}),re.prototype.update=function(e){this._imageryLayers._update()},re.prototype.initialize=function(e){this._imageryLayers.queueReprojectionCommands(e),this._layerOrderChanged&&(this._layerOrderChanged=!1,this._quadtree.forEachLoadedTile((function(e){e.data.imagery.sort(ie)}))),ae(this,e);for(var t=this._vertexArraysToDestroy,r=t.length,i=0;i<r;++i)z.Z._freeVertexArray(t[i]);t.length=0},re.prototype.beginUpdate=function(e){for(var t=this._tilesToRenderByTextureCount,r=0,i=t.length;r<i;++r){var a=t[r];(0,p.Z)(a)&&(a.length=0)}var n=this._clippingPlanes;(0,p.Z)(n)&&n.enabled&&n.update(e),this._usedDrawCommands=0,this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1},re.prototype.endUpdate=function(e){if(!(0,p.Z)(this._renderState)){this._renderState=H.Z.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:V.Z.LESS}}),this._blendRenderState=H.Z.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:V.Z.LESS_OR_EQUAL},blending:U.Z.ALPHA_BLEND});var t=(0,u.Z)(this._renderState,!0);t.cull.enabled=!1,this._disableCullingRenderState=H.Z.fromCache(t),t=(0,u.Z)(this._blendRenderState,!0),t.cull.enabled=!1,this._disableCullingBlendRenderState=H.Z.fromCache(t)}this._hasFillTilesThisFrame&&this._hasLoadedTilesThisFrame&&J.Z.updateFillTiles(this,this._quadtree._tilesToRender,e,this._vertexArraysToDestroy);var r=this.quadtree,i=e.terrainExaggeration,a=e.terrainExaggerationRelativeHeight,n=this._oldTerrainExaggeration!==i||this._oldTerrainExaggerationRelativeHeight!==a;this._oldTerrainExaggeration=i,this._oldTerrainExaggerationRelativeHeight=a,n&&r.forEachLoadedTile((function(t){var i=t.data;i.updateExaggeration(t,e,r)}));for(var o=this._tilesToRenderByTextureCount,s=0,d=o.length;s<d;++s){var l=o[s];if((0,p.Z)(l))for(var c=0,h=l.length;c<h;++c){var m=l[c],g=m.data.tileBoundingRegion;ke(this,m,e),e.minimumTerrainHeight=Math.min(e.minimumTerrainHeight,g.minimumHeight)}}},re.prototype.updateForPick=function(e){for(var t=this._drawCommands,r=0,i=this._usedDrawCommands;r<i;++r)ne(t[r],e)},re.prototype.cancelReprojections=function(){this._imageryLayers.cancelReprojections()},re.prototype.getLevelMaximumGeometricError=function(e){return this._terrainProvider.getLevelMaximumGeometricError(e)},re.prototype.loadTile=function(e,t){var r,i=t.data,a=!0;(0,p.Z)(i)&&(a=i.boundingVolumeSourceTile!==t||t._lastSelectionResult===te.Z.CULLED_BUT_NEEDED,r=i.terrainState),z.Z.processStateMachine(t,e,this.terrainProvider,this._imageryLayers,this.quadtree,this._vertexArraysToDestroy,a),i=t.data,a&&r!==t.data.terrainState&&this.computeTileVisibility(t,e,this.quadtree.occluders)!==L.Z.NONE&&i.boundingVolumeSourceTile===t&&(a=!1,z.Z.processStateMachine(t,e,this.terrainProvider,this._imageryLayers,this.quadtree,this._vertexArraysToDestroy,a))};var oe=new i.Z,se=new b.Z,de=new b.Z,ue=new d.Z;function le(e,t){if(t.west<t.east)return t;var r=b.Z.clone(t,de),i=b.Z.center(e,ue);return i.longitude>0?r.east=C.Z.PI:r.west=-C.Z.PI,r}function ce(e,t){if(t.cameraUnderground)return!0;if(t.globeTranslucencyState.translucent)return!0;if(e.backFaceCulling)return!1;var r=e._clippingPlanes;return!(!(0,p.Z)(r)||!r.enabled)||!b.Z.equals(e.cartographicLimitRectangle,b.Z.MAX_VALUE)}re.prototype.computeTileVisibility=function(e,t,r){var a=this.computeDistanceToTile(e,t);e._distance=a;var n=ce(this,t);if(t.fog.enabled&&!n&&C.Z.fog(a,t.fog.density)>=1)return L.Z.NONE;var s=e.data,d=s.tileBoundingRegion;if(void 0===s.boundingVolumeSourceTile)return L.Z.PARTIAL;var u=t.cullingVolume,l=d.boundingVolume;(0,p.Z)(l)||(l=d.boundingSphere),s.clippedByBoundaries=!1;var c=le(e.rectangle,this.cartographicLimitRectangle),h=b.Z.simpleIntersection(c,e.rectangle,se);if(!(0,p.Z)(h))return L.Z.NONE;if(b.Z.equals(h,e.rectangle)||(s.clippedByBoundaries=!0),t.mode!==Q.Z.SCENE3D&&(l=oe,i.Z.fromRectangleWithHeights2D(e.rectangle,t.mapProjection,d.minimumHeight,d.maximumHeight,l),o.Z.fromElements(l.center.z,l.center.x,l.center.y,l.center),t.mode===Q.Z.MORPHING&&(0,p.Z)(s.renderedMesh)&&(l=i.Z.union(d.boundingSphere,l,l))),!(0,p.Z)(l))return L.Z.PARTIAL;var m,g=this._clippingPlanes;if((0,p.Z)(g)&&g.enabled){var f=g.computeIntersectionWithBoundingVolume(l);if(e.isClipped=f!==T.Z.INSIDE,f===T.Z.OUTSIDE)return L.Z.NONE}var _=u.computeVisibility(l);if(_===T.Z.OUTSIDE?m=L.Z.NONE:_===T.Z.INTERSECTING?m=L.Z.PARTIAL:_===T.Z.INSIDE&&(m=L.Z.FULL),m===L.Z.NONE)return m;var y=t.mode===Q.Z.SCENE3D&&t.camera.frustum instanceof D.Z;if(t.mode===Q.Z.SCENE3D&&!y&&(0,p.Z)(r)&&!n){var v=s.occludeePointInScaledSpace;return(0,p.Z)(v)?r.ellipsoid.isScaledSpacePointVisiblePossiblyUnderEllipsoid(v,d.minimumHeight)?m:L.Z.NONE:m}return m},re.prototype.canRefine=function(e){if((0,p.Z)(e.data.terrainData))return!0;var t=this.terrainProvider.getTileDataAvailable(2*e.x,2*e.y,e.level+1);return void 0!==t};var he=[],me=[];re.prototype.canRenderWithoutLosingDetail=function(e,t){var r=e.data,i=he;i.length=this._imageryLayers.length;var a,n,o,s=!1,d=!1;for((0,p.Z)(r)&&(s=r.terrainState===$.Z.READY,d=!0,a=r.imagery),n=0,o=i.length;n<o;++n)i[n]=d;if((0,p.Z)(a))for(n=0,o=a.length;n<o;++n){var u=a[n],l=u.loadingImagery,c=!(0,p.Z)(l)||l.state===W.Z.FAILED||l.state===W.Z.INVALID,h=(u.loadingImagery||u.readyImagery).imageryLayer._layerIndex;i[h]=c&&i[h]}var m=this.quadtree._lastSelectionFrameNumber,g=me;g.length=0,g.push(e.southwestChild,e.southeastChild,e.northwestChild,e.northeastChild);while(g.length>0){var f=g.pop(),_=f._lastSelectionResultFrame===m?f._lastSelectionResult:te.Z.NONE;if(_===te.Z.RENDERED){var y=f.data;if(!(0,p.Z)(y))continue;if(!s&&f.data.terrainState===$.Z.READY)return!1;var v=f.data.imagery;for(n=0,o=v.length;n<o;++n){var Z=v[n],T=Z.loadingImagery,C=!(0,p.Z)(T)||T.state===W.Z.FAILED||T.state===W.Z.INVALID,x=(Z.loadingImagery||Z.readyImagery).imageryLayer._layerIndex;if(C&&!i[x])return!1}}else _===te.Z.REFINED&&g.push(f.southwestChild,f.southeastChild,f.northwestChild,f.northeastChild)}return!0};var pe=new o.Z;re.prototype.computeTileLoadPriority=function(e,t){var r=e.data;if(void 0===r)return 0;var i=r.tileBoundingRegion.boundingVolume;if(void 0===i)return 0;var a=t.camera.positionWC,n=t.camera.directionWC,s=o.Z.subtract(i.center,a,pe),d=o.Z.magnitude(s);return d<C.Z.EPSILON5?0:(o.Z.divideByScalar(s,d,s),(1-o.Z.dot(s,n))*e._distance)};var ge=new x.Z,fe=new x.Z,_e=new s.Z,ye=new s.Z,ve=new s.Z,Ze=new o.Z,Te=new o.Z,Ce=new o.Z,xe=new o.Z;re.prototype.showTileThisFrame=function(e,t){for(var r=0,i=e.data.imagery,a=0,n=i.length;a<n;++a){var o=i[a];(0,p.Z)(o.readyImagery)&&0!==o.readyImagery.imageryLayer.alpha&&++r}var s=this._tilesToRenderByTextureCount[r];(0,p.Z)(s)||(s=[],this._tilesToRenderByTextureCount[r]=s),s.push(e);var d=e.data;(0,p.Z)(d.vertexArray)?this._hasLoadedTilesThisFrame=!0:this._hasFillTilesThisFrame=!0;var u=this._debug;++u.tilesRendered,u.texturesRendered+=r};var Se=[new o.Z,new o.Z,new o.Z,new o.Z];function Ae(e,t,r,i,a,n){var s=e.quadtree._occluders.ellipsoid,d=s.ellipsoid,u=Se;return o.Z.fromRadians(r.west,r.south,a,d,u[0]),o.Z.fromRadians(r.east,r.south,a,d,u[1]),o.Z.fromRadians(r.west,r.north,a,d,u[2]),o.Z.fromRadians(r.east,r.north,a,d,u[3]),s.computeHorizonCullingPointPossiblyUnderEllipsoid(t,u,i,n)}function De(e,t,r){var a=e.data;void 0===a&&(a=e.data=new z.Z);var n=e.tilingScheme.ellipsoid;void 0===a.tileBoundingRegion&&(a.tileBoundingRegion=new ee.Z({computeBoundingVolumes:!1,rectangle:e.rectangle,ellipsoid:n,minimumHeight:0,maximumHeight:0}));var s=a.tileBoundingRegion,d=s.minimumHeight,u=s.maximumHeight,l=!1,c=e,h=a.mesh,m=a.terrainData;if(void 0!==h&&void 0!==h.minimumHeight&&void 0!==h.maximumHeight)s.minimumHeight=h.minimumHeight,s.maximumHeight=h.maximumHeight,l=!0;else if(void 0!==m&&void 0!==m._minimumHeight&&void 0!==m._maximumHeight)s.minimumHeight=m._minimumHeight,s.maximumHeight=m._maximumHeight;else{s.minimumHeight=Number.NaN,s.maximumHeight=Number.NaN;var g=e.parent;while(void 0!==g){var f=g.data;if(void 0!==f){var _=f.mesh,y=f.terrainData;if(void 0!==_&&void 0!==_.minimumHeight&&void 0!==_.maximumHeight){s.minimumHeight=_.minimumHeight,s.maximumHeight=_.maximumHeight;break}if(void 0!==y&&void 0!==y._minimumHeight&&void 0!==y._maximumHeight){s.minimumHeight=y._minimumHeight,s.maximumHeight=y._maximumHeight;break}}g=g.parent}c=g}if(void 0!==c){var v=r.terrainExaggeration,Z=r.terrainExaggerationRelativeHeight,T=1!==v;if(T&&(l=!1,s.minimumHeight=F.Z.getHeight(s.minimumHeight,v,Z),s.maximumHeight=F.Z.getHeight(s.maximumHeight,v,Z)),l)a.boundingVolumeIsFromMesh||(s._orientedBoundingBox=A.Z.clone(h.orientedBoundingBox,s._orientedBoundingBox),s._boundingSphere=i.Z.clone(h.boundingSphere3D,s._boundingSphere),a.occludeePointInScaledSpace=o.Z.clone(h.occludeePointInScaledSpace,a.occludeePointInScaledSpace),(0,p.Z)(a.occludeePointInScaledSpace)||(a.occludeePointInScaledSpace=Ae(t,s._orientedBoundingBox.center,e.rectangle,s.minimumHeight,s.maximumHeight,a.occludeePointInScaledSpace)));else{var C=void 0===s._orientedBoundingBox||void 0===s._boundingSphere,x=s.minimumHeight!==d||s.maximumHeight!==u;(x||C)&&(s.computeBoundingVolumes(n),a.occludeePointInScaledSpace=Ae(t,s._orientedBoundingBox.center,e.rectangle,s.minimumHeight,s.maximumHeight,a.occludeePointInScaledSpace))}a.boundingVolumeSourceTile=c,a.boundingVolumeIsFromMesh=l}else a.boundingVolumeSourceTile=void 0,a.boundingVolumeIsFromMesh=!1}function Ee(e,t,r){return function(i){var a,n,o,s=-1,d=i.data.imagery,u=d.length;for(o=0;o<u;++o)if(a=d[o],n=(0,m.Z)(a.readyImagery,a.loadingImagery),n.imageryLayer===t){s=o;break}if(-1!==s){var l=s+e;if(a=d[l],n=(0,p.Z)(a)?(0,m.Z)(a.readyImagery,a.loadingImagery):void 0,!(0,p.Z)(n)||n.imageryLayer!==t)return!t._createTileImagerySkeletons(i,r,l);for(o=s;o<l;++o)d[o].freeResources();d.splice(s,e)}return!0}}re.prototype.computeDistanceToTile=function(e,t){De(e,this,t);var r=e.data,i=r.boundingVolumeSourceTile;if(void 0===i)return 9999999999;var a=r.tileBoundingRegion,n=a.minimumHeight,o=a.maximumHeight;if(r.boundingVolumeSourceTile!==e){var s=t.camera.positionCartographic.height,d=Math.abs(s-n),u=Math.abs(s-o);d>u?(a.minimumHeight=n,a.maximumHeight=n):(a.minimumHeight=o,a.maximumHeight=o)}var l=a.distanceToCamera(t);return a.minimumHeight=n,a.maximumHeight=o,l},re.prototype.isDestroyed=function(){return!1},re.prototype.destroy=function(){return this._tileProvider=this._tileProvider&&this._tileProvider.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),(0,g.Z)(this)},re.prototype._onLayerAdded=function(e,t){if(e.show){var r=this._terrainProvider,i=this,a=e.imageryProvider,n=this._imageryLayersUpdatedEvent;a._reload=function(){e._imageryCache={},i._quadtree.forEachLoadedTile((function(t){if(!(0,p.Z)(t._loadedCallbacks[e._layerIndex])){var i,a=t.data.imagery,n=a.length,o=-1,s=0;for(i=0;i<n;++i){var d=a[i],u=(0,m.Z)(d.readyImagery,d.loadingImagery);if(u.imageryLayer===e)-1===o&&(o=i),++s;else if(-1!==o)break}if(-1!==o){var l=o+s;e._createTileImagerySkeletons(t,r,l)&&(t._loadedCallbacks[e._layerIndex]=Ee(s,e,r),t.state=j.Z.LOADING)}}}))},this._quadtree.forEachLoadedTile((function(t){e._createTileImagerySkeletons(t,r)&&(t.state=j.Z.LOADING,0===t.level||t._lastSelectionResultFrame===i.quadtree._lastSelectionFrameNumber&&t._lastSelectionResult===te.Z.RENDERED||(t.renderable=!1))})),this._layerOrderChanged=!0,n.raiseEvent()}},re.prototype._onLayerRemoved=function(e,t){this._quadtree.forEachLoadedTile((function(t){for(var r=t.data.imagery,i=-1,a=0,n=0,o=r.length;n<o;++n){var s=r[n],d=s.loadingImagery;if((0,p.Z)(d)||(d=s.readyImagery),d.imageryLayer===e)-1===i&&(i=n),s.freeResources(),++a;else if(-1!==i)break}-1!==i&&r.splice(i,a)})),(0,p.Z)(e.imageryProvider)&&(e.imageryProvider._reload=void 0),this._imageryLayersUpdatedEvent.raiseEvent()},re.prototype._onLayerMoved=function(e,t,r){this._layerOrderChanged=!0,this._imageryLayersUpdatedEvent.raiseEvent()},re.prototype._onLayerShownOrHidden=function(e,t,r){r?this._onLayerAdded(e,t):this._onLayerRemoved(e,t)};var be,we,Fe,Ne=new x.Z,Le=new x.Z;function Re(e,t){var r={u_initialColor:function(){return this.properties.initialColor},u_fillHighlightColor:function(){return this.properties.fillHighlightColor},u_zoomedOutOceanSpecularIntensity:function(){return this.properties.zoomedOutOceanSpecularIntensity},u_oceanNormalMap:function(){return this.properties.oceanNormalMap},u_lightingFadeDistance:function(){return this.properties.lightingFadeDistance},u_nightFadeDistance:function(){return this.properties.nightFadeDistance},u_center3D:function(){return this.properties.center3D},u_terrainExaggerationAndRelativeHeight:function(){return this.properties.terrainExaggerationAndRelativeHeight},u_tileRectangle:function(){return this.properties.tileRectangle},u_modifiedModelView:function(){var t=e.context.uniformState.view,r=x.Z.multiplyByPoint(t,this.properties.rtc,Te);return x.Z.setTranslation(t,r,ge),ge},u_modifiedModelViewProjection:function(){var t=e.context.uniformState.view,r=e.context.uniformState.projection,i=x.Z.multiplyByPoint(t,this.properties.rtc,Te);return x.Z.setTranslation(t,i,fe),x.Z.multiply(r,fe,fe),fe},u_dayTextures:function(){return this.properties.dayTextures},u_dayTextureTranslationAndScale:function(){return this.properties.dayTextureTranslationAndScale},u_dayTextureTexCoordsRectangle:function(){return this.properties.dayTextureTexCoordsRectangle},u_dayTextureUseWebMercatorT:function(){return this.properties.dayTextureUseWebMercatorT},u_dayTextureAlpha:function(){return this.properties.dayTextureAlpha},u_dayTextureNightAlpha:function(){return this.properties.dayTextureNightAlpha},u_dayTextureDayAlpha:function(){return this.properties.dayTextureDayAlpha},u_dayTextureBrightness:function(){return this.properties.dayTextureBrightness},u_dayTextureContrast:function(){return this.properties.dayTextureContrast},u_dayTextureHue:function(){return this.properties.dayTextureHue},u_dayTextureSaturation:function(){return this.properties.dayTextureSaturation},u_dayTextureOneOverGamma:function(){return this.properties.dayTextureOneOverGamma},u_dayIntensity:function(){return this.properties.dayIntensity},u_southAndNorthLatitude:function(){return this.properties.southAndNorthLatitude},u_southMercatorYAndOneOverHeight:function(){return this.properties.southMercatorYAndOneOverHeight},u_waterMask:function(){return this.properties.waterMask},u_waterMaskTranslationAndScale:function(){return this.properties.waterMaskTranslationAndScale},u_minMaxHeight:function(){return this.properties.minMaxHeight},u_scaleAndBias:function(){return this.properties.scaleAndBias},u_dayTextureSplit:function(){return this.properties.dayTextureSplit},u_dayTextureCutoutRectangles:function(){return this.properties.dayTextureCutoutRectangles},u_clippingPlanes:function(){var r=t._clippingPlanes;return(0,p.Z)(r)&&(0,p.Z)(r.texture)?r.texture:e.context.defaultTexture},u_cartographicLimitRectangle:function(){return this.properties.localizedCartographicLimitRectangle},u_clippingPlanesMatrix:function(){var r=t._clippingPlanes,i=(0,p.Z)(r)?x.Z.multiply(e.context.uniformState.view,r.modelMatrix,Ne):x.Z.IDENTITY;return x.Z.inverseTranspose(i,Le)},u_clippingPlanesEdgeStyle:function(){var e=this.properties.clippingPlanesEdgeColor;return e.alpha=this.properties.clippingPlanesEdgeWidth,e},u_minimumBrightness:function(){return e.fog.minimumBrightness},u_hsbShift:function(){return this.properties.hsbShift},u_colorsToAlpha:function(){return this.properties.colorsToAlpha},u_frontFaceAlphaByDistance:function(){return this.properties.frontFaceAlphaByDistance},u_backFaceAlphaByDistance:function(){return this.properties.backFaceAlphaByDistance},u_translucencyRectangle:function(){return this.properties.localizedTranslucencyRectangle},u_undergroundColor:function(){return this.properties.undergroundColor},u_undergroundColorAlphaByDistance:function(){return this.properties.undergroundColorAlphaByDistance},properties:{initialColor:new s.Z(0,0,.5,1),fillHighlightColor:new l.Z(0,0,0,0),zoomedOutOceanSpecularIntensity:.5,oceanNormalMap:void 0,lightingFadeDistance:new n.Z(65e5,9e6),nightFadeDistance:new n.Z(1e7,4e7),hsbShift:new o.Z,center3D:void 0,rtc:new o.Z,modifiedModelView:new x.Z,tileRectangle:new s.Z,terrainExaggerationAndRelativeHeight:new n.Z(1,0),dayTextures:[],dayTextureTranslationAndScale:[],dayTextureTexCoordsRectangle:[],dayTextureUseWebMercatorT:[],dayTextureAlpha:[],dayTextureNightAlpha:[],dayTextureDayAlpha:[],dayTextureBrightness:[],dayTextureContrast:[],dayTextureHue:[],dayTextureSaturation:[],dayTextureOneOverGamma:[],dayTextureSplit:[],dayTextureCutoutRectangles:[],dayIntensity:0,colorsToAlpha:[],southAndNorthLatitude:new n.Z,southMercatorYAndOneOverHeight:new n.Z,waterMask:void 0,waterMaskTranslationAndScale:new s.Z,minMaxHeight:new n.Z,scaleAndBias:new x.Z,clippingPlanesEdgeColor:l.Z.clone(l.Z.WHITE),clippingPlanesEdgeWidth:0,localizedCartographicLimitRectangle:new s.Z,frontFaceAlphaByDistance:new s.Z,backFaceAlphaByDistance:new s.Z,localizedTranslucencyRectangle:new s.Z,undergroundColor:l.Z.clone(l.Z.TRANSPARENT),undergroundColorAlphaByDistance:new s.Z}};return(0,p.Z)(t.materialUniformMap)?(0,h.Z)(r,t.materialUniformMap):r}function Pe(e,t,r){var i,a,n=r.data;if((0,p.Z)(n.vertexArray)?(i=n.mesh,a=n.vertexArray):(0,p.Z)(n.fill)&&(0,p.Z)(n.fill.vertexArray)&&(i=n.fill.mesh,a=n.fill.vertexArray),(0,p.Z)(i)&&(0,p.Z)(a)){if((0,p.Z)(n.wireframeVertexArray)){if(n.wireframeVertexArray.mesh===i)return;n.wireframeVertexArray.destroy(),n.wireframeVertexArray=void 0}n.wireframeVertexArray=Oe(e,a,i),n.wireframeVertexArray.mesh=i}}function Oe(e,t,r){var i=r.indices,a={indices:i,primitiveType:E.Z.TRIANGLES};v.Z.toWireframe(a);var n=a.indices,o=P.Z.createIndexBuffer({context:e,typedArray:n,usage:O.Z.STATIC_DRAW,indexDatatype:Z.Z.fromSizeInBytes(n.BYTES_PER_ELEMENT)});return new k.Z({context:e,attributes:t._attributes,indexBuffer:o})}(function(){var e,t,r=new y.Z({geometry:a.Z.fromDimensions({dimensions:new o.Z(2,2,2)})}),i=new y.Z({geometry:new w.Z({radius:1})}),n=new x.Z;function s(e){return new K.Z({geometryInstances:e,appearance:new Y.Z({translucent:!1,flat:!0}),asynchronous:!1})}be=function(i,a){return i===e||(Fe(),e=i,n=x.Z.fromRotationTranslation(i.halfAxes,i.center,n),r.modelMatrix=n,r.attributes.color=c.Z.fromColor(a),t=s(r)),t},we=function(r,a){return r===e||(Fe(),e=r,n=x.Z.fromTranslation(r.center,n),n=x.Z.multiplyByUniformScale(n,r.radius,n),i.modelMatrix=n,i.attributes.color=c.Z.fromColor(a),t=s(i)),t},Fe=function(){(0,p.Z)(t)&&(t.destroy(),t=void 0,e=void 0)}})();var Me=new s.Z(0,0,0,0),Ie={frameState:void 0,surfaceTile:void 0,numberOfDayTextures:void 0,applyBrightness:void 0,applyContrast:void 0,applyHue:void 0,applySaturation:void 0,applyGamma:void 0,applyAlpha:void 0,applyDayNightAlpha:void 0,applySplit:void 0,showReflectiveOcean:void 0,showOceanWaves:void 0,enableLighting:void 0,dynamicAtmosphereLighting:void 0,dynamicAtmosphereLightingFromSun:void 0,showGroundAtmosphere:void 0,perFragmentGroundAtmosphere:void 0,hasVertexNormals:void 0,useWebMercatorProjection:void 0,enableFog:void 0,enableClippingPlanes:void 0,clippingPlanes:void 0,clippedByBoundaries:void 0,hasImageryLayerCutout:void 0,colorCorrect:void 0,colorToAlpha:void 0,hasGeodeticSurfaceNormals:void 0,hasExaggeration:void 0},Be=l.Z.TRANSPARENT,He=new S.Z;function ke(e,t,r){var a=t.data;(0,p.Z)(a.vertexArray)||(void 0===a.fill&&(a.fill=new J.Z(t)),a.fill.update(e,r));var n=r.creditDisplay,d=a.terrainData;if((0,p.Z)(d)&&(0,p.Z)(d.credits))for(var u=d.credits,c=0,h=u.length;c<h;++c)n.addCredit(u[c]);var g=M.Z.maximumTextureImageUnits,_=a.waterMaskTexture,y=a.waterMaskTranslationAndScale;!(0,p.Z)(_)&&(0,p.Z)(a.fill)&&(_=a.fill.waterMaskTexture,y=a.fill.waterMaskTranslationAndScale);var v=r.cameraUnderground,Z=r.globeTranslucencyState,T=Z.translucent,S=Z.frontFaceAlphaByDistance,D=Z.backFaceAlphaByDistance,w=Z.rectangle,F=(0,m.Z)(e.undergroundColor,Be),L=(0,m.Z)(e.undergroundColorAlphaByDistance,He),P=ce(e,r)&&r.mode===Q.Z.SCENE3D&&F.alpha>0&&(L.nearValue>0||L.farValue>0),O=e.hasWaterMask&&(0,p.Z)(_),H=e.oceanNormalMap,k=O&&(0,p.Z)(H),U=e.terrainProvider.ready&&e.terrainProvider.hasVertexNormals,G=r.fog.enabled&&!v,V=e.showGroundAtmosphere&&r.mode===Q.Z.SCENE3D,z=X.Z.castShadows(e.shadows)&&!T,W=X.Z.receiveShadows(e.shadows)&&!T,Y=e.hueShift,K=e.saturationShift,j=e.brightnessShift,$=!(C.Z.equalsEpsilon(Y,0,C.Z.EPSILON7)&&C.Z.equalsEpsilon(K,0,C.Z.EPSILON7)&&C.Z.equalsEpsilon(j,0,C.Z.EPSILON7)),ee=!1;if(V){var te=o.Z.magnitude(r.camera.positionWC),re=e.nightFadeOutDistance;ee=te>re}O&&--g,k&&--g,(0,p.Z)(r.shadowState)&&r.shadowState.shadowsEnabled&&--g,(0,p.Z)(e.clippingPlanes)&&e.clippingPlanes.enabled&&--g,g-=Z.numberOfTextureUniforms;var ie=a.renderedMesh,ae=ie.center,oe=ie.encoding,de=a.tileBoundingRegion,ue=r.terrainExaggeration,he=r.terrainExaggerationRelativeHeight,me=1!==ue,pe=oe.hasGeodeticSurfaceNormals,ge=_e,fe=0,Te=0,Se=0,Ae=0,De=!1;if(r.mode!==Q.Z.SCENE3D){var Ee=r.mapProjection,Ne=Ee.project(b.Z.southwest(t.rectangle),Ce),Le=Ee.project(b.Z.northeast(t.rectangle),xe);if(ge.x=Ne.x,ge.y=Ne.y,ge.z=Le.x,ge.w=Le.y,r.mode!==Q.Z.MORPHING&&(ae=Ze,ae.x=0,ae.y=.5*(ge.z+ge.x),ae.z=.5*(ge.w+ge.y),ge.x-=ae.y,ge.y-=ae.z,ge.z-=ae.y,ge.w-=ae.z),r.mode===Q.Z.SCENE2D&&oe.quantization===N.Z.BITS12){var Oe=1/(Math.pow(2,12)-1)*.5,ke=(ge.z-ge.x)*Oe,Ue=(ge.w-ge.y)*Oe;ge.x-=ke,ge.y-=Ue,ge.z+=ke,ge.w+=Ue}Ee instanceof R.Z&&(fe=t.rectangle.south,Te=t.rectangle.north,Se=R.Z.geodeticLatitudeToMercatorAngle(fe),Ae=1/(R.Z.geodeticLatitudeToMercatorAngle(Te)-Se),De=!0)}var Ge=Ie;Ge.frameState=r,Ge.surfaceTile=a,Ge.showReflectiveOcean=O,Ge.showOceanWaves=k,Ge.enableLighting=e.enableLighting,Ge.dynamicAtmosphereLighting=e.dynamicAtmosphereLighting,Ge.dynamicAtmosphereLightingFromSun=e.dynamicAtmosphereLightingFromSun,Ge.showGroundAtmosphere=V,Ge.perFragmentGroundAtmosphere=ee,Ge.hasVertexNormals=U,Ge.useWebMercatorProjection=De,Ge.clippedByBoundaries=a.clippedByBoundaries,Ge.hasGeodeticSurfaceNormals=pe,Ge.hasExaggeration=me;var Ve=a.imagery,ze=0,qe=Ve.length,We=e.showSkirts&&!v&&!T,Ye=e.backFaceCulling&&!v&&!T,Ke=Ye?e._renderState:e._disableCullingRenderState,je=Ye?e._blendRenderState:e._disableCullingBlendRenderState,Qe=Ke,Xe=e._firstPassInitialColor,Je=r.context;(0,p.Z)(e._debug.boundingSphereTile)||Fe();var $e=e._materialUniformMap!==e.materialUniformMap;if($e){e._materialUniformMap=e.materialUniformMap;for(var et=e._drawCommands.length,tt=0;tt<et;++tt)e._uniformMaps[tt]=Re(r,e)}do{var rt,it,at=0;if(e._drawCommands.length<=e._usedDrawCommands?(rt=new I.Z,rt.owner=t,rt.cull=!1,rt.boundingVolume=new i.Z,rt.orientedBoundingBox=void 0,it=Re(r,e),e._drawCommands.push(rt),e._uniformMaps.push(it)):(rt=e._drawCommands[e._usedDrawCommands],it=e._uniformMaps[e._usedDrawCommands]),rt.owner=t,++e._usedDrawCommands,t===e._debug.boundingSphereTile){var nt=de.boundingVolume,ot=de.boundingSphere;(0,p.Z)(nt)?be(nt,l.Z.RED).update(r):(0,p.Z)(ot)&&we(ot,l.Z.RED).update(r)}var st=it.properties;s.Z.clone(Xe,st.initialColor),st.oceanNormalMap=H,st.lightingFadeDistance.x=e.lightingFadeOutDistance,st.lightingFadeDistance.y=e.lightingFadeInDistance,st.nightFadeDistance.x=e.nightFadeOutDistance,st.nightFadeDistance.y=e.nightFadeInDistance,st.zoomedOutOceanSpecularIntensity=e.zoomedOutOceanSpecularIntensity;var dt=v?D:S,ut=v?S:D;(0,p.Z)(dt)&&(s.Z.fromElements(dt.near,dt.nearValue,dt.far,dt.farValue,st.frontFaceAlphaByDistance),s.Z.fromElements(ut.near,ut.nearValue,ut.far,ut.farValue,st.backFaceAlphaByDistance)),s.Z.fromElements(L.near,L.nearValue,L.far,L.farValue,st.undergroundColorAlphaByDistance),l.Z.clone(F,st.undergroundColor);var lt=!(0,p.Z)(a.vertexArray)&&(0,p.Z)(e.fillHighlightColor)&&e.fillHighlightColor.alpha>0;lt&&l.Z.clone(e.fillHighlightColor,st.fillHighlightColor),st.terrainExaggerationAndRelativeHeight.x=ue,st.terrainExaggerationAndRelativeHeight.y=he,st.center3D=ie.center,o.Z.clone(ae,st.rtc),s.Z.clone(ge,st.tileRectangle),st.southAndNorthLatitude.x=fe,st.southAndNorthLatitude.y=Te,st.southMercatorYAndOneOverHeight.x=Se,st.southMercatorYAndOneOverHeight.y=Ae;var ct=ye,ht=le(t.rectangle,e.cartographicLimitRectangle),mt=ve,pt=le(t.rectangle,w);o.Z.fromElements(Y,K,j,st.hsbShift);var gt=t.rectangle,ft=1/gt.width,_t=1/gt.height;ct.x=(ht.west-gt.west)*ft,ct.y=(ht.south-gt.south)*_t,ct.z=(ht.east-gt.west)*ft,ct.w=(ht.north-gt.south)*_t,s.Z.clone(ct,st.localizedCartographicLimitRectangle),mt.x=(pt.west-gt.west)*ft,mt.y=(pt.south-gt.south)*_t,mt.z=(pt.east-gt.west)*ft,mt.w=(pt.north-gt.south)*_t,s.Z.clone(mt,st.localizedTranslucencyRectangle);var yt=G&&C.Z.fog(t._distance,r.fog.density)>C.Z.EPSILON3;$=$&&(yt||V);var vt=!1,Zt=!1,Tt=!1,Ct=!1,xt=!1,St=!1,At=!1,Dt=!1,Et=!1,bt=!1;while(at<g&&ze<qe){var wt=Ve[ze],Ft=wt.readyImagery;if(++ze,(0,p.Z)(Ft)&&0!==Ft.imageryLayer.alpha){var Nt=wt.useWebMercatorT?Ft.textureWebMercator:Ft.texture;if(!(0,p.Z)(Nt))throw new f.Z("readyImagery is not actually ready!");var Lt=Ft.imageryLayer;(0,p.Z)(wt.textureTranslationAndScale)||(wt.textureTranslationAndScale=Lt._calculateTextureTranslationAndScale(t,wt)),st.dayTextures[at]=Nt,st.dayTextureTranslationAndScale[at]=wt.textureTranslationAndScale,st.dayTextureTexCoordsRectangle[at]=wt.textureCoordinateRectangle,st.dayTextureUseWebMercatorT[at]=wt.useWebMercatorT,st.dayTextureAlpha[at]=Lt.alpha,St=St||1!==st.dayTextureAlpha[at],st.dayTextureNightAlpha[at]=Lt.nightAlpha,At=At||1!==st.dayTextureNightAlpha[at],st.dayTextureDayAlpha[at]=Lt.dayAlpha,At=At||1!==st.dayTextureDayAlpha[at],st.dayTextureBrightness[at]=Lt.brightness,vt=vt||st.dayTextureBrightness[at]!==q.Z.DEFAULT_BRIGHTNESS,st.dayTextureContrast[at]=Lt.contrast,Zt=Zt||st.dayTextureContrast[at]!==q.Z.DEFAULT_CONTRAST,st.dayTextureHue[at]=Lt.hue,Tt=Tt||st.dayTextureHue[at]!==q.Z.DEFAULT_HUE,st.dayTextureSaturation[at]=Lt.saturation,Ct=Ct||st.dayTextureSaturation[at]!==q.Z.DEFAULT_SATURATION,st.dayTextureOneOverGamma[at]=1/Lt.gamma,xt=xt||st.dayTextureOneOverGamma[at]!==1/q.Z.DEFAULT_GAMMA,st.dayTextureSplit[at]=Lt.splitDirection,Dt=Dt||0!==st.dayTextureSplit[at];var Rt=st.dayTextureCutoutRectangles[at];if((0,p.Z)(Rt)||(Rt=st.dayTextureCutoutRectangles[at]=new s.Z),s.Z.clone(s.Z.ZERO,Rt),(0,p.Z)(Lt.cutoutRectangle)){var Pt=le(gt,Lt.cutoutRectangle),Ot=b.Z.simpleIntersection(Pt,gt,se);Et=(0,p.Z)(Ot)||Et,Rt.x=(Pt.west-gt.west)*ft,Rt.y=(Pt.south-gt.south)*_t,Rt.z=(Pt.east-gt.west)*ft,Rt.w=(Pt.north-gt.south)*_t}var Mt=st.colorsToAlpha[at];(0,p.Z)(Mt)||(Mt=st.colorsToAlpha[at]=new s.Z);var It=(0,p.Z)(Lt.colorToAlpha)&&Lt.colorToAlphaThreshold>0;if(bt=bt||It,It){var Bt=Lt.colorToAlpha;Mt.x=Bt.red,Mt.y=Bt.green,Mt.z=Bt.blue,Mt.w=Lt.colorToAlphaThreshold}else Mt.w=-1;if((0,p.Z)(Ft.credits))for(var Ht=Ft.credits,kt=0,Ut=Ht.length;kt<Ut;++kt)n.addCredit(Ht[kt]);++at}}st.dayTextures.length=at,st.waterMask=_,s.Z.clone(y,st.waterMaskTranslationAndScale),st.minMaxHeight.x=oe.minimumHeight,st.minMaxHeight.y=oe.maximumHeight,x.Z.clone(oe.matrix,st.scaleAndBias);var Gt=e._clippingPlanes,Vt=(0,p.Z)(Gt)&&Gt.enabled&&t.isClipped;Vt&&(st.clippingPlanesEdgeColor=l.Z.clone(Gt.edgeColor,st.clippingPlanesEdgeColor),st.clippingPlanesEdgeWidth=Gt.edgeWidth),Ge.numberOfDayTextures=at,Ge.applyBrightness=vt,Ge.applyContrast=Zt,Ge.applyHue=Tt,Ge.applySaturation=Ct,Ge.applyGamma=xt,Ge.applyAlpha=St,Ge.applyDayNightAlpha=At,Ge.applySplit=Dt,Ge.enableFog=yt,Ge.enableClippingPlanes=Vt,Ge.clippingPlanes=Gt,Ge.hasImageryLayerCutout=Et,Ge.colorCorrect=$,Ge.highlightFillTile=lt,Ge.colorToAlpha=bt,Ge.showUndergroundColor=P,Ge.translucent=T;var zt=a.renderedMesh.indices.length;We||(zt=a.renderedMesh.indexCountWithoutSkirts),rt.shaderProgram=e._surfaceShaderSet.getShaderProgram(Ge),rt.castShadows=z,rt.receiveShadows=W,rt.renderState=Qe,rt.primitiveType=E.Z.TRIANGLES,rt.vertexArray=a.vertexArray||a.fill.vertexArray,rt.count=zt,rt.uniformMap=it,rt.pass=B.Z.GLOBE,e._debug.wireframe&&(Pe(Je,e,t),(0,p.Z)(a.wireframeVertexArray)&&(rt.vertexArray=a.wireframeVertexArray,rt.primitiveType=E.Z.LINES,rt.count=2*zt));var qt=rt.boundingVolume,Wt=rt.orientedBoundingBox;r.mode!==Q.Z.SCENE3D?(i.Z.fromRectangleWithHeights2D(t.rectangle,r.mapProjection,de.minimumHeight,de.maximumHeight,qt),o.Z.fromElements(qt.center.z,qt.center.x,qt.center.y,qt.center),r.mode===Q.Z.MORPHING&&(qt=i.Z.union(de.boundingSphere,qt,qt))):(rt.boundingVolume=i.Z.clone(de.boundingSphere,qt),rt.orientedBoundingBox=A.Z.clone(de.boundingVolume,Wt)),rt.dirty=!0,T&&Z.updateDerivedCommands(rt,r),ne(rt,r),Qe=je,Xe=Me}while(ze<qe)}t["Z"]=re},90538:function(e,t,r){var i=r(66553),a=r(82982),n=r(12572),o=r(15720),s=r(96190);function d(){this._enabled=!1,this._frontFaceAlpha=1,this._frontFaceAlphaByDistance=void 0,this._backFaceAlpha=1,this._backFaceAlphaByDistance=void 0,this._rectangle=s.Z.clone(s.Z.MAX_VALUE)}Object.defineProperties(d.prototype,{enabled:{get:function(){return this._enabled},set:function(e){i.Z.typeOf.bool("enabled",e),this._enabled=e}},frontFaceAlpha:{get:function(){return this._frontFaceAlpha},set:function(e){i.Z.typeOf.number.greaterThanOrEquals("frontFaceAlpha",e,0),i.Z.typeOf.number.lessThanOrEquals("frontFaceAlpha",e,1),this._frontFaceAlpha=e}},frontFaceAlphaByDistance:{get:function(){return this._frontFaceAlphaByDistance},set:function(e){if((0,a.Z)(e)&&e.far<e.near)throw new n.Z("far distance must be greater than near distance.");this._frontFaceAlphaByDistance=o.Z.clone(e,this._frontFaceAlphaByDistance)}},backFaceAlpha:{get:function(){return this._backFaceAlpha},set:function(e){i.Z.typeOf.number.greaterThanOrEquals("backFaceAlpha",e,0),i.Z.typeOf.number.lessThanOrEquals("backFaceAlpha",e,1),this._backFaceAlpha=e}},backFaceAlphaByDistance:{get:function(){return this._backFaceAlphaByDistance},set:function(e){if((0,a.Z)(e)&&e.far<e.near)throw new n.Z("far distance must be greater than near distance.");this._backFaceAlphaByDistance=o.Z.clone(e,this._backFaceAlphaByDistance)}},rectangle:{get:function(){return this._rectangle},set:function(e){(0,a.Z)(e)||(e=s.Z.clone(s.Z.MAX_VALUE)),s.Z.clone(e,this._rectangle)}}}),t["Z"]=d},55606:function(e,t,r){var i=r(88108),a=r(59947),n=r(82982),o=r(86511),s=r(38443),d=r(39899),u=r(2932),l=r(21572),c=r(17941),h=r(89032),m=r(10667),p=r(87721),g=r(8743),f=r(82239);function _(){this._colorTexture=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this._framebuffer=void 0,this._packedDepthTexture=void 0,this._packedDepthFramebuffer=void 0,this._renderState=void 0,this._packedDepthCommand=void 0,this._clearCommand=void 0,this._viewport=new i.Z,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHdr=void 0}function y(e){e._colorTexture=e._colorTexture&&!e._colorTexture.isDestroyed()&&e._colorTexture.destroy(),e._depthStencilTexture=e._depthStencilTexture&&!e._depthStencilTexture.isDestroyed()&&e._depthStencilTexture.destroy(),e._depthStencilRenderbuffer=e._depthStencilRenderbuffer&&!e._depthStencilRenderbuffer.isDestroyed()&&e._depthStencilRenderbuffer.destroy(),e._framebuffer=e._framebuffer&&!e._framebuffer.isDestroyed()&&e._framebuffer.destroy(),e._packedDepthTexture=e._packedDepthTexture&&!e._packedDepthTexture.isDestroyed()&&e._packedDepthTexture.destroy(),e._packedDepthFramebuffer=e._packedDepthFramebuffer&&!e._packedDepthFramebuffer.isDestroyed()&&e._packedDepthFramebuffer.destroy()}function v(e,t,r,i,a){var n=a?t.halfFloatingPointTexture?l.Z.HALF_FLOAT:l.Z.FLOAT:l.Z.UNSIGNED_BYTE;e._colorTexture=new g.Z({context:t,width:r,height:i,pixelFormat:s.Z.RGBA,pixelDatatype:n,sampler:p.Z.NEAREST}),t.depthTexture?e._depthStencilTexture=new g.Z({context:t,width:r,height:i,pixelFormat:s.Z.DEPTH_STENCIL,pixelDatatype:l.Z.UNSIGNED_INT_24_8}):e._depthStencilRenderbuffer=new c.Z({context:t,width:r,height:i,format:h.Z.DEPTH_STENCIL}),e._framebuffer=new u.Z({context:t,colorTextures:[e._colorTexture],depthStencilTexture:e._depthStencilTexture,depthStencilRenderbuffer:e._depthStencilRenderbuffer,destroyAttachments:!1}),e._packedDepthTexture=new g.Z({context:t,width:r,height:i,pixelFormat:s.Z.RGBA,pixelDatatype:l.Z.UNSIGNED_BYTE,sampler:p.Z.NEAREST}),e._packedDepthFramebuffer=new u.Z({context:t,colorTextures:[e._packedDepthTexture],destroyAttachments:!1})}function Z(e,t,r,i,a){var o=e._colorTexture,s=!(0,n.Z)(o)||o.width!==r||o.height!==i||a!==e._useHdr;s&&(y(e),v(e,t,r,i,a))}function T(e,t,r,o,s){e._viewport.width=r,e._viewport.height=o;var u=!i.Z.equals(e._viewport,s.viewport),l=u!==e._useScissorTest;e._useScissorTest=u,i.Z.equals(e._scissorRectangle,s.viewport)||(e._scissorRectangle=i.Z.clone(s.viewport,e._scissorRectangle),l=!0),(0,n.Z)(e._renderState)&&i.Z.equals(e._viewport,e._renderState.viewport)&&!l||(e._renderState=m.Z.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}})),(0,n.Z)(e._packedDepthCommand)||(e._packedDepthCommand=t.createViewportQuadCommand(f.Z,{uniformMap:{u_depthTexture:function(){return e._depthStencilTexture}},owner:e})),(0,n.Z)(e._clearCommand)||(e._clearCommand=new d.Z({color:new a.Z(0,0,0,0),depth:1,stencil:0,owner:e})),e._packedDepthCommand.framebuffer=e._packedDepthFramebuffer,e._packedDepthCommand.renderState=e._renderState,e._clearCommand.framebuffer=e._framebuffer,e._clearCommand.renderState=e._renderState}Object.defineProperties(_.prototype,{classificationTexture:{get:function(){return this._colorTexture}},classificationFramebuffer:{get:function(){return this._framebuffer}}}),_.prototype.updateAndClear=function(e,t,r,i){var a=t.width,n=t.height;Z(this,r,a,n,e),T(this,r,a,n,i),this._useHdr=e},_.prototype.clearClassification=function(e,t){this._clearCommand.execute(e,t)},_.prototype.packDepth=function(e,t){return this._packedDepthCommand.execute(e,t),this._packedDepthTexture},_.prototype.isDestroyed=function(){return!1},_.prototype.destroy=function(){return y(this),(0,o.Z)(this)},t["Z"]=_},85985:function(e,t,r){var i=r(8182),a=r(62200),n=r(82982),o=r(15720),s=r(96190),d=r(60072),u=r(8379),l=r(10667),c=r(53642),h=r(13633),m=r(71593),p=r(89917),g={OPAQUE_FRONT_FACE:0,OPAQUE_BACK_FACE:1,DEPTH_ONLY_FRONT_FACE:2,DEPTH_ONLY_BACK_FACE:3,DEPTH_ONLY_FRONT_AND_BACK_FACE:4,TRANSLUCENT_FRONT_FACE:5,TRANSLUCENT_BACK_FACE:6,TRANSLUCENT_FRONT_FACE_MANUAL_DEPTH_TEST:7,TRANSLUCENT_BACK_FACE_MANUAL_DEPTH_TEST:8,PICK_FRONT_FACE:9,PICK_BACK_FACE:10,DERIVED_COMMANDS_MAXIMUM_LENGTH:11},f=g.DERIVED_COMMANDS_MAXIMUM_LENGTH,_=["opaqueFrontFaceCommand","opaqueBackFaceCommand","depthOnlyFrontFaceCommand","depthOnlyBackFaceCommand","depthOnlyFrontAndBackFaceCommand","translucentFrontFaceCommand","translucentBackFaceCommand","translucentFrontFaceManualDepthTestCommand","translucentBackFaceManualDepthTestCommand","pickFrontFaceCommand","pickBackFaceCommand"];function y(){this._frontFaceAlphaByDistance=new o.Z(0,1,0,1),this._backFaceAlphaByDistance=new o.Z(0,1,0,1),this._frontFaceTranslucent=!1,this._backFaceTranslucent=!1,this._requiresManualDepthTest=!1,this._sunVisibleThroughGlobe=!1,this._environmentVisible=!1,this._useDepthPlane=!1,this._numberOfTextureUniforms=0,this._globeTranslucencyFramebuffer=void 0,this._rectangle=s.Z.clone(s.Z.MAX_VALUE),this._derivedCommandKey=0,this._derivedCommandsDirty=!1,this._derivedCommandPacks=void 0,this._derivedCommandTypes=new Array(f),this._derivedBlendCommandTypes=new Array(f),this._derivedPickCommandTypes=new Array(f),this._derivedCommandTypesToUpdate=new Array(f),this._derivedCommandsLength=0,this._derivedBlendCommandsLength=0,this._derivedPickCommandsLength=0,this._derivedCommandsToUpdateLength=0}function v(e,t,r,i){return e?(0,n.Z)(r)?(o.Z.clone(r,i),i.nearValue*=t,i.farValue*=t,i):(i.nearValue=t,i.farValue=t,i):(i.nearValue=1,i.farValue=1,i)}function Z(e,t,r){return e&&(r.baseColor.alpha<1||t.nearValue<1||t.farValue<1)}function T(e,t){var r=e._frontFaceTranslucent,i=e._backFaceTranslucent;return r&&(t.cameraUnderground||i)}function C(e,t){return!t.cameraUnderground||e._frontFaceTranslucent}function x(e,t){return!t.cameraUnderground&&!e._frontFaceTranslucent}function S(e,t,r){return e._frontFaceTranslucent&&!e._backFaceTranslucent&&!r.depthTestAgainstTerrain&&t.mode!==p.Z.SCENE2D&&t.context.depthTexture}function A(e){var t=0;return e._frontFaceTranslucent&&++t,e._requiresManualDepthTest&&++t,t}function D(e,t){var r;e._derivedCommandsLength=E(e,t,!1,!1,e._derivedCommandTypes),e._derivedBlendCommandsLength=E(e,t,!0,!1,e._derivedBlendCommandTypes),e._derivedPickCommandsLength=E(e,t,!1,!0,e._derivedPickCommandTypes);var i=0;for(r=0;r<e._derivedCommandsLength;++r)i|=1<<e._derivedCommandTypes[r];for(r=0;r<e._derivedBlendCommandsLength;++r)i|=1<<e._derivedBlendCommandTypes[r];for(r=0;r<e._derivedPickCommandsLength;++r)i|=1<<e._derivedPickCommandTypes[r];var a=0;for(r=0;r<f;++r)(i&1<<r)>0&&(e._derivedCommandTypesToUpdate[a++]=r);e._derivedCommandsToUpdateLength=a;var o=i!==e._derivedCommandKey;e._derivedCommandKey=i,e._derivedCommandsDirty=o,!(0,n.Z)(e._derivedCommandPacks)&&e._frontFaceTranslucent&&(e._derivedCommandPacks=J())}function E(e,t,r,i,a){var n=0,o=e._frontFaceTranslucent,s=e._backFaceTranslucent;if(!o)return n;var d=t.cameraUnderground,u=e._requiresManualDepthTest,l=i?g.PICK_FRONT_FACE:u?g.TRANSLUCENT_FRONT_FACE_MANUAL_DEPTH_TEST:g.TRANSLUCENT_FRONT_FACE,c=i?g.PICK_BACK_FACE:u?g.TRANSLUCENT_BACK_FACE_MANUAL_DEPTH_TEST:g.TRANSLUCENT_BACK_FACE;return t.mode===p.Z.SCENE2D?(a[n++]=g.DEPTH_ONLY_FRONT_FACE,a[n++]=l,n):(s?(r||(a[n++]=g.DEPTH_ONLY_FRONT_AND_BACK_FACE),d?(a[n++]=l,a[n++]=c):(a[n++]=c,a[n++]=l)):d?(r||(a[n++]=g.DEPTH_ONLY_BACK_FACE),a[n++]=g.OPAQUE_FRONT_FACE,a[n++]=c):(r||(a[n++]=g.DEPTH_ONLY_FRONT_FACE),a[n++]=g.OPAQUE_BACK_FACE,a[n++]=l),n)}function b(e,t){var r=e.indexOf(t);r>-1&&e.splice(r,1)}function w(e,t){return e.indexOf(t)>-1}function F(e,t){b(e.defines,"TRANSLUCENT"),b(t.defines,"TRANSLUCENT")}function N(e,t){b(e.defines,"GROUND_ATMOSPHERE"),b(t.defines,"GROUND_ATMOSPHERE"),b(e.defines,"FOG"),b(t.defines,"FOG"),b(e.defines,"TRANSLUCENT"),b(t.defines,"TRANSLUCENT")}function L(e,t){if(!w(t.defines,"TILE_LIMIT_RECTANGLE")&&!w(t.defines,"ENABLE_CLIPPING_PLANES")){var r="void main() \n{ \n    gl_FragColor = vec4(1.0); \n} \n";t.sources=[r]}}function R(e,t){for(var r=t.sources,i=r.length,a=0;a<i;++a)r[a]=c.Z.replaceMain(r[a],"czm_globe_translucency_main");var n="\n\nuniform sampler2D u_classificationTexture; \nvoid main() \n{ \n    vec2 st = gl_FragCoord.xy / czm_viewport.zw; \n#ifdef MANUAL_DEPTH_TEST \n    float logDepthOrDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, st)); \n    if (logDepthOrDepth != 0.0) \n    { \n        vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth); \n        float depthEC = eyeCoordinate.z / eyeCoordinate.w; \n        if (v_positionEC.z < depthEC) \n        { \n            discard; \n        } \n    } \n#endif \n    czm_globe_translucency_main(); \n    vec4 classificationColor = texture2D(u_classificationTexture, st); \n    if (classificationColor.a > 0.0) \n    { \n        // Reverse premultiplication process to get the correct composited result of the classification primitives \n        classificationColor.rgb /= classificationColor.a; \n    } \n    gl_FragColor = classificationColor * vec4(classificationColor.aaa, 1.0) + gl_FragColor * (1.0 - classificationColor.a); \n} \n";r.push(n)}function P(e,t){R(e,t),b(e.defines,"GROUND_ATMOSPHERE"),b(t.defines,"GROUND_ATMOSPHERE"),b(e.defines,"FOG"),b(t.defines,"FOG")}function O(e,t){R(e,t),e.defines.push("GENERATE_POSITION"),t.defines.push("MANUAL_DEPTH_TEST")}function M(e,t){P(e,t),e.defines.push("GENERATE_POSITION"),t.defines.push("MANUAL_DEPTH_TEST")}function I(e,t){var r="uniform sampler2D u_classificationTexture; \nvoid main() \n{ \n    vec2 st = gl_FragCoord.xy / czm_viewport.zw; \n    vec4 pickColor = texture2D(u_classificationTexture, st); \n    if (pickColor == vec4(0.0)) \n    { \n        discard; \n    } \n    gl_FragColor = pickColor; \n} \n";t.sources=[r]}function B(e,t,r,i,a,o){if(!(0,n.Z)(a))return t;if(!i&&(0,n.Z)(r))return r;var s=e.shaderCache.getDerivedShaderProgram(t,o);if(!(0,n.Z)(s)){var d=t._attributeLocations,u=t.vertexShaderSource.clone(),l=t.fragmentShaderSource.clone();u.defines=(0,n.Z)(u.defines)?u.defines.slice(0):[],l.defines=(0,n.Z)(l.defines)?l.defines.slice(0):[],a(u,l),s=e.shaderCache.createDerivedShaderProgram(t,o,{vertexShaderSource:u,fragmentShaderSource:l,attributeLocations:d})}return s}function H(e){e.cull.face=m.Z.BACK,e.cull.enabled=!0}function k(e){e.cull.face=m.Z.FRONT,e.cull.enabled=!0}function U(e){e.cull.face=m.Z.BACK,e.cull.enabled=!0,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function G(e){e.cull.face=m.Z.FRONT,e.cull.enabled=!0,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function V(e){e.cull.enabled=!1,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function z(e){e.cull.face=m.Z.BACK,e.cull.enabled=!0,e.depthMask=!1,e.blending=h.Z.ALPHA_BLEND}function q(e){e.cull.face=m.Z.FRONT,e.cull.enabled=!0,e.depthMask=!1,e.blending=h.Z.ALPHA_BLEND}function W(e){e.cull.face=m.Z.BACK,e.cull.enabled=!0,e.blending.enabled=!1}function Y(e){e.cull.face=m.Z.FRONT,e.cull.enabled=!0,e.blending.enabled=!1}function K(e,t,r,i,a){if(!(0,n.Z)(i))return e;if(!r&&(0,n.Z)(t))return t;var o=a[e.id];if(!(0,n.Z)(o)){var s=l.Z.getState(e);i(s),o=l.Z.fromCache(s),a[e.id]=o}return o}function j(e){return{u_classificationTexture:function(){return e._globeTranslucencyFramebuffer.classificationTexture}}}function Q(e,t,r,a,o){return(0,n.Z)(o)?!a&&(0,n.Z)(r)?r:(0,i.Z)(t,o(e),!1):t}function X(e){this.pass=e.pass,this.pickOnly=e.pickOnly,this.getShaderProgramFunction=e.getShaderProgramFunction,this.getRenderStateFunction=e.getRenderStateFunction,this.getUniformMapFunction=e.getUniformMapFunction,this.renderStateCache={}}function J(){return[new X({pass:u.Z.GLOBE,pickOnly:!1,getShaderProgramFunction:F,getRenderStateFunction:H,getUniformMapFunction:void 0}),new X({pass:u.Z.GLOBE,pickOnly:!1,getShaderProgramFunction:N,getRenderStateFunction:k,getUniformMapFunction:void 0}),new X({pass:u.Z.GLOBE,pickOnly:!1,getShaderProgramFunction:L,getRenderStateFunction:U,getUniformMapFunction:void 0}),new X({pass:u.Z.GLOBE,pickOnly:!1,getShaderProgramFunction:L,getRenderStateFunction:G,getUniformMapFunction:void 0}),new X({pass:u.Z.GLOBE,pickOnly:!1,getShaderProgramFunction:L,getRenderStateFunction:V,getUniformMapFunction:void 0}),new X({pass:u.Z.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:R,getRenderStateFunction:z,getUniformMapFunction:j}),new X({pass:u.Z.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:P,getRenderStateFunction:q,getUniformMapFunction:j}),new X({pass:u.Z.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:O,getRenderStateFunction:z,getUniformMapFunction:j}),new X({pass:u.Z.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:M,getRenderStateFunction:q,getUniformMapFunction:j}),new X({pass:u.Z.TRANSLUCENT,pickOnly:!0,getShaderProgramFunction:I,getRenderStateFunction:W,getUniformMapFunction:j}),new X({pass:u.Z.TRANSLUCENT,pickOnly:!0,getShaderProgramFunction:I,getRenderStateFunction:Y,getUniformMapFunction:j})]}Object.defineProperties(y.prototype,{frontFaceAlphaByDistance:{get:function(){return this._frontFaceAlphaByDistance}},backFaceAlphaByDistance:{get:function(){return this._backFaceAlphaByDistance}},translucent:{get:function(){return this._frontFaceTranslucent}},sunVisibleThroughGlobe:{get:function(){return this._sunVisibleThroughGlobe}},environmentVisible:{get:function(){return this._environmentVisible}},useDepthPlane:{get:function(){return this._useDepthPlane}},numberOfTextureUniforms:{get:function(){return this._numberOfTextureUniforms}},rectangle:{get:function(){return this._rectangle}}}),y.prototype.update=function(e){var t=e.globe;if(!(0,n.Z)(t)||!t.show)return this._frontFaceTranslucent=!1,this._backFaceTranslucent=!1,this._sunVisibleThroughGlobe=!0,this._environmentVisible=!0,void(this._useDepthPlane=!1);this._frontFaceAlphaByDistance=v(t.translucency.enabled,t.translucency.frontFaceAlpha,t.translucency.frontFaceAlphaByDistance,this._frontFaceAlphaByDistance),this._backFaceAlphaByDistance=v(t.translucency.enabled,t.translucency.backFaceAlpha,t.translucency.backFaceAlphaByDistance,this._backFaceAlphaByDistance),this._frontFaceTranslucent=Z(t.translucency.enabled,this._frontFaceAlphaByDistance,t),this._backFaceTranslucent=Z(t.translucency.enabled,this._backFaceAlphaByDistance,t),this._requiresManualDepthTest=S(this,e,t),this._sunVisibleThroughGlobe=T(this,e),this._environmentVisible=C(this,e),this._useDepthPlane=x(this,e),this._numberOfTextureUniforms=A(this),this._rectangle=s.Z.clone(t.translucency.rectangle,this._rectangle),D(this,e)};var $=new Array(f),ee=new Array(f);function te(e,t,r,i,o,s,u){var l=t.derivedCommands.globeTranslucency,c=e._derivedCommandsDirty;if(t.dirty||!(0,n.Z)(l)||c){t.dirty=!1,(0,n.Z)(l)||(l={},t.derivedCommands.globeTranslucency=l);var h=u.frameNumber,m=(0,a.Z)(l.uniformMapDirtyFrame,0),p=(0,a.Z)(l.shaderProgramDirtyFrame,0),g=(0,a.Z)(l.renderStateDirtyFrame,0),f=l.uniformMap!==t.uniformMap,_=l.shaderProgramId!==t.shaderProgram.id,y=l.renderStateId!==t.renderState.id;f&&(l.uniformMapDirtyFrame=h),_&&(l.shaderProgramDirtyFrame=h),y&&(l.renderStateDirtyFrame=h),l.uniformMap=t.uniformMap,l.shaderProgramId=t.shaderProgram.id,l.renderStateId=t.renderState.id;for(var v=0;v<r;++v){var Z,T,C,x=s[v],S=i[v],A=o[v],D=l[A];(0,n.Z)(D)?(Z=D.uniformMap,T=D.shaderProgram,C=D.renderState):(Z=void 0,T=void 0,C=void 0),D=d.Z.shallowClone(t,D),l[A]=D;var E=(0,a.Z)(D.derivedCommands.uniformMapDirtyFrame,0),b=(0,a.Z)(D.derivedCommands.shaderProgramDirtyFrame,0),w=(0,a.Z)(D.derivedCommands.renderStateDirtyFrame,0),F=f||E<m,N=_||b<p,L=y||w<g;F&&(D.derivedCommands.uniformMapDirtyFrame=h),N&&(D.derivedCommands.shaderProgramDirtyFrame=h),L&&(D.derivedCommands.renderStateDirtyFrame=h),D.derivedCommands.type=S,D.pass=x.pass,D.pickOnly=x.pickOnly,D.uniformMap=Q(e,t.uniformMap,Z,F,x.getUniformMapFunction),D.shaderProgram=B(u.context,t.shaderProgram,T,N,x.getShaderProgramFunction,A),D.renderState=K(t.renderState,C,L,x.getRenderStateFunction,x.renderStateCache)}}}function re(e,t,r,i,a,o,s){for(var d=0;d<t;++d){var u=e[d],l=u.derivedCommands.type;(!(0,n.Z)(s)||s.indexOf(l)>-1)&&r(u,i,a,o)}}function ie(e,t,r,i,a,n){for(var o=0;o<t;++o)r(e[o],i,a,n)}y.prototype.updateDerivedCommands=function(e,t){var r=this._derivedCommandTypesToUpdate,i=this._derivedCommandsToUpdateLength;if(0!==i){for(var a=0;a<i;++a)ee[a]=this._derivedCommandPacks[r[a]],$[a]=_[r[a]];te(this,e,i,r,$,ee,t)}},y.prototype.pushDerivedCommands=function(e,t,r){var i=r.passes.pick;if(!i||!t){var a=this._derivedCommandTypes,n=this._derivedCommandsLength;if(i?(a=this._derivedPickCommandTypes,n=this._derivedPickCommandsLength):t&&(a=this._derivedBlendCommandTypes,n=this._derivedBlendCommandsLength),0!==n)for(var o=e.derivedCommands.globeTranslucency,s=0;s<n;++s){var d=_[a[s]];r.commandList.push(o[d])}else r.commandList.push(e)}};var ae=[g.OPAQUE_FRONT_FACE,g.OPAQUE_BACK_FACE],ne=[g.DEPTH_ONLY_FRONT_FACE,g.DEPTH_ONLY_BACK_FACE,g.DEPTH_ONLY_FRONT_AND_BACK_FACE];y.prototype.executeGlobeCommands=function(e,t,r,i,a){var n=i.context,o=e.commands[u.Z.GLOBE],s=e.indices[u.Z.GLOBE];0!==s&&(this._globeTranslucencyFramebuffer=r,r.clearClassification(n,a),re(o,s,t,i,n,a,ae))},y.prototype.executeGlobeClassificationCommands=function(e,t,r,i,a){var n=i.context,o=e.commands[u.Z.GLOBE],s=e.indices[u.Z.GLOBE],d=e.commands[u.Z.TERRAIN_CLASSIFICATION],l=e.indices[u.Z.TERRAIN_CLASSIFICATION];if(0!==s&&0!==l){var c=this._frontFaceTranslucent,h=this._backFaceTranslucent;if(c&&h||ie(d,l,t,i,n,a),c||h){this._globeTranslucencyFramebuffer=r;var m=n.uniformState.globeDepthTexture,p=a.framebuffer;if(a.framebuffer=r.classificationFramebuffer,re(o,s,t,i,n,a,ne),n.depthTexture){var g=r.packDepth(n,a);n.uniformState.globeDepthTexture=g}ie(d,l,t,i,n,a),n.uniformState.globeDepthTexture=m,a.framebuffer=p}}},t["Z"]=y}}]);
//# sourceMappingURL=chunk-vendors-d3eda0bc.d0722120.js.map