"use strict";(self["webpackChunkvue3_webpack5"]=self["webpackChunkvue3_webpack5"]||[]).push([[7580],{30413:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_Color_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(59947);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(82982);\n/* harmony import */ var _Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(86511);\n/* harmony import */ var _Core_RequestType_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(82968);\n/* harmony import */ var _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(8379);\n/* harmony import */ var _Axis_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(66577);\n/* harmony import */ var _Model_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(16626);\n/* harmony import */ var _ModelAnimationLoop_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(61841);\n/* harmony import */ var _Core_ExperimentalFeatures_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(54862);\n/* harmony import */ var _ModelExperimental_ModelExperimental_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(46521);\n/* harmony import */ var _Core_combine_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(8182);\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Represents the contents of a glTF or glb tile in a {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification|3D Tiles} tileset using the {@link https://github.com/CesiumGS/3d-tiles/tree/3d-tiles-next/extensions/3DTILES_content_gltf|3DTILES_content_gltf} extension.\n * <p>\n * This class does not yet support the {@link https://github.com/CesiumGS/glTF/tree/3d-tiles-next/extensions/2.0/Vendor/EXT_feature_metadata|EXT_feature_metadata Extension}.\n * </p>\n * <p>\n * Implements the {@link Cesium3DTileContent} interface.\n * </p>\n *\n * @alias Gltf3DTileContent\n * @constructor\n *\n * @private\n * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium\'s standard deprecation policy.\n */\nfunction Gltf3DTileContent(tileset, tile, resource, gltf) {\n  this._tileset = tileset;\n  this._tile = tile;\n  this._resource = resource;\n  this._model = undefined;\n\n  this.featurePropertiesDirty = false;\n  this._groupMetadata = undefined;\n\n  initialize(this, gltf);\n}\n\nObject.defineProperties(Gltf3DTileContent.prototype, {\n  featuresLength: {\n    get: function () {\n      return 0;\n    },\n  },\n\n  pointsLength: {\n    get: function () {\n      return this._model.pointsLength;\n    },\n  },\n\n  trianglesLength: {\n    get: function () {\n      return this._model.trianglesLength;\n    },\n  },\n\n  geometryByteLength: {\n    get: function () {\n      return this._model.geometryByteLength;\n    },\n  },\n\n  texturesByteLength: {\n    get: function () {\n      return this._model.texturesByteLength;\n    },\n  },\n\n  batchTableByteLength: {\n    get: function () {\n      return 0;\n    },\n  },\n\n  innerContents: {\n    get: function () {\n      return undefined;\n    },\n  },\n\n  readyPromise: {\n    get: function () {\n      return this._model.readyPromise;\n    },\n  },\n\n  tileset: {\n    get: function () {\n      return this._tileset;\n    },\n  },\n\n  tile: {\n    get: function () {\n      return this._tile;\n    },\n  },\n\n  url: {\n    get: function () {\n      return this._resource.getUrlComponent(true);\n    },\n  },\n\n  batchTable: {\n    get: function () {\n      return undefined;\n    },\n  },\n\n  groupMetadata: {\n    get: function () {\n      return this._groupMetadata;\n    },\n    set: function (value) {\n      this._groupMetadata = value;\n    },\n  },\n});\n\nfunction initialize(content, gltf) {\n  var tileset = content._tileset;\n  var tile = content._tile;\n  var resource = content._resource;\n\n  var pickObject = {\n    content: content,\n    primitive: tileset,\n  };\n\n  var modelOptions = {\n    gltf: gltf,\n    cull: false, // The model is already culled by 3D Tiles\n    releaseGltfJson: true, // Models are unique and will not benefit from caching so save memory\n    opaquePass: _Renderer_Pass_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].CESIUM_3D_TILE */ .Z.CESIUM_3D_TILE, // Draw opaque portions of the model during the 3D Tiles pass\n    basePath: resource,\n    modelMatrix: tile.computedTransform,\n    upAxis: tileset._gltfUpAxis,\n    forwardAxis: _Axis_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].X */ .Z.X,\n    incrementallyLoadTextures: false,\n  };\n\n  if (_Core_ExperimentalFeatures_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].enableModelExperimental */ .Z.enableModelExperimental) {\n    modelOptions.customShader = tileset.customShader;\n    content._model = _ModelExperimental_ModelExperimental_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].fromGltf */ .Z.fromGltf(modelOptions);\n  } else {\n    modelOptions = (0,_Core_combine_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(modelOptions, {\n      requestType: _Core_RequestType_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].TILES3D */ .Z.TILES3D,\n      shadows: tileset.shadows,\n      debugWireframe: tileset.debugWireframe,\n      addBatchIdToGeneratedShaders: false,\n      pickObject: pickObject,\n      imageBasedLightingFactor: tileset.imageBasedLightingFactor,\n      lightColor: tileset.lightColor,\n      luminanceAtZenith: tileset.luminanceAtZenith,\n      sphericalHarmonicCoefficients: tileset.sphericalHarmonicCoefficients,\n      specularEnvironmentMaps: tileset.specularEnvironmentMaps,\n      backFaceCulling: tileset.backFaceCulling,\n      showOutline: tileset.showOutline,\n    });\n    content._model = new _Model_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z(modelOptions);\n  }\n\n  content._model.readyPromise.then(function (model) {\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(model.activeAnimations)) {\n      model.activeAnimations.addAll({\n        loop: _ModelAnimationLoop_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].REPEAT */ .Z.REPEAT,\n      });\n    }\n  });\n}\n\nGltf3DTileContent.prototype.hasProperty = function (batchId, name) {\n  return false;\n};\n\nGltf3DTileContent.prototype.getFeature = function (batchId) {\n  return undefined;\n};\n\nGltf3DTileContent.prototype.applyDebugSettings = function (enabled, color) {\n  color = enabled ? color : _Core_Color_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].WHITE */ .Z.WHITE;\n  this._model.color = color;\n};\n\nGltf3DTileContent.prototype.applyStyle = function (style) {\n  var hasColorStyle = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(style) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(style.color);\n  var hasShowStyle = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(style) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(style.show);\n  this._model.color = hasColorStyle\n    ? style.color.evaluateColor(undefined, this._model.color)\n    : _Core_Color_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].clone */ .Z.clone(_Core_Color_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].WHITE */ .Z.WHITE, this._model.color);\n  this._model.show = hasShowStyle ? style.show.evaluate(undefined) : true;\n};\n\nGltf3DTileContent.prototype.update = function (tileset, frameState) {\n  var model = this._model;\n  var tile = this._tile;\n\n  model.modelMatrix = tile.computedTransform;\n  model.shadows = tileset.shadows;\n  model.imageBasedLightingFactor = tileset.imageBasedLightingFactor;\n  model.lightColor = tileset.lightColor;\n  model.luminanceAtZenith = tileset.luminanceAtZenith;\n  model.sphericalHarmonicCoefficients = tileset.sphericalHarmonicCoefficients;\n  model.specularEnvironmentMaps = tileset.specularEnvironmentMaps;\n  model.backFaceCulling = tileset.backFaceCulling;\n  model.debugWireframe = tileset.debugWireframe;\n\n  // Update clipping planes\n  var tilesetClippingPlanes = tileset.clippingPlanes;\n  model.referenceMatrix = tileset.clippingPlanesOriginMatrix;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(tilesetClippingPlanes) && tile.clippingPlanesDirty) {\n    // Dereference the clipping planes from the model if they are irrelevant.\n    // Link/Dereference directly to avoid ownership checks.\n    // This will also trigger synchronous shader regeneration to remove or add the clipping plane and color blending code.\n    model._clippingPlanes =\n      tilesetClippingPlanes.enabled && tile._isClipped\n        ? tilesetClippingPlanes\n        : undefined;\n  }\n\n  // If the model references a different ClippingPlaneCollection due to the tileset\'s collection being replaced with a\n  // ClippingPlaneCollection that gives this tile the same clipping status, update the model to use the new ClippingPlaneCollection.\n  if (\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(tilesetClippingPlanes) &&\n    (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(model._clippingPlanes) &&\n    model._clippingPlanes !== tilesetClippingPlanes\n  ) {\n    model._clippingPlanes = tilesetClippingPlanes;\n  }\n\n  model.update(frameState);\n};\n\nGltf3DTileContent.prototype.isDestroyed = function () {\n  return false;\n};\n\nGltf3DTileContent.prototype.destroy = function () {\n  this._model = this._model && this._model.destroy();\n  return (0,_Core_destroyObject_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(this);\n};\n\n/* harmony default export */ __webpack_exports__["Z"] = (Gltf3DTileContent);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzA0MTMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBcUM7QUFDSTtBQUNZO0FBQ0o7QUFDVjtBQUNWO0FBQ0U7QUFDMEI7QUFDVTtBQUNNO0FBQ2hDOztBQUV6QztBQUNBLHVEQUF1RCw2RUFBNkUsbUJBQW1CLG9IQUFvSDtBQUMzUTtBQUNBLHdDQUF3QyxvSUFBb0k7QUFDNUs7QUFDQTtBQUNBLG1CQUFtQiwyQkFBMkI7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNILENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsZ0dBQW1CO0FBQ25DO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiw2REFBTTtBQUN2QjtBQUNBOztBQUVBLE1BQU0sOEhBQTRDO0FBQ2xEO0FBQ0EscUJBQXFCLDBHQUEwQjtBQUMvQyxJQUFJO0FBQ0osbUJBQW1CLHFFQUFPO0FBQzFCLG1CQUFtQixxRkFBbUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCx5QkFBeUIsMERBQUs7QUFDOUI7O0FBRUE7QUFDQSxRQUFRLHNFQUFPO0FBQ2Y7QUFDQSxjQUFjLHFGQUF5QjtBQUN2QyxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDRCQUE0QiwyRUFBVztBQUN2QztBQUNBOztBQUVBO0FBQ0Esc0JBQXNCLHNFQUFPLFdBQVcsc0VBQU87QUFDL0MscUJBQXFCLHNFQUFPLFdBQVcsc0VBQU87QUFDOUM7QUFDQTtBQUNBLE1BQU0sMkVBQVcsQ0FBQywyRUFBVztBQUM3QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTSxzRUFBTztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSSxzRUFBTztBQUNYLElBQUksc0VBQU87QUFDWDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUywyRUFBYTtBQUN0Qjs7QUFFQSx5REFBZSxpQkFBaUIsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9TY2VuZS9HbHRmM0RUaWxlQ29udGVudC5qcz9jMTIxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDb2xvciBmcm9tIFwiLi4vQ29yZS9Db2xvci5qc1wiO1xuaW1wb3J0IGRlZmluZWQgZnJvbSBcIi4uL0NvcmUvZGVmaW5lZC5qc1wiO1xuaW1wb3J0IGRlc3Ryb3lPYmplY3QgZnJvbSBcIi4uL0NvcmUvZGVzdHJveU9iamVjdC5qc1wiO1xuaW1wb3J0IFJlcXVlc3RUeXBlIGZyb20gXCIuLi9Db3JlL1JlcXVlc3RUeXBlLmpzXCI7XG5pbXBvcnQgUGFzcyBmcm9tIFwiLi4vUmVuZGVyZXIvUGFzcy5qc1wiO1xuaW1wb3J0IEF4aXMgZnJvbSBcIi4vQXhpcy5qc1wiO1xuaW1wb3J0IE1vZGVsIGZyb20gXCIuL01vZGVsLmpzXCI7XG5pbXBvcnQgTW9kZWxBbmltYXRpb25Mb29wIGZyb20gXCIuL01vZGVsQW5pbWF0aW9uTG9vcC5qc1wiO1xuaW1wb3J0IEV4cGVyaW1lbnRhbEZlYXR1cmVzIGZyb20gXCIuLi9Db3JlL0V4cGVyaW1lbnRhbEZlYXR1cmVzLmpzXCI7XG5pbXBvcnQgTW9kZWxFeHBlcmltZW50YWwgZnJvbSBcIi4vTW9kZWxFeHBlcmltZW50YWwvTW9kZWxFeHBlcmltZW50YWwuanNcIjtcbmltcG9ydCBjb21iaW5lIGZyb20gXCIuLi9Db3JlL2NvbWJpbmUuanNcIjtcblxuLyoqXG4gKiBSZXByZXNlbnRzIHRoZSBjb250ZW50cyBvZiBhIGdsVEYgb3IgZ2xiIHRpbGUgaW4gYSB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL0Nlc2l1bUdTLzNkLXRpbGVzL3RyZWUvbWFpbi9zcGVjaWZpY2F0aW9ufDNEIFRpbGVzfSB0aWxlc2V0IHVzaW5nIHRoZSB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL0Nlc2l1bUdTLzNkLXRpbGVzL3RyZWUvM2QtdGlsZXMtbmV4dC9leHRlbnNpb25zLzNEVElMRVNfY29udGVudF9nbHRmfDNEVElMRVNfY29udGVudF9nbHRmfSBleHRlbnNpb24uXG4gKiA8cD5cbiAqIFRoaXMgY2xhc3MgZG9lcyBub3QgeWV0IHN1cHBvcnQgdGhlIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vQ2VzaXVtR1MvZ2xURi90cmVlLzNkLXRpbGVzLW5leHQvZXh0ZW5zaW9ucy8yLjAvVmVuZG9yL0VYVF9mZWF0dXJlX21ldGFkYXRhfEVYVF9mZWF0dXJlX21ldGFkYXRhIEV4dGVuc2lvbn0uXG4gKiA8L3A+XG4gKiA8cD5cbiAqIEltcGxlbWVudHMgdGhlIHtAbGluayBDZXNpdW0zRFRpbGVDb250ZW50fSBpbnRlcmZhY2UuXG4gKiA8L3A+XG4gKlxuICogQGFsaWFzIEdsdGYzRFRpbGVDb250ZW50XG4gKiBAY29uc3RydWN0b3JcbiAqXG4gKiBAcHJpdmF0ZVxuICogQGV4cGVyaW1lbnRhbCBUaGlzIGZlYXR1cmUgaXMgdXNpbmcgcGFydCBvZiB0aGUgM0QgVGlsZXMgc3BlYyB0aGF0IGlzIG5vdCBmaW5hbCBhbmQgaXMgc3ViamVjdCB0byBjaGFuZ2Ugd2l0aG91dCBDZXNpdW0ncyBzdGFuZGFyZCBkZXByZWNhdGlvbiBwb2xpY3kuXG4gKi9cbmZ1bmN0aW9uIEdsdGYzRFRpbGVDb250ZW50KHRpbGVzZXQsIHRpbGUsIHJlc291cmNlLCBnbHRmKSB7XG4gIHRoaXMuX3RpbGVzZXQgPSB0aWxlc2V0O1xuICB0aGlzLl90aWxlID0gdGlsZTtcbiAgdGhpcy5fcmVzb3VyY2UgPSByZXNvdXJjZTtcbiAgdGhpcy5fbW9kZWwgPSB1bmRlZmluZWQ7XG5cbiAgdGhpcy5mZWF0dXJlUHJvcGVydGllc0RpcnR5ID0gZmFsc2U7XG4gIHRoaXMuX2dyb3VwTWV0YWRhdGEgPSB1bmRlZmluZWQ7XG5cbiAgaW5pdGlhbGl6ZSh0aGlzLCBnbHRmKTtcbn1cblxuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoR2x0ZjNEVGlsZUNvbnRlbnQucHJvdG90eXBlLCB7XG4gIGZlYXR1cmVzTGVuZ3RoOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9LFxuICB9LFxuXG4gIHBvaW50c0xlbmd0aDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX21vZGVsLnBvaW50c0xlbmd0aDtcbiAgICB9LFxuICB9LFxuXG4gIHRyaWFuZ2xlc0xlbmd0aDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX21vZGVsLnRyaWFuZ2xlc0xlbmd0aDtcbiAgICB9LFxuICB9LFxuXG4gIGdlb21ldHJ5Qnl0ZUxlbmd0aDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX21vZGVsLmdlb21ldHJ5Qnl0ZUxlbmd0aDtcbiAgICB9LFxuICB9LFxuXG4gIHRleHR1cmVzQnl0ZUxlbmd0aDoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX21vZGVsLnRleHR1cmVzQnl0ZUxlbmd0aDtcbiAgICB9LFxuICB9LFxuXG4gIGJhdGNoVGFibGVCeXRlTGVuZ3RoOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9LFxuICB9LFxuXG4gIGlubmVyQ29udGVudHM6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfSxcbiAgfSxcblxuICByZWFkeVByb21pc2U6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9tb2RlbC5yZWFkeVByb21pc2U7XG4gICAgfSxcbiAgfSxcblxuICB0aWxlc2V0OiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdGlsZXNldDtcbiAgICB9LFxuICB9LFxuXG4gIHRpbGU6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl90aWxlO1xuICAgIH0sXG4gIH0sXG5cbiAgdXJsOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcmVzb3VyY2UuZ2V0VXJsQ29tcG9uZW50KHRydWUpO1xuICAgIH0sXG4gIH0sXG5cbiAgYmF0Y2hUYWJsZToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9LFxuICB9LFxuXG4gIGdyb3VwTWV0YWRhdGE6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9ncm91cE1ldGFkYXRhO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHRoaXMuX2dyb3VwTWV0YWRhdGEgPSB2YWx1ZTtcbiAgICB9LFxuICB9LFxufSk7XG5cbmZ1bmN0aW9uIGluaXRpYWxpemUoY29udGVudCwgZ2x0Zikge1xuICB2YXIgdGlsZXNldCA9IGNvbnRlbnQuX3RpbGVzZXQ7XG4gIHZhciB0aWxlID0gY29udGVudC5fdGlsZTtcbiAgdmFyIHJlc291cmNlID0gY29udGVudC5fcmVzb3VyY2U7XG5cbiAgdmFyIHBpY2tPYmplY3QgPSB7XG4gICAgY29udGVudDogY29udGVudCxcbiAgICBwcmltaXRpdmU6IHRpbGVzZXQsXG4gIH07XG5cbiAgdmFyIG1vZGVsT3B0aW9ucyA9IHtcbiAgICBnbHRmOiBnbHRmLFxuICAgIGN1bGw6IGZhbHNlLCAvLyBUaGUgbW9kZWwgaXMgYWxyZWFkeSBjdWxsZWQgYnkgM0QgVGlsZXNcbiAgICByZWxlYXNlR2x0Zkpzb246IHRydWUsIC8vIE1vZGVscyBhcmUgdW5pcXVlIGFuZCB3aWxsIG5vdCBiZW5lZml0IGZyb20gY2FjaGluZyBzbyBzYXZlIG1lbW9yeVxuICAgIG9wYXF1ZVBhc3M6IFBhc3MuQ0VTSVVNXzNEX1RJTEUsIC8vIERyYXcgb3BhcXVlIHBvcnRpb25zIG9mIHRoZSBtb2RlbCBkdXJpbmcgdGhlIDNEIFRpbGVzIHBhc3NcbiAgICBiYXNlUGF0aDogcmVzb3VyY2UsXG4gICAgbW9kZWxNYXRyaXg6IHRpbGUuY29tcHV0ZWRUcmFuc2Zvcm0sXG4gICAgdXBBeGlzOiB0aWxlc2V0Ll9nbHRmVXBBeGlzLFxuICAgIGZvcndhcmRBeGlzOiBBeGlzLlgsXG4gICAgaW5jcmVtZW50YWxseUxvYWRUZXh0dXJlczogZmFsc2UsXG4gIH07XG5cbiAgaWYgKEV4cGVyaW1lbnRhbEZlYXR1cmVzLmVuYWJsZU1vZGVsRXhwZXJpbWVudGFsKSB7XG4gICAgbW9kZWxPcHRpb25zLmN1c3RvbVNoYWRlciA9IHRpbGVzZXQuY3VzdG9tU2hhZGVyO1xuICAgIGNvbnRlbnQuX21vZGVsID0gTW9kZWxFeHBlcmltZW50YWwuZnJvbUdsdGYobW9kZWxPcHRpb25zKTtcbiAgfSBlbHNlIHtcbiAgICBtb2RlbE9wdGlvbnMgPSBjb21iaW5lKG1vZGVsT3B0aW9ucywge1xuICAgICAgcmVxdWVzdFR5cGU6IFJlcXVlc3RUeXBlLlRJTEVTM0QsXG4gICAgICBzaGFkb3dzOiB0aWxlc2V0LnNoYWRvd3MsXG4gICAgICBkZWJ1Z1dpcmVmcmFtZTogdGlsZXNldC5kZWJ1Z1dpcmVmcmFtZSxcbiAgICAgIGFkZEJhdGNoSWRUb0dlbmVyYXRlZFNoYWRlcnM6IGZhbHNlLFxuICAgICAgcGlja09iamVjdDogcGlja09iamVjdCxcbiAgICAgIGltYWdlQmFzZWRMaWdodGluZ0ZhY3RvcjogdGlsZXNldC5pbWFnZUJhc2VkTGlnaHRpbmdGYWN0b3IsXG4gICAgICBsaWdodENvbG9yOiB0aWxlc2V0LmxpZ2h0Q29sb3IsXG4gICAgICBsdW1pbmFuY2VBdFplbml0aDogdGlsZXNldC5sdW1pbmFuY2VBdFplbml0aCxcbiAgICAgIHNwaGVyaWNhbEhhcm1vbmljQ29lZmZpY2llbnRzOiB0aWxlc2V0LnNwaGVyaWNhbEhhcm1vbmljQ29lZmZpY2llbnRzLFxuICAgICAgc3BlY3VsYXJFbnZpcm9ubWVudE1hcHM6IHRpbGVzZXQuc3BlY3VsYXJFbnZpcm9ubWVudE1hcHMsXG4gICAgICBiYWNrRmFjZUN1bGxpbmc6IHRpbGVzZXQuYmFja0ZhY2VDdWxsaW5nLFxuICAgICAgc2hvd091dGxpbmU6IHRpbGVzZXQuc2hvd091dGxpbmUsXG4gICAgfSk7XG4gICAgY29udGVudC5fbW9kZWwgPSBuZXcgTW9kZWwobW9kZWxPcHRpb25zKTtcbiAgfVxuXG4gIGNvbnRlbnQuX21vZGVsLnJlYWR5UHJvbWlzZS50aGVuKGZ1bmN0aW9uIChtb2RlbCkge1xuICAgIGlmIChkZWZpbmVkKG1vZGVsLmFjdGl2ZUFuaW1hdGlvbnMpKSB7XG4gICAgICBtb2RlbC5hY3RpdmVBbmltYXRpb25zLmFkZEFsbCh7XG4gICAgICAgIGxvb3A6IE1vZGVsQW5pbWF0aW9uTG9vcC5SRVBFQVQsXG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xufVxuXG5HbHRmM0RUaWxlQ29udGVudC5wcm90b3R5cGUuaGFzUHJvcGVydHkgPSBmdW5jdGlvbiAoYmF0Y2hJZCwgbmFtZSkge1xuICByZXR1cm4gZmFsc2U7XG59O1xuXG5HbHRmM0RUaWxlQ29udGVudC5wcm90b3R5cGUuZ2V0RmVhdHVyZSA9IGZ1bmN0aW9uIChiYXRjaElkKSB7XG4gIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5HbHRmM0RUaWxlQ29udGVudC5wcm90b3R5cGUuYXBwbHlEZWJ1Z1NldHRpbmdzID0gZnVuY3Rpb24gKGVuYWJsZWQsIGNvbG9yKSB7XG4gIGNvbG9yID0gZW5hYmxlZCA/IGNvbG9yIDogQ29sb3IuV0hJVEU7XG4gIHRoaXMuX21vZGVsLmNvbG9yID0gY29sb3I7XG59O1xuXG5HbHRmM0RUaWxlQ29udGVudC5wcm90b3R5cGUuYXBwbHlTdHlsZSA9IGZ1bmN0aW9uIChzdHlsZSkge1xuICB2YXIgaGFzQ29sb3JTdHlsZSA9IGRlZmluZWQoc3R5bGUpICYmIGRlZmluZWQoc3R5bGUuY29sb3IpO1xuICB2YXIgaGFzU2hvd1N0eWxlID0gZGVmaW5lZChzdHlsZSkgJiYgZGVmaW5lZChzdHlsZS5zaG93KTtcbiAgdGhpcy5fbW9kZWwuY29sb3IgPSBoYXNDb2xvclN0eWxlXG4gICAgPyBzdHlsZS5jb2xvci5ldmFsdWF0ZUNvbG9yKHVuZGVmaW5lZCwgdGhpcy5fbW9kZWwuY29sb3IpXG4gICAgOiBDb2xvci5jbG9uZShDb2xvci5XSElURSwgdGhpcy5fbW9kZWwuY29sb3IpO1xuICB0aGlzLl9tb2RlbC5zaG93ID0gaGFzU2hvd1N0eWxlID8gc3R5bGUuc2hvdy5ldmFsdWF0ZSh1bmRlZmluZWQpIDogdHJ1ZTtcbn07XG5cbkdsdGYzRFRpbGVDb250ZW50LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAodGlsZXNldCwgZnJhbWVTdGF0ZSkge1xuICB2YXIgbW9kZWwgPSB0aGlzLl9tb2RlbDtcbiAgdmFyIHRpbGUgPSB0aGlzLl90aWxlO1xuXG4gIG1vZGVsLm1vZGVsTWF0cml4ID0gdGlsZS5jb21wdXRlZFRyYW5zZm9ybTtcbiAgbW9kZWwuc2hhZG93cyA9IHRpbGVzZXQuc2hhZG93cztcbiAgbW9kZWwuaW1hZ2VCYXNlZExpZ2h0aW5nRmFjdG9yID0gdGlsZXNldC5pbWFnZUJhc2VkTGlnaHRpbmdGYWN0b3I7XG4gIG1vZGVsLmxpZ2h0Q29sb3IgPSB0aWxlc2V0LmxpZ2h0Q29sb3I7XG4gIG1vZGVsLmx1bWluYW5jZUF0WmVuaXRoID0gdGlsZXNldC5sdW1pbmFuY2VBdFplbml0aDtcbiAgbW9kZWwuc3BoZXJpY2FsSGFybW9uaWNDb2VmZmljaWVudHMgPSB0aWxlc2V0LnNwaGVyaWNhbEhhcm1vbmljQ29lZmZpY2llbnRzO1xuICBtb2RlbC5zcGVjdWxhckVudmlyb25tZW50TWFwcyA9IHRpbGVzZXQuc3BlY3VsYXJFbnZpcm9ubWVudE1hcHM7XG4gIG1vZGVsLmJhY2tGYWNlQ3VsbGluZyA9IHRpbGVzZXQuYmFja0ZhY2VDdWxsaW5nO1xuICBtb2RlbC5kZWJ1Z1dpcmVmcmFtZSA9IHRpbGVzZXQuZGVidWdXaXJlZnJhbWU7XG5cbiAgLy8gVXBkYXRlIGNsaXBwaW5nIHBsYW5lc1xuICB2YXIgdGlsZXNldENsaXBwaW5nUGxhbmVzID0gdGlsZXNldC5jbGlwcGluZ1BsYW5lcztcbiAgbW9kZWwucmVmZXJlbmNlTWF0cml4ID0gdGlsZXNldC5jbGlwcGluZ1BsYW5lc09yaWdpbk1hdHJpeDtcbiAgaWYgKGRlZmluZWQodGlsZXNldENsaXBwaW5nUGxhbmVzKSAmJiB0aWxlLmNsaXBwaW5nUGxhbmVzRGlydHkpIHtcbiAgICAvLyBEZXJlZmVyZW5jZSB0aGUgY2xpcHBpbmcgcGxhbmVzIGZyb20gdGhlIG1vZGVsIGlmIHRoZXkgYXJlIGlycmVsZXZhbnQuXG4gICAgLy8gTGluay9EZXJlZmVyZW5jZSBkaXJlY3RseSB0byBhdm9pZCBvd25lcnNoaXAgY2hlY2tzLlxuICAgIC8vIFRoaXMgd2lsbCBhbHNvIHRyaWdnZXIgc3luY2hyb25vdXMgc2hhZGVyIHJlZ2VuZXJhdGlvbiB0byByZW1vdmUgb3IgYWRkIHRoZSBjbGlwcGluZyBwbGFuZSBhbmQgY29sb3IgYmxlbmRpbmcgY29kZS5cbiAgICBtb2RlbC5fY2xpcHBpbmdQbGFuZXMgPVxuICAgICAgdGlsZXNldENsaXBwaW5nUGxhbmVzLmVuYWJsZWQgJiYgdGlsZS5faXNDbGlwcGVkXG4gICAgICAgID8gdGlsZXNldENsaXBwaW5nUGxhbmVzXG4gICAgICAgIDogdW5kZWZpbmVkO1xuICB9XG5cbiAgLy8gSWYgdGhlIG1vZGVsIHJlZmVyZW5jZXMgYSBkaWZmZXJlbnQgQ2xpcHBpbmdQbGFuZUNvbGxlY3Rpb24gZHVlIHRvIHRoZSB0aWxlc2V0J3MgY29sbGVjdGlvbiBiZWluZyByZXBsYWNlZCB3aXRoIGFcbiAgLy8gQ2xpcHBpbmdQbGFuZUNvbGxlY3Rpb24gdGhhdCBnaXZlcyB0aGlzIHRpbGUgdGhlIHNhbWUgY2xpcHBpbmcgc3RhdHVzLCB1cGRhdGUgdGhlIG1vZGVsIHRvIHVzZSB0aGUgbmV3IENsaXBwaW5nUGxhbmVDb2xsZWN0aW9uLlxuICBpZiAoXG4gICAgZGVmaW5lZCh0aWxlc2V0Q2xpcHBpbmdQbGFuZXMpICYmXG4gICAgZGVmaW5lZChtb2RlbC5fY2xpcHBpbmdQbGFuZXMpICYmXG4gICAgbW9kZWwuX2NsaXBwaW5nUGxhbmVzICE9PSB0aWxlc2V0Q2xpcHBpbmdQbGFuZXNcbiAgKSB7XG4gICAgbW9kZWwuX2NsaXBwaW5nUGxhbmVzID0gdGlsZXNldENsaXBwaW5nUGxhbmVzO1xuICB9XG5cbiAgbW9kZWwudXBkYXRlKGZyYW1lU3RhdGUpO1xufTtcblxuR2x0ZjNEVGlsZUNvbnRlbnQucHJvdG90eXBlLmlzRGVzdHJveWVkID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gZmFsc2U7XG59O1xuXG5HbHRmM0RUaWxlQ29udGVudC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5fbW9kZWwgPSB0aGlzLl9tb2RlbCAmJiB0aGlzLl9tb2RlbC5kZXN0cm95KCk7XG4gIHJldHVybiBkZXN0cm95T2JqZWN0KHRoaXMpO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgR2x0ZjNEVGlsZUNvbnRlbnQ7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///30413\n')},42306:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "Z": function() { return /* binding */ GltfBufferViewLoader; }\n/* harmony export */ });\n/* harmony import */ var _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(66553);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(82982);\n/* harmony import */ var _hasExtension_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(81326);\n/* harmony import */ var _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(13222);\n/* harmony import */ var _ThirdParty_meshoptimizer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(60176);\n/* harmony import */ var _ResourceLoader_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(29789);\n/* harmony import */ var _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(89356);\n\n\n\n\n\n\n\n\n\n/**\n * Loads a glTF buffer view.\n * <p>\n * Implements the {@link ResourceLoader} interface.\n * </p>\n *\n * @alias GltfBufferViewLoader\n * @constructor\n * @augments ResourceLoader\n *\n * @param {Object} options Object with the following properties:\n * @param {ResourceCache} options.resourceCache The {@link ResourceCache} (to avoid circular dependencies).\n * @param {Object} options.gltf The glTF JSON.\n * @param {Number} options.bufferViewId The buffer view ID.\n * @param {Resource} options.gltfResource The {@link Resource} containing the glTF.\n * @param {Resource} options.baseResource The {@link Resource} that paths in the glTF JSON are relative to.\n * @param {String} [options.cacheKey] The cache key of the resource.\n *\n * @private\n */\nfunction GltfBufferViewLoader(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n  var resourceCache = options.resourceCache;\n  var gltf = options.gltf;\n  var bufferViewId = options.bufferViewId;\n  var gltfResource = options.gltfResource;\n  var baseResource = options.baseResource;\n  var cacheKey = options.cacheKey;\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.func */ .Z.typeOf.func("options.resourceCache", resourceCache);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.gltf", gltf);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.number */ .Z.typeOf.number("options.bufferViewId", bufferViewId);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.gltfResource", gltfResource);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.baseResource", baseResource);\n  //>>includeEnd(\'debug\');\n\n  var bufferView = gltf.bufferViews[bufferViewId];\n  var bufferId = bufferView.buffer;\n  var byteOffset = bufferView.byteOffset;\n  var byteLength = bufferView.byteLength;\n\n  var hasMeshopt = false;\n  var meshoptByteStride;\n  var meshoptCount;\n  var meshoptMode;\n  var meshoptFilter;\n\n  if ((0,_hasExtension_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(bufferView, "EXT_meshopt_compression")) {\n    var meshopt = bufferView.extensions.EXT_meshopt_compression;\n    bufferId = meshopt.buffer;\n    byteOffset = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(meshopt.byteOffset, 0);\n    byteLength = meshopt.byteLength;\n\n    hasMeshopt = true;\n    meshoptByteStride = meshopt.byteStride;\n    meshoptCount = meshopt.count;\n    meshoptMode = meshopt.mode;\n    meshoptFilter = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(meshopt.filter, "NONE");\n  }\n\n  var buffer = gltf.buffers[bufferId];\n\n  this._hasMeshopt = hasMeshopt;\n  this._meshoptByteStride = meshoptByteStride;\n  this._meshoptCount = meshoptCount;\n  this._meshoptMode = meshoptMode;\n  this._meshoptFilter = meshoptFilter;\n\n  this._resourceCache = resourceCache;\n  this._gltfResource = gltfResource;\n  this._baseResource = baseResource;\n  this._buffer = buffer;\n  this._bufferId = bufferId;\n  this._byteOffset = byteOffset;\n  this._byteLength = byteLength;\n  this._cacheKey = cacheKey;\n  this._bufferLoader = undefined;\n  this._typedArray = undefined;\n  this._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].UNLOADED */ .Z.UNLOADED;\n  this._promise = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].defer */ .Z.defer();\n}\n\nif ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(Object.create)) {\n  GltfBufferViewLoader.prototype = Object.create(_ResourceLoader_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].prototype */ .Z.prototype);\n  GltfBufferViewLoader.prototype.constructor = GltfBufferViewLoader;\n}\n\nObject.defineProperties(GltfBufferViewLoader.prototype, {\n  /**\n   * A promise that resolves to the resource when the resource is ready.\n   *\n   * @memberof GltfBufferViewLoader.prototype\n   *\n   * @type {Promise.<GltfBufferViewLoader>}\n   * @readonly\n   * @private\n   */\n  promise: {\n    get: function () {\n      return this._promise.promise;\n    },\n  },\n  /**\n   * The cache key of the resource.\n   *\n   * @memberof GltfBufferViewLoader.prototype\n   *\n   * @type {String}\n   * @readonly\n   * @private\n   */\n  cacheKey: {\n    get: function () {\n      return this._cacheKey;\n    },\n  },\n  /**\n   * The typed array containing buffer view data.\n   *\n   * @memberof GltfBufferViewLoader.prototype\n   *\n   * @type {Uint8Array}\n   * @readonly\n   * @private\n   */\n  typedArray: {\n    get: function () {\n      return this._typedArray;\n    },\n  },\n});\n\n/**\n * Loads the resource.\n * @private\n */\nGltfBufferViewLoader.prototype.load = function () {\n  var bufferLoader = getBufferLoader(this);\n  this._bufferLoader = bufferLoader;\n  this._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].LOADING */ .Z.LOADING;\n\n  var that = this;\n\n  bufferLoader.promise\n    .then(function () {\n      if (that.isDestroyed()) {\n        return;\n      }\n      var bufferTypedArray = bufferLoader.typedArray;\n      var bufferViewTypedArray = new Uint8Array(\n        bufferTypedArray.buffer,\n        bufferTypedArray.byteOffset + that._byteOffset,\n        that._byteLength\n      );\n\n      // Unload the buffer\n      that.unload();\n\n      that._typedArray = bufferViewTypedArray;\n      if (that._hasMeshopt) {\n        that._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].PROCESSING */ .Z.PROCESSING;\n      } else {\n        that._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].READY */ .Z.READY;\n        that._promise.resolve(that);\n      }\n    })\n    .otherwise(function (error) {\n      if (that.isDestroyed()) {\n        return;\n      }\n      that.unload();\n      that._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].FAILED */ .Z.FAILED;\n      var errorMessage = "Failed to load buffer view";\n      that._promise.reject(that.getError(errorMessage, error));\n    });\n};\n\nfunction getBufferLoader(bufferViewLoader) {\n  var resourceCache = bufferViewLoader._resourceCache;\n  var buffer = bufferViewLoader._buffer;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(buffer.uri)) {\n    var baseResource = bufferViewLoader._baseResource;\n    var resource = baseResource.getDerivedResource({\n      url: buffer.uri,\n    });\n    return resourceCache.loadExternalBuffer({\n      resource: resource,\n    });\n  }\n  return resourceCache.loadEmbeddedBuffer({\n    parentResource: bufferViewLoader._gltfResource,\n    bufferId: bufferViewLoader._bufferId,\n  });\n}\n\n/**\n * Processes the resources. For a BufferView that does not have the EXT_meshopt_compression extension, there\n * is no processing that needs to happen, so this function returns immediately.\n *\n * @param {FrameState} frameState The frame state.\n */\nGltfBufferViewLoader.prototype.process = function (frameState) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("frameState", frameState);\n  //>>includeEnd(\'debug\');\n\n  if (!this._hasMeshopt) {\n    return;\n  }\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(this._typedArray)) {\n    return;\n  }\n\n  if (this._state !== _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].PROCESSING */ .Z.PROCESSING) {\n    return;\n  }\n\n  var count = this._meshoptCount;\n  var byteStride = this._meshoptByteStride;\n  var result = new Uint8Array(count * byteStride);\n  _ThirdParty_meshoptimizer_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].decodeGltfBuffer */ .Z.decodeGltfBuffer(\n    result,\n    count,\n    byteStride,\n    this._typedArray,\n    this._meshoptMode,\n    this._meshoptFilter\n  );\n\n  this._typedArray = result;\n  this._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].READY */ .Z.READY;\n  this._promise.resolve(this);\n};\n\n/**\n * Unloads the resource.\n * @private\n */\nGltfBufferViewLoader.prototype.unload = function () {\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(this._bufferLoader)) {\n    this._resourceCache.unload(this._bufferLoader);\n  }\n\n  this._bufferLoader = undefined;\n  this._typedArray = undefined;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92dWUzLXdlYnBhY2s1Ly4vbm9kZV9tb2R1bGVzL2Nlc2l1bS9Tb3VyY2UvU2NlbmUvR2x0ZkJ1ZmZlclZpZXdMb2FkZXIuanM/ZWFhMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ2hlY2sgZnJvbSBcIi4uL0NvcmUvQ2hlY2suanNcIjtcbmltcG9ydCBkZWZhdWx0VmFsdWUgZnJvbSBcIi4uL0NvcmUvZGVmYXVsdFZhbHVlLmpzXCI7XG5pbXBvcnQgZGVmaW5lZCBmcm9tIFwiLi4vQ29yZS9kZWZpbmVkLmpzXCI7XG5pbXBvcnQgaGFzRXh0ZW5zaW9uIGZyb20gXCIuL2hhc0V4dGVuc2lvbi5qc1wiO1xuaW1wb3J0IHdoZW4gZnJvbSBcIi4uL1RoaXJkUGFydHkvd2hlbi5qc1wiO1xuaW1wb3J0IE1lc2hvcHREZWNvZGVyIGZyb20gXCIuLi9UaGlyZFBhcnR5L21lc2hvcHRpbWl6ZXIuanNcIjtcbmltcG9ydCBSZXNvdXJjZUxvYWRlciBmcm9tIFwiLi9SZXNvdXJjZUxvYWRlci5qc1wiO1xuaW1wb3J0IFJlc291cmNlTG9hZGVyU3RhdGUgZnJvbSBcIi4vUmVzb3VyY2VMb2FkZXJTdGF0ZS5qc1wiO1xuXG4vKipcbiAqIExvYWRzIGEgZ2xURiBidWZmZXIgdmlldy5cbiAqIDxwPlxuICogSW1wbGVtZW50cyB0aGUge0BsaW5rIFJlc291cmNlTG9hZGVyfSBpbnRlcmZhY2UuXG4gKiA8L3A+XG4gKlxuICogQGFsaWFzIEdsdGZCdWZmZXJWaWV3TG9hZGVyXG4gKiBAY29uc3RydWN0b3JcbiAqIEBhdWdtZW50cyBSZXNvdXJjZUxvYWRlclxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIE9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqIEBwYXJhbSB7UmVzb3VyY2VDYWNoZX0gb3B0aW9ucy5yZXNvdXJjZUNhY2hlIFRoZSB7QGxpbmsgUmVzb3VyY2VDYWNoZX0gKHRvIGF2b2lkIGNpcmN1bGFyIGRlcGVuZGVuY2llcykuXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucy5nbHRmIFRoZSBnbFRGIEpTT04uXG4gKiBAcGFyYW0ge051bWJlcn0gb3B0aW9ucy5idWZmZXJWaWV3SWQgVGhlIGJ1ZmZlciB2aWV3IElELlxuICogQHBhcmFtIHtSZXNvdXJjZX0gb3B0aW9ucy5nbHRmUmVzb3VyY2UgVGhlIHtAbGluayBSZXNvdXJjZX0gY29udGFpbmluZyB0aGUgZ2xURi5cbiAqIEBwYXJhbSB7UmVzb3VyY2V9IG9wdGlvbnMuYmFzZVJlc291cmNlIFRoZSB7QGxpbmsgUmVzb3VyY2V9IHRoYXQgcGF0aHMgaW4gdGhlIGdsVEYgSlNPTiBhcmUgcmVsYXRpdmUgdG8uXG4gKiBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMuY2FjaGVLZXldIFRoZSBjYWNoZSBrZXkgb2YgdGhlIHJlc291cmNlLlxuICpcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIEdsdGZCdWZmZXJWaWV3TG9hZGVyKG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLCBkZWZhdWx0VmFsdWUuRU1QVFlfT0JKRUNUKTtcbiAgdmFyIHJlc291cmNlQ2FjaGUgPSBvcHRpb25zLnJlc291cmNlQ2FjaGU7XG4gIHZhciBnbHRmID0gb3B0aW9ucy5nbHRmO1xuICB2YXIgYnVmZmVyVmlld0lkID0gb3B0aW9ucy5idWZmZXJWaWV3SWQ7XG4gIHZhciBnbHRmUmVzb3VyY2UgPSBvcHRpb25zLmdsdGZSZXNvdXJjZTtcbiAgdmFyIGJhc2VSZXNvdXJjZSA9IG9wdGlvbnMuYmFzZVJlc291cmNlO1xuICB2YXIgY2FjaGVLZXkgPSBvcHRpb25zLmNhY2hlS2V5O1xuXG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLnR5cGVPZi5mdW5jKFwib3B0aW9ucy5yZXNvdXJjZUNhY2hlXCIsIHJlc291cmNlQ2FjaGUpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwib3B0aW9ucy5nbHRmXCIsIGdsdGYpO1xuICBDaGVjay50eXBlT2YubnVtYmVyKFwib3B0aW9ucy5idWZmZXJWaWV3SWRcIiwgYnVmZmVyVmlld0lkKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcIm9wdGlvbnMuZ2x0ZlJlc291cmNlXCIsIGdsdGZSZXNvdXJjZSk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJvcHRpb25zLmJhc2VSZXNvdXJjZVwiLCBiYXNlUmVzb3VyY2UpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB2YXIgYnVmZmVyVmlldyA9IGdsdGYuYnVmZmVyVmlld3NbYnVmZmVyVmlld0lkXTtcbiAgdmFyIGJ1ZmZlcklkID0gYnVmZmVyVmlldy5idWZmZXI7XG4gIHZhciBieXRlT2Zmc2V0ID0gYnVmZmVyVmlldy5ieXRlT2Zmc2V0O1xuICB2YXIgYnl0ZUxlbmd0aCA9IGJ1ZmZlclZpZXcuYnl0ZUxlbmd0aDtcblxuICB2YXIgaGFzTWVzaG9wdCA9IGZhbHNlO1xuICB2YXIgbWVzaG9wdEJ5dGVTdHJpZGU7XG4gIHZhciBtZXNob3B0Q291bnQ7XG4gIHZhciBtZXNob3B0TW9kZTtcbiAgdmFyIG1lc2hvcHRGaWx0ZXI7XG5cbiAgaWYgKGhhc0V4dGVuc2lvbihidWZmZXJWaWV3LCBcIkVYVF9tZXNob3B0X2NvbXByZXNzaW9uXCIpKSB7XG4gICAgdmFyIG1lc2hvcHQgPSBidWZmZXJWaWV3LmV4dGVuc2lvbnMuRVhUX21lc2hvcHRfY29tcHJlc3Npb247XG4gICAgYnVmZmVySWQgPSBtZXNob3B0LmJ1ZmZlcjtcbiAgICBieXRlT2Zmc2V0ID0gZGVmYXVsdFZhbHVlKG1lc2hvcHQuYnl0ZU9mZnNldCwgMCk7XG4gICAgYnl0ZUxlbmd0aCA9IG1lc2hvcHQuYnl0ZUxlbmd0aDtcblxuICAgIGhhc01lc2hvcHQgPSB0cnVlO1xuICAgIG1lc2hvcHRCeXRlU3RyaWRlID0gbWVzaG9wdC5ieXRlU3RyaWRlO1xuICAgIG1lc2hvcHRDb3VudCA9IG1lc2hvcHQuY291bnQ7XG4gICAgbWVzaG9wdE1vZGUgPSBtZXNob3B0Lm1vZGU7XG4gICAgbWVzaG9wdEZpbHRlciA9IGRlZmF1bHRWYWx1ZShtZXNob3B0LmZpbHRlciwgXCJOT05FXCIpO1xuICB9XG5cbiAgdmFyIGJ1ZmZlciA9IGdsdGYuYnVmZmVyc1tidWZmZXJJZF07XG5cbiAgdGhpcy5faGFzTWVzaG9wdCA9IGhhc01lc2hvcHQ7XG4gIHRoaXMuX21lc2hvcHRCeXRlU3RyaWRlID0gbWVzaG9wdEJ5dGVTdHJpZGU7XG4gIHRoaXMuX21lc2hvcHRDb3VudCA9IG1lc2hvcHRDb3VudDtcbiAgdGhpcy5fbWVzaG9wdE1vZGUgPSBtZXNob3B0TW9kZTtcbiAgdGhpcy5fbWVzaG9wdEZpbHRlciA9IG1lc2hvcHRGaWx0ZXI7XG5cbiAgdGhpcy5fcmVzb3VyY2VDYWNoZSA9IHJlc291cmNlQ2FjaGU7XG4gIHRoaXMuX2dsdGZSZXNvdXJjZSA9IGdsdGZSZXNvdXJjZTtcbiAgdGhpcy5fYmFzZVJlc291cmNlID0gYmFzZVJlc291cmNlO1xuICB0aGlzLl9idWZmZXIgPSBidWZmZXI7XG4gIHRoaXMuX2J1ZmZlcklkID0gYnVmZmVySWQ7XG4gIHRoaXMuX2J5dGVPZmZzZXQgPSBieXRlT2Zmc2V0O1xuICB0aGlzLl9ieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aDtcbiAgdGhpcy5fY2FjaGVLZXkgPSBjYWNoZUtleTtcbiAgdGhpcy5fYnVmZmVyTG9hZGVyID0gdW5kZWZpbmVkO1xuICB0aGlzLl90eXBlZEFycmF5ID0gdW5kZWZpbmVkO1xuICB0aGlzLl9zdGF0ZSA9IFJlc291cmNlTG9hZGVyU3RhdGUuVU5MT0FERUQ7XG4gIHRoaXMuX3Byb21pc2UgPSB3aGVuLmRlZmVyKCk7XG59XG5cbmlmIChkZWZpbmVkKE9iamVjdC5jcmVhdGUpKSB7XG4gIEdsdGZCdWZmZXJWaWV3TG9hZGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUmVzb3VyY2VMb2FkZXIucHJvdG90eXBlKTtcbiAgR2x0ZkJ1ZmZlclZpZXdMb2FkZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gR2x0ZkJ1ZmZlclZpZXdMb2FkZXI7XG59XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKEdsdGZCdWZmZXJWaWV3TG9hZGVyLnByb3RvdHlwZSwge1xuICAvKipcbiAgICogQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc291cmNlIHdoZW4gdGhlIHJlc291cmNlIGlzIHJlYWR5LlxuICAgKlxuICAgKiBAbWVtYmVyb2YgR2x0ZkJ1ZmZlclZpZXdMb2FkZXIucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtQcm9taXNlLjxHbHRmQnVmZmVyVmlld0xvYWRlcj59XG4gICAqIEByZWFkb25seVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJvbWlzZToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3Byb21pc2UucHJvbWlzZTtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogVGhlIGNhY2hlIGtleSBvZiB0aGUgcmVzb3VyY2UuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBHbHRmQnVmZmVyVmlld0xvYWRlci5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge1N0cmluZ31cbiAgICogQHJlYWRvbmx5XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBjYWNoZUtleToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlS2V5O1xuICAgIH0sXG4gIH0sXG4gIC8qKlxuICAgKiBUaGUgdHlwZWQgYXJyYXkgY29udGFpbmluZyBidWZmZXIgdmlldyBkYXRhLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgR2x0ZkJ1ZmZlclZpZXdMb2FkZXIucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtVaW50OEFycmF5fVxuICAgKiBAcmVhZG9ubHlcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHR5cGVkQXJyYXk6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl90eXBlZEFycmF5O1xuICAgIH0sXG4gIH0sXG59KTtcblxuLyoqXG4gKiBMb2FkcyB0aGUgcmVzb3VyY2UuXG4gKiBAcHJpdmF0ZVxuICovXG5HbHRmQnVmZmVyVmlld0xvYWRlci5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGJ1ZmZlckxvYWRlciA9IGdldEJ1ZmZlckxvYWRlcih0aGlzKTtcbiAgdGhpcy5fYnVmZmVyTG9hZGVyID0gYnVmZmVyTG9hZGVyO1xuICB0aGlzLl9zdGF0ZSA9IFJlc291cmNlTG9hZGVyU3RhdGUuTE9BRElORztcblxuICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgYnVmZmVyTG9hZGVyLnByb21pc2VcbiAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhhdC5pc0Rlc3Ryb3llZCgpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBidWZmZXJUeXBlZEFycmF5ID0gYnVmZmVyTG9hZGVyLnR5cGVkQXJyYXk7XG4gICAgICB2YXIgYnVmZmVyVmlld1R5cGVkQXJyYXkgPSBuZXcgVWludDhBcnJheShcbiAgICAgICAgYnVmZmVyVHlwZWRBcnJheS5idWZmZXIsXG4gICAgICAgIGJ1ZmZlclR5cGVkQXJyYXkuYnl0ZU9mZnNldCArIHRoYXQuX2J5dGVPZmZzZXQsXG4gICAgICAgIHRoYXQuX2J5dGVMZW5ndGhcbiAgICAgICk7XG5cbiAgICAgIC8vIFVubG9hZCB0aGUgYnVmZmVyXG4gICAgICB0aGF0LnVubG9hZCgpO1xuXG4gICAgICB0aGF0Ll90eXBlZEFycmF5ID0gYnVmZmVyVmlld1R5cGVkQXJyYXk7XG4gICAgICBpZiAodGhhdC5faGFzTWVzaG9wdCkge1xuICAgICAgICB0aGF0Ll9zdGF0ZSA9IFJlc291cmNlTG9hZGVyU3RhdGUuUFJPQ0VTU0lORztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoYXQuX3N0YXRlID0gUmVzb3VyY2VMb2FkZXJTdGF0ZS5SRUFEWTtcbiAgICAgICAgdGhhdC5fcHJvbWlzZS5yZXNvbHZlKHRoYXQpO1xuICAgICAgfVxuICAgIH0pXG4gICAgLm90aGVyd2lzZShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgIGlmICh0aGF0LmlzRGVzdHJveWVkKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhhdC51bmxvYWQoKTtcbiAgICAgIHRoYXQuX3N0YXRlID0gUmVzb3VyY2VMb2FkZXJTdGF0ZS5GQUlMRUQ7XG4gICAgICB2YXIgZXJyb3JNZXNzYWdlID0gXCJGYWlsZWQgdG8gbG9hZCBidWZmZXIgdmlld1wiO1xuICAgICAgdGhhdC5fcHJvbWlzZS5yZWplY3QodGhhdC5nZXRFcnJvcihlcnJvck1lc3NhZ2UsIGVycm9yKSk7XG4gICAgfSk7XG59O1xuXG5mdW5jdGlvbiBnZXRCdWZmZXJMb2FkZXIoYnVmZmVyVmlld0xvYWRlcikge1xuICB2YXIgcmVzb3VyY2VDYWNoZSA9IGJ1ZmZlclZpZXdMb2FkZXIuX3Jlc291cmNlQ2FjaGU7XG4gIHZhciBidWZmZXIgPSBidWZmZXJWaWV3TG9hZGVyLl9idWZmZXI7XG4gIGlmIChkZWZpbmVkKGJ1ZmZlci51cmkpKSB7XG4gICAgdmFyIGJhc2VSZXNvdXJjZSA9IGJ1ZmZlclZpZXdMb2FkZXIuX2Jhc2VSZXNvdXJjZTtcbiAgICB2YXIgcmVzb3VyY2UgPSBiYXNlUmVzb3VyY2UuZ2V0RGVyaXZlZFJlc291cmNlKHtcbiAgICAgIHVybDogYnVmZmVyLnVyaSxcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzb3VyY2VDYWNoZS5sb2FkRXh0ZXJuYWxCdWZmZXIoe1xuICAgICAgcmVzb3VyY2U6IHJlc291cmNlLFxuICAgIH0pO1xuICB9XG4gIHJldHVybiByZXNvdXJjZUNhY2hlLmxvYWRFbWJlZGRlZEJ1ZmZlcih7XG4gICAgcGFyZW50UmVzb3VyY2U6IGJ1ZmZlclZpZXdMb2FkZXIuX2dsdGZSZXNvdXJjZSxcbiAgICBidWZmZXJJZDogYnVmZmVyVmlld0xvYWRlci5fYnVmZmVySWQsXG4gIH0pO1xufVxuXG4vKipcbiAqIFByb2Nlc3NlcyB0aGUgcmVzb3VyY2VzLiBGb3IgYSBCdWZmZXJWaWV3IHRoYXQgZG9lcyBub3QgaGF2ZSB0aGUgRVhUX21lc2hvcHRfY29tcHJlc3Npb24gZXh0ZW5zaW9uLCB0aGVyZVxuICogaXMgbm8gcHJvY2Vzc2luZyB0aGF0IG5lZWRzIHRvIGhhcHBlbiwgc28gdGhpcyBmdW5jdGlvbiByZXR1cm5zIGltbWVkaWF0ZWx5LlxuICpcbiAqIEBwYXJhbSB7RnJhbWVTdGF0ZX0gZnJhbWVTdGF0ZSBUaGUgZnJhbWUgc3RhdGUuXG4gKi9cbkdsdGZCdWZmZXJWaWV3TG9hZGVyLnByb3RvdHlwZS5wcm9jZXNzID0gZnVuY3Rpb24gKGZyYW1lU3RhdGUpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcImZyYW1lU3RhdGVcIiwgZnJhbWVTdGF0ZSk7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIGlmICghdGhpcy5faGFzTWVzaG9wdCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICghZGVmaW5lZCh0aGlzLl90eXBlZEFycmF5KSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICh0aGlzLl9zdGF0ZSAhPT0gUmVzb3VyY2VMb2FkZXJTdGF0ZS5QUk9DRVNTSU5HKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGNvdW50ID0gdGhpcy5fbWVzaG9wdENvdW50O1xuICB2YXIgYnl0ZVN0cmlkZSA9IHRoaXMuX21lc2hvcHRCeXRlU3RyaWRlO1xuICB2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkoY291bnQgKiBieXRlU3RyaWRlKTtcbiAgTWVzaG9wdERlY29kZXIuZGVjb2RlR2x0ZkJ1ZmZlcihcbiAgICByZXN1bHQsXG4gICAgY291bnQsXG4gICAgYnl0ZVN0cmlkZSxcbiAgICB0aGlzLl90eXBlZEFycmF5LFxuICAgIHRoaXMuX21lc2hvcHRNb2RlLFxuICAgIHRoaXMuX21lc2hvcHRGaWx0ZXJcbiAgKTtcblxuICB0aGlzLl90eXBlZEFycmF5ID0gcmVzdWx0O1xuICB0aGlzLl9zdGF0ZSA9IFJlc291cmNlTG9hZGVyU3RhdGUuUkVBRFk7XG4gIHRoaXMuX3Byb21pc2UucmVzb2x2ZSh0aGlzKTtcbn07XG5cbi8qKlxuICogVW5sb2FkcyB0aGUgcmVzb3VyY2UuXG4gKiBAcHJpdmF0ZVxuICovXG5HbHRmQnVmZmVyVmlld0xvYWRlci5wcm90b3R5cGUudW5sb2FkID0gZnVuY3Rpb24gKCkge1xuICBpZiAoZGVmaW5lZCh0aGlzLl9idWZmZXJMb2FkZXIpKSB7XG4gICAgdGhpcy5fcmVzb3VyY2VDYWNoZS51bmxvYWQodGhpcy5fYnVmZmVyTG9hZGVyKTtcbiAgfVxuXG4gIHRoaXMuX2J1ZmZlckxvYWRlciA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fdHlwZWRBcnJheSA9IHVuZGVmaW5lZDtcbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///42306\n')},69179:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "Z": function() { return /* binding */ GltfDracoLoader; }\n/* harmony export */ });\n/* harmony import */ var _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(66553);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(82982);\n/* harmony import */ var _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(13222);\n/* harmony import */ var _DracoLoader_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(8056);\n/* harmony import */ var _ResourceLoader_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(29789);\n/* harmony import */ var _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(89356);\n\n\n\n\n\n\n\n\n/**\n * Load a draco buffer from a glTF.\n * <p>\n * Implements the {@link ResourceLoader} interface.\n * </p>\n *\n * @alias GltfDracoLoader\n * @constructor\n * @augments ResourceLoader\n *\n * @param {Object} options Object with the following properties:\n * @param {ResourceCache} options.resourceCache The {@link ResourceCache} (to avoid circular dependencies).\n * @param {Object} options.gltf The glTF JSON.\n * @param {Object} options.draco The Draco extension object.\n * @param {Resource} options.gltfResource The {@link Resource} containing the glTF.\n * @param {Resource} options.baseResource The {@link Resource} that paths in the glTF JSON are relative to.\n * @param {String} [options.cacheKey] The cache key of the resource.\n *\n * @private\n */\nfunction GltfDracoLoader(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n  var resourceCache = options.resourceCache;\n  var gltf = options.gltf;\n  var draco = options.draco;\n  var gltfResource = options.gltfResource;\n  var baseResource = options.baseResource;\n  var cacheKey = options.cacheKey;\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.func */ .Z.typeOf.func("options.resourceCache", resourceCache);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.gltf", gltf);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.draco", draco);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.gltfResource", gltfResource);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.baseResource", baseResource);\n  //>>includeEnd(\'debug\');\n\n  this._resourceCache = resourceCache;\n  this._gltfResource = gltfResource;\n  this._baseResource = baseResource;\n  this._gltf = gltf;\n  this._draco = draco;\n  this._cacheKey = cacheKey;\n  this._bufferViewLoader = undefined;\n  this._bufferViewTypedArray = undefined;\n  this._decodePromise = undefined;\n  this._decodedData = undefined;\n  this._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].UNLOADED */ .Z.UNLOADED;\n  this._promise = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].defer */ .Z.defer();\n}\n\nif ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(Object.create)) {\n  GltfDracoLoader.prototype = Object.create(_ResourceLoader_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].prototype */ .Z.prototype);\n  GltfDracoLoader.prototype.constructor = GltfDracoLoader;\n}\n\nObject.defineProperties(GltfDracoLoader.prototype, {\n  /**\n   * A promise that resolves to the resource when the resource is ready.\n   *\n   * @memberof GltfDracoLoader.prototype\n   *\n   * @type {Promise.<GltfDracoLoader>}\n   * @readonly\n   * @private\n   */\n  promise: {\n    get: function () {\n      return this._promise.promise;\n    },\n  },\n  /**\n   * The cache key of the resource.\n   *\n   * @memberof GltfDracoLoader.prototype\n   *\n   * @type {String}\n   * @readonly\n   * @private\n   */\n  cacheKey: {\n    get: function () {\n      return this._cacheKey;\n    },\n  },\n  /**\n   * The decoded data.\n   *\n   * @memberof GltfDracoLoader.prototype\n   *\n   * @type {Object}\n   * @readonly\n   * @private\n   */\n  decodedData: {\n    get: function () {\n      return this._decodedData;\n    },\n  },\n});\n\n/**\n * Loads the resource.\n * @private\n */\nGltfDracoLoader.prototype.load = function () {\n  var resourceCache = this._resourceCache;\n  var bufferViewLoader = resourceCache.loadBufferView({\n    gltf: this._gltf,\n    bufferViewId: this._draco.bufferView,\n    gltfResource: this._gltfResource,\n    baseResource: this._baseResource,\n  });\n\n  this._bufferViewLoader = bufferViewLoader;\n  this._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].LOADING */ .Z.LOADING;\n\n  var that = this;\n\n  bufferViewLoader.promise\n    .then(function () {\n      if (that.isDestroyed()) {\n        return;\n      }\n      // Now wait for process() to run to finish loading\n      that._bufferViewTypedArray = bufferViewLoader.typedArray;\n      that._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].PROCESSING */ .Z.PROCESSING;\n    })\n    .otherwise(function (error) {\n      if (that.isDestroyed()) {\n        return;\n      }\n      handleError(that, error);\n    });\n};\n\nfunction handleError(dracoLoader, error) {\n  dracoLoader.unload();\n  dracoLoader._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].FAILED */ .Z.FAILED;\n  var errorMessage = "Failed to load Draco";\n  dracoLoader._promise.reject(dracoLoader.getError(errorMessage, error));\n}\n\n/**\n * Processes the resource until it becomes ready.\n *\n * @param {FrameState} frameState The frame state.\n * @private\n */\nGltfDracoLoader.prototype.process = function (frameState) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("frameState", frameState);\n  //>>includeEnd(\'debug\');\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(this._bufferViewTypedArray)) {\n    // Not ready to decode the Draco buffer\n    return;\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(this._decodePromise)) {\n    // Currently decoding\n    return;\n  }\n\n  var draco = this._draco;\n  var gltf = this._gltf;\n  var bufferViews = gltf.bufferViews;\n  var bufferViewId = draco.bufferView;\n  var bufferView = bufferViews[bufferViewId];\n  var compressedAttributes = draco.attributes;\n\n  var decodeOptions = {\n    array: this._bufferViewTypedArray,\n    bufferView: bufferView,\n    compressedAttributes: compressedAttributes,\n    dequantizeInShader: true,\n  };\n\n  var decodePromise = _DracoLoader_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].decodeBufferView */ .Z.decodeBufferView(decodeOptions);\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(decodePromise)) {\n    // Cannot schedule task this frame\n    return;\n  }\n\n  var that = this;\n  this._decodePromise = decodePromise\n    .then(function (results) {\n      if (that.isDestroyed()) {\n        return;\n      }\n      // Unload everything except the decoded data\n      that.unload();\n\n      that._decodedData = {\n        indices: results.indexArray,\n        vertexAttributes: results.attributeData,\n      };\n      that._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].READY */ .Z.READY;\n      that._promise.resolve(that);\n    })\n    .otherwise(function (error) {\n      if (that.isDestroyed()) {\n        return;\n      }\n      handleError(that, error);\n    });\n};\n\n/**\n * Unloads the resource.\n * @private\n */\nGltfDracoLoader.prototype.unload = function () {\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(this._bufferViewLoader)) {\n    this._resourceCache.unload(this._bufferViewLoader);\n  }\n\n  this._bufferViewLoader = undefined;\n  this._bufferViewTypedArray = undefined;\n  this._decodedData = undefined;\n  this._gltf = undefined;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjkxNzkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFxQztBQUNjO0FBQ1Y7QUFDQTtBQUNFO0FBQ007QUFDVTs7QUFFM0Q7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHNCQUFzQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsV0FBVyxlQUFlLDJCQUEyQixxQkFBcUI7QUFDMUUsV0FBVyxRQUFRO0FBQ25CLFdBQVcsUUFBUTtBQUNuQixXQUFXLFVBQVUsMEJBQTBCLGdCQUFnQjtBQUMvRCxXQUFXLFVBQVUsMEJBQTBCLGdCQUFnQjtBQUMvRCxXQUFXLFFBQVE7QUFDbkI7QUFDQTtBQUNBO0FBQ2U7QUFDZixZQUFZLDBFQUFZLFVBQVUsZ0dBQXlCO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUUsdUZBQWlCO0FBQ25CLEVBQUUsMkZBQW1CO0FBQ3JCLEVBQUUsMkZBQW1CO0FBQ3JCLEVBQUUsMkZBQW1CO0FBQ3JCLEVBQUUsMkZBQW1CO0FBQ3JCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDBGQUE0QjtBQUM1QyxrQkFBa0IsZ0ZBQVU7QUFDNUI7O0FBRUEsSUFBSSxxRUFBTztBQUNYLDRDQUE0Qyx1RkFBd0I7QUFDcEU7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNILENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQSxnQkFBZ0Isd0ZBQTJCOztBQUUzQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiw4RkFBOEI7QUFDbEQsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBLHVCQUF1QixzRkFBMEI7QUFDakQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsWUFBWTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUUsMkZBQW1CO0FBQ3JCOztBQUVBLE9BQU8scUVBQU87QUFDZDtBQUNBO0FBQ0E7O0FBRUEsTUFBTSxxRUFBTztBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHNCQUFzQixrR0FBNEI7O0FBRWxELE9BQU8scUVBQU87QUFDZDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixvRkFBeUI7QUFDN0M7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxxRUFBTztBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL3Z1ZTMtd2VicGFjazUvLi9ub2RlX21vZHVsZXMvY2VzaXVtL1NvdXJjZS9TY2VuZS9HbHRmRHJhY29Mb2FkZXIuanM/NWZiZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ2hlY2sgZnJvbSBcIi4uL0NvcmUvQ2hlY2suanNcIjtcbmltcG9ydCBkZWZhdWx0VmFsdWUgZnJvbSBcIi4uL0NvcmUvZGVmYXVsdFZhbHVlLmpzXCI7XG5pbXBvcnQgZGVmaW5lZCBmcm9tIFwiLi4vQ29yZS9kZWZpbmVkLmpzXCI7XG5pbXBvcnQgd2hlbiBmcm9tIFwiLi4vVGhpcmRQYXJ0eS93aGVuLmpzXCI7XG5pbXBvcnQgRHJhY29Mb2FkZXIgZnJvbSBcIi4vRHJhY29Mb2FkZXIuanNcIjtcbmltcG9ydCBSZXNvdXJjZUxvYWRlciBmcm9tIFwiLi9SZXNvdXJjZUxvYWRlci5qc1wiO1xuaW1wb3J0IFJlc291cmNlTG9hZGVyU3RhdGUgZnJvbSBcIi4vUmVzb3VyY2VMb2FkZXJTdGF0ZS5qc1wiO1xuXG4vKipcbiAqIExvYWQgYSBkcmFjbyBidWZmZXIgZnJvbSBhIGdsVEYuXG4gKiA8cD5cbiAqIEltcGxlbWVudHMgdGhlIHtAbGluayBSZXNvdXJjZUxvYWRlcn0gaW50ZXJmYWNlLlxuICogPC9wPlxuICpcbiAqIEBhbGlhcyBHbHRmRHJhY29Mb2FkZXJcbiAqIEBjb25zdHJ1Y3RvclxuICogQGF1Z21lbnRzIFJlc291cmNlTG9hZGVyXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgT2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxuICogQHBhcmFtIHtSZXNvdXJjZUNhY2hlfSBvcHRpb25zLnJlc291cmNlQ2FjaGUgVGhlIHtAbGluayBSZXNvdXJjZUNhY2hlfSAodG8gYXZvaWQgY2lyY3VsYXIgZGVwZW5kZW5jaWVzKS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLmdsdGYgVGhlIGdsVEYgSlNPTi5cbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLmRyYWNvIFRoZSBEcmFjbyBleHRlbnNpb24gb2JqZWN0LlxuICogQHBhcmFtIHtSZXNvdXJjZX0gb3B0aW9ucy5nbHRmUmVzb3VyY2UgVGhlIHtAbGluayBSZXNvdXJjZX0gY29udGFpbmluZyB0aGUgZ2xURi5cbiAqIEBwYXJhbSB7UmVzb3VyY2V9IG9wdGlvbnMuYmFzZVJlc291cmNlIFRoZSB7QGxpbmsgUmVzb3VyY2V9IHRoYXQgcGF0aHMgaW4gdGhlIGdsVEYgSlNPTiBhcmUgcmVsYXRpdmUgdG8uXG4gKiBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMuY2FjaGVLZXldIFRoZSBjYWNoZSBrZXkgb2YgdGhlIHJlc291cmNlLlxuICpcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIEdsdGZEcmFjb0xvYWRlcihvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBkZWZhdWx0VmFsdWUob3B0aW9ucywgZGVmYXVsdFZhbHVlLkVNUFRZX09CSkVDVCk7XG4gIHZhciByZXNvdXJjZUNhY2hlID0gb3B0aW9ucy5yZXNvdXJjZUNhY2hlO1xuICB2YXIgZ2x0ZiA9IG9wdGlvbnMuZ2x0ZjtcbiAgdmFyIGRyYWNvID0gb3B0aW9ucy5kcmFjbztcbiAgdmFyIGdsdGZSZXNvdXJjZSA9IG9wdGlvbnMuZ2x0ZlJlc291cmNlO1xuICB2YXIgYmFzZVJlc291cmNlID0gb3B0aW9ucy5iYXNlUmVzb3VyY2U7XG4gIHZhciBjYWNoZUtleSA9IG9wdGlvbnMuY2FjaGVLZXk7XG5cbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLmZ1bmMoXCJvcHRpb25zLnJlc291cmNlQ2FjaGVcIiwgcmVzb3VyY2VDYWNoZSk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJvcHRpb25zLmdsdGZcIiwgZ2x0Zik7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJvcHRpb25zLmRyYWNvXCIsIGRyYWNvKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcIm9wdGlvbnMuZ2x0ZlJlc291cmNlXCIsIGdsdGZSZXNvdXJjZSk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJvcHRpb25zLmJhc2VSZXNvdXJjZVwiLCBiYXNlUmVzb3VyY2UpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB0aGlzLl9yZXNvdXJjZUNhY2hlID0gcmVzb3VyY2VDYWNoZTtcbiAgdGhpcy5fZ2x0ZlJlc291cmNlID0gZ2x0ZlJlc291cmNlO1xuICB0aGlzLl9iYXNlUmVzb3VyY2UgPSBiYXNlUmVzb3VyY2U7XG4gIHRoaXMuX2dsdGYgPSBnbHRmO1xuICB0aGlzLl9kcmFjbyA9IGRyYWNvO1xuICB0aGlzLl9jYWNoZUtleSA9IGNhY2hlS2V5O1xuICB0aGlzLl9idWZmZXJWaWV3TG9hZGVyID0gdW5kZWZpbmVkO1xuICB0aGlzLl9idWZmZXJWaWV3VHlwZWRBcnJheSA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fZGVjb2RlUHJvbWlzZSA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fZGVjb2RlZERhdGEgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX3N0YXRlID0gUmVzb3VyY2VMb2FkZXJTdGF0ZS5VTkxPQURFRDtcbiAgdGhpcy5fcHJvbWlzZSA9IHdoZW4uZGVmZXIoKTtcbn1cblxuaWYgKGRlZmluZWQoT2JqZWN0LmNyZWF0ZSkpIHtcbiAgR2x0ZkRyYWNvTG9hZGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUmVzb3VyY2VMb2FkZXIucHJvdG90eXBlKTtcbiAgR2x0ZkRyYWNvTG9hZGVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEdsdGZEcmFjb0xvYWRlcjtcbn1cblxuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoR2x0ZkRyYWNvTG9hZGVyLnByb3RvdHlwZSwge1xuICAvKipcbiAgICogQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc291cmNlIHdoZW4gdGhlIHJlc291cmNlIGlzIHJlYWR5LlxuICAgKlxuICAgKiBAbWVtYmVyb2YgR2x0ZkRyYWNvTG9hZGVyLnByb3RvdHlwZVxuICAgKlxuICAgKiBAdHlwZSB7UHJvbWlzZS48R2x0ZkRyYWNvTG9hZGVyPn1cbiAgICogQHJlYWRvbmx5XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcm9taXNlOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcHJvbWlzZS5wcm9taXNlO1xuICAgIH0sXG4gIH0sXG4gIC8qKlxuICAgKiBUaGUgY2FjaGUga2V5IG9mIHRoZSByZXNvdXJjZS5cbiAgICpcbiAgICogQG1lbWJlcm9mIEdsdGZEcmFjb0xvYWRlci5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge1N0cmluZ31cbiAgICogQHJlYWRvbmx5XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBjYWNoZUtleToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlS2V5O1xuICAgIH0sXG4gIH0sXG4gIC8qKlxuICAgKiBUaGUgZGVjb2RlZCBkYXRhLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgR2x0ZkRyYWNvTG9hZGVyLnByb3RvdHlwZVxuICAgKlxuICAgKiBAdHlwZSB7T2JqZWN0fVxuICAgKiBAcmVhZG9ubHlcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGRlY29kZWREYXRhOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZGVjb2RlZERhdGE7XG4gICAgfSxcbiAgfSxcbn0pO1xuXG4vKipcbiAqIExvYWRzIHRoZSByZXNvdXJjZS5cbiAqIEBwcml2YXRlXG4gKi9cbkdsdGZEcmFjb0xvYWRlci5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHJlc291cmNlQ2FjaGUgPSB0aGlzLl9yZXNvdXJjZUNhY2hlO1xuICB2YXIgYnVmZmVyVmlld0xvYWRlciA9IHJlc291cmNlQ2FjaGUubG9hZEJ1ZmZlclZpZXcoe1xuICAgIGdsdGY6IHRoaXMuX2dsdGYsXG4gICAgYnVmZmVyVmlld0lkOiB0aGlzLl9kcmFjby5idWZmZXJWaWV3LFxuICAgIGdsdGZSZXNvdXJjZTogdGhpcy5fZ2x0ZlJlc291cmNlLFxuICAgIGJhc2VSZXNvdXJjZTogdGhpcy5fYmFzZVJlc291cmNlLFxuICB9KTtcblxuICB0aGlzLl9idWZmZXJWaWV3TG9hZGVyID0gYnVmZmVyVmlld0xvYWRlcjtcbiAgdGhpcy5fc3RhdGUgPSBSZXNvdXJjZUxvYWRlclN0YXRlLkxPQURJTkc7XG5cbiAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gIGJ1ZmZlclZpZXdMb2FkZXIucHJvbWlzZVxuICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh0aGF0LmlzRGVzdHJveWVkKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgLy8gTm93IHdhaXQgZm9yIHByb2Nlc3MoKSB0byBydW4gdG8gZmluaXNoIGxvYWRpbmdcbiAgICAgIHRoYXQuX2J1ZmZlclZpZXdUeXBlZEFycmF5ID0gYnVmZmVyVmlld0xvYWRlci50eXBlZEFycmF5O1xuICAgICAgdGhhdC5fc3RhdGUgPSBSZXNvdXJjZUxvYWRlclN0YXRlLlBST0NFU1NJTkc7XG4gICAgfSlcbiAgICAub3RoZXJ3aXNlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgaWYgKHRoYXQuaXNEZXN0cm95ZWQoKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBoYW5kbGVFcnJvcih0aGF0LCBlcnJvcik7XG4gICAgfSk7XG59O1xuXG5mdW5jdGlvbiBoYW5kbGVFcnJvcihkcmFjb0xvYWRlciwgZXJyb3IpIHtcbiAgZHJhY29Mb2FkZXIudW5sb2FkKCk7XG4gIGRyYWNvTG9hZGVyLl9zdGF0ZSA9IFJlc291cmNlTG9hZGVyU3RhdGUuRkFJTEVEO1xuICB2YXIgZXJyb3JNZXNzYWdlID0gXCJGYWlsZWQgdG8gbG9hZCBEcmFjb1wiO1xuICBkcmFjb0xvYWRlci5fcHJvbWlzZS5yZWplY3QoZHJhY29Mb2FkZXIuZ2V0RXJyb3IoZXJyb3JNZXNzYWdlLCBlcnJvcikpO1xufVxuXG4vKipcbiAqIFByb2Nlc3NlcyB0aGUgcmVzb3VyY2UgdW50aWwgaXQgYmVjb21lcyByZWFkeS5cbiAqXG4gKiBAcGFyYW0ge0ZyYW1lU3RhdGV9IGZyYW1lU3RhdGUgVGhlIGZyYW1lIHN0YXRlLlxuICogQHByaXZhdGVcbiAqL1xuR2x0ZkRyYWNvTG9hZGVyLnByb3RvdHlwZS5wcm9jZXNzID0gZnVuY3Rpb24gKGZyYW1lU3RhdGUpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcImZyYW1lU3RhdGVcIiwgZnJhbWVTdGF0ZSk7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIGlmICghZGVmaW5lZCh0aGlzLl9idWZmZXJWaWV3VHlwZWRBcnJheSkpIHtcbiAgICAvLyBOb3QgcmVhZHkgdG8gZGVjb2RlIHRoZSBEcmFjbyBidWZmZXJcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoZGVmaW5lZCh0aGlzLl9kZWNvZGVQcm9taXNlKSkge1xuICAgIC8vIEN1cnJlbnRseSBkZWNvZGluZ1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBkcmFjbyA9IHRoaXMuX2RyYWNvO1xuICB2YXIgZ2x0ZiA9IHRoaXMuX2dsdGY7XG4gIHZhciBidWZmZXJWaWV3cyA9IGdsdGYuYnVmZmVyVmlld3M7XG4gIHZhciBidWZmZXJWaWV3SWQgPSBkcmFjby5idWZmZXJWaWV3O1xuICB2YXIgYnVmZmVyVmlldyA9IGJ1ZmZlclZpZXdzW2J1ZmZlclZpZXdJZF07XG4gIHZhciBjb21wcmVzc2VkQXR0cmlidXRlcyA9IGRyYWNvLmF0dHJpYnV0ZXM7XG5cbiAgdmFyIGRlY29kZU9wdGlvbnMgPSB7XG4gICAgYXJyYXk6IHRoaXMuX2J1ZmZlclZpZXdUeXBlZEFycmF5LFxuICAgIGJ1ZmZlclZpZXc6IGJ1ZmZlclZpZXcsXG4gICAgY29tcHJlc3NlZEF0dHJpYnV0ZXM6IGNvbXByZXNzZWRBdHRyaWJ1dGVzLFxuICAgIGRlcXVhbnRpemVJblNoYWRlcjogdHJ1ZSxcbiAgfTtcblxuICB2YXIgZGVjb2RlUHJvbWlzZSA9IERyYWNvTG9hZGVyLmRlY29kZUJ1ZmZlclZpZXcoZGVjb2RlT3B0aW9ucyk7XG5cbiAgaWYgKCFkZWZpbmVkKGRlY29kZVByb21pc2UpKSB7XG4gICAgLy8gQ2Fubm90IHNjaGVkdWxlIHRhc2sgdGhpcyBmcmFtZVxuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciB0aGF0ID0gdGhpcztcbiAgdGhpcy5fZGVjb2RlUHJvbWlzZSA9IGRlY29kZVByb21pc2VcbiAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0cykge1xuICAgICAgaWYgKHRoYXQuaXNEZXN0cm95ZWQoKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAvLyBVbmxvYWQgZXZlcnl0aGluZyBleGNlcHQgdGhlIGRlY29kZWQgZGF0YVxuICAgICAgdGhhdC51bmxvYWQoKTtcblxuICAgICAgdGhhdC5fZGVjb2RlZERhdGEgPSB7XG4gICAgICAgIGluZGljZXM6IHJlc3VsdHMuaW5kZXhBcnJheSxcbiAgICAgICAgdmVydGV4QXR0cmlidXRlczogcmVzdWx0cy5hdHRyaWJ1dGVEYXRhLFxuICAgICAgfTtcbiAgICAgIHRoYXQuX3N0YXRlID0gUmVzb3VyY2VMb2FkZXJTdGF0ZS5SRUFEWTtcbiAgICAgIHRoYXQuX3Byb21pc2UucmVzb2x2ZSh0aGF0KTtcbiAgICB9KVxuICAgIC5vdGhlcndpc2UoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICBpZiAodGhhdC5pc0Rlc3Ryb3llZCgpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGhhbmRsZUVycm9yKHRoYXQsIGVycm9yKTtcbiAgICB9KTtcbn07XG5cbi8qKlxuICogVW5sb2FkcyB0aGUgcmVzb3VyY2UuXG4gKiBAcHJpdmF0ZVxuICovXG5HbHRmRHJhY29Mb2FkZXIucHJvdG90eXBlLnVubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRlZmluZWQodGhpcy5fYnVmZmVyVmlld0xvYWRlcikpIHtcbiAgICB0aGlzLl9yZXNvdXJjZUNhY2hlLnVubG9hZCh0aGlzLl9idWZmZXJWaWV3TG9hZGVyKTtcbiAgfVxuXG4gIHRoaXMuX2J1ZmZlclZpZXdMb2FkZXIgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2J1ZmZlclZpZXdUeXBlZEFycmF5ID0gdW5kZWZpbmVkO1xuICB0aGlzLl9kZWNvZGVkRGF0YSA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fZ2x0ZiA9IHVuZGVmaW5lZDtcbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///69179\n')},42670:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "Z": function() { return /* binding */ GltfFeatureMetadataLoader; }\n/* harmony export */ });\n/* harmony import */ var _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(66553);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(82982);\n/* harmony import */ var _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(13222);\n/* harmony import */ var _parseFeatureMetadata_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(25821);\n/* harmony import */ var _ResourceCache_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(38956);\n/* harmony import */ var _ResourceLoader_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(29789);\n/* harmony import */ var _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(89356);\n\n\n\n\n\n\n\n\n\n/**\n * Loads glTF feature metadata.\n * <p>\n * Implements the {@link ResourceLoader} interface.\n * </p>\n *\n * @alias GltfFeatureMetadataLoader\n * @constructor\n * @augments ResourceLoader\n *\n * @param {Object} options Object with the following properties:\n * @param {Object} options.gltf The glTF JSON.\n * @param {String} options.extension The feature metadata extension object.\n * @param {Resource} options.gltfResource The {@link Resource} containing the glTF.\n * @param {Resource} options.baseResource The {@link Resource} that paths in the glTF JSON are relative to.\n * @param {SupportedImageFormats} options.supportedImageFormats The supported image formats.\n * @param {String} [options.cacheKey] The cache key of the resource.\n * @param {Boolean} [options.asynchronous=true] Determines if WebGL resource creation will be spread out over several frames or block until all WebGL resources are created.\n *\n * @private\n * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium\'s standard deprecation policy.\n */\nfunction GltfFeatureMetadataLoader(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n  var gltf = options.gltf;\n  var extension = options.extension;\n  var gltfResource = options.gltfResource;\n  var baseResource = options.baseResource;\n  var supportedImageFormats = options.supportedImageFormats;\n  var cacheKey = options.cacheKey;\n  var asynchronous = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(options.asynchronous, true);\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.gltf", gltf);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.extension", extension);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.gltfResource", gltfResource);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.baseResource", baseResource);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.supportedImageFormats", supportedImageFormats);\n  //>>includeEnd(\'debug\');\n\n  this._gltfResource = gltfResource;\n  this._baseResource = baseResource;\n  this._gltf = gltf;\n  this._extension = extension;\n  this._supportedImageFormats = supportedImageFormats;\n  this._cacheKey = cacheKey;\n  this._asynchronous = asynchronous;\n  this._bufferViewLoaders = [];\n  this._textureLoaders = [];\n  this._schemaLoader = undefined;\n  this._featureMetadata = undefined;\n  this._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].UNLOADED */ .Z.UNLOADED;\n  this._promise = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].defer */ .Z.defer();\n}\n\nif ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(Object.create)) {\n  GltfFeatureMetadataLoader.prototype = Object.create(_ResourceLoader_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].prototype */ .Z.prototype);\n  GltfFeatureMetadataLoader.prototype.constructor = GltfFeatureMetadataLoader;\n}\n\nObject.defineProperties(GltfFeatureMetadataLoader.prototype, {\n  /**\n   * A promise that resolves to the resource when the resource is ready.\n   *\n   * @memberof GltfFeatureMetadataLoader.prototype\n   *\n   * @type {Promise.<GltfFeatureMetadataLoader>}\n   * @readonly\n   * @private\n   */\n  promise: {\n    get: function () {\n      return this._promise.promise;\n    },\n  },\n  /**\n   * The cache key of the resource.\n   *\n   * @memberof GltfFeatureMetadataLoader.prototype\n   *\n   * @type {String}\n   * @readonly\n   * @private\n   */\n  cacheKey: {\n    get: function () {\n      return this._cacheKey;\n    },\n  },\n  /**\n   * Feature metadata.\n   *\n   * @memberof GltfFeatureMetadataLoader.prototype\n   *\n   * @type {FeatureMetadata}\n   * @readonly\n   * @private\n   */\n  featureMetadata: {\n    get: function () {\n      return this._featureMetadata;\n    },\n  },\n});\n\n/**\n * Loads the resource.\n * @private\n */\nGltfFeatureMetadataLoader.prototype.load = function () {\n  var bufferViewsPromise = loadBufferViews(this);\n  var texturesPromise = loadTextures(this);\n  var schemaPromise = loadSchema(this);\n\n  this._gltf = undefined; // No longer need to hold onto the glTF\n  this._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].LOADING */ .Z.LOADING;\n\n  var that = this;\n\n  _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].all */ .Z.all([bufferViewsPromise, texturesPromise, schemaPromise])\n    .then(function (results) {\n      if (that.isDestroyed()) {\n        return;\n      }\n      var bufferViews = results[0];\n      var textures = results[1];\n      var schema = results[2];\n\n      that._featureMetadata = (0,_parseFeatureMetadata_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)({\n        extension: that._extension,\n        schema: schema,\n        bufferViews: bufferViews,\n        textures: textures,\n      });\n      that._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].READY */ .Z.READY;\n      that._promise.resolve(that);\n    })\n    .otherwise(function (error) {\n      if (that.isDestroyed()) {\n        return;\n      }\n      that.unload();\n      that._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].FAILED */ .Z.FAILED;\n      var errorMessage = "Failed to load feature metadata";\n      that._promise.reject(that.getError(errorMessage, error));\n    });\n};\n\nfunction loadBufferViews(featureMetadataLoader) {\n  var extension = featureMetadataLoader._extension;\n  var featureTables = extension.featureTables;\n\n  // Gather the used buffer views\n  var bufferViewIds = {};\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(featureTables)) {\n    for (var featureTableId in featureTables) {\n      if (featureTables.hasOwnProperty(featureTableId)) {\n        var featureTable = featureTables[featureTableId];\n        var properties = featureTable.properties;\n        if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(properties)) {\n          for (var propertyId in properties) {\n            if (properties.hasOwnProperty(propertyId)) {\n              var property = properties[propertyId];\n              var bufferView = property.bufferView;\n              var arrayOffsetBufferView = property.arrayOffsetBufferView;\n              var stringOffsetBufferView = property.stringOffsetBufferView;\n              if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(bufferView)) {\n                bufferViewIds[bufferView] = true;\n              }\n              if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(arrayOffsetBufferView)) {\n                bufferViewIds[arrayOffsetBufferView] = true;\n              }\n              if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(stringOffsetBufferView)) {\n                bufferViewIds[stringOffsetBufferView] = true;\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  // Load the buffer views\n  var bufferViewPromises = [];\n  var bufferViewLoaders = {};\n  for (var bufferViewId in bufferViewIds) {\n    if (bufferViewIds.hasOwnProperty(bufferViewId)) {\n      var bufferViewLoader = _ResourceCache_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].loadBufferView */ .Z.loadBufferView({\n        gltf: featureMetadataLoader._gltf,\n        bufferViewId: parseInt(bufferViewId),\n        gltfResource: featureMetadataLoader._gltfResource,\n        baseResource: featureMetadataLoader._baseResource,\n      });\n      bufferViewPromises.push(bufferViewLoader.promise);\n      featureMetadataLoader._bufferViewLoaders.push(bufferViewLoader);\n      bufferViewLoaders[bufferViewId] = bufferViewLoader;\n    }\n  }\n\n  // Return a promise to a map of buffer view IDs to typed arrays\n  return _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].all */ .Z.all(bufferViewPromises).then(function () {\n    var bufferViews = {};\n    for (var bufferViewId in bufferViewLoaders) {\n      if (bufferViewLoaders.hasOwnProperty(bufferViewId)) {\n        var bufferViewLoader = bufferViewLoaders[bufferViewId];\n        // Copy the typed array and let the underlying ArrayBuffer be freed\n        var bufferViewTypedArray = new Uint8Array(bufferViewLoader.typedArray);\n        bufferViews[bufferViewId] = bufferViewTypedArray;\n      }\n    }\n\n    // Buffer views can be unloaded after the data has been copied\n    unloadBufferViews(featureMetadataLoader);\n\n    return bufferViews;\n  });\n}\n\nfunction loadTextures(featureMetadataLoader) {\n  var extension = featureMetadataLoader._extension;\n  var featureTextures = extension.featureTextures;\n\n  var gltf = featureMetadataLoader._gltf;\n  var gltfResource = featureMetadataLoader._gltfResource;\n  var baseResource = featureMetadataLoader._baseResource;\n  var supportedImageFormats = featureMetadataLoader._supportedImageFormats;\n  var asynchronous = featureMetadataLoader._asynchronous;\n\n  // Gather the used textures\n  var textureIds = {};\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(featureTextures)) {\n    for (var featureTextureId in featureTextures) {\n      if (featureTextures.hasOwnProperty(featureTextureId)) {\n        var featureTexture = featureTextures[featureTextureId];\n        var properties = featureTexture.properties;\n        if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(properties)) {\n          for (var propertyId in properties) {\n            if (properties.hasOwnProperty(propertyId)) {\n              var property = properties[propertyId];\n              var textureInfo = property.texture;\n              textureIds[textureInfo.index] = textureInfo;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  // Load the textures\n  var texturePromises = [];\n  var textureLoaders = {};\n  for (var textureId in textureIds) {\n    if (textureIds.hasOwnProperty(textureId)) {\n      var textureLoader = _ResourceCache_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].loadTexture */ .Z.loadTexture({\n        gltf: gltf,\n        textureInfo: textureIds[textureId],\n        gltfResource: gltfResource,\n        baseResource: baseResource,\n        supportedImageFormats: supportedImageFormats,\n        asynchronous: asynchronous,\n      });\n      texturePromises.push(textureLoader.promise);\n      featureMetadataLoader._textureLoaders.push(textureLoader);\n      textureLoaders[textureId] = textureLoader;\n    }\n  }\n\n  // Return a promise to a map of texture IDs to Texture objects\n  return _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].all */ .Z.all(texturePromises).then(function () {\n    var textures = {};\n    for (var textureId in textureLoaders) {\n      if (textureLoaders.hasOwnProperty(textureId)) {\n        var textureLoader = textureLoaders[textureId];\n        textures[textureId] = textureLoader.texture;\n      }\n    }\n    return textures;\n  });\n}\n\nfunction loadSchema(featureMetadataLoader) {\n  var extension = featureMetadataLoader._extension;\n\n  var schemaLoader;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(extension.schemaUri)) {\n    var resource = featureMetadataLoader._baseResource.getDerivedResource({\n      url: extension.schemaUri,\n    });\n    schemaLoader = _ResourceCache_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].loadSchema */ .Z.loadSchema({\n      resource: resource,\n    });\n  } else {\n    schemaLoader = _ResourceCache_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].loadSchema */ .Z.loadSchema({\n      schema: extension.schema,\n    });\n  }\n\n  featureMetadataLoader._schemaLoader = schemaLoader;\n\n  return schemaLoader.promise.then(function (schemaLoader) {\n    return schemaLoader.schema;\n  });\n}\n\n/**\n * Processes the resource until it becomes ready.\n *\n * @param {FrameState} frameState The frame state.\n * @private\n */\nGltfFeatureMetadataLoader.prototype.process = function (frameState) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("frameState", frameState);\n  //>>includeEnd(\'debug\');\n\n  if (this._state !== _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].LOADING */ .Z.LOADING) {\n    return;\n  }\n\n  var textureLoaders = this._textureLoaders;\n  var textureLoadersLength = textureLoaders.length;\n\n  for (var i = 0; i < textureLoadersLength; ++i) {\n    var textureLoader = textureLoaders[i];\n    textureLoader.process(frameState);\n  }\n};\n\nfunction unloadBufferViews(featureMetadataLoader) {\n  var bufferViewLoaders = featureMetadataLoader._bufferViewLoaders;\n  var bufferViewLoadersLength = bufferViewLoaders.length;\n  for (var i = 0; i < bufferViewLoadersLength; ++i) {\n    _ResourceCache_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].unload */ .Z.unload(bufferViewLoaders[i]);\n  }\n  featureMetadataLoader._bufferViewLoaders.length = 0;\n}\n\nfunction unloadTextures(featureMetadataLoader) {\n  var textureLoaders = featureMetadataLoader._textureLoaders;\n  var textureLoadersLength = textureLoaders.length;\n  for (var i = 0; i < textureLoadersLength; ++i) {\n    _ResourceCache_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].unload */ .Z.unload(textureLoaders[i]);\n  }\n  featureMetadataLoader._textureLoaders.length = 0;\n}\n\n/**\n * Unloads the resource.\n * @private\n */\nGltfFeatureMetadataLoader.prototype.unload = function () {\n  unloadBufferViews(this);\n  unloadTextures(this);\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(this._schemaLoader)) {\n    _ResourceCache_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].unload */ .Z.unload(this._schemaLoader);\n  }\n  this._schemaLoader = undefined;\n\n  this._featureMetadata = undefined;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiwwRkFBeUI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxTQUFTLDRFQUFRO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLE1BQU0scUVBQU87QUFDYjtBQUNBO0FBQ0EsS0FBSztBQUNMLG1CQUFtQix3RkFBd0I7QUFDM0M7QUFDQSxLQUFLO0FBQ0wsSUFBSTtBQUNKLG1CQUFtQix3RkFBd0I7QUFDM0M7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFlBQVk7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFLDJGQUFtQjtBQUNyQjs7QUFFQSxzQkFBc0Isd0ZBQTJCO0FBQ2pEO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxrQkFBa0IsMEJBQTBCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiw2QkFBNkI7QUFDL0MsSUFBSSxnRkFBb0I7QUFDeEI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiwwQkFBMEI7QUFDNUMsSUFBSSxnRkFBb0I7QUFDeEI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE1BQU0scUVBQU87QUFDYixJQUFJLGdGQUFvQjtBQUN4QjtBQUNBOztBQUVBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92dWUzLXdlYnBhY2s1Ly4vbm9kZV9tb2R1bGVzL2Nlc2l1bS9Tb3VyY2UvU2NlbmUvR2x0ZkZlYXR1cmVNZXRhZGF0YUxvYWRlci5qcz9lMjk2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDaGVjayBmcm9tIFwiLi4vQ29yZS9DaGVjay5qc1wiO1xuaW1wb3J0IGRlZmF1bHRWYWx1ZSBmcm9tIFwiLi4vQ29yZS9kZWZhdWx0VmFsdWUuanNcIjtcbmltcG9ydCBkZWZpbmVkIGZyb20gXCIuLi9Db3JlL2RlZmluZWQuanNcIjtcbmltcG9ydCB3aGVuIGZyb20gXCIuLi9UaGlyZFBhcnR5L3doZW4uanNcIjtcbmltcG9ydCBwYXJzZUZlYXR1cmVNZXRhZGF0YSBmcm9tIFwiLi9wYXJzZUZlYXR1cmVNZXRhZGF0YS5qc1wiO1xuaW1wb3J0IFJlc291cmNlQ2FjaGUgZnJvbSBcIi4vUmVzb3VyY2VDYWNoZS5qc1wiO1xuaW1wb3J0IFJlc291cmNlTG9hZGVyIGZyb20gXCIuL1Jlc291cmNlTG9hZGVyLmpzXCI7XG5pbXBvcnQgUmVzb3VyY2VMb2FkZXJTdGF0ZSBmcm9tIFwiLi9SZXNvdXJjZUxvYWRlclN0YXRlLmpzXCI7XG5cbi8qKlxuICogTG9hZHMgZ2xURiBmZWF0dXJlIG1ldGFkYXRhLlxuICogPHA+XG4gKiBJbXBsZW1lbnRzIHRoZSB7QGxpbmsgUmVzb3VyY2VMb2FkZXJ9IGludGVyZmFjZS5cbiAqIDwvcD5cbiAqXG4gKiBAYWxpYXMgR2x0ZkZlYXR1cmVNZXRhZGF0YUxvYWRlclxuICogQGNvbnN0cnVjdG9yXG4gKiBAYXVnbWVudHMgUmVzb3VyY2VMb2FkZXJcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBPYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucy5nbHRmIFRoZSBnbFRGIEpTT04uXG4gKiBAcGFyYW0ge1N0cmluZ30gb3B0aW9ucy5leHRlbnNpb24gVGhlIGZlYXR1cmUgbWV0YWRhdGEgZXh0ZW5zaW9uIG9iamVjdC5cbiAqIEBwYXJhbSB7UmVzb3VyY2V9IG9wdGlvbnMuZ2x0ZlJlc291cmNlIFRoZSB7QGxpbmsgUmVzb3VyY2V9IGNvbnRhaW5pbmcgdGhlIGdsVEYuXG4gKiBAcGFyYW0ge1Jlc291cmNlfSBvcHRpb25zLmJhc2VSZXNvdXJjZSBUaGUge0BsaW5rIFJlc291cmNlfSB0aGF0IHBhdGhzIGluIHRoZSBnbFRGIEpTT04gYXJlIHJlbGF0aXZlIHRvLlxuICogQHBhcmFtIHtTdXBwb3J0ZWRJbWFnZUZvcm1hdHN9IG9wdGlvbnMuc3VwcG9ydGVkSW1hZ2VGb3JtYXRzIFRoZSBzdXBwb3J0ZWQgaW1hZ2UgZm9ybWF0cy5cbiAqIEBwYXJhbSB7U3RyaW5nfSBbb3B0aW9ucy5jYWNoZUtleV0gVGhlIGNhY2hlIGtleSBvZiB0aGUgcmVzb3VyY2UuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmFzeW5jaHJvbm91cz10cnVlXSBEZXRlcm1pbmVzIGlmIFdlYkdMIHJlc291cmNlIGNyZWF0aW9uIHdpbGwgYmUgc3ByZWFkIG91dCBvdmVyIHNldmVyYWwgZnJhbWVzIG9yIGJsb2NrIHVudGlsIGFsbCBXZWJHTCByZXNvdXJjZXMgYXJlIGNyZWF0ZWQuXG4gKlxuICogQHByaXZhdGVcbiAqIEBleHBlcmltZW50YWwgVGhpcyBmZWF0dXJlIGlzIHVzaW5nIHBhcnQgb2YgdGhlIDNEIFRpbGVzIHNwZWMgdGhhdCBpcyBub3QgZmluYWwgYW5kIGlzIHN1YmplY3QgdG8gY2hhbmdlIHdpdGhvdXQgQ2VzaXVtJ3Mgc3RhbmRhcmQgZGVwcmVjYXRpb24gcG9saWN5LlxuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBHbHRmRmVhdHVyZU1ldGFkYXRhTG9hZGVyKG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLCBkZWZhdWx0VmFsdWUuRU1QVFlfT0JKRUNUKTtcbiAgdmFyIGdsdGYgPSBvcHRpb25zLmdsdGY7XG4gIHZhciBleHRlbnNpb24gPSBvcHRpb25zLmV4dGVuc2lvbjtcbiAgdmFyIGdsdGZSZXNvdXJjZSA9IG9wdGlvbnMuZ2x0ZlJlc291cmNlO1xuICB2YXIgYmFzZVJlc291cmNlID0gb3B0aW9ucy5iYXNlUmVzb3VyY2U7XG4gIHZhciBzdXBwb3J0ZWRJbWFnZUZvcm1hdHMgPSBvcHRpb25zLnN1cHBvcnRlZEltYWdlRm9ybWF0cztcbiAgdmFyIGNhY2hlS2V5ID0gb3B0aW9ucy5jYWNoZUtleTtcbiAgdmFyIGFzeW5jaHJvbm91cyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmFzeW5jaHJvbm91cywgdHJ1ZSk7XG5cbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcIm9wdGlvbnMuZ2x0ZlwiLCBnbHRmKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcIm9wdGlvbnMuZXh0ZW5zaW9uXCIsIGV4dGVuc2lvbik7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJvcHRpb25zLmdsdGZSZXNvdXJjZVwiLCBnbHRmUmVzb3VyY2UpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwib3B0aW9ucy5iYXNlUmVzb3VyY2VcIiwgYmFzZVJlc291cmNlKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcIm9wdGlvbnMuc3VwcG9ydGVkSW1hZ2VGb3JtYXRzXCIsIHN1cHBvcnRlZEltYWdlRm9ybWF0cyk7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIHRoaXMuX2dsdGZSZXNvdXJjZSA9IGdsdGZSZXNvdXJjZTtcbiAgdGhpcy5fYmFzZVJlc291cmNlID0gYmFzZVJlc291cmNlO1xuICB0aGlzLl9nbHRmID0gZ2x0ZjtcbiAgdGhpcy5fZXh0ZW5zaW9uID0gZXh0ZW5zaW9uO1xuICB0aGlzLl9zdXBwb3J0ZWRJbWFnZUZvcm1hdHMgPSBzdXBwb3J0ZWRJbWFnZUZvcm1hdHM7XG4gIHRoaXMuX2NhY2hlS2V5ID0gY2FjaGVLZXk7XG4gIHRoaXMuX2FzeW5jaHJvbm91cyA9IGFzeW5jaHJvbm91cztcbiAgdGhpcy5fYnVmZmVyVmlld0xvYWRlcnMgPSBbXTtcbiAgdGhpcy5fdGV4dHVyZUxvYWRlcnMgPSBbXTtcbiAgdGhpcy5fc2NoZW1hTG9hZGVyID0gdW5kZWZpbmVkO1xuICB0aGlzLl9mZWF0dXJlTWV0YWRhdGEgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX3N0YXRlID0gUmVzb3VyY2VMb2FkZXJTdGF0ZS5VTkxPQURFRDtcbiAgdGhpcy5fcHJvbWlzZSA9IHdoZW4uZGVmZXIoKTtcbn1cblxuaWYgKGRlZmluZWQoT2JqZWN0LmNyZWF0ZSkpIHtcbiAgR2x0ZkZlYXR1cmVNZXRhZGF0YUxvYWRlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFJlc291cmNlTG9hZGVyLnByb3RvdHlwZSk7XG4gIEdsdGZGZWF0dXJlTWV0YWRhdGFMb2FkZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gR2x0ZkZlYXR1cmVNZXRhZGF0YUxvYWRlcjtcbn1cblxuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoR2x0ZkZlYXR1cmVNZXRhZGF0YUxvYWRlci5wcm90b3R5cGUsIHtcbiAgLyoqXG4gICAqIEEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXNvdXJjZSB3aGVuIHRoZSByZXNvdXJjZSBpcyByZWFkeS5cbiAgICpcbiAgICogQG1lbWJlcm9mIEdsdGZGZWF0dXJlTWV0YWRhdGFMb2FkZXIucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtQcm9taXNlLjxHbHRmRmVhdHVyZU1ldGFkYXRhTG9hZGVyPn1cbiAgICogQHJlYWRvbmx5XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcm9taXNlOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcHJvbWlzZS5wcm9taXNlO1xuICAgIH0sXG4gIH0sXG4gIC8qKlxuICAgKiBUaGUgY2FjaGUga2V5IG9mIHRoZSByZXNvdXJjZS5cbiAgICpcbiAgICogQG1lbWJlcm9mIEdsdGZGZWF0dXJlTWV0YWRhdGFMb2FkZXIucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtTdHJpbmd9XG4gICAqIEByZWFkb25seVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgY2FjaGVLZXk6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jYWNoZUtleTtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogRmVhdHVyZSBtZXRhZGF0YS5cbiAgICpcbiAgICogQG1lbWJlcm9mIEdsdGZGZWF0dXJlTWV0YWRhdGFMb2FkZXIucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtGZWF0dXJlTWV0YWRhdGF9XG4gICAqIEByZWFkb25seVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZmVhdHVyZU1ldGFkYXRhOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZmVhdHVyZU1ldGFkYXRhO1xuICAgIH0sXG4gIH0sXG59KTtcblxuLyoqXG4gKiBMb2FkcyB0aGUgcmVzb3VyY2UuXG4gKiBAcHJpdmF0ZVxuICovXG5HbHRmRmVhdHVyZU1ldGFkYXRhTG9hZGVyLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKCkge1xuICB2YXIgYnVmZmVyVmlld3NQcm9taXNlID0gbG9hZEJ1ZmZlclZpZXdzKHRoaXMpO1xuICB2YXIgdGV4dHVyZXNQcm9taXNlID0gbG9hZFRleHR1cmVzKHRoaXMpO1xuICB2YXIgc2NoZW1hUHJvbWlzZSA9IGxvYWRTY2hlbWEodGhpcyk7XG5cbiAgdGhpcy5fZ2x0ZiA9IHVuZGVmaW5lZDsgLy8gTm8gbG9uZ2VyIG5lZWQgdG8gaG9sZCBvbnRvIHRoZSBnbFRGXG4gIHRoaXMuX3N0YXRlID0gUmVzb3VyY2VMb2FkZXJTdGF0ZS5MT0FESU5HO1xuXG4gIHZhciB0aGF0ID0gdGhpcztcblxuICB3aGVuXG4gICAgLmFsbChbYnVmZmVyVmlld3NQcm9taXNlLCB0ZXh0dXJlc1Byb21pc2UsIHNjaGVtYVByb21pc2VdKVxuICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7XG4gICAgICBpZiAodGhhdC5pc0Rlc3Ryb3llZCgpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBidWZmZXJWaWV3cyA9IHJlc3VsdHNbMF07XG4gICAgICB2YXIgdGV4dHVyZXMgPSByZXN1bHRzWzFdO1xuICAgICAgdmFyIHNjaGVtYSA9IHJlc3VsdHNbMl07XG5cbiAgICAgIHRoYXQuX2ZlYXR1cmVNZXRhZGF0YSA9IHBhcnNlRmVhdHVyZU1ldGFkYXRhKHtcbiAgICAgICAgZXh0ZW5zaW9uOiB0aGF0Ll9leHRlbnNpb24sXG4gICAgICAgIHNjaGVtYTogc2NoZW1hLFxuICAgICAgICBidWZmZXJWaWV3czogYnVmZmVyVmlld3MsXG4gICAgICAgIHRleHR1cmVzOiB0ZXh0dXJlcyxcbiAgICAgIH0pO1xuICAgICAgdGhhdC5fc3RhdGUgPSBSZXNvdXJjZUxvYWRlclN0YXRlLlJFQURZO1xuICAgICAgdGhhdC5fcHJvbWlzZS5yZXNvbHZlKHRoYXQpO1xuICAgIH0pXG4gICAgLm90aGVyd2lzZShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgIGlmICh0aGF0LmlzRGVzdHJveWVkKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhhdC51bmxvYWQoKTtcbiAgICAgIHRoYXQuX3N0YXRlID0gUmVzb3VyY2VMb2FkZXJTdGF0ZS5GQUlMRUQ7XG4gICAgICB2YXIgZXJyb3JNZXNzYWdlID0gXCJGYWlsZWQgdG8gbG9hZCBmZWF0dXJlIG1ldGFkYXRhXCI7XG4gICAgICB0aGF0Ll9wcm9taXNlLnJlamVjdCh0aGF0LmdldEVycm9yKGVycm9yTWVzc2FnZSwgZXJyb3IpKTtcbiAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIGxvYWRCdWZmZXJWaWV3cyhmZWF0dXJlTWV0YWRhdGFMb2FkZXIpIHtcbiAgdmFyIGV4dGVuc2lvbiA9IGZlYXR1cmVNZXRhZGF0YUxvYWRlci5fZXh0ZW5zaW9uO1xuICB2YXIgZmVhdHVyZVRhYmxlcyA9IGV4dGVuc2lvbi5mZWF0dXJlVGFibGVzO1xuXG4gIC8vIEdhdGhlciB0aGUgdXNlZCBidWZmZXIgdmlld3NcbiAgdmFyIGJ1ZmZlclZpZXdJZHMgPSB7fTtcbiAgaWYgKGRlZmluZWQoZmVhdHVyZVRhYmxlcykpIHtcbiAgICBmb3IgKHZhciBmZWF0dXJlVGFibGVJZCBpbiBmZWF0dXJlVGFibGVzKSB7XG4gICAgICBpZiAoZmVhdHVyZVRhYmxlcy5oYXNPd25Qcm9wZXJ0eShmZWF0dXJlVGFibGVJZCkpIHtcbiAgICAgICAgdmFyIGZlYXR1cmVUYWJsZSA9IGZlYXR1cmVUYWJsZXNbZmVhdHVyZVRhYmxlSWRdO1xuICAgICAgICB2YXIgcHJvcGVydGllcyA9IGZlYXR1cmVUYWJsZS5wcm9wZXJ0aWVzO1xuICAgICAgICBpZiAoZGVmaW5lZChwcm9wZXJ0aWVzKSkge1xuICAgICAgICAgIGZvciAodmFyIHByb3BlcnR5SWQgaW4gcHJvcGVydGllcykge1xuICAgICAgICAgICAgaWYgKHByb3BlcnRpZXMuaGFzT3duUHJvcGVydHkocHJvcGVydHlJZCkpIHtcbiAgICAgICAgICAgICAgdmFyIHByb3BlcnR5ID0gcHJvcGVydGllc1twcm9wZXJ0eUlkXTtcbiAgICAgICAgICAgICAgdmFyIGJ1ZmZlclZpZXcgPSBwcm9wZXJ0eS5idWZmZXJWaWV3O1xuICAgICAgICAgICAgICB2YXIgYXJyYXlPZmZzZXRCdWZmZXJWaWV3ID0gcHJvcGVydHkuYXJyYXlPZmZzZXRCdWZmZXJWaWV3O1xuICAgICAgICAgICAgICB2YXIgc3RyaW5nT2Zmc2V0QnVmZmVyVmlldyA9IHByb3BlcnR5LnN0cmluZ09mZnNldEJ1ZmZlclZpZXc7XG4gICAgICAgICAgICAgIGlmIChkZWZpbmVkKGJ1ZmZlclZpZXcpKSB7XG4gICAgICAgICAgICAgICAgYnVmZmVyVmlld0lkc1tidWZmZXJWaWV3XSA9IHRydWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKGRlZmluZWQoYXJyYXlPZmZzZXRCdWZmZXJWaWV3KSkge1xuICAgICAgICAgICAgICAgIGJ1ZmZlclZpZXdJZHNbYXJyYXlPZmZzZXRCdWZmZXJWaWV3XSA9IHRydWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKGRlZmluZWQoc3RyaW5nT2Zmc2V0QnVmZmVyVmlldykpIHtcbiAgICAgICAgICAgICAgICBidWZmZXJWaWV3SWRzW3N0cmluZ09mZnNldEJ1ZmZlclZpZXddID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIExvYWQgdGhlIGJ1ZmZlciB2aWV3c1xuICB2YXIgYnVmZmVyVmlld1Byb21pc2VzID0gW107XG4gIHZhciBidWZmZXJWaWV3TG9hZGVycyA9IHt9O1xuICBmb3IgKHZhciBidWZmZXJWaWV3SWQgaW4gYnVmZmVyVmlld0lkcykge1xuICAgIGlmIChidWZmZXJWaWV3SWRzLmhhc093blByb3BlcnR5KGJ1ZmZlclZpZXdJZCkpIHtcbiAgICAgIHZhciBidWZmZXJWaWV3TG9hZGVyID0gUmVzb3VyY2VDYWNoZS5sb2FkQnVmZmVyVmlldyh7XG4gICAgICAgIGdsdGY6IGZlYXR1cmVNZXRhZGF0YUxvYWRlci5fZ2x0ZixcbiAgICAgICAgYnVmZmVyVmlld0lkOiBwYXJzZUludChidWZmZXJWaWV3SWQpLFxuICAgICAgICBnbHRmUmVzb3VyY2U6IGZlYXR1cmVNZXRhZGF0YUxvYWRlci5fZ2x0ZlJlc291cmNlLFxuICAgICAgICBiYXNlUmVzb3VyY2U6IGZlYXR1cmVNZXRhZGF0YUxvYWRlci5fYmFzZVJlc291cmNlLFxuICAgICAgfSk7XG4gICAgICBidWZmZXJWaWV3UHJvbWlzZXMucHVzaChidWZmZXJWaWV3TG9hZGVyLnByb21pc2UpO1xuICAgICAgZmVhdHVyZU1ldGFkYXRhTG9hZGVyLl9idWZmZXJWaWV3TG9hZGVycy5wdXNoKGJ1ZmZlclZpZXdMb2FkZXIpO1xuICAgICAgYnVmZmVyVmlld0xvYWRlcnNbYnVmZmVyVmlld0lkXSA9IGJ1ZmZlclZpZXdMb2FkZXI7XG4gICAgfVxuICB9XG5cbiAgLy8gUmV0dXJuIGEgcHJvbWlzZSB0byBhIG1hcCBvZiBidWZmZXIgdmlldyBJRHMgdG8gdHlwZWQgYXJyYXlzXG4gIHJldHVybiB3aGVuLmFsbChidWZmZXJWaWV3UHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgIHZhciBidWZmZXJWaWV3cyA9IHt9O1xuICAgIGZvciAodmFyIGJ1ZmZlclZpZXdJZCBpbiBidWZmZXJWaWV3TG9hZGVycykge1xuICAgICAgaWYgKGJ1ZmZlclZpZXdMb2FkZXJzLmhhc093blByb3BlcnR5KGJ1ZmZlclZpZXdJZCkpIHtcbiAgICAgICAgdmFyIGJ1ZmZlclZpZXdMb2FkZXIgPSBidWZmZXJWaWV3TG9hZGVyc1tidWZmZXJWaWV3SWRdO1xuICAgICAgICAvLyBDb3B5IHRoZSB0eXBlZCBhcnJheSBhbmQgbGV0IHRoZSB1bmRlcmx5aW5nIEFycmF5QnVmZmVyIGJlIGZyZWVkXG4gICAgICAgIHZhciBidWZmZXJWaWV3VHlwZWRBcnJheSA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlclZpZXdMb2FkZXIudHlwZWRBcnJheSk7XG4gICAgICAgIGJ1ZmZlclZpZXdzW2J1ZmZlclZpZXdJZF0gPSBidWZmZXJWaWV3VHlwZWRBcnJheTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBCdWZmZXIgdmlld3MgY2FuIGJlIHVubG9hZGVkIGFmdGVyIHRoZSBkYXRhIGhhcyBiZWVuIGNvcGllZFxuICAgIHVubG9hZEJ1ZmZlclZpZXdzKGZlYXR1cmVNZXRhZGF0YUxvYWRlcik7XG5cbiAgICByZXR1cm4gYnVmZmVyVmlld3M7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBsb2FkVGV4dHVyZXMoZmVhdHVyZU1ldGFkYXRhTG9hZGVyKSB7XG4gIHZhciBleHRlbnNpb24gPSBmZWF0dXJlTWV0YWRhdGFMb2FkZXIuX2V4dGVuc2lvbjtcbiAgdmFyIGZlYXR1cmVUZXh0dXJlcyA9IGV4dGVuc2lvbi5mZWF0dXJlVGV4dHVyZXM7XG5cbiAgdmFyIGdsdGYgPSBmZWF0dXJlTWV0YWRhdGFMb2FkZXIuX2dsdGY7XG4gIHZhciBnbHRmUmVzb3VyY2UgPSBmZWF0dXJlTWV0YWRhdGFMb2FkZXIuX2dsdGZSZXNvdXJjZTtcbiAgdmFyIGJhc2VSZXNvdXJjZSA9IGZlYXR1cmVNZXRhZGF0YUxvYWRlci5fYmFzZVJlc291cmNlO1xuICB2YXIgc3VwcG9ydGVkSW1hZ2VGb3JtYXRzID0gZmVhdHVyZU1ldGFkYXRhTG9hZGVyLl9zdXBwb3J0ZWRJbWFnZUZvcm1hdHM7XG4gIHZhciBhc3luY2hyb25vdXMgPSBmZWF0dXJlTWV0YWRhdGFMb2FkZXIuX2FzeW5jaHJvbm91cztcblxuICAvLyBHYXRoZXIgdGhlIHVzZWQgdGV4dHVyZXNcbiAgdmFyIHRleHR1cmVJZHMgPSB7fTtcbiAgaWYgKGRlZmluZWQoZmVhdHVyZVRleHR1cmVzKSkge1xuICAgIGZvciAodmFyIGZlYXR1cmVUZXh0dXJlSWQgaW4gZmVhdHVyZVRleHR1cmVzKSB7XG4gICAgICBpZiAoZmVhdHVyZVRleHR1cmVzLmhhc093blByb3BlcnR5KGZlYXR1cmVUZXh0dXJlSWQpKSB7XG4gICAgICAgIHZhciBmZWF0dXJlVGV4dHVyZSA9IGZlYXR1cmVUZXh0dXJlc1tmZWF0dXJlVGV4dHVyZUlkXTtcbiAgICAgICAgdmFyIHByb3BlcnRpZXMgPSBmZWF0dXJlVGV4dHVyZS5wcm9wZXJ0aWVzO1xuICAgICAgICBpZiAoZGVmaW5lZChwcm9wZXJ0aWVzKSkge1xuICAgICAgICAgIGZvciAodmFyIHByb3BlcnR5SWQgaW4gcHJvcGVydGllcykge1xuICAgICAgICAgICAgaWYgKHByb3BlcnRpZXMuaGFzT3duUHJvcGVydHkocHJvcGVydHlJZCkpIHtcbiAgICAgICAgICAgICAgdmFyIHByb3BlcnR5ID0gcHJvcGVydGllc1twcm9wZXJ0eUlkXTtcbiAgICAgICAgICAgICAgdmFyIHRleHR1cmVJbmZvID0gcHJvcGVydHkudGV4dHVyZTtcbiAgICAgICAgICAgICAgdGV4dHVyZUlkc1t0ZXh0dXJlSW5mby5pbmRleF0gPSB0ZXh0dXJlSW5mbztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBMb2FkIHRoZSB0ZXh0dXJlc1xuICB2YXIgdGV4dHVyZVByb21pc2VzID0gW107XG4gIHZhciB0ZXh0dXJlTG9hZGVycyA9IHt9O1xuICBmb3IgKHZhciB0ZXh0dXJlSWQgaW4gdGV4dHVyZUlkcykge1xuICAgIGlmICh0ZXh0dXJlSWRzLmhhc093blByb3BlcnR5KHRleHR1cmVJZCkpIHtcbiAgICAgIHZhciB0ZXh0dXJlTG9hZGVyID0gUmVzb3VyY2VDYWNoZS5sb2FkVGV4dHVyZSh7XG4gICAgICAgIGdsdGY6IGdsdGYsXG4gICAgICAgIHRleHR1cmVJbmZvOiB0ZXh0dXJlSWRzW3RleHR1cmVJZF0sXG4gICAgICAgIGdsdGZSZXNvdXJjZTogZ2x0ZlJlc291cmNlLFxuICAgICAgICBiYXNlUmVzb3VyY2U6IGJhc2VSZXNvdXJjZSxcbiAgICAgICAgc3VwcG9ydGVkSW1hZ2VGb3JtYXRzOiBzdXBwb3J0ZWRJbWFnZUZvcm1hdHMsXG4gICAgICAgIGFzeW5jaHJvbm91czogYXN5bmNocm9ub3VzLFxuICAgICAgfSk7XG4gICAgICB0ZXh0dXJlUHJvbWlzZXMucHVzaCh0ZXh0dXJlTG9hZGVyLnByb21pc2UpO1xuICAgICAgZmVhdHVyZU1ldGFkYXRhTG9hZGVyLl90ZXh0dXJlTG9hZGVycy5wdXNoKHRleHR1cmVMb2FkZXIpO1xuICAgICAgdGV4dHVyZUxvYWRlcnNbdGV4dHVyZUlkXSA9IHRleHR1cmVMb2FkZXI7XG4gICAgfVxuICB9XG5cbiAgLy8gUmV0dXJuIGEgcHJvbWlzZSB0byBhIG1hcCBvZiB0ZXh0dXJlIElEcyB0byBUZXh0dXJlIG9iamVjdHNcbiAgcmV0dXJuIHdoZW4uYWxsKHRleHR1cmVQcm9taXNlcykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRleHR1cmVzID0ge307XG4gICAgZm9yICh2YXIgdGV4dHVyZUlkIGluIHRleHR1cmVMb2FkZXJzKSB7XG4gICAgICBpZiAodGV4dHVyZUxvYWRlcnMuaGFzT3duUHJvcGVydHkodGV4dHVyZUlkKSkge1xuICAgICAgICB2YXIgdGV4dHVyZUxvYWRlciA9IHRleHR1cmVMb2FkZXJzW3RleHR1cmVJZF07XG4gICAgICAgIHRleHR1cmVzW3RleHR1cmVJZF0gPSB0ZXh0dXJlTG9hZGVyLnRleHR1cmU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0ZXh0dXJlcztcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGxvYWRTY2hlbWEoZmVhdHVyZU1ldGFkYXRhTG9hZGVyKSB7XG4gIHZhciBleHRlbnNpb24gPSBmZWF0dXJlTWV0YWRhdGFMb2FkZXIuX2V4dGVuc2lvbjtcblxuICB2YXIgc2NoZW1hTG9hZGVyO1xuICBpZiAoZGVmaW5lZChleHRlbnNpb24uc2NoZW1hVXJpKSkge1xuICAgIHZhciByZXNvdXJjZSA9IGZlYXR1cmVNZXRhZGF0YUxvYWRlci5fYmFzZVJlc291cmNlLmdldERlcml2ZWRSZXNvdXJjZSh7XG4gICAgICB1cmw6IGV4dGVuc2lvbi5zY2hlbWFVcmksXG4gICAgfSk7XG4gICAgc2NoZW1hTG9hZGVyID0gUmVzb3VyY2VDYWNoZS5sb2FkU2NoZW1hKHtcbiAgICAgIHJlc291cmNlOiByZXNvdXJjZSxcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBzY2hlbWFMb2FkZXIgPSBSZXNvdXJjZUNhY2hlLmxvYWRTY2hlbWEoe1xuICAgICAgc2NoZW1hOiBleHRlbnNpb24uc2NoZW1hLFxuICAgIH0pO1xuICB9XG5cbiAgZmVhdHVyZU1ldGFkYXRhTG9hZGVyLl9zY2hlbWFMb2FkZXIgPSBzY2hlbWFMb2FkZXI7XG5cbiAgcmV0dXJuIHNjaGVtYUxvYWRlci5wcm9taXNlLnRoZW4oZnVuY3Rpb24gKHNjaGVtYUxvYWRlcikge1xuICAgIHJldHVybiBzY2hlbWFMb2FkZXIuc2NoZW1hO1xuICB9KTtcbn1cblxuLyoqXG4gKiBQcm9jZXNzZXMgdGhlIHJlc291cmNlIHVudGlsIGl0IGJlY29tZXMgcmVhZHkuXG4gKlxuICogQHBhcmFtIHtGcmFtZVN0YXRlfSBmcmFtZVN0YXRlIFRoZSBmcmFtZSBzdGF0ZS5cbiAqIEBwcml2YXRlXG4gKi9cbkdsdGZGZWF0dXJlTWV0YWRhdGFMb2FkZXIucHJvdG90eXBlLnByb2Nlc3MgPSBmdW5jdGlvbiAoZnJhbWVTdGF0ZSkge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwiZnJhbWVTdGF0ZVwiLCBmcmFtZVN0YXRlKTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgaWYgKHRoaXMuX3N0YXRlICE9PSBSZXNvdXJjZUxvYWRlclN0YXRlLkxPQURJTkcpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgdGV4dHVyZUxvYWRlcnMgPSB0aGlzLl90ZXh0dXJlTG9hZGVycztcbiAgdmFyIHRleHR1cmVMb2FkZXJzTGVuZ3RoID0gdGV4dHVyZUxvYWRlcnMubGVuZ3RoO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdGV4dHVyZUxvYWRlcnNMZW5ndGg7ICsraSkge1xuICAgIHZhciB0ZXh0dXJlTG9hZGVyID0gdGV4dHVyZUxvYWRlcnNbaV07XG4gICAgdGV4dHVyZUxvYWRlci5wcm9jZXNzKGZyYW1lU3RhdGUpO1xuICB9XG59O1xuXG5mdW5jdGlvbiB1bmxvYWRCdWZmZXJWaWV3cyhmZWF0dXJlTWV0YWRhdGFMb2FkZXIpIHtcbiAgdmFyIGJ1ZmZlclZpZXdMb2FkZXJzID0gZmVhdHVyZU1ldGFkYXRhTG9hZGVyLl9idWZmZXJWaWV3TG9hZGVycztcbiAgdmFyIGJ1ZmZlclZpZXdMb2FkZXJzTGVuZ3RoID0gYnVmZmVyVmlld0xvYWRlcnMubGVuZ3RoO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGJ1ZmZlclZpZXdMb2FkZXJzTGVuZ3RoOyArK2kpIHtcbiAgICBSZXNvdXJjZUNhY2hlLnVubG9hZChidWZmZXJWaWV3TG9hZGVyc1tpXSk7XG4gIH1cbiAgZmVhdHVyZU1ldGFkYXRhTG9hZGVyLl9idWZmZXJWaWV3TG9hZGVycy5sZW5ndGggPSAwO1xufVxuXG5mdW5jdGlvbiB1bmxvYWRUZXh0dXJlcyhmZWF0dXJlTWV0YWRhdGFMb2FkZXIpIHtcbiAgdmFyIHRleHR1cmVMb2FkZXJzID0gZmVhdHVyZU1ldGFkYXRhTG9hZGVyLl90ZXh0dXJlTG9hZGVycztcbiAgdmFyIHRleHR1cmVMb2FkZXJzTGVuZ3RoID0gdGV4dHVyZUxvYWRlcnMubGVuZ3RoO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHRleHR1cmVMb2FkZXJzTGVuZ3RoOyArK2kpIHtcbiAgICBSZXNvdXJjZUNhY2hlLnVubG9hZCh0ZXh0dXJlTG9hZGVyc1tpXSk7XG4gIH1cbiAgZmVhdHVyZU1ldGFkYXRhTG9hZGVyLl90ZXh0dXJlTG9hZGVycy5sZW5ndGggPSAwO1xufVxuXG4vKipcbiAqIFVubG9hZHMgdGhlIHJlc291cmNlLlxuICogQHByaXZhdGVcbiAqL1xuR2x0ZkZlYXR1cmVNZXRhZGF0YUxvYWRlci5wcm90b3R5cGUudW5sb2FkID0gZnVuY3Rpb24gKCkge1xuICB1bmxvYWRCdWZmZXJWaWV3cyh0aGlzKTtcbiAgdW5sb2FkVGV4dHVyZXModGhpcyk7XG5cbiAgaWYgKGRlZmluZWQodGhpcy5fc2NoZW1hTG9hZGVyKSkge1xuICAgIFJlc291cmNlQ2FjaGUudW5sb2FkKHRoaXMuX3NjaGVtYUxvYWRlcik7XG4gIH1cbiAgdGhpcy5fc2NoZW1hTG9hZGVyID0gdW5kZWZpbmVkO1xuXG4gIHRoaXMuX2ZlYXR1cmVNZXRhZGF0YSA9IHVuZGVmaW5lZDtcbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///42670\n')},24351:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "Z": function() { return /* binding */ GltfImageLoader; }\n/* harmony export */ });\n/* harmony import */ var _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(66553);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(82982);\n/* harmony import */ var _Core_loadImageFromTypedArray_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(10945);\n/* harmony import */ var _Core_loadKTX2_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(54973);\n/* harmony import */ var _Core_RuntimeError_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(9407);\n/* harmony import */ var _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(13222);\n/* harmony import */ var _ResourceLoader_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(29789);\n/* harmony import */ var _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(89356);\n\n\n\n\n\n\n\n\n\n\n/**\n * Loads a glTF image.\n * <p>\n * Implements the {@link ResourceLoader} interface.\n * </p>\n *\n * @alias GltfImageLoader\n * @constructor\n * @augments ResourceLoader\n *\n * @param {Object} options Object with the following properties:\n * @param {ResourceCache} options.resourceCache The {@link ResourceCache} (to avoid circular dependencies).\n * @param {Object} options.gltf The glTF JSON.\n * @param {Number} options.imageId The image ID.\n * @param {Resource} options.gltfResource The {@link Resource} containing the glTF.\n * @param {Resource} options.baseResource The {@link Resource} that paths in the glTF JSON are relative to.\n * @param {String} [options.cacheKey] The cache key of the resource.\n *\n * @private\n */\nfunction GltfImageLoader(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n  var resourceCache = options.resourceCache;\n  var gltf = options.gltf;\n  var imageId = options.imageId;\n  var gltfResource = options.gltfResource;\n  var baseResource = options.baseResource;\n  var cacheKey = options.cacheKey;\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.func */ .Z.typeOf.func("options.resourceCache", resourceCache);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.gltf", gltf);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.number */ .Z.typeOf.number("options.imageId", imageId);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.gltfResource", gltfResource);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.baseResource", baseResource);\n  //>>includeEnd(\'debug\');\n\n  var image = gltf.images[imageId];\n  var bufferViewId = image.bufferView;\n  var uri = image.uri;\n\n  this._resourceCache = resourceCache;\n  this._gltfResource = gltfResource;\n  this._baseResource = baseResource;\n  this._gltf = gltf;\n  this._bufferViewId = bufferViewId;\n  this._uri = uri;\n  this._cacheKey = cacheKey;\n  this._bufferViewLoader = undefined;\n  this._image = undefined;\n  this._mipLevels = undefined;\n  this._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].UNLOADED */ .Z.UNLOADED;\n  this._promise = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].defer */ .Z.defer();\n}\n\nif ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(Object.create)) {\n  GltfImageLoader.prototype = Object.create(_ResourceLoader_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].prototype */ .Z.prototype);\n  GltfImageLoader.prototype.constructor = GltfImageLoader;\n}\n\nObject.defineProperties(GltfImageLoader.prototype, {\n  /**\n   * A promise that resolves to the resource when the resource is ready.\n   *\n   * @memberof GltfImageLoader.prototype\n   *\n   * @type {Promise.<GltfImageLoader>}\n   * @readonly\n   * @private\n   */\n  promise: {\n    get: function () {\n      return this._promise.promise;\n    },\n  },\n  /**\n   * The cache key of the resource.\n   *\n   * @memberof GltfImageLoader.prototype\n   *\n   * @type {String}\n   * @readonly\n   * @private\n   */\n  cacheKey: {\n    get: function () {\n      return this._cacheKey;\n    },\n  },\n  /**\n   * The image.\n   *\n   * @memberof GltfImageLoader.prototype\n   *\n   * @type {Image|ImageBitmap|CompressedTextureBuffer}\n   * @readonly\n   * @private\n   */\n  image: {\n    get: function () {\n      return this._image;\n    },\n  },\n  /**\n   * The mip levels. Only defined for KTX2 files containing mip levels.\n   *\n   * @memberof GltfImageLoader.prototype\n   *\n   * @type {Uint8Array[]}\n   * @readonly\n   * @private\n   */\n  mipLevels: {\n    get: function () {\n      return this._mipLevels;\n    },\n  },\n});\n\n/**\n * Loads the resource.\n * @private\n */\nGltfImageLoader.prototype.load = function () {\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(this._bufferViewId)) {\n    loadFromBufferView(this);\n  } else {\n    loadFromUri(this);\n  }\n};\n\nfunction getImageAndMipLevels(image) {\n  // Images transcoded from KTX2 can contain multiple mip levels:\n  // https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_basisu\n  var mipLevels;\n  if (Array.isArray(image)) {\n    // highest detail mip should be level 0\n    mipLevels = image.slice(1, image.length).map(function (mipLevel) {\n      return mipLevel.bufferView;\n    });\n    image = image[0];\n  }\n  return {\n    image: image,\n    mipLevels: mipLevels,\n  };\n}\n\nfunction loadFromBufferView(imageLoader) {\n  var resourceCache = imageLoader._resourceCache;\n  var bufferViewLoader = resourceCache.loadBufferView({\n    gltf: imageLoader._gltf,\n    bufferViewId: imageLoader._bufferViewId,\n    gltfResource: imageLoader._gltfResource,\n    baseResource: imageLoader._baseResource,\n  });\n\n  imageLoader._bufferViewLoader = bufferViewLoader;\n  imageLoader._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].LOADING */ .Z.LOADING;\n\n  bufferViewLoader.promise\n    .then(function () {\n      if (imageLoader.isDestroyed()) {\n        return;\n      }\n\n      var typedArray = bufferViewLoader.typedArray;\n      return loadImageFromBufferTypedArray(typedArray).then(function (image) {\n        if (imageLoader.isDestroyed()) {\n          return;\n        }\n\n        var imageAndMipLevels = getImageAndMipLevels(image);\n\n        // Unload everything except the image\n        imageLoader.unload();\n\n        imageLoader._image = imageAndMipLevels.image;\n        imageLoader._mipLevels = imageAndMipLevels.mipLevels;\n        imageLoader._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].READY */ .Z.READY;\n        imageLoader._promise.resolve(imageLoader);\n      });\n    })\n    .otherwise(function (error) {\n      if (imageLoader.isDestroyed()) {\n        return;\n      }\n      handleError(imageLoader, error, "Failed to load embedded image");\n    });\n}\n\nfunction loadFromUri(imageLoader) {\n  var baseResource = imageLoader._baseResource;\n  var uri = imageLoader._uri;\n  var resource = baseResource.getDerivedResource({\n    url: uri,\n  });\n  imageLoader._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].LOADING */ .Z.LOADING;\n  loadImageFromUri(resource)\n    .then(function (image) {\n      if (imageLoader.isDestroyed()) {\n        return;\n      }\n\n      var imageAndMipLevels = getImageAndMipLevels(image);\n\n      // Unload everything except the image\n      imageLoader.unload();\n\n      imageLoader._image = imageAndMipLevels.image;\n      imageLoader._mipLevels = imageAndMipLevels.mipLevels;\n      imageLoader._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].READY */ .Z.READY;\n      imageLoader._promise.resolve(imageLoader);\n    })\n    .otherwise(function (error) {\n      if (imageLoader.isDestroyed()) {\n        return;\n      }\n      handleError(imageLoader, error, "Failed to load image: " + uri);\n    });\n}\n\nfunction handleError(imageLoader, error, errorMessage) {\n  imageLoader.unload();\n  imageLoader._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].FAILED */ .Z.FAILED;\n  imageLoader._promise.reject(imageLoader.getError(errorMessage, error));\n}\n\nfunction getMimeTypeFromTypedArray(typedArray) {\n  var header = typedArray.subarray(0, 2);\n  var webpHeaderRIFFChars = typedArray.subarray(0, 4);\n  var webpHeaderWEBPChars = typedArray.subarray(8, 12);\n\n  if (header[0] === 0xff && header[1] === 0xd8) {\n    // See https://en.wikipedia.org/wiki/JPEG_File_Interchange_Format\n    return "image/jpeg";\n  } else if (header[0] === 0x89 && header[1] === 0x50) {\n    // See http://www.libpng.org/pub/png/spec/1.2/PNG-Structure.html\n    return "image/png";\n  } else if (header[0] === 0xab && header[1] === 0x4b) {\n    // See http://github.khronos.org/KTX-Specification/#_identifier\n    return "image/ktx2";\n  } else if (\n    // See https://developers.google.com/speed/webp/docs/riff_container#webp_file_header\n    webpHeaderRIFFChars[0] === 0x52 &&\n    webpHeaderRIFFChars[1] === 0x49 &&\n    webpHeaderRIFFChars[2] === 0x46 &&\n    webpHeaderRIFFChars[3] === 0x46 &&\n    webpHeaderWEBPChars[0] === 0x57 &&\n    webpHeaderWEBPChars[1] === 0x45 &&\n    webpHeaderWEBPChars[2] === 0x42 &&\n    webpHeaderWEBPChars[3] === 0x50\n  ) {\n    return "image/webp";\n  }\n\n  throw new _Core_RuntimeError_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z("Image format is not recognized");\n}\n\nfunction loadImageFromBufferTypedArray(typedArray) {\n  var mimeType = getMimeTypeFromTypedArray(typedArray);\n  if (mimeType === "image/ktx2") {\n    // Need to make a copy of the embedded KTX2 buffer otherwise the underlying\n    // ArrayBuffer may be accessed on both the worker and the main thread and\n    // throw an error like "Cannot perform Construct on a detached ArrayBuffer".\n    // Look into SharedArrayBuffer at some point to get around this.\n    var ktxBuffer = new Uint8Array(typedArray);\n\n    // Resolves to a CompressedTextureBuffer\n    return (0,_Core_loadKTX2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(ktxBuffer);\n  }\n  // Resolves to an Image or ImageBitmap\n  return GltfImageLoader._loadImageFromTypedArray({\n    uint8Array: typedArray,\n    format: mimeType,\n    flipY: false,\n    skipColorSpaceConversion: true,\n  });\n}\n\nvar ktx2Regex = /(^data:image\\/ktx2)|(\\.ktx2$)/i;\n\nfunction loadImageFromUri(resource) {\n  var uri = resource.url;\n  if (ktx2Regex.test(uri)) {\n    // Resolves to a CompressedTextureBuffer\n    return (0,_Core_loadKTX2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(resource);\n  }\n  // Resolves to an ImageBitmap or Image\n  return resource.fetchImage({\n    skipColorSpaceConversion: true,\n    preferImageBitmap: true,\n  });\n}\n\n/**\n * Unloads the resource.\n * @private\n */\nGltfImageLoader.prototype.unload = function () {\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(this._bufferViewLoader)) {\n    this._resourceCache.unload(this._bufferViewLoader);\n  }\n\n  this._bufferViewLoader = undefined;\n  this._uri = undefined; // Free in case the uri is a data uri\n  this._image = undefined;\n  this._mipLevels = undefined;\n  this._gltf = undefined;\n};\n\n// Exposed for testing\nGltfImageLoader._loadImageFromTypedArray = _Core_loadImageFromTypedArray_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WTtBQUN4Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsV0FBVyxzRUFBUTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsc0VBQVE7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxxRUFBTztBQUNiO0FBQ0E7O0FBRUE7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSwyQ0FBMkMsaUZBQXVCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnVlMy13ZWJwYWNrNS8uL25vZGVfbW9kdWxlcy9jZXNpdW0vU291cmNlL1NjZW5lL0dsdGZJbWFnZUxvYWRlci5qcz9jMThkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDaGVjayBmcm9tIFwiLi4vQ29yZS9DaGVjay5qc1wiO1xuaW1wb3J0IGRlZmF1bHRWYWx1ZSBmcm9tIFwiLi4vQ29yZS9kZWZhdWx0VmFsdWUuanNcIjtcbmltcG9ydCBkZWZpbmVkIGZyb20gXCIuLi9Db3JlL2RlZmluZWQuanNcIjtcbmltcG9ydCBsb2FkSW1hZ2VGcm9tVHlwZWRBcnJheSBmcm9tIFwiLi4vQ29yZS9sb2FkSW1hZ2VGcm9tVHlwZWRBcnJheS5qc1wiO1xuaW1wb3J0IGxvYWRLVFgyIGZyb20gXCIuLi9Db3JlL2xvYWRLVFgyLmpzXCI7XG5pbXBvcnQgUnVudGltZUVycm9yIGZyb20gXCIuLi9Db3JlL1J1bnRpbWVFcnJvci5qc1wiO1xuaW1wb3J0IHdoZW4gZnJvbSBcIi4uL1RoaXJkUGFydHkvd2hlbi5qc1wiO1xuaW1wb3J0IFJlc291cmNlTG9hZGVyIGZyb20gXCIuL1Jlc291cmNlTG9hZGVyLmpzXCI7XG5pbXBvcnQgUmVzb3VyY2VMb2FkZXJTdGF0ZSBmcm9tIFwiLi9SZXNvdXJjZUxvYWRlclN0YXRlLmpzXCI7XG5cbi8qKlxuICogTG9hZHMgYSBnbFRGIGltYWdlLlxuICogPHA+XG4gKiBJbXBsZW1lbnRzIHRoZSB7QGxpbmsgUmVzb3VyY2VMb2FkZXJ9IGludGVyZmFjZS5cbiAqIDwvcD5cbiAqXG4gKiBAYWxpYXMgR2x0ZkltYWdlTG9hZGVyXG4gKiBAY29uc3RydWN0b3JcbiAqIEBhdWdtZW50cyBSZXNvdXJjZUxvYWRlclxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIE9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqIEBwYXJhbSB7UmVzb3VyY2VDYWNoZX0gb3B0aW9ucy5yZXNvdXJjZUNhY2hlIFRoZSB7QGxpbmsgUmVzb3VyY2VDYWNoZX0gKHRvIGF2b2lkIGNpcmN1bGFyIGRlcGVuZGVuY2llcykuXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucy5nbHRmIFRoZSBnbFRGIEpTT04uXG4gKiBAcGFyYW0ge051bWJlcn0gb3B0aW9ucy5pbWFnZUlkIFRoZSBpbWFnZSBJRC5cbiAqIEBwYXJhbSB7UmVzb3VyY2V9IG9wdGlvbnMuZ2x0ZlJlc291cmNlIFRoZSB7QGxpbmsgUmVzb3VyY2V9IGNvbnRhaW5pbmcgdGhlIGdsVEYuXG4gKiBAcGFyYW0ge1Jlc291cmNlfSBvcHRpb25zLmJhc2VSZXNvdXJjZSBUaGUge0BsaW5rIFJlc291cmNlfSB0aGF0IHBhdGhzIGluIHRoZSBnbFRGIEpTT04gYXJlIHJlbGF0aXZlIHRvLlxuICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLmNhY2hlS2V5XSBUaGUgY2FjaGUga2V5IG9mIHRoZSByZXNvdXJjZS5cbiAqXG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBHbHRmSW1hZ2VMb2FkZXIob3B0aW9ucykge1xuICBvcHRpb25zID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMsIGRlZmF1bHRWYWx1ZS5FTVBUWV9PQkpFQ1QpO1xuICB2YXIgcmVzb3VyY2VDYWNoZSA9IG9wdGlvbnMucmVzb3VyY2VDYWNoZTtcbiAgdmFyIGdsdGYgPSBvcHRpb25zLmdsdGY7XG4gIHZhciBpbWFnZUlkID0gb3B0aW9ucy5pbWFnZUlkO1xuICB2YXIgZ2x0ZlJlc291cmNlID0gb3B0aW9ucy5nbHRmUmVzb3VyY2U7XG4gIHZhciBiYXNlUmVzb3VyY2UgPSBvcHRpb25zLmJhc2VSZXNvdXJjZTtcbiAgdmFyIGNhY2hlS2V5ID0gb3B0aW9ucy5jYWNoZUtleTtcblxuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2YuZnVuYyhcIm9wdGlvbnMucmVzb3VyY2VDYWNoZVwiLCByZXNvdXJjZUNhY2hlKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcIm9wdGlvbnMuZ2x0ZlwiLCBnbHRmKTtcbiAgQ2hlY2sudHlwZU9mLm51bWJlcihcIm9wdGlvbnMuaW1hZ2VJZFwiLCBpbWFnZUlkKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcIm9wdGlvbnMuZ2x0ZlJlc291cmNlXCIsIGdsdGZSZXNvdXJjZSk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJvcHRpb25zLmJhc2VSZXNvdXJjZVwiLCBiYXNlUmVzb3VyY2UpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB2YXIgaW1hZ2UgPSBnbHRmLmltYWdlc1tpbWFnZUlkXTtcbiAgdmFyIGJ1ZmZlclZpZXdJZCA9IGltYWdlLmJ1ZmZlclZpZXc7XG4gIHZhciB1cmkgPSBpbWFnZS51cmk7XG5cbiAgdGhpcy5fcmVzb3VyY2VDYWNoZSA9IHJlc291cmNlQ2FjaGU7XG4gIHRoaXMuX2dsdGZSZXNvdXJjZSA9IGdsdGZSZXNvdXJjZTtcbiAgdGhpcy5fYmFzZVJlc291cmNlID0gYmFzZVJlc291cmNlO1xuICB0aGlzLl9nbHRmID0gZ2x0ZjtcbiAgdGhpcy5fYnVmZmVyVmlld0lkID0gYnVmZmVyVmlld0lkO1xuICB0aGlzLl91cmkgPSB1cmk7XG4gIHRoaXMuX2NhY2hlS2V5ID0gY2FjaGVLZXk7XG4gIHRoaXMuX2J1ZmZlclZpZXdMb2FkZXIgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2ltYWdlID0gdW5kZWZpbmVkO1xuICB0aGlzLl9taXBMZXZlbHMgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX3N0YXRlID0gUmVzb3VyY2VMb2FkZXJTdGF0ZS5VTkxPQURFRDtcbiAgdGhpcy5fcHJvbWlzZSA9IHdoZW4uZGVmZXIoKTtcbn1cblxuaWYgKGRlZmluZWQoT2JqZWN0LmNyZWF0ZSkpIHtcbiAgR2x0ZkltYWdlTG9hZGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUmVzb3VyY2VMb2FkZXIucHJvdG90eXBlKTtcbiAgR2x0ZkltYWdlTG9hZGVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEdsdGZJbWFnZUxvYWRlcjtcbn1cblxuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoR2x0ZkltYWdlTG9hZGVyLnByb3RvdHlwZSwge1xuICAvKipcbiAgICogQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc291cmNlIHdoZW4gdGhlIHJlc291cmNlIGlzIHJlYWR5LlxuICAgKlxuICAgKiBAbWVtYmVyb2YgR2x0ZkltYWdlTG9hZGVyLnByb3RvdHlwZVxuICAgKlxuICAgKiBAdHlwZSB7UHJvbWlzZS48R2x0ZkltYWdlTG9hZGVyPn1cbiAgICogQHJlYWRvbmx5XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcm9taXNlOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcHJvbWlzZS5wcm9taXNlO1xuICAgIH0sXG4gIH0sXG4gIC8qKlxuICAgKiBUaGUgY2FjaGUga2V5IG9mIHRoZSByZXNvdXJjZS5cbiAgICpcbiAgICogQG1lbWJlcm9mIEdsdGZJbWFnZUxvYWRlci5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge1N0cmluZ31cbiAgICogQHJlYWRvbmx5XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBjYWNoZUtleToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlS2V5O1xuICAgIH0sXG4gIH0sXG4gIC8qKlxuICAgKiBUaGUgaW1hZ2UuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBHbHRmSW1hZ2VMb2FkZXIucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtJbWFnZXxJbWFnZUJpdG1hcHxDb21wcmVzc2VkVGV4dHVyZUJ1ZmZlcn1cbiAgICogQHJlYWRvbmx5XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBpbWFnZToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2ltYWdlO1xuICAgIH0sXG4gIH0sXG4gIC8qKlxuICAgKiBUaGUgbWlwIGxldmVscy4gT25seSBkZWZpbmVkIGZvciBLVFgyIGZpbGVzIGNvbnRhaW5pbmcgbWlwIGxldmVscy5cbiAgICpcbiAgICogQG1lbWJlcm9mIEdsdGZJbWFnZUxvYWRlci5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge1VpbnQ4QXJyYXlbXX1cbiAgICogQHJlYWRvbmx5XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBtaXBMZXZlbHM6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9taXBMZXZlbHM7XG4gICAgfSxcbiAgfSxcbn0pO1xuXG4vKipcbiAqIExvYWRzIHRoZSByZXNvdXJjZS5cbiAqIEBwcml2YXRlXG4gKi9cbkdsdGZJbWFnZUxvYWRlci5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRlZmluZWQodGhpcy5fYnVmZmVyVmlld0lkKSkge1xuICAgIGxvYWRGcm9tQnVmZmVyVmlldyh0aGlzKTtcbiAgfSBlbHNlIHtcbiAgICBsb2FkRnJvbVVyaSh0aGlzKTtcbiAgfVxufTtcblxuZnVuY3Rpb24gZ2V0SW1hZ2VBbmRNaXBMZXZlbHMoaW1hZ2UpIHtcbiAgLy8gSW1hZ2VzIHRyYW5zY29kZWQgZnJvbSBLVFgyIGNhbiBjb250YWluIG11bHRpcGxlIG1pcCBsZXZlbHM6XG4gIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9LaHJvbm9zR3JvdXAvZ2xURi90cmVlL21hc3Rlci9leHRlbnNpb25zLzIuMC9LaHJvbm9zL0tIUl90ZXh0dXJlX2Jhc2lzdVxuICB2YXIgbWlwTGV2ZWxzO1xuICBpZiAoQXJyYXkuaXNBcnJheShpbWFnZSkpIHtcbiAgICAvLyBoaWdoZXN0IGRldGFpbCBtaXAgc2hvdWxkIGJlIGxldmVsIDBcbiAgICBtaXBMZXZlbHMgPSBpbWFnZS5zbGljZSgxLCBpbWFnZS5sZW5ndGgpLm1hcChmdW5jdGlvbiAobWlwTGV2ZWwpIHtcbiAgICAgIHJldHVybiBtaXBMZXZlbC5idWZmZXJWaWV3O1xuICAgIH0pO1xuICAgIGltYWdlID0gaW1hZ2VbMF07XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBpbWFnZTogaW1hZ2UsXG4gICAgbWlwTGV2ZWxzOiBtaXBMZXZlbHMsXG4gIH07XG59XG5cbmZ1bmN0aW9uIGxvYWRGcm9tQnVmZmVyVmlldyhpbWFnZUxvYWRlcikge1xuICB2YXIgcmVzb3VyY2VDYWNoZSA9IGltYWdlTG9hZGVyLl9yZXNvdXJjZUNhY2hlO1xuICB2YXIgYnVmZmVyVmlld0xvYWRlciA9IHJlc291cmNlQ2FjaGUubG9hZEJ1ZmZlclZpZXcoe1xuICAgIGdsdGY6IGltYWdlTG9hZGVyLl9nbHRmLFxuICAgIGJ1ZmZlclZpZXdJZDogaW1hZ2VMb2FkZXIuX2J1ZmZlclZpZXdJZCxcbiAgICBnbHRmUmVzb3VyY2U6IGltYWdlTG9hZGVyLl9nbHRmUmVzb3VyY2UsXG4gICAgYmFzZVJlc291cmNlOiBpbWFnZUxvYWRlci5fYmFzZVJlc291cmNlLFxuICB9KTtcblxuICBpbWFnZUxvYWRlci5fYnVmZmVyVmlld0xvYWRlciA9IGJ1ZmZlclZpZXdMb2FkZXI7XG4gIGltYWdlTG9hZGVyLl9zdGF0ZSA9IFJlc291cmNlTG9hZGVyU3RhdGUuTE9BRElORztcblxuICBidWZmZXJWaWV3TG9hZGVyLnByb21pc2VcbiAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoaW1hZ2VMb2FkZXIuaXNEZXN0cm95ZWQoKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciB0eXBlZEFycmF5ID0gYnVmZmVyVmlld0xvYWRlci50eXBlZEFycmF5O1xuICAgICAgcmV0dXJuIGxvYWRJbWFnZUZyb21CdWZmZXJUeXBlZEFycmF5KHR5cGVkQXJyYXkpLnRoZW4oZnVuY3Rpb24gKGltYWdlKSB7XG4gICAgICAgIGlmIChpbWFnZUxvYWRlci5pc0Rlc3Ryb3llZCgpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGltYWdlQW5kTWlwTGV2ZWxzID0gZ2V0SW1hZ2VBbmRNaXBMZXZlbHMoaW1hZ2UpO1xuXG4gICAgICAgIC8vIFVubG9hZCBldmVyeXRoaW5nIGV4Y2VwdCB0aGUgaW1hZ2VcbiAgICAgICAgaW1hZ2VMb2FkZXIudW5sb2FkKCk7XG5cbiAgICAgICAgaW1hZ2VMb2FkZXIuX2ltYWdlID0gaW1hZ2VBbmRNaXBMZXZlbHMuaW1hZ2U7XG4gICAgICAgIGltYWdlTG9hZGVyLl9taXBMZXZlbHMgPSBpbWFnZUFuZE1pcExldmVscy5taXBMZXZlbHM7XG4gICAgICAgIGltYWdlTG9hZGVyLl9zdGF0ZSA9IFJlc291cmNlTG9hZGVyU3RhdGUuUkVBRFk7XG4gICAgICAgIGltYWdlTG9hZGVyLl9wcm9taXNlLnJlc29sdmUoaW1hZ2VMb2FkZXIpO1xuICAgICAgfSk7XG4gICAgfSlcbiAgICAub3RoZXJ3aXNlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgaWYgKGltYWdlTG9hZGVyLmlzRGVzdHJveWVkKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaGFuZGxlRXJyb3IoaW1hZ2VMb2FkZXIsIGVycm9yLCBcIkZhaWxlZCB0byBsb2FkIGVtYmVkZGVkIGltYWdlXCIpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBsb2FkRnJvbVVyaShpbWFnZUxvYWRlcikge1xuICB2YXIgYmFzZVJlc291cmNlID0gaW1hZ2VMb2FkZXIuX2Jhc2VSZXNvdXJjZTtcbiAgdmFyIHVyaSA9IGltYWdlTG9hZGVyLl91cmk7XG4gIHZhciByZXNvdXJjZSA9IGJhc2VSZXNvdXJjZS5nZXREZXJpdmVkUmVzb3VyY2Uoe1xuICAgIHVybDogdXJpLFxuICB9KTtcbiAgaW1hZ2VMb2FkZXIuX3N0YXRlID0gUmVzb3VyY2VMb2FkZXJTdGF0ZS5MT0FESU5HO1xuICBsb2FkSW1hZ2VGcm9tVXJpKHJlc291cmNlKVxuICAgIC50aGVuKGZ1bmN0aW9uIChpbWFnZSkge1xuICAgICAgaWYgKGltYWdlTG9hZGVyLmlzRGVzdHJveWVkKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgaW1hZ2VBbmRNaXBMZXZlbHMgPSBnZXRJbWFnZUFuZE1pcExldmVscyhpbWFnZSk7XG5cbiAgICAgIC8vIFVubG9hZCBldmVyeXRoaW5nIGV4Y2VwdCB0aGUgaW1hZ2VcbiAgICAgIGltYWdlTG9hZGVyLnVubG9hZCgpO1xuXG4gICAgICBpbWFnZUxvYWRlci5faW1hZ2UgPSBpbWFnZUFuZE1pcExldmVscy5pbWFnZTtcbiAgICAgIGltYWdlTG9hZGVyLl9taXBMZXZlbHMgPSBpbWFnZUFuZE1pcExldmVscy5taXBMZXZlbHM7XG4gICAgICBpbWFnZUxvYWRlci5fc3RhdGUgPSBSZXNvdXJjZUxvYWRlclN0YXRlLlJFQURZO1xuICAgICAgaW1hZ2VMb2FkZXIuX3Byb21pc2UucmVzb2x2ZShpbWFnZUxvYWRlcik7XG4gICAgfSlcbiAgICAub3RoZXJ3aXNlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgaWYgKGltYWdlTG9hZGVyLmlzRGVzdHJveWVkKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaGFuZGxlRXJyb3IoaW1hZ2VMb2FkZXIsIGVycm9yLCBcIkZhaWxlZCB0byBsb2FkIGltYWdlOiBcIiArIHVyaSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUVycm9yKGltYWdlTG9hZGVyLCBlcnJvciwgZXJyb3JNZXNzYWdlKSB7XG4gIGltYWdlTG9hZGVyLnVubG9hZCgpO1xuICBpbWFnZUxvYWRlci5fc3RhdGUgPSBSZXNvdXJjZUxvYWRlclN0YXRlLkZBSUxFRDtcbiAgaW1hZ2VMb2FkZXIuX3Byb21pc2UucmVqZWN0KGltYWdlTG9hZGVyLmdldEVycm9yKGVycm9yTWVzc2FnZSwgZXJyb3IpKTtcbn1cblxuZnVuY3Rpb24gZ2V0TWltZVR5cGVGcm9tVHlwZWRBcnJheSh0eXBlZEFycmF5KSB7XG4gIHZhciBoZWFkZXIgPSB0eXBlZEFycmF5LnN1YmFycmF5KDAsIDIpO1xuICB2YXIgd2VicEhlYWRlclJJRkZDaGFycyA9IHR5cGVkQXJyYXkuc3ViYXJyYXkoMCwgNCk7XG4gIHZhciB3ZWJwSGVhZGVyV0VCUENoYXJzID0gdHlwZWRBcnJheS5zdWJhcnJheSg4LCAxMik7XG5cbiAgaWYgKGhlYWRlclswXSA9PT0gMHhmZiAmJiBoZWFkZXJbMV0gPT09IDB4ZDgpIHtcbiAgICAvLyBTZWUgaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvSlBFR19GaWxlX0ludGVyY2hhbmdlX0Zvcm1hdFxuICAgIHJldHVybiBcImltYWdlL2pwZWdcIjtcbiAgfSBlbHNlIGlmIChoZWFkZXJbMF0gPT09IDB4ODkgJiYgaGVhZGVyWzFdID09PSAweDUwKSB7XG4gICAgLy8gU2VlIGh0dHA6Ly93d3cubGlicG5nLm9yZy9wdWIvcG5nL3NwZWMvMS4yL1BORy1TdHJ1Y3R1cmUuaHRtbFxuICAgIHJldHVybiBcImltYWdlL3BuZ1wiO1xuICB9IGVsc2UgaWYgKGhlYWRlclswXSA9PT0gMHhhYiAmJiBoZWFkZXJbMV0gPT09IDB4NGIpIHtcbiAgICAvLyBTZWUgaHR0cDovL2dpdGh1Yi5raHJvbm9zLm9yZy9LVFgtU3BlY2lmaWNhdGlvbi8jX2lkZW50aWZpZXJcbiAgICByZXR1cm4gXCJpbWFnZS9rdHgyXCI7XG4gIH0gZWxzZSBpZiAoXG4gICAgLy8gU2VlIGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL3NwZWVkL3dlYnAvZG9jcy9yaWZmX2NvbnRhaW5lciN3ZWJwX2ZpbGVfaGVhZGVyXG4gICAgd2VicEhlYWRlclJJRkZDaGFyc1swXSA9PT0gMHg1MiAmJlxuICAgIHdlYnBIZWFkZXJSSUZGQ2hhcnNbMV0gPT09IDB4NDkgJiZcbiAgICB3ZWJwSGVhZGVyUklGRkNoYXJzWzJdID09PSAweDQ2ICYmXG4gICAgd2VicEhlYWRlclJJRkZDaGFyc1szXSA9PT0gMHg0NiAmJlxuICAgIHdlYnBIZWFkZXJXRUJQQ2hhcnNbMF0gPT09IDB4NTcgJiZcbiAgICB3ZWJwSGVhZGVyV0VCUENoYXJzWzFdID09PSAweDQ1ICYmXG4gICAgd2VicEhlYWRlcldFQlBDaGFyc1syXSA9PT0gMHg0MiAmJlxuICAgIHdlYnBIZWFkZXJXRUJQQ2hhcnNbM10gPT09IDB4NTBcbiAgKSB7XG4gICAgcmV0dXJuIFwiaW1hZ2Uvd2VicFwiO1xuICB9XG5cbiAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcihcIkltYWdlIGZvcm1hdCBpcyBub3QgcmVjb2duaXplZFwiKTtcbn1cblxuZnVuY3Rpb24gbG9hZEltYWdlRnJvbUJ1ZmZlclR5cGVkQXJyYXkodHlwZWRBcnJheSkge1xuICB2YXIgbWltZVR5cGUgPSBnZXRNaW1lVHlwZUZyb21UeXBlZEFycmF5KHR5cGVkQXJyYXkpO1xuICBpZiAobWltZVR5cGUgPT09IFwiaW1hZ2Uva3R4MlwiKSB7XG4gICAgLy8gTmVlZCB0byBtYWtlIGEgY29weSBvZiB0aGUgZW1iZWRkZWQgS1RYMiBidWZmZXIgb3RoZXJ3aXNlIHRoZSB1bmRlcmx5aW5nXG4gICAgLy8gQXJyYXlCdWZmZXIgbWF5IGJlIGFjY2Vzc2VkIG9uIGJvdGggdGhlIHdvcmtlciBhbmQgdGhlIG1haW4gdGhyZWFkIGFuZFxuICAgIC8vIHRocm93IGFuIGVycm9yIGxpa2UgXCJDYW5ub3QgcGVyZm9ybSBDb25zdHJ1Y3Qgb24gYSBkZXRhY2hlZCBBcnJheUJ1ZmZlclwiLlxuICAgIC8vIExvb2sgaW50byBTaGFyZWRBcnJheUJ1ZmZlciBhdCBzb21lIHBvaW50IHRvIGdldCBhcm91bmQgdGhpcy5cbiAgICB2YXIga3R4QnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkodHlwZWRBcnJheSk7XG5cbiAgICAvLyBSZXNvbHZlcyB0byBhIENvbXByZXNzZWRUZXh0dXJlQnVmZmVyXG4gICAgcmV0dXJuIGxvYWRLVFgyKGt0eEJ1ZmZlcik7XG4gIH1cbiAgLy8gUmVzb2x2ZXMgdG8gYW4gSW1hZ2Ugb3IgSW1hZ2VCaXRtYXBcbiAgcmV0dXJuIEdsdGZJbWFnZUxvYWRlci5fbG9hZEltYWdlRnJvbVR5cGVkQXJyYXkoe1xuICAgIHVpbnQ4QXJyYXk6IHR5cGVkQXJyYXksXG4gICAgZm9ybWF0OiBtaW1lVHlwZSxcbiAgICBmbGlwWTogZmFsc2UsXG4gICAgc2tpcENvbG9yU3BhY2VDb252ZXJzaW9uOiB0cnVlLFxuICB9KTtcbn1cblxudmFyIGt0eDJSZWdleCA9IC8oXmRhdGE6aW1hZ2VcXC9rdHgyKXwoXFwua3R4MiQpL2k7XG5cbmZ1bmN0aW9uIGxvYWRJbWFnZUZyb21VcmkocmVzb3VyY2UpIHtcbiAgdmFyIHVyaSA9IHJlc291cmNlLnVybDtcbiAgaWYgKGt0eDJSZWdleC50ZXN0KHVyaSkpIHtcbiAgICAvLyBSZXNvbHZlcyB0byBhIENvbXByZXNzZWRUZXh0dXJlQnVmZmVyXG4gICAgcmV0dXJuIGxvYWRLVFgyKHJlc291cmNlKTtcbiAgfVxuICAvLyBSZXNvbHZlcyB0byBhbiBJbWFnZUJpdG1hcCBvciBJbWFnZVxuICByZXR1cm4gcmVzb3VyY2UuZmV0Y2hJbWFnZSh7XG4gICAgc2tpcENvbG9yU3BhY2VDb252ZXJzaW9uOiB0cnVlLFxuICAgIHByZWZlckltYWdlQml0bWFwOiB0cnVlLFxuICB9KTtcbn1cblxuLyoqXG4gKiBVbmxvYWRzIHRoZSByZXNvdXJjZS5cbiAqIEBwcml2YXRlXG4gKi9cbkdsdGZJbWFnZUxvYWRlci5wcm90b3R5cGUudW5sb2FkID0gZnVuY3Rpb24gKCkge1xuICBpZiAoZGVmaW5lZCh0aGlzLl9idWZmZXJWaWV3TG9hZGVyKSkge1xuICAgIHRoaXMuX3Jlc291cmNlQ2FjaGUudW5sb2FkKHRoaXMuX2J1ZmZlclZpZXdMb2FkZXIpO1xuICB9XG5cbiAgdGhpcy5fYnVmZmVyVmlld0xvYWRlciA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fdXJpID0gdW5kZWZpbmVkOyAvLyBGcmVlIGluIGNhc2UgdGhlIHVyaSBpcyBhIGRhdGEgdXJpXG4gIHRoaXMuX2ltYWdlID0gdW5kZWZpbmVkO1xuICB0aGlzLl9taXBMZXZlbHMgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2dsdGYgPSB1bmRlZmluZWQ7XG59O1xuXG4vLyBFeHBvc2VkIGZvciB0ZXN0aW5nXG5HbHRmSW1hZ2VMb2FkZXIuX2xvYWRJbWFnZUZyb21UeXBlZEFycmF5ID0gbG9hZEltYWdlRnJvbVR5cGVkQXJyYXk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///24351\n')},28096:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "Z": function() { return /* binding */ GltfIndexBufferLoader; }\n/* harmony export */ });\n/* harmony import */ var _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(66553);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(82982);\n/* harmony import */ var _Core_IndexDatatype_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(22832);\n/* harmony import */ var _Renderer_Buffer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(99095);\n/* harmony import */ var _Renderer_BufferUsage_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(58597);\n/* harmony import */ var _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(13222);\n/* harmony import */ var _JobType_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(92454);\n/* harmony import */ var _ResourceLoader_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(29789);\n/* harmony import */ var _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(89356);\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Loads an index buffer from a glTF accessor.\n * <p>\n * Implements the {@link ResourceLoader} interface.\n * </p>\n *\n * @alias GltfIndexBufferLoader\n * @constructor\n * @augments ResourceLoader\n *\n * @param {Object} options Object with the following properties:\n * @param {ResourceCache} options.resourceCache The {@link ResourceCache} (to avoid circular dependencies).\n * @param {Object} options.gltf The glTF JSON.\n * @param {Number} options.accessorId The accessor ID corresponding to the index buffer.\n * @param {Resource} options.gltfResource The {@link Resource} containing the glTF.\n * @param {Resource} options.baseResource The {@link Resource} that paths in the glTF JSON are relative to.\n * @param {Object} [options.draco] The Draco extension object.\n * @param {String} [options.cacheKey] The cache key of the resource.\n * @param {Boolean} [options.asynchronous=true] Determines if WebGL resource creation will be spread out over several frames or block until all WebGL resources are created.\n *\n * @private\n */\nfunction GltfIndexBufferLoader(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n  var resourceCache = options.resourceCache;\n  var gltf = options.gltf;\n  var accessorId = options.accessorId;\n  var gltfResource = options.gltfResource;\n  var baseResource = options.baseResource;\n  var draco = options.draco;\n  var cacheKey = options.cacheKey;\n  var asynchronous = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(options.asynchronous, true);\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.func */ .Z.typeOf.func("options.resourceCache", resourceCache);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.gltf", gltf);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.number */ .Z.typeOf.number("options.accessorId", accessorId);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.gltfResource", gltfResource);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.baseResource", baseResource);\n  //>>includeEnd(\'debug\');\n\n  var indexDatatype = gltf.accessors[accessorId].componentType;\n\n  this._resourceCache = resourceCache;\n  this._gltfResource = gltfResource;\n  this._baseResource = baseResource;\n  this._gltf = gltf;\n  this._accessorId = accessorId;\n  this._indexDatatype = indexDatatype;\n  this._draco = draco;\n  this._cacheKey = cacheKey;\n  this._asynchronous = asynchronous;\n  this._bufferViewLoader = undefined;\n  this._dracoLoader = undefined;\n  this._typedArray = undefined;\n  this._indexBuffer = undefined;\n  this._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].UNLOADED */ .Z.UNLOADED;\n  this._promise = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].defer */ .Z.defer();\n}\n\nif ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(Object.create)) {\n  GltfIndexBufferLoader.prototype = Object.create(_ResourceLoader_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].prototype */ .Z.prototype);\n  GltfIndexBufferLoader.prototype.constructor = GltfIndexBufferLoader;\n}\n\nObject.defineProperties(GltfIndexBufferLoader.prototype, {\n  /**\n   * A promise that resolves to the resource when the resource is ready.\n   *\n   * @memberof GltfIndexBufferLoader.prototype\n   *\n   * @type {Promise.<GltfIndexBufferLoader>}\n   * @readonly\n   * @private\n   */\n  promise: {\n    get: function () {\n      return this._promise.promise;\n    },\n  },\n  /**\n   * The cache key of the resource.\n   *\n   * @memberof GltfIndexBufferLoader.prototype\n   *\n   * @type {String}\n   * @readonly\n   * @private\n   */\n  cacheKey: {\n    get: function () {\n      return this._cacheKey;\n    },\n  },\n  /**\n   * The index buffer.\n   *\n   * @memberof GltfIndexBufferLoader.prototype\n   *\n   * @type {Buffer}\n   * @readonly\n   * @private\n   */\n  indexBuffer: {\n    get: function () {\n      return this._indexBuffer;\n    },\n  },\n});\n\n/**\n * Loads the resource.\n * @private\n */\nGltfIndexBufferLoader.prototype.load = function () {\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(this._draco)) {\n    loadFromDraco(this);\n  } else {\n    loadFromBufferView(this);\n  }\n};\n\nfunction loadFromDraco(indexBufferLoader) {\n  var resourceCache = indexBufferLoader._resourceCache;\n  var dracoLoader = resourceCache.loadDraco({\n    gltf: indexBufferLoader._gltf,\n    draco: indexBufferLoader._draco,\n    gltfResource: indexBufferLoader._gltfResource,\n    baseResource: indexBufferLoader._baseResource,\n  });\n\n  indexBufferLoader._dracoLoader = dracoLoader;\n  indexBufferLoader._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].LOADING */ .Z.LOADING;\n\n  dracoLoader.promise\n    .then(function () {\n      if (indexBufferLoader.isDestroyed()) {\n        return;\n      }\n      // Now wait for process() to run to finish loading\n      indexBufferLoader._typedArray =\n        dracoLoader.decodedData.indices.typedArray;\n      indexBufferLoader._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].PROCESSING */ .Z.PROCESSING;\n    })\n    .otherwise(function (error) {\n      if (indexBufferLoader.isDestroyed()) {\n        return;\n      }\n      handleError(indexBufferLoader, error);\n    });\n}\n\nfunction loadFromBufferView(indexBufferLoader) {\n  var gltf = indexBufferLoader._gltf;\n  var accessorId = indexBufferLoader._accessorId;\n  var accessor = gltf.accessors[accessorId];\n  var bufferViewId = accessor.bufferView;\n\n  var resourceCache = indexBufferLoader._resourceCache;\n  var bufferViewLoader = resourceCache.loadBufferView({\n    gltf: gltf,\n    bufferViewId: bufferViewId,\n    gltfResource: indexBufferLoader._gltfResource,\n    baseResource: indexBufferLoader._baseResource,\n  });\n  indexBufferLoader._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].LOADING */ .Z.LOADING;\n  indexBufferLoader._bufferViewLoader = bufferViewLoader;\n\n  bufferViewLoader.promise\n    .then(function () {\n      if (indexBufferLoader.isDestroyed()) {\n        return;\n      }\n      // Now wait for process() to run to finish loading\n      var bufferViewTypedArray = bufferViewLoader.typedArray;\n      indexBufferLoader._typedArray = createIndicesTypedArray(\n        indexBufferLoader,\n        bufferViewTypedArray\n      );\n      indexBufferLoader._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].PROCESSING */ .Z.PROCESSING;\n    })\n    .otherwise(function (error) {\n      if (indexBufferLoader.isDestroyed()) {\n        return;\n      }\n      handleError(indexBufferLoader, error);\n    });\n}\n\nfunction createIndicesTypedArray(indexBufferLoader, bufferViewTypedArray) {\n  var gltf = indexBufferLoader._gltf;\n  var accessorId = indexBufferLoader._accessorId;\n  var accessor = gltf.accessors[accessorId];\n  var count = accessor.count;\n  var indexDatatype = accessor.componentType;\n\n  var arrayBuffer = bufferViewTypedArray.buffer;\n  var byteOffset = bufferViewTypedArray.byteOffset + accessor.byteOffset;\n\n  var typedArray;\n  if (indexDatatype === _Core_IndexDatatype_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].UNSIGNED_BYTE */ .Z.UNSIGNED_BYTE) {\n    typedArray = new Uint8Array(arrayBuffer, byteOffset, count);\n  } else if (indexDatatype === _Core_IndexDatatype_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].UNSIGNED_SHORT */ .Z.UNSIGNED_SHORT) {\n    typedArray = new Uint16Array(arrayBuffer, byteOffset, count);\n  } else if (indexDatatype === _Core_IndexDatatype_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].UNSIGNED_INT */ .Z.UNSIGNED_INT) {\n    typedArray = new Uint32Array(arrayBuffer, byteOffset, count);\n  }\n\n  return typedArray;\n}\n\nfunction handleError(indexBufferLoader, error) {\n  indexBufferLoader.unload();\n  indexBufferLoader._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].FAILED */ .Z.FAILED;\n  var errorMessage = "Failed to load index buffer";\n  error = indexBufferLoader.getError(errorMessage, error);\n  indexBufferLoader._promise.reject(error);\n}\n\nfunction CreateIndexBufferJob() {\n  this.typedArray = undefined;\n  this.indexDatatype = undefined;\n  this.context = undefined;\n  this.indexBuffer = undefined;\n}\n\nCreateIndexBufferJob.prototype.set = function (\n  typedArray,\n  indexDatatype,\n  context\n) {\n  this.typedArray = typedArray;\n  this.indexDatatype = indexDatatype;\n  this.context = context;\n};\n\nCreateIndexBufferJob.prototype.execute = function () {\n  this.indexBuffer = createIndexBuffer(\n    this.typedArray,\n    this.indexDatatype,\n    this.context\n  );\n};\n\nfunction createIndexBuffer(typedArray, indexDatatype, context) {\n  var indexBuffer = _Renderer_Buffer_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].createIndexBuffer */ .Z.createIndexBuffer({\n    typedArray: typedArray,\n    context: context,\n    usage: _Renderer_BufferUsage_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].STATIC_DRAW */ .Z.STATIC_DRAW,\n    indexDatatype: indexDatatype,\n  });\n  indexBuffer.vertexArrayDestroyable = false;\n  return indexBuffer;\n}\n\nvar scratchIndexBufferJob = new CreateIndexBufferJob();\n\n/**\n * Processes the resource until it becomes ready.\n *\n * @param {FrameState} frameState The frame state.\n * @private\n */\nGltfIndexBufferLoader.prototype.process = function (frameState) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("frameState", frameState);\n  //>>includeEnd(\'debug\');\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(this._dracoLoader)) {\n    this._dracoLoader.process(frameState);\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(this._bufferViewLoader)) {\n    this._bufferViewLoader.process(frameState);\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(this._indexBuffer)) {\n    // Already created index buffer\n    return;\n  }\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(this._typedArray)) {\n    // Not ready to create index buffer\n    return;\n  }\n\n  var indexBuffer;\n\n  if (this._asynchronous) {\n    var indexBufferJob = scratchIndexBufferJob;\n    indexBufferJob.set(\n      this._typedArray,\n      this._indexDatatype,\n      frameState.context\n    );\n    var jobScheduler = frameState.jobScheduler;\n    if (!jobScheduler.execute(indexBufferJob, _JobType_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].BUFFER */ .Z.BUFFER)) {\n      // Job scheduler is full. Try again next frame.\n      return;\n    }\n    indexBuffer = indexBufferJob.indexBuffer;\n  } else {\n    indexBuffer = createIndexBuffer(\n      this._typedArray,\n      this._indexDatatype,\n      frameState.context\n    );\n  }\n\n  // Unload everything except the index buffer\n  this.unload();\n\n  this._indexBuffer = indexBuffer;\n  this._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].READY */ .Z.READY;\n  this._promise.resolve(this);\n};\n\n/**\n * Unloads the resource.\n * @private\n */\nGltfIndexBufferLoader.prototype.unload = function () {\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(this._indexBuffer)) {\n    this._indexBuffer.destroy();\n  }\n\n  var resourceCache = this._resourceCache;\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(this._bufferViewLoader)) {\n    resourceCache.unload(this._bufferViewLoader);\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(this._dracoLoader)) {\n    resourceCache.unload(this._dracoLoader);\n  }\n\n  this._bufferViewLoader = undefined;\n  this._dracoLoader = undefined;\n  this._typedArray = undefined;\n  this._indexBuffer = undefined;\n  this._gltf = undefined;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Qix3R0FBd0I7QUFDNUM7QUFDQTtBQUNBLFdBQVcsaUdBQXVCO0FBQ2xDO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFlBQVk7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFLDJGQUFtQjtBQUNyQjs7QUFFQSxNQUFNLHFFQUFPO0FBQ2I7QUFDQTs7QUFFQSxNQUFNLHFFQUFPO0FBQ2I7QUFDQTs7QUFFQSxNQUFNLHFFQUFPO0FBQ2I7QUFDQTtBQUNBOztBQUVBLE9BQU8scUVBQU87QUFDZDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QywwRUFBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLGdCQUFnQixvRkFBeUI7QUFDekM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxxRUFBTztBQUNiO0FBQ0E7O0FBRUE7O0FBRUEsTUFBTSxxRUFBTztBQUNiO0FBQ0E7O0FBRUEsTUFBTSxxRUFBTztBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnVlMy13ZWJwYWNrNS8uL25vZGVfbW9kdWxlcy9jZXNpdW0vU291cmNlL1NjZW5lL0dsdGZJbmRleEJ1ZmZlckxvYWRlci5qcz8yMjc2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDaGVjayBmcm9tIFwiLi4vQ29yZS9DaGVjay5qc1wiO1xuaW1wb3J0IGRlZmF1bHRWYWx1ZSBmcm9tIFwiLi4vQ29yZS9kZWZhdWx0VmFsdWUuanNcIjtcbmltcG9ydCBkZWZpbmVkIGZyb20gXCIuLi9Db3JlL2RlZmluZWQuanNcIjtcbmltcG9ydCBJbmRleERhdGF0eXBlIGZyb20gXCIuLi9Db3JlL0luZGV4RGF0YXR5cGUuanNcIjtcbmltcG9ydCBCdWZmZXIgZnJvbSBcIi4uL1JlbmRlcmVyL0J1ZmZlci5qc1wiO1xuaW1wb3J0IEJ1ZmZlclVzYWdlIGZyb20gXCIuLi9SZW5kZXJlci9CdWZmZXJVc2FnZS5qc1wiO1xuaW1wb3J0IHdoZW4gZnJvbSBcIi4uL1RoaXJkUGFydHkvd2hlbi5qc1wiO1xuaW1wb3J0IEpvYlR5cGUgZnJvbSBcIi4vSm9iVHlwZS5qc1wiO1xuaW1wb3J0IFJlc291cmNlTG9hZGVyIGZyb20gXCIuL1Jlc291cmNlTG9hZGVyLmpzXCI7XG5pbXBvcnQgUmVzb3VyY2VMb2FkZXJTdGF0ZSBmcm9tIFwiLi9SZXNvdXJjZUxvYWRlclN0YXRlLmpzXCI7XG5cbi8qKlxuICogTG9hZHMgYW4gaW5kZXggYnVmZmVyIGZyb20gYSBnbFRGIGFjY2Vzc29yLlxuICogPHA+XG4gKiBJbXBsZW1lbnRzIHRoZSB7QGxpbmsgUmVzb3VyY2VMb2FkZXJ9IGludGVyZmFjZS5cbiAqIDwvcD5cbiAqXG4gKiBAYWxpYXMgR2x0ZkluZGV4QnVmZmVyTG9hZGVyXG4gKiBAY29uc3RydWN0b3JcbiAqIEBhdWdtZW50cyBSZXNvdXJjZUxvYWRlclxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIE9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqIEBwYXJhbSB7UmVzb3VyY2VDYWNoZX0gb3B0aW9ucy5yZXNvdXJjZUNhY2hlIFRoZSB7QGxpbmsgUmVzb3VyY2VDYWNoZX0gKHRvIGF2b2lkIGNpcmN1bGFyIGRlcGVuZGVuY2llcykuXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucy5nbHRmIFRoZSBnbFRGIEpTT04uXG4gKiBAcGFyYW0ge051bWJlcn0gb3B0aW9ucy5hY2Nlc3NvcklkIFRoZSBhY2Nlc3NvciBJRCBjb3JyZXNwb25kaW5nIHRvIHRoZSBpbmRleCBidWZmZXIuXG4gKiBAcGFyYW0ge1Jlc291cmNlfSBvcHRpb25zLmdsdGZSZXNvdXJjZSBUaGUge0BsaW5rIFJlc291cmNlfSBjb250YWluaW5nIHRoZSBnbFRGLlxuICogQHBhcmFtIHtSZXNvdXJjZX0gb3B0aW9ucy5iYXNlUmVzb3VyY2UgVGhlIHtAbGluayBSZXNvdXJjZX0gdGhhdCBwYXRocyBpbiB0aGUgZ2xURiBKU09OIGFyZSByZWxhdGl2ZSB0by5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5kcmFjb10gVGhlIERyYWNvIGV4dGVuc2lvbiBvYmplY3QuXG4gKiBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMuY2FjaGVLZXldIFRoZSBjYWNoZSBrZXkgb2YgdGhlIHJlc291cmNlLlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5hc3luY2hyb25vdXM9dHJ1ZV0gRGV0ZXJtaW5lcyBpZiBXZWJHTCByZXNvdXJjZSBjcmVhdGlvbiB3aWxsIGJlIHNwcmVhZCBvdXQgb3ZlciBzZXZlcmFsIGZyYW1lcyBvciBibG9jayB1bnRpbCBhbGwgV2ViR0wgcmVzb3VyY2VzIGFyZSBjcmVhdGVkLlxuICpcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIEdsdGZJbmRleEJ1ZmZlckxvYWRlcihvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBkZWZhdWx0VmFsdWUob3B0aW9ucywgZGVmYXVsdFZhbHVlLkVNUFRZX09CSkVDVCk7XG4gIHZhciByZXNvdXJjZUNhY2hlID0gb3B0aW9ucy5yZXNvdXJjZUNhY2hlO1xuICB2YXIgZ2x0ZiA9IG9wdGlvbnMuZ2x0ZjtcbiAgdmFyIGFjY2Vzc29ySWQgPSBvcHRpb25zLmFjY2Vzc29ySWQ7XG4gIHZhciBnbHRmUmVzb3VyY2UgPSBvcHRpb25zLmdsdGZSZXNvdXJjZTtcbiAgdmFyIGJhc2VSZXNvdXJjZSA9IG9wdGlvbnMuYmFzZVJlc291cmNlO1xuICB2YXIgZHJhY28gPSBvcHRpb25zLmRyYWNvO1xuICB2YXIgY2FjaGVLZXkgPSBvcHRpb25zLmNhY2hlS2V5O1xuICB2YXIgYXN5bmNocm9ub3VzID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMuYXN5bmNocm9ub3VzLCB0cnVlKTtcblxuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2YuZnVuYyhcIm9wdGlvbnMucmVzb3VyY2VDYWNoZVwiLCByZXNvdXJjZUNhY2hlKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcIm9wdGlvbnMuZ2x0ZlwiLCBnbHRmKTtcbiAgQ2hlY2sudHlwZU9mLm51bWJlcihcIm9wdGlvbnMuYWNjZXNzb3JJZFwiLCBhY2Nlc3NvcklkKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcIm9wdGlvbnMuZ2x0ZlJlc291cmNlXCIsIGdsdGZSZXNvdXJjZSk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJvcHRpb25zLmJhc2VSZXNvdXJjZVwiLCBiYXNlUmVzb3VyY2UpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB2YXIgaW5kZXhEYXRhdHlwZSA9IGdsdGYuYWNjZXNzb3JzW2FjY2Vzc29ySWRdLmNvbXBvbmVudFR5cGU7XG5cbiAgdGhpcy5fcmVzb3VyY2VDYWNoZSA9IHJlc291cmNlQ2FjaGU7XG4gIHRoaXMuX2dsdGZSZXNvdXJjZSA9IGdsdGZSZXNvdXJjZTtcbiAgdGhpcy5fYmFzZVJlc291cmNlID0gYmFzZVJlc291cmNlO1xuICB0aGlzLl9nbHRmID0gZ2x0ZjtcbiAgdGhpcy5fYWNjZXNzb3JJZCA9IGFjY2Vzc29ySWQ7XG4gIHRoaXMuX2luZGV4RGF0YXR5cGUgPSBpbmRleERhdGF0eXBlO1xuICB0aGlzLl9kcmFjbyA9IGRyYWNvO1xuICB0aGlzLl9jYWNoZUtleSA9IGNhY2hlS2V5O1xuICB0aGlzLl9hc3luY2hyb25vdXMgPSBhc3luY2hyb25vdXM7XG4gIHRoaXMuX2J1ZmZlclZpZXdMb2FkZXIgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2RyYWNvTG9hZGVyID0gdW5kZWZpbmVkO1xuICB0aGlzLl90eXBlZEFycmF5ID0gdW5kZWZpbmVkO1xuICB0aGlzLl9pbmRleEJ1ZmZlciA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fc3RhdGUgPSBSZXNvdXJjZUxvYWRlclN0YXRlLlVOTE9BREVEO1xuICB0aGlzLl9wcm9taXNlID0gd2hlbi5kZWZlcigpO1xufVxuXG5pZiAoZGVmaW5lZChPYmplY3QuY3JlYXRlKSkge1xuICBHbHRmSW5kZXhCdWZmZXJMb2FkZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShSZXNvdXJjZUxvYWRlci5wcm90b3R5cGUpO1xuICBHbHRmSW5kZXhCdWZmZXJMb2FkZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gR2x0ZkluZGV4QnVmZmVyTG9hZGVyO1xufVxuXG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhHbHRmSW5kZXhCdWZmZXJMb2FkZXIucHJvdG90eXBlLCB7XG4gIC8qKlxuICAgKiBBIHByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzb3VyY2Ugd2hlbiB0aGUgcmVzb3VyY2UgaXMgcmVhZHkuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBHbHRmSW5kZXhCdWZmZXJMb2FkZXIucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtQcm9taXNlLjxHbHRmSW5kZXhCdWZmZXJMb2FkZXI+fVxuICAgKiBAcmVhZG9ubHlcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHByb21pc2U6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9wcm9taXNlLnByb21pc2U7XG4gICAgfSxcbiAgfSxcbiAgLyoqXG4gICAqIFRoZSBjYWNoZSBrZXkgb2YgdGhlIHJlc291cmNlLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgR2x0ZkluZGV4QnVmZmVyTG9hZGVyLnByb3RvdHlwZVxuICAgKlxuICAgKiBAdHlwZSB7U3RyaW5nfVxuICAgKiBAcmVhZG9ubHlcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGNhY2hlS2V5OiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fY2FjaGVLZXk7XG4gICAgfSxcbiAgfSxcbiAgLyoqXG4gICAqIFRoZSBpbmRleCBidWZmZXIuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBHbHRmSW5kZXhCdWZmZXJMb2FkZXIucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtCdWZmZXJ9XG4gICAqIEByZWFkb25seVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgaW5kZXhCdWZmZXI6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9pbmRleEJ1ZmZlcjtcbiAgICB9LFxuICB9LFxufSk7XG5cbi8qKlxuICogTG9hZHMgdGhlIHJlc291cmNlLlxuICogQHByaXZhdGVcbiAqL1xuR2x0ZkluZGV4QnVmZmVyTG9hZGVyLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKCkge1xuICBpZiAoZGVmaW5lZCh0aGlzLl9kcmFjbykpIHtcbiAgICBsb2FkRnJvbURyYWNvKHRoaXMpO1xuICB9IGVsc2Uge1xuICAgIGxvYWRGcm9tQnVmZmVyVmlldyh0aGlzKTtcbiAgfVxufTtcblxuZnVuY3Rpb24gbG9hZEZyb21EcmFjbyhpbmRleEJ1ZmZlckxvYWRlcikge1xuICB2YXIgcmVzb3VyY2VDYWNoZSA9IGluZGV4QnVmZmVyTG9hZGVyLl9yZXNvdXJjZUNhY2hlO1xuICB2YXIgZHJhY29Mb2FkZXIgPSByZXNvdXJjZUNhY2hlLmxvYWREcmFjbyh7XG4gICAgZ2x0ZjogaW5kZXhCdWZmZXJMb2FkZXIuX2dsdGYsXG4gICAgZHJhY286IGluZGV4QnVmZmVyTG9hZGVyLl9kcmFjbyxcbiAgICBnbHRmUmVzb3VyY2U6IGluZGV4QnVmZmVyTG9hZGVyLl9nbHRmUmVzb3VyY2UsXG4gICAgYmFzZVJlc291cmNlOiBpbmRleEJ1ZmZlckxvYWRlci5fYmFzZVJlc291cmNlLFxuICB9KTtcblxuICBpbmRleEJ1ZmZlckxvYWRlci5fZHJhY29Mb2FkZXIgPSBkcmFjb0xvYWRlcjtcbiAgaW5kZXhCdWZmZXJMb2FkZXIuX3N0YXRlID0gUmVzb3VyY2VMb2FkZXJTdGF0ZS5MT0FESU5HO1xuXG4gIGRyYWNvTG9hZGVyLnByb21pc2VcbiAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoaW5kZXhCdWZmZXJMb2FkZXIuaXNEZXN0cm95ZWQoKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAvLyBOb3cgd2FpdCBmb3IgcHJvY2VzcygpIHRvIHJ1biB0byBmaW5pc2ggbG9hZGluZ1xuICAgICAgaW5kZXhCdWZmZXJMb2FkZXIuX3R5cGVkQXJyYXkgPVxuICAgICAgICBkcmFjb0xvYWRlci5kZWNvZGVkRGF0YS5pbmRpY2VzLnR5cGVkQXJyYXk7XG4gICAgICBpbmRleEJ1ZmZlckxvYWRlci5fc3RhdGUgPSBSZXNvdXJjZUxvYWRlclN0YXRlLlBST0NFU1NJTkc7XG4gICAgfSlcbiAgICAub3RoZXJ3aXNlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgaWYgKGluZGV4QnVmZmVyTG9hZGVyLmlzRGVzdHJveWVkKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaGFuZGxlRXJyb3IoaW5kZXhCdWZmZXJMb2FkZXIsIGVycm9yKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gbG9hZEZyb21CdWZmZXJWaWV3KGluZGV4QnVmZmVyTG9hZGVyKSB7XG4gIHZhciBnbHRmID0gaW5kZXhCdWZmZXJMb2FkZXIuX2dsdGY7XG4gIHZhciBhY2Nlc3NvcklkID0gaW5kZXhCdWZmZXJMb2FkZXIuX2FjY2Vzc29ySWQ7XG4gIHZhciBhY2Nlc3NvciA9IGdsdGYuYWNjZXNzb3JzW2FjY2Vzc29ySWRdO1xuICB2YXIgYnVmZmVyVmlld0lkID0gYWNjZXNzb3IuYnVmZmVyVmlldztcblxuICB2YXIgcmVzb3VyY2VDYWNoZSA9IGluZGV4QnVmZmVyTG9hZGVyLl9yZXNvdXJjZUNhY2hlO1xuICB2YXIgYnVmZmVyVmlld0xvYWRlciA9IHJlc291cmNlQ2FjaGUubG9hZEJ1ZmZlclZpZXcoe1xuICAgIGdsdGY6IGdsdGYsXG4gICAgYnVmZmVyVmlld0lkOiBidWZmZXJWaWV3SWQsXG4gICAgZ2x0ZlJlc291cmNlOiBpbmRleEJ1ZmZlckxvYWRlci5fZ2x0ZlJlc291cmNlLFxuICAgIGJhc2VSZXNvdXJjZTogaW5kZXhCdWZmZXJMb2FkZXIuX2Jhc2VSZXNvdXJjZSxcbiAgfSk7XG4gIGluZGV4QnVmZmVyTG9hZGVyLl9zdGF0ZSA9IFJlc291cmNlTG9hZGVyU3RhdGUuTE9BRElORztcbiAgaW5kZXhCdWZmZXJMb2FkZXIuX2J1ZmZlclZpZXdMb2FkZXIgPSBidWZmZXJWaWV3TG9hZGVyO1xuXG4gIGJ1ZmZlclZpZXdMb2FkZXIucHJvbWlzZVxuICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChpbmRleEJ1ZmZlckxvYWRlci5pc0Rlc3Ryb3llZCgpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIC8vIE5vdyB3YWl0IGZvciBwcm9jZXNzKCkgdG8gcnVuIHRvIGZpbmlzaCBsb2FkaW5nXG4gICAgICB2YXIgYnVmZmVyVmlld1R5cGVkQXJyYXkgPSBidWZmZXJWaWV3TG9hZGVyLnR5cGVkQXJyYXk7XG4gICAgICBpbmRleEJ1ZmZlckxvYWRlci5fdHlwZWRBcnJheSA9IGNyZWF0ZUluZGljZXNUeXBlZEFycmF5KFxuICAgICAgICBpbmRleEJ1ZmZlckxvYWRlcixcbiAgICAgICAgYnVmZmVyVmlld1R5cGVkQXJyYXlcbiAgICAgICk7XG4gICAgICBpbmRleEJ1ZmZlckxvYWRlci5fc3RhdGUgPSBSZXNvdXJjZUxvYWRlclN0YXRlLlBST0NFU1NJTkc7XG4gICAgfSlcbiAgICAub3RoZXJ3aXNlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgaWYgKGluZGV4QnVmZmVyTG9hZGVyLmlzRGVzdHJveWVkKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaGFuZGxlRXJyb3IoaW5kZXhCdWZmZXJMb2FkZXIsIGVycm9yKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlSW5kaWNlc1R5cGVkQXJyYXkoaW5kZXhCdWZmZXJMb2FkZXIsIGJ1ZmZlclZpZXdUeXBlZEFycmF5KSB7XG4gIHZhciBnbHRmID0gaW5kZXhCdWZmZXJMb2FkZXIuX2dsdGY7XG4gIHZhciBhY2Nlc3NvcklkID0gaW5kZXhCdWZmZXJMb2FkZXIuX2FjY2Vzc29ySWQ7XG4gIHZhciBhY2Nlc3NvciA9IGdsdGYuYWNjZXNzb3JzW2FjY2Vzc29ySWRdO1xuICB2YXIgY291bnQgPSBhY2Nlc3Nvci5jb3VudDtcbiAgdmFyIGluZGV4RGF0YXR5cGUgPSBhY2Nlc3Nvci5jb21wb25lbnRUeXBlO1xuXG4gIHZhciBhcnJheUJ1ZmZlciA9IGJ1ZmZlclZpZXdUeXBlZEFycmF5LmJ1ZmZlcjtcbiAgdmFyIGJ5dGVPZmZzZXQgPSBidWZmZXJWaWV3VHlwZWRBcnJheS5ieXRlT2Zmc2V0ICsgYWNjZXNzb3IuYnl0ZU9mZnNldDtcblxuICB2YXIgdHlwZWRBcnJheTtcbiAgaWYgKGluZGV4RGF0YXR5cGUgPT09IEluZGV4RGF0YXR5cGUuVU5TSUdORURfQllURSkge1xuICAgIHR5cGVkQXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheUJ1ZmZlciwgYnl0ZU9mZnNldCwgY291bnQpO1xuICB9IGVsc2UgaWYgKGluZGV4RGF0YXR5cGUgPT09IEluZGV4RGF0YXR5cGUuVU5TSUdORURfU0hPUlQpIHtcbiAgICB0eXBlZEFycmF5ID0gbmV3IFVpbnQxNkFycmF5KGFycmF5QnVmZmVyLCBieXRlT2Zmc2V0LCBjb3VudCk7XG4gIH0gZWxzZSBpZiAoaW5kZXhEYXRhdHlwZSA9PT0gSW5kZXhEYXRhdHlwZS5VTlNJR05FRF9JTlQpIHtcbiAgICB0eXBlZEFycmF5ID0gbmV3IFVpbnQzMkFycmF5KGFycmF5QnVmZmVyLCBieXRlT2Zmc2V0LCBjb3VudCk7XG4gIH1cblxuICByZXR1cm4gdHlwZWRBcnJheTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRXJyb3IoaW5kZXhCdWZmZXJMb2FkZXIsIGVycm9yKSB7XG4gIGluZGV4QnVmZmVyTG9hZGVyLnVubG9hZCgpO1xuICBpbmRleEJ1ZmZlckxvYWRlci5fc3RhdGUgPSBSZXNvdXJjZUxvYWRlclN0YXRlLkZBSUxFRDtcbiAgdmFyIGVycm9yTWVzc2FnZSA9IFwiRmFpbGVkIHRvIGxvYWQgaW5kZXggYnVmZmVyXCI7XG4gIGVycm9yID0gaW5kZXhCdWZmZXJMb2FkZXIuZ2V0RXJyb3IoZXJyb3JNZXNzYWdlLCBlcnJvcik7XG4gIGluZGV4QnVmZmVyTG9hZGVyLl9wcm9taXNlLnJlamVjdChlcnJvcik7XG59XG5cbmZ1bmN0aW9uIENyZWF0ZUluZGV4QnVmZmVySm9iKCkge1xuICB0aGlzLnR5cGVkQXJyYXkgPSB1bmRlZmluZWQ7XG4gIHRoaXMuaW5kZXhEYXRhdHlwZSA9IHVuZGVmaW5lZDtcbiAgdGhpcy5jb250ZXh0ID0gdW5kZWZpbmVkO1xuICB0aGlzLmluZGV4QnVmZmVyID0gdW5kZWZpbmVkO1xufVxuXG5DcmVhdGVJbmRleEJ1ZmZlckpvYi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKFxuICB0eXBlZEFycmF5LFxuICBpbmRleERhdGF0eXBlLFxuICBjb250ZXh0XG4pIHtcbiAgdGhpcy50eXBlZEFycmF5ID0gdHlwZWRBcnJheTtcbiAgdGhpcy5pbmRleERhdGF0eXBlID0gaW5kZXhEYXRhdHlwZTtcbiAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbn07XG5cbkNyZWF0ZUluZGV4QnVmZmVySm9iLnByb3RvdHlwZS5leGVjdXRlID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLmluZGV4QnVmZmVyID0gY3JlYXRlSW5kZXhCdWZmZXIoXG4gICAgdGhpcy50eXBlZEFycmF5LFxuICAgIHRoaXMuaW5kZXhEYXRhdHlwZSxcbiAgICB0aGlzLmNvbnRleHRcbiAgKTtcbn07XG5cbmZ1bmN0aW9uIGNyZWF0ZUluZGV4QnVmZmVyKHR5cGVkQXJyYXksIGluZGV4RGF0YXR5cGUsIGNvbnRleHQpIHtcbiAgdmFyIGluZGV4QnVmZmVyID0gQnVmZmVyLmNyZWF0ZUluZGV4QnVmZmVyKHtcbiAgICB0eXBlZEFycmF5OiB0eXBlZEFycmF5LFxuICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgdXNhZ2U6IEJ1ZmZlclVzYWdlLlNUQVRJQ19EUkFXLFxuICAgIGluZGV4RGF0YXR5cGU6IGluZGV4RGF0YXR5cGUsXG4gIH0pO1xuICBpbmRleEJ1ZmZlci52ZXJ0ZXhBcnJheURlc3Ryb3lhYmxlID0gZmFsc2U7XG4gIHJldHVybiBpbmRleEJ1ZmZlcjtcbn1cblxudmFyIHNjcmF0Y2hJbmRleEJ1ZmZlckpvYiA9IG5ldyBDcmVhdGVJbmRleEJ1ZmZlckpvYigpO1xuXG4vKipcbiAqIFByb2Nlc3NlcyB0aGUgcmVzb3VyY2UgdW50aWwgaXQgYmVjb21lcyByZWFkeS5cbiAqXG4gKiBAcGFyYW0ge0ZyYW1lU3RhdGV9IGZyYW1lU3RhdGUgVGhlIGZyYW1lIHN0YXRlLlxuICogQHByaXZhdGVcbiAqL1xuR2x0ZkluZGV4QnVmZmVyTG9hZGVyLnByb3RvdHlwZS5wcm9jZXNzID0gZnVuY3Rpb24gKGZyYW1lU3RhdGUpIHtcbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcImZyYW1lU3RhdGVcIiwgZnJhbWVTdGF0ZSk7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIGlmIChkZWZpbmVkKHRoaXMuX2RyYWNvTG9hZGVyKSkge1xuICAgIHRoaXMuX2RyYWNvTG9hZGVyLnByb2Nlc3MoZnJhbWVTdGF0ZSk7XG4gIH1cblxuICBpZiAoZGVmaW5lZCh0aGlzLl9idWZmZXJWaWV3TG9hZGVyKSkge1xuICAgIHRoaXMuX2J1ZmZlclZpZXdMb2FkZXIucHJvY2VzcyhmcmFtZVN0YXRlKTtcbiAgfVxuXG4gIGlmIChkZWZpbmVkKHRoaXMuX2luZGV4QnVmZmVyKSkge1xuICAgIC8vIEFscmVhZHkgY3JlYXRlZCBpbmRleCBidWZmZXJcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoIWRlZmluZWQodGhpcy5fdHlwZWRBcnJheSkpIHtcbiAgICAvLyBOb3QgcmVhZHkgdG8gY3JlYXRlIGluZGV4IGJ1ZmZlclxuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBpbmRleEJ1ZmZlcjtcblxuICBpZiAodGhpcy5fYXN5bmNocm9ub3VzKSB7XG4gICAgdmFyIGluZGV4QnVmZmVySm9iID0gc2NyYXRjaEluZGV4QnVmZmVySm9iO1xuICAgIGluZGV4QnVmZmVySm9iLnNldChcbiAgICAgIHRoaXMuX3R5cGVkQXJyYXksXG4gICAgICB0aGlzLl9pbmRleERhdGF0eXBlLFxuICAgICAgZnJhbWVTdGF0ZS5jb250ZXh0XG4gICAgKTtcbiAgICB2YXIgam9iU2NoZWR1bGVyID0gZnJhbWVTdGF0ZS5qb2JTY2hlZHVsZXI7XG4gICAgaWYgKCFqb2JTY2hlZHVsZXIuZXhlY3V0ZShpbmRleEJ1ZmZlckpvYiwgSm9iVHlwZS5CVUZGRVIpKSB7XG4gICAgICAvLyBKb2Igc2NoZWR1bGVyIGlzIGZ1bGwuIFRyeSBhZ2FpbiBuZXh0IGZyYW1lLlxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpbmRleEJ1ZmZlciA9IGluZGV4QnVmZmVySm9iLmluZGV4QnVmZmVyO1xuICB9IGVsc2Uge1xuICAgIGluZGV4QnVmZmVyID0gY3JlYXRlSW5kZXhCdWZmZXIoXG4gICAgICB0aGlzLl90eXBlZEFycmF5LFxuICAgICAgdGhpcy5faW5kZXhEYXRhdHlwZSxcbiAgICAgIGZyYW1lU3RhdGUuY29udGV4dFxuICAgICk7XG4gIH1cblxuICAvLyBVbmxvYWQgZXZlcnl0aGluZyBleGNlcHQgdGhlIGluZGV4IGJ1ZmZlclxuICB0aGlzLnVubG9hZCgpO1xuXG4gIHRoaXMuX2luZGV4QnVmZmVyID0gaW5kZXhCdWZmZXI7XG4gIHRoaXMuX3N0YXRlID0gUmVzb3VyY2VMb2FkZXJTdGF0ZS5SRUFEWTtcbiAgdGhpcy5fcHJvbWlzZS5yZXNvbHZlKHRoaXMpO1xufTtcblxuLyoqXG4gKiBVbmxvYWRzIHRoZSByZXNvdXJjZS5cbiAqIEBwcml2YXRlXG4gKi9cbkdsdGZJbmRleEJ1ZmZlckxvYWRlci5wcm90b3R5cGUudW5sb2FkID0gZnVuY3Rpb24gKCkge1xuICBpZiAoZGVmaW5lZCh0aGlzLl9pbmRleEJ1ZmZlcikpIHtcbiAgICB0aGlzLl9pbmRleEJ1ZmZlci5kZXN0cm95KCk7XG4gIH1cblxuICB2YXIgcmVzb3VyY2VDYWNoZSA9IHRoaXMuX3Jlc291cmNlQ2FjaGU7XG5cbiAgaWYgKGRlZmluZWQodGhpcy5fYnVmZmVyVmlld0xvYWRlcikpIHtcbiAgICByZXNvdXJjZUNhY2hlLnVubG9hZCh0aGlzLl9idWZmZXJWaWV3TG9hZGVyKTtcbiAgfVxuXG4gIGlmIChkZWZpbmVkKHRoaXMuX2RyYWNvTG9hZGVyKSkge1xuICAgIHJlc291cmNlQ2FjaGUudW5sb2FkKHRoaXMuX2RyYWNvTG9hZGVyKTtcbiAgfVxuXG4gIHRoaXMuX2J1ZmZlclZpZXdMb2FkZXIgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2RyYWNvTG9hZGVyID0gdW5kZWZpbmVkO1xuICB0aGlzLl90eXBlZEFycmF5ID0gdW5kZWZpbmVkO1xuICB0aGlzLl9pbmRleEJ1ZmZlciA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fZ2x0ZiA9IHVuZGVmaW5lZDtcbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///28096\n')},60785:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "Z": function() { return /* binding */ GltfJsonLoader; }\n/* harmony export */ });\n/* harmony import */ var _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(66553);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(82982);\n/* harmony import */ var _Core_getJsonFromTypedArray_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12540);\n/* harmony import */ var _Core_getMagic_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(3020);\n/* harmony import */ var _Core_isDataUri_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(46138);\n/* harmony import */ var _Core_Resource_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(68985);\n/* harmony import */ var _GltfPipeline_addDefaults_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(32550);\n/* harmony import */ var _GltfPipeline_addPipelineExtras_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(93410);\n/* harmony import */ var _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(56629);\n/* harmony import */ var _GltfPipeline_parseGlb_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(52655);\n/* harmony import */ var _GltfPipeline_removePipelineExtras_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(23537);\n/* harmony import */ var _GltfPipeline_updateVersion_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(6186);\n/* harmony import */ var _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(13222);\n/* harmony import */ var _ResourceLoader_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(29789);\n/* harmony import */ var _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(89356);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Loads a glTF JSON from a glTF or glb.\n * <p>\n * Implements the {@link ResourceLoader} interface.\n * </p>\n *\n * @alias GltfJsonLoader\n * @constructor\n * @augments ResourceLoader\n *\n * @param {Object} options Object with the following properties:\n * @param {ResourceCache} options.resourceCache The {@link ResourceCache} (to avoid circular dependencies).\n * @param {Resource} options.gltfResource The {@link Resource} containing the glTF.\n * @param {Resource} options.baseResource The {@link Resource} that paths in the glTF JSON are relative to.\n * @param {Uint8Array} [options.typedArray] The typed array containing the glTF contents.\n * @param {Object} [options.gltfJson] The parsed glTF JSON contents.\n * @param {String} [options.cacheKey] The cache key of the resource.\n *\n * @private\n */\nfunction GltfJsonLoader(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n  var resourceCache = options.resourceCache;\n  var gltfResource = options.gltfResource;\n  var baseResource = options.baseResource;\n  var typedArray = options.typedArray;\n  var gltfJson = options.gltfJson;\n  var cacheKey = options.cacheKey;\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.func */ .Z.typeOf.func("options.resourceCache", resourceCache);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.gltfResource", gltfResource);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].typeOf.object */ .Z.typeOf.object("options.baseResource", baseResource);\n  //>>includeEnd(\'debug\');\n\n  this._resourceCache = resourceCache;\n  this._gltfResource = gltfResource;\n  this._baseResource = baseResource;\n  this._typedArray = typedArray;\n  this._gltfJson = gltfJson;\n  this._cacheKey = cacheKey;\n  this._gltf = undefined;\n  this._bufferLoaders = [];\n  this._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].UNLOADED */ .Z.UNLOADED;\n  this._promise = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].defer */ .Z.defer();\n}\n\nif ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(Object.create)) {\n  GltfJsonLoader.prototype = Object.create(_ResourceLoader_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].prototype */ .Z.prototype);\n  GltfJsonLoader.prototype.constructor = GltfJsonLoader;\n}\n\nObject.defineProperties(GltfJsonLoader.prototype, {\n  /**\n   * A promise that resolves to the resource when the resource is ready.\n   *\n   * @memberof GltfJsonLoader.prototype\n   *\n   * @type {Promise.<GltfJsonLoader>}\n   * @readonly\n   * @private\n   */\n  promise: {\n    get: function () {\n      return this._promise.promise;\n    },\n  },\n  /**\n   * The cache key of the resource.\n   *\n   * @memberof GltfJsonLoader.prototype\n   *\n   * @type {String}\n   * @readonly\n   * @private\n   */\n  cacheKey: {\n    get: function () {\n      return this._cacheKey;\n    },\n  },\n  /**\n   * The glTF JSON.\n   *\n   * @memberof GltfJsonLoader.prototype\n   *\n   * @type {Object}\n   * @readonly\n   * @private\n   */\n  gltf: {\n    get: function () {\n      return this._gltf;\n    },\n  },\n});\n\n/**\n * Loads the resource.\n * @private\n */\nGltfJsonLoader.prototype.load = function () {\n  this._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].LOADING */ .Z.LOADING;\n\n  var processPromise;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(this._gltfJson)) {\n    processPromise = processGltfJson(this, this._gltfJson);\n  } else if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(this._typedArray)) {\n    processPromise = processGltfTypedArray(this, this._typedArray);\n  } else {\n    processPromise = loadFromUri(this);\n  }\n\n  var that = this;\n\n  return processPromise\n    .then(function (gltf) {\n      if (that.isDestroyed()) {\n        return;\n      }\n      that._gltf = gltf;\n      that._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].READY */ .Z.READY;\n      that._promise.resolve(that);\n    })\n    .otherwise(function (error) {\n      if (that.isDestroyed()) {\n        return;\n      }\n      handleError(that, error);\n    });\n};\n\nfunction loadFromUri(gltfJsonLoader) {\n  return gltfJsonLoader._fetchGltf().then(function (arrayBuffer) {\n    if (gltfJsonLoader.isDestroyed()) {\n      return;\n    }\n    var typedArray = new Uint8Array(arrayBuffer);\n    return processGltfTypedArray(gltfJsonLoader, typedArray);\n  });\n}\n\nfunction handleError(gltfJsonLoader, error) {\n  gltfJsonLoader.unload();\n  gltfJsonLoader._state = _ResourceLoaderState_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].FAILED */ .Z.FAILED;\n  var errorMessage = "Failed to load glTF: " + gltfJsonLoader._gltfResource.url;\n  gltfJsonLoader._promise.reject(gltfJsonLoader.getError(errorMessage, error));\n}\n\nfunction upgradeVersion(gltfJsonLoader, gltf) {\n  if (gltf.asset.version === "2.0") {\n    return _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].resolve */ .Z.resolve();\n  }\n\n  // Load all buffers into memory. updateVersion will read and in some cases modify\n  // the buffer data, which it accesses from buffer.extras._pipeline.source\n  var promises = [];\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].buffer */ .Z.buffer(gltf, function (buffer) {\n    if (\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(buffer.extras._pipeline.source) && // Ignore uri if this buffer uses the glTF 1.0 KHR_binary_glTF extension\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(buffer.uri)\n    ) {\n      var resource = gltfJsonLoader._baseResource.getDerivedResource({\n        url: buffer.uri,\n      });\n      var resourceCache = gltfJsonLoader._resourceCache;\n      var bufferLoader = resourceCache.loadExternalBuffer({\n        resource: resource,\n      });\n\n      gltfJsonLoader._bufferLoaders.push(bufferLoader);\n\n      promises.push(\n        bufferLoader.promise.then(function (bufferLoader) {\n          buffer.extras._pipeline.source = bufferLoader.typedArray;\n        })\n      );\n    }\n  });\n\n  return _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].all */ .Z.all(promises).then(function () {\n    (0,_GltfPipeline_updateVersion_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z)(gltf);\n  });\n}\n\nfunction decodeDataUris(gltf) {\n  var promises = [];\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].buffer */ .Z.buffer(gltf, function (buffer) {\n    var bufferUri = buffer.uri;\n    if (\n      !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(buffer.extras._pipeline.source) && // Ignore uri if this buffer uses the glTF 1.0 KHR_binary_glTF extension\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(bufferUri) &&\n      (0,_Core_isDataUri_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(bufferUri)\n    ) {\n      delete buffer.uri; // Delete the data URI to keep the cached glTF JSON small\n      promises.push(\n        _Core_Resource_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].fetchArrayBuffer */ .Z.fetchArrayBuffer(bufferUri).then(function (arrayBuffer) {\n          buffer.extras._pipeline.source = new Uint8Array(arrayBuffer);\n        })\n      );\n    }\n  });\n  return _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].all */ .Z.all(promises);\n}\n\nfunction loadEmbeddedBuffers(gltfJsonLoader, gltf) {\n  var promises = [];\n  _GltfPipeline_ForEach_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].buffer */ .Z.buffer(gltf, function (buffer, bufferId) {\n    var source = buffer.extras._pipeline.source;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(source) && !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(buffer.uri)) {\n      var resourceCache = gltfJsonLoader._resourceCache;\n      var bufferLoader = resourceCache.loadEmbeddedBuffer({\n        parentResource: gltfJsonLoader._gltfResource,\n        bufferId: bufferId,\n        typedArray: source,\n      });\n\n      gltfJsonLoader._bufferLoaders.push(bufferLoader);\n      promises.push(bufferLoader.promise);\n    }\n  });\n  return _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].all */ .Z.all(promises);\n}\n\nfunction processGltfJson(gltfJsonLoader, gltf) {\n  (0,_GltfPipeline_addPipelineExtras_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(gltf);\n\n  return decodeDataUris(gltf).then(function () {\n    return upgradeVersion(gltfJsonLoader, gltf).then(function () {\n      (0,_GltfPipeline_addDefaults_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(gltf);\n      return loadEmbeddedBuffers(gltfJsonLoader, gltf).then(function () {\n        (0,_GltfPipeline_removePipelineExtras_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(gltf);\n        return gltf;\n      });\n    });\n  });\n}\n\nfunction processGltfTypedArray(gltfJsonLoader, typedArray) {\n  var gltf;\n  if ((0,_Core_getMagic_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(typedArray) === "glTF") {\n    gltf = (0,_GltfPipeline_parseGlb_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(typedArray);\n  } else {\n    gltf = (0,_Core_getJsonFromTypedArray_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(typedArray);\n  }\n\n  return processGltfJson(gltfJsonLoader, gltf);\n}\n\n/**\n * Unloads the resource.\n * @private\n */\nGltfJsonLoader.prototype.unload = function () {\n  var bufferLoaders = this._bufferLoaders;\n  var bufferLoadersLength = bufferLoaders.length;\n  for (var i = 0; i < bufferLoadersLength; ++i) {\n    this._resourceCache.unload(bufferLoaders[i]);\n  }\n  this._bufferLoaders.length = 0;\n\n  this._gltf = undefined;\n};\n\n/**\n * Exposed for testing\n *\n * @private\n */\nGltfJsonLoader.prototype._fetchGltf = function () {\n  return this._gltfResource.fetchArrayBuffer();\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEdBQUc7QUFDSCxTQUFTLDZFQUFRO0FBQ2pCOztBQUVBO0FBQ0EsRUFBRSx1RkFBaUI7O0FBRW5CO0FBQ0E7QUFDQSxNQUFNLGlGQUFXO0FBQ2pCO0FBQ0EsUUFBUSwyRkFBb0I7QUFDNUI7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0EsTUFBTSxzRUFBUTtBQUNkLFdBQVcsOEVBQVE7QUFDbkIsSUFBSTtBQUNKLFdBQVcsbUZBQXFCO0FBQ2hDOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IseUJBQXlCO0FBQzNDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92dWUzLXdlYnBhY2s1Ly4vbm9kZV9tb2R1bGVzL2Nlc2l1bS9Tb3VyY2UvU2NlbmUvR2x0Zkpzb25Mb2FkZXIuanM/N2Q4MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ2hlY2sgZnJvbSBcIi4uL0NvcmUvQ2hlY2suanNcIjtcbmltcG9ydCBkZWZhdWx0VmFsdWUgZnJvbSBcIi4uL0NvcmUvZGVmYXVsdFZhbHVlLmpzXCI7XG5pbXBvcnQgZGVmaW5lZCBmcm9tIFwiLi4vQ29yZS9kZWZpbmVkLmpzXCI7XG5pbXBvcnQgZ2V0SnNvbkZyb21UeXBlZEFycmF5IGZyb20gXCIuLi9Db3JlL2dldEpzb25Gcm9tVHlwZWRBcnJheS5qc1wiO1xuaW1wb3J0IGdldE1hZ2ljIGZyb20gXCIuLi9Db3JlL2dldE1hZ2ljLmpzXCI7XG5pbXBvcnQgaXNEYXRhVXJpIGZyb20gXCIuLi9Db3JlL2lzRGF0YVVyaS5qc1wiO1xuaW1wb3J0IFJlc291cmNlIGZyb20gXCIuLi9Db3JlL1Jlc291cmNlLmpzXCI7XG5pbXBvcnQgYWRkRGVmYXVsdHMgZnJvbSBcIi4vR2x0ZlBpcGVsaW5lL2FkZERlZmF1bHRzLmpzXCI7XG5pbXBvcnQgYWRkUGlwZWxpbmVFeHRyYXMgZnJvbSBcIi4vR2x0ZlBpcGVsaW5lL2FkZFBpcGVsaW5lRXh0cmFzLmpzXCI7XG5pbXBvcnQgRm9yRWFjaCBmcm9tIFwiLi9HbHRmUGlwZWxpbmUvRm9yRWFjaC5qc1wiO1xuaW1wb3J0IHBhcnNlR2xiIGZyb20gXCIuL0dsdGZQaXBlbGluZS9wYXJzZUdsYi5qc1wiO1xuaW1wb3J0IHJlbW92ZVBpcGVsaW5lRXh0cmFzIGZyb20gXCIuL0dsdGZQaXBlbGluZS9yZW1vdmVQaXBlbGluZUV4dHJhcy5qc1wiO1xuaW1wb3J0IHVwZGF0ZVZlcnNpb24gZnJvbSBcIi4vR2x0ZlBpcGVsaW5lL3VwZGF0ZVZlcnNpb24uanNcIjtcbmltcG9ydCB3aGVuIGZyb20gXCIuLi9UaGlyZFBhcnR5L3doZW4uanNcIjtcbmltcG9ydCBSZXNvdXJjZUxvYWRlciBmcm9tIFwiLi9SZXNvdXJjZUxvYWRlci5qc1wiO1xuaW1wb3J0IFJlc291cmNlTG9hZGVyU3RhdGUgZnJvbSBcIi4vUmVzb3VyY2VMb2FkZXJTdGF0ZS5qc1wiO1xuXG4vKipcbiAqIExvYWRzIGEgZ2xURiBKU09OIGZyb20gYSBnbFRGIG9yIGdsYi5cbiAqIDxwPlxuICogSW1wbGVtZW50cyB0aGUge0BsaW5rIFJlc291cmNlTG9hZGVyfSBpbnRlcmZhY2UuXG4gKiA8L3A+XG4gKlxuICogQGFsaWFzIEdsdGZKc29uTG9hZGVyXG4gKiBAY29uc3RydWN0b3JcbiAqIEBhdWdtZW50cyBSZXNvdXJjZUxvYWRlclxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIE9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqIEBwYXJhbSB7UmVzb3VyY2VDYWNoZX0gb3B0aW9ucy5yZXNvdXJjZUNhY2hlIFRoZSB7QGxpbmsgUmVzb3VyY2VDYWNoZX0gKHRvIGF2b2lkIGNpcmN1bGFyIGRlcGVuZGVuY2llcykuXG4gKiBAcGFyYW0ge1Jlc291cmNlfSBvcHRpb25zLmdsdGZSZXNvdXJjZSBUaGUge0BsaW5rIFJlc291cmNlfSBjb250YWluaW5nIHRoZSBnbFRGLlxuICogQHBhcmFtIHtSZXNvdXJjZX0gb3B0aW9ucy5iYXNlUmVzb3VyY2UgVGhlIHtAbGluayBSZXNvdXJjZX0gdGhhdCBwYXRocyBpbiB0aGUgZ2xURiBKU09OIGFyZSByZWxhdGl2ZSB0by5cbiAqIEBwYXJhbSB7VWludDhBcnJheX0gW29wdGlvbnMudHlwZWRBcnJheV0gVGhlIHR5cGVkIGFycmF5IGNvbnRhaW5pbmcgdGhlIGdsVEYgY29udGVudHMuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMuZ2x0Zkpzb25dIFRoZSBwYXJzZWQgZ2xURiBKU09OIGNvbnRlbnRzLlxuICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLmNhY2hlS2V5XSBUaGUgY2FjaGUga2V5IG9mIHRoZSByZXNvdXJjZS5cbiAqXG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBHbHRmSnNvbkxvYWRlcihvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBkZWZhdWx0VmFsdWUob3B0aW9ucywgZGVmYXVsdFZhbHVlLkVNUFRZX09CSkVDVCk7XG4gIHZhciByZXNvdXJjZUNhY2hlID0gb3B0aW9ucy5yZXNvdXJjZUNhY2hlO1xuICB2YXIgZ2x0ZlJlc291cmNlID0gb3B0aW9ucy5nbHRmUmVzb3VyY2U7XG4gIHZhciBiYXNlUmVzb3VyY2UgPSBvcHRpb25zLmJhc2VSZXNvdXJjZTtcbiAgdmFyIHR5cGVkQXJyYXkgPSBvcHRpb25zLnR5cGVkQXJyYXk7XG4gIHZhciBnbHRmSnNvbiA9IG9wdGlvbnMuZ2x0Zkpzb247XG4gIHZhciBjYWNoZUtleSA9IG9wdGlvbnMuY2FjaGVLZXk7XG5cbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLmZ1bmMoXCJvcHRpb25zLnJlc291cmNlQ2FjaGVcIiwgcmVzb3VyY2VDYWNoZSk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJvcHRpb25zLmdsdGZSZXNvdXJjZVwiLCBnbHRmUmVzb3VyY2UpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwib3B0aW9ucy5iYXNlUmVzb3VyY2VcIiwgYmFzZVJlc291cmNlKTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgdGhpcy5fcmVzb3VyY2VDYWNoZSA9IHJlc291cmNlQ2FjaGU7XG4gIHRoaXMuX2dsdGZSZXNvdXJjZSA9IGdsdGZSZXNvdXJjZTtcbiAgdGhpcy5fYmFzZVJlc291cmNlID0gYmFzZVJlc291cmNlO1xuICB0aGlzLl90eXBlZEFycmF5ID0gdHlwZWRBcnJheTtcbiAgdGhpcy5fZ2x0Zkpzb24gPSBnbHRmSnNvbjtcbiAgdGhpcy5fY2FjaGVLZXkgPSBjYWNoZUtleTtcbiAgdGhpcy5fZ2x0ZiA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fYnVmZmVyTG9hZGVycyA9IFtdO1xuICB0aGlzLl9zdGF0ZSA9IFJlc291cmNlTG9hZGVyU3RhdGUuVU5MT0FERUQ7XG4gIHRoaXMuX3Byb21pc2UgPSB3aGVuLmRlZmVyKCk7XG59XG5cbmlmIChkZWZpbmVkKE9iamVjdC5jcmVhdGUpKSB7XG4gIEdsdGZKc29uTG9hZGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUmVzb3VyY2VMb2FkZXIucHJvdG90eXBlKTtcbiAgR2x0Zkpzb25Mb2FkZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gR2x0Zkpzb25Mb2FkZXI7XG59XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKEdsdGZKc29uTG9hZGVyLnByb3RvdHlwZSwge1xuICAvKipcbiAgICogQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc291cmNlIHdoZW4gdGhlIHJlc291cmNlIGlzIHJlYWR5LlxuICAgKlxuICAgKiBAbWVtYmVyb2YgR2x0Zkpzb25Mb2FkZXIucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtQcm9taXNlLjxHbHRmSnNvbkxvYWRlcj59XG4gICAqIEByZWFkb25seVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJvbWlzZToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3Byb21pc2UucHJvbWlzZTtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogVGhlIGNhY2hlIGtleSBvZiB0aGUgcmVzb3VyY2UuXG4gICAqXG4gICAqIEBtZW1iZXJvZiBHbHRmSnNvbkxvYWRlci5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge1N0cmluZ31cbiAgICogQHJlYWRvbmx5XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBjYWNoZUtleToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlS2V5O1xuICAgIH0sXG4gIH0sXG4gIC8qKlxuICAgKiBUaGUgZ2xURiBKU09OLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgR2x0Zkpzb25Mb2FkZXIucHJvdG90eXBlXG4gICAqXG4gICAqIEB0eXBlIHtPYmplY3R9XG4gICAqIEByZWFkb25seVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2x0Zjoge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2dsdGY7XG4gICAgfSxcbiAgfSxcbn0pO1xuXG4vKipcbiAqIExvYWRzIHRoZSByZXNvdXJjZS5cbiAqIEBwcml2YXRlXG4gKi9cbkdsdGZKc29uTG9hZGVyLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLl9zdGF0ZSA9IFJlc291cmNlTG9hZGVyU3RhdGUuTE9BRElORztcblxuICB2YXIgcHJvY2Vzc1Byb21pc2U7XG4gIGlmIChkZWZpbmVkKHRoaXMuX2dsdGZKc29uKSkge1xuICAgIHByb2Nlc3NQcm9taXNlID0gcHJvY2Vzc0dsdGZKc29uKHRoaXMsIHRoaXMuX2dsdGZKc29uKTtcbiAgfSBlbHNlIGlmIChkZWZpbmVkKHRoaXMuX3R5cGVkQXJyYXkpKSB7XG4gICAgcHJvY2Vzc1Byb21pc2UgPSBwcm9jZXNzR2x0ZlR5cGVkQXJyYXkodGhpcywgdGhpcy5fdHlwZWRBcnJheSk7XG4gIH0gZWxzZSB7XG4gICAgcHJvY2Vzc1Byb21pc2UgPSBsb2FkRnJvbVVyaSh0aGlzKTtcbiAgfVxuXG4gIHZhciB0aGF0ID0gdGhpcztcblxuICByZXR1cm4gcHJvY2Vzc1Byb21pc2VcbiAgICAudGhlbihmdW5jdGlvbiAoZ2x0Zikge1xuICAgICAgaWYgKHRoYXQuaXNEZXN0cm95ZWQoKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGF0Ll9nbHRmID0gZ2x0ZjtcbiAgICAgIHRoYXQuX3N0YXRlID0gUmVzb3VyY2VMb2FkZXJTdGF0ZS5SRUFEWTtcbiAgICAgIHRoYXQuX3Byb21pc2UucmVzb2x2ZSh0aGF0KTtcbiAgICB9KVxuICAgIC5vdGhlcndpc2UoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICBpZiAodGhhdC5pc0Rlc3Ryb3llZCgpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGhhbmRsZUVycm9yKHRoYXQsIGVycm9yKTtcbiAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIGxvYWRGcm9tVXJpKGdsdGZKc29uTG9hZGVyKSB7XG4gIHJldHVybiBnbHRmSnNvbkxvYWRlci5fZmV0Y2hHbHRmKCkudGhlbihmdW5jdGlvbiAoYXJyYXlCdWZmZXIpIHtcbiAgICBpZiAoZ2x0Zkpzb25Mb2FkZXIuaXNEZXN0cm95ZWQoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdHlwZWRBcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyKTtcbiAgICByZXR1cm4gcHJvY2Vzc0dsdGZUeXBlZEFycmF5KGdsdGZKc29uTG9hZGVyLCB0eXBlZEFycmF5KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUVycm9yKGdsdGZKc29uTG9hZGVyLCBlcnJvcikge1xuICBnbHRmSnNvbkxvYWRlci51bmxvYWQoKTtcbiAgZ2x0Zkpzb25Mb2FkZXIuX3N0YXRlID0gUmVzb3VyY2VMb2FkZXJTdGF0ZS5GQUlMRUQ7XG4gIHZhciBlcnJvck1lc3NhZ2UgPSBcIkZhaWxlZCB0byBsb2FkIGdsVEY6IFwiICsgZ2x0Zkpzb25Mb2FkZXIuX2dsdGZSZXNvdXJjZS51cmw7XG4gIGdsdGZKc29uTG9hZGVyLl9wcm9taXNlLnJlamVjdChnbHRmSnNvbkxvYWRlci5nZXRFcnJvcihlcnJvck1lc3NhZ2UsIGVycm9yKSk7XG59XG5cbmZ1bmN0aW9uIHVwZ3JhZGVWZXJzaW9uKGdsdGZKc29uTG9hZGVyLCBnbHRmKSB7XG4gIGlmIChnbHRmLmFzc2V0LnZlcnNpb24gPT09IFwiMi4wXCIpIHtcbiAgICByZXR1cm4gd2hlbi5yZXNvbHZlKCk7XG4gIH1cblxuICAvLyBMb2FkIGFsbCBidWZmZXJzIGludG8gbWVtb3J5LiB1cGRhdGVWZXJzaW9uIHdpbGwgcmVhZCBhbmQgaW4gc29tZSBjYXNlcyBtb2RpZnlcbiAgLy8gdGhlIGJ1ZmZlciBkYXRhLCB3aGljaCBpdCBhY2Nlc3NlcyBmcm9tIGJ1ZmZlci5leHRyYXMuX3BpcGVsaW5lLnNvdXJjZVxuICB2YXIgcHJvbWlzZXMgPSBbXTtcbiAgRm9yRWFjaC5idWZmZXIoZ2x0ZiwgZnVuY3Rpb24gKGJ1ZmZlcikge1xuICAgIGlmIChcbiAgICAgICFkZWZpbmVkKGJ1ZmZlci5leHRyYXMuX3BpcGVsaW5lLnNvdXJjZSkgJiYgLy8gSWdub3JlIHVyaSBpZiB0aGlzIGJ1ZmZlciB1c2VzIHRoZSBnbFRGIDEuMCBLSFJfYmluYXJ5X2dsVEYgZXh0ZW5zaW9uXG4gICAgICBkZWZpbmVkKGJ1ZmZlci51cmkpXG4gICAgKSB7XG4gICAgICB2YXIgcmVzb3VyY2UgPSBnbHRmSnNvbkxvYWRlci5fYmFzZVJlc291cmNlLmdldERlcml2ZWRSZXNvdXJjZSh7XG4gICAgICAgIHVybDogYnVmZmVyLnVyaSxcbiAgICAgIH0pO1xuICAgICAgdmFyIHJlc291cmNlQ2FjaGUgPSBnbHRmSnNvbkxvYWRlci5fcmVzb3VyY2VDYWNoZTtcbiAgICAgIHZhciBidWZmZXJMb2FkZXIgPSByZXNvdXJjZUNhY2hlLmxvYWRFeHRlcm5hbEJ1ZmZlcih7XG4gICAgICAgIHJlc291cmNlOiByZXNvdXJjZSxcbiAgICAgIH0pO1xuXG4gICAgICBnbHRmSnNvbkxvYWRlci5fYnVmZmVyTG9hZGVycy5wdXNoKGJ1ZmZlckxvYWRlcik7XG5cbiAgICAgIHByb21pc2VzLnB1c2goXG4gICAgICAgIGJ1ZmZlckxvYWRlci5wcm9taXNlLnRoZW4oZnVuY3Rpb24gKGJ1ZmZlckxvYWRlcikge1xuICAgICAgICAgIGJ1ZmZlci5leHRyYXMuX3BpcGVsaW5lLnNvdXJjZSA9IGJ1ZmZlckxvYWRlci50eXBlZEFycmF5O1xuICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiB3aGVuLmFsbChwcm9taXNlcykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgdXBkYXRlVmVyc2lvbihnbHRmKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGRlY29kZURhdGFVcmlzKGdsdGYpIHtcbiAgdmFyIHByb21pc2VzID0gW107XG4gIEZvckVhY2guYnVmZmVyKGdsdGYsIGZ1bmN0aW9uIChidWZmZXIpIHtcbiAgICB2YXIgYnVmZmVyVXJpID0gYnVmZmVyLnVyaTtcbiAgICBpZiAoXG4gICAgICAhZGVmaW5lZChidWZmZXIuZXh0cmFzLl9waXBlbGluZS5zb3VyY2UpICYmIC8vIElnbm9yZSB1cmkgaWYgdGhpcyBidWZmZXIgdXNlcyB0aGUgZ2xURiAxLjAgS0hSX2JpbmFyeV9nbFRGIGV4dGVuc2lvblxuICAgICAgZGVmaW5lZChidWZmZXJVcmkpICYmXG4gICAgICBpc0RhdGFVcmkoYnVmZmVyVXJpKVxuICAgICkge1xuICAgICAgZGVsZXRlIGJ1ZmZlci51cmk7IC8vIERlbGV0ZSB0aGUgZGF0YSBVUkkgdG8ga2VlcCB0aGUgY2FjaGVkIGdsVEYgSlNPTiBzbWFsbFxuICAgICAgcHJvbWlzZXMucHVzaChcbiAgICAgICAgUmVzb3VyY2UuZmV0Y2hBcnJheUJ1ZmZlcihidWZmZXJVcmkpLnRoZW4oZnVuY3Rpb24gKGFycmF5QnVmZmVyKSB7XG4gICAgICAgICAgYnVmZmVyLmV4dHJhcy5fcGlwZWxpbmUuc291cmNlID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIpO1xuICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gd2hlbi5hbGwocHJvbWlzZXMpO1xufVxuXG5mdW5jdGlvbiBsb2FkRW1iZWRkZWRCdWZmZXJzKGdsdGZKc29uTG9hZGVyLCBnbHRmKSB7XG4gIHZhciBwcm9taXNlcyA9IFtdO1xuICBGb3JFYWNoLmJ1ZmZlcihnbHRmLCBmdW5jdGlvbiAoYnVmZmVyLCBidWZmZXJJZCkge1xuICAgIHZhciBzb3VyY2UgPSBidWZmZXIuZXh0cmFzLl9waXBlbGluZS5zb3VyY2U7XG4gICAgaWYgKGRlZmluZWQoc291cmNlKSAmJiAhZGVmaW5lZChidWZmZXIudXJpKSkge1xuICAgICAgdmFyIHJlc291cmNlQ2FjaGUgPSBnbHRmSnNvbkxvYWRlci5fcmVzb3VyY2VDYWNoZTtcbiAgICAgIHZhciBidWZmZXJMb2FkZXIgPSByZXNvdXJjZUNhY2hlLmxvYWRFbWJlZGRlZEJ1ZmZlcih7XG4gICAgICAgIHBhcmVudFJlc291cmNlOiBnbHRmSnNvbkxvYWRlci5fZ2x0ZlJlc291cmNlLFxuICAgICAgICBidWZmZXJJZDogYnVmZmVySWQsXG4gICAgICAgIHR5cGVkQXJyYXk6IHNvdXJjZSxcbiAgICAgIH0pO1xuXG4gICAgICBnbHRmSnNvbkxvYWRlci5fYnVmZmVyTG9hZGVycy5wdXNoKGJ1ZmZlckxvYWRlcik7XG4gICAgICBwcm9taXNlcy5wdXNoKGJ1ZmZlckxvYWRlci5wcm9taXNlKTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gd2hlbi5hbGwocHJvbWlzZXMpO1xufVxuXG5mdW5jdGlvbiBwcm9jZXNzR2x0Zkpzb24oZ2x0Zkpzb25Mb2FkZXIsIGdsdGYpIHtcbiAgYWRkUGlwZWxpbmVFeHRyYXMoZ2x0Zik7XG5cbiAgcmV0dXJuIGRlY29kZURhdGFVcmlzKGdsdGYpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB1cGdyYWRlVmVyc2lvbihnbHRmSnNvbkxvYWRlciwgZ2x0ZikudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICBhZGREZWZhdWx0cyhnbHRmKTtcbiAgICAgIHJldHVybiBsb2FkRW1iZWRkZWRCdWZmZXJzKGdsdGZKc29uTG9hZGVyLCBnbHRmKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmVtb3ZlUGlwZWxpbmVFeHRyYXMoZ2x0Zik7XG4gICAgICAgIHJldHVybiBnbHRmO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBwcm9jZXNzR2x0ZlR5cGVkQXJyYXkoZ2x0Zkpzb25Mb2FkZXIsIHR5cGVkQXJyYXkpIHtcbiAgdmFyIGdsdGY7XG4gIGlmIChnZXRNYWdpYyh0eXBlZEFycmF5KSA9PT0gXCJnbFRGXCIpIHtcbiAgICBnbHRmID0gcGFyc2VHbGIodHlwZWRBcnJheSk7XG4gIH0gZWxzZSB7XG4gICAgZ2x0ZiA9IGdldEpzb25Gcm9tVHlwZWRBcnJheSh0eXBlZEFycmF5KTtcbiAgfVxuXG4gIHJldHVybiBwcm9jZXNzR2x0Zkpzb24oZ2x0Zkpzb25Mb2FkZXIsIGdsdGYpO1xufVxuXG4vKipcbiAqIFVubG9hZHMgdGhlIHJlc291cmNlLlxuICogQHByaXZhdGVcbiAqL1xuR2x0Zkpzb25Mb2FkZXIucHJvdG90eXBlLnVubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGJ1ZmZlckxvYWRlcnMgPSB0aGlzLl9idWZmZXJMb2FkZXJzO1xuICB2YXIgYnVmZmVyTG9hZGVyc0xlbmd0aCA9IGJ1ZmZlckxvYWRlcnMubGVuZ3RoO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGJ1ZmZlckxvYWRlcnNMZW5ndGg7ICsraSkge1xuICAgIHRoaXMuX3Jlc291cmNlQ2FjaGUudW5sb2FkKGJ1ZmZlckxvYWRlcnNbaV0pO1xuICB9XG4gIHRoaXMuX2J1ZmZlckxvYWRlcnMubGVuZ3RoID0gMDtcblxuICB0aGlzLl9nbHRmID0gdW5kZWZpbmVkO1xufTtcblxuLyoqXG4gKiBFeHBvc2VkIGZvciB0ZXN0aW5nXG4gKlxuICogQHByaXZhdGVcbiAqL1xuR2x0Zkpzb25Mb2FkZXIucHJvdG90eXBlLl9mZXRjaEdsdGYgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLl9nbHRmUmVzb3VyY2UuZmV0Y2hBcnJheUJ1ZmZlcigpO1xufTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///60785\n')},6366:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "Z": function() { return /* binding */ GltfLoader; }\n/* harmony export */ });\n/* harmony import */ var _Core_arrayFill_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(23401);\n/* harmony import */ var _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(60216);\n/* harmony import */ var _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(63367);\n/* harmony import */ var _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(66553);\n/* harmony import */ var _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(84828);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(82982);\n/* harmony import */ var _Core_FeatureDetection_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(96037);\n/* harmony import */ var _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(72248);\n/* harmony import */ var _Core_Quaternion_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(87811);\n/* harmony import */ var _Renderer_Sampler_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(87721);\n/* harmony import */ var _GltfPipeline_getAccessorByteStride_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(93224);\n/* harmony import */ var _GltfPipeline_getComponentReader_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2378);\n/* harmony import */ var _GltfPipeline_numberOfComponentsForType_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(26806);\n/* harmony import */ var _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(13222);\n/* harmony import */ var _AttributeType_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(77072);\n/* harmony import */ var _Axis_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(66577);\n/* harmony import */ var _GltfFeatureMetadataLoader_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(42670);\n/* harmony import */ var _GltfLoaderUtil_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(61120);\n/* harmony import */ var _InstanceAttributeSemantic_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(57325);\n/* harmony import */ var _ModelComponents_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(7896);\n/* harmony import */ var _ResourceCache_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(38956);\n/* harmony import */ var _ResourceLoader_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(29789);\n/* harmony import */ var _SupportedImageFormats_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(70922);\n/* harmony import */ var _VertexAttributeSemantic_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(26998);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar Attribute = _ModelComponents_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].Attribute */ .Z.Attribute;\nvar Indices = _ModelComponents_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].Indices */ .Z.Indices;\nvar FeatureIdAttribute = _ModelComponents_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].FeatureIdAttribute */ .Z.FeatureIdAttribute;\nvar FeatureIdTexture = _ModelComponents_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].FeatureIdTexture */ .Z.FeatureIdTexture;\nvar MorphTarget = _ModelComponents_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].MorphTarget */ .Z.MorphTarget;\nvar Primitive = _ModelComponents_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].Primitive */ .Z.Primitive;\nvar Instances = _ModelComponents_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].Instances */ .Z.Instances;\nvar Skin = _ModelComponents_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].Skin */ .Z.Skin;\nvar Node = _ModelComponents_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].Node */ .Z.Node;\nvar Scene = _ModelComponents_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].Scene */ .Z.Scene;\nvar Components = _ModelComponents_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].Components */ .Z.Components;\nvar MetallicRoughness = _ModelComponents_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].MetallicRoughness */ .Z.MetallicRoughness;\nvar SpecularGlossiness = _ModelComponents_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].SpecularGlossiness */ .Z.SpecularGlossiness;\nvar Material = _ModelComponents_js__WEBPACK_IMPORTED_MODULE_18__/* ["default"].Material */ .Z.Material;\n\nvar GltfLoaderState = {\n  UNLOADED: 0,\n  LOADING: 1,\n  LOADED: 2,\n  PROCESSING: 3,\n  PROCESSED: 4,\n  READY: 4,\n  FAILED: 5,\n};\n\n/**\n * Loads a glTF model.\n * <p>\n * Implements the {@link ResourceLoader} interface.\n * </p>\n *\n * @alias GltfLoader\n * @constructor\n * @augments ResourceLoader\n *\n * @param {Object} options Object with the following properties:\n * @param {Resource} options.gltfResource The {@link Resource} containing the glTF. This is often the path of the .gltf or .glb file, but may also be the path of the .b3dm, .i3dm, or .cmpt file containing the embedded glb. .cmpt resources should have a URI fragment indicating the index of the inner content to which the glb belongs in order to individually identify the glb in the cache, e.g. http://example.com/tile.cmpt#index=2.\n * @param {Resource} [options.baseResource] The {@link Resource} that paths in the glTF JSON are relative to.\n * @param {Uint8Array} [options.typedArray] The typed array containing the glTF contents, e.g. from a .b3dm, .i3dm, or .cmpt file.\n * @param {Object} [options.gltfJson] A parsed glTF JSON file instead of passing it in as a typed array.\n * @param {Boolean} [options.releaseGltfJson=false] When true, the glTF JSON is released once the glTF is loaded. This is is especially useful for cases like 3D Tiles, where each .gltf model is unique and caching the glTF JSON is not effective.\n * @param {Boolean} [options.asynchronous=true] Determines if WebGL resource creation will be spread out over several frames or block until all WebGL resources are created.\n * @param {Boolean} [options.incrementallyLoadTextures=true] Determine if textures may continue to stream in after the glTF is loaded.\n * @param {Axis} [options.upAxis=Axis.Y] The up-axis of the glTF model.\n * @param {Axis} [options.forwardAxis=Axis.Z] The forward-axis of the glTF model.\n *\n * @private\n */\nfunction GltfLoader(options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n  var gltfResource = options.gltfResource;\n  var baseResource = options.baseResource;\n  var typedArray = options.typedArray;\n  var releaseGltfJson = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options.releaseGltfJson, false);\n  var asynchronous = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options.asynchronous, true);\n  var incrementallyLoadTextures = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(\n    options.incrementallyLoadTextures,\n    true\n  );\n  var upAxis = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options.upAxis, _Axis_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].Y */ .Z.Y);\n  var forwardAxis = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options.forwardAxis, _Axis_js__WEBPACK_IMPORTED_MODULE_14__/* ["default"].Z */ .Z.Z);\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.object */ .Z.typeOf.object("options.gltfResource", gltfResource);\n  //>>includeEnd(\'debug\');\n\n  baseResource = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(baseResource) ? baseResource : gltfResource.clone();\n\n  this._gltfJson = options.gltfJson;\n  this._gltfResource = gltfResource;\n  this._baseResource = baseResource;\n  this._typedArray = typedArray;\n  this._releaseGltfJson = releaseGltfJson;\n  this._asynchronous = asynchronous;\n  this._incrementallyLoadTextures = incrementallyLoadTextures;\n  this._upAxis = upAxis;\n  this._forwardAxis = forwardAxis;\n\n  this._gltfJsonLoader = undefined;\n  this._state = GltfLoaderState.UNLOADED;\n  this._textureState = GltfLoaderState.UNLOADED;\n  this._promise = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].defer */ .Z.defer();\n  this._texturesLoadedPromise = _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].defer */ .Z.defer();\n\n  // Loaders that need to be processed before the glTF becomes ready\n  this._textureLoaders = [];\n  this._bufferViewLoaders = [];\n  this._geometryLoaders = [];\n  this._featureMetadataLoader = undefined;\n\n  // Loaded results\n  this._components = undefined;\n}\n\nif ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(Object.create)) {\n  GltfLoader.prototype = Object.create(_ResourceLoader_js__WEBPACK_IMPORTED_MODULE_20__/* ["default"].prototype */ .Z.prototype);\n  GltfLoader.prototype.constructor = GltfLoader;\n}\n\nObject.defineProperties(GltfLoader.prototype, {\n  /**\n   * A promise that resolves to the resource when the resource is ready.\n   *\n   * @memberof GltfLoader.prototype\n   *\n   * @type {Promise.<GltfLoader>}\n   * @readonly\n   * @private\n   */\n  promise: {\n    get: function () {\n      return this._promise.promise;\n    },\n  },\n  /**\n   * The cache key of the resource.\n   *\n   * @memberof GltfLoader.prototype\n   *\n   * @type {String}\n   * @readonly\n   * @private\n   */\n  cacheKey: {\n    get: function () {\n      return undefined;\n    },\n  },\n  /**\n   * The loaded components.\n   *\n   * @memberof GltfLoader.prototype\n   *\n   * @type {ModelComponents.Components}\n   * @readonly\n   * @private\n   */\n  components: {\n    get: function () {\n      return this._components;\n    },\n  },\n\n  /**\n   * A promise that resolves when all textures are loaded.\n   * When <code>incrementallyLoadTextures</code> is true this may resolve after\n   * <code>promise</code> resolves.\n   *\n   * @memberof GltfLoader.prototype\n   *\n   * @type {Promise}\n   * @readonly\n   * @private\n   */\n  texturesLoadedPromise: {\n    get: function () {\n      return this._texturesLoadedPromise.promise;\n    },\n  },\n});\n\n/**\n * Loads the resource.\n * @private\n */\nGltfLoader.prototype.load = function () {\n  var gltfJsonLoader = _ResourceCache_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].loadGltfJson */ .Z.loadGltfJson({\n    gltfResource: this._gltfResource,\n    baseResource: this._baseResource,\n    typedArray: this._typedArray,\n    gltfJson: this._gltfJson,\n  });\n\n  this._gltfJsonLoader = gltfJsonLoader;\n  this._state = GltfLoaderState.LOADING;\n  this._textureState = GltfLoaderState.LOADING;\n\n  var that = this;\n  gltfJsonLoader.promise\n    .then(function () {\n      if (that.isDestroyed()) {\n        return;\n      }\n      that._state = GltfLoaderState.LOADED;\n      that._textureState = GltfLoaderState.LOADED;\n    })\n    .otherwise(function (error) {\n      if (that.isDestroyed()) {\n        return;\n      }\n      handleError(that, error);\n    });\n};\n\nfunction handleError(gltfLoader, error) {\n  gltfLoader.unload();\n  gltfLoader._state = GltfLoaderState.FAILED;\n  gltfLoader._textureState = GltfLoaderState.FAILED;\n  var errorMessage = "Failed to load glTF";\n  error = gltfLoader.getError(errorMessage, error);\n  gltfLoader._promise.reject(error);\n  gltfLoader._texturesLoadedPromise.reject(error);\n}\n\nfunction process(loader, frameState) {\n  var i;\n  var textureLoaders = loader._textureLoaders;\n  var textureLoadersLength = textureLoaders.length;\n  for (i = 0; i < textureLoadersLength; ++i) {\n    textureLoaders[i].process(frameState);\n  }\n\n  var bufferViewLoaders = loader._bufferViewLoaders;\n  var bufferViewLoadersLength = bufferViewLoaders.length;\n  for (i = 0; i < bufferViewLoadersLength; ++i) {\n    bufferViewLoaders[i].process(frameState);\n  }\n\n  var geometryLoaders = loader._geometryLoaders;\n  var geometryLoadersLength = geometryLoaders.length;\n  for (i = 0; i < geometryLoadersLength; ++i) {\n    geometryLoaders[i].process(frameState);\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(loader._featureMetadataLoader)) {\n    loader._featureMetadataLoader.process(frameState);\n  }\n}\n\n/**\n * Processes the resource until it becomes ready.\n *\n * @param {FrameState} frameState The frame state.\n * @private\n */\nGltfLoader.prototype.process = function (frameState) {\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"].typeOf.object */ .Z.typeOf.object("frameState", frameState);\n  //>>includeEnd(\'debug\');\n\n  if (!_Core_FeatureDetection_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].supportsWebP.initialized */ .Z.supportsWebP.initialized) {\n    _Core_FeatureDetection_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].supportsWebP.initialize */ .Z.supportsWebP.initialize();\n    return;\n  }\n\n  if (this._state === GltfLoaderState.LOADED) {\n    this._state = GltfLoaderState.PROCESSING;\n\n    var supportedImageFormats = new _SupportedImageFormats_js__WEBPACK_IMPORTED_MODULE_21__/* ["default"] */ .Z({\n      webp: _Core_FeatureDetection_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].supportsWebP */ .Z.supportsWebP(),\n      basis: frameState.context.supportsBasis,\n    });\n\n    var gltf;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(this._gltfJsonLoader)) {\n      gltf = this._gltfJsonLoader.gltf;\n    } else {\n      gltf = this._gltfJson;\n    }\n\n    // Parse the glTF which populates the loaders arrays. The ready promise\n    // resolves once all the loaders are ready (i.e. all external resources\n    // have been fetched and all GPU resources have been created). Loaders that\n    // create GPU resources need to be processed every frame until they become\n    // ready since the JobScheduler is not able to execute all jobs in a single\n    // frame. Also note that it\'s fine to call process before a loader is ready\n    // to process; nothing will happen.\n    parse(this, gltf, supportedImageFormats, frameState);\n\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(this._gltfJsonLoader) && this._releaseGltfJson) {\n      // Check that the glTF JSON loader is still defined before trying to unload it.\n      // It may be undefined if the ready promise rejects immediately (which can happen in unit tests)\n      _ResourceCache_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].unload */ .Z.unload(this._gltfJsonLoader);\n      this._gltfJsonLoader = undefined;\n    }\n  }\n\n  if (this._textureState === GltfLoaderState.LOADED) {\n    this._textureState = GltfLoaderState.PROCESSING;\n  }\n\n  if (\n    this._state === GltfLoaderState.PROCESSING ||\n    this._textureState === GltfLoaderState.PROCESSING\n  ) {\n    process(this, frameState);\n  }\n\n  if (this._state === GltfLoaderState.PROCESSED) {\n    unloadBufferViews(this); // Buffer views can be unloaded after the data has been copied\n    this._state = GltfLoaderState.READY;\n    this._promise.resolve(this);\n  }\n\n  if (this._textureState === GltfLoaderState.PROCESSED) {\n    this._textureState = GltfLoaderState.READY;\n    this._texturesLoadedPromise.resolve(this);\n  }\n};\n\nfunction loadVertexBuffer(\n  loader,\n  gltf,\n  accessorId,\n  semantic,\n  draco,\n  dequantize\n) {\n  var accessor = gltf.accessors[accessorId];\n  var bufferViewId = accessor.bufferView;\n\n  var vertexBufferLoader = _ResourceCache_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].loadVertexBuffer */ .Z.loadVertexBuffer({\n    gltf: gltf,\n    gltfResource: loader._gltfResource,\n    baseResource: loader._baseResource,\n    bufferViewId: bufferViewId,\n    draco: draco,\n    attributeSemantic: semantic,\n    accessorId: accessorId,\n    asynchronous: loader._asynchronous,\n    dequantize: dequantize,\n  });\n\n  loader._geometryLoaders.push(vertexBufferLoader);\n\n  return vertexBufferLoader;\n}\n\nfunction loadIndexBuffer(loader, gltf, accessorId, draco) {\n  var indexBufferLoader = _ResourceCache_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].loadIndexBuffer */ .Z.loadIndexBuffer({\n    gltf: gltf,\n    accessorId: accessorId,\n    gltfResource: loader._gltfResource,\n    baseResource: loader._baseResource,\n    draco: draco,\n    asynchronous: loader._asynchronous,\n  });\n\n  loader._geometryLoaders.push(indexBufferLoader);\n\n  return indexBufferLoader;\n}\n\nfunction loadBufferView(loader, gltf, bufferViewId) {\n  var bufferViewLoader = _ResourceCache_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].loadBufferView */ .Z.loadBufferView({\n    gltf: gltf,\n    bufferViewId: bufferViewId,\n    gltfResource: loader._gltfResource,\n    baseResource: loader._baseResource,\n  });\n\n  loader._bufferViewLoaders.push(bufferViewLoader);\n\n  return bufferViewLoader;\n}\n\nfunction getAccessorTypedArray(gltf, accessor, bufferViewTypedArray) {\n  var byteOffset = accessor.byteOffset;\n  var byteStride = (0,_GltfPipeline_getAccessorByteStride_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(gltf, accessor);\n  var count = accessor.count;\n  var componentCount = (0,_GltfPipeline_numberOfComponentsForType_js__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z)(accessor.type);\n  var componentType = accessor.componentType;\n  var componentByteLength = _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].getSizeInBytes */ .Z.getSizeInBytes(componentType);\n  var defaultByteStride = componentByteLength * componentCount;\n  var componentsLength = count * componentCount;\n\n  if (byteStride === defaultByteStride) {\n    // Copy the typed array and let the underlying ArrayBuffer be freed\n    bufferViewTypedArray = new Uint8Array(bufferViewTypedArray);\n    return _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].createArrayBufferView */ .Z.createArrayBufferView(\n      componentType,\n      bufferViewTypedArray.buffer,\n      bufferViewTypedArray.byteOffset + byteOffset,\n      componentsLength\n    );\n  }\n\n  var accessorTypedArray = _Core_ComponentDatatype_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"].createTypedArray */ .Z.createTypedArray(\n    componentType,\n    componentsLength\n  );\n\n  var dataView = new DataView(bufferViewTypedArray.buffer);\n  var components = new Array(componentCount);\n  var componentReader = (0,_GltfPipeline_getComponentReader_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z)(accessor.componentType);\n  byteOffset = bufferViewTypedArray.byteOffset + byteOffset;\n\n  for (var i = 0; i < count; ++i) {\n    componentReader(\n      dataView,\n      byteOffset,\n      componentCount,\n      componentByteLength,\n      components\n    );\n    for (var j = 0; j < componentCount; ++j) {\n      accessorTypedArray[i * componentCount + j] = components[j];\n    }\n    byteOffset += byteStride;\n  }\n\n  return accessorTypedArray;\n}\n\nfunction fromArray(MathType, values) {\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(values)) {\n    return undefined;\n  }\n\n  if (MathType === Number) {\n    return values[0];\n  }\n\n  return MathType.unpack(values);\n}\n\nfunction getDefault(MathType) {\n  if (MathType === Number) {\n    return 0.0;\n  }\n\n  return new MathType(); // defaults to 0.0 for all types\n}\n\nfunction createAttribute(gltf, accessorId, name, semantic, setIndex) {\n  var accessor = gltf.accessors[accessorId];\n  var MathType = _AttributeType_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"].getMathType */ .Z.getMathType(accessor.type);\n\n  var attribute = new Attribute();\n  attribute.name = name;\n  attribute.semantic = semantic;\n  attribute.setIndex = setIndex;\n  attribute.constant = getDefault(MathType);\n  attribute.componentDatatype = accessor.componentType;\n  attribute.normalized = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(accessor.normalized, false);\n  attribute.count = accessor.count;\n  attribute.type = accessor.type;\n  attribute.min = fromArray(MathType, accessor.min);\n  attribute.max = fromArray(MathType, accessor.max);\n  attribute.byteOffset = accessor.byteOffset;\n  attribute.byteStride = (0,_GltfPipeline_getAccessorByteStride_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(gltf, accessor);\n\n  return attribute;\n}\n\nfunction getSetIndex(gltfSemantic) {\n  var setIndexRegex = /^\\w+_(\\d+)$/;\n  var setIndexMatch = setIndexRegex.exec(gltfSemantic);\n  if (setIndexMatch !== null) {\n    return parseInt(setIndexMatch[1]);\n  }\n  return undefined;\n}\n\nfunction loadVertexAttribute(loader, gltf, accessorId, gltfSemantic, draco) {\n  var accessor = gltf.accessors[accessorId];\n  var bufferViewId = accessor.bufferView;\n\n  var name = gltfSemantic;\n  var semantic = _VertexAttributeSemantic_js__WEBPACK_IMPORTED_MODULE_22__/* ["default"].fromGltfSemantic */ .Z.fromGltfSemantic(gltfSemantic);\n  var setIndex = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(semantic) ? getSetIndex(gltfSemantic) : undefined;\n\n  var attribute = createAttribute(gltf, accessorId, name, semantic, setIndex);\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(draco) && !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(bufferViewId)) {\n    return attribute;\n  }\n\n  var vertexBufferLoader = loadVertexBuffer(\n    loader,\n    gltf,\n    accessorId,\n    gltfSemantic,\n    draco,\n    false\n  );\n  vertexBufferLoader.promise.then(function (vertexBufferLoader) {\n    if (loader.isDestroyed()) {\n      return;\n    }\n\n    attribute.buffer = vertexBufferLoader.vertexBuffer;\n\n    if (\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(draco) &&\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(draco.attributes) &&\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(draco.attributes[gltfSemantic])\n    ) {\n      // The accessor\'s byteOffset and byteStride should be ignored for draco.\n      // Each attribute is tightly packed in its own buffer after decode.\n      attribute.byteOffset = 0;\n      attribute.byteStride = undefined;\n      attribute.quantization = vertexBufferLoader.quantization;\n    }\n  });\n\n  return attribute;\n}\n\nfunction loadInstancedAttribute(\n  loader,\n  gltf,\n  accessorId,\n  gltfSemantic,\n  loadAsTypedArray,\n  frameState\n) {\n  var accessor = gltf.accessors[accessorId];\n  var bufferViewId = accessor.bufferView;\n\n  var name = gltfSemantic;\n  var semantic = _InstanceAttributeSemantic_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].fromGltfSemantic */ .Z.fromGltfSemantic(gltfSemantic);\n  var setIndex = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(semantic) ? getSetIndex(gltfSemantic) : undefined;\n\n  var attribute = createAttribute(gltf, accessorId, name, semantic, setIndex);\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(bufferViewId)) {\n    return attribute;\n  }\n\n  if (!loadAsTypedArray && frameState.context.instancedArrays) {\n    // Only create a GPU buffer if the browser supports WebGL instancing\n    // Don\'t pass in draco object since instanced attributes can\'t be draco compressed\n    var vertexBufferLoader = loadVertexBuffer(\n      loader,\n      gltf,\n      accessorId,\n      gltfSemantic,\n      undefined,\n      true\n    );\n    vertexBufferLoader.promise.then(function (vertexBufferLoader) {\n      if (loader.isDestroyed()) {\n        return;\n      }\n      attribute.buffer = vertexBufferLoader.vertexBuffer;\n    });\n    return attribute;\n  }\n\n  var bufferViewLoader = loadBufferView(loader, gltf, bufferViewId);\n  bufferViewLoader.promise.then(function (bufferViewLoader) {\n    if (loader.isDestroyed()) {\n      return;\n    }\n    var bufferViewTypedArray = bufferViewLoader.typedArray;\n    var accessorTypedArray = getAccessorTypedArray(\n      gltf,\n      accessor,\n      bufferViewTypedArray\n    );\n    attribute.typedArray = accessorTypedArray;\n\n    // The accessor\'s byteOffset and byteStride should be ignored since values\n    // are tightly packed in a typed array\n    attribute.byteOffset = 0;\n    attribute.byteStride = undefined;\n  });\n\n  return attribute;\n}\n\nfunction loadIndices(loader, gltf, accessorId, draco) {\n  var accessor = gltf.accessors[accessorId];\n  var bufferViewId = accessor.bufferView;\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(draco) && !(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(bufferViewId)) {\n    return undefined;\n  }\n\n  var indices = new Indices();\n  indices.indexDatatype = accessor.componentType;\n  indices.count = accessor.count;\n\n  var indexBufferLoader = loadIndexBuffer(loader, gltf, accessorId, draco);\n  indexBufferLoader.promise.then(function (indexBufferLoader) {\n    if (loader.isDestroyed()) {\n      return;\n    }\n    indices.buffer = indexBufferLoader.indexBuffer;\n  });\n\n  return indices;\n}\n\nfunction loadTexture(\n  loader,\n  gltf,\n  textureInfo,\n  supportedImageFormats,\n  samplerOverride\n) {\n  var imageId = _GltfLoaderUtil_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].getImageIdFromTexture */ .Z.getImageIdFromTexture({\n    gltf: gltf,\n    textureId: textureInfo.index,\n    supportedImageFormats: supportedImageFormats,\n  });\n\n  if (!(0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(imageId)) {\n    return undefined;\n  }\n\n  var textureLoader = _ResourceCache_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].loadTexture */ .Z.loadTexture({\n    gltf: gltf,\n    textureInfo: textureInfo,\n    gltfResource: loader._gltfResource,\n    baseResource: loader._baseResource,\n    supportedImageFormats: supportedImageFormats,\n    asynchronous: loader._asynchronous,\n  });\n\n  loader._textureLoaders.push(textureLoader);\n\n  var textureReader = _GltfLoaderUtil_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"].createModelTextureReader */ .Z.createModelTextureReader({\n    textureInfo: textureInfo,\n  });\n\n  textureLoader.promise.then(function (textureLoader) {\n    if (loader.isDestroyed()) {\n      return;\n    }\n    textureReader.texture = textureLoader.texture;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(samplerOverride)) {\n      textureReader.texture.sampler = samplerOverride;\n    }\n  });\n\n  return textureReader;\n}\n\nfunction loadMaterial(loader, gltf, gltfMaterial, supportedImageFormats) {\n  var material = new Material();\n\n  var extensions = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(\n    gltfMaterial.extensions,\n    _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT\n  );\n  var pbrSpecularGlossiness = extensions.KHR_materials_pbrSpecularGlossiness;\n  var pbrMetallicRoughness = gltfMaterial.pbrMetallicRoughness;\n\n  material.unlit = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(extensions.KHR_materials_unlit);\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(pbrSpecularGlossiness)) {\n    var specularGlossiness = new SpecularGlossiness();\n    material.specularGlossiness = specularGlossiness;\n\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(pbrSpecularGlossiness.diffuseTexture)) {\n      specularGlossiness.diffuseTexture = loadTexture(\n        loader,\n        gltf,\n        pbrSpecularGlossiness.diffuseTexture,\n        supportedImageFormats\n      );\n    }\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(pbrSpecularGlossiness.specularGlossinessTexture)) {\n      if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(pbrSpecularGlossiness.specularGlossinessTexture)) {\n        specularGlossiness.specularGlossinessTexture = loadTexture(\n          loader,\n          gltf,\n          pbrSpecularGlossiness.specularGlossinessTexture,\n          supportedImageFormats\n        );\n      }\n    }\n    specularGlossiness.diffuseFactor = fromArray(\n      _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z,\n      pbrSpecularGlossiness.diffuseFactor\n    );\n    specularGlossiness.specularFactor = fromArray(\n      _Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z,\n      pbrSpecularGlossiness.specularFactor\n    );\n    specularGlossiness.glossinessFactor =\n      pbrSpecularGlossiness.glossinessFactor;\n    material.pbrSpecularGlossiness = pbrSpecularGlossiness;\n  } else if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(pbrMetallicRoughness)) {\n    var metallicRoughness = new MetallicRoughness();\n    material.metallicRoughness = metallicRoughness;\n\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(pbrMetallicRoughness.baseColorTexture)) {\n      metallicRoughness.baseColorTexture = loadTexture(\n        loader,\n        gltf,\n        pbrMetallicRoughness.baseColorTexture,\n        supportedImageFormats\n      );\n    }\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(pbrMetallicRoughness.metallicRoughnessTexture)) {\n      metallicRoughness.metallicRoughnessTexture = loadTexture(\n        loader,\n        gltf,\n        pbrMetallicRoughness.metallicRoughnessTexture,\n        supportedImageFormats\n      );\n    }\n    metallicRoughness.baseColorFactor = fromArray(\n      _Core_Cartesian4_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z,\n      pbrMetallicRoughness.baseColorFactor\n    );\n    metallicRoughness.metallicFactor = pbrMetallicRoughness.metallicFactor;\n    metallicRoughness.roughnessFactor = pbrMetallicRoughness.roughnessFactor;\n    material.pbrMetallicRoughness = pbrMetallicRoughness;\n  }\n\n  // Top level textures\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(gltfMaterial.emissiveTexture)) {\n    material.emissiveTexture = loadTexture(\n      loader,\n      gltf,\n      gltfMaterial.emissiveTexture,\n      supportedImageFormats\n    );\n  }\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(gltfMaterial.normalTexture)) {\n    material.normalTexture = loadTexture(\n      loader,\n      gltf,\n      gltfMaterial.normalTexture,\n      supportedImageFormats\n    );\n  }\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(gltfMaterial.occlusionTexture)) {\n    material.occlusionTexture = loadTexture(\n      loader,\n      gltf,\n      gltfMaterial.occlusionTexture,\n      supportedImageFormats\n    );\n  }\n  material.emissiveFactor = fromArray(_Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z, gltfMaterial.emissiveFactor);\n  material.alphaMode = gltfMaterial.alphaMode;\n  material.alphaCutoff = gltfMaterial.alphaCutoff;\n  material.doubleSided = gltfMaterial.doubleSided;\n\n  return material;\n}\n\nfunction loadFeatureIdAttribute(gltfFeatureIdAttribute) {\n  var featureIdAttribute = new FeatureIdAttribute();\n  var featureIds = gltfFeatureIdAttribute.featureIds;\n  featureIdAttribute.featureTableId = gltfFeatureIdAttribute.featureTable;\n  featureIdAttribute.setIndex = getSetIndex(featureIds.attribute);\n  featureIdAttribute.constant = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(featureIds.constant, 0);\n  featureIdAttribute.divisor = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(featureIds.divisor, 0);\n  return featureIdAttribute;\n}\n\nfunction loadFeatureIdTexture(\n  loader,\n  gltf,\n  gltfFeatureIdTexture,\n  supportedImageFormats\n) {\n  var featureIdTexture = new FeatureIdTexture();\n  var featureIds = gltfFeatureIdTexture.featureIds;\n  var textureInfo = featureIds.texture;\n\n  featureIdTexture.featureTableId = gltfFeatureIdTexture.featureTable;\n  featureIdTexture.textureReader = loadTexture(\n    loader,\n    gltf,\n    textureInfo,\n    supportedImageFormats,\n    _Renderer_Sampler_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"].NEAREST */ .Z.NEAREST // Feature ID textures require nearest sampling\n  );\n\n  featureIdTexture.textureReader.channels = featureIds.channels;\n\n  return featureIdTexture;\n}\n\nfunction loadMorphTarget(loader, gltf, target) {\n  var morphTarget = new MorphTarget();\n\n  for (var semantic in target) {\n    if (target.hasOwnProperty(semantic)) {\n      var accessorId = target[semantic];\n      morphTarget.attributes.push(\n        // Don\'t pass in draco object since morph targets can\'t be draco compressed\n        loadVertexAttribute(loader, gltf, accessorId, semantic, undefined)\n      );\n    }\n  }\n\n  return morphTarget;\n}\n\nfunction loadPrimitive(\n  loader,\n  gltf,\n  gltfPrimitive,\n  morphWeights,\n  supportedImageFormats\n) {\n  var i;\n\n  var primitive = new Primitive();\n\n  var materialId = gltfPrimitive.material;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(materialId)) {\n    primitive.material = loadMaterial(\n      loader,\n      gltf,\n      gltf.materials[materialId],\n      supportedImageFormats\n    );\n  }\n\n  var extensions = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(\n    gltfPrimitive.extensions,\n    _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT\n  );\n  var draco = extensions.KHR_draco_mesh_compression;\n  var featureMetadata = extensions.EXT_feature_metadata;\n\n  var attributes = gltfPrimitive.attributes;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(attributes)) {\n    for (var semantic in attributes) {\n      if (attributes.hasOwnProperty(semantic)) {\n        var accessorId = attributes[semantic];\n        primitive.attributes.push(\n          loadVertexAttribute(loader, gltf, accessorId, semantic, draco)\n        );\n      }\n    }\n  }\n\n  var targets = gltfPrimitive.targets;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(targets)) {\n    var targetsLength = targets.length;\n    for (i = 0; i < targetsLength; ++i) {\n      primitive.morphTargets.push(loadMorphTarget(loader, gltf, targets[i]));\n    }\n    primitive.morphWeights = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(morphWeights)\n      ? morphWeights.slice()\n      : (0,_Core_arrayFill_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(new Array(targetsLength), 0.0);\n  }\n\n  var indices = gltfPrimitive.indices;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(indices)) {\n    primitive.indices = loadIndices(loader, gltf, indices, draco);\n  }\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(featureMetadata)) {\n    // Feature ID Attributes\n    var featureIdAttributes = featureMetadata.featureIdAttributes;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(featureIdAttributes)) {\n      var featureIdAttributesLength = featureIdAttributes.length;\n      for (i = 0; i < featureIdAttributesLength; ++i) {\n        primitive.featureIdAttributes.push(\n          loadFeatureIdAttribute(featureIdAttributes[i])\n        );\n      }\n    }\n\n    // Feature ID Textures\n    var featureIdTextures = featureMetadata.featureIdTextures;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(featureIdTextures)) {\n      var featureIdTexturesLength = featureIdTextures.length;\n      for (i = 0; i < featureIdTexturesLength; ++i) {\n        primitive.featureIdTextures.push(\n          loadFeatureIdTexture(\n            loader,\n            gltf,\n            featureIdTextures[i],\n            supportedImageFormats\n          )\n        );\n      }\n    }\n\n    // Feature Textures\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(featureMetadata.featureTextures)) {\n      primitive.featureTextureIds = featureMetadata.featureTextures;\n    }\n  }\n\n  primitive.primitiveType = gltfPrimitive.mode;\n\n  return primitive;\n}\n\nfunction loadInstances(loader, gltf, instancingExtension, frameState) {\n  var instances = new Instances();\n  var attributes = instancingExtension.attributes;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(attributes)) {\n    var hasRotation = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(attributes.ROTATION);\n    var hasTranslationMinMax =\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(attributes.TRANSLATION) &&\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(gltf.accessors[attributes.TRANSLATION].min) &&\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(gltf.accessors[attributes.TRANSLATION].max);\n    for (var semantic in attributes) {\n      if (attributes.hasOwnProperty(semantic)) {\n        // If the instances have rotations load the attributes as typed arrays\n        // so that instance matrices are computed on the CPU. This avoids the\n        // expensive quaternion -> rotation matrix conversion in the shader.\n        // If the translation accessor does not have a min and max, load the\n        // attributes as typed arrays, so the values can be used for computing\n        // an accurate bounding volume.\n        var loadAsTypedArray =\n          (hasRotation || !hasTranslationMinMax) &&\n          (semantic === _InstanceAttributeSemantic_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].TRANSLATION */ .Z.TRANSLATION ||\n            semantic === _InstanceAttributeSemantic_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].ROTATION */ .Z.ROTATION ||\n            semantic === _InstanceAttributeSemantic_js__WEBPACK_IMPORTED_MODULE_17__/* ["default"].SCALE */ .Z.SCALE);\n\n        var accessorId = attributes[semantic];\n        instances.attributes.push(\n          loadInstancedAttribute(\n            loader,\n            gltf,\n            accessorId,\n            semantic,\n            loadAsTypedArray,\n            frameState\n          )\n        );\n      }\n    }\n  }\n\n  var extensions = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(\n    instancingExtension.extensions,\n    _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT\n  );\n  var featureMetadata = extensions.EXT_feature_metadata;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(featureMetadata)) {\n    var featureIdAttributes = featureMetadata.featureIdAttributes;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(featureIdAttributes)) {\n      var featureIdAttributesLength = featureIdAttributes.length;\n      for (var i = 0; i < featureIdAttributesLength; ++i) {\n        instances.featureIdAttributes.push(\n          loadFeatureIdAttribute(featureIdAttributes[i])\n        );\n      }\n    }\n  }\n  return instances;\n}\n\nfunction loadSkin(loader, gltf, gltfSkin, nodes) {\n  var skin = new Skin();\n\n  var jointIds = gltfSkin.joints;\n  var jointsLength = jointIds.length;\n  var joints = new Array(jointsLength);\n  for (var i = 0; i < jointsLength; ++i) {\n    joints[i] = nodes[jointIds[i]];\n  }\n  skin.joints = joints;\n\n  var inverseBindMatricesAccessorId = gltfSkin.inverseBindMatrices;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(inverseBindMatricesAccessorId)) {\n    var accessor = gltf.accessors[inverseBindMatricesAccessorId];\n    var bufferViewId = accessor.bufferView;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(bufferViewId)) {\n      var bufferViewLoader = loadBufferView(loader, gltf, bufferViewId);\n      bufferViewLoader.promise.then(function (bufferViewLoader) {\n        if (loader.isDestroyed()) {\n          return;\n        }\n        var bufferViewTypedArray = bufferViewLoader.typedArray;\n        var accessorTypedArray = getAccessorTypedArray(\n          gltf,\n          accessor,\n          bufferViewTypedArray\n        );\n        var inverseBindMatrices = new Array(jointsLength);\n        for (var i = 0; i < jointsLength; ++i) {\n          inverseBindMatrices[i] = _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].unpack */ .Z.unpack(accessorTypedArray, i * 16);\n        }\n        skin.inverseBindMatrices = inverseBindMatrices;\n      });\n    }\n  } else {\n    skin.inverseBindMatrices = (0,_Core_arrayFill_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(\n      new Array(jointsLength),\n      _Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].IDENTITY */ .Z.IDENTITY\n    );\n  }\n\n  return skin;\n}\n\nfunction loadNode(loader, gltf, gltfNode, supportedImageFormats, frameState) {\n  var node = new Node();\n\n  node.matrix = fromArray(_Core_Matrix4_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z, gltfNode.matrix);\n  node.translation = fromArray(_Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z, gltfNode.translation);\n  node.rotation = fromArray(_Core_Quaternion_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, gltfNode.rotation);\n  node.scale = fromArray(_Core_Cartesian3_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z, gltfNode.scale);\n\n  var meshId = gltfNode.mesh;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(meshId)) {\n    var mesh = gltf.meshes[meshId];\n    var morphWeights = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(gltfNode.weights, mesh.weights);\n    var primitives = mesh.primitives;\n    var primitivesLength = primitives.length;\n    for (var i = 0; i < primitivesLength; ++i) {\n      node.primitives.push(\n        loadPrimitive(\n          loader,\n          gltf,\n          primitives[i],\n          morphWeights,\n          supportedImageFormats\n        )\n      );\n    }\n  }\n\n  var extensions = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(gltfNode.extensions, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n  var instancingExtension = extensions.EXT_mesh_gpu_instancing;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(instancingExtension)) {\n    node.instances = loadInstances(\n      loader,\n      gltf,\n      instancingExtension,\n      frameState\n    );\n  }\n\n  return node;\n}\n\nfunction loadNodes(loader, gltf, supportedImageFormats, frameState) {\n  var i;\n  var j;\n\n  var nodesLength = gltf.nodes.length;\n  var nodes = new Array(nodesLength);\n  for (i = 0; i < nodesLength; ++i) {\n    nodes[i] = loadNode(\n      loader,\n      gltf,\n      gltf.nodes[i],\n      supportedImageFormats,\n      frameState\n    );\n  }\n\n  for (i = 0; i < nodesLength; ++i) {\n    var childrenNodeIds = gltf.nodes[i].children;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(childrenNodeIds)) {\n      var childrenLength = childrenNodeIds.length;\n      for (j = 0; j < childrenLength; ++j) {\n        nodes[i].children.push(nodes[childrenNodeIds[j]]);\n      }\n    }\n  }\n\n  for (i = 0; i < nodesLength; ++i) {\n    var skinId = gltf.nodes[i].skin;\n    if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(skinId)) {\n      nodes[i].skin = loadSkin(loader, gltf, gltf.skins[skinId], nodes);\n    }\n  }\n\n  return nodes;\n}\n\nfunction loadFeatureMetadata(loader, gltf, extension, supportedImageFormats) {\n  var featureMetadataLoader = new _GltfFeatureMetadataLoader_js__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z({\n    gltf: gltf,\n    extension: extension,\n    gltfResource: loader._gltfResource,\n    baseResource: loader._baseResource,\n    supportedImageFormats: supportedImageFormats,\n    asynchronous: loader._asynchronous,\n  });\n  featureMetadataLoader.load();\n\n  loader._featureMetadataLoader = featureMetadataLoader;\n\n  return featureMetadataLoader;\n}\n\nfunction getSceneNodeIds(gltf) {\n  var nodesIds;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(gltf.scenes) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(gltf.scene)) {\n    nodesIds = gltf.scenes[gltf.scene].nodes;\n  }\n  nodesIds = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(nodesIds, gltf.nodes);\n  nodesIds = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(nodesIds) ? nodesIds : [];\n  return nodesIds;\n}\n\nfunction loadScene(gltf, nodes, upAxis, forwardAxis) {\n  var scene = new Scene();\n  scene.upAxis = upAxis;\n  scene.forwardAxis = forwardAxis;\n  var sceneNodeIds = getSceneNodeIds(gltf);\n  scene.nodes = sceneNodeIds.map(function (sceneNodeId) {\n    return nodes[sceneNodeId];\n  });\n  return scene;\n}\n\nfunction parse(loader, gltf, supportedImageFormats, frameState) {\n  var nodes = loadNodes(loader, gltf, supportedImageFormats, frameState);\n  var upAxis = loader._upAxis;\n  var forwardAxis = loader._forwardAxis;\n  var scene = loadScene(gltf, nodes, upAxis, forwardAxis);\n\n  var components = new Components();\n  components.scene = scene;\n  components.nodes = nodes;\n\n  loader._components = components;\n\n  // Load feature metadata (feature tables and feature textures)\n  var extensions = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(gltf.extensions, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n  var featureMetadataExtension = extensions.EXT_feature_metadata;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(featureMetadataExtension)) {\n    var featureMetadataLoader = loadFeatureMetadata(\n      loader,\n      gltf,\n      featureMetadataExtension,\n      supportedImageFormats\n    );\n    featureMetadataLoader.promise.then(function (featureMetadataLoader) {\n      if (loader.isDestroyed()) {\n        return;\n      }\n      components.featureMetadata = featureMetadataLoader.featureMetadata;\n    });\n  }\n\n  // Gather promises and reject if any promises fail.\n  var loaders = [];\n  loaders.push.apply(loaders, loader._bufferViewLoaders);\n  loaders.push.apply(loaders, loader._geometryLoaders);\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(loader._featureMetadataLoader)) {\n    loaders.push(loader._featureMetadataLoader);\n  }\n\n  if (!loader._incrementallyLoadTextures) {\n    loaders.push.apply(loaders, loader._textureLoaders);\n  }\n\n  var readyPromises = loaders.map(function (loader) {\n    return loader.promise;\n  });\n\n  // Separate promise will resolve once textures are loaded.\n  var texturePromises = loader._textureLoaders.map(function (loader) {\n    return loader.promise;\n  });\n\n  _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].all */ .Z.all(readyPromises)\n    .then(function () {\n      if (loader.isDestroyed()) {\n        return;\n      }\n      loader._state = GltfLoaderState.PROCESSED;\n    })\n    .otherwise(function (error) {\n      if (loader.isDestroyed()) {\n        return;\n      }\n      handleError(loader, error);\n    });\n\n  _ThirdParty_when_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"].all */ .Z.all(texturePromises).then(function () {\n    if (loader.isDestroyed()) {\n      return;\n    }\n    loader._textureState = GltfLoaderState.PROCESSED;\n  });\n}\n\nfunction unloadTextures(loader) {\n  var textureLoaders = loader._textureLoaders;\n  var textureLoadersLength = textureLoaders.length;\n  for (var i = 0; i < textureLoadersLength; ++i) {\n    _ResourceCache_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].unload */ .Z.unload(textureLoaders[i]);\n  }\n  loader._textureLoaders.length = 0;\n}\n\nfunction unloadBufferViews(loader) {\n  var bufferViewLoaders = loader._bufferViewLoaders;\n  var bufferViewLoadersLength = bufferViewLoaders.length;\n  for (var i = 0; i < bufferViewLoadersLength; ++i) {\n    _ResourceCache_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].unload */ .Z.unload(bufferViewLoaders[i]);\n  }\n  loader._bufferViewLoaders.length = 0;\n}\n\nfunction unloadGeometry(loader) {\n  var geometryLoaders = loader._geometryLoaders;\n  var geometryLoadersLength = geometryLoaders.length;\n  for (var i = 0; i < geometryLoadersLength; ++i) {\n    _ResourceCache_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].unload */ .Z.unload(geometryLoaders[i]);\n  }\n  loader._geometryLoaders.length = 0;\n}\n\nfunction unloadFeatureMetadata(loader) {\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(loader._featureMetadataLoader)) {\n    loader._featureMetadataLoader.destroy();\n    loader._featureMetadataLoader = undefined;\n  }\n}\n\n/**\n * Unloads the resource.\n * @private\n */\nGltfLoader.prototype.unload = function () {\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z)(this._gltfJsonLoader)) {\n    _ResourceCache_js__WEBPACK_IMPORTED_MODULE_19__/* ["default"].unload */ .Z.unload(this._gltfJsonLoader);\n  }\n  this._gltfJsonLoader = undefined;\n\n  unloadTextures(this);\n  unloadBufferViews(this);\n  unloadGeometry(this);\n  unloadFeatureMetadata(this);\n\n  this._components = undefined;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDQTtBQUNBOztBQUVBO0FBQ0EsTUFBTSxzRUFBTztBQUNiO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLHNFQUFPO0FBQ2IsSUFBSSxpRkFBb0I7QUFDeEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnVlMy13ZWJwYWNrNS8uL25vZGVfbW9kdWxlcy9jZXNpdW0vU291cmNlL1NjZW5lL0dsdGZMb2FkZXIuanM/ZGQzOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYXJyYXlGaWxsIGZyb20gXCIuLi9Db3JlL2FycmF5RmlsbC5qc1wiO1xuaW1wb3J0IENhcnRlc2lhbjMgZnJvbSBcIi4uL0NvcmUvQ2FydGVzaWFuMy5qc1wiO1xuaW1wb3J0IENhcnRlc2lhbjQgZnJvbSBcIi4uL0NvcmUvQ2FydGVzaWFuNC5qc1wiO1xuaW1wb3J0IENoZWNrIGZyb20gXCIuLi9Db3JlL0NoZWNrLmpzXCI7XG5pbXBvcnQgQ29tcG9uZW50RGF0YXR5cGUgZnJvbSBcIi4uL0NvcmUvQ29tcG9uZW50RGF0YXR5cGUuanNcIjtcbmltcG9ydCBkZWZhdWx0VmFsdWUgZnJvbSBcIi4uL0NvcmUvZGVmYXVsdFZhbHVlLmpzXCI7XG5pbXBvcnQgZGVmaW5lZCBmcm9tIFwiLi4vQ29yZS9kZWZpbmVkLmpzXCI7XG5pbXBvcnQgRmVhdHVyZURldGVjdGlvbiBmcm9tIFwiLi4vQ29yZS9GZWF0dXJlRGV0ZWN0aW9uLmpzXCI7XG5pbXBvcnQgTWF0cml4NCBmcm9tIFwiLi4vQ29yZS9NYXRyaXg0LmpzXCI7XG5pbXBvcnQgUXVhdGVybmlvbiBmcm9tIFwiLi4vQ29yZS9RdWF0ZXJuaW9uLmpzXCI7XG5pbXBvcnQgU2FtcGxlciBmcm9tIFwiLi4vUmVuZGVyZXIvU2FtcGxlci5qc1wiO1xuaW1wb3J0IGdldEFjY2Vzc29yQnl0ZVN0cmlkZSBmcm9tIFwiLi9HbHRmUGlwZWxpbmUvZ2V0QWNjZXNzb3JCeXRlU3RyaWRlLmpzXCI7XG5pbXBvcnQgZ2V0Q29tcG9uZW50UmVhZGVyIGZyb20gXCIuL0dsdGZQaXBlbGluZS9nZXRDb21wb25lbnRSZWFkZXIuanNcIjtcbmltcG9ydCBudW1iZXJPZkNvbXBvbmVudHNGb3JUeXBlIGZyb20gXCIuL0dsdGZQaXBlbGluZS9udW1iZXJPZkNvbXBvbmVudHNGb3JUeXBlLmpzXCI7XG5pbXBvcnQgd2hlbiBmcm9tIFwiLi4vVGhpcmRQYXJ0eS93aGVuLmpzXCI7XG5pbXBvcnQgQXR0cmlidXRlVHlwZSBmcm9tIFwiLi9BdHRyaWJ1dGVUeXBlLmpzXCI7XG5pbXBvcnQgQXhpcyBmcm9tIFwiLi9BeGlzLmpzXCI7XG5pbXBvcnQgR2x0ZkZlYXR1cmVNZXRhZGF0YUxvYWRlciBmcm9tIFwiLi9HbHRmRmVhdHVyZU1ldGFkYXRhTG9hZGVyLmpzXCI7XG5pbXBvcnQgR2x0ZkxvYWRlclV0aWwgZnJvbSBcIi4vR2x0ZkxvYWRlclV0aWwuanNcIjtcbmltcG9ydCBJbnN0YW5jZUF0dHJpYnV0ZVNlbWFudGljIGZyb20gXCIuL0luc3RhbmNlQXR0cmlidXRlU2VtYW50aWMuanNcIjtcbmltcG9ydCBNb2RlbENvbXBvbmVudHMgZnJvbSBcIi4vTW9kZWxDb21wb25lbnRzLmpzXCI7XG5pbXBvcnQgUmVzb3VyY2VDYWNoZSBmcm9tIFwiLi9SZXNvdXJjZUNhY2hlLmpzXCI7XG5pbXBvcnQgUmVzb3VyY2VMb2FkZXIgZnJvbSBcIi4vUmVzb3VyY2VMb2FkZXIuanNcIjtcbmltcG9ydCBTdXBwb3J0ZWRJbWFnZUZvcm1hdHMgZnJvbSBcIi4vU3VwcG9ydGVkSW1hZ2VGb3JtYXRzLmpzXCI7XG5pbXBvcnQgVmVydGV4QXR0cmlidXRlU2VtYW50aWMgZnJvbSBcIi4vVmVydGV4QXR0cmlidXRlU2VtYW50aWMuanNcIjtcblxudmFyIEF0dHJpYnV0ZSA9IE1vZGVsQ29tcG9uZW50cy5BdHRyaWJ1dGU7XG52YXIgSW5kaWNlcyA9IE1vZGVsQ29tcG9uZW50cy5JbmRpY2VzO1xudmFyIEZlYXR1cmVJZEF0dHJpYnV0ZSA9IE1vZGVsQ29tcG9uZW50cy5GZWF0dXJlSWRBdHRyaWJ1dGU7XG52YXIgRmVhdHVyZUlkVGV4dHVyZSA9IE1vZGVsQ29tcG9uZW50cy5GZWF0dXJlSWRUZXh0dXJlO1xudmFyIE1vcnBoVGFyZ2V0ID0gTW9kZWxDb21wb25lbnRzLk1vcnBoVGFyZ2V0O1xudmFyIFByaW1pdGl2ZSA9IE1vZGVsQ29tcG9uZW50cy5QcmltaXRpdmU7XG52YXIgSW5zdGFuY2VzID0gTW9kZWxDb21wb25lbnRzLkluc3RhbmNlcztcbnZhciBTa2luID0gTW9kZWxDb21wb25lbnRzLlNraW47XG52YXIgTm9kZSA9IE1vZGVsQ29tcG9uZW50cy5Ob2RlO1xudmFyIFNjZW5lID0gTW9kZWxDb21wb25lbnRzLlNjZW5lO1xudmFyIENvbXBvbmVudHMgPSBNb2RlbENvbXBvbmVudHMuQ29tcG9uZW50cztcbnZhciBNZXRhbGxpY1JvdWdobmVzcyA9IE1vZGVsQ29tcG9uZW50cy5NZXRhbGxpY1JvdWdobmVzcztcbnZhciBTcGVjdWxhckdsb3NzaW5lc3MgPSBNb2RlbENvbXBvbmVudHMuU3BlY3VsYXJHbG9zc2luZXNzO1xudmFyIE1hdGVyaWFsID0gTW9kZWxDb21wb25lbnRzLk1hdGVyaWFsO1xuXG52YXIgR2x0ZkxvYWRlclN0YXRlID0ge1xuICBVTkxPQURFRDogMCxcbiAgTE9BRElORzogMSxcbiAgTE9BREVEOiAyLFxuICBQUk9DRVNTSU5HOiAzLFxuICBQUk9DRVNTRUQ6IDQsXG4gIFJFQURZOiA0LFxuICBGQUlMRUQ6IDUsXG59O1xuXG4vKipcbiAqIExvYWRzIGEgZ2xURiBtb2RlbC5cbiAqIDxwPlxuICogSW1wbGVtZW50cyB0aGUge0BsaW5rIFJlc291cmNlTG9hZGVyfSBpbnRlcmZhY2UuXG4gKiA8L3A+XG4gKlxuICogQGFsaWFzIEdsdGZMb2FkZXJcbiAqIEBjb25zdHJ1Y3RvclxuICogQGF1Z21lbnRzIFJlc291cmNlTG9hZGVyXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgT2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxuICogQHBhcmFtIHtSZXNvdXJjZX0gb3B0aW9ucy5nbHRmUmVzb3VyY2UgVGhlIHtAbGluayBSZXNvdXJjZX0gY29udGFpbmluZyB0aGUgZ2xURi4gVGhpcyBpcyBvZnRlbiB0aGUgcGF0aCBvZiB0aGUgLmdsdGYgb3IgLmdsYiBmaWxlLCBidXQgbWF5IGFsc28gYmUgdGhlIHBhdGggb2YgdGhlIC5iM2RtLCAuaTNkbSwgb3IgLmNtcHQgZmlsZSBjb250YWluaW5nIHRoZSBlbWJlZGRlZCBnbGIuIC5jbXB0IHJlc291cmNlcyBzaG91bGQgaGF2ZSBhIFVSSSBmcmFnbWVudCBpbmRpY2F0aW5nIHRoZSBpbmRleCBvZiB0aGUgaW5uZXIgY29udGVudCB0byB3aGljaCB0aGUgZ2xiIGJlbG9uZ3MgaW4gb3JkZXIgdG8gaW5kaXZpZHVhbGx5IGlkZW50aWZ5IHRoZSBnbGIgaW4gdGhlIGNhY2hlLCBlLmcuIGh0dHA6Ly9leGFtcGxlLmNvbS90aWxlLmNtcHQjaW5kZXg9Mi5cbiAqIEBwYXJhbSB7UmVzb3VyY2V9IFtvcHRpb25zLmJhc2VSZXNvdXJjZV0gVGhlIHtAbGluayBSZXNvdXJjZX0gdGhhdCBwYXRocyBpbiB0aGUgZ2xURiBKU09OIGFyZSByZWxhdGl2ZSB0by5cbiAqIEBwYXJhbSB7VWludDhBcnJheX0gW29wdGlvbnMudHlwZWRBcnJheV0gVGhlIHR5cGVkIGFycmF5IGNvbnRhaW5pbmcgdGhlIGdsVEYgY29udGVudHMsIGUuZy4gZnJvbSBhIC5iM2RtLCAuaTNkbSwgb3IgLmNtcHQgZmlsZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5nbHRmSnNvbl0gQSBwYXJzZWQgZ2xURiBKU09OIGZpbGUgaW5zdGVhZCBvZiBwYXNzaW5nIGl0IGluIGFzIGEgdHlwZWQgYXJyYXkuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLnJlbGVhc2VHbHRmSnNvbj1mYWxzZV0gV2hlbiB0cnVlLCB0aGUgZ2xURiBKU09OIGlzIHJlbGVhc2VkIG9uY2UgdGhlIGdsVEYgaXMgbG9hZGVkLiBUaGlzIGlzIGlzIGVzcGVjaWFsbHkgdXNlZnVsIGZvciBjYXNlcyBsaWtlIDNEIFRpbGVzLCB3aGVyZSBlYWNoIC5nbHRmIG1vZGVsIGlzIHVuaXF1ZSBhbmQgY2FjaGluZyB0aGUgZ2xURiBKU09OIGlzIG5vdCBlZmZlY3RpdmUuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmFzeW5jaHJvbm91cz10cnVlXSBEZXRlcm1pbmVzIGlmIFdlYkdMIHJlc291cmNlIGNyZWF0aW9uIHdpbGwgYmUgc3ByZWFkIG91dCBvdmVyIHNldmVyYWwgZnJhbWVzIG9yIGJsb2NrIHVudGlsIGFsbCBXZWJHTCByZXNvdXJjZXMgYXJlIGNyZWF0ZWQuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmluY3JlbWVudGFsbHlMb2FkVGV4dHVyZXM9dHJ1ZV0gRGV0ZXJtaW5lIGlmIHRleHR1cmVzIG1heSBjb250aW51ZSB0byBzdHJlYW0gaW4gYWZ0ZXIgdGhlIGdsVEYgaXMgbG9hZGVkLlxuICogQHBhcmFtIHtBeGlzfSBbb3B0aW9ucy51cEF4aXM9QXhpcy5ZXSBUaGUgdXAtYXhpcyBvZiB0aGUgZ2xURiBtb2RlbC5cbiAqIEBwYXJhbSB7QXhpc30gW29wdGlvbnMuZm9yd2FyZEF4aXM9QXhpcy5aXSBUaGUgZm9yd2FyZC1heGlzIG9mIHRoZSBnbFRGIG1vZGVsLlxuICpcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIEdsdGZMb2FkZXIob3B0aW9ucykge1xuICBvcHRpb25zID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMsIGRlZmF1bHRWYWx1ZS5FTVBUWV9PQkpFQ1QpO1xuICB2YXIgZ2x0ZlJlc291cmNlID0gb3B0aW9ucy5nbHRmUmVzb3VyY2U7XG4gIHZhciBiYXNlUmVzb3VyY2UgPSBvcHRpb25zLmJhc2VSZXNvdXJjZTtcbiAgdmFyIHR5cGVkQXJyYXkgPSBvcHRpb25zLnR5cGVkQXJyYXk7XG4gIHZhciByZWxlYXNlR2x0Zkpzb24gPSBkZWZhdWx0VmFsdWUob3B0aW9ucy5yZWxlYXNlR2x0Zkpzb24sIGZhbHNlKTtcbiAgdmFyIGFzeW5jaHJvbm91cyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmFzeW5jaHJvbm91cywgdHJ1ZSk7XG4gIHZhciBpbmNyZW1lbnRhbGx5TG9hZFRleHR1cmVzID0gZGVmYXVsdFZhbHVlKFxuICAgIG9wdGlvbnMuaW5jcmVtZW50YWxseUxvYWRUZXh0dXJlcyxcbiAgICB0cnVlXG4gICk7XG4gIHZhciB1cEF4aXMgPSBkZWZhdWx0VmFsdWUob3B0aW9ucy51cEF4aXMsIEF4aXMuWSk7XG4gIHZhciBmb3J3YXJkQXhpcyA9IGRlZmF1bHRWYWx1ZShvcHRpb25zLmZvcndhcmRBeGlzLCBBeGlzLlopO1xuXG4gIC8vPj5pbmNsdWRlU3RhcnQoJ2RlYnVnJywgcHJhZ21hcy5kZWJ1Zyk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJvcHRpb25zLmdsdGZSZXNvdXJjZVwiLCBnbHRmUmVzb3VyY2UpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICBiYXNlUmVzb3VyY2UgPSBkZWZpbmVkKGJhc2VSZXNvdXJjZSkgPyBiYXNlUmVzb3VyY2UgOiBnbHRmUmVzb3VyY2UuY2xvbmUoKTtcblxuICB0aGlzLl9nbHRmSnNvbiA9IG9wdGlvbnMuZ2x0Zkpzb247XG4gIHRoaXMuX2dsdGZSZXNvdXJjZSA9IGdsdGZSZXNvdXJjZTtcbiAgdGhpcy5fYmFzZVJlc291cmNlID0gYmFzZVJlc291cmNlO1xuICB0aGlzLl90eXBlZEFycmF5ID0gdHlwZWRBcnJheTtcbiAgdGhpcy5fcmVsZWFzZUdsdGZKc29uID0gcmVsZWFzZUdsdGZKc29uO1xuICB0aGlzLl9hc3luY2hyb25vdXMgPSBhc3luY2hyb25vdXM7XG4gIHRoaXMuX2luY3JlbWVudGFsbHlMb2FkVGV4dHVyZXMgPSBpbmNyZW1lbnRhbGx5TG9hZFRleHR1cmVzO1xuICB0aGlzLl91cEF4aXMgPSB1cEF4aXM7XG4gIHRoaXMuX2ZvcndhcmRBeGlzID0gZm9yd2FyZEF4aXM7XG5cbiAgdGhpcy5fZ2x0Zkpzb25Mb2FkZXIgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX3N0YXRlID0gR2x0ZkxvYWRlclN0YXRlLlVOTE9BREVEO1xuICB0aGlzLl90ZXh0dXJlU3RhdGUgPSBHbHRmTG9hZGVyU3RhdGUuVU5MT0FERUQ7XG4gIHRoaXMuX3Byb21pc2UgPSB3aGVuLmRlZmVyKCk7XG4gIHRoaXMuX3RleHR1cmVzTG9hZGVkUHJvbWlzZSA9IHdoZW4uZGVmZXIoKTtcblxuICAvLyBMb2FkZXJzIHRoYXQgbmVlZCB0byBiZSBwcm9jZXNzZWQgYmVmb3JlIHRoZSBnbFRGIGJlY29tZXMgcmVhZHlcbiAgdGhpcy5fdGV4dHVyZUxvYWRlcnMgPSBbXTtcbiAgdGhpcy5fYnVmZmVyVmlld0xvYWRlcnMgPSBbXTtcbiAgdGhpcy5fZ2VvbWV0cnlMb2FkZXJzID0gW107XG4gIHRoaXMuX2ZlYXR1cmVNZXRhZGF0YUxvYWRlciA9IHVuZGVmaW5lZDtcblxuICAvLyBMb2FkZWQgcmVzdWx0c1xuICB0aGlzLl9jb21wb25lbnRzID0gdW5kZWZpbmVkO1xufVxuXG5pZiAoZGVmaW5lZChPYmplY3QuY3JlYXRlKSkge1xuICBHbHRmTG9hZGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUmVzb3VyY2VMb2FkZXIucHJvdG90eXBlKTtcbiAgR2x0ZkxvYWRlci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBHbHRmTG9hZGVyO1xufVxuXG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhHbHRmTG9hZGVyLnByb3RvdHlwZSwge1xuICAvKipcbiAgICogQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc291cmNlIHdoZW4gdGhlIHJlc291cmNlIGlzIHJlYWR5LlxuICAgKlxuICAgKiBAbWVtYmVyb2YgR2x0ZkxvYWRlci5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge1Byb21pc2UuPEdsdGZMb2FkZXI+fVxuICAgKiBAcmVhZG9ubHlcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHByb21pc2U6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9wcm9taXNlLnByb21pc2U7XG4gICAgfSxcbiAgfSxcbiAgLyoqXG4gICAqIFRoZSBjYWNoZSBrZXkgb2YgdGhlIHJlc291cmNlLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgR2x0ZkxvYWRlci5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge1N0cmluZ31cbiAgICogQHJlYWRvbmx5XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBjYWNoZUtleToge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9LFxuICB9LFxuICAvKipcbiAgICogVGhlIGxvYWRlZCBjb21wb25lbnRzLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgR2x0ZkxvYWRlci5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge01vZGVsQ29tcG9uZW50cy5Db21wb25lbnRzfVxuICAgKiBAcmVhZG9ubHlcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGNvbXBvbmVudHM6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jb21wb25lbnRzO1xuICAgIH0sXG4gIH0sXG5cbiAgLyoqXG4gICAqIEEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIHdoZW4gYWxsIHRleHR1cmVzIGFyZSBsb2FkZWQuXG4gICAqIFdoZW4gPGNvZGU+aW5jcmVtZW50YWxseUxvYWRUZXh0dXJlczwvY29kZT4gaXMgdHJ1ZSB0aGlzIG1heSByZXNvbHZlIGFmdGVyXG4gICAqIDxjb2RlPnByb21pc2U8L2NvZGU+IHJlc29sdmVzLlxuICAgKlxuICAgKiBAbWVtYmVyb2YgR2x0ZkxvYWRlci5wcm90b3R5cGVcbiAgICpcbiAgICogQHR5cGUge1Byb21pc2V9XG4gICAqIEByZWFkb25seVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdGV4dHVyZXNMb2FkZWRQcm9taXNlOiB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdGV4dHVyZXNMb2FkZWRQcm9taXNlLnByb21pc2U7XG4gICAgfSxcbiAgfSxcbn0pO1xuXG4vKipcbiAqIExvYWRzIHRoZSByZXNvdXJjZS5cbiAqIEBwcml2YXRlXG4gKi9cbkdsdGZMb2FkZXIucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBnbHRmSnNvbkxvYWRlciA9IFJlc291cmNlQ2FjaGUubG9hZEdsdGZKc29uKHtcbiAgICBnbHRmUmVzb3VyY2U6IHRoaXMuX2dsdGZSZXNvdXJjZSxcbiAgICBiYXNlUmVzb3VyY2U6IHRoaXMuX2Jhc2VSZXNvdXJjZSxcbiAgICB0eXBlZEFycmF5OiB0aGlzLl90eXBlZEFycmF5LFxuICAgIGdsdGZKc29uOiB0aGlzLl9nbHRmSnNvbixcbiAgfSk7XG5cbiAgdGhpcy5fZ2x0Zkpzb25Mb2FkZXIgPSBnbHRmSnNvbkxvYWRlcjtcbiAgdGhpcy5fc3RhdGUgPSBHbHRmTG9hZGVyU3RhdGUuTE9BRElORztcbiAgdGhpcy5fdGV4dHVyZVN0YXRlID0gR2x0ZkxvYWRlclN0YXRlLkxPQURJTkc7XG5cbiAgdmFyIHRoYXQgPSB0aGlzO1xuICBnbHRmSnNvbkxvYWRlci5wcm9taXNlXG4gICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoYXQuaXNEZXN0cm95ZWQoKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGF0Ll9zdGF0ZSA9IEdsdGZMb2FkZXJTdGF0ZS5MT0FERUQ7XG4gICAgICB0aGF0Ll90ZXh0dXJlU3RhdGUgPSBHbHRmTG9hZGVyU3RhdGUuTE9BREVEO1xuICAgIH0pXG4gICAgLm90aGVyd2lzZShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgIGlmICh0aGF0LmlzRGVzdHJveWVkKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaGFuZGxlRXJyb3IodGhhdCwgZXJyb3IpO1xuICAgIH0pO1xufTtcblxuZnVuY3Rpb24gaGFuZGxlRXJyb3IoZ2x0ZkxvYWRlciwgZXJyb3IpIHtcbiAgZ2x0ZkxvYWRlci51bmxvYWQoKTtcbiAgZ2x0ZkxvYWRlci5fc3RhdGUgPSBHbHRmTG9hZGVyU3RhdGUuRkFJTEVEO1xuICBnbHRmTG9hZGVyLl90ZXh0dXJlU3RhdGUgPSBHbHRmTG9hZGVyU3RhdGUuRkFJTEVEO1xuICB2YXIgZXJyb3JNZXNzYWdlID0gXCJGYWlsZWQgdG8gbG9hZCBnbFRGXCI7XG4gIGVycm9yID0gZ2x0ZkxvYWRlci5nZXRFcnJvcihlcnJvck1lc3NhZ2UsIGVycm9yKTtcbiAgZ2x0ZkxvYWRlci5fcHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICBnbHRmTG9hZGVyLl90ZXh0dXJlc0xvYWRlZFByb21pc2UucmVqZWN0KGVycm9yKTtcbn1cblxuZnVuY3Rpb24gcHJvY2Vzcyhsb2FkZXIsIGZyYW1lU3RhdGUpIHtcbiAgdmFyIGk7XG4gIHZhciB0ZXh0dXJlTG9hZGVycyA9IGxvYWRlci5fdGV4dHVyZUxvYWRlcnM7XG4gIHZhciB0ZXh0dXJlTG9hZGVyc0xlbmd0aCA9IHRleHR1cmVMb2FkZXJzLmxlbmd0aDtcbiAgZm9yIChpID0gMDsgaSA8IHRleHR1cmVMb2FkZXJzTGVuZ3RoOyArK2kpIHtcbiAgICB0ZXh0dXJlTG9hZGVyc1tpXS5wcm9jZXNzKGZyYW1lU3RhdGUpO1xuICB9XG5cbiAgdmFyIGJ1ZmZlclZpZXdMb2FkZXJzID0gbG9hZGVyLl9idWZmZXJWaWV3TG9hZGVycztcbiAgdmFyIGJ1ZmZlclZpZXdMb2FkZXJzTGVuZ3RoID0gYnVmZmVyVmlld0xvYWRlcnMubGVuZ3RoO1xuICBmb3IgKGkgPSAwOyBpIDwgYnVmZmVyVmlld0xvYWRlcnNMZW5ndGg7ICsraSkge1xuICAgIGJ1ZmZlclZpZXdMb2FkZXJzW2ldLnByb2Nlc3MoZnJhbWVTdGF0ZSk7XG4gIH1cblxuICB2YXIgZ2VvbWV0cnlMb2FkZXJzID0gbG9hZGVyLl9nZW9tZXRyeUxvYWRlcnM7XG4gIHZhciBnZW9tZXRyeUxvYWRlcnNMZW5ndGggPSBnZW9tZXRyeUxvYWRlcnMubGVuZ3RoO1xuICBmb3IgKGkgPSAwOyBpIDwgZ2VvbWV0cnlMb2FkZXJzTGVuZ3RoOyArK2kpIHtcbiAgICBnZW9tZXRyeUxvYWRlcnNbaV0ucHJvY2VzcyhmcmFtZVN0YXRlKTtcbiAgfVxuXG4gIGlmIChkZWZpbmVkKGxvYWRlci5fZmVhdHVyZU1ldGFkYXRhTG9hZGVyKSkge1xuICAgIGxvYWRlci5fZmVhdHVyZU1ldGFkYXRhTG9hZGVyLnByb2Nlc3MoZnJhbWVTdGF0ZSk7XG4gIH1cbn1cblxuLyoqXG4gKiBQcm9jZXNzZXMgdGhlIHJlc291cmNlIHVudGlsIGl0IGJlY29tZXMgcmVhZHkuXG4gKlxuICogQHBhcmFtIHtGcmFtZVN0YXRlfSBmcmFtZVN0YXRlIFRoZSBmcmFtZSBzdGF0ZS5cbiAqIEBwcml2YXRlXG4gKi9cbkdsdGZMb2FkZXIucHJvdG90eXBlLnByb2Nlc3MgPSBmdW5jdGlvbiAoZnJhbWVTdGF0ZSkge1xuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwiZnJhbWVTdGF0ZVwiLCBmcmFtZVN0YXRlKTtcbiAgLy8+PmluY2x1ZGVFbmQoJ2RlYnVnJyk7XG5cbiAgaWYgKCFGZWF0dXJlRGV0ZWN0aW9uLnN1cHBvcnRzV2ViUC5pbml0aWFsaXplZCkge1xuICAgIEZlYXR1cmVEZXRlY3Rpb24uc3VwcG9ydHNXZWJQLmluaXRpYWxpemUoKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAodGhpcy5fc3RhdGUgPT09IEdsdGZMb2FkZXJTdGF0ZS5MT0FERUQpIHtcbiAgICB0aGlzLl9zdGF0ZSA9IEdsdGZMb2FkZXJTdGF0ZS5QUk9DRVNTSU5HO1xuXG4gICAgdmFyIHN1cHBvcnRlZEltYWdlRm9ybWF0cyA9IG5ldyBTdXBwb3J0ZWRJbWFnZUZvcm1hdHMoe1xuICAgICAgd2VicDogRmVhdHVyZURldGVjdGlvbi5zdXBwb3J0c1dlYlAoKSxcbiAgICAgIGJhc2lzOiBmcmFtZVN0YXRlLmNvbnRleHQuc3VwcG9ydHNCYXNpcyxcbiAgICB9KTtcblxuICAgIHZhciBnbHRmO1xuICAgIGlmIChkZWZpbmVkKHRoaXMuX2dsdGZKc29uTG9hZGVyKSkge1xuICAgICAgZ2x0ZiA9IHRoaXMuX2dsdGZKc29uTG9hZGVyLmdsdGY7XG4gICAgfSBlbHNlIHtcbiAgICAgIGdsdGYgPSB0aGlzLl9nbHRmSnNvbjtcbiAgICB9XG5cbiAgICAvLyBQYXJzZSB0aGUgZ2xURiB3aGljaCBwb3B1bGF0ZXMgdGhlIGxvYWRlcnMgYXJyYXlzLiBUaGUgcmVhZHkgcHJvbWlzZVxuICAgIC8vIHJlc29sdmVzIG9uY2UgYWxsIHRoZSBsb2FkZXJzIGFyZSByZWFkeSAoaS5lLiBhbGwgZXh0ZXJuYWwgcmVzb3VyY2VzXG4gICAgLy8gaGF2ZSBiZWVuIGZldGNoZWQgYW5kIGFsbCBHUFUgcmVzb3VyY2VzIGhhdmUgYmVlbiBjcmVhdGVkKS4gTG9hZGVycyB0aGF0XG4gICAgLy8gY3JlYXRlIEdQVSByZXNvdXJjZXMgbmVlZCB0byBiZSBwcm9jZXNzZWQgZXZlcnkgZnJhbWUgdW50aWwgdGhleSBiZWNvbWVcbiAgICAvLyByZWFkeSBzaW5jZSB0aGUgSm9iU2NoZWR1bGVyIGlzIG5vdCBhYmxlIHRvIGV4ZWN1dGUgYWxsIGpvYnMgaW4gYSBzaW5nbGVcbiAgICAvLyBmcmFtZS4gQWxzbyBub3RlIHRoYXQgaXQncyBmaW5lIHRvIGNhbGwgcHJvY2VzcyBiZWZvcmUgYSBsb2FkZXIgaXMgcmVhZHlcbiAgICAvLyB0byBwcm9jZXNzOyBub3RoaW5nIHdpbGwgaGFwcGVuLlxuICAgIHBhcnNlKHRoaXMsIGdsdGYsIHN1cHBvcnRlZEltYWdlRm9ybWF0cywgZnJhbWVTdGF0ZSk7XG5cbiAgICBpZiAoZGVmaW5lZCh0aGlzLl9nbHRmSnNvbkxvYWRlcikgJiYgdGhpcy5fcmVsZWFzZUdsdGZKc29uKSB7XG4gICAgICAvLyBDaGVjayB0aGF0IHRoZSBnbFRGIEpTT04gbG9hZGVyIGlzIHN0aWxsIGRlZmluZWQgYmVmb3JlIHRyeWluZyB0byB1bmxvYWQgaXQuXG4gICAgICAvLyBJdCBtYXkgYmUgdW5kZWZpbmVkIGlmIHRoZSByZWFkeSBwcm9taXNlIHJlamVjdHMgaW1tZWRpYXRlbHkgKHdoaWNoIGNhbiBoYXBwZW4gaW4gdW5pdCB0ZXN0cylcbiAgICAgIFJlc291cmNlQ2FjaGUudW5sb2FkKHRoaXMuX2dsdGZKc29uTG9hZGVyKTtcbiAgICAgIHRoaXMuX2dsdGZKc29uTG9hZGVyID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfVxuXG4gIGlmICh0aGlzLl90ZXh0dXJlU3RhdGUgPT09IEdsdGZMb2FkZXJTdGF0ZS5MT0FERUQpIHtcbiAgICB0aGlzLl90ZXh0dXJlU3RhdGUgPSBHbHRmTG9hZGVyU3RhdGUuUFJPQ0VTU0lORztcbiAgfVxuXG4gIGlmIChcbiAgICB0aGlzLl9zdGF0ZSA9PT0gR2x0ZkxvYWRlclN0YXRlLlBST0NFU1NJTkcgfHxcbiAgICB0aGlzLl90ZXh0dXJlU3RhdGUgPT09IEdsdGZMb2FkZXJTdGF0ZS5QUk9DRVNTSU5HXG4gICkge1xuICAgIHByb2Nlc3ModGhpcywgZnJhbWVTdGF0ZSk7XG4gIH1cblxuICBpZiAodGhpcy5fc3RhdGUgPT09IEdsdGZMb2FkZXJTdGF0ZS5QUk9DRVNTRUQpIHtcbiAgICB1bmxvYWRCdWZmZXJWaWV3cyh0aGlzKTsgLy8gQnVmZmVyIHZpZXdzIGNhbiBiZSB1bmxvYWRlZCBhZnRlciB0aGUgZGF0YSBoYXMgYmVlbiBjb3BpZWRcbiAgICB0aGlzLl9zdGF0ZSA9IEdsdGZMb2FkZXJTdGF0ZS5SRUFEWTtcbiAgICB0aGlzLl9wcm9taXNlLnJlc29sdmUodGhpcyk7XG4gIH1cblxuICBpZiAodGhpcy5fdGV4dHVyZVN0YXRlID09PSBHbHRmTG9hZGVyU3RhdGUuUFJPQ0VTU0VEKSB7XG4gICAgdGhpcy5fdGV4dHVyZVN0YXRlID0gR2x0ZkxvYWRlclN0YXRlLlJFQURZO1xuICAgIHRoaXMuX3RleHR1cmVzTG9hZGVkUHJvbWlzZS5yZXNvbHZlKHRoaXMpO1xuICB9XG59O1xuXG5mdW5jdGlvbiBsb2FkVmVydGV4QnVmZmVyKFxuICBsb2FkZXIsXG4gIGdsdGYsXG4gIGFjY2Vzc29ySWQsXG4gIHNlbWFudGljLFxuICBkcmFjbyxcbiAgZGVxdWFudGl6ZVxuKSB7XG4gIHZhciBhY2Nlc3NvciA9IGdsdGYuYWNjZXNzb3JzW2FjY2Vzc29ySWRdO1xuICB2YXIgYnVmZmVyVmlld0lkID0gYWNjZXNzb3IuYnVmZmVyVmlldztcblxuICB2YXIgdmVydGV4QnVmZmVyTG9hZGVyID0gUmVzb3VyY2VDYWNoZS5sb2FkVmVydGV4QnVmZmVyKHtcbiAgICBnbHRmOiBnbHRmLFxuICAgIGdsdGZSZXNvdXJjZTogbG9hZGVyLl9nbHRmUmVzb3VyY2UsXG4gICAgYmFzZVJlc291cmNlOiBsb2FkZXIuX2Jhc2VSZXNvdXJjZSxcbiAgICBidWZmZXJWaWV3SWQ6IGJ1ZmZlclZpZXdJZCxcbiAgICBkcmFjbzogZHJhY28sXG4gICAgYXR0cmlidXRlU2VtYW50aWM6IHNlbWFudGljLFxuICAgIGFjY2Vzc29ySWQ6IGFjY2Vzc29ySWQsXG4gICAgYXN5bmNocm9ub3VzOiBsb2FkZXIuX2FzeW5jaHJvbm91cyxcbiAgICBkZXF1YW50aXplOiBkZXF1YW50aXplLFxuICB9KTtcblxuICBsb2FkZXIuX2dlb21ldHJ5TG9hZGVycy5wdXNoKHZlcnRleEJ1ZmZlckxvYWRlcik7XG5cbiAgcmV0dXJuIHZlcnRleEJ1ZmZlckxvYWRlcjtcbn1cblxuZnVuY3Rpb24gbG9hZEluZGV4QnVmZmVyKGxvYWRlciwgZ2x0ZiwgYWNjZXNzb3JJZCwgZHJhY28pIHtcbiAgdmFyIGluZGV4QnVmZmVyTG9hZGVyID0gUmVzb3VyY2VDYWNoZS5sb2FkSW5kZXhCdWZmZXIoe1xuICAgIGdsdGY6IGdsdGYsXG4gICAgYWNjZXNzb3JJZDogYWNjZXNzb3JJZCxcbiAgICBnbHRmUmVzb3VyY2U6IGxvYWRlci5fZ2x0ZlJlc291cmNlLFxuICAgIGJhc2VSZXNvdXJjZTogbG9hZGVyLl9iYXNlUmVzb3VyY2UsXG4gICAgZHJhY286IGRyYWNvLFxuICAgIGFzeW5jaHJvbm91czogbG9hZGVyLl9hc3luY2hyb25vdXMsXG4gIH0pO1xuXG4gIGxvYWRlci5fZ2VvbWV0cnlMb2FkZXJzLnB1c2goaW5kZXhCdWZmZXJMb2FkZXIpO1xuXG4gIHJldHVybiBpbmRleEJ1ZmZlckxvYWRlcjtcbn1cblxuZnVuY3Rpb24gbG9hZEJ1ZmZlclZpZXcobG9hZGVyLCBnbHRmLCBidWZmZXJWaWV3SWQpIHtcbiAgdmFyIGJ1ZmZlclZpZXdMb2FkZXIgPSBSZXNvdXJjZUNhY2hlLmxvYWRCdWZmZXJWaWV3KHtcbiAgICBnbHRmOiBnbHRmLFxuICAgIGJ1ZmZlclZpZXdJZDogYnVmZmVyVmlld0lkLFxuICAgIGdsdGZSZXNvdXJjZTogbG9hZGVyLl9nbHRmUmVzb3VyY2UsXG4gICAgYmFzZVJlc291cmNlOiBsb2FkZXIuX2Jhc2VSZXNvdXJjZSxcbiAgfSk7XG5cbiAgbG9hZGVyLl9idWZmZXJWaWV3TG9hZGVycy5wdXNoKGJ1ZmZlclZpZXdMb2FkZXIpO1xuXG4gIHJldHVybiBidWZmZXJWaWV3TG9hZGVyO1xufVxuXG5mdW5jdGlvbiBnZXRBY2Nlc3NvclR5cGVkQXJyYXkoZ2x0ZiwgYWNjZXNzb3IsIGJ1ZmZlclZpZXdUeXBlZEFycmF5KSB7XG4gIHZhciBieXRlT2Zmc2V0ID0gYWNjZXNzb3IuYnl0ZU9mZnNldDtcbiAgdmFyIGJ5dGVTdHJpZGUgPSBnZXRBY2Nlc3NvckJ5dGVTdHJpZGUoZ2x0ZiwgYWNjZXNzb3IpO1xuICB2YXIgY291bnQgPSBhY2Nlc3Nvci5jb3VudDtcbiAgdmFyIGNvbXBvbmVudENvdW50ID0gbnVtYmVyT2ZDb21wb25lbnRzRm9yVHlwZShhY2Nlc3Nvci50eXBlKTtcbiAgdmFyIGNvbXBvbmVudFR5cGUgPSBhY2Nlc3Nvci5jb21wb25lbnRUeXBlO1xuICB2YXIgY29tcG9uZW50Qnl0ZUxlbmd0aCA9IENvbXBvbmVudERhdGF0eXBlLmdldFNpemVJbkJ5dGVzKGNvbXBvbmVudFR5cGUpO1xuICB2YXIgZGVmYXVsdEJ5dGVTdHJpZGUgPSBjb21wb25lbnRCeXRlTGVuZ3RoICogY29tcG9uZW50Q291bnQ7XG4gIHZhciBjb21wb25lbnRzTGVuZ3RoID0gY291bnQgKiBjb21wb25lbnRDb3VudDtcblxuICBpZiAoYnl0ZVN0cmlkZSA9PT0gZGVmYXVsdEJ5dGVTdHJpZGUpIHtcbiAgICAvLyBDb3B5IHRoZSB0eXBlZCBhcnJheSBhbmQgbGV0IHRoZSB1bmRlcmx5aW5nIEFycmF5QnVmZmVyIGJlIGZyZWVkXG4gICAgYnVmZmVyVmlld1R5cGVkQXJyYXkgPSBuZXcgVWludDhBcnJheShidWZmZXJWaWV3VHlwZWRBcnJheSk7XG4gICAgcmV0dXJuIENvbXBvbmVudERhdGF0eXBlLmNyZWF0ZUFycmF5QnVmZmVyVmlldyhcbiAgICAgIGNvbXBvbmVudFR5cGUsXG4gICAgICBidWZmZXJWaWV3VHlwZWRBcnJheS5idWZmZXIsXG4gICAgICBidWZmZXJWaWV3VHlwZWRBcnJheS5ieXRlT2Zmc2V0ICsgYnl0ZU9mZnNldCxcbiAgICAgIGNvbXBvbmVudHNMZW5ndGhcbiAgICApO1xuICB9XG5cbiAgdmFyIGFjY2Vzc29yVHlwZWRBcnJheSA9IENvbXBvbmVudERhdGF0eXBlLmNyZWF0ZVR5cGVkQXJyYXkoXG4gICAgY29tcG9uZW50VHlwZSxcbiAgICBjb21wb25lbnRzTGVuZ3RoXG4gICk7XG5cbiAgdmFyIGRhdGFWaWV3ID0gbmV3IERhdGFWaWV3KGJ1ZmZlclZpZXdUeXBlZEFycmF5LmJ1ZmZlcik7XG4gIHZhciBjb21wb25lbnRzID0gbmV3IEFycmF5KGNvbXBvbmVudENvdW50KTtcbiAgdmFyIGNvbXBvbmVudFJlYWRlciA9IGdldENvbXBvbmVudFJlYWRlcihhY2Nlc3Nvci5jb21wb25lbnRUeXBlKTtcbiAgYnl0ZU9mZnNldCA9IGJ1ZmZlclZpZXdUeXBlZEFycmF5LmJ5dGVPZmZzZXQgKyBieXRlT2Zmc2V0O1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7ICsraSkge1xuICAgIGNvbXBvbmVudFJlYWRlcihcbiAgICAgIGRhdGFWaWV3LFxuICAgICAgYnl0ZU9mZnNldCxcbiAgICAgIGNvbXBvbmVudENvdW50LFxuICAgICAgY29tcG9uZW50Qnl0ZUxlbmd0aCxcbiAgICAgIGNvbXBvbmVudHNcbiAgICApO1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgY29tcG9uZW50Q291bnQ7ICsraikge1xuICAgICAgYWNjZXNzb3JUeXBlZEFycmF5W2kgKiBjb21wb25lbnRDb3VudCArIGpdID0gY29tcG9uZW50c1tqXTtcbiAgICB9XG4gICAgYnl0ZU9mZnNldCArPSBieXRlU3RyaWRlO1xuICB9XG5cbiAgcmV0dXJuIGFjY2Vzc29yVHlwZWRBcnJheTtcbn1cblxuZnVuY3Rpb24gZnJvbUFycmF5KE1hdGhUeXBlLCB2YWx1ZXMpIHtcbiAgaWYgKCFkZWZpbmVkKHZhbHVlcykpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgaWYgKE1hdGhUeXBlID09PSBOdW1iZXIpIHtcbiAgICByZXR1cm4gdmFsdWVzWzBdO1xuICB9XG5cbiAgcmV0dXJuIE1hdGhUeXBlLnVucGFjayh2YWx1ZXMpO1xufVxuXG5mdW5jdGlvbiBnZXREZWZhdWx0KE1hdGhUeXBlKSB7XG4gIGlmIChNYXRoVHlwZSA9PT0gTnVtYmVyKSB7XG4gICAgcmV0dXJuIDAuMDtcbiAgfVxuXG4gIHJldHVybiBuZXcgTWF0aFR5cGUoKTsgLy8gZGVmYXVsdHMgdG8gMC4wIGZvciBhbGwgdHlwZXNcbn1cblxuZnVuY3Rpb24gY3JlYXRlQXR0cmlidXRlKGdsdGYsIGFjY2Vzc29ySWQsIG5hbWUsIHNlbWFudGljLCBzZXRJbmRleCkge1xuICB2YXIgYWNjZXNzb3IgPSBnbHRmLmFjY2Vzc29yc1thY2Nlc3NvcklkXTtcbiAgdmFyIE1hdGhUeXBlID0gQXR0cmlidXRlVHlwZS5nZXRNYXRoVHlwZShhY2Nlc3Nvci50eXBlKTtcblxuICB2YXIgYXR0cmlidXRlID0gbmV3IEF0dHJpYnV0ZSgpO1xuICBhdHRyaWJ1dGUubmFtZSA9IG5hbWU7XG4gIGF0dHJpYnV0ZS5zZW1hbnRpYyA9IHNlbWFudGljO1xuICBhdHRyaWJ1dGUuc2V0SW5kZXggPSBzZXRJbmRleDtcbiAgYXR0cmlidXRlLmNvbnN0YW50ID0gZ2V0RGVmYXVsdChNYXRoVHlwZSk7XG4gIGF0dHJpYnV0ZS5jb21wb25lbnREYXRhdHlwZSA9IGFjY2Vzc29yLmNvbXBvbmVudFR5cGU7XG4gIGF0dHJpYnV0ZS5ub3JtYWxpemVkID0gZGVmYXVsdFZhbHVlKGFjY2Vzc29yLm5vcm1hbGl6ZWQsIGZhbHNlKTtcbiAgYXR0cmlidXRlLmNvdW50ID0gYWNjZXNzb3IuY291bnQ7XG4gIGF0dHJpYnV0ZS50eXBlID0gYWNjZXNzb3IudHlwZTtcbiAgYXR0cmlidXRlLm1pbiA9IGZyb21BcnJheShNYXRoVHlwZSwgYWNjZXNzb3IubWluKTtcbiAgYXR0cmlidXRlLm1heCA9IGZyb21BcnJheShNYXRoVHlwZSwgYWNjZXNzb3IubWF4KTtcbiAgYXR0cmlidXRlLmJ5dGVPZmZzZXQgPSBhY2Nlc3Nvci5ieXRlT2Zmc2V0O1xuICBhdHRyaWJ1dGUuYnl0ZVN0cmlkZSA9IGdldEFjY2Vzc29yQnl0ZVN0cmlkZShnbHRmLCBhY2Nlc3Nvcik7XG5cbiAgcmV0dXJuIGF0dHJpYnV0ZTtcbn1cblxuZnVuY3Rpb24gZ2V0U2V0SW5kZXgoZ2x0ZlNlbWFudGljKSB7XG4gIHZhciBzZXRJbmRleFJlZ2V4ID0gL15cXHcrXyhcXGQrKSQvO1xuICB2YXIgc2V0SW5kZXhNYXRjaCA9IHNldEluZGV4UmVnZXguZXhlYyhnbHRmU2VtYW50aWMpO1xuICBpZiAoc2V0SW5kZXhNYXRjaCAhPT0gbnVsbCkge1xuICAgIHJldHVybiBwYXJzZUludChzZXRJbmRleE1hdGNoWzFdKTtcbiAgfVxuICByZXR1cm4gdW5kZWZpbmVkO1xufVxuXG5mdW5jdGlvbiBsb2FkVmVydGV4QXR0cmlidXRlKGxvYWRlciwgZ2x0ZiwgYWNjZXNzb3JJZCwgZ2x0ZlNlbWFudGljLCBkcmFjbykge1xuICB2YXIgYWNjZXNzb3IgPSBnbHRmLmFjY2Vzc29yc1thY2Nlc3NvcklkXTtcbiAgdmFyIGJ1ZmZlclZpZXdJZCA9IGFjY2Vzc29yLmJ1ZmZlclZpZXc7XG5cbiAgdmFyIG5hbWUgPSBnbHRmU2VtYW50aWM7XG4gIHZhciBzZW1hbnRpYyA9IFZlcnRleEF0dHJpYnV0ZVNlbWFudGljLmZyb21HbHRmU2VtYW50aWMoZ2x0ZlNlbWFudGljKTtcbiAgdmFyIHNldEluZGV4ID0gZGVmaW5lZChzZW1hbnRpYykgPyBnZXRTZXRJbmRleChnbHRmU2VtYW50aWMpIDogdW5kZWZpbmVkO1xuXG4gIHZhciBhdHRyaWJ1dGUgPSBjcmVhdGVBdHRyaWJ1dGUoZ2x0ZiwgYWNjZXNzb3JJZCwgbmFtZSwgc2VtYW50aWMsIHNldEluZGV4KTtcblxuICBpZiAoIWRlZmluZWQoZHJhY28pICYmICFkZWZpbmVkKGJ1ZmZlclZpZXdJZCkpIHtcbiAgICByZXR1cm4gYXR0cmlidXRlO1xuICB9XG5cbiAgdmFyIHZlcnRleEJ1ZmZlckxvYWRlciA9IGxvYWRWZXJ0ZXhCdWZmZXIoXG4gICAgbG9hZGVyLFxuICAgIGdsdGYsXG4gICAgYWNjZXNzb3JJZCxcbiAgICBnbHRmU2VtYW50aWMsXG4gICAgZHJhY28sXG4gICAgZmFsc2VcbiAgKTtcbiAgdmVydGV4QnVmZmVyTG9hZGVyLnByb21pc2UudGhlbihmdW5jdGlvbiAodmVydGV4QnVmZmVyTG9hZGVyKSB7XG4gICAgaWYgKGxvYWRlci5pc0Rlc3Ryb3llZCgpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgYXR0cmlidXRlLmJ1ZmZlciA9IHZlcnRleEJ1ZmZlckxvYWRlci52ZXJ0ZXhCdWZmZXI7XG5cbiAgICBpZiAoXG4gICAgICBkZWZpbmVkKGRyYWNvKSAmJlxuICAgICAgZGVmaW5lZChkcmFjby5hdHRyaWJ1dGVzKSAmJlxuICAgICAgZGVmaW5lZChkcmFjby5hdHRyaWJ1dGVzW2dsdGZTZW1hbnRpY10pXG4gICAgKSB7XG4gICAgICAvLyBUaGUgYWNjZXNzb3IncyBieXRlT2Zmc2V0IGFuZCBieXRlU3RyaWRlIHNob3VsZCBiZSBpZ25vcmVkIGZvciBkcmFjby5cbiAgICAgIC8vIEVhY2ggYXR0cmlidXRlIGlzIHRpZ2h0bHkgcGFja2VkIGluIGl0cyBvd24gYnVmZmVyIGFmdGVyIGRlY29kZS5cbiAgICAgIGF0dHJpYnV0ZS5ieXRlT2Zmc2V0ID0gMDtcbiAgICAgIGF0dHJpYnV0ZS5ieXRlU3RyaWRlID0gdW5kZWZpbmVkO1xuICAgICAgYXR0cmlidXRlLnF1YW50aXphdGlvbiA9IHZlcnRleEJ1ZmZlckxvYWRlci5xdWFudGl6YXRpb247XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gYXR0cmlidXRlO1xufVxuXG5mdW5jdGlvbiBsb2FkSW5zdGFuY2VkQXR0cmlidXRlKFxuICBsb2FkZXIsXG4gIGdsdGYsXG4gIGFjY2Vzc29ySWQsXG4gIGdsdGZTZW1hbnRpYyxcbiAgbG9hZEFzVHlwZWRBcnJheSxcbiAgZnJhbWVTdGF0ZVxuKSB7XG4gIHZhciBhY2Nlc3NvciA9IGdsdGYuYWNjZXNzb3JzW2FjY2Vzc29ySWRdO1xuICB2YXIgYnVmZmVyVmlld0lkID0gYWNjZXNzb3IuYnVmZmVyVmlldztcblxuICB2YXIgbmFtZSA9IGdsdGZTZW1hbnRpYztcbiAgdmFyIHNlbWFudGljID0gSW5zdGFuY2VBdHRyaWJ1dGVTZW1hbnRpYy5mcm9tR2x0ZlNlbWFudGljKGdsdGZTZW1hbnRpYyk7XG4gIHZhciBzZXRJbmRleCA9IGRlZmluZWQoc2VtYW50aWMpID8gZ2V0U2V0SW5kZXgoZ2x0ZlNlbWFudGljKSA6IHVuZGVmaW5lZDtcblxuICB2YXIgYXR0cmlidXRlID0gY3JlYXRlQXR0cmlidXRlKGdsdGYsIGFjY2Vzc29ySWQsIG5hbWUsIHNlbWFudGljLCBzZXRJbmRleCk7XG5cbiAgaWYgKCFkZWZpbmVkKGJ1ZmZlclZpZXdJZCkpIHtcbiAgICByZXR1cm4gYXR0cmlidXRlO1xuICB9XG5cbiAgaWYgKCFsb2FkQXNUeXBlZEFycmF5ICYmIGZyYW1lU3RhdGUuY29udGV4dC5pbnN0YW5jZWRBcnJheXMpIHtcbiAgICAvLyBPbmx5IGNyZWF0ZSBhIEdQVSBidWZmZXIgaWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgV2ViR0wgaW5zdGFuY2luZ1xuICAgIC8vIERvbid0IHBhc3MgaW4gZHJhY28gb2JqZWN0IHNpbmNlIGluc3RhbmNlZCBhdHRyaWJ1dGVzIGNhbid0IGJlIGRyYWNvIGNvbXByZXNzZWRcbiAgICB2YXIgdmVydGV4QnVmZmVyTG9hZGVyID0gbG9hZFZlcnRleEJ1ZmZlcihcbiAgICAgIGxvYWRlcixcbiAgICAgIGdsdGYsXG4gICAgICBhY2Nlc3NvcklkLFxuICAgICAgZ2x0ZlNlbWFudGljLFxuICAgICAgdW5kZWZpbmVkLFxuICAgICAgdHJ1ZVxuICAgICk7XG4gICAgdmVydGV4QnVmZmVyTG9hZGVyLnByb21pc2UudGhlbihmdW5jdGlvbiAodmVydGV4QnVmZmVyTG9hZGVyKSB7XG4gICAgICBpZiAobG9hZGVyLmlzRGVzdHJveWVkKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgYXR0cmlidXRlLmJ1ZmZlciA9IHZlcnRleEJ1ZmZlckxvYWRlci52ZXJ0ZXhCdWZmZXI7XG4gICAgfSk7XG4gICAgcmV0dXJuIGF0dHJpYnV0ZTtcbiAgfVxuXG4gIHZhciBidWZmZXJWaWV3TG9hZGVyID0gbG9hZEJ1ZmZlclZpZXcobG9hZGVyLCBnbHRmLCBidWZmZXJWaWV3SWQpO1xuICBidWZmZXJWaWV3TG9hZGVyLnByb21pc2UudGhlbihmdW5jdGlvbiAoYnVmZmVyVmlld0xvYWRlcikge1xuICAgIGlmIChsb2FkZXIuaXNEZXN0cm95ZWQoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgYnVmZmVyVmlld1R5cGVkQXJyYXkgPSBidWZmZXJWaWV3TG9hZGVyLnR5cGVkQXJyYXk7XG4gICAgdmFyIGFjY2Vzc29yVHlwZWRBcnJheSA9IGdldEFjY2Vzc29yVHlwZWRBcnJheShcbiAgICAgIGdsdGYsXG4gICAgICBhY2Nlc3NvcixcbiAgICAgIGJ1ZmZlclZpZXdUeXBlZEFycmF5XG4gICAgKTtcbiAgICBhdHRyaWJ1dGUudHlwZWRBcnJheSA9IGFjY2Vzc29yVHlwZWRBcnJheTtcblxuICAgIC8vIFRoZSBhY2Nlc3NvcidzIGJ5dGVPZmZzZXQgYW5kIGJ5dGVTdHJpZGUgc2hvdWxkIGJlIGlnbm9yZWQgc2luY2UgdmFsdWVzXG4gICAgLy8gYXJlIHRpZ2h0bHkgcGFja2VkIGluIGEgdHlwZWQgYXJyYXlcbiAgICBhdHRyaWJ1dGUuYnl0ZU9mZnNldCA9IDA7XG4gICAgYXR0cmlidXRlLmJ5dGVTdHJpZGUgPSB1bmRlZmluZWQ7XG4gIH0pO1xuXG4gIHJldHVybiBhdHRyaWJ1dGU7XG59XG5cbmZ1bmN0aW9uIGxvYWRJbmRpY2VzKGxvYWRlciwgZ2x0ZiwgYWNjZXNzb3JJZCwgZHJhY28pIHtcbiAgdmFyIGFjY2Vzc29yID0gZ2x0Zi5hY2Nlc3NvcnNbYWNjZXNzb3JJZF07XG4gIHZhciBidWZmZXJWaWV3SWQgPSBhY2Nlc3Nvci5idWZmZXJWaWV3O1xuXG4gIGlmICghZGVmaW5lZChkcmFjbykgJiYgIWRlZmluZWQoYnVmZmVyVmlld0lkKSkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICB2YXIgaW5kaWNlcyA9IG5ldyBJbmRpY2VzKCk7XG4gIGluZGljZXMuaW5kZXhEYXRhdHlwZSA9IGFjY2Vzc29yLmNvbXBvbmVudFR5cGU7XG4gIGluZGljZXMuY291bnQgPSBhY2Nlc3Nvci5jb3VudDtcblxuICB2YXIgaW5kZXhCdWZmZXJMb2FkZXIgPSBsb2FkSW5kZXhCdWZmZXIobG9hZGVyLCBnbHRmLCBhY2Nlc3NvcklkLCBkcmFjbyk7XG4gIGluZGV4QnVmZmVyTG9hZGVyLnByb21pc2UudGhlbihmdW5jdGlvbiAoaW5kZXhCdWZmZXJMb2FkZXIpIHtcbiAgICBpZiAobG9hZGVyLmlzRGVzdHJveWVkKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaW5kaWNlcy5idWZmZXIgPSBpbmRleEJ1ZmZlckxvYWRlci5pbmRleEJ1ZmZlcjtcbiAgfSk7XG5cbiAgcmV0dXJuIGluZGljZXM7XG59XG5cbmZ1bmN0aW9uIGxvYWRUZXh0dXJlKFxuICBsb2FkZXIsXG4gIGdsdGYsXG4gIHRleHR1cmVJbmZvLFxuICBzdXBwb3J0ZWRJbWFnZUZvcm1hdHMsXG4gIHNhbXBsZXJPdmVycmlkZVxuKSB7XG4gIHZhciBpbWFnZUlkID0gR2x0ZkxvYWRlclV0aWwuZ2V0SW1hZ2VJZEZyb21UZXh0dXJlKHtcbiAgICBnbHRmOiBnbHRmLFxuICAgIHRleHR1cmVJZDogdGV4dHVyZUluZm8uaW5kZXgsXG4gICAgc3VwcG9ydGVkSW1hZ2VGb3JtYXRzOiBzdXBwb3J0ZWRJbWFnZUZvcm1hdHMsXG4gIH0pO1xuXG4gIGlmICghZGVmaW5lZChpbWFnZUlkKSkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICB2YXIgdGV4dHVyZUxvYWRlciA9IFJlc291cmNlQ2FjaGUubG9hZFRleHR1cmUoe1xuICAgIGdsdGY6IGdsdGYsXG4gICAgdGV4dHVyZUluZm86IHRleHR1cmVJbmZvLFxuICAgIGdsdGZSZXNvdXJjZTogbG9hZGVyLl9nbHRmUmVzb3VyY2UsXG4gICAgYmFzZVJlc291cmNlOiBsb2FkZXIuX2Jhc2VSZXNvdXJjZSxcbiAgICBzdXBwb3J0ZWRJbWFnZUZvcm1hdHM6IHN1cHBvcnRlZEltYWdlRm9ybWF0cyxcbiAgICBhc3luY2hyb25vdXM6IGxvYWRlci5fYXN5bmNocm9ub3VzLFxuICB9KTtcblxuICBsb2FkZXIuX3RleHR1cmVMb2FkZXJzLnB1c2godGV4dHVyZUxvYWRlcik7XG5cbiAgdmFyIHRleHR1cmVSZWFkZXIgPSBHbHRmTG9hZGVyVXRpbC5jcmVhdGVNb2RlbFRleHR1cmVSZWFkZXIoe1xuICAgIHRleHR1cmVJbmZvOiB0ZXh0dXJlSW5mbyxcbiAgfSk7XG5cbiAgdGV4dHVyZUxvYWRlci5wcm9taXNlLnRoZW4oZnVuY3Rpb24gKHRleHR1cmVMb2FkZXIpIHtcbiAgICBpZiAobG9hZGVyLmlzRGVzdHJveWVkKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGV4dHVyZVJlYWRlci50ZXh0dXJlID0gdGV4dHVyZUxvYWRlci50ZXh0dXJlO1xuICAgIGlmIChkZWZpbmVkKHNhbXBsZXJPdmVycmlkZSkpIHtcbiAgICAgIHRleHR1cmVSZWFkZXIudGV4dHVyZS5zYW1wbGVyID0gc2FtcGxlck92ZXJyaWRlO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHRleHR1cmVSZWFkZXI7XG59XG5cbmZ1bmN0aW9uIGxvYWRNYXRlcmlhbChsb2FkZXIsIGdsdGYsIGdsdGZNYXRlcmlhbCwgc3VwcG9ydGVkSW1hZ2VGb3JtYXRzKSB7XG4gIHZhciBtYXRlcmlhbCA9IG5ldyBNYXRlcmlhbCgpO1xuXG4gIHZhciBleHRlbnNpb25zID0gZGVmYXVsdFZhbHVlKFxuICAgIGdsdGZNYXRlcmlhbC5leHRlbnNpb25zLFxuICAgIGRlZmF1bHRWYWx1ZS5FTVBUWV9PQkpFQ1RcbiAgKTtcbiAgdmFyIHBiclNwZWN1bGFyR2xvc3NpbmVzcyA9IGV4dGVuc2lvbnMuS0hSX21hdGVyaWFsc19wYnJTcGVjdWxhckdsb3NzaW5lc3M7XG4gIHZhciBwYnJNZXRhbGxpY1JvdWdobmVzcyA9IGdsdGZNYXRlcmlhbC5wYnJNZXRhbGxpY1JvdWdobmVzcztcblxuICBtYXRlcmlhbC51bmxpdCA9IGRlZmluZWQoZXh0ZW5zaW9ucy5LSFJfbWF0ZXJpYWxzX3VubGl0KTtcblxuICBpZiAoZGVmaW5lZChwYnJTcGVjdWxhckdsb3NzaW5lc3MpKSB7XG4gICAgdmFyIHNwZWN1bGFyR2xvc3NpbmVzcyA9IG5ldyBTcGVjdWxhckdsb3NzaW5lc3MoKTtcbiAgICBtYXRlcmlhbC5zcGVjdWxhckdsb3NzaW5lc3MgPSBzcGVjdWxhckdsb3NzaW5lc3M7XG5cbiAgICBpZiAoZGVmaW5lZChwYnJTcGVjdWxhckdsb3NzaW5lc3MuZGlmZnVzZVRleHR1cmUpKSB7XG4gICAgICBzcGVjdWxhckdsb3NzaW5lc3MuZGlmZnVzZVRleHR1cmUgPSBsb2FkVGV4dHVyZShcbiAgICAgICAgbG9hZGVyLFxuICAgICAgICBnbHRmLFxuICAgICAgICBwYnJTcGVjdWxhckdsb3NzaW5lc3MuZGlmZnVzZVRleHR1cmUsXG4gICAgICAgIHN1cHBvcnRlZEltYWdlRm9ybWF0c1xuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKGRlZmluZWQocGJyU3BlY3VsYXJHbG9zc2luZXNzLnNwZWN1bGFyR2xvc3NpbmVzc1RleHR1cmUpKSB7XG4gICAgICBpZiAoZGVmaW5lZChwYnJTcGVjdWxhckdsb3NzaW5lc3Muc3BlY3VsYXJHbG9zc2luZXNzVGV4dHVyZSkpIHtcbiAgICAgICAgc3BlY3VsYXJHbG9zc2luZXNzLnNwZWN1bGFyR2xvc3NpbmVzc1RleHR1cmUgPSBsb2FkVGV4dHVyZShcbiAgICAgICAgICBsb2FkZXIsXG4gICAgICAgICAgZ2x0ZixcbiAgICAgICAgICBwYnJTcGVjdWxhckdsb3NzaW5lc3Muc3BlY3VsYXJHbG9zc2luZXNzVGV4dHVyZSxcbiAgICAgICAgICBzdXBwb3J0ZWRJbWFnZUZvcm1hdHNcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgc3BlY3VsYXJHbG9zc2luZXNzLmRpZmZ1c2VGYWN0b3IgPSBmcm9tQXJyYXkoXG4gICAgICBDYXJ0ZXNpYW40LFxuICAgICAgcGJyU3BlY3VsYXJHbG9zc2luZXNzLmRpZmZ1c2VGYWN0b3JcbiAgICApO1xuICAgIHNwZWN1bGFyR2xvc3NpbmVzcy5zcGVjdWxhckZhY3RvciA9IGZyb21BcnJheShcbiAgICAgIENhcnRlc2lhbjMsXG4gICAgICBwYnJTcGVjdWxhckdsb3NzaW5lc3Muc3BlY3VsYXJGYWN0b3JcbiAgICApO1xuICAgIHNwZWN1bGFyR2xvc3NpbmVzcy5nbG9zc2luZXNzRmFjdG9yID1cbiAgICAgIHBiclNwZWN1bGFyR2xvc3NpbmVzcy5nbG9zc2luZXNzRmFjdG9yO1xuICAgIG1hdGVyaWFsLnBiclNwZWN1bGFyR2xvc3NpbmVzcyA9IHBiclNwZWN1bGFyR2xvc3NpbmVzcztcbiAgfSBlbHNlIGlmIChkZWZpbmVkKHBick1ldGFsbGljUm91Z2huZXNzKSkge1xuICAgIHZhciBtZXRhbGxpY1JvdWdobmVzcyA9IG5ldyBNZXRhbGxpY1JvdWdobmVzcygpO1xuICAgIG1hdGVyaWFsLm1ldGFsbGljUm91Z2huZXNzID0gbWV0YWxsaWNSb3VnaG5lc3M7XG5cbiAgICBpZiAoZGVmaW5lZChwYnJNZXRhbGxpY1JvdWdobmVzcy5iYXNlQ29sb3JUZXh0dXJlKSkge1xuICAgICAgbWV0YWxsaWNSb3VnaG5lc3MuYmFzZUNvbG9yVGV4dHVyZSA9IGxvYWRUZXh0dXJlKFxuICAgICAgICBsb2FkZXIsXG4gICAgICAgIGdsdGYsXG4gICAgICAgIHBick1ldGFsbGljUm91Z2huZXNzLmJhc2VDb2xvclRleHR1cmUsXG4gICAgICAgIHN1cHBvcnRlZEltYWdlRm9ybWF0c1xuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKGRlZmluZWQocGJyTWV0YWxsaWNSb3VnaG5lc3MubWV0YWxsaWNSb3VnaG5lc3NUZXh0dXJlKSkge1xuICAgICAgbWV0YWxsaWNSb3VnaG5lc3MubWV0YWxsaWNSb3VnaG5lc3NUZXh0dXJlID0gbG9hZFRleHR1cmUoXG4gICAgICAgIGxvYWRlcixcbiAgICAgICAgZ2x0ZixcbiAgICAgICAgcGJyTWV0YWxsaWNSb3VnaG5lc3MubWV0YWxsaWNSb3VnaG5lc3NUZXh0dXJlLFxuICAgICAgICBzdXBwb3J0ZWRJbWFnZUZvcm1hdHNcbiAgICAgICk7XG4gICAgfVxuICAgIG1ldGFsbGljUm91Z2huZXNzLmJhc2VDb2xvckZhY3RvciA9IGZyb21BcnJheShcbiAgICAgIENhcnRlc2lhbjQsXG4gICAgICBwYnJNZXRhbGxpY1JvdWdobmVzcy5iYXNlQ29sb3JGYWN0b3JcbiAgICApO1xuICAgIG1ldGFsbGljUm91Z2huZXNzLm1ldGFsbGljRmFjdG9yID0gcGJyTWV0YWxsaWNSb3VnaG5lc3MubWV0YWxsaWNGYWN0b3I7XG4gICAgbWV0YWxsaWNSb3VnaG5lc3Mucm91Z2huZXNzRmFjdG9yID0gcGJyTWV0YWxsaWNSb3VnaG5lc3Mucm91Z2huZXNzRmFjdG9yO1xuICAgIG1hdGVyaWFsLnBick1ldGFsbGljUm91Z2huZXNzID0gcGJyTWV0YWxsaWNSb3VnaG5lc3M7XG4gIH1cblxuICAvLyBUb3AgbGV2ZWwgdGV4dHVyZXNcbiAgaWYgKGRlZmluZWQoZ2x0Zk1hdGVyaWFsLmVtaXNzaXZlVGV4dHVyZSkpIHtcbiAgICBtYXRlcmlhbC5lbWlzc2l2ZVRleHR1cmUgPSBsb2FkVGV4dHVyZShcbiAgICAgIGxvYWRlcixcbiAgICAgIGdsdGYsXG4gICAgICBnbHRmTWF0ZXJpYWwuZW1pc3NpdmVUZXh0dXJlLFxuICAgICAgc3VwcG9ydGVkSW1hZ2VGb3JtYXRzXG4gICAgKTtcbiAgfVxuICBpZiAoZGVmaW5lZChnbHRmTWF0ZXJpYWwubm9ybWFsVGV4dHVyZSkpIHtcbiAgICBtYXRlcmlhbC5ub3JtYWxUZXh0dXJlID0gbG9hZFRleHR1cmUoXG4gICAgICBsb2FkZXIsXG4gICAgICBnbHRmLFxuICAgICAgZ2x0Zk1hdGVyaWFsLm5vcm1hbFRleHR1cmUsXG4gICAgICBzdXBwb3J0ZWRJbWFnZUZvcm1hdHNcbiAgICApO1xuICB9XG4gIGlmIChkZWZpbmVkKGdsdGZNYXRlcmlhbC5vY2NsdXNpb25UZXh0dXJlKSkge1xuICAgIG1hdGVyaWFsLm9jY2x1c2lvblRleHR1cmUgPSBsb2FkVGV4dHVyZShcbiAgICAgIGxvYWRlcixcbiAgICAgIGdsdGYsXG4gICAgICBnbHRmTWF0ZXJpYWwub2NjbHVzaW9uVGV4dHVyZSxcbiAgICAgIHN1cHBvcnRlZEltYWdlRm9ybWF0c1xuICAgICk7XG4gIH1cbiAgbWF0ZXJpYWwuZW1pc3NpdmVGYWN0b3IgPSBmcm9tQXJyYXkoQ2FydGVzaWFuMywgZ2x0Zk1hdGVyaWFsLmVtaXNzaXZlRmFjdG9yKTtcbiAgbWF0ZXJpYWwuYWxwaGFNb2RlID0gZ2x0Zk1hdGVyaWFsLmFscGhhTW9kZTtcbiAgbWF0ZXJpYWwuYWxwaGFDdXRvZmYgPSBnbHRmTWF0ZXJpYWwuYWxwaGFDdXRvZmY7XG4gIG1hdGVyaWFsLmRvdWJsZVNpZGVkID0gZ2x0Zk1hdGVyaWFsLmRvdWJsZVNpZGVkO1xuXG4gIHJldHVybiBtYXRlcmlhbDtcbn1cblxuZnVuY3Rpb24gbG9hZEZlYXR1cmVJZEF0dHJpYnV0ZShnbHRmRmVhdHVyZUlkQXR0cmlidXRlKSB7XG4gIHZhciBmZWF0dXJlSWRBdHRyaWJ1dGUgPSBuZXcgRmVhdHVyZUlkQXR0cmlidXRlKCk7XG4gIHZhciBmZWF0dXJlSWRzID0gZ2x0ZkZlYXR1cmVJZEF0dHJpYnV0ZS5mZWF0dXJlSWRzO1xuICBmZWF0dXJlSWRBdHRyaWJ1dGUuZmVhdHVyZVRhYmxlSWQgPSBnbHRmRmVhdHVyZUlkQXR0cmlidXRlLmZlYXR1cmVUYWJsZTtcbiAgZmVhdHVyZUlkQXR0cmlidXRlLnNldEluZGV4ID0gZ2V0U2V0SW5kZXgoZmVhdHVyZUlkcy5hdHRyaWJ1dGUpO1xuICBmZWF0dXJlSWRBdHRyaWJ1dGUuY29uc3RhbnQgPSBkZWZhdWx0VmFsdWUoZmVhdHVyZUlkcy5jb25zdGFudCwgMCk7XG4gIGZlYXR1cmVJZEF0dHJpYnV0ZS5kaXZpc29yID0gZGVmYXVsdFZhbHVlKGZlYXR1cmVJZHMuZGl2aXNvciwgMCk7XG4gIHJldHVybiBmZWF0dXJlSWRBdHRyaWJ1dGU7XG59XG5cbmZ1bmN0aW9uIGxvYWRGZWF0dXJlSWRUZXh0dXJlKFxuICBsb2FkZXIsXG4gIGdsdGYsXG4gIGdsdGZGZWF0dXJlSWRUZXh0dXJlLFxuICBzdXBwb3J0ZWRJbWFnZUZvcm1hdHNcbikge1xuICB2YXIgZmVhdHVyZUlkVGV4dHVyZSA9IG5ldyBGZWF0dXJlSWRUZXh0dXJlKCk7XG4gIHZhciBmZWF0dXJlSWRzID0gZ2x0ZkZlYXR1cmVJZFRleHR1cmUuZmVhdHVyZUlkcztcbiAgdmFyIHRleHR1cmVJbmZvID0gZmVhdHVyZUlkcy50ZXh0dXJlO1xuXG4gIGZlYXR1cmVJZFRleHR1cmUuZmVhdHVyZVRhYmxlSWQgPSBnbHRmRmVhdHVyZUlkVGV4dHVyZS5mZWF0dXJlVGFibGU7XG4gIGZlYXR1cmVJZFRleHR1cmUudGV4dHVyZVJlYWRlciA9IGxvYWRUZXh0dXJlKFxuICAgIGxvYWRlcixcbiAgICBnbHRmLFxuICAgIHRleHR1cmVJbmZvLFxuICAgIHN1cHBvcnRlZEltYWdlRm9ybWF0cyxcbiAgICBTYW1wbGVyLk5FQVJFU1QgLy8gRmVhdHVyZSBJRCB0ZXh0dXJlcyByZXF1aXJlIG5lYXJlc3Qgc2FtcGxpbmdcbiAgKTtcblxuICBmZWF0dXJlSWRUZXh0dXJlLnRleHR1cmVSZWFkZXIuY2hhbm5lbHMgPSBmZWF0dXJlSWRzLmNoYW5uZWxzO1xuXG4gIHJldHVybiBmZWF0dXJlSWRUZXh0dXJlO1xufVxuXG5mdW5jdGlvbiBsb2FkTW9ycGhUYXJnZXQobG9hZGVyLCBnbHRmLCB0YXJnZXQpIHtcbiAgdmFyIG1vcnBoVGFyZ2V0ID0gbmV3IE1vcnBoVGFyZ2V0KCk7XG5cbiAgZm9yICh2YXIgc2VtYW50aWMgaW4gdGFyZ2V0KSB7XG4gICAgaWYgKHRhcmdldC5oYXNPd25Qcm9wZXJ0eShzZW1hbnRpYykpIHtcbiAgICAgIHZhciBhY2Nlc3NvcklkID0gdGFyZ2V0W3NlbWFudGljXTtcbiAgICAgIG1vcnBoVGFyZ2V0LmF0dHJpYnV0ZXMucHVzaChcbiAgICAgICAgLy8gRG9uJ3QgcGFzcyBpbiBkcmFjbyBvYmplY3Qgc2luY2UgbW9ycGggdGFyZ2V0cyBjYW4ndCBiZSBkcmFjbyBjb21wcmVzc2VkXG4gICAgICAgIGxvYWRWZXJ0ZXhBdHRyaWJ1dGUobG9hZGVyLCBnbHRmLCBhY2Nlc3NvcklkLCBzZW1hbnRpYywgdW5kZWZpbmVkKVxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbW9ycGhUYXJnZXQ7XG59XG5cbmZ1bmN0aW9uIGxvYWRQcmltaXRpdmUoXG4gIGxvYWRlcixcbiAgZ2x0ZixcbiAgZ2x0ZlByaW1pdGl2ZSxcbiAgbW9ycGhXZWlnaHRzLFxuICBzdXBwb3J0ZWRJbWFnZUZvcm1hdHNcbikge1xuICB2YXIgaTtcblxuICB2YXIgcHJpbWl0aXZlID0gbmV3IFByaW1pdGl2ZSgpO1xuXG4gIHZhciBtYXRlcmlhbElkID0gZ2x0ZlByaW1pdGl2ZS5tYXRlcmlhbDtcbiAgaWYgKGRlZmluZWQobWF0ZXJpYWxJZCkpIHtcbiAgICBwcmltaXRpdmUubWF0ZXJpYWwgPSBsb2FkTWF0ZXJpYWwoXG4gICAgICBsb2FkZXIsXG4gICAgICBnbHRmLFxuICAgICAgZ2x0Zi5tYXRlcmlhbHNbbWF0ZXJpYWxJZF0sXG4gICAgICBzdXBwb3J0ZWRJbWFnZUZvcm1hdHNcbiAgICApO1xuICB9XG5cbiAgdmFyIGV4dGVuc2lvbnMgPSBkZWZhdWx0VmFsdWUoXG4gICAgZ2x0ZlByaW1pdGl2ZS5leHRlbnNpb25zLFxuICAgIGRlZmF1bHRWYWx1ZS5FTVBUWV9PQkpFQ1RcbiAgKTtcbiAgdmFyIGRyYWNvID0gZXh0ZW5zaW9ucy5LSFJfZHJhY29fbWVzaF9jb21wcmVzc2lvbjtcbiAgdmFyIGZlYXR1cmVNZXRhZGF0YSA9IGV4dGVuc2lvbnMuRVhUX2ZlYXR1cmVfbWV0YWRhdGE7XG5cbiAgdmFyIGF0dHJpYnV0ZXMgPSBnbHRmUHJpbWl0aXZlLmF0dHJpYnV0ZXM7XG4gIGlmIChkZWZpbmVkKGF0dHJpYnV0ZXMpKSB7XG4gICAgZm9yICh2YXIgc2VtYW50aWMgaW4gYXR0cmlidXRlcykge1xuICAgICAgaWYgKGF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkoc2VtYW50aWMpKSB7XG4gICAgICAgIHZhciBhY2Nlc3NvcklkID0gYXR0cmlidXRlc1tzZW1hbnRpY107XG4gICAgICAgIHByaW1pdGl2ZS5hdHRyaWJ1dGVzLnB1c2goXG4gICAgICAgICAgbG9hZFZlcnRleEF0dHJpYnV0ZShsb2FkZXIsIGdsdGYsIGFjY2Vzc29ySWQsIHNlbWFudGljLCBkcmFjbylcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2YXIgdGFyZ2V0cyA9IGdsdGZQcmltaXRpdmUudGFyZ2V0cztcbiAgaWYgKGRlZmluZWQodGFyZ2V0cykpIHtcbiAgICB2YXIgdGFyZ2V0c0xlbmd0aCA9IHRhcmdldHMubGVuZ3RoO1xuICAgIGZvciAoaSA9IDA7IGkgPCB0YXJnZXRzTGVuZ3RoOyArK2kpIHtcbiAgICAgIHByaW1pdGl2ZS5tb3JwaFRhcmdldHMucHVzaChsb2FkTW9ycGhUYXJnZXQobG9hZGVyLCBnbHRmLCB0YXJnZXRzW2ldKSk7XG4gICAgfVxuICAgIHByaW1pdGl2ZS5tb3JwaFdlaWdodHMgPSBkZWZpbmVkKG1vcnBoV2VpZ2h0cylcbiAgICAgID8gbW9ycGhXZWlnaHRzLnNsaWNlKClcbiAgICAgIDogYXJyYXlGaWxsKG5ldyBBcnJheSh0YXJnZXRzTGVuZ3RoKSwgMC4wKTtcbiAgfVxuXG4gIHZhciBpbmRpY2VzID0gZ2x0ZlByaW1pdGl2ZS5pbmRpY2VzO1xuICBpZiAoZGVmaW5lZChpbmRpY2VzKSkge1xuICAgIHByaW1pdGl2ZS5pbmRpY2VzID0gbG9hZEluZGljZXMobG9hZGVyLCBnbHRmLCBpbmRpY2VzLCBkcmFjbyk7XG4gIH1cblxuICBpZiAoZGVmaW5lZChmZWF0dXJlTWV0YWRhdGEpKSB7XG4gICAgLy8gRmVhdHVyZSBJRCBBdHRyaWJ1dGVzXG4gICAgdmFyIGZlYXR1cmVJZEF0dHJpYnV0ZXMgPSBmZWF0dXJlTWV0YWRhdGEuZmVhdHVyZUlkQXR0cmlidXRlcztcbiAgICBpZiAoZGVmaW5lZChmZWF0dXJlSWRBdHRyaWJ1dGVzKSkge1xuICAgICAgdmFyIGZlYXR1cmVJZEF0dHJpYnV0ZXNMZW5ndGggPSBmZWF0dXJlSWRBdHRyaWJ1dGVzLmxlbmd0aDtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBmZWF0dXJlSWRBdHRyaWJ1dGVzTGVuZ3RoOyArK2kpIHtcbiAgICAgICAgcHJpbWl0aXZlLmZlYXR1cmVJZEF0dHJpYnV0ZXMucHVzaChcbiAgICAgICAgICBsb2FkRmVhdHVyZUlkQXR0cmlidXRlKGZlYXR1cmVJZEF0dHJpYnV0ZXNbaV0pXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRmVhdHVyZSBJRCBUZXh0dXJlc1xuICAgIHZhciBmZWF0dXJlSWRUZXh0dXJlcyA9IGZlYXR1cmVNZXRhZGF0YS5mZWF0dXJlSWRUZXh0dXJlcztcbiAgICBpZiAoZGVmaW5lZChmZWF0dXJlSWRUZXh0dXJlcykpIHtcbiAgICAgIHZhciBmZWF0dXJlSWRUZXh0dXJlc0xlbmd0aCA9IGZlYXR1cmVJZFRleHR1cmVzLmxlbmd0aDtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBmZWF0dXJlSWRUZXh0dXJlc0xlbmd0aDsgKytpKSB7XG4gICAgICAgIHByaW1pdGl2ZS5mZWF0dXJlSWRUZXh0dXJlcy5wdXNoKFxuICAgICAgICAgIGxvYWRGZWF0dXJlSWRUZXh0dXJlKFxuICAgICAgICAgICAgbG9hZGVyLFxuICAgICAgICAgICAgZ2x0ZixcbiAgICAgICAgICAgIGZlYXR1cmVJZFRleHR1cmVzW2ldLFxuICAgICAgICAgICAgc3VwcG9ydGVkSW1hZ2VGb3JtYXRzXG4gICAgICAgICAgKVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEZlYXR1cmUgVGV4dHVyZXNcbiAgICBpZiAoZGVmaW5lZChmZWF0dXJlTWV0YWRhdGEuZmVhdHVyZVRleHR1cmVzKSkge1xuICAgICAgcHJpbWl0aXZlLmZlYXR1cmVUZXh0dXJlSWRzID0gZmVhdHVyZU1ldGFkYXRhLmZlYXR1cmVUZXh0dXJlcztcbiAgICB9XG4gIH1cblxuICBwcmltaXRpdmUucHJpbWl0aXZlVHlwZSA9IGdsdGZQcmltaXRpdmUubW9kZTtcblxuICByZXR1cm4gcHJpbWl0aXZlO1xufVxuXG5mdW5jdGlvbiBsb2FkSW5zdGFuY2VzKGxvYWRlciwgZ2x0ZiwgaW5zdGFuY2luZ0V4dGVuc2lvbiwgZnJhbWVTdGF0ZSkge1xuICB2YXIgaW5zdGFuY2VzID0gbmV3IEluc3RhbmNlcygpO1xuICB2YXIgYXR0cmlidXRlcyA9IGluc3RhbmNpbmdFeHRlbnNpb24uYXR0cmlidXRlcztcbiAgaWYgKGRlZmluZWQoYXR0cmlidXRlcykpIHtcbiAgICB2YXIgaGFzUm90YXRpb24gPSBkZWZpbmVkKGF0dHJpYnV0ZXMuUk9UQVRJT04pO1xuICAgIHZhciBoYXNUcmFuc2xhdGlvbk1pbk1heCA9XG4gICAgICBkZWZpbmVkKGF0dHJpYnV0ZXMuVFJBTlNMQVRJT04pICYmXG4gICAgICBkZWZpbmVkKGdsdGYuYWNjZXNzb3JzW2F0dHJpYnV0ZXMuVFJBTlNMQVRJT05dLm1pbikgJiZcbiAgICAgIGRlZmluZWQoZ2x0Zi5hY2Nlc3NvcnNbYXR0cmlidXRlcy5UUkFOU0xBVElPTl0ubWF4KTtcbiAgICBmb3IgKHZhciBzZW1hbnRpYyBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICBpZiAoYXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eShzZW1hbnRpYykpIHtcbiAgICAgICAgLy8gSWYgdGhlIGluc3RhbmNlcyBoYXZlIHJvdGF0aW9ucyBsb2FkIHRoZSBhdHRyaWJ1dGVzIGFzIHR5cGVkIGFycmF5c1xuICAgICAgICAvLyBzbyB0aGF0IGluc3RhbmNlIG1hdHJpY2VzIGFyZSBjb21wdXRlZCBvbiB0aGUgQ1BVLiBUaGlzIGF2b2lkcyB0aGVcbiAgICAgICAgLy8gZXhwZW5zaXZlIHF1YXRlcm5pb24gLT4gcm90YXRpb24gbWF0cml4IGNvbnZlcnNpb24gaW4gdGhlIHNoYWRlci5cbiAgICAgICAgLy8gSWYgdGhlIHRyYW5zbGF0aW9uIGFjY2Vzc29yIGRvZXMgbm90IGhhdmUgYSBtaW4gYW5kIG1heCwgbG9hZCB0aGVcbiAgICAgICAgLy8gYXR0cmlidXRlcyBhcyB0eXBlZCBhcnJheXMsIHNvIHRoZSB2YWx1ZXMgY2FuIGJlIHVzZWQgZm9yIGNvbXB1dGluZ1xuICAgICAgICAvLyBhbiBhY2N1cmF0ZSBib3VuZGluZyB2b2x1bWUuXG4gICAgICAgIHZhciBsb2FkQXNUeXBlZEFycmF5ID1cbiAgICAgICAgICAoaGFzUm90YXRpb24gfHwgIWhhc1RyYW5zbGF0aW9uTWluTWF4KSAmJlxuICAgICAgICAgIChzZW1hbnRpYyA9PT0gSW5zdGFuY2VBdHRyaWJ1dGVTZW1hbnRpYy5UUkFOU0xBVElPTiB8fFxuICAgICAgICAgICAgc2VtYW50aWMgPT09IEluc3RhbmNlQXR0cmlidXRlU2VtYW50aWMuUk9UQVRJT04gfHxcbiAgICAgICAgICAgIHNlbWFudGljID09PSBJbnN0YW5jZUF0dHJpYnV0ZVNlbWFudGljLlNDQUxFKTtcblxuICAgICAgICB2YXIgYWNjZXNzb3JJZCA9IGF0dHJpYnV0ZXNbc2VtYW50aWNdO1xuICAgICAgICBpbnN0YW5jZXMuYXR0cmlidXRlcy5wdXNoKFxuICAgICAgICAgIGxvYWRJbnN0YW5jZWRBdHRyaWJ1dGUoXG4gICAgICAgICAgICBsb2FkZXIsXG4gICAgICAgICAgICBnbHRmLFxuICAgICAgICAgICAgYWNjZXNzb3JJZCxcbiAgICAgICAgICAgIHNlbWFudGljLFxuICAgICAgICAgICAgbG9hZEFzVHlwZWRBcnJheSxcbiAgICAgICAgICAgIGZyYW1lU3RhdGVcbiAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdmFyIGV4dGVuc2lvbnMgPSBkZWZhdWx0VmFsdWUoXG4gICAgaW5zdGFuY2luZ0V4dGVuc2lvbi5leHRlbnNpb25zLFxuICAgIGRlZmF1bHRWYWx1ZS5FTVBUWV9PQkpFQ1RcbiAgKTtcbiAgdmFyIGZlYXR1cmVNZXRhZGF0YSA9IGV4dGVuc2lvbnMuRVhUX2ZlYXR1cmVfbWV0YWRhdGE7XG4gIGlmIChkZWZpbmVkKGZlYXR1cmVNZXRhZGF0YSkpIHtcbiAgICB2YXIgZmVhdHVyZUlkQXR0cmlidXRlcyA9IGZlYXR1cmVNZXRhZGF0YS5mZWF0dXJlSWRBdHRyaWJ1dGVzO1xuICAgIGlmIChkZWZpbmVkKGZlYXR1cmVJZEF0dHJpYnV0ZXMpKSB7XG4gICAgICB2YXIgZmVhdHVyZUlkQXR0cmlidXRlc0xlbmd0aCA9IGZlYXR1cmVJZEF0dHJpYnV0ZXMubGVuZ3RoO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmZWF0dXJlSWRBdHRyaWJ1dGVzTGVuZ3RoOyArK2kpIHtcbiAgICAgICAgaW5zdGFuY2VzLmZlYXR1cmVJZEF0dHJpYnV0ZXMucHVzaChcbiAgICAgICAgICBsb2FkRmVhdHVyZUlkQXR0cmlidXRlKGZlYXR1cmVJZEF0dHJpYnV0ZXNbaV0pXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBpbnN0YW5jZXM7XG59XG5cbmZ1bmN0aW9uIGxvYWRTa2luKGxvYWRlciwgZ2x0ZiwgZ2x0ZlNraW4sIG5vZGVzKSB7XG4gIHZhciBza2luID0gbmV3IFNraW4oKTtcblxuICB2YXIgam9pbnRJZHMgPSBnbHRmU2tpbi5qb2ludHM7XG4gIHZhciBqb2ludHNMZW5ndGggPSBqb2ludElkcy5sZW5ndGg7XG4gIHZhciBqb2ludHMgPSBuZXcgQXJyYXkoam9pbnRzTGVuZ3RoKTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBqb2ludHNMZW5ndGg7ICsraSkge1xuICAgIGpvaW50c1tpXSA9IG5vZGVzW2pvaW50SWRzW2ldXTtcbiAgfVxuICBza2luLmpvaW50cyA9IGpvaW50cztcblxuICB2YXIgaW52ZXJzZUJpbmRNYXRyaWNlc0FjY2Vzc29ySWQgPSBnbHRmU2tpbi5pbnZlcnNlQmluZE1hdHJpY2VzO1xuICBpZiAoZGVmaW5lZChpbnZlcnNlQmluZE1hdHJpY2VzQWNjZXNzb3JJZCkpIHtcbiAgICB2YXIgYWNjZXNzb3IgPSBnbHRmLmFjY2Vzc29yc1tpbnZlcnNlQmluZE1hdHJpY2VzQWNjZXNzb3JJZF07XG4gICAgdmFyIGJ1ZmZlclZpZXdJZCA9IGFjY2Vzc29yLmJ1ZmZlclZpZXc7XG4gICAgaWYgKGRlZmluZWQoYnVmZmVyVmlld0lkKSkge1xuICAgICAgdmFyIGJ1ZmZlclZpZXdMb2FkZXIgPSBsb2FkQnVmZmVyVmlldyhsb2FkZXIsIGdsdGYsIGJ1ZmZlclZpZXdJZCk7XG4gICAgICBidWZmZXJWaWV3TG9hZGVyLnByb21pc2UudGhlbihmdW5jdGlvbiAoYnVmZmVyVmlld0xvYWRlcikge1xuICAgICAgICBpZiAobG9hZGVyLmlzRGVzdHJveWVkKCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJ1ZmZlclZpZXdUeXBlZEFycmF5ID0gYnVmZmVyVmlld0xvYWRlci50eXBlZEFycmF5O1xuICAgICAgICB2YXIgYWNjZXNzb3JUeXBlZEFycmF5ID0gZ2V0QWNjZXNzb3JUeXBlZEFycmF5KFxuICAgICAgICAgIGdsdGYsXG4gICAgICAgICAgYWNjZXNzb3IsXG4gICAgICAgICAgYnVmZmVyVmlld1R5cGVkQXJyYXlcbiAgICAgICAgKTtcbiAgICAgICAgdmFyIGludmVyc2VCaW5kTWF0cmljZXMgPSBuZXcgQXJyYXkoam9pbnRzTGVuZ3RoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBqb2ludHNMZW5ndGg7ICsraSkge1xuICAgICAgICAgIGludmVyc2VCaW5kTWF0cmljZXNbaV0gPSBNYXRyaXg0LnVucGFjayhhY2Nlc3NvclR5cGVkQXJyYXksIGkgKiAxNik7XG4gICAgICAgIH1cbiAgICAgICAgc2tpbi5pbnZlcnNlQmluZE1hdHJpY2VzID0gaW52ZXJzZUJpbmRNYXRyaWNlcztcbiAgICAgIH0pO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBza2luLmludmVyc2VCaW5kTWF0cmljZXMgPSBhcnJheUZpbGwoXG4gICAgICBuZXcgQXJyYXkoam9pbnRzTGVuZ3RoKSxcbiAgICAgIE1hdHJpeDQuSURFTlRJVFlcbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIHNraW47XG59XG5cbmZ1bmN0aW9uIGxvYWROb2RlKGxvYWRlciwgZ2x0ZiwgZ2x0Zk5vZGUsIHN1cHBvcnRlZEltYWdlRm9ybWF0cywgZnJhbWVTdGF0ZSkge1xuICB2YXIgbm9kZSA9IG5ldyBOb2RlKCk7XG5cbiAgbm9kZS5tYXRyaXggPSBmcm9tQXJyYXkoTWF0cml4NCwgZ2x0Zk5vZGUubWF0cml4KTtcbiAgbm9kZS50cmFuc2xhdGlvbiA9IGZyb21BcnJheShDYXJ0ZXNpYW4zLCBnbHRmTm9kZS50cmFuc2xhdGlvbik7XG4gIG5vZGUucm90YXRpb24gPSBmcm9tQXJyYXkoUXVhdGVybmlvbiwgZ2x0Zk5vZGUucm90YXRpb24pO1xuICBub2RlLnNjYWxlID0gZnJvbUFycmF5KENhcnRlc2lhbjMsIGdsdGZOb2RlLnNjYWxlKTtcblxuICB2YXIgbWVzaElkID0gZ2x0Zk5vZGUubWVzaDtcbiAgaWYgKGRlZmluZWQobWVzaElkKSkge1xuICAgIHZhciBtZXNoID0gZ2x0Zi5tZXNoZXNbbWVzaElkXTtcbiAgICB2YXIgbW9ycGhXZWlnaHRzID0gZGVmYXVsdFZhbHVlKGdsdGZOb2RlLndlaWdodHMsIG1lc2gud2VpZ2h0cyk7XG4gICAgdmFyIHByaW1pdGl2ZXMgPSBtZXNoLnByaW1pdGl2ZXM7XG4gICAgdmFyIHByaW1pdGl2ZXNMZW5ndGggPSBwcmltaXRpdmVzLmxlbmd0aDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByaW1pdGl2ZXNMZW5ndGg7ICsraSkge1xuICAgICAgbm9kZS5wcmltaXRpdmVzLnB1c2goXG4gICAgICAgIGxvYWRQcmltaXRpdmUoXG4gICAgICAgICAgbG9hZGVyLFxuICAgICAgICAgIGdsdGYsXG4gICAgICAgICAgcHJpbWl0aXZlc1tpXSxcbiAgICAgICAgICBtb3JwaFdlaWdodHMsXG4gICAgICAgICAgc3VwcG9ydGVkSW1hZ2VGb3JtYXRzXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgdmFyIGV4dGVuc2lvbnMgPSBkZWZhdWx0VmFsdWUoZ2x0Zk5vZGUuZXh0ZW5zaW9ucywgZGVmYXVsdFZhbHVlLkVNUFRZX09CSkVDVCk7XG4gIHZhciBpbnN0YW5jaW5nRXh0ZW5zaW9uID0gZXh0ZW5zaW9ucy5FWFRfbWVzaF9ncHVfaW5zdGFuY2luZztcbiAgaWYgKGRlZmluZWQoaW5zdGFuY2luZ0V4dGVuc2lvbikpIHtcbiAgICBub2RlLmluc3RhbmNlcyA9IGxvYWRJbnN0YW5jZXMoXG4gICAgICBsb2FkZXIsXG4gICAgICBnbHRmLFxuICAgICAgaW5zdGFuY2luZ0V4dGVuc2lvbixcbiAgICAgIGZyYW1lU3RhdGVcbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIG5vZGU7XG59XG5cbmZ1bmN0aW9uIGxvYWROb2Rlcyhsb2FkZXIsIGdsdGYsIHN1cHBvcnRlZEltYWdlRm9ybWF0cywgZnJhbWVTdGF0ZSkge1xuICB2YXIgaTtcbiAgdmFyIGo7XG5cbiAgdmFyIG5vZGVzTGVuZ3RoID0gZ2x0Zi5ub2Rlcy5sZW5ndGg7XG4gIHZhciBub2RlcyA9IG5ldyBBcnJheShub2Rlc0xlbmd0aCk7XG4gIGZvciAoaSA9IDA7IGkgPCBub2Rlc0xlbmd0aDsgKytpKSB7XG4gICAgbm9kZXNbaV0gPSBsb2FkTm9kZShcbiAgICAgIGxvYWRlcixcbiAgICAgIGdsdGYsXG4gICAgICBnbHRmLm5vZGVzW2ldLFxuICAgICAgc3VwcG9ydGVkSW1hZ2VGb3JtYXRzLFxuICAgICAgZnJhbWVTdGF0ZVxuICAgICk7XG4gIH1cblxuICBmb3IgKGkgPSAwOyBpIDwgbm9kZXNMZW5ndGg7ICsraSkge1xuICAgIHZhciBjaGlsZHJlbk5vZGVJZHMgPSBnbHRmLm5vZGVzW2ldLmNoaWxkcmVuO1xuICAgIGlmIChkZWZpbmVkKGNoaWxkcmVuTm9kZUlkcykpIHtcbiAgICAgIHZhciBjaGlsZHJlbkxlbmd0aCA9IGNoaWxkcmVuTm9kZUlkcy5sZW5ndGg7XG4gICAgICBmb3IgKGogPSAwOyBqIDwgY2hpbGRyZW5MZW5ndGg7ICsraikge1xuICAgICAgICBub2Rlc1tpXS5jaGlsZHJlbi5wdXNoKG5vZGVzW2NoaWxkcmVuTm9kZUlkc1tqXV0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZvciAoaSA9IDA7IGkgPCBub2Rlc0xlbmd0aDsgKytpKSB7XG4gICAgdmFyIHNraW5JZCA9IGdsdGYubm9kZXNbaV0uc2tpbjtcbiAgICBpZiAoZGVmaW5lZChza2luSWQpKSB7XG4gICAgICBub2Rlc1tpXS5za2luID0gbG9hZFNraW4obG9hZGVyLCBnbHRmLCBnbHRmLnNraW5zW3NraW5JZF0sIG5vZGVzKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbm9kZXM7XG59XG5cbmZ1bmN0aW9uIGxvYWRGZWF0dXJlTWV0YWRhdGEobG9hZGVyLCBnbHRmLCBleHRlbnNpb24sIHN1cHBvcnRlZEltYWdlRm9ybWF0cykge1xuICB2YXIgZmVhdHVyZU1ldGFkYXRhTG9hZGVyID0gbmV3IEdsdGZGZWF0dXJlTWV0YWRhdGFMb2FkZXIoe1xuICAgIGdsdGY6IGdsdGYsXG4gICAgZXh0ZW5zaW9uOiBleHRlbnNpb24sXG4gICAgZ2x0ZlJlc291cmNlOiBsb2FkZXIuX2dsdGZSZXNvdXJjZSxcbiAgICBiYXNlUmVzb3VyY2U6IGxvYWRlci5fYmFzZVJlc291cmNlLFxuICAgIHN1cHBvcnRlZEltYWdlRm9ybWF0czogc3VwcG9ydGVkSW1hZ2VGb3JtYXRzLFxuICAgIGFzeW5jaHJvbm91czogbG9hZGVyLl9hc3luY2hyb25vdXMsXG4gIH0pO1xuICBmZWF0dXJlTWV0YWRhdGFMb2FkZXIubG9hZCgpO1xuXG4gIGxvYWRlci5fZmVhdHVyZU1ldGFkYXRhTG9hZGVyID0gZmVhdHVyZU1ldGFkYXRhTG9hZGVyO1xuXG4gIHJldHVybiBmZWF0dXJlTWV0YWRhdGFMb2FkZXI7XG59XG5cbmZ1bmN0aW9uIGdldFNjZW5lTm9kZUlkcyhnbHRmKSB7XG4gIHZhciBub2Rlc0lkcztcbiAgaWYgKGRlZmluZWQoZ2x0Zi5zY2VuZXMpICYmIGRlZmluZWQoZ2x0Zi5zY2VuZSkpIHtcbiAgICBub2Rlc0lkcyA9IGdsdGYuc2NlbmVzW2dsdGYuc2NlbmVdLm5vZGVzO1xuICB9XG4gIG5vZGVzSWRzID0gZGVmYXVsdFZhbHVlKG5vZGVzSWRzLCBnbHRmLm5vZGVzKTtcbiAgbm9kZXNJZHMgPSBkZWZpbmVkKG5vZGVzSWRzKSA/IG5vZGVzSWRzIDogW107XG4gIHJldHVybiBub2Rlc0lkcztcbn1cblxuZnVuY3Rpb24gbG9hZFNjZW5lKGdsdGYsIG5vZGVzLCB1cEF4aXMsIGZvcndhcmRBeGlzKSB7XG4gIHZhciBzY2VuZSA9IG5ldyBTY2VuZSgpO1xuICBzY2VuZS51cEF4aXMgPSB1cEF4aXM7XG4gIHNjZW5lLmZvcndhcmRBeGlzID0gZm9yd2FyZEF4aXM7XG4gIHZhciBzY2VuZU5vZGVJZHMgPSBnZXRTY2VuZU5vZGVJZHMoZ2x0Zik7XG4gIHNjZW5lLm5vZGVzID0gc2NlbmVOb2RlSWRzLm1hcChmdW5jdGlvbiAoc2NlbmVOb2RlSWQpIHtcbiAgICByZXR1cm4gbm9kZXNbc2NlbmVOb2RlSWRdO1xuICB9KTtcbiAgcmV0dXJuIHNjZW5lO1xufVxuXG5mdW5jdGlvbiBwYXJzZShsb2FkZXIsIGdsdGYsIHN1cHBvcnRlZEltYWdlRm9ybWF0cywgZnJhbWVTdGF0ZSkge1xuICB2YXIgbm9kZXMgPSBsb2FkTm9kZXMobG9hZGVyLCBnbHRmLCBzdXBwb3J0ZWRJbWFnZUZvcm1hdHMsIGZyYW1lU3RhdGUpO1xuICB2YXIgdXBBeGlzID0gbG9hZGVyLl91cEF4aXM7XG4gIHZhciBmb3J3YXJkQXhpcyA9IGxvYWRlci5fZm9yd2FyZEF4aXM7XG4gIHZhciBzY2VuZSA9IGxvYWRTY2VuZShnbHRmLCBub2RlcywgdXBBeGlzLCBmb3J3YXJkQXhpcyk7XG5cbiAgdmFyIGNvbXBvbmVudHMgPSBuZXcgQ29tcG9uZW50cygpO1xuICBjb21wb25lbnRzLnNjZW5lID0gc2NlbmU7XG4gIGNvbXBvbmVudHMubm9kZXMgPSBub2RlcztcblxuICBsb2FkZXIuX2NvbXBvbmVudHMgPSBjb21wb25lbnRzO1xuXG4gIC8vIExvYWQgZmVhdHVyZSBtZXRhZGF0YSAoZmVhdHVyZSB0YWJsZXMgYW5kIGZlYXR1cmUgdGV4dHVyZXMpXG4gIHZhciBleHRlbnNpb25zID0gZGVmYXVsdFZhbHVlKGdsdGYuZXh0ZW5zaW9ucywgZGVmYXVsdFZhbHVlLkVNUFRZX09CSkVDVCk7XG4gIHZhciBmZWF0dXJlTWV0YWRhdGFFeHRlbnNpb24gPSBleHRlbnNpb25zLkVYVF9mZWF0dXJlX21ldGFkYXRhO1xuICBpZiAoZGVmaW5lZChmZWF0dXJlTWV0YWRhdGFFeHRlbnNpb24pKSB7XG4gICAgdmFyIGZlYXR1cmVNZXRhZGF0YUxvYWRlciA9IGxvYWRGZWF0dXJlTWV0YWRhdGEoXG4gICAgICBsb2FkZXIsXG4gICAgICBnbHRmLFxuICAgICAgZmVhdHVyZU1ldGFkYXRhRXh0ZW5zaW9uLFxuICAgICAgc3VwcG9ydGVkSW1hZ2VGb3JtYXRzXG4gICAgKTtcbiAgICBmZWF0dXJlTWV0YWRhdGFMb2FkZXIucHJvbWlzZS50aGVuKGZ1bmN0aW9uIChmZWF0dXJlTWV0YWRhdGFMb2FkZXIpIHtcbiAgICAgIGlmIChsb2FkZXIuaXNEZXN0cm95ZWQoKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb21wb25lbnRzLmZlYXR1cmVNZXRhZGF0YSA9IGZlYXR1cmVNZXRhZGF0YUxvYWRlci5mZWF0dXJlTWV0YWRhdGE7XG4gICAgfSk7XG4gIH1cblxuICAvLyBHYXRoZXIgcHJvbWlzZXMgYW5kIHJlamVjdCBpZiBhbnkgcHJvbWlzZXMgZmFpbC5cbiAgdmFyIGxvYWRlcnMgPSBbXTtcbiAgbG9hZGVycy5wdXNoLmFwcGx5KGxvYWRlcnMsIGxvYWRlci5fYnVmZmVyVmlld0xvYWRlcnMpO1xuICBsb2FkZXJzLnB1c2guYXBwbHkobG9hZGVycywgbG9hZGVyLl9nZW9tZXRyeUxvYWRlcnMpO1xuXG4gIGlmIChkZWZpbmVkKGxvYWRlci5fZmVhdHVyZU1ldGFkYXRhTG9hZGVyKSkge1xuICAgIGxvYWRlcnMucHVzaChsb2FkZXIuX2ZlYXR1cmVNZXRhZGF0YUxvYWRlcik7XG4gIH1cblxuICBpZiAoIWxvYWRlci5faW5jcmVtZW50YWxseUxvYWRUZXh0dXJlcykge1xuICAgIGxvYWRlcnMucHVzaC5hcHBseShsb2FkZXJzLCBsb2FkZXIuX3RleHR1cmVMb2FkZXJzKTtcbiAgfVxuXG4gIHZhciByZWFkeVByb21pc2VzID0gbG9hZGVycy5tYXAoZnVuY3Rpb24gKGxvYWRlcikge1xuICAgIHJldHVybiBsb2FkZXIucHJvbWlzZTtcbiAgfSk7XG5cbiAgLy8gU2VwYXJhdGUgcHJvbWlzZSB3aWxsIHJlc29sdmUgb25jZSB0ZXh0dXJlcyBhcmUgbG9hZGVkLlxuICB2YXIgdGV4dHVyZVByb21pc2VzID0gbG9hZGVyLl90ZXh0dXJlTG9hZGVycy5tYXAoZnVuY3Rpb24gKGxvYWRlcikge1xuICAgIHJldHVybiBsb2FkZXIucHJvbWlzZTtcbiAgfSk7XG5cbiAgd2hlblxuICAgIC5hbGwocmVhZHlQcm9taXNlcylcbiAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAobG9hZGVyLmlzRGVzdHJveWVkKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgbG9hZGVyLl9zdGF0ZSA9IEdsdGZMb2FkZXJTdGF0ZS5QUk9DRVNTRUQ7XG4gICAgfSlcbiAgICAub3RoZXJ3aXNlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgaWYgKGxvYWRlci5pc0Rlc3Ryb3llZCgpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGhhbmRsZUVycm9yKGxvYWRlciwgZXJyb3IpO1xuICAgIH0pO1xuXG4gIHdoZW4uYWxsKHRleHR1cmVQcm9taXNlcykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGxvYWRlci5pc0Rlc3Ryb3llZCgpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGxvYWRlci5fdGV4dHVyZVN0YXRlID0gR2x0ZkxvYWRlclN0YXRlLlBST0NFU1NFRDtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHVubG9hZFRleHR1cmVzKGxvYWRlcikge1xuICB2YXIgdGV4dHVyZUxvYWRlcnMgPSBsb2FkZXIuX3RleHR1cmVMb2FkZXJzO1xuICB2YXIgdGV4dHVyZUxvYWRlcnNMZW5ndGggPSB0ZXh0dXJlTG9hZGVycy5sZW5ndGg7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdGV4dHVyZUxvYWRlcnNMZW5ndGg7ICsraSkge1xuICAgIFJlc291cmNlQ2FjaGUudW5sb2FkKHRleHR1cmVMb2FkZXJzW2ldKTtcbiAgfVxuICBsb2FkZXIuX3RleHR1cmVMb2FkZXJzLmxlbmd0aCA9IDA7XG59XG5cbmZ1bmN0aW9uIHVubG9hZEJ1ZmZlclZpZXdzKGxvYWRlcikge1xuICB2YXIgYnVmZmVyVmlld0xvYWRlcnMgPSBsb2FkZXIuX2J1ZmZlclZpZXdMb2FkZXJzO1xuICB2YXIgYnVmZmVyVmlld0xvYWRlcnNMZW5ndGggPSBidWZmZXJWaWV3TG9hZGVycy5sZW5ndGg7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYnVmZmVyVmlld0xvYWRlcnNMZW5ndGg7ICsraSkge1xuICAgIFJlc291cmNlQ2FjaGUudW5sb2FkKGJ1ZmZlclZpZXdMb2FkZXJzW2ldKTtcbiAgfVxuICBsb2FkZXIuX2J1ZmZlclZpZXdMb2FkZXJzLmxlbmd0aCA9IDA7XG59XG5cbmZ1bmN0aW9uIHVubG9hZEdlb21ldHJ5KGxvYWRlcikge1xuICB2YXIgZ2VvbWV0cnlMb2FkZXJzID0gbG9hZGVyLl9nZW9tZXRyeUxvYWRlcnM7XG4gIHZhciBnZW9tZXRyeUxvYWRlcnNMZW5ndGggPSBnZW9tZXRyeUxvYWRlcnMubGVuZ3RoO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGdlb21ldHJ5TG9hZGVyc0xlbmd0aDsgKytpKSB7XG4gICAgUmVzb3VyY2VDYWNoZS51bmxvYWQoZ2VvbWV0cnlMb2FkZXJzW2ldKTtcbiAgfVxuICBsb2FkZXIuX2dlb21ldHJ5TG9hZGVycy5sZW5ndGggPSAwO1xufVxuXG5mdW5jdGlvbiB1bmxvYWRGZWF0dXJlTWV0YWRhdGEobG9hZGVyKSB7XG4gIGlmIChkZWZpbmVkKGxvYWRlci5fZmVhdHVyZU1ldGFkYXRhTG9hZGVyKSkge1xuICAgIGxvYWRlci5fZmVhdHVyZU1ldGFkYXRhTG9hZGVyLmRlc3Ryb3koKTtcbiAgICBsb2FkZXIuX2ZlYXR1cmVNZXRhZGF0YUxvYWRlciA9IHVuZGVmaW5lZDtcbiAgfVxufVxuXG4vKipcbiAqIFVubG9hZHMgdGhlIHJlc291cmNlLlxuICogQHByaXZhdGVcbiAqL1xuR2x0ZkxvYWRlci5wcm90b3R5cGUudW5sb2FkID0gZnVuY3Rpb24gKCkge1xuICBpZiAoZGVmaW5lZCh0aGlzLl9nbHRmSnNvbkxvYWRlcikpIHtcbiAgICBSZXNvdXJjZUNhY2hlLnVubG9hZCh0aGlzLl9nbHRmSnNvbkxvYWRlcik7XG4gIH1cbiAgdGhpcy5fZ2x0Zkpzb25Mb2FkZXIgPSB1bmRlZmluZWQ7XG5cbiAgdW5sb2FkVGV4dHVyZXModGhpcyk7XG4gIHVubG9hZEJ1ZmZlclZpZXdzKHRoaXMpO1xuICB1bmxvYWRHZW9tZXRyeSh0aGlzKTtcbiAgdW5sb2FkRmVhdHVyZU1ldGFkYXRhKHRoaXMpO1xuXG4gIHRoaXMuX2NvbXBvbmVudHMgPSB1bmRlZmluZWQ7XG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///6366\n')},61120:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('/* harmony import */ var _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(60838);\n/* harmony import */ var _Core_Check_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(66553);\n/* harmony import */ var _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(62200);\n/* harmony import */ var _Core_defined_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(82982);\n/* harmony import */ var _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(68201);\n/* harmony import */ var _Renderer_Sampler_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(87721);\n/* harmony import */ var _Renderer_TextureMagnificationFilter_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(42246);\n/* harmony import */ var _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(80188);\n/* harmony import */ var _Renderer_TextureWrap_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(88453);\n/* harmony import */ var _ModelComponents_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(7896);\n\n\n\n\n\n\n\n\n\n\n\n/**\n * glTF loading utilities.\n *\n * @namespace GltfLoaderUtil\n *\n * @private\n */\nvar GltfLoaderUtil = {};\n\n/**\n * Get the image ID referenced by a texture.\n * <p>\n * When the texture has the EXT_texture_webp extension and the browser supports\n * WebP images the WebP image ID is returned.\n * </p>\n *\n * @param {Object} options Object with the following properties:\n * @param {Object} options.gltf The glTF JSON.\n * @param {Number} options.textureId The texture ID.\n * @param {SupportedImageFormats} options.supportedImageFormats The supported image formats.\n *\n * @returns {Number} The image ID.\n * @private\n */\nGltfLoaderUtil.getImageIdFromTexture = function (options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n  var gltf = options.gltf;\n  var textureId = options.textureId;\n  var supportedImageFormats = options.supportedImageFormats;\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("options.gltf", gltf);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.number */ .Z.typeOf.number("options.textureId", textureId);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("options.supportedImageFormats", supportedImageFormats);\n  //>>includeEnd(\'debug\');\n\n  var texture = gltf.textures[textureId];\n  var extensions = texture.extensions;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(extensions)) {\n    if (supportedImageFormats.webp && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(extensions.EXT_texture_webp)) {\n      return extensions.EXT_texture_webp.source;\n    } else if (\n      supportedImageFormats.basis &&\n      (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(extensions.KHR_texture_basisu)\n    ) {\n      return extensions.KHR_texture_basisu.source;\n    }\n  }\n  return texture.source;\n};\n\n/**\n * Create a sampler for a texture.\n *\n * @param {Object} options Object with the following properties:\n * @param {Object} options.gltf The glTF JSON.\n * @param {Object} options.textureInfo The texture info object.\n * @param {Boolean} [options.compressedTextureNoMipmap=false] True when the texture is compressed and does not have an embedded mipmap.\n *\n * @returns {Sampler} The sampler.\n * @private\n */\nGltfLoaderUtil.createSampler = function (options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n  var gltf = options.gltf;\n  var textureInfo = options.textureInfo;\n  var compressedTextureNoMipmap = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(\n    options.compressedTextureNoMipmap,\n    false\n  );\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("options.gltf", gltf);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("options.textureInfo", textureInfo);\n  //>>includeEnd(\'debug\');\n\n  // Default sampler properties\n  var wrapS = _Renderer_TextureWrap_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].REPEAT */ .Z.REPEAT;\n  var wrapT = _Renderer_TextureWrap_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"].REPEAT */ .Z.REPEAT;\n  var minFilter = _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].LINEAR */ .Z.LINEAR;\n  var magFilter = _Renderer_TextureMagnificationFilter_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"].LINEAR */ .Z.LINEAR;\n\n  var textureId = textureInfo.index;\n  var texture = gltf.textures[textureId];\n  var samplerId = texture.sampler;\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(samplerId)) {\n    var sampler = gltf.samplers[samplerId];\n    wrapS = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(sampler.wrapS, wrapS);\n    wrapT = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(sampler.wrapT, wrapT);\n    minFilter = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(sampler.minFilter, minFilter);\n    magFilter = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(sampler.magFilter, magFilter);\n  }\n\n  var usesTextureTransform = false;\n  var extensions = textureInfo.extensions;\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(extensions) && (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(extensions.KHR_texture_transform)) {\n    usesTextureTransform = true;\n  }\n\n  if (\n    (compressedTextureNoMipmap || usesTextureTransform) &&\n    minFilter !== _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].LINEAR */ .Z.LINEAR &&\n    minFilter !== _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].NEAREST */ .Z.NEAREST\n  ) {\n    if (\n      minFilter === _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].NEAREST_MIPMAP_NEAREST */ .Z.NEAREST_MIPMAP_NEAREST ||\n      minFilter === _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].NEAREST_MIPMAP_LINEAR */ .Z.NEAREST_MIPMAP_LINEAR\n    ) {\n      minFilter = _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].NEAREST */ .Z.NEAREST;\n    } else {\n      minFilter = _Renderer_TextureMinificationFilter_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"].LINEAR */ .Z.LINEAR;\n    }\n  }\n\n  return new _Renderer_Sampler_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z({\n    wrapS: wrapS,\n    wrapT: wrapT,\n    minificationFilter: minFilter,\n    magnificationFilter: magFilter,\n  });\n};\n\nvar defaultScale = new _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(1.0, 1.0);\n\n/**\n * Create a model texture reader.\n *\n * @param {Object} options Object with the following properties:\n * @param {Object} options.textureInfo The texture info JSON.\n * @param {String} [options.channels] The texture channels to read from.\n * @param {Texture} [options.texture] The texture object.\n *\n * @returns {ModelComponents.TextureReader} The texture reader for this model.\n */\nGltfLoaderUtil.createModelTextureReader = function (options) {\n  options = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(options, _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT);\n  var textureInfo = options.textureInfo;\n  var channels = options.channels;\n  var texture = options.texture;\n\n  //>>includeStart(\'debug\', pragmas.debug);\n  _Core_Check_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].typeOf.object */ .Z.typeOf.object("options.textureInfo", textureInfo);\n  //>>includeEnd(\'debug\');\n\n  var texCoord = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(textureInfo.texCoord, 0);\n  var transform;\n\n  var textureTransform = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(\n    textureInfo.extensions,\n    _Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"].EMPTY_OBJECT */ .Z.EMPTY_OBJECT\n  ).KHR_texture_transform;\n\n  if ((0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(textureTransform)) {\n    texCoord = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(textureTransform.texCoord, texCoord);\n\n    var offset = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(textureTransform.offset)\n      ? _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].unpack */ .Z.unpack(textureTransform.offset)\n      : _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].ZERO */ .Z.ZERO;\n    var rotation = (0,_Core_defaultValue_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(textureTransform.rotation, 0.0);\n    var scale = (0,_Core_defined_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(textureTransform.scale)\n      ? _Core_Cartesian2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"].unpack */ .Z.unpack(textureTransform.scale)\n      : defaultScale;\n\n    // glTF assumes UV coordinates start with (0, 0) in the top left corner\n    // (y-down) unlike WebGL which puts (0, 0) in the bottom left corner (y-up).\n    // This means rotations are reversed since the angle from x to y is now\n    // clockwise instead of CCW. Translations and scales are not impacted by\n    // this.\n    rotation = -rotation;\n\n    // prettier-ignore\n    transform = new _Core_Matrix3_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z(\n        Math.cos(rotation) * scale.x, -Math.sin(rotation) * scale.y, offset.x,\n        Math.sin(rotation) * scale.x, Math.cos(rotation) * scale.y, offset.y,\n        0.0, 0.0, 1.0\n      );\n  }\n\n  var modelTextureReader = new _ModelComponents_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"].TextureReader */ .Z.TextureReader();\n  modelTextureReader.texture = texture;\n  modelTextureReader.texCoord = texCoord;\n  modelTextureReader.transform = transform;\n  modelTextureReader.channels = channels;\n\n  return modelTextureReader;\n};\n\n/* harmony default export */ __webpack_exports__["Z"] = (GltfLoaderUtil);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Y2VzIjpbIndlYnBhY2s6Ly92dWUzLXdlYnBhY2s1Ly4vbm9kZV9tb2R1bGVzL2Nlc2l1bS9Tb3VyY2UvU2NlbmUvR2x0ZkxvYWRlclV0aWwuanM/N2E1MSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ2FydGVzaWFuMiBmcm9tIFwiLi4vQ29yZS9DYXJ0ZXNpYW4yLmpzXCI7XG5pbXBvcnQgQ2hlY2sgZnJvbSBcIi4uL0NvcmUvQ2hlY2suanNcIjtcbmltcG9ydCBkZWZhdWx0VmFsdWUgZnJvbSBcIi4uL0NvcmUvZGVmYXVsdFZhbHVlLmpzXCI7XG5pbXBvcnQgZGVmaW5lZCBmcm9tIFwiLi4vQ29yZS9kZWZpbmVkLmpzXCI7XG5pbXBvcnQgTWF0cml4MyBmcm9tIFwiLi4vQ29yZS9NYXRyaXgzLmpzXCI7XG5pbXBvcnQgU2FtcGxlciBmcm9tIFwiLi4vUmVuZGVyZXIvU2FtcGxlci5qc1wiO1xuaW1wb3J0IFRleHR1cmVNYWduaWZpY2F0aW9uRmlsdGVyIGZyb20gXCIuLi9SZW5kZXJlci9UZXh0dXJlTWFnbmlmaWNhdGlvbkZpbHRlci5qc1wiO1xuaW1wb3J0IFRleHR1cmVNaW5pZmljYXRpb25GaWx0ZXIgZnJvbSBcIi4uL1JlbmRlcmVyL1RleHR1cmVNaW5pZmljYXRpb25GaWx0ZXIuanNcIjtcbmltcG9ydCBUZXh0dXJlV3JhcCBmcm9tIFwiLi4vUmVuZGVyZXIvVGV4dHVyZVdyYXAuanNcIjtcbmltcG9ydCBNb2RlbENvbXBvbmVudHMgZnJvbSBcIi4vTW9kZWxDb21wb25lbnRzLmpzXCI7XG5cbi8qKlxuICogZ2xURiBsb2FkaW5nIHV0aWxpdGllcy5cbiAqXG4gKiBAbmFtZXNwYWNlIEdsdGZMb2FkZXJVdGlsXG4gKlxuICogQHByaXZhdGVcbiAqL1xudmFyIEdsdGZMb2FkZXJVdGlsID0ge307XG5cbi8qKlxuICogR2V0IHRoZSBpbWFnZSBJRCByZWZlcmVuY2VkIGJ5IGEgdGV4dHVyZS5cbiAqIDxwPlxuICogV2hlbiB0aGUgdGV4dHVyZSBoYXMgdGhlIEVYVF90ZXh0dXJlX3dlYnAgZXh0ZW5zaW9uIGFuZCB0aGUgYnJvd3NlciBzdXBwb3J0c1xuICogV2ViUCBpbWFnZXMgdGhlIFdlYlAgaW1hZ2UgSUQgaXMgcmV0dXJuZWQuXG4gKiA8L3A+XG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgT2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMuZ2x0ZiBUaGUgZ2xURiBKU09OLlxuICogQHBhcmFtIHtOdW1iZXJ9IG9wdGlvbnMudGV4dHVyZUlkIFRoZSB0ZXh0dXJlIElELlxuICogQHBhcmFtIHtTdXBwb3J0ZWRJbWFnZUZvcm1hdHN9IG9wdGlvbnMuc3VwcG9ydGVkSW1hZ2VGb3JtYXRzIFRoZSBzdXBwb3J0ZWQgaW1hZ2UgZm9ybWF0cy5cbiAqXG4gKiBAcmV0dXJucyB7TnVtYmVyfSBUaGUgaW1hZ2UgSUQuXG4gKiBAcHJpdmF0ZVxuICovXG5HbHRmTG9hZGVyVXRpbC5nZXRJbWFnZUlkRnJvbVRleHR1cmUgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICBvcHRpb25zID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMsIGRlZmF1bHRWYWx1ZS5FTVBUWV9PQkpFQ1QpO1xuICB2YXIgZ2x0ZiA9IG9wdGlvbnMuZ2x0ZjtcbiAgdmFyIHRleHR1cmVJZCA9IG9wdGlvbnMudGV4dHVyZUlkO1xuICB2YXIgc3VwcG9ydGVkSW1hZ2VGb3JtYXRzID0gb3B0aW9ucy5zdXBwb3J0ZWRJbWFnZUZvcm1hdHM7XG5cbiAgLy8+PmluY2x1ZGVTdGFydCgnZGVidWcnLCBwcmFnbWFzLmRlYnVnKTtcbiAgQ2hlY2sudHlwZU9mLm9iamVjdChcIm9wdGlvbnMuZ2x0ZlwiLCBnbHRmKTtcbiAgQ2hlY2sudHlwZU9mLm51bWJlcihcIm9wdGlvbnMudGV4dHVyZUlkXCIsIHRleHR1cmVJZCk7XG4gIENoZWNrLnR5cGVPZi5vYmplY3QoXCJvcHRpb25zLnN1cHBvcnRlZEltYWdlRm9ybWF0c1wiLCBzdXBwb3J0ZWRJbWFnZUZvcm1hdHMpO1xuICAvLz4+aW5jbHVkZUVuZCgnZGVidWcnKTtcblxuICB2YXIgdGV4dHVyZSA9IGdsdGYudGV4dHVyZXNbdGV4dHVyZUlkXTtcbiAgdmFyIGV4dGVuc2lvbnMgPSB0ZXh0dXJlLmV4dGVuc2lvbnM7XG4gIGlmIChkZWZpbmVkKGV4dGVuc2lvbnMpKSB7XG4gICAgaWYgKHN1cHBvcnRlZEltYWdlRm9ybWF0cy53ZWJwICYmIGRlZmluZWQoZXh0ZW5zaW9ucy5FWFRfdGV4dHVyZV93ZWJwKSkge1xuICAgICAgcmV0dXJuIGV4dGVuc2lvbnMuRVhUX3RleHR1cmVfd2VicC5zb3VyY2U7XG4gICAgfSBlbHNlIGlmIChcbiAgICAgIHN1cHBvcnRlZEltYWdlRm9ybWF0cy5iYXNpcyAmJlxuICAgICAgZGVmaW5lZChleHRlbnNpb25zLktIUl90ZXh0dXJlX2Jhc2lzdSlcbiAgICApIHtcbiAgICAgIHJldHVybiBleHRlbnNpb25zLktIUl90ZXh0dXJlX2Jhc2lzdS5zb3VyY2U7XG4gICAgfVxuICB9XG4gIHJldHVybiB0ZXh0dXJlLnNvdXJjZTtcbn07XG5cbi8qKlxuICogQ3JlYXRlIGEgc2FtcGxlciBmb3IgYSB0ZXh0dXJlLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIE9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLmdsdGYgVGhlIGdsVEYgSlNPTi5cbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLnRleHR1cmVJbmZvIFRoZSB0ZXh0dXJlIGluZm8gb2JqZWN0LlxuICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5jb21wcmVzc2VkVGV4dHVyZU5vTWlwbWFwPWZhbHNlXSBUcnVlIHdoZW4gdGhlIHRleHR1cmUgaXMgY29tcHJlc3NlZCBhbmQgZG9lcyBub3QgaGF2ZSBhbiBlbWJlZGRlZCBtaXBtYXAuXG4gKlxuICogQHJldHVybnMge1NhbXBsZXJ9IFRoZSBzYW1wbGVyLlxuICogQHByaXZhdGVcbiAqL1xuR2x0ZkxvYWRlclV0aWwuY3JlYXRlU2FtcGxlciA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBkZWZhdWx0VmFsdWUob3B0aW9ucywgZGVmYXVsdFZhbHVlLkVNUFRZX09CSkVDVCk7XG4gIHZhciBnbHRmID0gb3B0aW9ucy5nbHRmO1xuICB2YXIgdGV4dHVyZUluZm8gPSBvcHRpb25zLnRleHR1cmVJbmZvO1xuICB2YXIgY29tcHJlc3NlZFRleHR1cmVOb01pcG1hcCA9IGRlZmF1bHRWYWx1ZShcbiAgICBvcHRpb25zLmNvbXByZXNzZWRUZXh0dXJlTm9NaXBtYXAsXG4gICAgZmFsc2VcbiAgKTtcblxuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwib3B0aW9ucy5nbHRmXCIsIGdsdGYpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwib3B0aW9ucy50ZXh0dXJlSW5mb1wiLCB0ZXh0dXJlSW5mbyk7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIC8vIERlZmF1bHQgc2FtcGxlciBwcm9wZXJ0aWVzXG4gIHZhciB3cmFwUyA9IFRleHR1cmVXcmFwLlJFUEVBVDtcbiAgdmFyIHdyYXBUID0gVGV4dHVyZVdyYXAuUkVQRUFUO1xuICB2YXIgbWluRmlsdGVyID0gVGV4dHVyZU1pbmlmaWNhdGlvbkZpbHRlci5MSU5FQVI7XG4gIHZhciBtYWdGaWx0ZXIgPSBUZXh0dXJlTWFnbmlmaWNhdGlvbkZpbHRlci5MSU5FQVI7XG5cbiAgdmFyIHRleHR1cmVJZCA9IHRleHR1cmVJbmZvLmluZGV4O1xuICB2YXIgdGV4dHVyZSA9IGdsdGYudGV4dHVyZXNbdGV4dHVyZUlkXTtcbiAgdmFyIHNhbXBsZXJJZCA9IHRleHR1cmUuc2FtcGxlcjtcblxuICBpZiAoZGVmaW5lZChzYW1wbGVySWQpKSB7XG4gICAgdmFyIHNhbXBsZXIgPSBnbHRmLnNhbXBsZXJzW3NhbXBsZXJJZF07XG4gICAgd3JhcFMgPSBkZWZhdWx0VmFsdWUoc2FtcGxlci53cmFwUywgd3JhcFMpO1xuICAgIHdyYXBUID0gZGVmYXVsdFZhbHVlKHNhbXBsZXIud3JhcFQsIHdyYXBUKTtcbiAgICBtaW5GaWx0ZXIgPSBkZWZhdWx0VmFsdWUoc2FtcGxlci5taW5GaWx0ZXIsIG1pbkZpbHRlcik7XG4gICAgbWFnRmlsdGVyID0gZGVmYXVsdFZhbHVlKHNhbXBsZXIubWFnRmlsdGVyLCBtYWdGaWx0ZXIpO1xuICB9XG5cbiAgdmFyIHVzZXNUZXh0dXJlVHJhbnNmb3JtID0gZmFsc2U7XG4gIHZhciBleHRlbnNpb25zID0gdGV4dHVyZUluZm8uZXh0ZW5zaW9ucztcbiAgaWYgKGRlZmluZWQoZXh0ZW5zaW9ucykgJiYgZGVmaW5lZChleHRlbnNpb25zLktIUl90ZXh0dXJlX3RyYW5zZm9ybSkpIHtcbiAgICB1c2VzVGV4dHVyZVRyYW5zZm9ybSA9IHRydWU7XG4gIH1cblxuICBpZiAoXG4gICAgKGNvbXByZXNzZWRUZXh0dXJlTm9NaXBtYXAgfHwgdXNlc1RleHR1cmVUcmFuc2Zvcm0pICYmXG4gICAgbWluRmlsdGVyICE9PSBUZXh0dXJlTWluaWZpY2F0aW9uRmlsdGVyLkxJTkVBUiAmJlxuICAgIG1pbkZpbHRlciAhPT0gVGV4dHVyZU1pbmlmaWNhdGlvbkZpbHRlci5ORUFSRVNUXG4gICkge1xuICAgIGlmIChcbiAgICAgIG1pbkZpbHRlciA9PT0gVGV4dHVyZU1pbmlmaWNhdGlvbkZpbHRlci5ORUFSRVNUX01JUE1BUF9ORUFSRVNUIHx8XG4gICAgICBtaW5GaWx0ZXIgPT09IFRleHR1cmVNaW5pZmljYXRpb25GaWx0ZXIuTkVBUkVTVF9NSVBNQVBfTElORUFSXG4gICAgKSB7XG4gICAgICBtaW5GaWx0ZXIgPSBUZXh0dXJlTWluaWZpY2F0aW9uRmlsdGVyLk5FQVJFU1Q7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1pbkZpbHRlciA9IFRleHR1cmVNaW5pZmljYXRpb25GaWx0ZXIuTElORUFSO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBuZXcgU2FtcGxlcih7XG4gICAgd3JhcFM6IHdyYXBTLFxuICAgIHdyYXBUOiB3cmFwVCxcbiAgICBtaW5pZmljYXRpb25GaWx0ZXI6IG1pbkZpbHRlcixcbiAgICBtYWduaWZpY2F0aW9uRmlsdGVyOiBtYWdGaWx0ZXIsXG4gIH0pO1xufTtcblxudmFyIGRlZmF1bHRTY2FsZSA9IG5ldyBDYXJ0ZXNpYW4yKDEuMCwgMS4wKTtcblxuLyoqXG4gKiBDcmVhdGUgYSBtb2RlbCB0ZXh0dXJlIHJlYWRlci5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBPYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucy50ZXh0dXJlSW5mbyBUaGUgdGV4dHVyZSBpbmZvIEpTT04uXG4gKiBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMuY2hhbm5lbHNdIFRoZSB0ZXh0dXJlIGNoYW5uZWxzIHRvIHJlYWQgZnJvbS5cbiAqIEBwYXJhbSB7VGV4dHVyZX0gW29wdGlvbnMudGV4dHVyZV0gVGhlIHRleHR1cmUgb2JqZWN0LlxuICpcbiAqIEByZXR1cm5zIHtNb2RlbENvbXBvbmVudHMuVGV4dHVyZVJlYWRlcn0gVGhlIHRleHR1cmUgcmVhZGVyIGZvciB0aGlzIG1vZGVsLlxuICovXG5HbHRmTG9hZGVyVXRpbC5jcmVhdGVNb2RlbFRleHR1cmVSZWFkZXIgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICBvcHRpb25zID0gZGVmYXVsdFZhbHVlKG9wdGlvbnMsIGRlZmF1bHRWYWx1ZS5FTVBUWV9PQkpFQ1QpO1xuICB2YXIgdGV4dHVyZUluZm8gPSBvcHRpb25zLnRleHR1cmVJbmZvO1xuICB2YXIgY2hhbm5lbHMgPSBvcHRpb25zLmNoYW5uZWxzO1xuICB2YXIgdGV4dHVyZSA9IG9wdGlvbnMudGV4dHVyZTtcblxuICAvLz4+aW5jbHVkZVN0YXJ0KCdkZWJ1ZycsIHByYWdtYXMuZGVidWcpO1xuICBDaGVjay50eXBlT2Yub2JqZWN0KFwib3B0aW9ucy50ZXh0dXJlSW5mb1wiLCB0ZXh0dXJlSW5mbyk7XG4gIC8vPj5pbmNsdWRlRW5kKCdkZWJ1ZycpO1xuXG4gIHZhciB0ZXhDb29yZCA9IGRlZmF1bHRWYWx1ZSh0ZXh0dXJlSW5mby50ZXhDb29yZCwgMCk7XG4gIHZhciB0cmFuc2Zvcm07XG5cbiAgdmFyIHRleHR1cmVUcmFuc2Zvcm0gPSBkZWZhdWx0VmFsdWUoXG4gICAgdGV4dHVyZUluZm8uZXh0ZW5zaW9ucyxcbiAgICBkZWZhdWx0VmFsdWUuRU1QVFlfT0JKRUNUXG4gICkuS0hSX3RleHR1cmVfdHJhbnNmb3JtO1xuXG4gIGlmIChkZWZpbmVkKHRleHR1cmVUcmFuc2Zvcm0pKSB7XG4gICAgdGV4Q29vcmQgPSBkZWZhdWx0VmFsdWUodGV4dHVyZVRyYW5zZm9ybS50ZXhDb29yZCwgdGV4Q29vcmQpO1xuXG4gICAgdmFyIG9mZnNldCA9IGRlZmluZWQodGV4dHVyZVRyYW5zZm9ybS5vZmZzZXQpXG4gICAgICA/IENhcnRlc2lhbjIudW5wYWNrKHRleHR1cmVUcmFuc2Zvcm0ub2Zmc2V0KVxuICAgICAgOiBDYXJ0ZXNpYW4yLlpFUk87XG4gICAgdmFyIHJvdGF0aW9uID0gZGVmYXVsdFZhbHVlKHRleHR1cmVUcmFuc2Zvcm0ucm90YXRpb24sIDAuMCk7XG4gICAgdmFyIHNjYWxlID0gZGVmaW5lZCh0ZXh0dXJlVHJhbnNmb3JtLnNjYWxlKVxuICAgICAgPyBDYXJ0ZXNpYW4yLnVucGFjayh0ZXh0dXJlVHJhbnNmb3JtLnNjYWxlKVxuICAgICAgOiBkZWZhdWx0U2NhbGU7XG5cbiAgICAvLyBnbFRGIGFzc3VtZXMgVVYgY29vcmRpbmF0ZXMgc3RhcnQgd2l0aCAoMCwgMCkgaW4gdGhlIHRvcCBsZWZ0IGNvcm5lclxuICAgIC8vICh5LWRvd24pIHVubGlrZSBXZWJHTCB3aGljaCBwdXRzICgwLCAwKSBpbiB0aGUgYm90dG9tIGxlZnQgY29ybmVyICh5LXVwKS5cbiAgICAvLyBUaGlzIG1lYW5zIHJvdGF0aW9ucyBhcmUgcmV2ZXJzZWQgc2luY2UgdGhlIGFuZ2xlIGZyb20geCB0byB5IGlzIG5vd1xuICAgIC8vIGNsb2Nrd2lzZSBpbnN0ZWFkIG9mIENDVy4gVHJhbnNsYXRpb25zIGFuZCBzY2FsZXMgYXJlIG5vdCBpbXBhY3RlZCBieVxuICAgIC8vIHRoaXMuXG4gICAgcm90YXRpb24gPSAtcm90YXRpb247XG5cbiAgICAvLyBwcmV0dGllci1pZ25vcmVcbiAgICB0cmFuc2Zvcm0gPSBuZXcgTWF0cml4MyhcbiAgICAgICAgTWF0aC5jb3Mocm90YXRpb24pICogc2NhbGUueCwgLU1hdGguc2luKHJvdGF0aW9uKSAqIHNjYWxlLnksIG9mZnNldC54LFxuICAgICAgICBNYXRoLnNpbihyb3RhdGlvbikgKiBzY2FsZS54LCBNYXRoLmNvcyhyb3RhdGlvbikgKiBzY2FsZS55LCBvZmZzZXQueSxcbiAgICAgICAgMC4wLCAwLjAsIDEuMFxuICAgICAgKTtcbiAgfVxuXG4gIHZhciBtb2RlbFRleHR1cmVSZWFkZXIgPSBuZXcgTW9kZWxDb21wb25lbnRzLlRleHR1cmVSZWFkZXIoKTtcbiAgbW9kZWxUZXh0dXJlUmVhZGVyLnRleHR1cmUgPSB0ZXh0dXJlO1xuICBtb2RlbFRleHR1cmVSZWFkZXIudGV4Q29vcmQgPSB0ZXhDb29yZDtcbiAgbW9kZWxUZXh0dXJlUmVhZGVyLnRyYW5zZm9ybSA9IHRyYW5zZm9ybTtcbiAgbW9kZWxUZXh0dXJlUmVhZGVyLmNoYW5uZWxzID0gY2hhbm5lbHM7XG5cbiAgcmV0dXJuIG1vZGVsVGV4dHVyZVJlYWRlcjtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IEdsdGZMb2FkZXJVdGlsO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///61120\n')}}]);