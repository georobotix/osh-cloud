"use strict";(self["webpackChunkvue3_webpack5"]=self["webpackChunkvue3_webpack5"]||[]).push([[5014],{81499:function(t,e,i){i.d(e,{Z:function(){return I}});const s=.5;var r=i(85487),o=i(94806),n=i(37195),a=i(28641),h=i(24121),c=i(33983);const l=10,u=.25;class d{constructor(t,e,i,s,r,o){this.sourceProj_=t,this.targetProj_=e;let n={};const c=(0,h.Ck)(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const e=t[0]+"/"+t[1];return n[e]||(n[e]=c(t)),n[e]},this.maxSourceExtent_=s,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!s&&!!this.sourceProj_.getExtent()&&(0,a.dz)(s)==(0,a.dz)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,a.dz)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,a.dz)(this.targetProj_.getExtent()):null;const u=(0,a.rL)(i),d=(0,a.Xv)(i),_=(0,a.w$)(i),g=(0,a.hC)(i),f=this.transformInv_(u),T=this.transformInv_(d),E=this.transformInv_(_),m=this.transformInv_(g),p=l+(o?Math.max(0,Math.ceil(Math.log2((0,a.bg)(i)/(o*o*256*256)))):0);if(this.addQuad_(u,d,_,g,f,T,E,m,p),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach((function(e,i,s){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])})),this.triangles_.forEach((e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const i=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];i[0][0]-t>this.sourceWorldWidth_/2&&(i[0][0]-=this.sourceWorldWidth_),i[1][0]-t>this.sourceWorldWidth_/2&&(i[1][0]-=this.sourceWorldWidth_),i[2][0]-t>this.sourceWorldWidth_/2&&(i[2][0]-=this.sourceWorldWidth_);const s=Math.min(i[0][0],i[1][0],i[2][0]),r=Math.max(i[0][0],i[1][0],i[2][0]);r-s<this.sourceWorldWidth_/2&&(e.source=i)}}))}n={}}addTriangle_(t,e,i,s,r,o){this.triangles_.push({source:[s,r,o],target:[t,e,i]})}addQuad_(t,e,i,s,r,o,n,h,l){const d=(0,a.hI)([r,o,n,h]),_=this.sourceWorldWidth_?(0,a.dz)(d)/this.sourceWorldWidth_:null,g=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&_>.5&&_<1;let T=!1;if(l>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const r=(0,a.hI)([t,e,i,s]),o=(0,a.dz)(r)/this.targetWorldWidth_;T=o>u||T}!f&&this.sourceProj_.isGlobal()&&_&&(T=_>u||T)}if(!T&&this.maxSourceExtent_&&isFinite(d[0])&&isFinite(d[1])&&isFinite(d[2])&&isFinite(d[3])&&!(0,a.kK)(d,this.maxSourceExtent_))return;let E=0;if(!T&&(!isFinite(r[0])||!isFinite(r[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(n[0])||!isFinite(n[1])||!isFinite(h[0])||!isFinite(h[1])))if(l>0)T=!0;else if(E=(isFinite(r[0])&&isFinite(r[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(n[0])&&isFinite(n[1])?0:2)+(isFinite(h[0])&&isFinite(h[1])?0:1),1!=E&&2!=E&&4!=E&&8!=E)return;if(l>0){if(!T){const e=[(t[0]+i[0])/2,(t[1]+i[1])/2],s=this.transformInv_(e);let o;if(f){const t=((0,c.$W)(r[0],g)+(0,c.$W)(n[0],g))/2;o=t-(0,c.$W)(s[0],g)}else o=(r[0]+n[0])/2-s[0];const a=(r[1]+n[1])/2-s[1],h=o*o+a*a;T=h>this.errorThresholdSquared_}if(T){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const a=[(e[0]+i[0])/2,(e[1]+i[1])/2],c=this.transformInv_(a),u=[(s[0]+t[0])/2,(s[1]+t[1])/2],d=this.transformInv_(u);this.addQuad_(t,e,a,u,r,o,c,d,l-1),this.addQuad_(u,a,i,s,d,c,n,h,l-1)}else{const a=[(t[0]+e[0])/2,(t[1]+e[1])/2],c=this.transformInv_(a),u=[(i[0]+s[0])/2,(i[1]+s[1])/2],d=this.transformInv_(u);this.addQuad_(t,a,u,s,r,c,d,h,l-1),this.addQuad_(a,e,i,u,c,o,n,d,l-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&E)&&this.addTriangle_(t,i,s,r,n,h),0==(14&E)&&this.addTriangle_(t,i,e,r,n,o),E&&(0==(13&E)&&this.addTriangle_(e,s,t,o,h,r),0==(7&E)&&this.addTriangle_(e,s,i,o,h,n))}calculateSourceExtent(){const t=(0,a.lJ)();return this.triangles_.forEach((function(e,i,s){const r=e.source;(0,a.Wj)(t,r[0]),(0,a.Wj)(t,r[1]),(0,a.Wj)(t,r[2])})),t}getTriangles(){return this.triangles_}}var _=d,g=i(68326);let f;const T=[];function E(t,e,i,s,r){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(s,r),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,s)+1,Math.max(i,r)),t.restore()}function m(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function p(){if(void 0===f){const t=(0,g.E4)(6,6,T);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",E(t,4,5,4,0),E(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;f=m(e,0)||m(e,4)||m(e,8),(0,g.jy)(t),T.push(t.canvas)}return f}function v(t,e,i,s){const r=(0,h.vs)(i,e,t);let o=(0,h._Q)(e,s,i);const n=e.getMetersPerUnit();void 0!==n&&(o*=n);const c=t.getMetersPerUnit();void 0!==c&&(o/=c);const l=t.getExtent();if(!l||(0,a.b8)(l,r)){const e=(0,h._Q)(t,o,r)/o;isFinite(e)&&e>0&&(o/=e)}return o}function W(t,e,i,s){const r=(0,a.qg)(i);let o=v(t,e,r,s);return(!isFinite(o)||o<=0)&&(0,a.H6)(i,(function(i){return o=v(t,e,i,s),isFinite(o)&&o>0})),o}function x(t,e,i,s,r,o,n,h,l,u,d,_){const f=(0,g.E4)(Math.round(i*t),Math.round(i*e),T);if(_||(f.imageSmoothingEnabled=!1),0===l.length)return f.canvas;function E(t){return Math.round(t*i)/i}f.scale(i,i),f.globalCompositeOperation="lighter";const m=(0,a.lJ)();l.forEach((function(t,e,i){(0,a.l7)(m,t.extent)}));const v=(0,a.dz)(m),W=(0,a.Cr)(m),x=(0,g.E4)(Math.round(i*v/s),Math.round(i*W/s),T);_||(x.imageSmoothingEnabled=!1);const b=i/s;l.forEach((function(t,e,i){const s=t.extent[0]-m[0],r=-(t.extent[3]-m[3]),o=(0,a.dz)(t.extent),n=(0,a.Cr)(t.extent);t.image.width>0&&t.image.height>0&&x.drawImage(t.image,u,u,t.image.width-2*u,t.image.height-2*u,s*b,r*b,o*b,n*b)}));const Z=(0,a.rL)(n);return h.getTriangles().forEach((function(t,e,r){const n=t.source,a=t.target;let h=n[0][0],l=n[0][1],u=n[1][0],d=n[1][1],g=n[2][0],T=n[2][1];const v=E((a[0][0]-Z[0])/o),W=E(-(a[0][1]-Z[1])/o),b=E((a[1][0]-Z[0])/o),I=E(-(a[1][1]-Z[1])/o),P=E((a[2][0]-Z[0])/o),F=E(-(a[2][1]-Z[1])/o),M=h,S=l;h=0,l=0,u-=M,d-=S,g-=M,T-=S;const j=[[u,d,0,0,b-v],[g,T,0,0,P-v],[0,0,u,d,I-W],[0,0,g,T,F-W]],C=(0,c.SV)(j);if(C){if(f.save(),f.beginPath(),p()||!_){f.moveTo(b,I);const t=4,e=v-b,i=W-I;for(let s=0;s<t;s++)f.lineTo(b+E((s+1)*e/t),I+E(s*i/(t-1))),s!=t-1&&f.lineTo(b+E((s+1)*e/t),I+E((s+1)*i/(t-1)));f.lineTo(P,F)}else f.moveTo(b,I),f.lineTo(v,W),f.lineTo(P,F);f.clip(),f.transform(C[0],C[2],C[1],C[3],v,W),f.translate(m[0]-M,m[3]-S),f.scale(s/i,-s/i),f.drawImage(x.canvas,0,0),f.restore()}})),(0,g.jy)(x),T.push(x.canvas),d&&(f.save(),f.globalCompositeOperation="source-over",f.strokeStyle="black",f.lineWidth=1,h.getTriangles().forEach((function(t,e,i){const s=t.target,r=(s[0][0]-Z[0])/o,n=-(s[0][1]-Z[1])/o,a=(s[1][0]-Z[0])/o,h=-(s[1][1]-Z[1])/o,c=(s[2][0]-Z[0])/o,l=-(s[2][1]-Z[1])/o;f.beginPath(),f.moveTo(a,h),f.lineTo(r,n),f.lineTo(c,l),f.closePath(),f.stroke()})),f.restore()),f.canvas}var b=i(65818);class Z extends o.Z{constructor(t,e,i,r,o,h,l,u,d,g,f,T){super(o,n.Z.IDLE,{interpolate:!!T}),this.renderEdges_=void 0!==f&&f,this.pixelRatio_=l,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=r,this.wrappedTileCoord_=h||o,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const E=r.getTileCoordExtent(this.wrappedTileCoord_),m=this.targetTileGrid_.getExtent();let p=this.sourceTileGrid_.getExtent();const v=m?(0,a.Ed)(E,m):E;if(0===(0,a.bg)(v))return void(this.state=n.Z.EMPTY);const x=t.getExtent();x&&(p=p?(0,a.Ed)(p,x):x);const b=r.getResolution(this.wrappedTileCoord_[0]),Z=W(t,i,v,b);if(!isFinite(Z)||Z<=0)return void(this.state=n.Z.EMPTY);const I=void 0!==g?g:s;if(this.triangulation_=new _(t,i,v,p,Z*I,b),0===this.triangulation_.getTriangles().length)return void(this.state=n.Z.EMPTY);this.sourceZ_=e.getZForResolution(Z);let P=this.triangulation_.calculateSourceExtent();if(p&&(t.canWrapX()?(P[1]=(0,c.uZ)(P[1],p[1],p[3]),P[3]=(0,c.uZ)(P[3],p[1],p[3])):P=(0,a.Ed)(P,p)),(0,a.bg)(P)){const t=e.getTileRangeForExtentAndZ(P,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let i=t.minY;i<=t.maxY;i++){const t=d(this.sourceZ_,e,i,l);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=n.Z.EMPTY)}else this.state=n.Z.EMPTY}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach((e=>{e&&e.getState()==n.Z.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})})),this.sourceTiles_.length=0,0===t.length)this.state=n.Z.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),s="number"===typeof i?i:i[0],r="number"===typeof i?i:i[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),h=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=x(s,r,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,h,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=n.Z.LOADED}this.changed()}load(){if(this.state==n.Z.IDLE){this.state=n.Z.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((e=>{const i=e.getState();if(i==n.Z.IDLE||i==n.Z.LOADING){t++;const i=(0,b.oL)(e,r.Z.CHANGE,(function(s){const r=e.getState();r!=n.Z.LOADED&&r!=n.Z.ERROR&&r!=n.Z.EMPTY||((0,b.bN)(i),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(i)}})),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,i){const s=t.getState();s==n.Z.IDLE&&t.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(b.bN),this.sourcesListenerKeys_=null}release(){this.canvas_&&((0,g.jy)(this.canvas_.getContext("2d")),T.push(this.canvas_),this.canvas_=null),super.release()}}var I=Z}}]);
//# sourceMappingURL=chunk-vendors-6452bf7f.59ba785b.js.map