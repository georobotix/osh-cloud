define(["./GeometryOffsetAttribute-e8e698d7","./arrayRemoveDuplicates-198208a4","./Transforms-62a339c3","./Matrix2-92b7fb9d","./RuntimeError-4fdc4459","./ComponentDatatype-9ed50558","./PolylineVolumeGeometryLibrary-b9fa2b05","./CorridorGeometryLibrary-143e6a2e","./when-8166c7dd","./GeometryAttribute-6f4c3b93","./GeometryAttributes-50becc99","./IndexDatatype-797210ca","./PolygonPipeline-7fb6627c","./combine-a5c4cc47","./WebGLConstants-0664004c","./EllipsoidTangentPlane-5d8b4bd3","./AxisAlignedBoundingBox-b0cd1e39","./IntersectionTests-4f28a69c","./Plane-049255eb","./PolylinePipeline-fd9260c9","./EllipsoidGeodesic-133bd147","./EllipsoidRhumbLine-51654311"],(function(e,t,i,r,o,a,n,s,l,d,u,p,f,h,y,c,b,g,v,m,A,_){"use strict";var C=new r.Cartesian3,E=new r.Cartesian3,G=new r.Cartesian3;function T(e,t){for(var i=0;i<e.length;i++)e[i]=t.scaleToGeodeticSurface(e[i],e[i]);return e}function P(e,t){var i,o,f,h=[],y=e.positions,c=e.corners,b=e.endPositions,g=new u.GeometryAttributes,v=0,m=0,A=0;for(o=0;o<y.length;o+=2)f=y[o].length-3,v+=f,A+=f/3*4,m+=y[o+1].length-3;for(v+=3,m+=3,o=0;o<c.length;o++){i=c[o];var _=c[o].leftPositions;l.defined(_)?(f=_.length,v+=f,A+=f/3*2):(f=c[o].rightPositions.length,m+=f,A+=f/3*2)}var T,P=l.defined(b);P&&(T=b[0].length-3,v+=T,m+=T,T/=3,A+=4*T);var w,L,D,k,O,x,N=v+m,V=new Float64Array(N),H=0,I=N-1,S=T/2,B=p.IndexDatatype.createTypedArray(N/3,A+4),M=0;if(B[M++]=H/3,B[M++]=(I-2)/3,P){h.push(H/3),x=C,O=E;var R=b[0];for(o=0;o<S;o++)x=r.Cartesian3.fromArray(R,3*(S-1-o),x),O=r.Cartesian3.fromArray(R,3*(S+o),O),s.CorridorGeometryLibrary.addAttribute(V,O,H),s.CorridorGeometryLibrary.addAttribute(V,x,void 0,I),L=H/3,k=L+1,w=(I-2)/3,D=w-1,B[M++]=w,B[M++]=D,B[M++]=L,B[M++]=k,H+=3,I-=3}var U=0,F=y[U++],j=y[U++];for(V.set(F,H),V.set(j,I-j.length+1),f=j.length-3,h.push(H/3,(I-2)/3),o=0;o<f;o+=3)L=H/3,k=L+1,w=(I-2)/3,D=w-1,B[M++]=w,B[M++]=D,B[M++]=L,B[M++]=k,H+=3,I-=3;for(o=0;o<c.length;o++){var Y;i=c[o];var q,W=i.leftPositions,J=i.rightPositions,z=G;if(l.defined(W)){for(I-=3,q=D,h.push(k),Y=0;Y<W.length/3;Y++)z=r.Cartesian3.fromArray(W,3*Y,z),B[M++]=q-Y-1,B[M++]=q-Y,s.CorridorGeometryLibrary.addAttribute(V,z,void 0,I),I-=3;h.push(q-Math.floor(W.length/6)),t===n.CornerType.BEVELED&&h.push((I-2)/3+1),H+=3}else{for(H+=3,q=k,h.push(D),Y=0;Y<J.length/3;Y++)z=r.Cartesian3.fromArray(J,3*Y,z),B[M++]=q+Y,B[M++]=q+Y+1,s.CorridorGeometryLibrary.addAttribute(V,z,H),H+=3;h.push(q+Math.floor(J.length/6)),t===n.CornerType.BEVELED&&h.push(H/3-1),I-=3}for(F=y[U++],j=y[U++],F.splice(0,3),j.splice(j.length-3,3),V.set(F,H),V.set(j,I-j.length+1),f=j.length-3,Y=0;Y<j.length;Y+=3)k=H/3,L=k-1,D=(I-2)/3,w=D+1,B[M++]=w,B[M++]=D,B[M++]=L,B[M++]=k,H+=3,I-=3;H-=3,I+=3,h.push(H/3,(I-2)/3)}if(P){H+=3,I-=3,x=C,O=E;var K=b[1];for(o=0;o<S;o++)x=r.Cartesian3.fromArray(K,3*(T-o-1),x),O=r.Cartesian3.fromArray(K,3*o,O),s.CorridorGeometryLibrary.addAttribute(V,x,void 0,I),s.CorridorGeometryLibrary.addAttribute(V,O,H),k=H/3,L=k-1,D=(I-2)/3,w=D+1,B[M++]=w,B[M++]=D,B[M++]=L,B[M++]=k,H+=3,I-=3;h.push(H/3)}else h.push(H/3,(I-2)/3);return B[M++]=H/3,B[M++]=(I-2)/3,g.position=new d.GeometryAttribute({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:V}),{attributes:g,indices:B,wallIndices:h}}function w(t){var i=t.ellipsoid,r=s.CorridorGeometryLibrary.computePositions(t),o=P(r,t.cornerType),n=o.wallIndices,u=t.height,h=t.extrudedHeight,y=o.attributes,c=o.indices,b=y.position.values,g=b.length,v=new Float64Array(g);v.set(b);var m,A=new Float64Array(2*g);if(b=f.PolygonPipeline.scaleToGeodeticHeight(b,u,i),v=f.PolygonPipeline.scaleToGeodeticHeight(v,h,i),A.set(b),A.set(v,g),y.position.values=A,g/=3,l.defined(t.offsetAttribute)){var _=new Uint8Array(2*g);if(t.offsetAttribute===e.GeometryOffsetAttribute.TOP)_=e.arrayFill(_,1,0,g);else{var C=t.offsetAttribute===e.GeometryOffsetAttribute.NONE?0:1;_=e.arrayFill(_,C)}y.applyOffset=new d.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:_})}var E=c.length,G=p.IndexDatatype.createTypedArray(A.length/3,2*(E+n.length));G.set(c);var T,w,L=E;for(m=0;m<E;m+=2){var D=c[m],k=c[m+1];G[L++]=D+g,G[L++]=k+g}for(m=0;m<n.length;m++)T=n[m],w=T+g,G[L++]=T,G[L++]=w;return{attributes:y,indices:G}}function L(e){e=l.defaultValue(e,l.defaultValue.EMPTY_OBJECT);var t=e.positions,i=e.width;o.Check.typeOf.object("options.positions",t),o.Check.typeOf.number("options.width",i);var s=l.defaultValue(e.height,0),d=l.defaultValue(e.extrudedHeight,s);this._positions=t,this._ellipsoid=r.Ellipsoid.clone(l.defaultValue(e.ellipsoid,r.Ellipsoid.WGS84)),this._width=i,this._height=Math.max(s,d),this._extrudedHeight=Math.min(s,d),this._cornerType=l.defaultValue(e.cornerType,n.CornerType.ROUNDED),this._granularity=l.defaultValue(e.granularity,a.CesiumMath.RADIANS_PER_DEGREE),this._offsetAttribute=e.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+t.length*r.Cartesian3.packedLength+r.Ellipsoid.packedLength+6}L.pack=function(e,t,i){o.Check.typeOf.object("value",e),o.Check.typeOf.object("array",t),i=l.defaultValue(i,0);var a=e._positions,n=a.length;t[i++]=n;for(var s=0;s<n;++s,i+=r.Cartesian3.packedLength)r.Cartesian3.pack(a[s],t,i);return r.Ellipsoid.pack(e._ellipsoid,t,i),i+=r.Ellipsoid.packedLength,t[i++]=e._width,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._cornerType,t[i++]=e._granularity,t[i]=l.defaultValue(e._offsetAttribute,-1),t};var D=r.Ellipsoid.clone(r.Ellipsoid.UNIT_SPHERE),k={positions:void 0,ellipsoid:D,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};function O(e,t){return l.defined(t)&&(e=L.unpack(e,t)),e._ellipsoid=r.Ellipsoid.clone(e._ellipsoid),L.createGeometry(e)}return L.unpack=function(e,t,i){o.Check.typeOf.object("array",e),t=l.defaultValue(t,0);for(var a=e[t++],n=new Array(a),s=0;s<a;++s,t+=r.Cartesian3.packedLength)n[s]=r.Cartesian3.unpack(e,t);var d=r.Ellipsoid.unpack(e,t,D);t+=r.Ellipsoid.packedLength;var u=e[t++],p=e[t++],f=e[t++],h=e[t++],y=e[t++],c=e[t];return l.defined(i)?(i._positions=n,i._ellipsoid=r.Ellipsoid.clone(d,i._ellipsoid),i._width=u,i._height=p,i._extrudedHeight=f,i._cornerType=h,i._granularity=y,i._offsetAttribute=-1===c?void 0:c,i):(k.positions=n,k.width=u,k.height=p,k.extrudedHeight=f,k.cornerType=h,k.granularity=y,k.offsetAttribute=-1===c?void 0:c,new L(k))},L.createGeometry=function(o){var n=o._positions,u=o._width,p=o._ellipsoid;n=T(n,p);var h=t.arrayRemoveDuplicates(n,r.Cartesian3.equalsEpsilon);if(!(h.length<2||u<=0)){var y,c=o._height,b=o._extrudedHeight,g=!a.CesiumMath.equalsEpsilon(c,b,0,a.CesiumMath.EPSILON2),v={ellipsoid:p,positions:h,width:u,cornerType:o._cornerType,granularity:o._granularity,saveAttributes:!1};if(g)v.height=c,v.extrudedHeight=b,v.offsetAttribute=o._offsetAttribute,y=w(v);else{var m=s.CorridorGeometryLibrary.computePositions(v);if(y=P(m,v.cornerType),y.attributes.position.values=f.PolygonPipeline.scaleToGeodeticHeight(y.attributes.position.values,c,p),l.defined(o._offsetAttribute)){var A=y.attributes.position.values.length,_=new Uint8Array(A/3),C=o._offsetAttribute===e.GeometryOffsetAttribute.NONE?0:1;e.arrayFill(_,C),y.attributes.applyOffset=new d.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:_})}}var E=y.attributes,G=i.BoundingSphere.fromVertices(E.position.values,void 0,3);return new d.Geometry({attributes:E,indices:y.indices,primitiveType:d.PrimitiveType.LINES,boundingSphere:G,offsetAttribute:o._offsetAttribute})}},O}));