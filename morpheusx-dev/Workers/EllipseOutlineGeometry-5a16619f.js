define(["exports","./GeometryOffsetAttribute-e8e698d7","./Transforms-62a339c3","./Matrix2-92b7fb9d","./ComponentDatatype-9ed50558","./when-8166c7dd","./RuntimeError-4fdc4459","./EllipseGeometryLibrary-64f7a7c9","./GeometryAttribute-6f4c3b93","./GeometryAttributes-50becc99","./IndexDatatype-797210ca"],(function(e,t,i,r,a,n,o,s,l,u,d){"use strict";var f=new r.Cartesian3,p=new r.Cartesian3;function m(e){var t=e.center;p=r.Cartesian3.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(t,p),e.height,p),p=r.Cartesian3.add(t,p,p);for(var n=new i.BoundingSphere(p,e.semiMajorAxis),o=s.EllipseGeometryLibrary.computeEllipsePositions(e,!1,!0).outerPositions,f=new u.GeometryAttributes({position:new l.GeometryAttribute({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:s.EllipseGeometryLibrary.raisePositionsToHeight(o,e,!1)})}),m=o.length/3,c=d.IndexDatatype.createTypedArray(m,2*m),h=0,y=0;y<m;++y)c[h++]=y,c[h++]=(y+1)%m;return{boundingSphere:n,attributes:f,indices:c}}var c=new i.BoundingSphere,h=new i.BoundingSphere;function y(e){var o=e.center,p=e.ellipsoid,m=e.semiMajorAxis,y=r.Cartesian3.multiplyByScalar(p.geodeticSurfaceNormal(o,f),e.height,f);c.center=r.Cartesian3.add(o,y,c.center),c.radius=m,y=r.Cartesian3.multiplyByScalar(p.geodeticSurfaceNormal(o,y),e.extrudedHeight,y),h.center=r.Cartesian3.add(o,y,h.center),h.radius=m;var b=s.EllipseGeometryLibrary.computeEllipsePositions(e,!1,!0).outerPositions,A=new u.GeometryAttributes({position:new l.GeometryAttribute({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:s.EllipseGeometryLibrary.raisePositionsToHeight(b,e,!0)})});b=A.position.values;var _=i.BoundingSphere.union(c,h),g=b.length/3;if(n.defined(e.offsetAttribute)){var v=new Uint8Array(g);if(e.offsetAttribute===t.GeometryOffsetAttribute.TOP)v=t.arrayFill(v,1,0,g/2);else{var E=e.offsetAttribute===t.GeometryOffsetAttribute.NONE?0:1;v=t.arrayFill(v,E)}A.applyOffset=new l.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:v})}var x=n.defaultValue(e.numberOfVerticalLines,16);x=a.CesiumMath.clamp(x,0,g/2);var M=d.IndexDatatype.createTypedArray(g,2*g+2*x);g/=2;var w,C,D=0;for(w=0;w<g;++w)M[D++]=w,M[D++]=(w+1)%g,M[D++]=w+g,M[D++]=(w+1)%g+g;if(x>0){var G=Math.min(x,g);C=Math.round(g/G);var L=Math.min(C*x,g);for(w=0;w<L;w+=C)M[D++]=w,M[D++]=w+g}return{boundingSphere:_,attributes:A,indices:M}}function b(e){e=n.defaultValue(e,n.defaultValue.EMPTY_OBJECT);var t=e.center,i=n.defaultValue(e.ellipsoid,r.Ellipsoid.WGS84),s=e.semiMajorAxis,l=e.semiMinorAxis,u=n.defaultValue(e.granularity,a.CesiumMath.RADIANS_PER_DEGREE);if(!n.defined(t))throw new o.DeveloperError("center is required.");if(!n.defined(s))throw new o.DeveloperError("semiMajorAxis is required.");if(!n.defined(l))throw new o.DeveloperError("semiMinorAxis is required.");if(s<l)throw new o.DeveloperError("semiMajorAxis must be greater than or equal to the semiMinorAxis.");if(u<=0)throw new o.DeveloperError("granularity must be greater than zero.");var d=n.defaultValue(e.height,0),f=n.defaultValue(e.extrudedHeight,d);this._center=r.Cartesian3.clone(t),this._semiMajorAxis=s,this._semiMinorAxis=l,this._ellipsoid=r.Ellipsoid.clone(i),this._rotation=n.defaultValue(e.rotation,0),this._height=Math.max(f,d),this._granularity=u,this._extrudedHeight=Math.min(f,d),this._numberOfVerticalLines=Math.max(n.defaultValue(e.numberOfVerticalLines,16),0),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipseOutlineGeometry"}b.packedLength=r.Cartesian3.packedLength+r.Ellipsoid.packedLength+8,b.pack=function(e,t,i){if(!n.defined(e))throw new o.DeveloperError("value is required");if(!n.defined(t))throw new o.DeveloperError("array is required");return i=n.defaultValue(i,0),r.Cartesian3.pack(e._center,t,i),i+=r.Cartesian3.packedLength,r.Ellipsoid.pack(e._ellipsoid,t,i),i+=r.Ellipsoid.packedLength,t[i++]=e._semiMajorAxis,t[i++]=e._semiMinorAxis,t[i++]=e._rotation,t[i++]=e._height,t[i++]=e._granularity,t[i++]=e._extrudedHeight,t[i++]=e._numberOfVerticalLines,t[i]=n.defaultValue(e._offsetAttribute,-1),t};var A=new r.Cartesian3,_=new r.Ellipsoid,g={center:A,ellipsoid:_,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};b.unpack=function(e,t,i){if(!n.defined(e))throw new o.DeveloperError("array is required");t=n.defaultValue(t,0);var a=r.Cartesian3.unpack(e,t,A);t+=r.Cartesian3.packedLength;var s=r.Ellipsoid.unpack(e,t,_);t+=r.Ellipsoid.packedLength;var l=e[t++],u=e[t++],d=e[t++],f=e[t++],p=e[t++],m=e[t++],c=e[t++],h=e[t];return n.defined(i)?(i._center=r.Cartesian3.clone(a,i._center),i._ellipsoid=r.Ellipsoid.clone(s,i._ellipsoid),i._semiMajorAxis=l,i._semiMinorAxis=u,i._rotation=d,i._height=f,i._granularity=p,i._extrudedHeight=m,i._numberOfVerticalLines=c,i._offsetAttribute=-1===h?void 0:h,i):(g.height=f,g.extrudedHeight=m,g.granularity=p,g.rotation=d,g.semiMajorAxis=l,g.semiMinorAxis=u,g.numberOfVerticalLines=c,g.offsetAttribute=-1===h?void 0:h,new b(g))},b.createGeometry=function(e){if(!(e._semiMajorAxis<=0||e._semiMinorAxis<=0)){var i=e._height,r=e._extrudedHeight,o=!a.CesiumMath.equalsEpsilon(i,r,0,a.CesiumMath.EPSILON2);e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);var s,u={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:i,granularity:e._granularity,numberOfVerticalLines:e._numberOfVerticalLines};if(o)u.extrudedHeight=r,u.offsetAttribute=e._offsetAttribute,s=y(u);else if(s=m(u),n.defined(e._offsetAttribute)){var d=s.attributes.position.values.length,f=new Uint8Array(d/3),p=e._offsetAttribute===t.GeometryOffsetAttribute.NONE?0:1;t.arrayFill(f,p),s.attributes.applyOffset=new l.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:f})}return new l.Geometry({attributes:s.attributes,indices:s.indices,primitiveType:l.PrimitiveType.LINES,boundingSphere:s.boundingSphere,offsetAttribute:e._offsetAttribute})}},e.EllipseOutlineGeometry=b}));